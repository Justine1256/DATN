var AB=Object.defineProperty;var IB=(s,t,e)=>t in s?AB(s,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):s[t]=e;var p=(s,t,e)=>IB(s,typeof t!="symbol"?t+"":t,e);function RB(s,t){for(var e=0;e<t.length;e++){const i=t[e];if(typeof i!="string"&&!Array.isArray(i)){for(const n in i)if(n!=="default"&&!(n in s)){const r=Object.getOwnPropertyDescriptor(i,n);r&&Object.defineProperty(s,n,r.get?r:{enumerable:!0,get:()=>i[n]})}}}return Object.freeze(Object.defineProperty(s,Symbol.toStringTag,{value:"Module"}))}(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))i(n);new MutationObserver(n=>{for(const r of n)if(r.type==="childList")for(const o of r.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&i(o)}).observe(document,{childList:!0,subtree:!0});function e(n){const r={};return n.integrity&&(r.integrity=n.integrity),n.referrerPolicy&&(r.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?r.credentials="include":n.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function i(n){if(n.ep)return;n.ep=!0;const r=e(n);fetch(n.href,r)}})();function ld(s){return s&&s.__esModule&&Object.prototype.hasOwnProperty.call(s,"default")?s.default:s}var Lw={exports:{}},ku={},Bw={exports:{}},He={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var cS;function VB(){if(cS)return He;cS=1;var s=Symbol.for("react.element"),t=Symbol.for("react.portal"),e=Symbol.for("react.fragment"),i=Symbol.for("react.strict_mode"),n=Symbol.for("react.profiler"),r=Symbol.for("react.provider"),o=Symbol.for("react.context"),l=Symbol.for("react.forward_ref"),a=Symbol.for("react.suspense"),c=Symbol.for("react.memo"),h=Symbol.for("react.lazy"),f=Symbol.iterator;function m(V){return V===null||typeof V!="object"?null:(V=f&&V[f]||V["@@iterator"],typeof V=="function"?V:null)}var w={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},O=Object.assign,_={};function k(V,J,ae){this.props=V,this.context=J,this.refs=_,this.updater=ae||w}k.prototype.isReactComponent={},k.prototype.setState=function(V,J){if(typeof V!="object"&&typeof V!="function"&&V!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,V,J,"setState")},k.prototype.forceUpdate=function(V){this.updater.enqueueForceUpdate(this,V,"forceUpdate")};function C(){}C.prototype=k.prototype;function P(V,J,ae){this.props=V,this.context=J,this.refs=_,this.updater=ae||w}var M=P.prototype=new C;M.constructor=P,O(M,k.prototype),M.isPureReactComponent=!0;var Q=Array.isArray,N=Object.prototype.hasOwnProperty,G={current:null},D={key:!0,ref:!0,__self:!0,__source:!0};function b(V,J,ae){var U,$={},ee=null,pe=null;if(J!=null)for(U in J.ref!==void 0&&(pe=J.ref),J.key!==void 0&&(ee=""+J.key),J)N.call(J,U)&&!D.hasOwnProperty(U)&&($[U]=J[U]);var we=arguments.length-2;if(we===1)$.children=ae;else if(1<we){for(var xe=Array(we),ge=0;ge<we;ge++)xe[ge]=arguments[ge+2];$.children=xe}if(V&&V.defaultProps)for(U in we=V.defaultProps,we)$[U]===void 0&&($[U]=we[U]);return{$$typeof:s,type:V,key:ee,ref:pe,props:$,_owner:G.current}}function I(V,J){return{$$typeof:s,type:V.type,key:J,ref:V.ref,props:V.props,_owner:V._owner}}function B(V){return typeof V=="object"&&V!==null&&V.$$typeof===s}function j(V){var J={"=":"=0",":":"=2"};return"$"+V.replace(/[=:]/g,function(ae){return J[ae]})}var W=/\/+/g;function H(V,J){return typeof V=="object"&&V!==null&&V.key!=null?j(""+V.key):J.toString(36)}function te(V,J,ae,U,$){var ee=typeof V;(ee==="undefined"||ee==="boolean")&&(V=null);var pe=!1;if(V===null)pe=!0;else switch(ee){case"string":case"number":pe=!0;break;case"object":switch(V.$$typeof){case s:case t:pe=!0}}if(pe)return pe=V,$=$(pe),V=U===""?"."+H(pe,0):U,Q($)?(ae="",V!=null&&(ae=V.replace(W,"$&/")+"/"),te($,J,ae,"",function(ge){return ge})):$!=null&&(B($)&&($=I($,ae+(!$.key||pe&&pe.key===$.key?"":(""+$.key).replace(W,"$&/")+"/")+V)),J.push($)),1;if(pe=0,U=U===""?".":U+":",Q(V))for(var we=0;we<V.length;we++){ee=V[we];var xe=U+H(ee,we);pe+=te(ee,J,ae,xe,$)}else if(xe=m(V),typeof xe=="function")for(V=xe.call(V),we=0;!(ee=V.next()).done;)ee=ee.value,xe=U+H(ee,we++),pe+=te(ee,J,ae,xe,$);else if(ee==="object")throw J=String(V),Error("Objects are not valid as a React child (found: "+(J==="[object Object]"?"object with keys {"+Object.keys(V).join(", ")+"}":J)+"). If you meant to render a collection of children, use an array instead.");return pe}function de(V,J,ae){if(V==null)return V;var U=[],$=0;return te(V,U,"","",function(ee){return J.call(ae,ee,$++)}),U}function oe(V){if(V._status===-1){var J=V._result;J=J(),J.then(function(ae){(V._status===0||V._status===-1)&&(V._status=1,V._result=ae)},function(ae){(V._status===0||V._status===-1)&&(V._status=2,V._result=ae)}),V._status===-1&&(V._status=0,V._result=J)}if(V._status===1)return V._result.default;throw V._result}var ve={current:null},Z={transition:null},Y={ReactCurrentDispatcher:ve,ReactCurrentBatchConfig:Z,ReactCurrentOwner:G};function ie(){throw Error("act(...) is not supported in production builds of React.")}return He.Children={map:de,forEach:function(V,J,ae){de(V,function(){J.apply(this,arguments)},ae)},count:function(V){var J=0;return de(V,function(){J++}),J},toArray:function(V){return de(V,function(J){return J})||[]},only:function(V){if(!B(V))throw Error("React.Children.only expected to receive a single React element child.");return V}},He.Component=k,He.Fragment=e,He.Profiler=n,He.PureComponent=P,He.StrictMode=i,He.Suspense=a,He.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Y,He.act=ie,He.cloneElement=function(V,J,ae){if(V==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+V+".");var U=O({},V.props),$=V.key,ee=V.ref,pe=V._owner;if(J!=null){if(J.ref!==void 0&&(ee=J.ref,pe=G.current),J.key!==void 0&&($=""+J.key),V.type&&V.type.defaultProps)var we=V.type.defaultProps;for(xe in J)N.call(J,xe)&&!D.hasOwnProperty(xe)&&(U[xe]=J[xe]===void 0&&we!==void 0?we[xe]:J[xe])}var xe=arguments.length-2;if(xe===1)U.children=ae;else if(1<xe){we=Array(xe);for(var ge=0;ge<xe;ge++)we[ge]=arguments[ge+2];U.children=we}return{$$typeof:s,type:V.type,key:$,ref:ee,props:U,_owner:pe}},He.createContext=function(V){return V={$$typeof:o,_currentValue:V,_currentValue2:V,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},V.Provider={$$typeof:r,_context:V},V.Consumer=V},He.createElement=b,He.createFactory=function(V){var J=b.bind(null,V);return J.type=V,J},He.createRef=function(){return{current:null}},He.forwardRef=function(V){return{$$typeof:l,render:V}},He.isValidElement=B,He.lazy=function(V){return{$$typeof:h,_payload:{_status:-1,_result:V},_init:oe}},He.memo=function(V,J){return{$$typeof:c,type:V,compare:J===void 0?null:J}},He.startTransition=function(V){var J=Z.transition;Z.transition={};try{V()}finally{Z.transition=J}},He.unstable_act=ie,He.useCallback=function(V,J){return ve.current.useCallback(V,J)},He.useContext=function(V){return ve.current.useContext(V)},He.useDebugValue=function(){},He.useDeferredValue=function(V){return ve.current.useDeferredValue(V)},He.useEffect=function(V,J){return ve.current.useEffect(V,J)},He.useId=function(){return ve.current.useId()},He.useImperativeHandle=function(V,J,ae){return ve.current.useImperativeHandle(V,J,ae)},He.useInsertionEffect=function(V,J){return ve.current.useInsertionEffect(V,J)},He.useLayoutEffect=function(V,J){return ve.current.useLayoutEffect(V,J)},He.useMemo=function(V,J){return ve.current.useMemo(V,J)},He.useReducer=function(V,J,ae){return ve.current.useReducer(V,J,ae)},He.useRef=function(V){return ve.current.useRef(V)},He.useState=function(V){return ve.current.useState(V)},He.useSyncExternalStore=function(V,J,ae){return ve.current.useSyncExternalStore(V,J,ae)},He.useTransition=function(){return ve.current.useTransition()},He.version="18.3.1",He}var uS;function kO(){return uS||(uS=1,Bw.exports=VB()),Bw.exports}/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var hS;function MB(){if(hS)return ku;hS=1;var s=kO(),t=Symbol.for("react.element"),e=Symbol.for("react.fragment"),i=Object.prototype.hasOwnProperty,n=s.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,r={key:!0,ref:!0,__self:!0,__source:!0};function o(l,a,c){var h,f={},m=null,w=null;c!==void 0&&(m=""+c),a.key!==void 0&&(m=""+a.key),a.ref!==void 0&&(w=a.ref);for(h in a)i.call(a,h)&&!r.hasOwnProperty(h)&&(f[h]=a[h]);if(l&&l.defaultProps)for(h in a=l.defaultProps,a)f[h]===void 0&&(f[h]=a[h]);return{$$typeof:t,type:l,key:m,ref:w,props:f,_owner:n.current}}return ku.Fragment=e,ku.jsx=o,ku.jsxs=o,ku}var dS;function LB(){return dS||(dS=1,Lw.exports=MB()),Lw.exports}var ml=LB(),pn=kO();const ko=ld(pn);var Nf={},$w={exports:{}},dn={},Dw={exports:{}},Qw={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var fS;function BB(){return fS||(fS=1,function(s){function t(Z,Y){var ie=Z.length;Z.push(Y);e:for(;0<ie;){var V=ie-1>>>1,J=Z[V];if(0<n(J,Y))Z[V]=Y,Z[ie]=J,ie=V;else break e}}function e(Z){return Z.length===0?null:Z[0]}function i(Z){if(Z.length===0)return null;var Y=Z[0],ie=Z.pop();if(ie!==Y){Z[0]=ie;e:for(var V=0,J=Z.length,ae=J>>>1;V<ae;){var U=2*(V+1)-1,$=Z[U],ee=U+1,pe=Z[ee];if(0>n($,ie))ee<J&&0>n(pe,$)?(Z[V]=pe,Z[ee]=ie,V=ee):(Z[V]=$,Z[U]=ie,V=U);else if(ee<J&&0>n(pe,ie))Z[V]=pe,Z[ee]=ie,V=ee;else break e}}return Y}function n(Z,Y){var ie=Z.sortIndex-Y.sortIndex;return ie!==0?ie:Z.id-Y.id}if(typeof performance=="object"&&typeof performance.now=="function"){var r=performance;s.unstable_now=function(){return r.now()}}else{var o=Date,l=o.now();s.unstable_now=function(){return o.now()-l}}var a=[],c=[],h=1,f=null,m=3,w=!1,O=!1,_=!1,k=typeof setTimeout=="function"?setTimeout:null,C=typeof clearTimeout=="function"?clearTimeout:null,P=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function M(Z){for(var Y=e(c);Y!==null;){if(Y.callback===null)i(c);else if(Y.startTime<=Z)i(c),Y.sortIndex=Y.expirationTime,t(a,Y);else break;Y=e(c)}}function Q(Z){if(_=!1,M(Z),!O)if(e(a)!==null)O=!0,oe(N);else{var Y=e(c);Y!==null&&ve(Q,Y.startTime-Z)}}function N(Z,Y){O=!1,_&&(_=!1,C(b),b=-1),w=!0;var ie=m;try{for(M(Y),f=e(a);f!==null&&(!(f.expirationTime>Y)||Z&&!j());){var V=f.callback;if(typeof V=="function"){f.callback=null,m=f.priorityLevel;var J=V(f.expirationTime<=Y);Y=s.unstable_now(),typeof J=="function"?f.callback=J:f===e(a)&&i(a),M(Y)}else i(a);f=e(a)}if(f!==null)var ae=!0;else{var U=e(c);U!==null&&ve(Q,U.startTime-Y),ae=!1}return ae}finally{f=null,m=ie,w=!1}}var G=!1,D=null,b=-1,I=5,B=-1;function j(){return!(s.unstable_now()-B<I)}function W(){if(D!==null){var Z=s.unstable_now();B=Z;var Y=!0;try{Y=D(!0,Z)}finally{Y?H():(G=!1,D=null)}}else G=!1}var H;if(typeof P=="function")H=function(){P(W)};else if(typeof MessageChannel<"u"){var te=new MessageChannel,de=te.port2;te.port1.onmessage=W,H=function(){de.postMessage(null)}}else H=function(){k(W,0)};function oe(Z){D=Z,G||(G=!0,H())}function ve(Z,Y){b=k(function(){Z(s.unstable_now())},Y)}s.unstable_IdlePriority=5,s.unstable_ImmediatePriority=1,s.unstable_LowPriority=4,s.unstable_NormalPriority=3,s.unstable_Profiling=null,s.unstable_UserBlockingPriority=2,s.unstable_cancelCallback=function(Z){Z.callback=null},s.unstable_continueExecution=function(){O||w||(O=!0,oe(N))},s.unstable_forceFrameRate=function(Z){0>Z||125<Z?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):I=0<Z?Math.floor(1e3/Z):5},s.unstable_getCurrentPriorityLevel=function(){return m},s.unstable_getFirstCallbackNode=function(){return e(a)},s.unstable_next=function(Z){switch(m){case 1:case 2:case 3:var Y=3;break;default:Y=m}var ie=m;m=Y;try{return Z()}finally{m=ie}},s.unstable_pauseExecution=function(){},s.unstable_requestPaint=function(){},s.unstable_runWithPriority=function(Z,Y){switch(Z){case 1:case 2:case 3:case 4:case 5:break;default:Z=3}var ie=m;m=Z;try{return Y()}finally{m=ie}},s.unstable_scheduleCallback=function(Z,Y,ie){var V=s.unstable_now();switch(typeof ie=="object"&&ie!==null?(ie=ie.delay,ie=typeof ie=="number"&&0<ie?V+ie:V):ie=V,Z){case 1:var J=-1;break;case 2:J=250;break;case 5:J=1073741823;break;case 4:J=1e4;break;default:J=5e3}return J=ie+J,Z={id:h++,callback:Y,priorityLevel:Z,startTime:ie,expirationTime:J,sortIndex:-1},ie>V?(Z.sortIndex=ie,t(c,Z),e(a)===null&&Z===e(c)&&(_?(C(b),b=-1):_=!0,ve(Q,ie-V))):(Z.sortIndex=J,t(a,Z),O||w||(O=!0,oe(N))),Z},s.unstable_shouldYield=j,s.unstable_wrapCallback=function(Z){var Y=m;return function(){var ie=m;m=Y;try{return Z.apply(this,arguments)}finally{m=ie}}}}(Qw)),Qw}var mS;function $B(){return mS||(mS=1,Dw.exports=BB()),Dw.exports}/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var gS;function DB(){if(gS)return dn;gS=1;var s=kO(),t=$B();function e(u){for(var d="https://reactjs.org/docs/error-decoder.html?invariant="+u,g=1;g<arguments.length;g++)d+="&args[]="+encodeURIComponent(arguments[g]);return"Minified React error #"+u+"; visit "+d+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var i=new Set,n={};function r(u,d){o(u,d),o(u+"Capture",d)}function o(u,d){for(n[u]=d,u=0;u<d.length;u++)i.add(d[u])}var l=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),a=Object.prototype.hasOwnProperty,c=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,h={},f={};function m(u){return a.call(f,u)?!0:a.call(h,u)?!1:c.test(u)?f[u]=!0:(h[u]=!0,!1)}function w(u,d,g,x){if(g!==null&&g.type===0)return!1;switch(typeof d){case"function":case"symbol":return!0;case"boolean":return x?!1:g!==null?!g.acceptsBooleans:(u=u.toLowerCase().slice(0,5),u!=="data-"&&u!=="aria-");default:return!1}}function O(u,d,g,x){if(d===null||typeof d>"u"||w(u,d,g,x))return!0;if(x)return!1;if(g!==null)switch(g.type){case 3:return!d;case 4:return d===!1;case 5:return isNaN(d);case 6:return isNaN(d)||1>d}return!1}function _(u,d,g,x,y,v,S){this.acceptsBooleans=d===2||d===3||d===4,this.attributeName=x,this.attributeNamespace=y,this.mustUseProperty=g,this.propertyName=u,this.type=d,this.sanitizeURL=v,this.removeEmptyString=S}var k={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(u){k[u]=new _(u,0,!1,u,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(u){var d=u[0];k[d]=new _(d,1,!1,u[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(u){k[u]=new _(u,2,!1,u.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(u){k[u]=new _(u,2,!1,u,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(u){k[u]=new _(u,3,!1,u.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(u){k[u]=new _(u,3,!0,u,null,!1,!1)}),["capture","download"].forEach(function(u){k[u]=new _(u,4,!1,u,null,!1,!1)}),["cols","rows","size","span"].forEach(function(u){k[u]=new _(u,6,!1,u,null,!1,!1)}),["rowSpan","start"].forEach(function(u){k[u]=new _(u,5,!1,u.toLowerCase(),null,!1,!1)});var C=/[\-:]([a-z])/g;function P(u){return u[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(u){var d=u.replace(C,P);k[d]=new _(d,1,!1,u,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(u){var d=u.replace(C,P);k[d]=new _(d,1,!1,u,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(u){var d=u.replace(C,P);k[d]=new _(d,1,!1,u,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(u){k[u]=new _(u,1,!1,u.toLowerCase(),null,!1,!1)}),k.xlinkHref=new _("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(u){k[u]=new _(u,1,!1,u.toLowerCase(),null,!0,!0)});function M(u,d,g,x){var y=k.hasOwnProperty(d)?k[d]:null;(y!==null?y.type!==0:x||!(2<d.length)||d[0]!=="o"&&d[0]!=="O"||d[1]!=="n"&&d[1]!=="N")&&(O(d,g,y,x)&&(g=null),x||y===null?m(d)&&(g===null?u.removeAttribute(d):u.setAttribute(d,""+g)):y.mustUseProperty?u[y.propertyName]=g===null?y.type===3?!1:"":g:(d=y.attributeName,x=y.attributeNamespace,g===null?u.removeAttribute(d):(y=y.type,g=y===3||y===4&&g===!0?"":""+g,x?u.setAttributeNS(x,d,g):u.setAttribute(d,g))))}var Q=s.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,N=Symbol.for("react.element"),G=Symbol.for("react.portal"),D=Symbol.for("react.fragment"),b=Symbol.for("react.strict_mode"),I=Symbol.for("react.profiler"),B=Symbol.for("react.provider"),j=Symbol.for("react.context"),W=Symbol.for("react.forward_ref"),H=Symbol.for("react.suspense"),te=Symbol.for("react.suspense_list"),de=Symbol.for("react.memo"),oe=Symbol.for("react.lazy"),ve=Symbol.for("react.offscreen"),Z=Symbol.iterator;function Y(u){return u===null||typeof u!="object"?null:(u=Z&&u[Z]||u["@@iterator"],typeof u=="function"?u:null)}var ie=Object.assign,V;function J(u){if(V===void 0)try{throw Error()}catch(g){var d=g.stack.trim().match(/\n( *(at )?)/);V=d&&d[1]||""}return`
`+V+u}var ae=!1;function U(u,d){if(!u||ae)return"";ae=!0;var g=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(d)if(d=function(){throw Error()},Object.defineProperty(d.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(d,[])}catch(X){var x=X}Reflect.construct(u,[],d)}else{try{d.call()}catch(X){x=X}u.call(d.prototype)}else{try{throw Error()}catch(X){x=X}u()}}catch(X){if(X&&x&&typeof X.stack=="string"){for(var y=X.stack.split(`
`),v=x.stack.split(`
`),S=y.length-1,A=v.length-1;1<=S&&0<=A&&y[S]!==v[A];)A--;for(;1<=S&&0<=A;S--,A--)if(y[S]!==v[A]){if(S!==1||A!==1)do if(S--,A--,0>A||y[S]!==v[A]){var R=`
`+y[S].replace(" at new "," at ");return u.displayName&&R.includes("<anonymous>")&&(R=R.replace("<anonymous>",u.displayName)),R}while(1<=S&&0<=A);break}}}finally{ae=!1,Error.prepareStackTrace=g}return(u=u?u.displayName||u.name:"")?J(u):""}function $(u){switch(u.tag){case 5:return J(u.type);case 16:return J("Lazy");case 13:return J("Suspense");case 19:return J("SuspenseList");case 0:case 2:case 15:return u=U(u.type,!1),u;case 11:return u=U(u.type.render,!1),u;case 1:return u=U(u.type,!0),u;default:return""}}function ee(u){if(u==null)return null;if(typeof u=="function")return u.displayName||u.name||null;if(typeof u=="string")return u;switch(u){case D:return"Fragment";case G:return"Portal";case I:return"Profiler";case b:return"StrictMode";case H:return"Suspense";case te:return"SuspenseList"}if(typeof u=="object")switch(u.$$typeof){case j:return(u.displayName||"Context")+".Consumer";case B:return(u._context.displayName||"Context")+".Provider";case W:var d=u.render;return u=u.displayName,u||(u=d.displayName||d.name||"",u=u!==""?"ForwardRef("+u+")":"ForwardRef"),u;case de:return d=u.displayName||null,d!==null?d:ee(u.type)||"Memo";case oe:d=u._payload,u=u._init;try{return ee(u(d))}catch{}}return null}function pe(u){var d=u.type;switch(u.tag){case 24:return"Cache";case 9:return(d.displayName||"Context")+".Consumer";case 10:return(d._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return u=d.render,u=u.displayName||u.name||"",d.displayName||(u!==""?"ForwardRef("+u+")":"ForwardRef");case 7:return"Fragment";case 5:return d;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return ee(d);case 8:return d===b?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof d=="function")return d.displayName||d.name||null;if(typeof d=="string")return d}return null}function we(u){switch(typeof u){case"boolean":case"number":case"string":case"undefined":return u;case"object":return u;default:return""}}function xe(u){var d=u.type;return(u=u.nodeName)&&u.toLowerCase()==="input"&&(d==="checkbox"||d==="radio")}function ge(u){var d=xe(u)?"checked":"value",g=Object.getOwnPropertyDescriptor(u.constructor.prototype,d),x=""+u[d];if(!u.hasOwnProperty(d)&&typeof g<"u"&&typeof g.get=="function"&&typeof g.set=="function"){var y=g.get,v=g.set;return Object.defineProperty(u,d,{configurable:!0,get:function(){return y.call(this)},set:function(S){x=""+S,v.call(this,S)}}),Object.defineProperty(u,d,{enumerable:g.enumerable}),{getValue:function(){return x},setValue:function(S){x=""+S},stopTracking:function(){u._valueTracker=null,delete u[d]}}}}function Qe(u){u._valueTracker||(u._valueTracker=ge(u))}function Me(u){if(!u)return!1;var d=u._valueTracker;if(!d)return!0;var g=d.getValue(),x="";return u&&(x=xe(u)?u.checked?"true":"false":u.value),u=x,u!==g?(d.setValue(u),!0):!1}function qe(u){if(u=u||(typeof document<"u"?document:void 0),typeof u>"u")return null;try{return u.activeElement||u.body}catch{return u.body}}function je(u,d){var g=d.checked;return ie({},d,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:g??u._wrapperState.initialChecked})}function ki(u,d){var g=d.defaultValue==null?"":d.defaultValue,x=d.checked!=null?d.checked:d.defaultChecked;g=we(d.value!=null?d.value:g),u._wrapperState={initialChecked:x,initialValue:g,controlled:d.type==="checkbox"||d.type==="radio"?d.checked!=null:d.value!=null}}function ri(u,d){d=d.checked,d!=null&&M(u,"checked",d,!1)}function Xe(u,d){ri(u,d);var g=we(d.value),x=d.type;if(g!=null)x==="number"?(g===0&&u.value===""||u.value!=g)&&(u.value=""+g):u.value!==""+g&&(u.value=""+g);else if(x==="submit"||x==="reset"){u.removeAttribute("value");return}d.hasOwnProperty("value")?tt(u,d.type,g):d.hasOwnProperty("defaultValue")&&tt(u,d.type,we(d.defaultValue)),d.checked==null&&d.defaultChecked!=null&&(u.defaultChecked=!!d.defaultChecked)}function mi(u,d,g){if(d.hasOwnProperty("value")||d.hasOwnProperty("defaultValue")){var x=d.type;if(!(x!=="submit"&&x!=="reset"||d.value!==void 0&&d.value!==null))return;d=""+u._wrapperState.initialValue,g||d===u.value||(u.value=d),u.defaultValue=d}g=u.name,g!==""&&(u.name=""),u.defaultChecked=!!u._wrapperState.initialChecked,g!==""&&(u.name=g)}function tt(u,d,g){(d!=="number"||qe(u.ownerDocument)!==u)&&(g==null?u.defaultValue=""+u._wrapperState.initialValue:u.defaultValue!==""+g&&(u.defaultValue=""+g))}var it=Array.isArray;function Xi(u,d,g,x){if(u=u.options,d){d={};for(var y=0;y<g.length;y++)d["$"+g[y]]=!0;for(g=0;g<u.length;g++)y=d.hasOwnProperty("$"+u[g].value),u[g].selected!==y&&(u[g].selected=y),y&&x&&(u[g].defaultSelected=!0)}else{for(g=""+we(g),d=null,y=0;y<u.length;y++){if(u[y].value===g){u[y].selected=!0,x&&(u[y].defaultSelected=!0);return}d!==null||u[y].disabled||(d=u[y])}d!==null&&(d.selected=!0)}}function Vi(u,d){if(d.dangerouslySetInnerHTML!=null)throw Error(e(91));return ie({},d,{value:void 0,defaultValue:void 0,children:""+u._wrapperState.initialValue})}function oi(u,d){var g=d.value;if(g==null){if(g=d.children,d=d.defaultValue,g!=null){if(d!=null)throw Error(e(92));if(it(g)){if(1<g.length)throw Error(e(93));g=g[0]}d=g}d==null&&(d=""),g=d}u._wrapperState={initialValue:we(g)}}function Ge(u,d){var g=we(d.value),x=we(d.defaultValue);g!=null&&(g=""+g,g!==u.value&&(u.value=g),d.defaultValue==null&&u.defaultValue!==g&&(u.defaultValue=g)),x!=null&&(u.defaultValue=""+x)}function ii(u){var d=u.textContent;d===u._wrapperState.initialValue&&d!==""&&d!==null&&(u.value=d)}function Ze(u){switch(u){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Si(u,d){return u==null||u==="http://www.w3.org/1999/xhtml"?Ze(d):u==="http://www.w3.org/2000/svg"&&d==="foreignObject"?"http://www.w3.org/1999/xhtml":u}var It,vs=function(u){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(d,g,x,y){MSApp.execUnsafeLocalFunction(function(){return u(d,g,x,y)})}:u}(function(u,d){if(u.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in u)u.innerHTML=d;else{for(It=It||document.createElement("div"),It.innerHTML="<svg>"+d.valueOf().toString()+"</svg>",d=It.firstChild;u.firstChild;)u.removeChild(u.firstChild);for(;d.firstChild;)u.appendChild(d.firstChild)}});function Tn(u,d){if(d){var g=u.firstChild;if(g&&g===u.lastChild&&g.nodeType===3){g.nodeValue=d;return}}u.textContent=d}var Fs={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},ut=["Webkit","ms","Moz","O"];Object.keys(Fs).forEach(function(u){ut.forEach(function(d){d=d+u.charAt(0).toUpperCase()+u.substring(1),Fs[d]=Fs[u]})});function ft(u,d,g){return d==null||typeof d=="boolean"||d===""?"":g||typeof d!="number"||d===0||Fs.hasOwnProperty(u)&&Fs[u]?(""+d).trim():d+"px"}function Nc(u,d){u=u.style;for(var g in d)if(d.hasOwnProperty(g)){var x=g.indexOf("--")===0,y=ft(g,d[g],x);g==="float"&&(g="cssFloat"),x?u.setProperty(g,y):u[g]=y}}var _s=ie({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Fc(u,d){if(d){if(_s[u]&&(d.children!=null||d.dangerouslySetInnerHTML!=null))throw Error(e(137,u));if(d.dangerouslySetInnerHTML!=null){if(d.children!=null)throw Error(e(60));if(typeof d.dangerouslySetInnerHTML!="object"||!("__html"in d.dangerouslySetInnerHTML))throw Error(e(61))}if(d.style!=null&&typeof d.style!="object")throw Error(e(62))}}function Zo(u,d){if(u.indexOf("-")===-1)return typeof d.is=="string";switch(u){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Xp=null;function Gp(u){return u=u.target||u.srcElement||window,u.correspondingUseElement&&(u=u.correspondingUseElement),u.nodeType===3?u.parentNode:u}var Yp=null,Jl=null,ea=null;function Cv(u){if(u=cu(u)){if(typeof Yp!="function")throw Error(e(280));var d=u.stateNode;d&&(d=ef(d),Yp(u.stateNode,u.type,d))}}function Pv(u){Jl?ea?ea.push(u):ea=[u]:Jl=u}function Tv(){if(Jl){var u=Jl,d=ea;if(ea=Jl=null,Cv(u),d)for(u=0;u<d.length;u++)Cv(d[u])}}function Ev(u,d){return u(d)}function Av(){}var Kp=!1;function Iv(u,d,g){if(Kp)return u(d,g);Kp=!0;try{return Ev(u,d,g)}finally{Kp=!1,(Jl!==null||ea!==null)&&(Av(),Tv())}}function zc(u,d){var g=u.stateNode;if(g===null)return null;var x=ef(g);if(x===null)return null;g=x[d];e:switch(d){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(x=!x.disabled)||(u=u.type,x=!(u==="button"||u==="input"||u==="select"||u==="textarea")),u=!x;break e;default:u=!1}if(u)return null;if(g&&typeof g!="function")throw Error(e(231,d,typeof g));return g}var Jp=!1;if(l)try{var Wc={};Object.defineProperty(Wc,"passive",{get:function(){Jp=!0}}),window.addEventListener("test",Wc,Wc),window.removeEventListener("test",Wc,Wc)}catch{Jp=!1}function BM(u,d,g,x,y,v,S,A,R){var X=Array.prototype.slice.call(arguments,3);try{d.apply(g,X)}catch(le){this.onError(le)}}var Uc=!1,Rd=null,Vd=!1,e0=null,$M={onError:function(u){Uc=!0,Rd=u}};function DM(u,d,g,x,y,v,S,A,R){Uc=!1,Rd=null,BM.apply($M,arguments)}function QM(u,d,g,x,y,v,S,A,R){if(DM.apply(this,arguments),Uc){if(Uc){var X=Rd;Uc=!1,Rd=null}else throw Error(e(198));Vd||(Vd=!0,e0=X)}}function Ho(u){var d=u,g=u;if(u.alternate)for(;d.return;)d=d.return;else{u=d;do d=u,(d.flags&4098)!==0&&(g=d.return),u=d.return;while(u)}return d.tag===3?g:null}function Rv(u){if(u.tag===13){var d=u.memoizedState;if(d===null&&(u=u.alternate,u!==null&&(d=u.memoizedState)),d!==null)return d.dehydrated}return null}function Vv(u){if(Ho(u)!==u)throw Error(e(188))}function NM(u){var d=u.alternate;if(!d){if(d=Ho(u),d===null)throw Error(e(188));return d!==u?null:u}for(var g=u,x=d;;){var y=g.return;if(y===null)break;var v=y.alternate;if(v===null){if(x=y.return,x!==null){g=x;continue}break}if(y.child===v.child){for(v=y.child;v;){if(v===g)return Vv(y),u;if(v===x)return Vv(y),d;v=v.sibling}throw Error(e(188))}if(g.return!==x.return)g=y,x=v;else{for(var S=!1,A=y.child;A;){if(A===g){S=!0,g=y,x=v;break}if(A===x){S=!0,x=y,g=v;break}A=A.sibling}if(!S){for(A=v.child;A;){if(A===g){S=!0,g=v,x=y;break}if(A===x){S=!0,x=v,g=y;break}A=A.sibling}if(!S)throw Error(e(189))}}if(g.alternate!==x)throw Error(e(190))}if(g.tag!==3)throw Error(e(188));return g.stateNode.current===g?u:d}function Mv(u){return u=NM(u),u!==null?Lv(u):null}function Lv(u){if(u.tag===5||u.tag===6)return u;for(u=u.child;u!==null;){var d=Lv(u);if(d!==null)return d;u=u.sibling}return null}var Bv=t.unstable_scheduleCallback,$v=t.unstable_cancelCallback,FM=t.unstable_shouldYield,zM=t.unstable_requestPaint,qt=t.unstable_now,WM=t.unstable_getCurrentPriorityLevel,t0=t.unstable_ImmediatePriority,Dv=t.unstable_UserBlockingPriority,Md=t.unstable_NormalPriority,UM=t.unstable_LowPriority,Qv=t.unstable_IdlePriority,Ld=null,zs=null;function ZM(u){if(zs&&typeof zs.onCommitFiberRoot=="function")try{zs.onCommitFiberRoot(Ld,u,void 0,(u.current.flags&128)===128)}catch{}}var ks=Math.clz32?Math.clz32:jM,HM=Math.log,qM=Math.LN2;function jM(u){return u>>>=0,u===0?32:31-(HM(u)/qM|0)|0}var Bd=64,$d=4194304;function Zc(u){switch(u&-u){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return u&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return u&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return u}}function Dd(u,d){var g=u.pendingLanes;if(g===0)return 0;var x=0,y=u.suspendedLanes,v=u.pingedLanes,S=g&268435455;if(S!==0){var A=S&~y;A!==0?x=Zc(A):(v&=S,v!==0&&(x=Zc(v)))}else S=g&~y,S!==0?x=Zc(S):v!==0&&(x=Zc(v));if(x===0)return 0;if(d!==0&&d!==x&&(d&y)===0&&(y=x&-x,v=d&-d,y>=v||y===16&&(v&4194240)!==0))return d;if((x&4)!==0&&(x|=g&16),d=u.entangledLanes,d!==0)for(u=u.entanglements,d&=x;0<d;)g=31-ks(d),y=1<<g,x|=u[g],d&=~y;return x}function XM(u,d){switch(u){case 1:case 2:case 4:return d+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return d+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function GM(u,d){for(var g=u.suspendedLanes,x=u.pingedLanes,y=u.expirationTimes,v=u.pendingLanes;0<v;){var S=31-ks(v),A=1<<S,R=y[S];R===-1?((A&g)===0||(A&x)!==0)&&(y[S]=XM(A,d)):R<=d&&(u.expiredLanes|=A),v&=~A}}function i0(u){return u=u.pendingLanes&-1073741825,u!==0?u:u&1073741824?1073741824:0}function Nv(){var u=Bd;return Bd<<=1,(Bd&4194240)===0&&(Bd=64),u}function n0(u){for(var d=[],g=0;31>g;g++)d.push(u);return d}function Hc(u,d,g){u.pendingLanes|=d,d!==536870912&&(u.suspendedLanes=0,u.pingedLanes=0),u=u.eventTimes,d=31-ks(d),u[d]=g}function YM(u,d){var g=u.pendingLanes&~d;u.pendingLanes=d,u.suspendedLanes=0,u.pingedLanes=0,u.expiredLanes&=d,u.mutableReadLanes&=d,u.entangledLanes&=d,d=u.entanglements;var x=u.eventTimes;for(u=u.expirationTimes;0<g;){var y=31-ks(g),v=1<<y;d[y]=0,x[y]=-1,u[y]=-1,g&=~v}}function s0(u,d){var g=u.entangledLanes|=d;for(u=u.entanglements;g;){var x=31-ks(g),y=1<<x;y&d|u[x]&d&&(u[x]|=d),g&=~y}}var xt=0;function Fv(u){return u&=-u,1<u?4<u?(u&268435455)!==0?16:536870912:4:1}var zv,r0,Wv,Uv,Zv,o0=!1,Qd=[],Hr=null,qr=null,jr=null,qc=new Map,jc=new Map,Xr=[],KM="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Hv(u,d){switch(u){case"focusin":case"focusout":Hr=null;break;case"dragenter":case"dragleave":qr=null;break;case"mouseover":case"mouseout":jr=null;break;case"pointerover":case"pointerout":qc.delete(d.pointerId);break;case"gotpointercapture":case"lostpointercapture":jc.delete(d.pointerId)}}function Xc(u,d,g,x,y,v){return u===null||u.nativeEvent!==v?(u={blockedOn:d,domEventName:g,eventSystemFlags:x,nativeEvent:v,targetContainers:[y]},d!==null&&(d=cu(d),d!==null&&r0(d)),u):(u.eventSystemFlags|=x,d=u.targetContainers,y!==null&&d.indexOf(y)===-1&&d.push(y),u)}function JM(u,d,g,x,y){switch(d){case"focusin":return Hr=Xc(Hr,u,d,g,x,y),!0;case"dragenter":return qr=Xc(qr,u,d,g,x,y),!0;case"mouseover":return jr=Xc(jr,u,d,g,x,y),!0;case"pointerover":var v=y.pointerId;return qc.set(v,Xc(qc.get(v)||null,u,d,g,x,y)),!0;case"gotpointercapture":return v=y.pointerId,jc.set(v,Xc(jc.get(v)||null,u,d,g,x,y)),!0}return!1}function qv(u){var d=qo(u.target);if(d!==null){var g=Ho(d);if(g!==null){if(d=g.tag,d===13){if(d=Rv(g),d!==null){u.blockedOn=d,Zv(u.priority,function(){Wv(g)});return}}else if(d===3&&g.stateNode.current.memoizedState.isDehydrated){u.blockedOn=g.tag===3?g.stateNode.containerInfo:null;return}}}u.blockedOn=null}function Nd(u){if(u.blockedOn!==null)return!1;for(var d=u.targetContainers;0<d.length;){var g=a0(u.domEventName,u.eventSystemFlags,d[0],u.nativeEvent);if(g===null){g=u.nativeEvent;var x=new g.constructor(g.type,g);Xp=x,g.target.dispatchEvent(x),Xp=null}else return d=cu(g),d!==null&&r0(d),u.blockedOn=g,!1;d.shift()}return!0}function jv(u,d,g){Nd(u)&&g.delete(d)}function eL(){o0=!1,Hr!==null&&Nd(Hr)&&(Hr=null),qr!==null&&Nd(qr)&&(qr=null),jr!==null&&Nd(jr)&&(jr=null),qc.forEach(jv),jc.forEach(jv)}function Gc(u,d){u.blockedOn===d&&(u.blockedOn=null,o0||(o0=!0,t.unstable_scheduleCallback(t.unstable_NormalPriority,eL)))}function Yc(u){function d(y){return Gc(y,u)}if(0<Qd.length){Gc(Qd[0],u);for(var g=1;g<Qd.length;g++){var x=Qd[g];x.blockedOn===u&&(x.blockedOn=null)}}for(Hr!==null&&Gc(Hr,u),qr!==null&&Gc(qr,u),jr!==null&&Gc(jr,u),qc.forEach(d),jc.forEach(d),g=0;g<Xr.length;g++)x=Xr[g],x.blockedOn===u&&(x.blockedOn=null);for(;0<Xr.length&&(g=Xr[0],g.blockedOn===null);)qv(g),g.blockedOn===null&&Xr.shift()}var ta=Q.ReactCurrentBatchConfig,Fd=!0;function tL(u,d,g,x){var y=xt,v=ta.transition;ta.transition=null;try{xt=1,l0(u,d,g,x)}finally{xt=y,ta.transition=v}}function iL(u,d,g,x){var y=xt,v=ta.transition;ta.transition=null;try{xt=4,l0(u,d,g,x)}finally{xt=y,ta.transition=v}}function l0(u,d,g,x){if(Fd){var y=a0(u,d,g,x);if(y===null)S0(u,d,x,zd,g),Hv(u,x);else if(JM(y,u,d,g,x))x.stopPropagation();else if(Hv(u,x),d&4&&-1<KM.indexOf(u)){for(;y!==null;){var v=cu(y);if(v!==null&&zv(v),v=a0(u,d,g,x),v===null&&S0(u,d,x,zd,g),v===y)break;y=v}y!==null&&x.stopPropagation()}else S0(u,d,x,null,g)}}var zd=null;function a0(u,d,g,x){if(zd=null,u=Gp(x),u=qo(u),u!==null)if(d=Ho(u),d===null)u=null;else if(g=d.tag,g===13){if(u=Rv(d),u!==null)return u;u=null}else if(g===3){if(d.stateNode.current.memoizedState.isDehydrated)return d.tag===3?d.stateNode.containerInfo:null;u=null}else d!==u&&(u=null);return zd=u,null}function Xv(u){switch(u){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(WM()){case t0:return 1;case Dv:return 4;case Md:case UM:return 16;case Qv:return 536870912;default:return 16}default:return 16}}var Gr=null,c0=null,Wd=null;function Gv(){if(Wd)return Wd;var u,d=c0,g=d.length,x,y="value"in Gr?Gr.value:Gr.textContent,v=y.length;for(u=0;u<g&&d[u]===y[u];u++);var S=g-u;for(x=1;x<=S&&d[g-x]===y[v-x];x++);return Wd=y.slice(u,1<x?1-x:void 0)}function Ud(u){var d=u.keyCode;return"charCode"in u?(u=u.charCode,u===0&&d===13&&(u=13)):u=d,u===10&&(u=13),32<=u||u===13?u:0}function Zd(){return!0}function Yv(){return!1}function En(u){function d(g,x,y,v,S){this._reactName=g,this._targetInst=y,this.type=x,this.nativeEvent=v,this.target=S,this.currentTarget=null;for(var A in u)u.hasOwnProperty(A)&&(g=u[A],this[A]=g?g(v):v[A]);return this.isDefaultPrevented=(v.defaultPrevented!=null?v.defaultPrevented:v.returnValue===!1)?Zd:Yv,this.isPropagationStopped=Yv,this}return ie(d.prototype,{preventDefault:function(){this.defaultPrevented=!0;var g=this.nativeEvent;g&&(g.preventDefault?g.preventDefault():typeof g.returnValue!="unknown"&&(g.returnValue=!1),this.isDefaultPrevented=Zd)},stopPropagation:function(){var g=this.nativeEvent;g&&(g.stopPropagation?g.stopPropagation():typeof g.cancelBubble!="unknown"&&(g.cancelBubble=!0),this.isPropagationStopped=Zd)},persist:function(){},isPersistent:Zd}),d}var ia={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(u){return u.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},u0=En(ia),Kc=ie({},ia,{view:0,detail:0}),nL=En(Kc),h0,d0,Jc,Hd=ie({},Kc,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:m0,button:0,buttons:0,relatedTarget:function(u){return u.relatedTarget===void 0?u.fromElement===u.srcElement?u.toElement:u.fromElement:u.relatedTarget},movementX:function(u){return"movementX"in u?u.movementX:(u!==Jc&&(Jc&&u.type==="mousemove"?(h0=u.screenX-Jc.screenX,d0=u.screenY-Jc.screenY):d0=h0=0,Jc=u),h0)},movementY:function(u){return"movementY"in u?u.movementY:d0}}),Kv=En(Hd),sL=ie({},Hd,{dataTransfer:0}),rL=En(sL),oL=ie({},Kc,{relatedTarget:0}),f0=En(oL),lL=ie({},ia,{animationName:0,elapsedTime:0,pseudoElement:0}),aL=En(lL),cL=ie({},ia,{clipboardData:function(u){return"clipboardData"in u?u.clipboardData:window.clipboardData}}),uL=En(cL),hL=ie({},ia,{data:0}),Jv=En(hL),dL={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},fL={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},mL={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function gL(u){var d=this.nativeEvent;return d.getModifierState?d.getModifierState(u):(u=mL[u])?!!d[u]:!1}function m0(){return gL}var pL=ie({},Kc,{key:function(u){if(u.key){var d=dL[u.key]||u.key;if(d!=="Unidentified")return d}return u.type==="keypress"?(u=Ud(u),u===13?"Enter":String.fromCharCode(u)):u.type==="keydown"||u.type==="keyup"?fL[u.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:m0,charCode:function(u){return u.type==="keypress"?Ud(u):0},keyCode:function(u){return u.type==="keydown"||u.type==="keyup"?u.keyCode:0},which:function(u){return u.type==="keypress"?Ud(u):u.type==="keydown"||u.type==="keyup"?u.keyCode:0}}),wL=En(pL),xL=ie({},Hd,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),e_=En(xL),bL=ie({},Kc,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:m0}),OL=En(bL),yL=ie({},ia,{propertyName:0,elapsedTime:0,pseudoElement:0}),vL=En(yL),_L=ie({},Hd,{deltaX:function(u){return"deltaX"in u?u.deltaX:"wheelDeltaX"in u?-u.wheelDeltaX:0},deltaY:function(u){return"deltaY"in u?u.deltaY:"wheelDeltaY"in u?-u.wheelDeltaY:"wheelDelta"in u?-u.wheelDelta:0},deltaZ:0,deltaMode:0}),kL=En(_L),SL=[9,13,27,32],g0=l&&"CompositionEvent"in window,eu=null;l&&"documentMode"in document&&(eu=document.documentMode);var CL=l&&"TextEvent"in window&&!eu,t_=l&&(!g0||eu&&8<eu&&11>=eu),i_=" ",n_=!1;function s_(u,d){switch(u){case"keyup":return SL.indexOf(d.keyCode)!==-1;case"keydown":return d.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function r_(u){return u=u.detail,typeof u=="object"&&"data"in u?u.data:null}var na=!1;function PL(u,d){switch(u){case"compositionend":return r_(d);case"keypress":return d.which!==32?null:(n_=!0,i_);case"textInput":return u=d.data,u===i_&&n_?null:u;default:return null}}function TL(u,d){if(na)return u==="compositionend"||!g0&&s_(u,d)?(u=Gv(),Wd=c0=Gr=null,na=!1,u):null;switch(u){case"paste":return null;case"keypress":if(!(d.ctrlKey||d.altKey||d.metaKey)||d.ctrlKey&&d.altKey){if(d.char&&1<d.char.length)return d.char;if(d.which)return String.fromCharCode(d.which)}return null;case"compositionend":return t_&&d.locale!=="ko"?null:d.data;default:return null}}var EL={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function o_(u){var d=u&&u.nodeName&&u.nodeName.toLowerCase();return d==="input"?!!EL[u.type]:d==="textarea"}function l_(u,d,g,x){Pv(x),d=Yd(d,"onChange"),0<d.length&&(g=new u0("onChange","change",null,g,x),u.push({event:g,listeners:d}))}var tu=null,iu=null;function AL(u){S_(u,0)}function qd(u){var d=aa(u);if(Me(d))return u}function IL(u,d){if(u==="change")return d}var a_=!1;if(l){var p0;if(l){var w0="oninput"in document;if(!w0){var c_=document.createElement("div");c_.setAttribute("oninput","return;"),w0=typeof c_.oninput=="function"}p0=w0}else p0=!1;a_=p0&&(!document.documentMode||9<document.documentMode)}function u_(){tu&&(tu.detachEvent("onpropertychange",h_),iu=tu=null)}function h_(u){if(u.propertyName==="value"&&qd(iu)){var d=[];l_(d,iu,u,Gp(u)),Iv(AL,d)}}function RL(u,d,g){u==="focusin"?(u_(),tu=d,iu=g,tu.attachEvent("onpropertychange",h_)):u==="focusout"&&u_()}function VL(u){if(u==="selectionchange"||u==="keyup"||u==="keydown")return qd(iu)}function ML(u,d){if(u==="click")return qd(d)}function LL(u,d){if(u==="input"||u==="change")return qd(d)}function BL(u,d){return u===d&&(u!==0||1/u===1/d)||u!==u&&d!==d}var Ss=typeof Object.is=="function"?Object.is:BL;function nu(u,d){if(Ss(u,d))return!0;if(typeof u!="object"||u===null||typeof d!="object"||d===null)return!1;var g=Object.keys(u),x=Object.keys(d);if(g.length!==x.length)return!1;for(x=0;x<g.length;x++){var y=g[x];if(!a.call(d,y)||!Ss(u[y],d[y]))return!1}return!0}function d_(u){for(;u&&u.firstChild;)u=u.firstChild;return u}function f_(u,d){var g=d_(u);u=0;for(var x;g;){if(g.nodeType===3){if(x=u+g.textContent.length,u<=d&&x>=d)return{node:g,offset:d-u};u=x}e:{for(;g;){if(g.nextSibling){g=g.nextSibling;break e}g=g.parentNode}g=void 0}g=d_(g)}}function m_(u,d){return u&&d?u===d?!0:u&&u.nodeType===3?!1:d&&d.nodeType===3?m_(u,d.parentNode):"contains"in u?u.contains(d):u.compareDocumentPosition?!!(u.compareDocumentPosition(d)&16):!1:!1}function g_(){for(var u=window,d=qe();d instanceof u.HTMLIFrameElement;){try{var g=typeof d.contentWindow.location.href=="string"}catch{g=!1}if(g)u=d.contentWindow;else break;d=qe(u.document)}return d}function x0(u){var d=u&&u.nodeName&&u.nodeName.toLowerCase();return d&&(d==="input"&&(u.type==="text"||u.type==="search"||u.type==="tel"||u.type==="url"||u.type==="password")||d==="textarea"||u.contentEditable==="true")}function $L(u){var d=g_(),g=u.focusedElem,x=u.selectionRange;if(d!==g&&g&&g.ownerDocument&&m_(g.ownerDocument.documentElement,g)){if(x!==null&&x0(g)){if(d=x.start,u=x.end,u===void 0&&(u=d),"selectionStart"in g)g.selectionStart=d,g.selectionEnd=Math.min(u,g.value.length);else if(u=(d=g.ownerDocument||document)&&d.defaultView||window,u.getSelection){u=u.getSelection();var y=g.textContent.length,v=Math.min(x.start,y);x=x.end===void 0?v:Math.min(x.end,y),!u.extend&&v>x&&(y=x,x=v,v=y),y=f_(g,v);var S=f_(g,x);y&&S&&(u.rangeCount!==1||u.anchorNode!==y.node||u.anchorOffset!==y.offset||u.focusNode!==S.node||u.focusOffset!==S.offset)&&(d=d.createRange(),d.setStart(y.node,y.offset),u.removeAllRanges(),v>x?(u.addRange(d),u.extend(S.node,S.offset)):(d.setEnd(S.node,S.offset),u.addRange(d)))}}for(d=[],u=g;u=u.parentNode;)u.nodeType===1&&d.push({element:u,left:u.scrollLeft,top:u.scrollTop});for(typeof g.focus=="function"&&g.focus(),g=0;g<d.length;g++)u=d[g],u.element.scrollLeft=u.left,u.element.scrollTop=u.top}}var DL=l&&"documentMode"in document&&11>=document.documentMode,sa=null,b0=null,su=null,O0=!1;function p_(u,d,g){var x=g.window===g?g.document:g.nodeType===9?g:g.ownerDocument;O0||sa==null||sa!==qe(x)||(x=sa,"selectionStart"in x&&x0(x)?x={start:x.selectionStart,end:x.selectionEnd}:(x=(x.ownerDocument&&x.ownerDocument.defaultView||window).getSelection(),x={anchorNode:x.anchorNode,anchorOffset:x.anchorOffset,focusNode:x.focusNode,focusOffset:x.focusOffset}),su&&nu(su,x)||(su=x,x=Yd(b0,"onSelect"),0<x.length&&(d=new u0("onSelect","select",null,d,g),u.push({event:d,listeners:x}),d.target=sa)))}function jd(u,d){var g={};return g[u.toLowerCase()]=d.toLowerCase(),g["Webkit"+u]="webkit"+d,g["Moz"+u]="moz"+d,g}var ra={animationend:jd("Animation","AnimationEnd"),animationiteration:jd("Animation","AnimationIteration"),animationstart:jd("Animation","AnimationStart"),transitionend:jd("Transition","TransitionEnd")},y0={},w_={};l&&(w_=document.createElement("div").style,"AnimationEvent"in window||(delete ra.animationend.animation,delete ra.animationiteration.animation,delete ra.animationstart.animation),"TransitionEvent"in window||delete ra.transitionend.transition);function Xd(u){if(y0[u])return y0[u];if(!ra[u])return u;var d=ra[u],g;for(g in d)if(d.hasOwnProperty(g)&&g in w_)return y0[u]=d[g];return u}var x_=Xd("animationend"),b_=Xd("animationiteration"),O_=Xd("animationstart"),y_=Xd("transitionend"),v_=new Map,__="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Yr(u,d){v_.set(u,d),r(d,[u])}for(var v0=0;v0<__.length;v0++){var _0=__[v0],QL=_0.toLowerCase(),NL=_0[0].toUpperCase()+_0.slice(1);Yr(QL,"on"+NL)}Yr(x_,"onAnimationEnd"),Yr(b_,"onAnimationIteration"),Yr(O_,"onAnimationStart"),Yr("dblclick","onDoubleClick"),Yr("focusin","onFocus"),Yr("focusout","onBlur"),Yr(y_,"onTransitionEnd"),o("onMouseEnter",["mouseout","mouseover"]),o("onMouseLeave",["mouseout","mouseover"]),o("onPointerEnter",["pointerout","pointerover"]),o("onPointerLeave",["pointerout","pointerover"]),r("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),r("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),r("onBeforeInput",["compositionend","keypress","textInput","paste"]),r("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),r("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),r("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var ru="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),FL=new Set("cancel close invalid load scroll toggle".split(" ").concat(ru));function k_(u,d,g){var x=u.type||"unknown-event";u.currentTarget=g,QM(x,d,void 0,u),u.currentTarget=null}function S_(u,d){d=(d&4)!==0;for(var g=0;g<u.length;g++){var x=u[g],y=x.event;x=x.listeners;e:{var v=void 0;if(d)for(var S=x.length-1;0<=S;S--){var A=x[S],R=A.instance,X=A.currentTarget;if(A=A.listener,R!==v&&y.isPropagationStopped())break e;k_(y,A,X),v=R}else for(S=0;S<x.length;S++){if(A=x[S],R=A.instance,X=A.currentTarget,A=A.listener,R!==v&&y.isPropagationStopped())break e;k_(y,A,X),v=R}}}if(Vd)throw u=e0,Vd=!1,e0=null,u}function Ct(u,d){var g=d[I0];g===void 0&&(g=d[I0]=new Set);var x=u+"__bubble";g.has(x)||(C_(d,u,2,!1),g.add(x))}function k0(u,d,g){var x=0;d&&(x|=4),C_(g,u,x,d)}var Gd="_reactListening"+Math.random().toString(36).slice(2);function ou(u){if(!u[Gd]){u[Gd]=!0,i.forEach(function(g){g!=="selectionchange"&&(FL.has(g)||k0(g,!1,u),k0(g,!0,u))});var d=u.nodeType===9?u:u.ownerDocument;d===null||d[Gd]||(d[Gd]=!0,k0("selectionchange",!1,d))}}function C_(u,d,g,x){switch(Xv(d)){case 1:var y=tL;break;case 4:y=iL;break;default:y=l0}g=y.bind(null,d,g,u),y=void 0,!Jp||d!=="touchstart"&&d!=="touchmove"&&d!=="wheel"||(y=!0),x?y!==void 0?u.addEventListener(d,g,{capture:!0,passive:y}):u.addEventListener(d,g,!0):y!==void 0?u.addEventListener(d,g,{passive:y}):u.addEventListener(d,g,!1)}function S0(u,d,g,x,y){var v=x;if((d&1)===0&&(d&2)===0&&x!==null)e:for(;;){if(x===null)return;var S=x.tag;if(S===3||S===4){var A=x.stateNode.containerInfo;if(A===y||A.nodeType===8&&A.parentNode===y)break;if(S===4)for(S=x.return;S!==null;){var R=S.tag;if((R===3||R===4)&&(R=S.stateNode.containerInfo,R===y||R.nodeType===8&&R.parentNode===y))return;S=S.return}for(;A!==null;){if(S=qo(A),S===null)return;if(R=S.tag,R===5||R===6){x=v=S;continue e}A=A.parentNode}}x=x.return}Iv(function(){var X=v,le=Gp(g),ce=[];e:{var re=v_.get(u);if(re!==void 0){var _e=u0,Ce=u;switch(u){case"keypress":if(Ud(g)===0)break e;case"keydown":case"keyup":_e=wL;break;case"focusin":Ce="focus",_e=f0;break;case"focusout":Ce="blur",_e=f0;break;case"beforeblur":case"afterblur":_e=f0;break;case"click":if(g.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":_e=Kv;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":_e=rL;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":_e=OL;break;case x_:case b_:case O_:_e=aL;break;case y_:_e=vL;break;case"scroll":_e=nL;break;case"wheel":_e=kL;break;case"copy":case"cut":case"paste":_e=uL;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":_e=e_}var Te=(d&4)!==0,jt=!Te&&u==="scroll",z=Te?re!==null?re+"Capture":null:re;Te=[];for(var L=X,q;L!==null;){q=L;var fe=q.stateNode;if(q.tag===5&&fe!==null&&(q=fe,z!==null&&(fe=zc(L,z),fe!=null&&Te.push(lu(L,fe,q)))),jt)break;L=L.return}0<Te.length&&(re=new _e(re,Ce,null,g,le),ce.push({event:re,listeners:Te}))}}if((d&7)===0){e:{if(re=u==="mouseover"||u==="pointerover",_e=u==="mouseout"||u==="pointerout",re&&g!==Xp&&(Ce=g.relatedTarget||g.fromElement)&&(qo(Ce)||Ce[fr]))break e;if((_e||re)&&(re=le.window===le?le:(re=le.ownerDocument)?re.defaultView||re.parentWindow:window,_e?(Ce=g.relatedTarget||g.toElement,_e=X,Ce=Ce?qo(Ce):null,Ce!==null&&(jt=Ho(Ce),Ce!==jt||Ce.tag!==5&&Ce.tag!==6)&&(Ce=null)):(_e=null,Ce=X),_e!==Ce)){if(Te=Kv,fe="onMouseLeave",z="onMouseEnter",L="mouse",(u==="pointerout"||u==="pointerover")&&(Te=e_,fe="onPointerLeave",z="onPointerEnter",L="pointer"),jt=_e==null?re:aa(_e),q=Ce==null?re:aa(Ce),re=new Te(fe,L+"leave",_e,g,le),re.target=jt,re.relatedTarget=q,fe=null,qo(le)===X&&(Te=new Te(z,L+"enter",Ce,g,le),Te.target=q,Te.relatedTarget=jt,fe=Te),jt=fe,_e&&Ce)t:{for(Te=_e,z=Ce,L=0,q=Te;q;q=oa(q))L++;for(q=0,fe=z;fe;fe=oa(fe))q++;for(;0<L-q;)Te=oa(Te),L--;for(;0<q-L;)z=oa(z),q--;for(;L--;){if(Te===z||z!==null&&Te===z.alternate)break t;Te=oa(Te),z=oa(z)}Te=null}else Te=null;_e!==null&&P_(ce,re,_e,Te,!1),Ce!==null&&jt!==null&&P_(ce,jt,Ce,Te,!0)}}e:{if(re=X?aa(X):window,_e=re.nodeName&&re.nodeName.toLowerCase(),_e==="select"||_e==="input"&&re.type==="file")var Ae=IL;else if(o_(re))if(a_)Ae=LL;else{Ae=VL;var $e=RL}else(_e=re.nodeName)&&_e.toLowerCase()==="input"&&(re.type==="checkbox"||re.type==="radio")&&(Ae=ML);if(Ae&&(Ae=Ae(u,X))){l_(ce,Ae,g,le);break e}$e&&$e(u,re,X),u==="focusout"&&($e=re._wrapperState)&&$e.controlled&&re.type==="number"&&tt(re,"number",re.value)}switch($e=X?aa(X):window,u){case"focusin":(o_($e)||$e.contentEditable==="true")&&(sa=$e,b0=X,su=null);break;case"focusout":su=b0=sa=null;break;case"mousedown":O0=!0;break;case"contextmenu":case"mouseup":case"dragend":O0=!1,p_(ce,g,le);break;case"selectionchange":if(DL)break;case"keydown":case"keyup":p_(ce,g,le)}var De;if(g0)e:{switch(u){case"compositionstart":var Ne="onCompositionStart";break e;case"compositionend":Ne="onCompositionEnd";break e;case"compositionupdate":Ne="onCompositionUpdate";break e}Ne=void 0}else na?s_(u,g)&&(Ne="onCompositionEnd"):u==="keydown"&&g.keyCode===229&&(Ne="onCompositionStart");Ne&&(t_&&g.locale!=="ko"&&(na||Ne!=="onCompositionStart"?Ne==="onCompositionEnd"&&na&&(De=Gv()):(Gr=le,c0="value"in Gr?Gr.value:Gr.textContent,na=!0)),$e=Yd(X,Ne),0<$e.length&&(Ne=new Jv(Ne,u,null,g,le),ce.push({event:Ne,listeners:$e}),De?Ne.data=De:(De=r_(g),De!==null&&(Ne.data=De)))),(De=CL?PL(u,g):TL(u,g))&&(X=Yd(X,"onBeforeInput"),0<X.length&&(le=new Jv("onBeforeInput","beforeinput",null,g,le),ce.push({event:le,listeners:X}),le.data=De))}S_(ce,d)})}function lu(u,d,g){return{instance:u,listener:d,currentTarget:g}}function Yd(u,d){for(var g=d+"Capture",x=[];u!==null;){var y=u,v=y.stateNode;y.tag===5&&v!==null&&(y=v,v=zc(u,g),v!=null&&x.unshift(lu(u,v,y)),v=zc(u,d),v!=null&&x.push(lu(u,v,y))),u=u.return}return x}function oa(u){if(u===null)return null;do u=u.return;while(u&&u.tag!==5);return u||null}function P_(u,d,g,x,y){for(var v=d._reactName,S=[];g!==null&&g!==x;){var A=g,R=A.alternate,X=A.stateNode;if(R!==null&&R===x)break;A.tag===5&&X!==null&&(A=X,y?(R=zc(g,v),R!=null&&S.unshift(lu(g,R,A))):y||(R=zc(g,v),R!=null&&S.push(lu(g,R,A)))),g=g.return}S.length!==0&&u.push({event:d,listeners:S})}var zL=/\r\n?/g,WL=/\u0000|\uFFFD/g;function T_(u){return(typeof u=="string"?u:""+u).replace(zL,`
`).replace(WL,"")}function Kd(u,d,g){if(d=T_(d),T_(u)!==d&&g)throw Error(e(425))}function Jd(){}var C0=null,P0=null;function T0(u,d){return u==="textarea"||u==="noscript"||typeof d.children=="string"||typeof d.children=="number"||typeof d.dangerouslySetInnerHTML=="object"&&d.dangerouslySetInnerHTML!==null&&d.dangerouslySetInnerHTML.__html!=null}var E0=typeof setTimeout=="function"?setTimeout:void 0,UL=typeof clearTimeout=="function"?clearTimeout:void 0,E_=typeof Promise=="function"?Promise:void 0,ZL=typeof queueMicrotask=="function"?queueMicrotask:typeof E_<"u"?function(u){return E_.resolve(null).then(u).catch(HL)}:E0;function HL(u){setTimeout(function(){throw u})}function A0(u,d){var g=d,x=0;do{var y=g.nextSibling;if(u.removeChild(g),y&&y.nodeType===8)if(g=y.data,g==="/$"){if(x===0){u.removeChild(y),Yc(d);return}x--}else g!=="$"&&g!=="$?"&&g!=="$!"||x++;g=y}while(g);Yc(d)}function Kr(u){for(;u!=null;u=u.nextSibling){var d=u.nodeType;if(d===1||d===3)break;if(d===8){if(d=u.data,d==="$"||d==="$!"||d==="$?")break;if(d==="/$")return null}}return u}function A_(u){u=u.previousSibling;for(var d=0;u;){if(u.nodeType===8){var g=u.data;if(g==="$"||g==="$!"||g==="$?"){if(d===0)return u;d--}else g==="/$"&&d++}u=u.previousSibling}return null}var la=Math.random().toString(36).slice(2),Ws="__reactFiber$"+la,au="__reactProps$"+la,fr="__reactContainer$"+la,I0="__reactEvents$"+la,qL="__reactListeners$"+la,jL="__reactHandles$"+la;function qo(u){var d=u[Ws];if(d)return d;for(var g=u.parentNode;g;){if(d=g[fr]||g[Ws]){if(g=d.alternate,d.child!==null||g!==null&&g.child!==null)for(u=A_(u);u!==null;){if(g=u[Ws])return g;u=A_(u)}return d}u=g,g=u.parentNode}return null}function cu(u){return u=u[Ws]||u[fr],!u||u.tag!==5&&u.tag!==6&&u.tag!==13&&u.tag!==3?null:u}function aa(u){if(u.tag===5||u.tag===6)return u.stateNode;throw Error(e(33))}function ef(u){return u[au]||null}var R0=[],ca=-1;function Jr(u){return{current:u}}function Pt(u){0>ca||(u.current=R0[ca],R0[ca]=null,ca--)}function _t(u,d){ca++,R0[ca]=u.current,u.current=d}var eo={},Mi=Jr(eo),ln=Jr(!1),jo=eo;function ua(u,d){var g=u.type.contextTypes;if(!g)return eo;var x=u.stateNode;if(x&&x.__reactInternalMemoizedUnmaskedChildContext===d)return x.__reactInternalMemoizedMaskedChildContext;var y={},v;for(v in g)y[v]=d[v];return x&&(u=u.stateNode,u.__reactInternalMemoizedUnmaskedChildContext=d,u.__reactInternalMemoizedMaskedChildContext=y),y}function an(u){return u=u.childContextTypes,u!=null}function tf(){Pt(ln),Pt(Mi)}function I_(u,d,g){if(Mi.current!==eo)throw Error(e(168));_t(Mi,d),_t(ln,g)}function R_(u,d,g){var x=u.stateNode;if(d=d.childContextTypes,typeof x.getChildContext!="function")return g;x=x.getChildContext();for(var y in x)if(!(y in d))throw Error(e(108,pe(u)||"Unknown",y));return ie({},g,x)}function nf(u){return u=(u=u.stateNode)&&u.__reactInternalMemoizedMergedChildContext||eo,jo=Mi.current,_t(Mi,u),_t(ln,ln.current),!0}function V_(u,d,g){var x=u.stateNode;if(!x)throw Error(e(169));g?(u=R_(u,d,jo),x.__reactInternalMemoizedMergedChildContext=u,Pt(ln),Pt(Mi),_t(Mi,u)):Pt(ln),_t(ln,g)}var mr=null,sf=!1,V0=!1;function M_(u){mr===null?mr=[u]:mr.push(u)}function XL(u){sf=!0,M_(u)}function to(){if(!V0&&mr!==null){V0=!0;var u=0,d=xt;try{var g=mr;for(xt=1;u<g.length;u++){var x=g[u];do x=x(!0);while(x!==null)}mr=null,sf=!1}catch(y){throw mr!==null&&(mr=mr.slice(u+1)),Bv(t0,to),y}finally{xt=d,V0=!1}}return null}var ha=[],da=0,rf=null,of=0,Hn=[],qn=0,Xo=null,gr=1,pr="";function Go(u,d){ha[da++]=of,ha[da++]=rf,rf=u,of=d}function L_(u,d,g){Hn[qn++]=gr,Hn[qn++]=pr,Hn[qn++]=Xo,Xo=u;var x=gr;u=pr;var y=32-ks(x)-1;x&=~(1<<y),g+=1;var v=32-ks(d)+y;if(30<v){var S=y-y%5;v=(x&(1<<S)-1).toString(32),x>>=S,y-=S,gr=1<<32-ks(d)+y|g<<y|x,pr=v+u}else gr=1<<v|g<<y|x,pr=u}function M0(u){u.return!==null&&(Go(u,1),L_(u,1,0))}function L0(u){for(;u===rf;)rf=ha[--da],ha[da]=null,of=ha[--da],ha[da]=null;for(;u===Xo;)Xo=Hn[--qn],Hn[qn]=null,pr=Hn[--qn],Hn[qn]=null,gr=Hn[--qn],Hn[qn]=null}var An=null,In=null,Rt=!1,Cs=null;function B_(u,d){var g=Yn(5,null,null,0);g.elementType="DELETED",g.stateNode=d,g.return=u,d=u.deletions,d===null?(u.deletions=[g],u.flags|=16):d.push(g)}function $_(u,d){switch(u.tag){case 5:var g=u.type;return d=d.nodeType!==1||g.toLowerCase()!==d.nodeName.toLowerCase()?null:d,d!==null?(u.stateNode=d,An=u,In=Kr(d.firstChild),!0):!1;case 6:return d=u.pendingProps===""||d.nodeType!==3?null:d,d!==null?(u.stateNode=d,An=u,In=null,!0):!1;case 13:return d=d.nodeType!==8?null:d,d!==null?(g=Xo!==null?{id:gr,overflow:pr}:null,u.memoizedState={dehydrated:d,treeContext:g,retryLane:1073741824},g=Yn(18,null,null,0),g.stateNode=d,g.return=u,u.child=g,An=u,In=null,!0):!1;default:return!1}}function B0(u){return(u.mode&1)!==0&&(u.flags&128)===0}function $0(u){if(Rt){var d=In;if(d){var g=d;if(!$_(u,d)){if(B0(u))throw Error(e(418));d=Kr(g.nextSibling);var x=An;d&&$_(u,d)?B_(x,g):(u.flags=u.flags&-4097|2,Rt=!1,An=u)}}else{if(B0(u))throw Error(e(418));u.flags=u.flags&-4097|2,Rt=!1,An=u}}}function D_(u){for(u=u.return;u!==null&&u.tag!==5&&u.tag!==3&&u.tag!==13;)u=u.return;An=u}function lf(u){if(u!==An)return!1;if(!Rt)return D_(u),Rt=!0,!1;var d;if((d=u.tag!==3)&&!(d=u.tag!==5)&&(d=u.type,d=d!=="head"&&d!=="body"&&!T0(u.type,u.memoizedProps)),d&&(d=In)){if(B0(u))throw Q_(),Error(e(418));for(;d;)B_(u,d),d=Kr(d.nextSibling)}if(D_(u),u.tag===13){if(u=u.memoizedState,u=u!==null?u.dehydrated:null,!u)throw Error(e(317));e:{for(u=u.nextSibling,d=0;u;){if(u.nodeType===8){var g=u.data;if(g==="/$"){if(d===0){In=Kr(u.nextSibling);break e}d--}else g!=="$"&&g!=="$!"&&g!=="$?"||d++}u=u.nextSibling}In=null}}else In=An?Kr(u.stateNode.nextSibling):null;return!0}function Q_(){for(var u=In;u;)u=Kr(u.nextSibling)}function fa(){In=An=null,Rt=!1}function D0(u){Cs===null?Cs=[u]:Cs.push(u)}var GL=Q.ReactCurrentBatchConfig;function uu(u,d,g){if(u=g.ref,u!==null&&typeof u!="function"&&typeof u!="object"){if(g._owner){if(g=g._owner,g){if(g.tag!==1)throw Error(e(309));var x=g.stateNode}if(!x)throw Error(e(147,u));var y=x,v=""+u;return d!==null&&d.ref!==null&&typeof d.ref=="function"&&d.ref._stringRef===v?d.ref:(d=function(S){var A=y.refs;S===null?delete A[v]:A[v]=S},d._stringRef=v,d)}if(typeof u!="string")throw Error(e(284));if(!g._owner)throw Error(e(290,u))}return u}function af(u,d){throw u=Object.prototype.toString.call(d),Error(e(31,u==="[object Object]"?"object with keys {"+Object.keys(d).join(", ")+"}":u))}function N_(u){var d=u._init;return d(u._payload)}function F_(u){function d(z,L){if(u){var q=z.deletions;q===null?(z.deletions=[L],z.flags|=16):q.push(L)}}function g(z,L){if(!u)return null;for(;L!==null;)d(z,L),L=L.sibling;return null}function x(z,L){for(z=new Map;L!==null;)L.key!==null?z.set(L.key,L):z.set(L.index,L),L=L.sibling;return z}function y(z,L){return z=co(z,L),z.index=0,z.sibling=null,z}function v(z,L,q){return z.index=q,u?(q=z.alternate,q!==null?(q=q.index,q<L?(z.flags|=2,L):q):(z.flags|=2,L)):(z.flags|=1048576,L)}function S(z){return u&&z.alternate===null&&(z.flags|=2),z}function A(z,L,q,fe){return L===null||L.tag!==6?(L=Ew(q,z.mode,fe),L.return=z,L):(L=y(L,q),L.return=z,L)}function R(z,L,q,fe){var Ae=q.type;return Ae===D?le(z,L,q.props.children,fe,q.key):L!==null&&(L.elementType===Ae||typeof Ae=="object"&&Ae!==null&&Ae.$$typeof===oe&&N_(Ae)===L.type)?(fe=y(L,q.props),fe.ref=uu(z,L,q),fe.return=z,fe):(fe=Rf(q.type,q.key,q.props,null,z.mode,fe),fe.ref=uu(z,L,q),fe.return=z,fe)}function X(z,L,q,fe){return L===null||L.tag!==4||L.stateNode.containerInfo!==q.containerInfo||L.stateNode.implementation!==q.implementation?(L=Aw(q,z.mode,fe),L.return=z,L):(L=y(L,q.children||[]),L.return=z,L)}function le(z,L,q,fe,Ae){return L===null||L.tag!==7?(L=sl(q,z.mode,fe,Ae),L.return=z,L):(L=y(L,q),L.return=z,L)}function ce(z,L,q){if(typeof L=="string"&&L!==""||typeof L=="number")return L=Ew(""+L,z.mode,q),L.return=z,L;if(typeof L=="object"&&L!==null){switch(L.$$typeof){case N:return q=Rf(L.type,L.key,L.props,null,z.mode,q),q.ref=uu(z,null,L),q.return=z,q;case G:return L=Aw(L,z.mode,q),L.return=z,L;case oe:var fe=L._init;return ce(z,fe(L._payload),q)}if(it(L)||Y(L))return L=sl(L,z.mode,q,null),L.return=z,L;af(z,L)}return null}function re(z,L,q,fe){var Ae=L!==null?L.key:null;if(typeof q=="string"&&q!==""||typeof q=="number")return Ae!==null?null:A(z,L,""+q,fe);if(typeof q=="object"&&q!==null){switch(q.$$typeof){case N:return q.key===Ae?R(z,L,q,fe):null;case G:return q.key===Ae?X(z,L,q,fe):null;case oe:return Ae=q._init,re(z,L,Ae(q._payload),fe)}if(it(q)||Y(q))return Ae!==null?null:le(z,L,q,fe,null);af(z,q)}return null}function _e(z,L,q,fe,Ae){if(typeof fe=="string"&&fe!==""||typeof fe=="number")return z=z.get(q)||null,A(L,z,""+fe,Ae);if(typeof fe=="object"&&fe!==null){switch(fe.$$typeof){case N:return z=z.get(fe.key===null?q:fe.key)||null,R(L,z,fe,Ae);case G:return z=z.get(fe.key===null?q:fe.key)||null,X(L,z,fe,Ae);case oe:var $e=fe._init;return _e(z,L,q,$e(fe._payload),Ae)}if(it(fe)||Y(fe))return z=z.get(q)||null,le(L,z,fe,Ae,null);af(L,fe)}return null}function Ce(z,L,q,fe){for(var Ae=null,$e=null,De=L,Ne=L=0,wi=null;De!==null&&Ne<q.length;Ne++){De.index>Ne?(wi=De,De=null):wi=De.sibling;var lt=re(z,De,q[Ne],fe);if(lt===null){De===null&&(De=wi);break}u&&De&&lt.alternate===null&&d(z,De),L=v(lt,L,Ne),$e===null?Ae=lt:$e.sibling=lt,$e=lt,De=wi}if(Ne===q.length)return g(z,De),Rt&&Go(z,Ne),Ae;if(De===null){for(;Ne<q.length;Ne++)De=ce(z,q[Ne],fe),De!==null&&(L=v(De,L,Ne),$e===null?Ae=De:$e.sibling=De,$e=De);return Rt&&Go(z,Ne),Ae}for(De=x(z,De);Ne<q.length;Ne++)wi=_e(De,z,Ne,q[Ne],fe),wi!==null&&(u&&wi.alternate!==null&&De.delete(wi.key===null?Ne:wi.key),L=v(wi,L,Ne),$e===null?Ae=wi:$e.sibling=wi,$e=wi);return u&&De.forEach(function(uo){return d(z,uo)}),Rt&&Go(z,Ne),Ae}function Te(z,L,q,fe){var Ae=Y(q);if(typeof Ae!="function")throw Error(e(150));if(q=Ae.call(q),q==null)throw Error(e(151));for(var $e=Ae=null,De=L,Ne=L=0,wi=null,lt=q.next();De!==null&&!lt.done;Ne++,lt=q.next()){De.index>Ne?(wi=De,De=null):wi=De.sibling;var uo=re(z,De,lt.value,fe);if(uo===null){De===null&&(De=wi);break}u&&De&&uo.alternate===null&&d(z,De),L=v(uo,L,Ne),$e===null?Ae=uo:$e.sibling=uo,$e=uo,De=wi}if(lt.done)return g(z,De),Rt&&Go(z,Ne),Ae;if(De===null){for(;!lt.done;Ne++,lt=q.next())lt=ce(z,lt.value,fe),lt!==null&&(L=v(lt,L,Ne),$e===null?Ae=lt:$e.sibling=lt,$e=lt);return Rt&&Go(z,Ne),Ae}for(De=x(z,De);!lt.done;Ne++,lt=q.next())lt=_e(De,z,Ne,lt.value,fe),lt!==null&&(u&&lt.alternate!==null&&De.delete(lt.key===null?Ne:lt.key),L=v(lt,L,Ne),$e===null?Ae=lt:$e.sibling=lt,$e=lt);return u&&De.forEach(function(EB){return d(z,EB)}),Rt&&Go(z,Ne),Ae}function jt(z,L,q,fe){if(typeof q=="object"&&q!==null&&q.type===D&&q.key===null&&(q=q.props.children),typeof q=="object"&&q!==null){switch(q.$$typeof){case N:e:{for(var Ae=q.key,$e=L;$e!==null;){if($e.key===Ae){if(Ae=q.type,Ae===D){if($e.tag===7){g(z,$e.sibling),L=y($e,q.props.children),L.return=z,z=L;break e}}else if($e.elementType===Ae||typeof Ae=="object"&&Ae!==null&&Ae.$$typeof===oe&&N_(Ae)===$e.type){g(z,$e.sibling),L=y($e,q.props),L.ref=uu(z,$e,q),L.return=z,z=L;break e}g(z,$e);break}else d(z,$e);$e=$e.sibling}q.type===D?(L=sl(q.props.children,z.mode,fe,q.key),L.return=z,z=L):(fe=Rf(q.type,q.key,q.props,null,z.mode,fe),fe.ref=uu(z,L,q),fe.return=z,z=fe)}return S(z);case G:e:{for($e=q.key;L!==null;){if(L.key===$e)if(L.tag===4&&L.stateNode.containerInfo===q.containerInfo&&L.stateNode.implementation===q.implementation){g(z,L.sibling),L=y(L,q.children||[]),L.return=z,z=L;break e}else{g(z,L);break}else d(z,L);L=L.sibling}L=Aw(q,z.mode,fe),L.return=z,z=L}return S(z);case oe:return $e=q._init,jt(z,L,$e(q._payload),fe)}if(it(q))return Ce(z,L,q,fe);if(Y(q))return Te(z,L,q,fe);af(z,q)}return typeof q=="string"&&q!==""||typeof q=="number"?(q=""+q,L!==null&&L.tag===6?(g(z,L.sibling),L=y(L,q),L.return=z,z=L):(g(z,L),L=Ew(q,z.mode,fe),L.return=z,z=L),S(z)):g(z,L)}return jt}var ma=F_(!0),z_=F_(!1),cf=Jr(null),uf=null,ga=null,Q0=null;function N0(){Q0=ga=uf=null}function F0(u){var d=cf.current;Pt(cf),u._currentValue=d}function z0(u,d,g){for(;u!==null;){var x=u.alternate;if((u.childLanes&d)!==d?(u.childLanes|=d,x!==null&&(x.childLanes|=d)):x!==null&&(x.childLanes&d)!==d&&(x.childLanes|=d),u===g)break;u=u.return}}function pa(u,d){uf=u,Q0=ga=null,u=u.dependencies,u!==null&&u.firstContext!==null&&((u.lanes&d)!==0&&(cn=!0),u.firstContext=null)}function jn(u){var d=u._currentValue;if(Q0!==u)if(u={context:u,memoizedValue:d,next:null},ga===null){if(uf===null)throw Error(e(308));ga=u,uf.dependencies={lanes:0,firstContext:u}}else ga=ga.next=u;return d}var Yo=null;function W0(u){Yo===null?Yo=[u]:Yo.push(u)}function W_(u,d,g,x){var y=d.interleaved;return y===null?(g.next=g,W0(d)):(g.next=y.next,y.next=g),d.interleaved=g,wr(u,x)}function wr(u,d){u.lanes|=d;var g=u.alternate;for(g!==null&&(g.lanes|=d),g=u,u=u.return;u!==null;)u.childLanes|=d,g=u.alternate,g!==null&&(g.childLanes|=d),g=u,u=u.return;return g.tag===3?g.stateNode:null}var io=!1;function U0(u){u.updateQueue={baseState:u.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function U_(u,d){u=u.updateQueue,d.updateQueue===u&&(d.updateQueue={baseState:u.baseState,firstBaseUpdate:u.firstBaseUpdate,lastBaseUpdate:u.lastBaseUpdate,shared:u.shared,effects:u.effects})}function xr(u,d){return{eventTime:u,lane:d,tag:0,payload:null,callback:null,next:null}}function no(u,d,g){var x=u.updateQueue;if(x===null)return null;if(x=x.shared,(nt&2)!==0){var y=x.pending;return y===null?d.next=d:(d.next=y.next,y.next=d),x.pending=d,wr(u,g)}return y=x.interleaved,y===null?(d.next=d,W0(x)):(d.next=y.next,y.next=d),x.interleaved=d,wr(u,g)}function hf(u,d,g){if(d=d.updateQueue,d!==null&&(d=d.shared,(g&4194240)!==0)){var x=d.lanes;x&=u.pendingLanes,g|=x,d.lanes=g,s0(u,g)}}function Z_(u,d){var g=u.updateQueue,x=u.alternate;if(x!==null&&(x=x.updateQueue,g===x)){var y=null,v=null;if(g=g.firstBaseUpdate,g!==null){do{var S={eventTime:g.eventTime,lane:g.lane,tag:g.tag,payload:g.payload,callback:g.callback,next:null};v===null?y=v=S:v=v.next=S,g=g.next}while(g!==null);v===null?y=v=d:v=v.next=d}else y=v=d;g={baseState:x.baseState,firstBaseUpdate:y,lastBaseUpdate:v,shared:x.shared,effects:x.effects},u.updateQueue=g;return}u=g.lastBaseUpdate,u===null?g.firstBaseUpdate=d:u.next=d,g.lastBaseUpdate=d}function df(u,d,g,x){var y=u.updateQueue;io=!1;var v=y.firstBaseUpdate,S=y.lastBaseUpdate,A=y.shared.pending;if(A!==null){y.shared.pending=null;var R=A,X=R.next;R.next=null,S===null?v=X:S.next=X,S=R;var le=u.alternate;le!==null&&(le=le.updateQueue,A=le.lastBaseUpdate,A!==S&&(A===null?le.firstBaseUpdate=X:A.next=X,le.lastBaseUpdate=R))}if(v!==null){var ce=y.baseState;S=0,le=X=R=null,A=v;do{var re=A.lane,_e=A.eventTime;if((x&re)===re){le!==null&&(le=le.next={eventTime:_e,lane:0,tag:A.tag,payload:A.payload,callback:A.callback,next:null});e:{var Ce=u,Te=A;switch(re=d,_e=g,Te.tag){case 1:if(Ce=Te.payload,typeof Ce=="function"){ce=Ce.call(_e,ce,re);break e}ce=Ce;break e;case 3:Ce.flags=Ce.flags&-65537|128;case 0:if(Ce=Te.payload,re=typeof Ce=="function"?Ce.call(_e,ce,re):Ce,re==null)break e;ce=ie({},ce,re);break e;case 2:io=!0}}A.callback!==null&&A.lane!==0&&(u.flags|=64,re=y.effects,re===null?y.effects=[A]:re.push(A))}else _e={eventTime:_e,lane:re,tag:A.tag,payload:A.payload,callback:A.callback,next:null},le===null?(X=le=_e,R=ce):le=le.next=_e,S|=re;if(A=A.next,A===null){if(A=y.shared.pending,A===null)break;re=A,A=re.next,re.next=null,y.lastBaseUpdate=re,y.shared.pending=null}}while(!0);if(le===null&&(R=ce),y.baseState=R,y.firstBaseUpdate=X,y.lastBaseUpdate=le,d=y.shared.interleaved,d!==null){y=d;do S|=y.lane,y=y.next;while(y!==d)}else v===null&&(y.shared.lanes=0);el|=S,u.lanes=S,u.memoizedState=ce}}function H_(u,d,g){if(u=d.effects,d.effects=null,u!==null)for(d=0;d<u.length;d++){var x=u[d],y=x.callback;if(y!==null){if(x.callback=null,x=g,typeof y!="function")throw Error(e(191,y));y.call(x)}}}var hu={},Us=Jr(hu),du=Jr(hu),fu=Jr(hu);function Ko(u){if(u===hu)throw Error(e(174));return u}function Z0(u,d){switch(_t(fu,d),_t(du,u),_t(Us,hu),u=d.nodeType,u){case 9:case 11:d=(d=d.documentElement)?d.namespaceURI:Si(null,"");break;default:u=u===8?d.parentNode:d,d=u.namespaceURI||null,u=u.tagName,d=Si(d,u)}Pt(Us),_t(Us,d)}function wa(){Pt(Us),Pt(du),Pt(fu)}function q_(u){Ko(fu.current);var d=Ko(Us.current),g=Si(d,u.type);d!==g&&(_t(du,u),_t(Us,g))}function H0(u){du.current===u&&(Pt(Us),Pt(du))}var Dt=Jr(0);function ff(u){for(var d=u;d!==null;){if(d.tag===13){var g=d.memoizedState;if(g!==null&&(g=g.dehydrated,g===null||g.data==="$?"||g.data==="$!"))return d}else if(d.tag===19&&d.memoizedProps.revealOrder!==void 0){if((d.flags&128)!==0)return d}else if(d.child!==null){d.child.return=d,d=d.child;continue}if(d===u)break;for(;d.sibling===null;){if(d.return===null||d.return===u)return null;d=d.return}d.sibling.return=d.return,d=d.sibling}return null}var q0=[];function j0(){for(var u=0;u<q0.length;u++)q0[u]._workInProgressVersionPrimary=null;q0.length=0}var mf=Q.ReactCurrentDispatcher,X0=Q.ReactCurrentBatchConfig,Jo=0,Qt=null,li=null,gi=null,gf=!1,mu=!1,gu=0,YL=0;function Li(){throw Error(e(321))}function G0(u,d){if(d===null)return!1;for(var g=0;g<d.length&&g<u.length;g++)if(!Ss(u[g],d[g]))return!1;return!0}function Y0(u,d,g,x,y,v){if(Jo=v,Qt=d,d.memoizedState=null,d.updateQueue=null,d.lanes=0,mf.current=u===null||u.memoizedState===null?tB:iB,u=g(x,y),mu){v=0;do{if(mu=!1,gu=0,25<=v)throw Error(e(301));v+=1,gi=li=null,d.updateQueue=null,mf.current=nB,u=g(x,y)}while(mu)}if(mf.current=xf,d=li!==null&&li.next!==null,Jo=0,gi=li=Qt=null,gf=!1,d)throw Error(e(300));return u}function K0(){var u=gu!==0;return gu=0,u}function Zs(){var u={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return gi===null?Qt.memoizedState=gi=u:gi=gi.next=u,gi}function Xn(){if(li===null){var u=Qt.alternate;u=u!==null?u.memoizedState:null}else u=li.next;var d=gi===null?Qt.memoizedState:gi.next;if(d!==null)gi=d,li=u;else{if(u===null)throw Error(e(310));li=u,u={memoizedState:li.memoizedState,baseState:li.baseState,baseQueue:li.baseQueue,queue:li.queue,next:null},gi===null?Qt.memoizedState=gi=u:gi=gi.next=u}return gi}function pu(u,d){return typeof d=="function"?d(u):d}function J0(u){var d=Xn(),g=d.queue;if(g===null)throw Error(e(311));g.lastRenderedReducer=u;var x=li,y=x.baseQueue,v=g.pending;if(v!==null){if(y!==null){var S=y.next;y.next=v.next,v.next=S}x.baseQueue=y=v,g.pending=null}if(y!==null){v=y.next,x=x.baseState;var A=S=null,R=null,X=v;do{var le=X.lane;if((Jo&le)===le)R!==null&&(R=R.next={lane:0,action:X.action,hasEagerState:X.hasEagerState,eagerState:X.eagerState,next:null}),x=X.hasEagerState?X.eagerState:u(x,X.action);else{var ce={lane:le,action:X.action,hasEagerState:X.hasEagerState,eagerState:X.eagerState,next:null};R===null?(A=R=ce,S=x):R=R.next=ce,Qt.lanes|=le,el|=le}X=X.next}while(X!==null&&X!==v);R===null?S=x:R.next=A,Ss(x,d.memoizedState)||(cn=!0),d.memoizedState=x,d.baseState=S,d.baseQueue=R,g.lastRenderedState=x}if(u=g.interleaved,u!==null){y=u;do v=y.lane,Qt.lanes|=v,el|=v,y=y.next;while(y!==u)}else y===null&&(g.lanes=0);return[d.memoizedState,g.dispatch]}function ew(u){var d=Xn(),g=d.queue;if(g===null)throw Error(e(311));g.lastRenderedReducer=u;var x=g.dispatch,y=g.pending,v=d.memoizedState;if(y!==null){g.pending=null;var S=y=y.next;do v=u(v,S.action),S=S.next;while(S!==y);Ss(v,d.memoizedState)||(cn=!0),d.memoizedState=v,d.baseQueue===null&&(d.baseState=v),g.lastRenderedState=v}return[v,x]}function j_(){}function X_(u,d){var g=Qt,x=Xn(),y=d(),v=!Ss(x.memoizedState,y);if(v&&(x.memoizedState=y,cn=!0),x=x.queue,tw(K_.bind(null,g,x,u),[u]),x.getSnapshot!==d||v||gi!==null&&gi.memoizedState.tag&1){if(g.flags|=2048,wu(9,Y_.bind(null,g,x,y,d),void 0,null),pi===null)throw Error(e(349));(Jo&30)!==0||G_(g,d,y)}return y}function G_(u,d,g){u.flags|=16384,u={getSnapshot:d,value:g},d=Qt.updateQueue,d===null?(d={lastEffect:null,stores:null},Qt.updateQueue=d,d.stores=[u]):(g=d.stores,g===null?d.stores=[u]:g.push(u))}function Y_(u,d,g,x){d.value=g,d.getSnapshot=x,J_(d)&&ek(u)}function K_(u,d,g){return g(function(){J_(d)&&ek(u)})}function J_(u){var d=u.getSnapshot;u=u.value;try{var g=d();return!Ss(u,g)}catch{return!0}}function ek(u){var d=wr(u,1);d!==null&&As(d,u,1,-1)}function tk(u){var d=Zs();return typeof u=="function"&&(u=u()),d.memoizedState=d.baseState=u,u={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:pu,lastRenderedState:u},d.queue=u,u=u.dispatch=eB.bind(null,Qt,u),[d.memoizedState,u]}function wu(u,d,g,x){return u={tag:u,create:d,destroy:g,deps:x,next:null},d=Qt.updateQueue,d===null?(d={lastEffect:null,stores:null},Qt.updateQueue=d,d.lastEffect=u.next=u):(g=d.lastEffect,g===null?d.lastEffect=u.next=u:(x=g.next,g.next=u,u.next=x,d.lastEffect=u)),u}function ik(){return Xn().memoizedState}function pf(u,d,g,x){var y=Zs();Qt.flags|=u,y.memoizedState=wu(1|d,g,void 0,x===void 0?null:x)}function wf(u,d,g,x){var y=Xn();x=x===void 0?null:x;var v=void 0;if(li!==null){var S=li.memoizedState;if(v=S.destroy,x!==null&&G0(x,S.deps)){y.memoizedState=wu(d,g,v,x);return}}Qt.flags|=u,y.memoizedState=wu(1|d,g,v,x)}function nk(u,d){return pf(8390656,8,u,d)}function tw(u,d){return wf(2048,8,u,d)}function sk(u,d){return wf(4,2,u,d)}function rk(u,d){return wf(4,4,u,d)}function ok(u,d){if(typeof d=="function")return u=u(),d(u),function(){d(null)};if(d!=null)return u=u(),d.current=u,function(){d.current=null}}function lk(u,d,g){return g=g!=null?g.concat([u]):null,wf(4,4,ok.bind(null,d,u),g)}function iw(){}function ak(u,d){var g=Xn();d=d===void 0?null:d;var x=g.memoizedState;return x!==null&&d!==null&&G0(d,x[1])?x[0]:(g.memoizedState=[u,d],u)}function ck(u,d){var g=Xn();d=d===void 0?null:d;var x=g.memoizedState;return x!==null&&d!==null&&G0(d,x[1])?x[0]:(u=u(),g.memoizedState=[u,d],u)}function uk(u,d,g){return(Jo&21)===0?(u.baseState&&(u.baseState=!1,cn=!0),u.memoizedState=g):(Ss(g,d)||(g=Nv(),Qt.lanes|=g,el|=g,u.baseState=!0),d)}function KL(u,d){var g=xt;xt=g!==0&&4>g?g:4,u(!0);var x=X0.transition;X0.transition={};try{u(!1),d()}finally{xt=g,X0.transition=x}}function hk(){return Xn().memoizedState}function JL(u,d,g){var x=lo(u);if(g={lane:x,action:g,hasEagerState:!1,eagerState:null,next:null},dk(u))fk(d,g);else if(g=W_(u,d,g,x),g!==null){var y=Yi();As(g,u,x,y),mk(g,d,x)}}function eB(u,d,g){var x=lo(u),y={lane:x,action:g,hasEagerState:!1,eagerState:null,next:null};if(dk(u))fk(d,y);else{var v=u.alternate;if(u.lanes===0&&(v===null||v.lanes===0)&&(v=d.lastRenderedReducer,v!==null))try{var S=d.lastRenderedState,A=v(S,g);if(y.hasEagerState=!0,y.eagerState=A,Ss(A,S)){var R=d.interleaved;R===null?(y.next=y,W0(d)):(y.next=R.next,R.next=y),d.interleaved=y;return}}catch{}finally{}g=W_(u,d,y,x),g!==null&&(y=Yi(),As(g,u,x,y),mk(g,d,x))}}function dk(u){var d=u.alternate;return u===Qt||d!==null&&d===Qt}function fk(u,d){mu=gf=!0;var g=u.pending;g===null?d.next=d:(d.next=g.next,g.next=d),u.pending=d}function mk(u,d,g){if((g&4194240)!==0){var x=d.lanes;x&=u.pendingLanes,g|=x,d.lanes=g,s0(u,g)}}var xf={readContext:jn,useCallback:Li,useContext:Li,useEffect:Li,useImperativeHandle:Li,useInsertionEffect:Li,useLayoutEffect:Li,useMemo:Li,useReducer:Li,useRef:Li,useState:Li,useDebugValue:Li,useDeferredValue:Li,useTransition:Li,useMutableSource:Li,useSyncExternalStore:Li,useId:Li,unstable_isNewReconciler:!1},tB={readContext:jn,useCallback:function(u,d){return Zs().memoizedState=[u,d===void 0?null:d],u},useContext:jn,useEffect:nk,useImperativeHandle:function(u,d,g){return g=g!=null?g.concat([u]):null,pf(4194308,4,ok.bind(null,d,u),g)},useLayoutEffect:function(u,d){return pf(4194308,4,u,d)},useInsertionEffect:function(u,d){return pf(4,2,u,d)},useMemo:function(u,d){var g=Zs();return d=d===void 0?null:d,u=u(),g.memoizedState=[u,d],u},useReducer:function(u,d,g){var x=Zs();return d=g!==void 0?g(d):d,x.memoizedState=x.baseState=d,u={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:u,lastRenderedState:d},x.queue=u,u=u.dispatch=JL.bind(null,Qt,u),[x.memoizedState,u]},useRef:function(u){var d=Zs();return u={current:u},d.memoizedState=u},useState:tk,useDebugValue:iw,useDeferredValue:function(u){return Zs().memoizedState=u},useTransition:function(){var u=tk(!1),d=u[0];return u=KL.bind(null,u[1]),Zs().memoizedState=u,[d,u]},useMutableSource:function(){},useSyncExternalStore:function(u,d,g){var x=Qt,y=Zs();if(Rt){if(g===void 0)throw Error(e(407));g=g()}else{if(g=d(),pi===null)throw Error(e(349));(Jo&30)!==0||G_(x,d,g)}y.memoizedState=g;var v={value:g,getSnapshot:d};return y.queue=v,nk(K_.bind(null,x,v,u),[u]),x.flags|=2048,wu(9,Y_.bind(null,x,v,g,d),void 0,null),g},useId:function(){var u=Zs(),d=pi.identifierPrefix;if(Rt){var g=pr,x=gr;g=(x&~(1<<32-ks(x)-1)).toString(32)+g,d=":"+d+"R"+g,g=gu++,0<g&&(d+="H"+g.toString(32)),d+=":"}else g=YL++,d=":"+d+"r"+g.toString(32)+":";return u.memoizedState=d},unstable_isNewReconciler:!1},iB={readContext:jn,useCallback:ak,useContext:jn,useEffect:tw,useImperativeHandle:lk,useInsertionEffect:sk,useLayoutEffect:rk,useMemo:ck,useReducer:J0,useRef:ik,useState:function(){return J0(pu)},useDebugValue:iw,useDeferredValue:function(u){var d=Xn();return uk(d,li.memoizedState,u)},useTransition:function(){var u=J0(pu)[0],d=Xn().memoizedState;return[u,d]},useMutableSource:j_,useSyncExternalStore:X_,useId:hk,unstable_isNewReconciler:!1},nB={readContext:jn,useCallback:ak,useContext:jn,useEffect:tw,useImperativeHandle:lk,useInsertionEffect:sk,useLayoutEffect:rk,useMemo:ck,useReducer:ew,useRef:ik,useState:function(){return ew(pu)},useDebugValue:iw,useDeferredValue:function(u){var d=Xn();return li===null?d.memoizedState=u:uk(d,li.memoizedState,u)},useTransition:function(){var u=ew(pu)[0],d=Xn().memoizedState;return[u,d]},useMutableSource:j_,useSyncExternalStore:X_,useId:hk,unstable_isNewReconciler:!1};function Ps(u,d){if(u&&u.defaultProps){d=ie({},d),u=u.defaultProps;for(var g in u)d[g]===void 0&&(d[g]=u[g]);return d}return d}function nw(u,d,g,x){d=u.memoizedState,g=g(x,d),g=g==null?d:ie({},d,g),u.memoizedState=g,u.lanes===0&&(u.updateQueue.baseState=g)}var bf={isMounted:function(u){return(u=u._reactInternals)?Ho(u)===u:!1},enqueueSetState:function(u,d,g){u=u._reactInternals;var x=Yi(),y=lo(u),v=xr(x,y);v.payload=d,g!=null&&(v.callback=g),d=no(u,v,y),d!==null&&(As(d,u,y,x),hf(d,u,y))},enqueueReplaceState:function(u,d,g){u=u._reactInternals;var x=Yi(),y=lo(u),v=xr(x,y);v.tag=1,v.payload=d,g!=null&&(v.callback=g),d=no(u,v,y),d!==null&&(As(d,u,y,x),hf(d,u,y))},enqueueForceUpdate:function(u,d){u=u._reactInternals;var g=Yi(),x=lo(u),y=xr(g,x);y.tag=2,d!=null&&(y.callback=d),d=no(u,y,x),d!==null&&(As(d,u,x,g),hf(d,u,x))}};function gk(u,d,g,x,y,v,S){return u=u.stateNode,typeof u.shouldComponentUpdate=="function"?u.shouldComponentUpdate(x,v,S):d.prototype&&d.prototype.isPureReactComponent?!nu(g,x)||!nu(y,v):!0}function pk(u,d,g){var x=!1,y=eo,v=d.contextType;return typeof v=="object"&&v!==null?v=jn(v):(y=an(d)?jo:Mi.current,x=d.contextTypes,v=(x=x!=null)?ua(u,y):eo),d=new d(g,v),u.memoizedState=d.state!==null&&d.state!==void 0?d.state:null,d.updater=bf,u.stateNode=d,d._reactInternals=u,x&&(u=u.stateNode,u.__reactInternalMemoizedUnmaskedChildContext=y,u.__reactInternalMemoizedMaskedChildContext=v),d}function wk(u,d,g,x){u=d.state,typeof d.componentWillReceiveProps=="function"&&d.componentWillReceiveProps(g,x),typeof d.UNSAFE_componentWillReceiveProps=="function"&&d.UNSAFE_componentWillReceiveProps(g,x),d.state!==u&&bf.enqueueReplaceState(d,d.state,null)}function sw(u,d,g,x){var y=u.stateNode;y.props=g,y.state=u.memoizedState,y.refs={},U0(u);var v=d.contextType;typeof v=="object"&&v!==null?y.context=jn(v):(v=an(d)?jo:Mi.current,y.context=ua(u,v)),y.state=u.memoizedState,v=d.getDerivedStateFromProps,typeof v=="function"&&(nw(u,d,v,g),y.state=u.memoizedState),typeof d.getDerivedStateFromProps=="function"||typeof y.getSnapshotBeforeUpdate=="function"||typeof y.UNSAFE_componentWillMount!="function"&&typeof y.componentWillMount!="function"||(d=y.state,typeof y.componentWillMount=="function"&&y.componentWillMount(),typeof y.UNSAFE_componentWillMount=="function"&&y.UNSAFE_componentWillMount(),d!==y.state&&bf.enqueueReplaceState(y,y.state,null),df(u,g,y,x),y.state=u.memoizedState),typeof y.componentDidMount=="function"&&(u.flags|=4194308)}function xa(u,d){try{var g="",x=d;do g+=$(x),x=x.return;while(x);var y=g}catch(v){y=`
Error generating stack: `+v.message+`
`+v.stack}return{value:u,source:d,stack:y,digest:null}}function rw(u,d,g){return{value:u,source:null,stack:g??null,digest:d??null}}function ow(u,d){try{console.error(d.value)}catch(g){setTimeout(function(){throw g})}}var sB=typeof WeakMap=="function"?WeakMap:Map;function xk(u,d,g){g=xr(-1,g),g.tag=3,g.payload={element:null};var x=d.value;return g.callback=function(){Cf||(Cf=!0,yw=x),ow(u,d)},g}function bk(u,d,g){g=xr(-1,g),g.tag=3;var x=u.type.getDerivedStateFromError;if(typeof x=="function"){var y=d.value;g.payload=function(){return x(y)},g.callback=function(){ow(u,d)}}var v=u.stateNode;return v!==null&&typeof v.componentDidCatch=="function"&&(g.callback=function(){ow(u,d),typeof x!="function"&&(ro===null?ro=new Set([this]):ro.add(this));var S=d.stack;this.componentDidCatch(d.value,{componentStack:S!==null?S:""})}),g}function Ok(u,d,g){var x=u.pingCache;if(x===null){x=u.pingCache=new sB;var y=new Set;x.set(d,y)}else y=x.get(d),y===void 0&&(y=new Set,x.set(d,y));y.has(g)||(y.add(g),u=xB.bind(null,u,d,g),d.then(u,u))}function yk(u){do{var d;if((d=u.tag===13)&&(d=u.memoizedState,d=d!==null?d.dehydrated!==null:!0),d)return u;u=u.return}while(u!==null);return null}function vk(u,d,g,x,y){return(u.mode&1)===0?(u===d?u.flags|=65536:(u.flags|=128,g.flags|=131072,g.flags&=-52805,g.tag===1&&(g.alternate===null?g.tag=17:(d=xr(-1,1),d.tag=2,no(g,d,1))),g.lanes|=1),u):(u.flags|=65536,u.lanes=y,u)}var rB=Q.ReactCurrentOwner,cn=!1;function Gi(u,d,g,x){d.child=u===null?z_(d,null,g,x):ma(d,u.child,g,x)}function _k(u,d,g,x,y){g=g.render;var v=d.ref;return pa(d,y),x=Y0(u,d,g,x,v,y),g=K0(),u!==null&&!cn?(d.updateQueue=u.updateQueue,d.flags&=-2053,u.lanes&=~y,br(u,d,y)):(Rt&&g&&M0(d),d.flags|=1,Gi(u,d,x,y),d.child)}function kk(u,d,g,x,y){if(u===null){var v=g.type;return typeof v=="function"&&!Tw(v)&&v.defaultProps===void 0&&g.compare===null&&g.defaultProps===void 0?(d.tag=15,d.type=v,Sk(u,d,v,x,y)):(u=Rf(g.type,null,x,d,d.mode,y),u.ref=d.ref,u.return=d,d.child=u)}if(v=u.child,(u.lanes&y)===0){var S=v.memoizedProps;if(g=g.compare,g=g!==null?g:nu,g(S,x)&&u.ref===d.ref)return br(u,d,y)}return d.flags|=1,u=co(v,x),u.ref=d.ref,u.return=d,d.child=u}function Sk(u,d,g,x,y){if(u!==null){var v=u.memoizedProps;if(nu(v,x)&&u.ref===d.ref)if(cn=!1,d.pendingProps=x=v,(u.lanes&y)!==0)(u.flags&131072)!==0&&(cn=!0);else return d.lanes=u.lanes,br(u,d,y)}return lw(u,d,g,x,y)}function Ck(u,d,g){var x=d.pendingProps,y=x.children,v=u!==null?u.memoizedState:null;if(x.mode==="hidden")if((d.mode&1)===0)d.memoizedState={baseLanes:0,cachePool:null,transitions:null},_t(Oa,Rn),Rn|=g;else{if((g&1073741824)===0)return u=v!==null?v.baseLanes|g:g,d.lanes=d.childLanes=1073741824,d.memoizedState={baseLanes:u,cachePool:null,transitions:null},d.updateQueue=null,_t(Oa,Rn),Rn|=u,null;d.memoizedState={baseLanes:0,cachePool:null,transitions:null},x=v!==null?v.baseLanes:g,_t(Oa,Rn),Rn|=x}else v!==null?(x=v.baseLanes|g,d.memoizedState=null):x=g,_t(Oa,Rn),Rn|=x;return Gi(u,d,y,g),d.child}function Pk(u,d){var g=d.ref;(u===null&&g!==null||u!==null&&u.ref!==g)&&(d.flags|=512,d.flags|=2097152)}function lw(u,d,g,x,y){var v=an(g)?jo:Mi.current;return v=ua(d,v),pa(d,y),g=Y0(u,d,g,x,v,y),x=K0(),u!==null&&!cn?(d.updateQueue=u.updateQueue,d.flags&=-2053,u.lanes&=~y,br(u,d,y)):(Rt&&x&&M0(d),d.flags|=1,Gi(u,d,g,y),d.child)}function Tk(u,d,g,x,y){if(an(g)){var v=!0;nf(d)}else v=!1;if(pa(d,y),d.stateNode===null)yf(u,d),pk(d,g,x),sw(d,g,x,y),x=!0;else if(u===null){var S=d.stateNode,A=d.memoizedProps;S.props=A;var R=S.context,X=g.contextType;typeof X=="object"&&X!==null?X=jn(X):(X=an(g)?jo:Mi.current,X=ua(d,X));var le=g.getDerivedStateFromProps,ce=typeof le=="function"||typeof S.getSnapshotBeforeUpdate=="function";ce||typeof S.UNSAFE_componentWillReceiveProps!="function"&&typeof S.componentWillReceiveProps!="function"||(A!==x||R!==X)&&wk(d,S,x,X),io=!1;var re=d.memoizedState;S.state=re,df(d,x,S,y),R=d.memoizedState,A!==x||re!==R||ln.current||io?(typeof le=="function"&&(nw(d,g,le,x),R=d.memoizedState),(A=io||gk(d,g,A,x,re,R,X))?(ce||typeof S.UNSAFE_componentWillMount!="function"&&typeof S.componentWillMount!="function"||(typeof S.componentWillMount=="function"&&S.componentWillMount(),typeof S.UNSAFE_componentWillMount=="function"&&S.UNSAFE_componentWillMount()),typeof S.componentDidMount=="function"&&(d.flags|=4194308)):(typeof S.componentDidMount=="function"&&(d.flags|=4194308),d.memoizedProps=x,d.memoizedState=R),S.props=x,S.state=R,S.context=X,x=A):(typeof S.componentDidMount=="function"&&(d.flags|=4194308),x=!1)}else{S=d.stateNode,U_(u,d),A=d.memoizedProps,X=d.type===d.elementType?A:Ps(d.type,A),S.props=X,ce=d.pendingProps,re=S.context,R=g.contextType,typeof R=="object"&&R!==null?R=jn(R):(R=an(g)?jo:Mi.current,R=ua(d,R));var _e=g.getDerivedStateFromProps;(le=typeof _e=="function"||typeof S.getSnapshotBeforeUpdate=="function")||typeof S.UNSAFE_componentWillReceiveProps!="function"&&typeof S.componentWillReceiveProps!="function"||(A!==ce||re!==R)&&wk(d,S,x,R),io=!1,re=d.memoizedState,S.state=re,df(d,x,S,y);var Ce=d.memoizedState;A!==ce||re!==Ce||ln.current||io?(typeof _e=="function"&&(nw(d,g,_e,x),Ce=d.memoizedState),(X=io||gk(d,g,X,x,re,Ce,R)||!1)?(le||typeof S.UNSAFE_componentWillUpdate!="function"&&typeof S.componentWillUpdate!="function"||(typeof S.componentWillUpdate=="function"&&S.componentWillUpdate(x,Ce,R),typeof S.UNSAFE_componentWillUpdate=="function"&&S.UNSAFE_componentWillUpdate(x,Ce,R)),typeof S.componentDidUpdate=="function"&&(d.flags|=4),typeof S.getSnapshotBeforeUpdate=="function"&&(d.flags|=1024)):(typeof S.componentDidUpdate!="function"||A===u.memoizedProps&&re===u.memoizedState||(d.flags|=4),typeof S.getSnapshotBeforeUpdate!="function"||A===u.memoizedProps&&re===u.memoizedState||(d.flags|=1024),d.memoizedProps=x,d.memoizedState=Ce),S.props=x,S.state=Ce,S.context=R,x=X):(typeof S.componentDidUpdate!="function"||A===u.memoizedProps&&re===u.memoizedState||(d.flags|=4),typeof S.getSnapshotBeforeUpdate!="function"||A===u.memoizedProps&&re===u.memoizedState||(d.flags|=1024),x=!1)}return aw(u,d,g,x,v,y)}function aw(u,d,g,x,y,v){Pk(u,d);var S=(d.flags&128)!==0;if(!x&&!S)return y&&V_(d,g,!1),br(u,d,v);x=d.stateNode,rB.current=d;var A=S&&typeof g.getDerivedStateFromError!="function"?null:x.render();return d.flags|=1,u!==null&&S?(d.child=ma(d,u.child,null,v),d.child=ma(d,null,A,v)):Gi(u,d,A,v),d.memoizedState=x.state,y&&V_(d,g,!0),d.child}function Ek(u){var d=u.stateNode;d.pendingContext?I_(u,d.pendingContext,d.pendingContext!==d.context):d.context&&I_(u,d.context,!1),Z0(u,d.containerInfo)}function Ak(u,d,g,x,y){return fa(),D0(y),d.flags|=256,Gi(u,d,g,x),d.child}var cw={dehydrated:null,treeContext:null,retryLane:0};function uw(u){return{baseLanes:u,cachePool:null,transitions:null}}function Ik(u,d,g){var x=d.pendingProps,y=Dt.current,v=!1,S=(d.flags&128)!==0,A;if((A=S)||(A=u!==null&&u.memoizedState===null?!1:(y&2)!==0),A?(v=!0,d.flags&=-129):(u===null||u.memoizedState!==null)&&(y|=1),_t(Dt,y&1),u===null)return $0(d),u=d.memoizedState,u!==null&&(u=u.dehydrated,u!==null)?((d.mode&1)===0?d.lanes=1:u.data==="$!"?d.lanes=8:d.lanes=1073741824,null):(S=x.children,u=x.fallback,v?(x=d.mode,v=d.child,S={mode:"hidden",children:S},(x&1)===0&&v!==null?(v.childLanes=0,v.pendingProps=S):v=Vf(S,x,0,null),u=sl(u,x,g,null),v.return=d,u.return=d,v.sibling=u,d.child=v,d.child.memoizedState=uw(g),d.memoizedState=cw,u):hw(d,S));if(y=u.memoizedState,y!==null&&(A=y.dehydrated,A!==null))return oB(u,d,S,x,A,y,g);if(v){v=x.fallback,S=d.mode,y=u.child,A=y.sibling;var R={mode:"hidden",children:x.children};return(S&1)===0&&d.child!==y?(x=d.child,x.childLanes=0,x.pendingProps=R,d.deletions=null):(x=co(y,R),x.subtreeFlags=y.subtreeFlags&14680064),A!==null?v=co(A,v):(v=sl(v,S,g,null),v.flags|=2),v.return=d,x.return=d,x.sibling=v,d.child=x,x=v,v=d.child,S=u.child.memoizedState,S=S===null?uw(g):{baseLanes:S.baseLanes|g,cachePool:null,transitions:S.transitions},v.memoizedState=S,v.childLanes=u.childLanes&~g,d.memoizedState=cw,x}return v=u.child,u=v.sibling,x=co(v,{mode:"visible",children:x.children}),(d.mode&1)===0&&(x.lanes=g),x.return=d,x.sibling=null,u!==null&&(g=d.deletions,g===null?(d.deletions=[u],d.flags|=16):g.push(u)),d.child=x,d.memoizedState=null,x}function hw(u,d){return d=Vf({mode:"visible",children:d},u.mode,0,null),d.return=u,u.child=d}function Of(u,d,g,x){return x!==null&&D0(x),ma(d,u.child,null,g),u=hw(d,d.pendingProps.children),u.flags|=2,d.memoizedState=null,u}function oB(u,d,g,x,y,v,S){if(g)return d.flags&256?(d.flags&=-257,x=rw(Error(e(422))),Of(u,d,S,x)):d.memoizedState!==null?(d.child=u.child,d.flags|=128,null):(v=x.fallback,y=d.mode,x=Vf({mode:"visible",children:x.children},y,0,null),v=sl(v,y,S,null),v.flags|=2,x.return=d,v.return=d,x.sibling=v,d.child=x,(d.mode&1)!==0&&ma(d,u.child,null,S),d.child.memoizedState=uw(S),d.memoizedState=cw,v);if((d.mode&1)===0)return Of(u,d,S,null);if(y.data==="$!"){if(x=y.nextSibling&&y.nextSibling.dataset,x)var A=x.dgst;return x=A,v=Error(e(419)),x=rw(v,x,void 0),Of(u,d,S,x)}if(A=(S&u.childLanes)!==0,cn||A){if(x=pi,x!==null){switch(S&-S){case 4:y=2;break;case 16:y=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:y=32;break;case 536870912:y=268435456;break;default:y=0}y=(y&(x.suspendedLanes|S))!==0?0:y,y!==0&&y!==v.retryLane&&(v.retryLane=y,wr(u,y),As(x,u,y,-1))}return Pw(),x=rw(Error(e(421))),Of(u,d,S,x)}return y.data==="$?"?(d.flags|=128,d.child=u.child,d=bB.bind(null,u),y._reactRetry=d,null):(u=v.treeContext,In=Kr(y.nextSibling),An=d,Rt=!0,Cs=null,u!==null&&(Hn[qn++]=gr,Hn[qn++]=pr,Hn[qn++]=Xo,gr=u.id,pr=u.overflow,Xo=d),d=hw(d,x.children),d.flags|=4096,d)}function Rk(u,d,g){u.lanes|=d;var x=u.alternate;x!==null&&(x.lanes|=d),z0(u.return,d,g)}function dw(u,d,g,x,y){var v=u.memoizedState;v===null?u.memoizedState={isBackwards:d,rendering:null,renderingStartTime:0,last:x,tail:g,tailMode:y}:(v.isBackwards=d,v.rendering=null,v.renderingStartTime=0,v.last=x,v.tail=g,v.tailMode=y)}function Vk(u,d,g){var x=d.pendingProps,y=x.revealOrder,v=x.tail;if(Gi(u,d,x.children,g),x=Dt.current,(x&2)!==0)x=x&1|2,d.flags|=128;else{if(u!==null&&(u.flags&128)!==0)e:for(u=d.child;u!==null;){if(u.tag===13)u.memoizedState!==null&&Rk(u,g,d);else if(u.tag===19)Rk(u,g,d);else if(u.child!==null){u.child.return=u,u=u.child;continue}if(u===d)break e;for(;u.sibling===null;){if(u.return===null||u.return===d)break e;u=u.return}u.sibling.return=u.return,u=u.sibling}x&=1}if(_t(Dt,x),(d.mode&1)===0)d.memoizedState=null;else switch(y){case"forwards":for(g=d.child,y=null;g!==null;)u=g.alternate,u!==null&&ff(u)===null&&(y=g),g=g.sibling;g=y,g===null?(y=d.child,d.child=null):(y=g.sibling,g.sibling=null),dw(d,!1,y,g,v);break;case"backwards":for(g=null,y=d.child,d.child=null;y!==null;){if(u=y.alternate,u!==null&&ff(u)===null){d.child=y;break}u=y.sibling,y.sibling=g,g=y,y=u}dw(d,!0,g,null,v);break;case"together":dw(d,!1,null,null,void 0);break;default:d.memoizedState=null}return d.child}function yf(u,d){(d.mode&1)===0&&u!==null&&(u.alternate=null,d.alternate=null,d.flags|=2)}function br(u,d,g){if(u!==null&&(d.dependencies=u.dependencies),el|=d.lanes,(g&d.childLanes)===0)return null;if(u!==null&&d.child!==u.child)throw Error(e(153));if(d.child!==null){for(u=d.child,g=co(u,u.pendingProps),d.child=g,g.return=d;u.sibling!==null;)u=u.sibling,g=g.sibling=co(u,u.pendingProps),g.return=d;g.sibling=null}return d.child}function lB(u,d,g){switch(d.tag){case 3:Ek(d),fa();break;case 5:q_(d);break;case 1:an(d.type)&&nf(d);break;case 4:Z0(d,d.stateNode.containerInfo);break;case 10:var x=d.type._context,y=d.memoizedProps.value;_t(cf,x._currentValue),x._currentValue=y;break;case 13:if(x=d.memoizedState,x!==null)return x.dehydrated!==null?(_t(Dt,Dt.current&1),d.flags|=128,null):(g&d.child.childLanes)!==0?Ik(u,d,g):(_t(Dt,Dt.current&1),u=br(u,d,g),u!==null?u.sibling:null);_t(Dt,Dt.current&1);break;case 19:if(x=(g&d.childLanes)!==0,(u.flags&128)!==0){if(x)return Vk(u,d,g);d.flags|=128}if(y=d.memoizedState,y!==null&&(y.rendering=null,y.tail=null,y.lastEffect=null),_t(Dt,Dt.current),x)break;return null;case 22:case 23:return d.lanes=0,Ck(u,d,g)}return br(u,d,g)}var Mk,fw,Lk,Bk;Mk=function(u,d){for(var g=d.child;g!==null;){if(g.tag===5||g.tag===6)u.appendChild(g.stateNode);else if(g.tag!==4&&g.child!==null){g.child.return=g,g=g.child;continue}if(g===d)break;for(;g.sibling===null;){if(g.return===null||g.return===d)return;g=g.return}g.sibling.return=g.return,g=g.sibling}},fw=function(){},Lk=function(u,d,g,x){var y=u.memoizedProps;if(y!==x){u=d.stateNode,Ko(Us.current);var v=null;switch(g){case"input":y=je(u,y),x=je(u,x),v=[];break;case"select":y=ie({},y,{value:void 0}),x=ie({},x,{value:void 0}),v=[];break;case"textarea":y=Vi(u,y),x=Vi(u,x),v=[];break;default:typeof y.onClick!="function"&&typeof x.onClick=="function"&&(u.onclick=Jd)}Fc(g,x);var S;g=null;for(X in y)if(!x.hasOwnProperty(X)&&y.hasOwnProperty(X)&&y[X]!=null)if(X==="style"){var A=y[X];for(S in A)A.hasOwnProperty(S)&&(g||(g={}),g[S]="")}else X!=="dangerouslySetInnerHTML"&&X!=="children"&&X!=="suppressContentEditableWarning"&&X!=="suppressHydrationWarning"&&X!=="autoFocus"&&(n.hasOwnProperty(X)?v||(v=[]):(v=v||[]).push(X,null));for(X in x){var R=x[X];if(A=y!=null?y[X]:void 0,x.hasOwnProperty(X)&&R!==A&&(R!=null||A!=null))if(X==="style")if(A){for(S in A)!A.hasOwnProperty(S)||R&&R.hasOwnProperty(S)||(g||(g={}),g[S]="");for(S in R)R.hasOwnProperty(S)&&A[S]!==R[S]&&(g||(g={}),g[S]=R[S])}else g||(v||(v=[]),v.push(X,g)),g=R;else X==="dangerouslySetInnerHTML"?(R=R?R.__html:void 0,A=A?A.__html:void 0,R!=null&&A!==R&&(v=v||[]).push(X,R)):X==="children"?typeof R!="string"&&typeof R!="number"||(v=v||[]).push(X,""+R):X!=="suppressContentEditableWarning"&&X!=="suppressHydrationWarning"&&(n.hasOwnProperty(X)?(R!=null&&X==="onScroll"&&Ct("scroll",u),v||A===R||(v=[])):(v=v||[]).push(X,R))}g&&(v=v||[]).push("style",g);var X=v;(d.updateQueue=X)&&(d.flags|=4)}},Bk=function(u,d,g,x){g!==x&&(d.flags|=4)};function xu(u,d){if(!Rt)switch(u.tailMode){case"hidden":d=u.tail;for(var g=null;d!==null;)d.alternate!==null&&(g=d),d=d.sibling;g===null?u.tail=null:g.sibling=null;break;case"collapsed":g=u.tail;for(var x=null;g!==null;)g.alternate!==null&&(x=g),g=g.sibling;x===null?d||u.tail===null?u.tail=null:u.tail.sibling=null:x.sibling=null}}function Bi(u){var d=u.alternate!==null&&u.alternate.child===u.child,g=0,x=0;if(d)for(var y=u.child;y!==null;)g|=y.lanes|y.childLanes,x|=y.subtreeFlags&14680064,x|=y.flags&14680064,y.return=u,y=y.sibling;else for(y=u.child;y!==null;)g|=y.lanes|y.childLanes,x|=y.subtreeFlags,x|=y.flags,y.return=u,y=y.sibling;return u.subtreeFlags|=x,u.childLanes=g,d}function aB(u,d,g){var x=d.pendingProps;switch(L0(d),d.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Bi(d),null;case 1:return an(d.type)&&tf(),Bi(d),null;case 3:return x=d.stateNode,wa(),Pt(ln),Pt(Mi),j0(),x.pendingContext&&(x.context=x.pendingContext,x.pendingContext=null),(u===null||u.child===null)&&(lf(d)?d.flags|=4:u===null||u.memoizedState.isDehydrated&&(d.flags&256)===0||(d.flags|=1024,Cs!==null&&(kw(Cs),Cs=null))),fw(u,d),Bi(d),null;case 5:H0(d);var y=Ko(fu.current);if(g=d.type,u!==null&&d.stateNode!=null)Lk(u,d,g,x,y),u.ref!==d.ref&&(d.flags|=512,d.flags|=2097152);else{if(!x){if(d.stateNode===null)throw Error(e(166));return Bi(d),null}if(u=Ko(Us.current),lf(d)){x=d.stateNode,g=d.type;var v=d.memoizedProps;switch(x[Ws]=d,x[au]=v,u=(d.mode&1)!==0,g){case"dialog":Ct("cancel",x),Ct("close",x);break;case"iframe":case"object":case"embed":Ct("load",x);break;case"video":case"audio":for(y=0;y<ru.length;y++)Ct(ru[y],x);break;case"source":Ct("error",x);break;case"img":case"image":case"link":Ct("error",x),Ct("load",x);break;case"details":Ct("toggle",x);break;case"input":ki(x,v),Ct("invalid",x);break;case"select":x._wrapperState={wasMultiple:!!v.multiple},Ct("invalid",x);break;case"textarea":oi(x,v),Ct("invalid",x)}Fc(g,v),y=null;for(var S in v)if(v.hasOwnProperty(S)){var A=v[S];S==="children"?typeof A=="string"?x.textContent!==A&&(v.suppressHydrationWarning!==!0&&Kd(x.textContent,A,u),y=["children",A]):typeof A=="number"&&x.textContent!==""+A&&(v.suppressHydrationWarning!==!0&&Kd(x.textContent,A,u),y=["children",""+A]):n.hasOwnProperty(S)&&A!=null&&S==="onScroll"&&Ct("scroll",x)}switch(g){case"input":Qe(x),mi(x,v,!0);break;case"textarea":Qe(x),ii(x);break;case"select":case"option":break;default:typeof v.onClick=="function"&&(x.onclick=Jd)}x=y,d.updateQueue=x,x!==null&&(d.flags|=4)}else{S=y.nodeType===9?y:y.ownerDocument,u==="http://www.w3.org/1999/xhtml"&&(u=Ze(g)),u==="http://www.w3.org/1999/xhtml"?g==="script"?(u=S.createElement("div"),u.innerHTML="<script><\/script>",u=u.removeChild(u.firstChild)):typeof x.is=="string"?u=S.createElement(g,{is:x.is}):(u=S.createElement(g),g==="select"&&(S=u,x.multiple?S.multiple=!0:x.size&&(S.size=x.size))):u=S.createElementNS(u,g),u[Ws]=d,u[au]=x,Mk(u,d,!1,!1),d.stateNode=u;e:{switch(S=Zo(g,x),g){case"dialog":Ct("cancel",u),Ct("close",u),y=x;break;case"iframe":case"object":case"embed":Ct("load",u),y=x;break;case"video":case"audio":for(y=0;y<ru.length;y++)Ct(ru[y],u);y=x;break;case"source":Ct("error",u),y=x;break;case"img":case"image":case"link":Ct("error",u),Ct("load",u),y=x;break;case"details":Ct("toggle",u),y=x;break;case"input":ki(u,x),y=je(u,x),Ct("invalid",u);break;case"option":y=x;break;case"select":u._wrapperState={wasMultiple:!!x.multiple},y=ie({},x,{value:void 0}),Ct("invalid",u);break;case"textarea":oi(u,x),y=Vi(u,x),Ct("invalid",u);break;default:y=x}Fc(g,y),A=y;for(v in A)if(A.hasOwnProperty(v)){var R=A[v];v==="style"?Nc(u,R):v==="dangerouslySetInnerHTML"?(R=R?R.__html:void 0,R!=null&&vs(u,R)):v==="children"?typeof R=="string"?(g!=="textarea"||R!=="")&&Tn(u,R):typeof R=="number"&&Tn(u,""+R):v!=="suppressContentEditableWarning"&&v!=="suppressHydrationWarning"&&v!=="autoFocus"&&(n.hasOwnProperty(v)?R!=null&&v==="onScroll"&&Ct("scroll",u):R!=null&&M(u,v,R,S))}switch(g){case"input":Qe(u),mi(u,x,!1);break;case"textarea":Qe(u),ii(u);break;case"option":x.value!=null&&u.setAttribute("value",""+we(x.value));break;case"select":u.multiple=!!x.multiple,v=x.value,v!=null?Xi(u,!!x.multiple,v,!1):x.defaultValue!=null&&Xi(u,!!x.multiple,x.defaultValue,!0);break;default:typeof y.onClick=="function"&&(u.onclick=Jd)}switch(g){case"button":case"input":case"select":case"textarea":x=!!x.autoFocus;break e;case"img":x=!0;break e;default:x=!1}}x&&(d.flags|=4)}d.ref!==null&&(d.flags|=512,d.flags|=2097152)}return Bi(d),null;case 6:if(u&&d.stateNode!=null)Bk(u,d,u.memoizedProps,x);else{if(typeof x!="string"&&d.stateNode===null)throw Error(e(166));if(g=Ko(fu.current),Ko(Us.current),lf(d)){if(x=d.stateNode,g=d.memoizedProps,x[Ws]=d,(v=x.nodeValue!==g)&&(u=An,u!==null))switch(u.tag){case 3:Kd(x.nodeValue,g,(u.mode&1)!==0);break;case 5:u.memoizedProps.suppressHydrationWarning!==!0&&Kd(x.nodeValue,g,(u.mode&1)!==0)}v&&(d.flags|=4)}else x=(g.nodeType===9?g:g.ownerDocument).createTextNode(x),x[Ws]=d,d.stateNode=x}return Bi(d),null;case 13:if(Pt(Dt),x=d.memoizedState,u===null||u.memoizedState!==null&&u.memoizedState.dehydrated!==null){if(Rt&&In!==null&&(d.mode&1)!==0&&(d.flags&128)===0)Q_(),fa(),d.flags|=98560,v=!1;else if(v=lf(d),x!==null&&x.dehydrated!==null){if(u===null){if(!v)throw Error(e(318));if(v=d.memoizedState,v=v!==null?v.dehydrated:null,!v)throw Error(e(317));v[Ws]=d}else fa(),(d.flags&128)===0&&(d.memoizedState=null),d.flags|=4;Bi(d),v=!1}else Cs!==null&&(kw(Cs),Cs=null),v=!0;if(!v)return d.flags&65536?d:null}return(d.flags&128)!==0?(d.lanes=g,d):(x=x!==null,x!==(u!==null&&u.memoizedState!==null)&&x&&(d.child.flags|=8192,(d.mode&1)!==0&&(u===null||(Dt.current&1)!==0?ai===0&&(ai=3):Pw())),d.updateQueue!==null&&(d.flags|=4),Bi(d),null);case 4:return wa(),fw(u,d),u===null&&ou(d.stateNode.containerInfo),Bi(d),null;case 10:return F0(d.type._context),Bi(d),null;case 17:return an(d.type)&&tf(),Bi(d),null;case 19:if(Pt(Dt),v=d.memoizedState,v===null)return Bi(d),null;if(x=(d.flags&128)!==0,S=v.rendering,S===null)if(x)xu(v,!1);else{if(ai!==0||u!==null&&(u.flags&128)!==0)for(u=d.child;u!==null;){if(S=ff(u),S!==null){for(d.flags|=128,xu(v,!1),x=S.updateQueue,x!==null&&(d.updateQueue=x,d.flags|=4),d.subtreeFlags=0,x=g,g=d.child;g!==null;)v=g,u=x,v.flags&=14680066,S=v.alternate,S===null?(v.childLanes=0,v.lanes=u,v.child=null,v.subtreeFlags=0,v.memoizedProps=null,v.memoizedState=null,v.updateQueue=null,v.dependencies=null,v.stateNode=null):(v.childLanes=S.childLanes,v.lanes=S.lanes,v.child=S.child,v.subtreeFlags=0,v.deletions=null,v.memoizedProps=S.memoizedProps,v.memoizedState=S.memoizedState,v.updateQueue=S.updateQueue,v.type=S.type,u=S.dependencies,v.dependencies=u===null?null:{lanes:u.lanes,firstContext:u.firstContext}),g=g.sibling;return _t(Dt,Dt.current&1|2),d.child}u=u.sibling}v.tail!==null&&qt()>ya&&(d.flags|=128,x=!0,xu(v,!1),d.lanes=4194304)}else{if(!x)if(u=ff(S),u!==null){if(d.flags|=128,x=!0,g=u.updateQueue,g!==null&&(d.updateQueue=g,d.flags|=4),xu(v,!0),v.tail===null&&v.tailMode==="hidden"&&!S.alternate&&!Rt)return Bi(d),null}else 2*qt()-v.renderingStartTime>ya&&g!==1073741824&&(d.flags|=128,x=!0,xu(v,!1),d.lanes=4194304);v.isBackwards?(S.sibling=d.child,d.child=S):(g=v.last,g!==null?g.sibling=S:d.child=S,v.last=S)}return v.tail!==null?(d=v.tail,v.rendering=d,v.tail=d.sibling,v.renderingStartTime=qt(),d.sibling=null,g=Dt.current,_t(Dt,x?g&1|2:g&1),d):(Bi(d),null);case 22:case 23:return Cw(),x=d.memoizedState!==null,u!==null&&u.memoizedState!==null!==x&&(d.flags|=8192),x&&(d.mode&1)!==0?(Rn&1073741824)!==0&&(Bi(d),d.subtreeFlags&6&&(d.flags|=8192)):Bi(d),null;case 24:return null;case 25:return null}throw Error(e(156,d.tag))}function cB(u,d){switch(L0(d),d.tag){case 1:return an(d.type)&&tf(),u=d.flags,u&65536?(d.flags=u&-65537|128,d):null;case 3:return wa(),Pt(ln),Pt(Mi),j0(),u=d.flags,(u&65536)!==0&&(u&128)===0?(d.flags=u&-65537|128,d):null;case 5:return H0(d),null;case 13:if(Pt(Dt),u=d.memoizedState,u!==null&&u.dehydrated!==null){if(d.alternate===null)throw Error(e(340));fa()}return u=d.flags,u&65536?(d.flags=u&-65537|128,d):null;case 19:return Pt(Dt),null;case 4:return wa(),null;case 10:return F0(d.type._context),null;case 22:case 23:return Cw(),null;case 24:return null;default:return null}}var vf=!1,$i=!1,uB=typeof WeakSet=="function"?WeakSet:Set,Se=null;function ba(u,d){var g=u.ref;if(g!==null)if(typeof g=="function")try{g(null)}catch(x){zt(u,d,x)}else g.current=null}function mw(u,d,g){try{g()}catch(x){zt(u,d,x)}}var $k=!1;function hB(u,d){if(C0=Fd,u=g_(),x0(u)){if("selectionStart"in u)var g={start:u.selectionStart,end:u.selectionEnd};else e:{g=(g=u.ownerDocument)&&g.defaultView||window;var x=g.getSelection&&g.getSelection();if(x&&x.rangeCount!==0){g=x.anchorNode;var y=x.anchorOffset,v=x.focusNode;x=x.focusOffset;try{g.nodeType,v.nodeType}catch{g=null;break e}var S=0,A=-1,R=-1,X=0,le=0,ce=u,re=null;t:for(;;){for(var _e;ce!==g||y!==0&&ce.nodeType!==3||(A=S+y),ce!==v||x!==0&&ce.nodeType!==3||(R=S+x),ce.nodeType===3&&(S+=ce.nodeValue.length),(_e=ce.firstChild)!==null;)re=ce,ce=_e;for(;;){if(ce===u)break t;if(re===g&&++X===y&&(A=S),re===v&&++le===x&&(R=S),(_e=ce.nextSibling)!==null)break;ce=re,re=ce.parentNode}ce=_e}g=A===-1||R===-1?null:{start:A,end:R}}else g=null}g=g||{start:0,end:0}}else g=null;for(P0={focusedElem:u,selectionRange:g},Fd=!1,Se=d;Se!==null;)if(d=Se,u=d.child,(d.subtreeFlags&1028)!==0&&u!==null)u.return=d,Se=u;else for(;Se!==null;){d=Se;try{var Ce=d.alternate;if((d.flags&1024)!==0)switch(d.tag){case 0:case 11:case 15:break;case 1:if(Ce!==null){var Te=Ce.memoizedProps,jt=Ce.memoizedState,z=d.stateNode,L=z.getSnapshotBeforeUpdate(d.elementType===d.type?Te:Ps(d.type,Te),jt);z.__reactInternalSnapshotBeforeUpdate=L}break;case 3:var q=d.stateNode.containerInfo;q.nodeType===1?q.textContent="":q.nodeType===9&&q.documentElement&&q.removeChild(q.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(e(163))}}catch(fe){zt(d,d.return,fe)}if(u=d.sibling,u!==null){u.return=d.return,Se=u;break}Se=d.return}return Ce=$k,$k=!1,Ce}function bu(u,d,g){var x=d.updateQueue;if(x=x!==null?x.lastEffect:null,x!==null){var y=x=x.next;do{if((y.tag&u)===u){var v=y.destroy;y.destroy=void 0,v!==void 0&&mw(d,g,v)}y=y.next}while(y!==x)}}function _f(u,d){if(d=d.updateQueue,d=d!==null?d.lastEffect:null,d!==null){var g=d=d.next;do{if((g.tag&u)===u){var x=g.create;g.destroy=x()}g=g.next}while(g!==d)}}function gw(u){var d=u.ref;if(d!==null){var g=u.stateNode;switch(u.tag){case 5:u=g;break;default:u=g}typeof d=="function"?d(u):d.current=u}}function Dk(u){var d=u.alternate;d!==null&&(u.alternate=null,Dk(d)),u.child=null,u.deletions=null,u.sibling=null,u.tag===5&&(d=u.stateNode,d!==null&&(delete d[Ws],delete d[au],delete d[I0],delete d[qL],delete d[jL])),u.stateNode=null,u.return=null,u.dependencies=null,u.memoizedProps=null,u.memoizedState=null,u.pendingProps=null,u.stateNode=null,u.updateQueue=null}function Qk(u){return u.tag===5||u.tag===3||u.tag===4}function Nk(u){e:for(;;){for(;u.sibling===null;){if(u.return===null||Qk(u.return))return null;u=u.return}for(u.sibling.return=u.return,u=u.sibling;u.tag!==5&&u.tag!==6&&u.tag!==18;){if(u.flags&2||u.child===null||u.tag===4)continue e;u.child.return=u,u=u.child}if(!(u.flags&2))return u.stateNode}}function pw(u,d,g){var x=u.tag;if(x===5||x===6)u=u.stateNode,d?g.nodeType===8?g.parentNode.insertBefore(u,d):g.insertBefore(u,d):(g.nodeType===8?(d=g.parentNode,d.insertBefore(u,g)):(d=g,d.appendChild(u)),g=g._reactRootContainer,g!=null||d.onclick!==null||(d.onclick=Jd));else if(x!==4&&(u=u.child,u!==null))for(pw(u,d,g),u=u.sibling;u!==null;)pw(u,d,g),u=u.sibling}function ww(u,d,g){var x=u.tag;if(x===5||x===6)u=u.stateNode,d?g.insertBefore(u,d):g.appendChild(u);else if(x!==4&&(u=u.child,u!==null))for(ww(u,d,g),u=u.sibling;u!==null;)ww(u,d,g),u=u.sibling}var Ci=null,Ts=!1;function so(u,d,g){for(g=g.child;g!==null;)Fk(u,d,g),g=g.sibling}function Fk(u,d,g){if(zs&&typeof zs.onCommitFiberUnmount=="function")try{zs.onCommitFiberUnmount(Ld,g)}catch{}switch(g.tag){case 5:$i||ba(g,d);case 6:var x=Ci,y=Ts;Ci=null,so(u,d,g),Ci=x,Ts=y,Ci!==null&&(Ts?(u=Ci,g=g.stateNode,u.nodeType===8?u.parentNode.removeChild(g):u.removeChild(g)):Ci.removeChild(g.stateNode));break;case 18:Ci!==null&&(Ts?(u=Ci,g=g.stateNode,u.nodeType===8?A0(u.parentNode,g):u.nodeType===1&&A0(u,g),Yc(u)):A0(Ci,g.stateNode));break;case 4:x=Ci,y=Ts,Ci=g.stateNode.containerInfo,Ts=!0,so(u,d,g),Ci=x,Ts=y;break;case 0:case 11:case 14:case 15:if(!$i&&(x=g.updateQueue,x!==null&&(x=x.lastEffect,x!==null))){y=x=x.next;do{var v=y,S=v.destroy;v=v.tag,S!==void 0&&((v&2)!==0||(v&4)!==0)&&mw(g,d,S),y=y.next}while(y!==x)}so(u,d,g);break;case 1:if(!$i&&(ba(g,d),x=g.stateNode,typeof x.componentWillUnmount=="function"))try{x.props=g.memoizedProps,x.state=g.memoizedState,x.componentWillUnmount()}catch(A){zt(g,d,A)}so(u,d,g);break;case 21:so(u,d,g);break;case 22:g.mode&1?($i=(x=$i)||g.memoizedState!==null,so(u,d,g),$i=x):so(u,d,g);break;default:so(u,d,g)}}function zk(u){var d=u.updateQueue;if(d!==null){u.updateQueue=null;var g=u.stateNode;g===null&&(g=u.stateNode=new uB),d.forEach(function(x){var y=OB.bind(null,u,x);g.has(x)||(g.add(x),x.then(y,y))})}}function Es(u,d){var g=d.deletions;if(g!==null)for(var x=0;x<g.length;x++){var y=g[x];try{var v=u,S=d,A=S;e:for(;A!==null;){switch(A.tag){case 5:Ci=A.stateNode,Ts=!1;break e;case 3:Ci=A.stateNode.containerInfo,Ts=!0;break e;case 4:Ci=A.stateNode.containerInfo,Ts=!0;break e}A=A.return}if(Ci===null)throw Error(e(160));Fk(v,S,y),Ci=null,Ts=!1;var R=y.alternate;R!==null&&(R.return=null),y.return=null}catch(X){zt(y,d,X)}}if(d.subtreeFlags&12854)for(d=d.child;d!==null;)Wk(d,u),d=d.sibling}function Wk(u,d){var g=u.alternate,x=u.flags;switch(u.tag){case 0:case 11:case 14:case 15:if(Es(d,u),Hs(u),x&4){try{bu(3,u,u.return),_f(3,u)}catch(Te){zt(u,u.return,Te)}try{bu(5,u,u.return)}catch(Te){zt(u,u.return,Te)}}break;case 1:Es(d,u),Hs(u),x&512&&g!==null&&ba(g,g.return);break;case 5:if(Es(d,u),Hs(u),x&512&&g!==null&&ba(g,g.return),u.flags&32){var y=u.stateNode;try{Tn(y,"")}catch(Te){zt(u,u.return,Te)}}if(x&4&&(y=u.stateNode,y!=null)){var v=u.memoizedProps,S=g!==null?g.memoizedProps:v,A=u.type,R=u.updateQueue;if(u.updateQueue=null,R!==null)try{A==="input"&&v.type==="radio"&&v.name!=null&&ri(y,v),Zo(A,S);var X=Zo(A,v);for(S=0;S<R.length;S+=2){var le=R[S],ce=R[S+1];le==="style"?Nc(y,ce):le==="dangerouslySetInnerHTML"?vs(y,ce):le==="children"?Tn(y,ce):M(y,le,ce,X)}switch(A){case"input":Xe(y,v);break;case"textarea":Ge(y,v);break;case"select":var re=y._wrapperState.wasMultiple;y._wrapperState.wasMultiple=!!v.multiple;var _e=v.value;_e!=null?Xi(y,!!v.multiple,_e,!1):re!==!!v.multiple&&(v.defaultValue!=null?Xi(y,!!v.multiple,v.defaultValue,!0):Xi(y,!!v.multiple,v.multiple?[]:"",!1))}y[au]=v}catch(Te){zt(u,u.return,Te)}}break;case 6:if(Es(d,u),Hs(u),x&4){if(u.stateNode===null)throw Error(e(162));y=u.stateNode,v=u.memoizedProps;try{y.nodeValue=v}catch(Te){zt(u,u.return,Te)}}break;case 3:if(Es(d,u),Hs(u),x&4&&g!==null&&g.memoizedState.isDehydrated)try{Yc(d.containerInfo)}catch(Te){zt(u,u.return,Te)}break;case 4:Es(d,u),Hs(u);break;case 13:Es(d,u),Hs(u),y=u.child,y.flags&8192&&(v=y.memoizedState!==null,y.stateNode.isHidden=v,!v||y.alternate!==null&&y.alternate.memoizedState!==null||(Ow=qt())),x&4&&zk(u);break;case 22:if(le=g!==null&&g.memoizedState!==null,u.mode&1?($i=(X=$i)||le,Es(d,u),$i=X):Es(d,u),Hs(u),x&8192){if(X=u.memoizedState!==null,(u.stateNode.isHidden=X)&&!le&&(u.mode&1)!==0)for(Se=u,le=u.child;le!==null;){for(ce=Se=le;Se!==null;){switch(re=Se,_e=re.child,re.tag){case 0:case 11:case 14:case 15:bu(4,re,re.return);break;case 1:ba(re,re.return);var Ce=re.stateNode;if(typeof Ce.componentWillUnmount=="function"){x=re,g=re.return;try{d=x,Ce.props=d.memoizedProps,Ce.state=d.memoizedState,Ce.componentWillUnmount()}catch(Te){zt(x,g,Te)}}break;case 5:ba(re,re.return);break;case 22:if(re.memoizedState!==null){Hk(ce);continue}}_e!==null?(_e.return=re,Se=_e):Hk(ce)}le=le.sibling}e:for(le=null,ce=u;;){if(ce.tag===5){if(le===null){le=ce;try{y=ce.stateNode,X?(v=y.style,typeof v.setProperty=="function"?v.setProperty("display","none","important"):v.display="none"):(A=ce.stateNode,R=ce.memoizedProps.style,S=R!=null&&R.hasOwnProperty("display")?R.display:null,A.style.display=ft("display",S))}catch(Te){zt(u,u.return,Te)}}}else if(ce.tag===6){if(le===null)try{ce.stateNode.nodeValue=X?"":ce.memoizedProps}catch(Te){zt(u,u.return,Te)}}else if((ce.tag!==22&&ce.tag!==23||ce.memoizedState===null||ce===u)&&ce.child!==null){ce.child.return=ce,ce=ce.child;continue}if(ce===u)break e;for(;ce.sibling===null;){if(ce.return===null||ce.return===u)break e;le===ce&&(le=null),ce=ce.return}le===ce&&(le=null),ce.sibling.return=ce.return,ce=ce.sibling}}break;case 19:Es(d,u),Hs(u),x&4&&zk(u);break;case 21:break;default:Es(d,u),Hs(u)}}function Hs(u){var d=u.flags;if(d&2){try{e:{for(var g=u.return;g!==null;){if(Qk(g)){var x=g;break e}g=g.return}throw Error(e(160))}switch(x.tag){case 5:var y=x.stateNode;x.flags&32&&(Tn(y,""),x.flags&=-33);var v=Nk(u);ww(u,v,y);break;case 3:case 4:var S=x.stateNode.containerInfo,A=Nk(u);pw(u,A,S);break;default:throw Error(e(161))}}catch(R){zt(u,u.return,R)}u.flags&=-3}d&4096&&(u.flags&=-4097)}function dB(u,d,g){Se=u,Uk(u)}function Uk(u,d,g){for(var x=(u.mode&1)!==0;Se!==null;){var y=Se,v=y.child;if(y.tag===22&&x){var S=y.memoizedState!==null||vf;if(!S){var A=y.alternate,R=A!==null&&A.memoizedState!==null||$i;A=vf;var X=$i;if(vf=S,($i=R)&&!X)for(Se=y;Se!==null;)S=Se,R=S.child,S.tag===22&&S.memoizedState!==null?qk(y):R!==null?(R.return=S,Se=R):qk(y);for(;v!==null;)Se=v,Uk(v),v=v.sibling;Se=y,vf=A,$i=X}Zk(u)}else(y.subtreeFlags&8772)!==0&&v!==null?(v.return=y,Se=v):Zk(u)}}function Zk(u){for(;Se!==null;){var d=Se;if((d.flags&8772)!==0){var g=d.alternate;try{if((d.flags&8772)!==0)switch(d.tag){case 0:case 11:case 15:$i||_f(5,d);break;case 1:var x=d.stateNode;if(d.flags&4&&!$i)if(g===null)x.componentDidMount();else{var y=d.elementType===d.type?g.memoizedProps:Ps(d.type,g.memoizedProps);x.componentDidUpdate(y,g.memoizedState,x.__reactInternalSnapshotBeforeUpdate)}var v=d.updateQueue;v!==null&&H_(d,v,x);break;case 3:var S=d.updateQueue;if(S!==null){if(g=null,d.child!==null)switch(d.child.tag){case 5:g=d.child.stateNode;break;case 1:g=d.child.stateNode}H_(d,S,g)}break;case 5:var A=d.stateNode;if(g===null&&d.flags&4){g=A;var R=d.memoizedProps;switch(d.type){case"button":case"input":case"select":case"textarea":R.autoFocus&&g.focus();break;case"img":R.src&&(g.src=R.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(d.memoizedState===null){var X=d.alternate;if(X!==null){var le=X.memoizedState;if(le!==null){var ce=le.dehydrated;ce!==null&&Yc(ce)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(e(163))}$i||d.flags&512&&gw(d)}catch(re){zt(d,d.return,re)}}if(d===u){Se=null;break}if(g=d.sibling,g!==null){g.return=d.return,Se=g;break}Se=d.return}}function Hk(u){for(;Se!==null;){var d=Se;if(d===u){Se=null;break}var g=d.sibling;if(g!==null){g.return=d.return,Se=g;break}Se=d.return}}function qk(u){for(;Se!==null;){var d=Se;try{switch(d.tag){case 0:case 11:case 15:var g=d.return;try{_f(4,d)}catch(R){zt(d,g,R)}break;case 1:var x=d.stateNode;if(typeof x.componentDidMount=="function"){var y=d.return;try{x.componentDidMount()}catch(R){zt(d,y,R)}}var v=d.return;try{gw(d)}catch(R){zt(d,v,R)}break;case 5:var S=d.return;try{gw(d)}catch(R){zt(d,S,R)}}}catch(R){zt(d,d.return,R)}if(d===u){Se=null;break}var A=d.sibling;if(A!==null){A.return=d.return,Se=A;break}Se=d.return}}var fB=Math.ceil,kf=Q.ReactCurrentDispatcher,xw=Q.ReactCurrentOwner,Gn=Q.ReactCurrentBatchConfig,nt=0,pi=null,ni=null,Pi=0,Rn=0,Oa=Jr(0),ai=0,Ou=null,el=0,Sf=0,bw=0,yu=null,un=null,Ow=0,ya=1/0,Or=null,Cf=!1,yw=null,ro=null,Pf=!1,oo=null,Tf=0,vu=0,vw=null,Ef=-1,Af=0;function Yi(){return(nt&6)!==0?qt():Ef!==-1?Ef:Ef=qt()}function lo(u){return(u.mode&1)===0?1:(nt&2)!==0&&Pi!==0?Pi&-Pi:GL.transition!==null?(Af===0&&(Af=Nv()),Af):(u=xt,u!==0||(u=window.event,u=u===void 0?16:Xv(u.type)),u)}function As(u,d,g,x){if(50<vu)throw vu=0,vw=null,Error(e(185));Hc(u,g,x),((nt&2)===0||u!==pi)&&(u===pi&&((nt&2)===0&&(Sf|=g),ai===4&&ao(u,Pi)),hn(u,x),g===1&&nt===0&&(d.mode&1)===0&&(ya=qt()+500,sf&&to()))}function hn(u,d){var g=u.callbackNode;GM(u,d);var x=Dd(u,u===pi?Pi:0);if(x===0)g!==null&&$v(g),u.callbackNode=null,u.callbackPriority=0;else if(d=x&-x,u.callbackPriority!==d){if(g!=null&&$v(g),d===1)u.tag===0?XL(Xk.bind(null,u)):M_(Xk.bind(null,u)),ZL(function(){(nt&6)===0&&to()}),g=null;else{switch(Fv(x)){case 1:g=t0;break;case 4:g=Dv;break;case 16:g=Md;break;case 536870912:g=Qv;break;default:g=Md}g=nS(g,jk.bind(null,u))}u.callbackPriority=d,u.callbackNode=g}}function jk(u,d){if(Ef=-1,Af=0,(nt&6)!==0)throw Error(e(327));var g=u.callbackNode;if(va()&&u.callbackNode!==g)return null;var x=Dd(u,u===pi?Pi:0);if(x===0)return null;if((x&30)!==0||(x&u.expiredLanes)!==0||d)d=If(u,x);else{d=x;var y=nt;nt|=2;var v=Yk();(pi!==u||Pi!==d)&&(Or=null,ya=qt()+500,il(u,d));do try{pB();break}catch(A){Gk(u,A)}while(!0);N0(),kf.current=v,nt=y,ni!==null?d=0:(pi=null,Pi=0,d=ai)}if(d!==0){if(d===2&&(y=i0(u),y!==0&&(x=y,d=_w(u,y))),d===1)throw g=Ou,il(u,0),ao(u,x),hn(u,qt()),g;if(d===6)ao(u,x);else{if(y=u.current.alternate,(x&30)===0&&!mB(y)&&(d=If(u,x),d===2&&(v=i0(u),v!==0&&(x=v,d=_w(u,v))),d===1))throw g=Ou,il(u,0),ao(u,x),hn(u,qt()),g;switch(u.finishedWork=y,u.finishedLanes=x,d){case 0:case 1:throw Error(e(345));case 2:nl(u,un,Or);break;case 3:if(ao(u,x),(x&130023424)===x&&(d=Ow+500-qt(),10<d)){if(Dd(u,0)!==0)break;if(y=u.suspendedLanes,(y&x)!==x){Yi(),u.pingedLanes|=u.suspendedLanes&y;break}u.timeoutHandle=E0(nl.bind(null,u,un,Or),d);break}nl(u,un,Or);break;case 4:if(ao(u,x),(x&4194240)===x)break;for(d=u.eventTimes,y=-1;0<x;){var S=31-ks(x);v=1<<S,S=d[S],S>y&&(y=S),x&=~v}if(x=y,x=qt()-x,x=(120>x?120:480>x?480:1080>x?1080:1920>x?1920:3e3>x?3e3:4320>x?4320:1960*fB(x/1960))-x,10<x){u.timeoutHandle=E0(nl.bind(null,u,un,Or),x);break}nl(u,un,Or);break;case 5:nl(u,un,Or);break;default:throw Error(e(329))}}}return hn(u,qt()),u.callbackNode===g?jk.bind(null,u):null}function _w(u,d){var g=yu;return u.current.memoizedState.isDehydrated&&(il(u,d).flags|=256),u=If(u,d),u!==2&&(d=un,un=g,d!==null&&kw(d)),u}function kw(u){un===null?un=u:un.push.apply(un,u)}function mB(u){for(var d=u;;){if(d.flags&16384){var g=d.updateQueue;if(g!==null&&(g=g.stores,g!==null))for(var x=0;x<g.length;x++){var y=g[x],v=y.getSnapshot;y=y.value;try{if(!Ss(v(),y))return!1}catch{return!1}}}if(g=d.child,d.subtreeFlags&16384&&g!==null)g.return=d,d=g;else{if(d===u)break;for(;d.sibling===null;){if(d.return===null||d.return===u)return!0;d=d.return}d.sibling.return=d.return,d=d.sibling}}return!0}function ao(u,d){for(d&=~bw,d&=~Sf,u.suspendedLanes|=d,u.pingedLanes&=~d,u=u.expirationTimes;0<d;){var g=31-ks(d),x=1<<g;u[g]=-1,d&=~x}}function Xk(u){if((nt&6)!==0)throw Error(e(327));va();var d=Dd(u,0);if((d&1)===0)return hn(u,qt()),null;var g=If(u,d);if(u.tag!==0&&g===2){var x=i0(u);x!==0&&(d=x,g=_w(u,x))}if(g===1)throw g=Ou,il(u,0),ao(u,d),hn(u,qt()),g;if(g===6)throw Error(e(345));return u.finishedWork=u.current.alternate,u.finishedLanes=d,nl(u,un,Or),hn(u,qt()),null}function Sw(u,d){var g=nt;nt|=1;try{return u(d)}finally{nt=g,nt===0&&(ya=qt()+500,sf&&to())}}function tl(u){oo!==null&&oo.tag===0&&(nt&6)===0&&va();var d=nt;nt|=1;var g=Gn.transition,x=xt;try{if(Gn.transition=null,xt=1,u)return u()}finally{xt=x,Gn.transition=g,nt=d,(nt&6)===0&&to()}}function Cw(){Rn=Oa.current,Pt(Oa)}function il(u,d){u.finishedWork=null,u.finishedLanes=0;var g=u.timeoutHandle;if(g!==-1&&(u.timeoutHandle=-1,UL(g)),ni!==null)for(g=ni.return;g!==null;){var x=g;switch(L0(x),x.tag){case 1:x=x.type.childContextTypes,x!=null&&tf();break;case 3:wa(),Pt(ln),Pt(Mi),j0();break;case 5:H0(x);break;case 4:wa();break;case 13:Pt(Dt);break;case 19:Pt(Dt);break;case 10:F0(x.type._context);break;case 22:case 23:Cw()}g=g.return}if(pi=u,ni=u=co(u.current,null),Pi=Rn=d,ai=0,Ou=null,bw=Sf=el=0,un=yu=null,Yo!==null){for(d=0;d<Yo.length;d++)if(g=Yo[d],x=g.interleaved,x!==null){g.interleaved=null;var y=x.next,v=g.pending;if(v!==null){var S=v.next;v.next=y,x.next=S}g.pending=x}Yo=null}return u}function Gk(u,d){do{var g=ni;try{if(N0(),mf.current=xf,gf){for(var x=Qt.memoizedState;x!==null;){var y=x.queue;y!==null&&(y.pending=null),x=x.next}gf=!1}if(Jo=0,gi=li=Qt=null,mu=!1,gu=0,xw.current=null,g===null||g.return===null){ai=1,Ou=d,ni=null;break}e:{var v=u,S=g.return,A=g,R=d;if(d=Pi,A.flags|=32768,R!==null&&typeof R=="object"&&typeof R.then=="function"){var X=R,le=A,ce=le.tag;if((le.mode&1)===0&&(ce===0||ce===11||ce===15)){var re=le.alternate;re?(le.updateQueue=re.updateQueue,le.memoizedState=re.memoizedState,le.lanes=re.lanes):(le.updateQueue=null,le.memoizedState=null)}var _e=yk(S);if(_e!==null){_e.flags&=-257,vk(_e,S,A,v,d),_e.mode&1&&Ok(v,X,d),d=_e,R=X;var Ce=d.updateQueue;if(Ce===null){var Te=new Set;Te.add(R),d.updateQueue=Te}else Ce.add(R);break e}else{if((d&1)===0){Ok(v,X,d),Pw();break e}R=Error(e(426))}}else if(Rt&&A.mode&1){var jt=yk(S);if(jt!==null){(jt.flags&65536)===0&&(jt.flags|=256),vk(jt,S,A,v,d),D0(xa(R,A));break e}}v=R=xa(R,A),ai!==4&&(ai=2),yu===null?yu=[v]:yu.push(v),v=S;do{switch(v.tag){case 3:v.flags|=65536,d&=-d,v.lanes|=d;var z=xk(v,R,d);Z_(v,z);break e;case 1:A=R;var L=v.type,q=v.stateNode;if((v.flags&128)===0&&(typeof L.getDerivedStateFromError=="function"||q!==null&&typeof q.componentDidCatch=="function"&&(ro===null||!ro.has(q)))){v.flags|=65536,d&=-d,v.lanes|=d;var fe=bk(v,A,d);Z_(v,fe);break e}}v=v.return}while(v!==null)}Jk(g)}catch(Ae){d=Ae,ni===g&&g!==null&&(ni=g=g.return);continue}break}while(!0)}function Yk(){var u=kf.current;return kf.current=xf,u===null?xf:u}function Pw(){(ai===0||ai===3||ai===2)&&(ai=4),pi===null||(el&268435455)===0&&(Sf&268435455)===0||ao(pi,Pi)}function If(u,d){var g=nt;nt|=2;var x=Yk();(pi!==u||Pi!==d)&&(Or=null,il(u,d));do try{gB();break}catch(y){Gk(u,y)}while(!0);if(N0(),nt=g,kf.current=x,ni!==null)throw Error(e(261));return pi=null,Pi=0,ai}function gB(){for(;ni!==null;)Kk(ni)}function pB(){for(;ni!==null&&!FM();)Kk(ni)}function Kk(u){var d=iS(u.alternate,u,Rn);u.memoizedProps=u.pendingProps,d===null?Jk(u):ni=d,xw.current=null}function Jk(u){var d=u;do{var g=d.alternate;if(u=d.return,(d.flags&32768)===0){if(g=aB(g,d,Rn),g!==null){ni=g;return}}else{if(g=cB(g,d),g!==null){g.flags&=32767,ni=g;return}if(u!==null)u.flags|=32768,u.subtreeFlags=0,u.deletions=null;else{ai=6,ni=null;return}}if(d=d.sibling,d!==null){ni=d;return}ni=d=u}while(d!==null);ai===0&&(ai=5)}function nl(u,d,g){var x=xt,y=Gn.transition;try{Gn.transition=null,xt=1,wB(u,d,g,x)}finally{Gn.transition=y,xt=x}return null}function wB(u,d,g,x){do va();while(oo!==null);if((nt&6)!==0)throw Error(e(327));g=u.finishedWork;var y=u.finishedLanes;if(g===null)return null;if(u.finishedWork=null,u.finishedLanes=0,g===u.current)throw Error(e(177));u.callbackNode=null,u.callbackPriority=0;var v=g.lanes|g.childLanes;if(YM(u,v),u===pi&&(ni=pi=null,Pi=0),(g.subtreeFlags&2064)===0&&(g.flags&2064)===0||Pf||(Pf=!0,nS(Md,function(){return va(),null})),v=(g.flags&15990)!==0,(g.subtreeFlags&15990)!==0||v){v=Gn.transition,Gn.transition=null;var S=xt;xt=1;var A=nt;nt|=4,xw.current=null,hB(u,g),Wk(g,u),$L(P0),Fd=!!C0,P0=C0=null,u.current=g,dB(g),zM(),nt=A,xt=S,Gn.transition=v}else u.current=g;if(Pf&&(Pf=!1,oo=u,Tf=y),v=u.pendingLanes,v===0&&(ro=null),ZM(g.stateNode),hn(u,qt()),d!==null)for(x=u.onRecoverableError,g=0;g<d.length;g++)y=d[g],x(y.value,{componentStack:y.stack,digest:y.digest});if(Cf)throw Cf=!1,u=yw,yw=null,u;return(Tf&1)!==0&&u.tag!==0&&va(),v=u.pendingLanes,(v&1)!==0?u===vw?vu++:(vu=0,vw=u):vu=0,to(),null}function va(){if(oo!==null){var u=Fv(Tf),d=Gn.transition,g=xt;try{if(Gn.transition=null,xt=16>u?16:u,oo===null)var x=!1;else{if(u=oo,oo=null,Tf=0,(nt&6)!==0)throw Error(e(331));var y=nt;for(nt|=4,Se=u.current;Se!==null;){var v=Se,S=v.child;if((Se.flags&16)!==0){var A=v.deletions;if(A!==null){for(var R=0;R<A.length;R++){var X=A[R];for(Se=X;Se!==null;){var le=Se;switch(le.tag){case 0:case 11:case 15:bu(8,le,v)}var ce=le.child;if(ce!==null)ce.return=le,Se=ce;else for(;Se!==null;){le=Se;var re=le.sibling,_e=le.return;if(Dk(le),le===X){Se=null;break}if(re!==null){re.return=_e,Se=re;break}Se=_e}}}var Ce=v.alternate;if(Ce!==null){var Te=Ce.child;if(Te!==null){Ce.child=null;do{var jt=Te.sibling;Te.sibling=null,Te=jt}while(Te!==null)}}Se=v}}if((v.subtreeFlags&2064)!==0&&S!==null)S.return=v,Se=S;else e:for(;Se!==null;){if(v=Se,(v.flags&2048)!==0)switch(v.tag){case 0:case 11:case 15:bu(9,v,v.return)}var z=v.sibling;if(z!==null){z.return=v.return,Se=z;break e}Se=v.return}}var L=u.current;for(Se=L;Se!==null;){S=Se;var q=S.child;if((S.subtreeFlags&2064)!==0&&q!==null)q.return=S,Se=q;else e:for(S=L;Se!==null;){if(A=Se,(A.flags&2048)!==0)try{switch(A.tag){case 0:case 11:case 15:_f(9,A)}}catch(Ae){zt(A,A.return,Ae)}if(A===S){Se=null;break e}var fe=A.sibling;if(fe!==null){fe.return=A.return,Se=fe;break e}Se=A.return}}if(nt=y,to(),zs&&typeof zs.onPostCommitFiberRoot=="function")try{zs.onPostCommitFiberRoot(Ld,u)}catch{}x=!0}return x}finally{xt=g,Gn.transition=d}}return!1}function eS(u,d,g){d=xa(g,d),d=xk(u,d,1),u=no(u,d,1),d=Yi(),u!==null&&(Hc(u,1,d),hn(u,d))}function zt(u,d,g){if(u.tag===3)eS(u,u,g);else for(;d!==null;){if(d.tag===3){eS(d,u,g);break}else if(d.tag===1){var x=d.stateNode;if(typeof d.type.getDerivedStateFromError=="function"||typeof x.componentDidCatch=="function"&&(ro===null||!ro.has(x))){u=xa(g,u),u=bk(d,u,1),d=no(d,u,1),u=Yi(),d!==null&&(Hc(d,1,u),hn(d,u));break}}d=d.return}}function xB(u,d,g){var x=u.pingCache;x!==null&&x.delete(d),d=Yi(),u.pingedLanes|=u.suspendedLanes&g,pi===u&&(Pi&g)===g&&(ai===4||ai===3&&(Pi&130023424)===Pi&&500>qt()-Ow?il(u,0):bw|=g),hn(u,d)}function tS(u,d){d===0&&((u.mode&1)===0?d=1:(d=$d,$d<<=1,($d&130023424)===0&&($d=4194304)));var g=Yi();u=wr(u,d),u!==null&&(Hc(u,d,g),hn(u,g))}function bB(u){var d=u.memoizedState,g=0;d!==null&&(g=d.retryLane),tS(u,g)}function OB(u,d){var g=0;switch(u.tag){case 13:var x=u.stateNode,y=u.memoizedState;y!==null&&(g=y.retryLane);break;case 19:x=u.stateNode;break;default:throw Error(e(314))}x!==null&&x.delete(d),tS(u,g)}var iS;iS=function(u,d,g){if(u!==null)if(u.memoizedProps!==d.pendingProps||ln.current)cn=!0;else{if((u.lanes&g)===0&&(d.flags&128)===0)return cn=!1,lB(u,d,g);cn=(u.flags&131072)!==0}else cn=!1,Rt&&(d.flags&1048576)!==0&&L_(d,of,d.index);switch(d.lanes=0,d.tag){case 2:var x=d.type;yf(u,d),u=d.pendingProps;var y=ua(d,Mi.current);pa(d,g),y=Y0(null,d,x,u,y,g);var v=K0();return d.flags|=1,typeof y=="object"&&y!==null&&typeof y.render=="function"&&y.$$typeof===void 0?(d.tag=1,d.memoizedState=null,d.updateQueue=null,an(x)?(v=!0,nf(d)):v=!1,d.memoizedState=y.state!==null&&y.state!==void 0?y.state:null,U0(d),y.updater=bf,d.stateNode=y,y._reactInternals=d,sw(d,x,u,g),d=aw(null,d,x,!0,v,g)):(d.tag=0,Rt&&v&&M0(d),Gi(null,d,y,g),d=d.child),d;case 16:x=d.elementType;e:{switch(yf(u,d),u=d.pendingProps,y=x._init,x=y(x._payload),d.type=x,y=d.tag=vB(x),u=Ps(x,u),y){case 0:d=lw(null,d,x,u,g);break e;case 1:d=Tk(null,d,x,u,g);break e;case 11:d=_k(null,d,x,u,g);break e;case 14:d=kk(null,d,x,Ps(x.type,u),g);break e}throw Error(e(306,x,""))}return d;case 0:return x=d.type,y=d.pendingProps,y=d.elementType===x?y:Ps(x,y),lw(u,d,x,y,g);case 1:return x=d.type,y=d.pendingProps,y=d.elementType===x?y:Ps(x,y),Tk(u,d,x,y,g);case 3:e:{if(Ek(d),u===null)throw Error(e(387));x=d.pendingProps,v=d.memoizedState,y=v.element,U_(u,d),df(d,x,null,g);var S=d.memoizedState;if(x=S.element,v.isDehydrated)if(v={element:x,isDehydrated:!1,cache:S.cache,pendingSuspenseBoundaries:S.pendingSuspenseBoundaries,transitions:S.transitions},d.updateQueue.baseState=v,d.memoizedState=v,d.flags&256){y=xa(Error(e(423)),d),d=Ak(u,d,x,g,y);break e}else if(x!==y){y=xa(Error(e(424)),d),d=Ak(u,d,x,g,y);break e}else for(In=Kr(d.stateNode.containerInfo.firstChild),An=d,Rt=!0,Cs=null,g=z_(d,null,x,g),d.child=g;g;)g.flags=g.flags&-3|4096,g=g.sibling;else{if(fa(),x===y){d=br(u,d,g);break e}Gi(u,d,x,g)}d=d.child}return d;case 5:return q_(d),u===null&&$0(d),x=d.type,y=d.pendingProps,v=u!==null?u.memoizedProps:null,S=y.children,T0(x,y)?S=null:v!==null&&T0(x,v)&&(d.flags|=32),Pk(u,d),Gi(u,d,S,g),d.child;case 6:return u===null&&$0(d),null;case 13:return Ik(u,d,g);case 4:return Z0(d,d.stateNode.containerInfo),x=d.pendingProps,u===null?d.child=ma(d,null,x,g):Gi(u,d,x,g),d.child;case 11:return x=d.type,y=d.pendingProps,y=d.elementType===x?y:Ps(x,y),_k(u,d,x,y,g);case 7:return Gi(u,d,d.pendingProps,g),d.child;case 8:return Gi(u,d,d.pendingProps.children,g),d.child;case 12:return Gi(u,d,d.pendingProps.children,g),d.child;case 10:e:{if(x=d.type._context,y=d.pendingProps,v=d.memoizedProps,S=y.value,_t(cf,x._currentValue),x._currentValue=S,v!==null)if(Ss(v.value,S)){if(v.children===y.children&&!ln.current){d=br(u,d,g);break e}}else for(v=d.child,v!==null&&(v.return=d);v!==null;){var A=v.dependencies;if(A!==null){S=v.child;for(var R=A.firstContext;R!==null;){if(R.context===x){if(v.tag===1){R=xr(-1,g&-g),R.tag=2;var X=v.updateQueue;if(X!==null){X=X.shared;var le=X.pending;le===null?R.next=R:(R.next=le.next,le.next=R),X.pending=R}}v.lanes|=g,R=v.alternate,R!==null&&(R.lanes|=g),z0(v.return,g,d),A.lanes|=g;break}R=R.next}}else if(v.tag===10)S=v.type===d.type?null:v.child;else if(v.tag===18){if(S=v.return,S===null)throw Error(e(341));S.lanes|=g,A=S.alternate,A!==null&&(A.lanes|=g),z0(S,g,d),S=v.sibling}else S=v.child;if(S!==null)S.return=v;else for(S=v;S!==null;){if(S===d){S=null;break}if(v=S.sibling,v!==null){v.return=S.return,S=v;break}S=S.return}v=S}Gi(u,d,y.children,g),d=d.child}return d;case 9:return y=d.type,x=d.pendingProps.children,pa(d,g),y=jn(y),x=x(y),d.flags|=1,Gi(u,d,x,g),d.child;case 14:return x=d.type,y=Ps(x,d.pendingProps),y=Ps(x.type,y),kk(u,d,x,y,g);case 15:return Sk(u,d,d.type,d.pendingProps,g);case 17:return x=d.type,y=d.pendingProps,y=d.elementType===x?y:Ps(x,y),yf(u,d),d.tag=1,an(x)?(u=!0,nf(d)):u=!1,pa(d,g),pk(d,x,y),sw(d,x,y,g),aw(null,d,x,!0,u,g);case 19:return Vk(u,d,g);case 22:return Ck(u,d,g)}throw Error(e(156,d.tag))};function nS(u,d){return Bv(u,d)}function yB(u,d,g,x){this.tag=u,this.key=g,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=d,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=x,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Yn(u,d,g,x){return new yB(u,d,g,x)}function Tw(u){return u=u.prototype,!(!u||!u.isReactComponent)}function vB(u){if(typeof u=="function")return Tw(u)?1:0;if(u!=null){if(u=u.$$typeof,u===W)return 11;if(u===de)return 14}return 2}function co(u,d){var g=u.alternate;return g===null?(g=Yn(u.tag,d,u.key,u.mode),g.elementType=u.elementType,g.type=u.type,g.stateNode=u.stateNode,g.alternate=u,u.alternate=g):(g.pendingProps=d,g.type=u.type,g.flags=0,g.subtreeFlags=0,g.deletions=null),g.flags=u.flags&14680064,g.childLanes=u.childLanes,g.lanes=u.lanes,g.child=u.child,g.memoizedProps=u.memoizedProps,g.memoizedState=u.memoizedState,g.updateQueue=u.updateQueue,d=u.dependencies,g.dependencies=d===null?null:{lanes:d.lanes,firstContext:d.firstContext},g.sibling=u.sibling,g.index=u.index,g.ref=u.ref,g}function Rf(u,d,g,x,y,v){var S=2;if(x=u,typeof u=="function")Tw(u)&&(S=1);else if(typeof u=="string")S=5;else e:switch(u){case D:return sl(g.children,y,v,d);case b:S=8,y|=8;break;case I:return u=Yn(12,g,d,y|2),u.elementType=I,u.lanes=v,u;case H:return u=Yn(13,g,d,y),u.elementType=H,u.lanes=v,u;case te:return u=Yn(19,g,d,y),u.elementType=te,u.lanes=v,u;case ve:return Vf(g,y,v,d);default:if(typeof u=="object"&&u!==null)switch(u.$$typeof){case B:S=10;break e;case j:S=9;break e;case W:S=11;break e;case de:S=14;break e;case oe:S=16,x=null;break e}throw Error(e(130,u==null?u:typeof u,""))}return d=Yn(S,g,d,y),d.elementType=u,d.type=x,d.lanes=v,d}function sl(u,d,g,x){return u=Yn(7,u,x,d),u.lanes=g,u}function Vf(u,d,g,x){return u=Yn(22,u,x,d),u.elementType=ve,u.lanes=g,u.stateNode={isHidden:!1},u}function Ew(u,d,g){return u=Yn(6,u,null,d),u.lanes=g,u}function Aw(u,d,g){return d=Yn(4,u.children!==null?u.children:[],u.key,d),d.lanes=g,d.stateNode={containerInfo:u.containerInfo,pendingChildren:null,implementation:u.implementation},d}function _B(u,d,g,x,y){this.tag=d,this.containerInfo=u,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=n0(0),this.expirationTimes=n0(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=n0(0),this.identifierPrefix=x,this.onRecoverableError=y,this.mutableSourceEagerHydrationData=null}function Iw(u,d,g,x,y,v,S,A,R){return u=new _B(u,d,g,A,R),d===1?(d=1,v===!0&&(d|=8)):d=0,v=Yn(3,null,null,d),u.current=v,v.stateNode=u,v.memoizedState={element:x,isDehydrated:g,cache:null,transitions:null,pendingSuspenseBoundaries:null},U0(v),u}function kB(u,d,g){var x=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:G,key:x==null?null:""+x,children:u,containerInfo:d,implementation:g}}function sS(u){if(!u)return eo;u=u._reactInternals;e:{if(Ho(u)!==u||u.tag!==1)throw Error(e(170));var d=u;do{switch(d.tag){case 3:d=d.stateNode.context;break e;case 1:if(an(d.type)){d=d.stateNode.__reactInternalMemoizedMergedChildContext;break e}}d=d.return}while(d!==null);throw Error(e(171))}if(u.tag===1){var g=u.type;if(an(g))return R_(u,g,d)}return d}function rS(u,d,g,x,y,v,S,A,R){return u=Iw(g,x,!0,u,y,v,S,A,R),u.context=sS(null),g=u.current,x=Yi(),y=lo(g),v=xr(x,y),v.callback=d??null,no(g,v,y),u.current.lanes=y,Hc(u,y,x),hn(u,x),u}function Mf(u,d,g,x){var y=d.current,v=Yi(),S=lo(y);return g=sS(g),d.context===null?d.context=g:d.pendingContext=g,d=xr(v,S),d.payload={element:u},x=x===void 0?null:x,x!==null&&(d.callback=x),u=no(y,d,S),u!==null&&(As(u,y,S,v),hf(u,y,S)),S}function Lf(u){if(u=u.current,!u.child)return null;switch(u.child.tag){case 5:return u.child.stateNode;default:return u.child.stateNode}}function oS(u,d){if(u=u.memoizedState,u!==null&&u.dehydrated!==null){var g=u.retryLane;u.retryLane=g!==0&&g<d?g:d}}function Rw(u,d){oS(u,d),(u=u.alternate)&&oS(u,d)}function SB(){return null}var lS=typeof reportError=="function"?reportError:function(u){console.error(u)};function Vw(u){this._internalRoot=u}Bf.prototype.render=Vw.prototype.render=function(u){var d=this._internalRoot;if(d===null)throw Error(e(409));Mf(u,d,null,null)},Bf.prototype.unmount=Vw.prototype.unmount=function(){var u=this._internalRoot;if(u!==null){this._internalRoot=null;var d=u.containerInfo;tl(function(){Mf(null,u,null,null)}),d[fr]=null}};function Bf(u){this._internalRoot=u}Bf.prototype.unstable_scheduleHydration=function(u){if(u){var d=Uv();u={blockedOn:null,target:u,priority:d};for(var g=0;g<Xr.length&&d!==0&&d<Xr[g].priority;g++);Xr.splice(g,0,u),g===0&&qv(u)}};function Mw(u){return!(!u||u.nodeType!==1&&u.nodeType!==9&&u.nodeType!==11)}function $f(u){return!(!u||u.nodeType!==1&&u.nodeType!==9&&u.nodeType!==11&&(u.nodeType!==8||u.nodeValue!==" react-mount-point-unstable "))}function aS(){}function CB(u,d,g,x,y){if(y){if(typeof x=="function"){var v=x;x=function(){var X=Lf(S);v.call(X)}}var S=rS(d,x,u,0,null,!1,!1,"",aS);return u._reactRootContainer=S,u[fr]=S.current,ou(u.nodeType===8?u.parentNode:u),tl(),S}for(;y=u.lastChild;)u.removeChild(y);if(typeof x=="function"){var A=x;x=function(){var X=Lf(R);A.call(X)}}var R=Iw(u,0,!1,null,null,!1,!1,"",aS);return u._reactRootContainer=R,u[fr]=R.current,ou(u.nodeType===8?u.parentNode:u),tl(function(){Mf(d,R,g,x)}),R}function Df(u,d,g,x,y){var v=g._reactRootContainer;if(v){var S=v;if(typeof y=="function"){var A=y;y=function(){var R=Lf(S);A.call(R)}}Mf(d,S,u,y)}else S=CB(g,d,u,y,x);return Lf(S)}zv=function(u){switch(u.tag){case 3:var d=u.stateNode;if(d.current.memoizedState.isDehydrated){var g=Zc(d.pendingLanes);g!==0&&(s0(d,g|1),hn(d,qt()),(nt&6)===0&&(ya=qt()+500,to()))}break;case 13:tl(function(){var x=wr(u,1);if(x!==null){var y=Yi();As(x,u,1,y)}}),Rw(u,1)}},r0=function(u){if(u.tag===13){var d=wr(u,134217728);if(d!==null){var g=Yi();As(d,u,134217728,g)}Rw(u,134217728)}},Wv=function(u){if(u.tag===13){var d=lo(u),g=wr(u,d);if(g!==null){var x=Yi();As(g,u,d,x)}Rw(u,d)}},Uv=function(){return xt},Zv=function(u,d){var g=xt;try{return xt=u,d()}finally{xt=g}},Yp=function(u,d,g){switch(d){case"input":if(Xe(u,g),d=g.name,g.type==="radio"&&d!=null){for(g=u;g.parentNode;)g=g.parentNode;for(g=g.querySelectorAll("input[name="+JSON.stringify(""+d)+'][type="radio"]'),d=0;d<g.length;d++){var x=g[d];if(x!==u&&x.form===u.form){var y=ef(x);if(!y)throw Error(e(90));Me(x),Xe(x,y)}}}break;case"textarea":Ge(u,g);break;case"select":d=g.value,d!=null&&Xi(u,!!g.multiple,d,!1)}},Ev=Sw,Av=tl;var PB={usingClientEntryPoint:!1,Events:[cu,aa,ef,Pv,Tv,Sw]},_u={findFiberByHostInstance:qo,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},TB={bundleType:_u.bundleType,version:_u.version,rendererPackageName:_u.rendererPackageName,rendererConfig:_u.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Q.ReactCurrentDispatcher,findHostInstanceByFiber:function(u){return u=Mv(u),u===null?null:u.stateNode},findFiberByHostInstance:_u.findFiberByHostInstance||SB,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Qf=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Qf.isDisabled&&Qf.supportsFiber)try{Ld=Qf.inject(TB),zs=Qf}catch{}}return dn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=PB,dn.createPortal=function(u,d){var g=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Mw(d))throw Error(e(200));return kB(u,d,null,g)},dn.createRoot=function(u,d){if(!Mw(u))throw Error(e(299));var g=!1,x="",y=lS;return d!=null&&(d.unstable_strictMode===!0&&(g=!0),d.identifierPrefix!==void 0&&(x=d.identifierPrefix),d.onRecoverableError!==void 0&&(y=d.onRecoverableError)),d=Iw(u,1,!1,null,null,g,!1,x,y),u[fr]=d.current,ou(u.nodeType===8?u.parentNode:u),new Vw(d)},dn.findDOMNode=function(u){if(u==null)return null;if(u.nodeType===1)return u;var d=u._reactInternals;if(d===void 0)throw typeof u.render=="function"?Error(e(188)):(u=Object.keys(u).join(","),Error(e(268,u)));return u=Mv(d),u=u===null?null:u.stateNode,u},dn.flushSync=function(u){return tl(u)},dn.hydrate=function(u,d,g){if(!$f(d))throw Error(e(200));return Df(null,u,d,!0,g)},dn.hydrateRoot=function(u,d,g){if(!Mw(u))throw Error(e(405));var x=g!=null&&g.hydratedSources||null,y=!1,v="",S=lS;if(g!=null&&(g.unstable_strictMode===!0&&(y=!0),g.identifierPrefix!==void 0&&(v=g.identifierPrefix),g.onRecoverableError!==void 0&&(S=g.onRecoverableError)),d=rS(d,null,u,1,g??null,y,!1,v,S),u[fr]=d.current,ou(u),x)for(u=0;u<x.length;u++)g=x[u],y=g._getVersion,y=y(g._source),d.mutableSourceEagerHydrationData==null?d.mutableSourceEagerHydrationData=[g,y]:d.mutableSourceEagerHydrationData.push(g,y);return new Bf(d)},dn.render=function(u,d,g){if(!$f(d))throw Error(e(200));return Df(null,u,d,!1,g)},dn.unmountComponentAtNode=function(u){if(!$f(u))throw Error(e(40));return u._reactRootContainer?(tl(function(){Df(null,null,u,!1,function(){u._reactRootContainer=null,u[fr]=null})}),!0):!1},dn.unstable_batchedUpdates=Sw,dn.unstable_renderSubtreeIntoContainer=function(u,d,g,x){if(!$f(g))throw Error(e(200));if(u==null||u._reactInternals===void 0)throw Error(e(38));return Df(u,d,g,!1,x)},dn.version="18.3.1-next-f1338f8080-20240426",dn}var pS;function QB(){if(pS)return $w.exports;pS=1;function s(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(s)}catch(t){console.error(t)}}return s(),$w.exports=DB(),$w.exports}var wS;function NB(){if(wS)return Nf;wS=1;var s=QB();return Nf.createRoot=s.createRoot,Nf.hydrateRoot=s.hydrateRoot,Nf}var FB=NB();const zB=ld(FB);/**
 * @license Copyright (c) 2003-2025, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options
 */function WB(){const s={resolve:null,promise:null};return s.promise=new Promise(t=>{s.resolve=t}),s}/**
 * @license Copyright (c) 2003-2025, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options
 */function UB(s){let t=null;return(...e)=>(t||(t={current:s(...e)}),t.current)}/**
 * @license Copyright (c) 2003-2025, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options
 */const Di=new Array(256).fill("").map((s,t)=>("0"+t.toString(16)).slice(-2));function ZB(){const[s,t,e,i]=crypto.getRandomValues(new Uint32Array(4));return"e"+Di[s>>0&255]+Di[s>>8&255]+Di[s>>16&255]+Di[s>>24&255]+Di[t>>0&255]+Di[t>>8&255]+Di[t>>16&255]+Di[t>>24&255]+Di[e>>0&255]+Di[e>>8&255]+Di[e>>16&255]+Di[e>>24&255]+Di[i>>0&255]+Di[i>>8&255]+Di[i>>16&255]+Di[i>>24&255]}/**
 * @license Copyright (c) 2003-2025, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options
 */function HB(s,t){const e=s.extraPlugins||[];return{...s,extraPlugins:[...e,...t.filter(i=>!e.includes(i))]}}/**
 * @license Copyright (c) 2003-2025, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options
 */function KE(s){return!!s&&/^\d+\.\d+\.\d+/.test(s)}/**
 * @license Copyright (c) 2003-2025, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options
 */function JE(s){return s?["nightly","alpha","internal","nightly-","staging"].some(t=>s.includes(t)):!1}function qB(s){return KE(s)||JE(s)}/**
 * @license Copyright (c) 2003-2025, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options
 */function jB(s){if(!KE(s))throw new Error(`Invalid semantic version: ${s||"<blank>"}.`);const[t,e,i]=s.split(".");return{major:Number.parseInt(t,10),minor:Number.parseInt(e,10),patch:Number.parseInt(i,10)}}/**
 * @license Copyright (c) 2003-2025, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options
 */function XB(s){if(JE(s))return 3;const{major:t}=jB(s);switch(!0){case t>=44:return 3;case t>=38:return 2;default:return 1}}/**
 * @license Copyright (c) 2003-2025, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options
 */function GB(){const{CKEDITOR_VERSION:s,CKEDITOR:t}=window;return qB(s)?{source:t?"cdn":"npm",version:s}:null}/**
 * @license Copyright (c) 2003-2025, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options
 */function YB(){const s=GB();return s?XB(s.version):null}/**
 * @license Copyright (c) 2003-2025, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options
 */function e6(s,t){switch(t||(t=YB()||void 0),t){case 1:case 2:return s===void 0;case 3:return s==="GPL";default:return!1}}/**
 * @license Copyright (c) 2003-2025, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options
 */function KB(s,t){return function(i){e6(i.config.get("licenseKey"))||i.on("collectUsageData",(n,{setUsageData:r})=>{r(`integration.${s}`,t)})}}var JB=Object.defineProperty,e$=(s,t,e)=>t in s?JB(s,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):s[t]=e,mn=(s,t,e)=>e$(s,typeof t!="symbol"?t+"":t,e);/**
 * @license Copyright (c) 2003-2025, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options
 */const t6=class i6{constructor(t,e){mn(this,"_lifecycle"),mn(this,"_element"),mn(this,"_releaseLock",null),mn(this,"_value",null),mn(this,"_afterMountCallbacks",[]),mn(this,"_state",{destroyedBeforeInitialization:!1,mountingInProgress:null}),mn(this,"release",UB(()=>{const{_releaseLock:i,_state:n,_element:r,_lifecycle:o}=this;n.mountingInProgress?n.mountingInProgress.then(()=>o.unmount({element:r,mountResult:this.value})).catch(l=>{console.error("Semaphore unmounting error:",l)}).then(i.resolve).then(()=>{this._value=null}):(n.destroyedBeforeInitialization=!0,i.resolve())})),this._element=t,this._lifecycle=e,this._lock()}get value(){return this._value}unsafeSetValue(t){this._value=t,this._afterMountCallbacks.forEach(e=>e(t)),this._afterMountCallbacks=[]}runAfterMount(t){const{_value:e,_afterMountCallbacks:i}=this;e?t(e):i.push(t)}_lock(){const{_semaphores:t}=i6,{_state:e,_element:i,_lifecycle:n}=this,r=t.get(i)||Promise.resolve(null),o=WB();this._releaseLock=o;const l=r.then(()=>e.destroyedBeforeInitialization?Promise.resolve(void 0):(e.mountingInProgress=n.mount().then(a=>(a&&this.unsafeSetValue(a),a)),e.mountingInProgress)).then(async a=>{a&&n.afterMount&&await n.afterMount({element:i,mountResult:a})}).then(()=>o.promise).catch(a=>{console.error("Semaphore mounting error:",a)}).then(()=>{t.get(i)===l&&t.delete(i)});t.set(i,l)}};mn(t6,"_semaphores",new Map);let t$=t6;/**
 * @license Copyright (c) 2003-2025, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options
 */const i$="$__CKEditorReactContextMetadata";function n$(s,t){return{...t,[i$]:s}}/**
 * @license Copyright (c) 2003-2025, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options
 */const s$=ko.createContext(null),r$=s=>!!s&&typeof s=="object"&&"status"in s&&["initializing","initialized","error"].includes(s.status),n6=s=>t=>r$(t)&&t.status===s,xS=n6("initializing"),o$=s=>n6("initialized")(s)&&s.watchdog.state==="ready";/**
 * @license Copyright (c) 2003-2025, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options
 */const l$=KB("react",{version:"9.5.0",frameworkVersion:ko.version});/**
 * @license Copyright (c) 2003-2025, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options
 */function a$(s){return e6(s.licenseKey)?s:HB(s,[l$])}/**
 * @license Copyright (c) 2003-2025, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options
 */const Nw="Lock from React integration (@ckeditor/ckeditor5-react)";class s6 extends ko.Component{constructor(t){super(t),mn(this,"domContainer",ko.createRef()),mn(this,"editorSemaphore",null),this._checkVersion()}_checkVersion(){const{CKEDITOR_VERSION:t}=window;if(!t)return console.warn('Cannot find the "CKEDITOR_VERSION" in the "window" scope.');const[e]=t.split(".").map(Number);e>=42||t.startsWith("0.0.0")||console.warn("The <CKEditor> component requires using CKEditor 5 in version 42+ or nightly build.")}get _semaphoreValue(){const{editorSemaphore:t}=this;return t?t.value:null}get watchdog(){const{_semaphoreValue:t}=this;return t?t.watchdog:null}get editor(){const{_semaphoreValue:t}=this;return t?t.instance:null}shouldComponentUpdate(t){const{props:e,editorSemaphore:i}=this;return t.id!==e.id||t.disableWatchdog!==e.disableWatchdog?!0:(i&&(i.runAfterMount(({instance:n})=>{this._shouldUpdateEditorData(e,t,n)&&n.data.set(t.data)}),"disabled"in t&&i.runAfterMount(({instance:n})=>{t.disabled?n.enableReadOnlyMode(Nw):n.disableReadOnlyMode(Nw)})),!1)}componentDidMount(){xS(this.context)||this._initLifeCycleSemaphore()}componentDidUpdate(){xS(this.context)||this._initLifeCycleSemaphore()}componentWillUnmount(){this._unlockLifeCycleSemaphore()}_unlockLifeCycleSemaphore(){this.editorSemaphore&&(this.editorSemaphore.release(),this.editorSemaphore=null)}_initLifeCycleSemaphore(){this._unlockLifeCycleSemaphore(),this.editorSemaphore=new t$(this.domContainer.current,{mount:async()=>this._initializeEditor(),afterMount:({mountResult:t})=>{const{onReady:e}=this.props;e&&this.domContainer.current!==null&&e(t.instance)},unmount:async({element:t,mountResult:e})=>{const{onAfterDestroy:i}=this.props;try{await this._destroyEditor(e),t.innerHTML=""}finally{i&&i(e.instance)}}})}render(){return ko.createElement("div",{ref:this.domContainer})}async _initializeEditor(){if(this.props.disableWatchdog)return{instance:await this._createEditor(this.domContainer.current,this._getConfig()),watchdog:null};const t=o$(this.context)?new c$(this.context.watchdog):new this.props.editor.EditorWatchdog(this.props.editor,this.props.watchdogConfig),e={current:0};return t.setCreator(async(i,n)=>{var r;const{editorSemaphore:o}=this,{onAfterDestroy:l}=this.props;e.current>0&&l&&((r=o==null?void 0:o.value)!=null&&r.instance)&&l(o.value.instance);const a=await this._createEditor(i,n);return o&&e.current>0&&(o.unsafeSetValue({instance:a,watchdog:t}),setTimeout(()=>{this.props.onReady&&this.props.onReady(t.editor)})),e.current++,a}),t.on("error",(i,{error:n,causesRestart:r})=>{(this.props.onError||console.error)(n,{phase:"runtime",willEditorRestart:r})}),await t.create(this.domContainer.current,this._getConfig()).catch(i=>{(this.props.onError||console.error)(i,{phase:"initialization",willEditorRestart:!1})}),{watchdog:t,instance:t.editor}}_createEditor(t,e){const{contextItemMetadata:i}=this.props;return i&&(e=n$(i,e)),this.props.editor.create(t,a$(e)).then(n=>{if("disabled"in this.props){/* istanbul ignore else -- @preserve */this.props.disabled&&n.enableReadOnlyMode(Nw)}const r=n.model.document,o=n.editing.view.document;return r.on("change:data",l=>{/* istanbul ignore else -- @preserve */this.props.onChange&&this.props.onChange(l,n)}),o.on("focus",l=>{/* istanbul ignore else -- @preserve */this.props.onFocus&&this.props.onFocus(l,n)}),o.on("blur",l=>{/* istanbul ignore else -- @preserve */this.props.onBlur&&this.props.onBlur(l,n)}),n})}async _destroyEditor(t){const{watchdog:e,instance:i}=t;return new Promise((n,r)=>{/* istanbul ignore next -- @preserve */setTimeout(async()=>{try{if(e)return await e.destroy(),n();if(i)return await i.destroy(),n();n()}catch(o){console.error(o),r(o)}})})}_shouldUpdateEditorData(t,e,i){return!(t.data===e.data||i.data.get()===e.data)}_getConfig(){const t=this.props.config||{};return this.props.data&&t.initialData&&console.warn("Editor data should be provided either using `config.initialData` or `content` property. The config value takes precedence over `content` property and will be used when both are specified."),{...t,initialData:t.initialData||this.props.data||""}}}mn(s6,"contextType",s$);class c${constructor(t){mn(this,"_contextWatchdog"),mn(this,"_id"),mn(this,"_creator"),this._contextWatchdog=t,this._id=ZB()}setCreator(t){this._creator=t}create(t,e){return this._contextWatchdog.add({sourceElementOrData:t,config:e,creator:this._creator,id:this._id,type:"editor"})}on(t,e){this._contextWatchdog.on("itemError",(i,{itemId:n,error:r})=>{n===this._id&&e(null,{error:r,causesRestart:void 0})})}destroy(){return this._contextWatchdog.state==="ready"?this._contextWatchdog.remove(this._id):Promise.resolve()}get editor(){return this._contextWatchdog.getItem(this._id)}}/**
 * @license Copyright (c) 2003-2025, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options
 */function r6(...s){return t=>{s.forEach(e=>{typeof e=="function"?e(t):e!=null&&(e.current=t)})}}const u$=pn.memo(pn.forwardRef(({id:s,semaphore:t,rootName:e},i)=>{const n=pn.useRef(null);return pn.useEffect(()=>{let r,o;return t.runAfterMount(({instance:l})=>{if(!n.current)return;o=l;const{ui:a,model:c}=o,h=c.document.getRoot(e);h&&o.ui.getEditableElement(e)&&o.detachEditable(h),r=a.view.createEditable(e,n.current),a.addEditable(r),l.editing.view.forceRender()}),()=>{if(o&&o.state!=="destroyed"&&n.current){const l=o.model.document.getRoot(e);/* istanbul ignore else -- @preserve */l&&o.detachEditable(l)}}},[t.revision]),ko.createElement("div",{key:t.revision,id:s,ref:r6(i,n)})}));u$.displayName="EditorEditable";const h$=pn.forwardRef(({editor:s},t)=>{const e=pn.useRef(null);return pn.useEffect(()=>{const i=e.current;if(!s||!i)return;const n=s.ui.view.toolbar.element;return i.appendChild(n),()=>{i.contains(n)&&i.removeChild(n)}},[s&&s.id]),ko.createElement("div",{ref:r6(e,t)})});h$.displayName="EditorToolbarWrapper";function d$(s,t){const e={};for(let i=0;i<s.length;i++){const n=s[i],r=t(n);Object.hasOwn(e,r)||(e[r]=[]),e[r].push(n)}return e}function $a(s){return s}function lg(){}function SO(s){return s==null||typeof s!="object"&&typeof s!="function"}function CO(s){return ArrayBuffer.isView(s)&&!(s instanceof DataView)}function PO(s){if(SO(s))return s;if(Array.isArray(s)||CO(s)||s instanceof ArrayBuffer||typeof SharedArrayBuffer<"u"&&s instanceof SharedArrayBuffer)return s.slice(0);const t=Object.getPrototypeOf(s),e=t.constructor;if(s instanceof Date||s instanceof Map||s instanceof Set)return new e(s);if(s instanceof RegExp){const i=new e(s);return i.lastIndex=s.lastIndex,i}if(s instanceof DataView)return new e(s.buffer.slice(0));if(s instanceof Error){const i=new e(s.message);return i.stack=s.stack,i.name=s.name,i.cause=s.cause,i}if(typeof File<"u"&&s instanceof File)return new e([s],s.name,{type:s.type,lastModified:s.lastModified});if(typeof s=="object"){const i=Object.create(t);return Object.assign(i,s)}return s}function bS(s){if(!s||typeof s!="object")return!1;const t=Object.getPrototypeOf(s);return t===null||t===Object.prototype||Object.getPrototypeOf(t)===null?Object.prototype.toString.call(s)==="[object Object]":!1}function vb(s){return typeof s=="object"&&s!==null}function ag(s){return Object.getOwnPropertySymbols(s).filter(t=>Object.prototype.propertyIsEnumerable.call(s,t))}function cg(s){return s==null?s===void 0?"[object Undefined]":"[object Null]":Object.prototype.toString.call(s)}const o6="[object RegExp]",TO="[object String]",EO="[object Number]",AO="[object Boolean]",ug="[object Arguments]",l6="[object Symbol]",a6="[object Date]",c6="[object Map]",u6="[object Set]",h6="[object Array]",f$="[object Function]",d6="[object ArrayBuffer]",Im="[object Object]",m$="[object Error]",f6="[object DataView]",m6="[object Uint8Array]",g6="[object Uint8ClampedArray]",p6="[object Uint16Array]",w6="[object Uint32Array]",g$="[object BigUint64Array]",x6="[object Int8Array]",b6="[object Int16Array]",O6="[object Int32Array]",p$="[object BigInt64Array]",y6="[object Float32Array]",v6="[object Float64Array]";function w$(s,t){return Ha(s,void 0,s,new Map,t)}function Ha(s,t,e,i=new Map,n=void 0){const r=n==null?void 0:n(s,t,e,i);if(r!=null)return r;if(SO(s))return s;if(i.has(s))return i.get(s);if(Array.isArray(s)){const o=new Array(s.length);i.set(s,o);for(let l=0;l<s.length;l++)o[l]=Ha(s[l],l,e,i,n);return Object.hasOwn(s,"index")&&(o.index=s.index),Object.hasOwn(s,"input")&&(o.input=s.input),o}if(s instanceof Date)return new Date(s.getTime());if(s instanceof RegExp){const o=new RegExp(s.source,s.flags);return o.lastIndex=s.lastIndex,o}if(s instanceof Map){const o=new Map;i.set(s,o);for(const[l,a]of s)o.set(l,Ha(a,l,e,i,n));return o}if(s instanceof Set){const o=new Set;i.set(s,o);for(const l of s)o.add(Ha(l,void 0,e,i,n));return o}if(typeof Buffer<"u"&&Buffer.isBuffer(s))return s.subarray();if(CO(s)){const o=new(Object.getPrototypeOf(s)).constructor(s.length);i.set(s,o);for(let l=0;l<s.length;l++)o[l]=Ha(s[l],l,e,i,n);return o}if(s instanceof ArrayBuffer||typeof SharedArrayBuffer<"u"&&s instanceof SharedArrayBuffer)return s.slice(0);if(s instanceof DataView){const o=new DataView(s.buffer.slice(0),s.byteOffset,s.byteLength);return i.set(s,o),gl(o,s,e,i,n),o}if(typeof File<"u"&&s instanceof File){const o=new File([s],s.name,{type:s.type});return i.set(s,o),gl(o,s,e,i,n),o}if(s instanceof Blob){const o=new Blob([s],{type:s.type});return i.set(s,o),gl(o,s,e,i,n),o}if(s instanceof Error){const o=new s.constructor;return i.set(s,o),o.message=s.message,o.name=s.name,o.stack=s.stack,o.cause=s.cause,gl(o,s,e,i,n),o}if(typeof s=="object"&&x$(s)){const o=Object.create(Object.getPrototypeOf(s));return i.set(s,o),gl(o,s,e,i,n),o}return s}function gl(s,t,e=s,i,n){const r=[...Object.keys(t),...ag(t)];for(let o=0;o<r.length;o++){const l=r[o],a=Object.getOwnPropertyDescriptor(s,l);(a==null||a.writable)&&(s[l]=Ha(t[l],l,e,i,n))}}function x$(s){switch(cg(s)){case ug:case h6:case d6:case f6:case AO:case a6:case y6:case v6:case x6:case b6:case O6:case c6:case EO:case Im:case o6:case u6:case TO:case l6:case m6:case g6:case p6:case w6:return!0;default:return!1}}function _6(s,t){return s===t||Number.isNaN(s)&&Number.isNaN(t)}function k6(s,t,e){return qu(s,t,void 0,void 0,void 0,void 0,e)}function qu(s,t,e,i,n,r,o){const l=o(s,t,e,i,n,r);if(l!==void 0)return l;if(typeof s==typeof t)switch(typeof s){case"bigint":case"string":case"boolean":case"symbol":case"undefined":return s===t;case"number":return s===t||Object.is(s,t);case"function":return s===t;case"object":return rh(s,t,r,o)}return rh(s,t,r,o)}function rh(s,t,e,i){if(Object.is(s,t))return!0;let n=cg(s),r=cg(t);if(n===ug&&(n=Im),r===ug&&(r=Im),n!==r)return!1;switch(n){case TO:return s.toString()===t.toString();case EO:{const a=s.valueOf(),c=t.valueOf();return _6(a,c)}case AO:case a6:case l6:return Object.is(s.valueOf(),t.valueOf());case o6:return s.source===t.source&&s.flags===t.flags;case f$:return s===t}e=e??new Map;const o=e.get(s),l=e.get(t);if(o!=null&&l!=null)return o===t;e.set(s,t),e.set(t,s);try{switch(n){case c6:{if(s.size!==t.size)return!1;for(const[a,c]of s.entries())if(!t.has(a)||!qu(c,t.get(a),a,s,t,e,i))return!1;return!0}case u6:{if(s.size!==t.size)return!1;const a=Array.from(s.values()),c=Array.from(t.values());for(let h=0;h<a.length;h++){const f=a[h],m=c.findIndex(w=>qu(f,w,void 0,s,t,e,i));if(m===-1)return!1;c.splice(m,1)}return!0}case h6:case m6:case g6:case p6:case w6:case g$:case x6:case b6:case O6:case p$:case y6:case v6:{if(typeof Buffer<"u"&&Buffer.isBuffer(s)!==Buffer.isBuffer(t)||s.length!==t.length)return!1;for(let a=0;a<s.length;a++)if(!qu(s[a],t[a],a,s,t,e,i))return!1;return!0}case d6:return s.byteLength!==t.byteLength?!1:rh(new Uint8Array(s),new Uint8Array(t),e,i);case f6:return s.byteLength!==t.byteLength||s.byteOffset!==t.byteOffset?!1:rh(new Uint8Array(s),new Uint8Array(t),e,i);case m$:return s.name===t.name&&s.message===t.message;case Im:{if(!(rh(s.constructor,t.constructor,e,i)||bS(s)&&bS(t)))return!1;const c=[...Object.keys(s),...ag(s)],h=[...Object.keys(t),...ag(t)];if(c.length!==h.length)return!1;for(let f=0;f<c.length;f++){const m=c[f],w=s[m];if(!Object.hasOwn(t,m))return!1;const O=t[m];if(!qu(w,O,m,s,t,e,i))return!1}return!0}default:return!1}}finally{e.delete(s),e.delete(t)}}function Cl(s,t){return k6(s,t,lg)}function hg(s){return typeof s=="function"}function b$(s){return Number.isSafeInteger(s)&&s>=0}const O$=new RegExp("\\p{Lu}?\\p{Ll}+|[0-9]+|\\p{Lu}+(?!\\p{Ll})|\\p{Emoji_Presentation}|\\p{Extended_Pictographic}|\\p{L}+","gu");function y$(s){return Array.from(s.match(O$)??[])}function v$(s){return s!=null&&typeof s!="function"&&b$(s.length)}function S6(s){switch(typeof s){case"number":case"symbol":return!1;case"string":return s.includes(".")||s.includes("[")||s.includes("]")}}function C6(s){return Object.is(s,-0)?"-0":s.toString()}function IO(s){const t=[],e=s.length;if(e===0)return t;let i=0,n="",r="",o=!1;for(s.charCodeAt(0)===46&&(t.push(""),i++);i<e;){const l=s[i];r?l==="\\"&&i+1<e?(i++,n+=s[i]):l===r?r="":n+=l:o?l==='"'||l==="'"?r=l:l==="]"?(o=!1,t.push(n),n=""):n+=l:l==="["?(o=!0,n&&(t.push(n),n="")):l==="."?n&&(t.push(n),n=""):n+=l,i++}return n&&t.push(n),t}function Eo(s,t,e){if(s==null)return e;switch(typeof t){case"string":{const i=s[t];return i===void 0?S6(t)?Eo(s,IO(t),e):e:i}case"number":case"symbol":{typeof t=="number"&&(t=C6(t));const i=s[t];return i===void 0?e:i}default:{if(Array.isArray(t))return _$(s,t,e);Object.is(t==null?void 0:t.valueOf(),-0)?t="-0":t=String(t);const i=s[t];return i===void 0?e:i}}}function _$(s,t,e){if(t.length===0)return e;let i=s;for(let n=0;n<t.length;n++){if(i==null)return e;i=i[t[n]]}return i===void 0?e:i}function k$(s){return function(t){return Eo(t,s)}}function ds(s){return s!==null&&(typeof s=="object"||typeof s=="function")}function bp(s,t){return w$(s,(e,i,n,r)=>{const o=t==null?void 0:t(e,i,n,r);if(o!=null)return o;if(typeof s=="object")switch(Object.prototype.toString.call(s)){case EO:case TO:case AO:{const l=new s.constructor(s==null?void 0:s.valueOf());return gl(l,s),l}case ug:{const l={};return gl(l,s),l.length=s.length,l[Symbol.iterator]=s[Symbol.iterator],l}default:return}})}function _n(s){return bp(s)}const S$=/^(?:0|[1-9]\d*)$/;function C$(s,t=Number.MAX_SAFE_INTEGER){switch(typeof s){case"number":return Number.isInteger(s)&&s>=0&&s<t;case"symbol":return!1;case"string":return S$.test(s)}}function OS(s){return s!==null&&typeof s=="object"&&cg(s)==="[object Arguments]"}function P$(s){return typeof s=="symbol"||s instanceof Symbol}function T$(s){return P$(s)?NaN:Number(s)}function E$(s){return s?(s=T$(s),s===1/0||s===-1/0?(s<0?-1:1)*Number.MAX_VALUE:s===s?s:0):s===0?s:0}function A$(s){const t=E$(s),e=t%1;return e?t-e:t}function yS(s){return typeof s=="string"||s instanceof String}function P6(s,t,e){const i=Array.isArray(t)?t:typeof t=="string"?IO(t):[t];let n=s;for(let o=0;o<i.length-1;o++){const l=i[o],a=i[o+1];n[l]==null&&(n[l]=C$(a)?[]:{}),n=n[l]}const r=i[i.length-1];return n[r]=e,s}function I$(s,t,{signal:e,edges:i}={}){let n,r=null;const o=i!=null&&i.includes("leading"),l=i==null||i.includes("trailing"),a=()=>{r!==null&&(s.apply(n,r),n=void 0,r=null)},c=()=>{l&&a(),w()};let h=null;const f=()=>{h!=null&&clearTimeout(h),h=setTimeout(()=>{h=null,c()},t)},m=()=>{h!==null&&(clearTimeout(h),h=null)},w=()=>{m(),n=void 0,r=null},O=()=>{m(),a()},_=function(...k){if(e!=null&&e.aborted)return;n=this,r=k;const C=h==null;f(),o&&C&&a()};return _.schedule=f,_.cancel=w,_.flush=O,e==null||e.addEventListener("abort",w,{once:!0}),_}function fs(s,t=0,e={}){typeof e!="object"&&(e={});const{signal:i,leading:n=!1,trailing:r=!0,maxWait:o}=e,l=Array(2);n&&(l[0]="leading"),r&&(l[1]="trailing");let a,c=null;const h=I$(function(...w){a=s.apply(this,w),c=null},t,{signal:i,edges:l}),f=function(...w){if(o!=null){if(c===null)c=Date.now();else if(Date.now()-c>=o)return a=s.apply(this,w),c=Date.now(),h.cancel(),h.schedule(),a}return h.apply(this,w),a},m=()=>(h.flush(),a);return f.cancel=h.cancel,f.flush=m,f}function hc(s,t=0,e={}){typeof e!="object"&&(e={});const{leading:i=!0,trailing:n=!0,signal:r}=e;return fs(s,t,{leading:i,trailing:n,signal:r,maxWait:t})}function Ec(s){if(s==null)return"";if(Array.isArray(s))return s.map(Ec).join(",");const t=String(s);return t==="0"&&Object.is(Number(s),-0)?"-0":t}function R$(s){return typeof Buffer<"u"&&Buffer.isBuffer(s)}function V$(s){const t=s==null?void 0:s.constructor,e=typeof t=="function"?t.prototype:Object.prototype;return s===e}function T6(s){return CO(s)}function M$(s,t){if(s=A$(s),s<1||!Number.isSafeInteger(s))return[];const e=new Array(s);for(let i=0;i<s;i++)e[i]=typeof t=="function"?t(i):i;return e}function L$(s){if(s==null)return[];switch(typeof s){case"object":case"function":return v$(s)?$$(s):V$(s)?B$(s):dg(s);default:return dg(Object(s))}}function dg(s){const t=[];for(const e in s)t.push(e);return t}function B$(s){return dg(s).filter(e=>e!=="constructor")}function $$(s){const t=M$(s.length,i=>`${i}`),e=new Set(t);return R$(s)&&(e.add("offset"),e.add("parent")),T6(s)&&(e.add("buffer"),e.add("byteLength"),e.add("byteOffset")),[...t,...dg(s).filter(i=>!e.has(i))]}function E6(s,...t){for(let e=0;e<t.length;e++)D$(s,t[e]);return s}function D$(s,t){const e=L$(t);for(let i=0;i<e.length;i++){const n=e[i];_6(s[n],t[n])||(s[n]=t[n])}}function vS(s,t){const e={},i=Object.keys(s);for(let n=0;n<i.length;n++){const r=i[n],o=s[r];e[r]=t(o,r,s)}return e}function Q$(s,t){switch(t=t??$a,typeof t){case"string":case"symbol":case"number":case"object":return vS(s,k$(t));case"function":return vS(s,t)}}function Vs(s){var e;if(typeof s!="object"||s==null)return!1;if(Object.getPrototypeOf(s)===null)return!0;if(Object.prototype.toString.call(s)!=="[object Object]"){const i=s[Symbol.toStringTag];return i==null||!((e=Object.getOwnPropertyDescriptor(s,Symbol.toStringTag))!=null&&e.writable)?!1:s.toString()===`[object ${i}]`}let t=s;for(;Object.getPrototypeOf(t)!==null;)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(s)===t}function A6(s,...t){const e=t.slice(0,-1),i=t[t.length-1];let n=s;for(let r=0;r<e.length;r++){const o=e[r];n=Rm(n,o,i,new Map)}return n}function Rm(s,t,e,i){if(SO(s)&&(s=Object(s)),t==null||typeof t!="object")return s;if(i.has(t))return PO(i.get(t));if(i.set(t,s),Array.isArray(t)){t=t.slice();for(let r=0;r<t.length;r++)t[r]=t[r]??void 0}const n=[...Object.keys(t),...ag(t)];for(let r=0;r<n.length;r++){const o=n[r];let l=t[o],a=s[o];if(OS(l)&&(l={...l}),OS(a)&&(a={...a}),typeof Buffer<"u"&&Buffer.isBuffer(l)&&(l=_n(l)),Array.isArray(l))if(typeof a=="object"&&a!=null){const h=[],f=Reflect.ownKeys(a);for(let m=0;m<f.length;m++){const w=f[m];h[w]=a[w]}a=h}else a=[];const c=e(a,l,o,s,t,i);c!=null?s[o]=c:Array.isArray(l)||vb(a)&&vb(l)?s[o]=Rm(a,l,e,i):a==null&&Vs(l)?s[o]=Rm({},l,e,i):a==null&&T6(l)?s[o]=_n(l):(a===void 0||l!==void 0)&&(s[o]=l)}return s}function RO(s,...t){return A6(s,...t,lg)}function N$(s,t){if(s==null)return!0;switch(typeof t){case"symbol":case"number":case"object":{if(Array.isArray(t))return _S(s,t);if(typeof t=="number"?t=C6(t):typeof t=="object"&&(Object.is(t==null?void 0:t.valueOf(),-0)?t="-0":t=String(t)),(s==null?void 0:s[t])===void 0)return!0;try{return delete s[t],!0}catch{return!1}}case"string":{if((s==null?void 0:s[t])===void 0&&S6(t))return _S(s,IO(t));try{return delete s[t],!0}catch{return!1}}}}function _S(s,t){const e=Eo(s,t.slice(0,-1),s),i=t[t.length-1];if((e==null?void 0:e[i])===void 0)return!0;try{return delete e[i],!0}catch{return!1}}function Ao(s){return vb(s)&&s.nodeType===1&&!Vs(s)}function kS(s,t){if(!Number.isInteger(s)||s<0)throw new Error("n must be a non-negative integer.");let e=0;return(...i)=>{if(++e>=s)return t(...i)}}function _b(s,t,e=lg){return typeof e!="function"&&(e=lg),k6(s,t,(...i)=>{const n=e(...i);if(n!==void 0)return!!n;if(s instanceof Map&&t instanceof Map||s instanceof Set&&t instanceof Set)return _b(Array.from(s),Array.from(t),kS(2,e))})}function F$(s){return typeof s!="string"&&(s=Ec(s)),s.replace(/['\u2019]/g,"")}const z$={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"};function W$(s){return s.replace(/[&<>"']/g,t=>z$[t])}function U$(s){return W$(Ec(s))}function Z$(s){return s.replace(/[\\^$.*+?()[\]{}|]/g,"\\$&")}function VO(s){return Z$(Ec(s))}function H$(s){const t=y$(F$(s).trim());let e="";for(let i=0;i<t.length;i++){const n=t[i];e&&(e+=" "),n===n.toUpperCase()?e+=n:e+=n[0].toUpperCase()+n.slice(1).toLowerCase()}return e}const q$={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"};function j$(s){return s.replace(/&(?:amp|lt|gt|quot|#(0+)?39);/g,t=>q$[t]||"'")}function X$(s){return j$(Ec(s))}function G$(s){return s.substring(0,1).toUpperCase()+s.substring(1)}function Y$(s){return G$(Ec(s))}/**
 * @license Copyright (c) 2003-2025, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options
 *//**
 * @license Copyright (c) 2003-2025, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options
 */let kb;try{kb={window,document}}catch{/* istanbul ignore next -- @preserve */kb={window:{},document:{}}}var he=kb;function K$(){try{return navigator.userAgent.toLowerCase()}catch{return""}}const rl=K$(),Ie={isMac:I6(rl),isWindows:J$(rl),isGecko:e9(rl),isSafari:t9(rl),isiOS:i9(rl),isAndroid:n9(rl),isBlink:s9(rl),get isMediaForcedColors(){return o9()},features:{isRegExpUnicodePropertySupported:r9()}};function I6(s){return s.indexOf("macintosh")>-1}function J$(s){return s.indexOf("windows")>-1}function e9(s){return!!s.match(/gecko\/\d+/)}function t9(s){return s.indexOf(" applewebkit/")>-1&&s.indexOf("chrome")===-1}function i9(s){return!!s.match(/iphone|ipad/i)||I6(s)&&navigator.maxTouchPoints>0}function n9(s){return s.indexOf("android")>-1}function s9(s){return s.indexOf("chrome/")>-1&&s.indexOf("edge/")<0}function r9(){let s=!1;try{s="ć".search(new RegExp("[\\p{L}]","u"))===0}catch{}return s}function o9(){return he.window.matchMedia?he.window.matchMedia("(forced-colors: active)").matches:!1}/**
 * @license Copyright (c) 2003-2025, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options
 */function R6(s,t,e,i){e=e||function(a,c){return a===c};const n=Array.isArray(s)?s:Array.prototype.slice.call(s),r=Array.isArray(t)?t:Array.prototype.slice.call(t),o=l9(n,r,e);return i?c9(o,r.length):a9(r,o)}function l9(s,t,e){const i=SS(s,t,e);if(i===-1)return{firstIndex:-1,lastIndexOld:-1,lastIndexNew:-1};const n=CS(s,i),r=CS(t,i),o=SS(n,r,e),l=s.length-o,a=t.length-o;return{firstIndex:i,lastIndexOld:l,lastIndexNew:a}}function SS(s,t,e){for(let i=0;i<Math.max(s.length,t.length);i++)if(s[i]===void 0||t[i]===void 0||!e(s[i],t[i]))return i;return-1}function CS(s,t){return s.slice(t).reverse()}function a9(s,t){const e=[],{firstIndex:i,lastIndexOld:n,lastIndexNew:r}=t;return r-i>0&&e.push({index:i,type:"insert",values:s.slice(i,r)}),n-i>0&&e.push({index:i+(r-i),type:"delete",howMany:n-i}),e}function c9(s,t){const{firstIndex:e,lastIndexOld:i,lastIndexNew:n}=s;if(e===-1)return Array(t).fill("equal");let r=[];return e>0&&(r=r.concat(Array(e).fill("equal"))),n-e>0&&(r=r.concat(Array(n-e).fill("insert"))),i-e>0&&(r=r.concat(Array(i-e).fill("delete"))),n<t&&(r=r.concat(Array(t-n).fill("equal"))),r}function ic(s,t,e){e=e||function(_,k){return _===k};const i=s.length,n=t.length;if(i>200||n>200||i+n>300)return ic.fastDiff(s,t,e,!0);let r,o;if(n<i){const _=s;s=t,t=_,r="delete",o="insert"}else r="insert",o="delete";const l=s.length,a=t.length,c=a-l,h={},f={};function m(_){const k=(f[_-1]!==void 0?f[_-1]:-1)+1,C=f[_+1]!==void 0?f[_+1]:-1,P=k>C?-1:1;h[_+P]&&(h[_]=h[_+P].slice(0)),h[_]||(h[_]=[]),h[_].push(k>C?r:o);let M=Math.max(k,C),Q=M-_;for(;Q<l&&M<a&&e(s[Q],t[M]);)Q++,M++,h[_].push("equal");return M}let w=0,O;do{for(O=-w;O<c;O++)f[O]=m(O);for(O=c+w;O>c;O--)f[O]=m(O);f[c]=m(c),w++}while(f[c]!==a);return h[c].slice(1)}ic.fastDiff=R6;/**
 * @license Copyright (c) 2003-2025, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options
 */function PS(){return function s(){s.called=!0}}class Lr{constructor(t,e){p(this,"source");p(this,"name");p(this,"path");p(this,"stop");p(this,"off");p(this,"return");this.source=t,this.name=e,this.path=[],this.stop=PS(),this.off=PS()}}/**
 * @license Copyright (c) 2003-2025, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options
 */const Qi=new Array(256).fill("").map((s,t)=>("0"+t.toString(16)).slice(-2));function ei(){const[s,t,e,i]=crypto.getRandomValues(new Uint32Array(4));return"e"+Qi[s>>0&255]+Qi[s>>8&255]+Qi[s>>16&255]+Qi[s>>24&255]+Qi[t>>0&255]+Qi[t>>8&255]+Qi[t>>16&255]+Qi[t>>24&255]+Qi[e>>0&255]+Qi[e>>8&255]+Qi[e>>16&255]+Qi[e>>24&255]+Qi[i>>0&255]+Qi[i>>8&255]+Qi[i>>16&255]+Qi[i>>24&255]}/**
 * @license Copyright (c) 2003-2025, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options
 */const Ji={get(s="normal"){return typeof s!="number"?this[s]||this.normal:s},highest:1e5,high:1e3,normal:0,low:-1e3,lowest:-1e5};function u9(s,t){const e=Ji.get(t.priority);let i=0,n=s.length;for(;i<n;){const r=i+n>>1;Ji.get(s[r].priority)<e?n=r:i=r+1}s.splice(i,0,t)}/**
 * @license Copyright (c) 2003-2025, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options
 */const h9="https://ckeditor.com/docs/ckeditor5/latest/support/error-codes.html";class E extends Error{constructor(e,i,n){super(d9(e,n));p(this,"context");p(this,"data");this.name="CKEditorError",this.context=i,this.data=n}is(e){return e==="CKEditorError"}static rethrowUnexpectedError(e,i){if(e.is&&e.is("CKEditorError"))throw e;const n=new E(e.message,i);throw n.stack=e.stack,n}}function Ue(s,t){console.warn(...M6(s,t))}function fg(s,t){console.error(...M6(s,t))}function V6(s){return`
Read more: ${h9}#error-${s}`}function d9(s,t){const e=new WeakSet,n=t?` ${JSON.stringify(t,(o,l)=>{if(typeof l=="object"&&l!==null){if(e.has(l))return`[object ${l.constructor.name}]`;e.add(l)}return l})}`:"",r=V6(s);return s+n+r}function M6(s,t){const e=V6(s);return t?[s,t,e]:[s,e]}const L6="45.2.1",f9=new Date(2025,5,24);/* istanbul ignore next -- @preserve */if(globalThis.CKEDITOR_VERSION)throw new E("ckeditor-duplicated-modules",null);globalThis.CKEDITOR_VERSION=L6;const Da=Symbol("listeningTo"),Sb=Symbol("emitterId"),yr=Symbol("delegations"),B6=pt(Object);function pt(s){if(!s)return B6;class t extends s{on(i,n,r){this.listenTo(this,i,n,r)}once(i,n,r){let o=!1;const l=(a,...c)=>{o||(o=!0,a.off(),n.call(this,a,...c))};this.listenTo(this,i,l,r)}off(i,n){this.stopListening(this,i,n)}listenTo(i,n,r,o={}){let l,a;this[Da]||(this[Da]={});const c=this[Da];Fw(i)||$6(i);const h=Fw(i);(l=c[h])||(l=c[h]={emitter:i,callbacks:{}}),(a=l.callbacks[n])||(a=l.callbacks[n]=[]),a.push(r),x9(this,i,n,r,o)}stopListening(i,n,r){const o=this[Da];let l=i&&Fw(i);const a=o&&l?o[l]:void 0,c=a&&n?a.callbacks[n]:void 0;if(!(!o||i&&!a||n&&!c))if(r)zw(this,i,n,r),c.indexOf(r)!==-1&&(c.length===1?delete a.callbacks[n]:zw(this,i,n,r));else if(c){for(;r=c.pop();)zw(this,i,n,r);delete a.callbacks[n]}else if(a){for(n in a.callbacks)this.stopListening(i,n);delete o[l]}else{for(l in o)this.stopListening(o[l].emitter);delete this[Da]}}fire(i,...n){try{const r=i instanceof Lr?i:new Lr(this,i),o=r.name;let l=w9(this,o);if(r.path.push(this),l){l=l.slice();for(let c=0;c<l.length;c++){const h=l[c].callback;if(h.call(this,r,...n),r.off.called&&(delete r.off.called,this._removeEventListener(o,h)),r.stop.called)break}}const a=this[yr];if(a){const c=a.get(o),h=a.get("*");c&&TS(c,r,n),h&&TS(h,r,n)}return r.return}catch(r){/* istanbul ignore next -- @preserve */E.rethrowUnexpectedError(r,this)}}delegate(...i){return{to:(n,r)=>{this[yr]||(this[yr]=new Map),i.forEach(o=>{const l=this[yr].get(o);l?l.set(n,r):this[yr].set(o,new Map([[n,r]]))})}}}stopDelegating(i,n){if(this[yr])if(!i)this[yr].clear();else if(!n)this[yr].delete(i);else{const r=this[yr].get(i);r&&r.delete(n)}}_addEventListener(i,n,r){p9(this,i);const o=Cb(this,i),l=Ji.get(r.priority),a={callback:n,priority:l};for(const c of o)u9(c,a)}_removeEventListener(i,n){const r=Cb(this,i);for(const o of r)for(let l=0;l<o.length;l++)o[l].callback==n&&(o.splice(l,1),l--)}}return t}["on","once","off","listenTo","stopListening","fire","delegate","stopDelegating","_addEventListener","_removeEventListener"].forEach(s=>{pt[s]=B6.prototype[s]});function m9(s,t){const e=s[Da];return e&&e[t]?e[t].emitter:null}function $6(s,t){s[Sb]||(s[Sb]=t||ei())}function Fw(s){return s[Sb]}function D6(s){return s._events||Object.defineProperty(s,"_events",{value:{}}),s._events}function g9(){return{callbacks:[],childEvents:[]}}function p9(s,t){const e=D6(s);if(e[t])return;let i=t,n=null;const r=[];for(;i!==""&&!e[i];)e[i]=g9(),r.push(e[i]),n&&e[i].childEvents.push(n),n=i,i=i.substr(0,i.lastIndexOf(":"));if(i!==""){for(const o of r)o.callbacks=e[i].callbacks.slice();e[i].childEvents.push(n)}}function Cb(s,t){const e=D6(s)[t];if(!e)return[];let i=[e.callbacks];for(let n=0;n<e.childEvents.length;n++){const r=Cb(s,e.childEvents[n]);i=i.concat(r)}return i}function w9(s,t){if(!s._events)return null;let e=t;do{const i=s._events[e];if(i&&i.callbacks&&i.callbacks.length)return i.callbacks;const n=e.lastIndexOf(":");e=n>-1?e.substring(0,n):""}while(e);return null}function TS(s,t,e){for(let[i,n]of s){n?typeof n=="function"&&(n=n(t.name)):n=t.name;const r=new Lr(t.source,n);r.path=[...t.path],i.fire(r,...e)}}function x9(s,t,e,i,n){t._addEventListener?t._addEventListener(e,i,n):s._addEventListener.call(t,e,i,n)}function zw(s,t,e,i){t._removeEventListener?t._removeEventListener(e,i):s._removeEventListener.call(t,e,i)}const oh=Symbol("observableProperties"),kh=Symbol("boundObservables"),lh=Symbol("boundProperties"),ol=Symbol("decoratedMethods"),ES=Symbol("decoratedOriginal"),Q6=at(pt());function at(s){var e,i,n,r,o;if(!s)return Q6;class t extends(o=s,r=oh,n=ol,i=lh,e=kh,o){constructor(){super(...arguments);p(this,r);p(this,n);p(this,i);p(this,e)}set(c,h){if(ds(c)){Object.keys(c).forEach(m=>{this.set(m,c[m])},this);return}Ww(this);const f=this[oh];if(c in this&&!f.has(c))throw new E("observable-set-cannot-override",this);Object.defineProperty(this,c,{enumerable:!0,configurable:!0,get(){return f.get(c)},set(m){const w=f.get(c);let O=this.fire(`set:${c}`,c,m,w);O===void 0&&(O=m),(w!==O||!f.has(c))&&(f.set(c,O),this.fire(`change:${c}`,c,O,w))}}),this[c]=h}bind(...c){if(!c.length||!AS(c))throw new E("observable-bind-wrong-properties",this);if(new Set(c).size!==c.length)throw new E("observable-bind-duplicate-properties",this);Ww(this);const h=this[lh];c.forEach(m=>{if(h.has(m))throw new E("observable-bind-rebind",this)});const f=new Map;return c.forEach(m=>{const w={property:m,to:[]};h.set(m,w),f.set(m,w)}),{to:b9,toMany:O9,_observable:this,_bindProperties:c,_to:[],_bindings:f}}unbind(...c){if(!this[oh])return;const h=this[lh],f=this[kh];if(c.length){if(!AS(c))throw new E("observable-unbind-wrong-properties",this);c.forEach(m=>{const w=h.get(m);w&&(w.to.forEach(([O,_])=>{const k=f.get(O),C=k[_];C.delete(w),C.size||delete k[_],Object.keys(k).length||(f.delete(O),this.stopListening(O,"change"))}),h.delete(m))})}else f.forEach((m,w)=>{this.stopListening(w,"change")}),f.clear(),h.clear()}decorate(c){Ww(this);const h=this[c];if(!h)throw new E("observablemixin-cannot-decorate-undefined",this,{object:this,methodName:c});this.on(c,(f,m)=>{f.return=h.apply(this,m)}),this[c]=function(...f){return this.fire(c,f)},this[c][ES]=h,this[ol]||(this[ol]=[]),this[ol].push(c)}stopListening(c,h,f){if(!c&&this[ol]){for(const m of this[ol])this[m]=this[m][ES];delete this[ol]}super.stopListening(c,h,f)}}return t}["set","bind","unbind","decorate","on","once","off","listenTo","stopListening","fire","delegate","stopDelegating","_addEventListener","_removeEventListener"].forEach(s=>{at[s]=Q6.prototype[s]});function Ww(s){s[oh]||(Object.defineProperty(s,oh,{value:new Map}),Object.defineProperty(s,kh,{value:new Map}),Object.defineProperty(s,lh,{value:new Map}))}function b9(...s){const t=v9(...s),e=Array.from(this._bindings.keys()),i=e.length;if(!t.callback&&t.to.length>1)throw new E("observable-bind-to-no-callback",this);if(i>1&&t.callback)throw new E("observable-bind-to-extra-callback",this);t.to.forEach(n=>{if(n.properties.length&&n.properties.length!==i)throw new E("observable-bind-to-properties-length",this);n.properties.length||(n.properties=this._bindProperties)}),this._to=t.to,t.callback&&(this._bindings.get(e[0]).callback=t.callback),S9(this._observable,this._to),k9(this),this._bindProperties.forEach(n=>{N6(this._observable,n)})}function O9(s,t,e){if(this._bindings.size>1)throw new E("observable-bind-to-many-not-one-binding",this);this.to(...y9(s,t),e)}function y9(s,t){const e=s.map(i=>[i,t]);return Array.prototype.concat.apply([],e)}function AS(s){return s.every(t=>typeof t=="string")}function v9(...s){if(!s.length)throw new E("observable-bind-to-parse-error",null);const t={to:[]};let e;return typeof s[s.length-1]=="function"&&(t.callback=s.pop()),s.forEach(i=>{if(typeof i=="string")e.properties.push(i);else if(typeof i=="object")e={observable:i,properties:[]},t.to.push(e);else throw new E("observable-bind-to-parse-error",null)}),t}function _9(s,t,e,i){const n=s[kh],r=n.get(e),o=r||{};o[i]||(o[i]=new Set),o[i].add(t),r||n.set(e,o)}function k9(s){let t;s._bindings.forEach((e,i)=>{s._to.forEach(n=>{t=n.properties[e.callback?0:s._bindProperties.indexOf(i)],e.to.push([n.observable,t]),_9(s._observable,e,n.observable,t)})})}function N6(s,t){const i=s[lh].get(t);let n;i.callback?n=i.callback.apply(s,i.to.map(r=>r[0][r[1]])):(n=i.to[0],n=n[0][n[1]]),Object.prototype.hasOwnProperty.call(s,t)?s[t]=n:s.set(t,n)}function S9(s,t){t.forEach(e=>{const i=s[kh];let n;i.get(e.observable)||s.listenTo(e.observable,"change",(r,o)=>{n=i.get(e.observable)[o],n&&n.forEach(l=>{N6(s,l.property)})})})}/**
 * @license Copyright (c) 2003-2025, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options
 */class C9{constructor(){p(this,"_replacedElements");this._replacedElements=[]}replace(t,e){this._replacedElements.push({element:t,newElement:e}),t.style.display="none",e&&t.parentNode.insertBefore(e,t.nextSibling)}restore(){this._replacedElements.forEach(({element:t,newElement:e})=>{t.style.display="",e&&e.remove()}),this._replacedElements=[]}}/**
 * @license Copyright (c) 2003-2025, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options
 */function P9(s){let t=new AbortController;function e(...i){return t.abort(),t=new AbortController,s(t.signal,...i)}return e.abort=()=>t.abort(),e}/**
 * @license Copyright (c) 2003-2025, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options
 */function Pb(s){let t=0;for(const e of s)t++;return t}/**
 * @license Copyright (c) 2003-2025, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options
 */function Ni(s,t){const e=Math.min(s.length,t.length);for(let i=0;i<e;i++)if(s[i]!=t[i])return i;return s.length==t.length?"same":s.length<t.length?"prefix":"extension"}/**
 * @license Copyright (c) 2003-2025, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options
 */function Wn(s){return!!(s&&s[Symbol.iterator])}function bi(s,t,e={},i=[]){const n=e&&e.xmlns,r=n?s.createElementNS(n,t):s.createElement(t);for(const o in e)r.setAttribute(o,e[o]);(yS(i)||!Wn(i))&&(i=[i]);for(let o of i)yS(o)&&(o=s.createTextNode(o)),r.appendChild(o);return r}class F6{constructor(t,e){p(this,"_config");this._config=Object.create(null),e&&this.define(IS(e)),t&&this._setObjectToTarget(this._config,t)}set(t,e){this._setToTarget(this._config,t,e)}define(t,e){this._setToTarget(this._config,t,e,!0)}get(t){return this._getFromSource(this._config,t)}*names(){for(const t of Object.keys(this._config))yield t}_setToTarget(t,e,i,n=!1){if(Vs(e)){this._setObjectToTarget(t,e,n);return}const r=e.split(".");e=r.pop();for(const o of r)Vs(t[o])||(t[o]=Object.create(null)),t=t[o];if(Vs(i)){Vs(t[e])||(t[e]=Object.create(null)),t=t[e],this._setObjectToTarget(t,i,n);return}n&&typeof t[e]<"u"||(t[e]=i)}_getFromSource(t,e){const i=e.split(".");e=i.pop();for(const n of i){if(!Vs(t[n])){t=null;break}t=t[n]}return t?IS(t[e]):void 0}_setObjectToTarget(t,e,i){Object.keys(e).forEach(n=>{this._setToTarget(t,n,e[n],i)})}}function IS(s){return bp(s,T9)}function T9(s){return Ao(s)||typeof s=="function"?s:void 0}/**
 * @license Copyright (c) 2003-2025, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options
 */function Io(s){if(s){if(s.defaultView)return s instanceof s.defaultView.Document;if(s.ownerDocument&&s.ownerDocument.defaultView)return s instanceof s.ownerDocument.defaultView.Node}return!1}/**
 * @license Copyright (c) 2003-2025, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options
 */function mg(s){const t=Object.prototype.toString.apply(s);return t=="[object Window]"||t=="[object global]"}const z6=qi(pt());function qi(s){if(!s)return z6;class t extends s{listenTo(i,n,r,o={}){if(Io(i)||mg(i)||i instanceof he.window.EventTarget){const l={capture:!!o.useCapture,passive:!!o.usePassive},a=this._getProxyEmitter(i,l)||new E9(i,l);this.listenTo(a,n,r,o)}else super.listenTo(i,n,r,o)}stopListening(i,n,r){if(Io(i)||mg(i)||i instanceof he.window.EventTarget){const o=this._getAllProxyEmitters(i);for(const l of o)this.stopListening(l,n,r)}else super.stopListening(i,n,r)}_getProxyEmitter(i,n){return m9(this,W6(i,n))}_getAllProxyEmitters(i){return[{capture:!1,passive:!1},{capture:!1,passive:!0},{capture:!0,passive:!1},{capture:!0,passive:!0}].map(n=>this._getProxyEmitter(i,n)).filter(n=>!!n)}}return t}["_getProxyEmitter","_getAllProxyEmitters","on","once","off","listenTo","stopListening","fire","delegate","stopDelegating","_addEventListener","_removeEventListener"].forEach(s=>{qi[s]=z6.prototype[s]});class E9 extends pt(){constructor(e,i){super();p(this,"_domNode");p(this,"_options");p(this,"_domListeners");$6(this,W6(e,i)),this._domNode=e,this._options=i}attach(e){if(this._domListeners&&this._domListeners[e])return;const i=this._createDomListener(e);this._domNode.addEventListener(e,i,this._options),this._domListeners||(this._domListeners={}),this._domListeners[e]=i}detach(e){let i;this._domListeners[e]&&(!(i=this._events[e])||!i.callbacks.length)&&this._domListeners[e].removeListener()}_addEventListener(e,i,n){this.attach(e),pt().prototype._addEventListener.call(this,e,i,n)}_removeEventListener(e,i){pt().prototype._removeEventListener.call(this,e,i),this.detach(e)}_createDomListener(e){const i=n=>{this.fire(e,n)};return i.removeListener=()=>{this._domNode.removeEventListener(e,i,this._options),delete this._domListeners[e]},i}}function A9(s){return s["data-ck-expando"]||(s["data-ck-expando"]=ei())}function W6(s,t){let e=A9(s);for(const i of Object.keys(t).sort())t[i]&&(e+="-"+i);return e}/**
 * @license Copyright (c) 2003-2025, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options
 */function I9(s){const t=[];let e=s;for(;e&&e.nodeType!=Node.DOCUMENT_NODE;)t.unshift(e),e=e.parentNode;return t}/**
 * @license Copyright (c) 2003-2025, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options
 */function R9(s){return s instanceof HTMLTextAreaElement?s.value:s.innerHTML}/**
 * @license Copyright (c) 2003-2025, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options
 */function MO(s){const t=s.ownerDocument.defaultView.getComputedStyle(s);return{top:parseInt(t.borderTopWidth,10),right:parseInt(t.borderRightWidth,10),bottom:parseInt(t.borderBottomWidth,10),left:parseInt(t.borderLeftWidth,10)}}/**
 * @license Copyright (c) 2003-2025, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options
 */function U6(s){if(!s.target)return null;const t=s.target.ownerDocument,e=s.clientX,i=s.clientY;let n=null;return t.caretRangeFromPoint&&t.caretRangeFromPoint(e,i)?n=t.caretRangeFromPoint(e,i):s.rangeParent&&(n=t.createRange(),n.setStart(s.rangeParent,s.rangeOffset),n.collapse(!0)),n}/**
 * @license Copyright (c) 2003-2025, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options
 */function Lt(s){return Object.prototype.toString.call(s)=="[object Text]"}/**
 * @license Copyright (c) 2003-2025, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options
 */function Op(s){return Object.prototype.toString.apply(s)=="[object Range]"}function Z6(s){return!s||!s.parentNode||s.offsetParent===he.document.body?null:s.offsetParent}const H6=["top","right","bottom","left","width","height"];class Ve{constructor(t){p(this,"top");p(this,"right");p(this,"bottom");p(this,"left");p(this,"width");p(this,"height");p(this,"_source");const e=Op(t);if(Object.defineProperty(this,"_source",{value:t._source||t,writable:!0,enumerable:!1}),Tb(t)||e)if(e){const i=Ve.getDomRangeRects(t);Ff(this,Ve.getBoundingRect(i))}else Ff(this,t.getBoundingClientRect());else if(mg(t)){const{innerWidth:i,innerHeight:n}=t;Ff(this,{top:0,right:i,bottom:n,left:0,width:i,height:n})}else Ff(this,t)}clone(){return new Ve(this)}moveTo(t,e){return this.top=e,this.right=t+this.width,this.bottom=e+this.height,this.left=t,this}moveBy(t,e){return this.top+=e,this.right+=t,this.left+=t,this.bottom+=e,this}getIntersection(t){const e={top:Math.max(this.top,t.top),right:Math.min(this.right,t.right),bottom:Math.min(this.bottom,t.bottom),left:Math.max(this.left,t.left),width:0,height:0};if(e.width=e.right-e.left,e.height=e.bottom-e.top,e.width<0||e.height<0)return null;{const i=new Ve(e);return i._source=this._source,i}}getIntersectionArea(t){const e=this.getIntersection(t);return e?e.getArea():0}getArea(){return this.width*this.height}getVisible(){const t=this._source;let e=this.clone();if(RS(t))return e;let i=t,n=t.parentNode||t.commonAncestorContainer,r;for(;n&&!RS(n);){const o=V9(n)==="visible";i instanceof HTMLElement&&VS(i)==="absolute"&&(r=i);const l=VS(n);if(o||r&&(l==="relative"&&o||l!=="relative")){i=n,n=n.parentNode;continue}const a=new Ve(n),c=e.getIntersection(a);if(c)c.getArea()<e.getArea()&&(e=c);else return null;i=n,n=n.parentNode}return e}isEqual(t){for(const e of H6)if(this[e]!==t[e])return!1;return!0}contains(t){const e=this.getIntersection(t);return!!(e&&e.isEqual(t))}toAbsoluteRect(){const{scrollX:t,scrollY:e}=he.window,i=this.clone().moveBy(t,e);if(Tb(i._source)){const n=Z6(i._source);n&&M9(i,n)}return i}excludeScrollbarsAndBorders(){const t=this._source;let e,i,n;if(mg(t))e=t.innerWidth-t.document.documentElement.clientWidth,i=t.innerHeight-t.document.documentElement.clientHeight,n=t.getComputedStyle(t.document.documentElement).direction;else{const r=MO(t);e=t.offsetWidth-t.clientWidth-r.left-r.right,i=t.offsetHeight-t.clientHeight-r.top-r.bottom,n=t.ownerDocument.defaultView.getComputedStyle(t).direction,this.left+=r.left,this.top+=r.top,this.right-=r.right,this.bottom-=r.bottom,this.width=this.right-this.left,this.height=this.bottom-this.top}return this.width-=e,n==="ltr"?this.right-=e:this.left+=e,this.height-=i,this.bottom-=i,this}static getDomRangeRects(t){const e=[],i=Array.from(t.getClientRects());if(i.length)for(const n of i)e.push(new Ve(n));else{let n=t.startContainer;Lt(n)&&(n=n.parentNode);const r=new Ve(n.getBoundingClientRect());r.right=r.left,r.width=0,e.push(r)}return e}static getBoundingRect(t){const e={left:Number.POSITIVE_INFINITY,top:Number.POSITIVE_INFINITY,right:Number.NEGATIVE_INFINITY,bottom:Number.NEGATIVE_INFINITY,width:0,height:0};let i=0;for(const n of t)i++,e.left=Math.min(e.left,n.left),e.top=Math.min(e.top,n.top),e.right=Math.max(e.right,n.right),e.bottom=Math.max(e.bottom,n.bottom);return i==0?null:(e.width=e.right-e.left,e.height=e.bottom-e.top,new Ve(e))}}function Ff(s,t){for(const e of H6)s[e]=t[e]}function RS(s){return Tb(s)?s===s.ownerDocument.body:!1}function Tb(s){return s!==null&&typeof s=="object"&&s.nodeType===1&&typeof s.getBoundingClientRect=="function"}function VS(s){return s instanceof HTMLElement?s.ownerDocument.defaultView.getComputedStyle(s).position:"static"}function V9(s){return s instanceof HTMLElement?s.ownerDocument.defaultView.getComputedStyle(s).overflow:"visible"}function M9(s,t){const e=new Ve(t),i=MO(t);let n=0,r=0;n-=e.left,r-=e.top,n+=t.scrollLeft,r+=t.scrollTop,n-=i.left,r-=i.top,s.moveBy(n,r)}var Ot;let yp=(Ot=class{constructor(t,e){p(this,"_element");p(this,"_callback");Ot._observerInstance||Ot._createObserver(),this._element=t,this._callback=e,Ot._addElementCallback(t,e),Ot._observerInstance.observe(t)}get element(){return this._element}destroy(){Ot._deleteElementCallback(this._element,this._callback)}static _addElementCallback(t,e){Ot._elementCallbacks||(Ot._elementCallbacks=new Map);let i=Ot._elementCallbacks.get(t);i||(i=new Set,Ot._elementCallbacks.set(t,i)),i.add(e)}static _deleteElementCallback(t,e){const i=Ot._getElementCallbacks(t);i&&(i.delete(e),i.size||(Ot._elementCallbacks.delete(t),Ot._observerInstance.unobserve(t))),Ot._elementCallbacks&&!Ot._elementCallbacks.size&&(Ot._observerInstance=null,Ot._elementCallbacks=null)}static _getElementCallbacks(t){return Ot._elementCallbacks?Ot._elementCallbacks.get(t):null}static _createObserver(){Ot._observerInstance=new he.window.ResizeObserver(t=>{for(const e of t){const i=Ot._getElementCallbacks(e.target);if(i)for(const n of i)n(e)}})}},p(Ot,"_observerInstance",null),p(Ot,"_elementCallbacks",null),Ot);/**
 * @license Copyright (c) 2003-2025, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options
 */function MS(s,t){s instanceof HTMLTextAreaElement&&(s.value=t),s.innerHTML=t}/**
 * @license Copyright (c) 2003-2025, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options
 */function No(s){return t=>t+s}/**
 * @license Copyright (c) 2003-2025, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options
 */function qa(s){let t=0;for(;s.previousSibling;)s=s.previousSibling,t++;return t}/**
 * @license Copyright (c) 2003-2025, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options
 */function q6(s,t,e){s.insertBefore(e,s.childNodes[t]||null)}/**
 * @license Copyright (c) 2003-2025, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options
 */function ah(s){return s&&s.nodeType===Node.COMMENT_NODE}function j6(s){try{he.document.createAttribute(s)}catch{return!1}return!0}function Ls(s){return s?Lt(s)?Ls(s.parentElement):s.getClientRects?!!s.getClientRects().length:!1:!1}function vp({element:s,target:t,positions:e,limiter:i,fitInViewport:n,viewportOffsetConfig:r}){hg(t)&&(t=t()),hg(i)&&(i=i());const o=Z6(s),l=L9(r),a=new Ve(s),c=LS(t,l);let h;if(!c||!l.getIntersection(c))return null;const f={targetRect:c,elementRect:a,positionedElementAncestor:o,viewportRect:l};if(!i&&!n)h=new X6(e[0],f);else{if(i){const m=LS(i,l);m&&(f.limiterRect=m)}h=B9(e,f)}return h}function LS(s,t){const e=new Ve(s).getVisible();return e?e.getIntersection(t):null}function L9(s){s=Object.assign({top:0,bottom:0,left:0,right:0},s);const t=new Ve(he.window);return t.top+=s.top,t.height-=s.top,t.bottom-=s.bottom,t.height-=s.bottom,t}function B9(s,t){const{elementRect:e}=t,i=e.getArea(),n=s.map(l=>new X6(l,t)).filter(l=>!!l.name);let r=0,o=null;for(const l of n){const{limiterIntersectionArea:a,viewportIntersectionArea:c}=l;if(a===i)return l;const h=c**2+a**2;h>r&&(r=h,o=l)}return o}class X6{constructor(t,e){p(this,"name");p(this,"config");p(this,"_positioningFunctionCoordinates");p(this,"_options");p(this,"_cachedRect");p(this,"_cachedAbsoluteRect");const i=t(e.targetRect,e.elementRect,e.viewportRect,e.limiterRect);if(!i)return;const{left:n,top:r,name:o,config:l}=i;this.name=o,this.config=l,this._positioningFunctionCoordinates={left:n,top:r},this._options=e}get left(){return this._absoluteRect.left}get top(){return this._absoluteRect.top}get limiterIntersectionArea(){const t=this._options.limiterRect;return t?t.getIntersectionArea(this._rect):0}get viewportIntersectionArea(){return this._options.viewportRect.getIntersectionArea(this._rect)}get _rect(){return this._cachedRect?this._cachedRect:(this._cachedRect=this._options.elementRect.clone().moveTo(this._positioningFunctionCoordinates.left,this._positioningFunctionCoordinates.top),this._cachedRect)}get _absoluteRect(){return this._cachedAbsoluteRect?this._cachedAbsoluteRect:(this._cachedAbsoluteRect=this._rect.toAbsoluteRect(),this._cachedAbsoluteRect)}}/**
 * @license Copyright (c) 2003-2025, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options
 */function BS(s){const t=s.parentNode;t&&t.removeChild(s)}function Vm(){const s=he.window.visualViewport;if(!s||!(Ie.isiOS||Ie.isSafari))return{left:0,top:0};const t=Math.max(Math.round(s.offsetLeft),0),e=Math.max(Math.round(s.offsetTop),0);return{left:t,top:e}}function $9({target:s,viewportOffset:t=0,ancestorOffset:e=0,alignToTop:i,forceScroll:n}){const r=LO(s);let o=r,l=null;for(t=N9(t);o;){let a;o==r?a=$S(s):a=$S(l),Q9({parent:a,getRect:()=>Uw(s,o),alignToTop:i,ancestorOffset:e,forceScroll:n});let c=Uw(s,o);const h=Uw(a,o);if(c.height>h.height){const f=c.getIntersection(h);f&&(c=f)}if(D9({window:o,rect:c,viewportOffset:t,alignToTop:i,forceScroll:n}),o.parent!=o){if(l=o.frameElement,o=o.parent,!l)return}else o=null}}function D9({window:s,rect:t,alignToTop:e,forceScroll:i,viewportOffset:n}){const r=t.clone().moveBy(0,n.bottom),o=t.clone().moveBy(0,-n.top),l=new Ve(s).excludeScrollbarsAndBorders(),a=[o,r],c=e&&i,h=a.every(_=>l.contains(_));let{scrollX:f,scrollY:m}=s;const w=f,O=m;c?m-=l.top-t.top+n.top:h||(Y6(o,l)?m-=l.top-t.top+n.top:G6(r,l)&&(e?m+=t.top-l.top-n.top:m+=t.bottom-l.bottom+n.bottom)),h||(K6(t,l)?f-=l.left-t.left+n.left:J6(t,l)&&(f+=t.right-l.right+n.right)),(f!=w||m!==O)&&s.scrollTo(f,m)}function Q9({parent:s,getRect:t,alignToTop:e,forceScroll:i,ancestorOffset:n=0,limiterElement:r}){const o=LO(s),l=e&&i;let a,c,h;const f=r||o.document.body;for(;s!=f;)c=t(),a=new Ve(s).excludeScrollbarsAndBorders(),h=a.contains(c),l?s.scrollTop-=a.top-c.top+n:h||(Y6(c,a)?s.scrollTop-=a.top-c.top+n:G6(c,a)&&(e?s.scrollTop+=c.top-a.top-n:s.scrollTop+=c.bottom-a.bottom+n)),h||(K6(c,a)?s.scrollLeft-=a.left-c.left+n:J6(c,a)&&(s.scrollLeft+=c.right-a.right+n)),s=s.parentNode}function G6(s,t){return s.bottom>t.bottom}function Y6(s,t){return s.top<t.top}function K6(s,t){return s.left<t.left}function J6(s,t){return s.right>t.right}function LO(s){return Op(s)?s.startContainer.ownerDocument.defaultView:s.ownerDocument.defaultView}function $S(s){if(Op(s)){let t=s.commonAncestorContainer;return Lt(t)&&(t=t.parentNode),t}else return s.parentNode}function Uw(s,t){const e=LO(s),i=new Ve(s);if(e===t)return i;{let n=e;for(;n!=t;){const r=n.frameElement,o=new Ve(r).excludeScrollbarsAndBorders();i.moveBy(o.left,o.top),n=n.parent}}return i}function N9(s){return typeof s=="number"?{top:s,bottom:s,left:s,right:s}:s}const F9={ctrl:"⌃",cmd:"⌘",alt:"⌥",shift:"⇧"},z9={ctrl:"Ctrl+",alt:"Alt+",shift:"Shift+"},DS={37:"←",38:"↑",39:"→",40:"↓",9:"⇥",33:"Page Up",34:"Page Down"},ze=q9(),W9=Object.fromEntries(Object.entries(ze).map(([s,t])=>{let e;return t in DS?e=DS[t]:e=s.charAt(0).toUpperCase()+s.slice(1),[t,e]}));function dc(s){let t;if(typeof s=="string"){if(t=ze[s.toLowerCase()],!t)throw new E("keyboard-unknown-key",null,{key:s})}else t=s.keyCode+(s.altKey?ze.alt:0)+(s.ctrlKey?ze.ctrl:0)+(s.shiftKey?ze.shift:0)+(s.metaKey?ze.cmd:0);return t}function BO(s){return typeof s=="string"&&(s=j9(s)),s.map(t=>typeof t=="string"?Z9(t):t).reduce((t,e)=>e+t,0)}function gg(s,t){let e=BO(s);const i=Ie.isMac||Ie.isiOS;return Object.entries(i?F9:z9).reduce((o,[l,a])=>((e&ze[l])!=0&&(e&=~ze[l],o+=a),o),"")+(e?W9[e]:"")}function U9(s){return s==ze.arrowright||s==ze.arrowleft||s==ze.arrowup||s==ze.arrowdown}function $O(s,t){const e=t==="ltr";switch(s){case ze.arrowleft:return e?"left":"right";case ze.arrowright:return e?"right":"left";case ze.arrowup:return"up";case ze.arrowdown:return"down"}}function Z9(s){if(s.endsWith("!"))return dc(s.slice(0,-1));const t=dc(s);return(Ie.isMac||Ie.isiOS)&&t==ze.ctrl?ze.cmd:t}function H9(s,t){const e=$O(s,t);return e==="down"||e==="right"}function q9(){const s={pageup:33,pagedown:34,end:35,home:36,arrowleft:37,arrowup:38,arrowright:39,arrowdown:40,backspace:8,delete:46,enter:13,space:32,esc:27,tab:9,ctrl:1114112,shift:2228224,alt:4456448,cmd:8912896};for(let t=65;t<=90;t++){const e=String.fromCharCode(t);s[e.toLowerCase()]=t}for(let t=48;t<=57;t++)s[t-48]=t;for(let t=112;t<=123;t++)s["f"+(t-111)]=t;return Object.assign(s,{"'":222,",":108,"-":109,".":110,"/":111,";":186,"=":187,"[":219,"\\":220,"]":221,"`":223}),s}function j9(s){return s.split("+").map(t=>t.trim())}/**
 * @license Copyright (c) 2003-2025, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options
 */const X9=["ar","ara","dv","div","fa","per","fas","he","heb","ku","kur","ug","uig","ur","urd"];function QS(s){return X9.includes(s)?"rtl":"ltr"}/**
 * @license Copyright (c) 2003-2025, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options
 */function dt(s){return Array.isArray(s)?s:[s]}/* istanbul ignore else -- @preserve */he.window.CKEDITOR_TRANSLATIONS||(he.window.CKEDITOR_TRANSLATIONS={});function G9(s,t,e=1,i){if(typeof e!="number")throw new E("translation-service-quantity-not-a-number",null,{quantity:e});const n=i||he.window.CKEDITOR_TRANSLATIONS,r=J9(n);r===1&&(s=Object.keys(n)[0]);const o=t.id||t.string;if(r===0||!K9(s,o,n))return e!==1?t.plural:t.string;const l=n[s].dictionary,a=n[s].getPluralForm||(f=>f===1?0:1),c=l[o];if(typeof c=="string")return c;const h=Number(a(e));return c[h]}function Y9(s){return Array.isArray(s)?s.reduce((t,e)=>RO(t,e)):s}function K9(s,t,e){return!!e[s]&&!!e[s].dictionary[t]}function J9(s){return Object.keys(s).length}class eD{constructor({uiLanguage:t="en",contentLanguage:e,translations:i}={}){p(this,"uiLanguage");p(this,"uiLanguageDirection");p(this,"contentLanguage");p(this,"contentLanguageDirection");p(this,"t");p(this,"translations");this.uiLanguage=t,this.contentLanguage=e||this.uiLanguage,this.uiLanguageDirection=QS(this.uiLanguage),this.contentLanguageDirection=QS(this.contentLanguage),this.translations=Y9(i),this.t=(n,r)=>this._t(n,r)}get language(){return console.warn("locale-deprecated-language-property: The Locale#language property has been deprecated and will be removed in the near future. Please use #uiLanguage and #contentLanguage properties instead."),this.uiLanguage}_t(t,e=[]){e=dt(e),typeof t=="string"&&(t={string:t});const n=!!t.plural?e[0]:1,r=G9(this.uiLanguage,t,n,this.translations);return tD(r,e)}}function tD(s,t){return s.replace(/%(\d+)/g,(e,i)=>i<t.length?t[i]:e)}class di extends pt(){constructor(e={},i={}){super();p(this,"_items");p(this,"_itemMap");p(this,"_idProperty");p(this,"_bindToCollection");p(this,"_bindToExternalToInternalMap");p(this,"_bindToInternalToExternalMap");p(this,"_skippedIndexesFromExternal");const n=Wn(e);if(n||(i=e),this._items=[],this._itemMap=new Map,this._idProperty=i.idProperty||"id",this._bindToExternalToInternalMap=new WeakMap,this._bindToInternalToExternalMap=new WeakMap,this._skippedIndexesFromExternal=[],n)for(const r of e)this._items.push(r),this._itemMap.set(this._getItemIdBeforeAdding(r),r)}get length(){return this._items.length}get first(){return this._items[0]||null}get last(){return this._items[this.length-1]||null}add(e,i){return this.addMany([e],i)}addMany(e,i){if(i===void 0)i=this._items.length;else if(i>this._items.length||i<0)throw new E("collection-add-item-invalid-index",this);let n=0;for(const r of e){const o=this._getItemIdBeforeAdding(r),l=i+n;this._items.splice(l,0,r),this._itemMap.set(o,r),this.fire("add",r,l),n++}return this.fire("change",{added:e,removed:[],index:i}),this}get(e){let i;if(typeof e=="string")i=this._itemMap.get(e);else if(typeof e=="number")i=this._items[e];else throw new E("collection-get-invalid-arg",this);return i||null}has(e){if(typeof e=="string")return this._itemMap.has(e);{const i=this._idProperty,n=e[i];return n&&this._itemMap.has(n)}}getIndex(e){let i;return typeof e=="string"?i=this._itemMap.get(e):i=e,i?this._items.indexOf(i):-1}remove(e){const[i,n]=this._remove(e);return this.fire("change",{added:[],removed:[i],index:n}),i}map(e,i){return this._items.map(e,i)}forEach(e,i){this._items.forEach(e,i)}find(e,i){return this._items.find(e,i)}filter(e,i){return this._items.filter(e,i)}clear(){this._bindToCollection&&(this.stopListening(this._bindToCollection),this._bindToCollection=null);const e=Array.from(this._items);for(;this.length;)this._remove(0);this.fire("change",{added:[],removed:e,index:0})}bindTo(e){if(this._bindToCollection)throw new E("collection-bind-to-rebind",this);return this._bindToCollection=e,{as:i=>{this._setUpBindToBinding(n=>new i(n))},using:i=>{typeof i=="function"?this._setUpBindToBinding(i):this._setUpBindToBinding(n=>n[i])}}}_setUpBindToBinding(e){const i=this._bindToCollection,n=(r,o,l)=>{const a=i._bindToCollection==this,c=i._bindToInternalToExternalMap.get(o);if(a&&c)this._bindToExternalToInternalMap.set(o,c),this._bindToInternalToExternalMap.set(c,o);else{const h=e(o);if(!h){this._skippedIndexesFromExternal.push(l);return}let f=l;for(const m of this._skippedIndexesFromExternal)l>m&&f--;for(const m of i._skippedIndexesFromExternal)f>=m&&f++;this._bindToExternalToInternalMap.set(o,h),this._bindToInternalToExternalMap.set(h,o),this.add(h,f);for(let m=0;m<i._skippedIndexesFromExternal.length;m++)f<=i._skippedIndexesFromExternal[m]&&i._skippedIndexesFromExternal[m]++}};for(const r of i)n(null,r,i.getIndex(r));this.listenTo(i,"add",n),this.listenTo(i,"remove",(r,o,l)=>{const a=this._bindToExternalToInternalMap.get(o);a&&this.remove(a),this._skippedIndexesFromExternal=this._skippedIndexesFromExternal.reduce((c,h)=>(l<h&&c.push(h-1),l>h&&c.push(h),c),[])})}_getItemIdBeforeAdding(e){const i=this._idProperty;let n;if(i in e){if(n=e[i],typeof n!="string")throw new E("collection-add-invalid-id",this);if(this.get(n))throw new E("collection-add-item-already-exists",this)}else e[i]=n=ei();return n}_remove(e){let i,n,r,o=!1;const l=this._idProperty;if(typeof e=="string"?(n=e,r=this._itemMap.get(n),o=!r,r&&(i=this._items.indexOf(r))):typeof e=="number"?(i=e,r=this._items[i],o=!r,r&&(n=r[l])):(r=e,n=r[l],i=this._items.indexOf(r),o=i==-1||!this._itemMap.get(n)),o)throw new E("collection-remove-404",this);this._items.splice(i,1),this._itemMap.delete(n);const a=this._bindToInternalToExternalMap.get(r);return this._bindToInternalToExternalMap.delete(r),this._bindToExternalToInternalMap.delete(a),this.fire("remove",r,i),[r,i]}[Symbol.iterator](){return this._items[Symbol.iterator]()}}/**
 * @license Copyright (c) 2003-2025, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options
 */function $t(s){const t=s.next();return t.done?null:t.value}class ot extends qi(at()){constructor(){super();p(this,"_elements",new Set);p(this,"_externalViews",new Set);p(this,"_blurTimeout",null);this.set("isFocused",!1),this.set("focusedElement",null)}get elements(){return Array.from(this._elements.values())}get externalViews(){return Array.from(this._externalViews.values())}add(e){if(FS(e))this._addElement(e);else if(NS(e))this._addView(e);else{if(!e.element)throw new E("focustracker-add-view-missing-element",{focusTracker:this,view:e});this._addElement(e.element)}}remove(e){FS(e)?this._removeElement(e):NS(e)?this._removeView(e):this._removeElement(e.element)}_addElement(e){if(this._elements.has(e))throw new E("focustracker-add-element-already-exist",this);this.listenTo(e,"focus",()=>{const i=this.externalViews.find(n=>iD(e,n));i?this._focus(i.element):this._focus(e)},{useCapture:!0}),this.listenTo(e,"blur",()=>{this._blur()},{useCapture:!0}),this._elements.add(e)}_removeElement(e){this._elements.has(e)&&(this.stopListening(e),this._elements.delete(e)),e===this.focusedElement&&this._blur()}_addView(e){e.element&&this._addElement(e.element),this.listenTo(e.focusTracker,"change:focusedElement",()=>{e.focusTracker.focusedElement?e.element&&this._focus(e.element):this._blur()}),this._externalViews.add(e)}_removeView(e){e.element&&this._removeElement(e.element),this.stopListening(e.focusTracker),this._externalViews.delete(e)}destroy(){this.stopListening(),this._elements.clear(),this._externalViews.clear(),this.isFocused=!1,this.focusedElement=null}_focus(e){this._clearBlurTimeout(),this.focusedElement=e,this.isFocused=!0}_blur(){this.elements.find(n=>n.contains(document.activeElement))||this.externalViews.find(n=>n.focusTracker.isFocused&&!n.focusTracker._blurTimeout)||(this._clearBlurTimeout(),this._blurTimeout=setTimeout(()=>{this.focusedElement=null,this.isFocused=!1},0))}_clearBlurTimeout(){clearTimeout(this._blurTimeout),this._blurTimeout=null}}function NS(s){return"focusTracker"in s&&s.focusTracker instanceof ot}function FS(s){return Ao(s)}function iD(s,t){return zS(s,t)?!0:!!t.focusTracker.externalViews.find(e=>zS(s,e))}function zS(s,t){return!!t.element&&t.element.contains(document.activeElement)&&s.contains(t.element)}class wt{constructor(){p(this,"_listener");this._listener=new(qi())}listenTo(t){this._listener.listenTo(t,"keydown",(e,i)=>{this._listener.fire("_keydown:"+dc(i),i)})}set(t,e,i={}){const n=BO(t),r=i.priority;this._listener.listenTo(this._listener,"_keydown:"+n,(o,l)=>{i.filter&&!i.filter(l)||(e(l,()=>{l.preventDefault(),l.stopPropagation(),o.stop()}),o.return=!0)},{priority:r})}press(t){return!!this._listener.fire("_keydown:"+dc(t),t)}stopListening(t){this._listener.stopListening(t)}destroy(){this.stopListening()}}/**
 * @license Copyright (c) 2003-2025, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options
 */function nD(s){const t=new Map;for(const e in s)t.set(e,s[e]);return t}function ms(s){return Wn(s)?new Map(s):nD(s)}/**
 * @license Copyright (c) 2003-2025, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options
 */function sD(s,t={}){return new Promise((e,i)=>{const n=t.signal||new AbortController().signal;n.throwIfAborted();const r=setTimeout(o,s);n.addEventListener("abort",l,{once:!0});function o(){n.removeEventListener("abort",l),e()}function l(){clearTimeout(r),i(n.reason)}})}async function rD(s,t={}){const{maxAttempts:e=4,retryDelay:i=oD(),signal:n=new AbortController().signal}=t;n.throwIfAborted();for(let r=0;;r++){try{return await s()}catch(o){if(r+1>=e)throw o}await sD(i(r),{signal:n})}}function oD(s={}){const{delay:t=1e3,factor:e=2,maxDelay:i=1e4}=s;return n=>Math.min(e**n*t,i)}/**
 * @license Copyright (c) 2003-2025, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options
 */function WS(s,t,e){const i=s.length,n=t.length;for(let r=i-1;r>=e;r--)s[r+n]=s[r];for(let r=0;r<n;r++)s[e+r]=t[r]}/**
 * @license Copyright (c) 2003-2025, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options
 */function _p(s,t){let e;function i(...n){i.cancel(),e=setTimeout(()=>s(...n),t)}return i.cancel=()=>{clearTimeout(e)},i}/**
 * @license Copyright (c) 2003-2025, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options
 */function DO(s){try{if(!s.startsWith("ey"))return null;const t=atob(s.replace(/-/g,"+").replace(/_/g,"/"));return JSON.parse(t)}catch{return null}}/**
 * @license Copyright (c) 2003-2025, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options
 */function lD(){const s=[];for(let t=0;t<256;t++){let e=t;for(let i=0;i<8;i++)e&1?e=3988292384^e>>>1:e=e>>>1;s[t]=e}return s}function aD(s){const t=Array.isArray(s)?s:[s],e=lD();let i=-1;const n=t.map(r=>Array.isArray(r)?r.join(""):String(r)).join("");for(let r=0;r<n.length;r++){const o=n.charCodeAt(r);i=i>>>8^e[(i^o)&255]}return i=(i^-1)>>>0,i.toString(16).padStart(8,"0")}/**
 * @license Copyright (c) 2003-2025, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options
 */function cD(s){const t=[{name:"address",isVoid:!1},{name:"article",isVoid:!1},{name:"aside",isVoid:!1},{name:"blockquote",isVoid:!1},{name:"details",isVoid:!1},{name:"dialog",isVoid:!1},{name:"dd",isVoid:!1},{name:"div",isVoid:!1},{name:"dl",isVoid:!1},{name:"dt",isVoid:!1},{name:"fieldset",isVoid:!1},{name:"figcaption",isVoid:!1},{name:"figure",isVoid:!1},{name:"footer",isVoid:!1},{name:"form",isVoid:!1},{name:"h1",isVoid:!1},{name:"h2",isVoid:!1},{name:"h3",isVoid:!1},{name:"h4",isVoid:!1},{name:"h5",isVoid:!1},{name:"h6",isVoid:!1},{name:"header",isVoid:!1},{name:"hgroup",isVoid:!1},{name:"hr",isVoid:!0},{name:"li",isVoid:!1},{name:"main",isVoid:!1},{name:"nav",isVoid:!1},{name:"ol",isVoid:!1},{name:"p",isVoid:!1},{name:"section",isVoid:!1},{name:"table",isVoid:!1},{name:"tbody",isVoid:!1},{name:"td",isVoid:!1},{name:"th",isVoid:!1},{name:"thead",isVoid:!1},{name:"tr",isVoid:!1},{name:"ul",isVoid:!1}],e=t.map(o=>o.name).join("|"),i=s.replace(new RegExp(`</?(${e})( .*?)?>`,"g"),`
$&
`).replace(/<br[^>]*>/g,`$&
`).split(`
`);let n=0,r=!1;return i.map(o=>(r=dD(o,r),!o.length&&!r?"":uD(o,t)?zf(o,n++):hD(o,t)?zf(o,--n):r==="middle"||r==="last"?zf(o,0):zf(o,n))).join("").trimEnd()}function uD(s,t){return t.some(e=>!(e.isVoid||!new RegExp(`<${e.name}( .*?)?>`).test(s)))}function hD(s,t){return t.some(e=>new RegExp(`</${e.name}>`).test(s))}function zf(s,t,e="    "){return`${e.repeat(Math.max(0,t))}${s}
`}function dD(s,t){const e=/<pre( .*?)?>/.test(s),i=/<\/pre>/.test(s);return e&&i?!1:e?"first":i?"last":t==="first"||t==="middle"?"middle":!1}/**
 * @license Copyright (c) 2003-2025, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options
 */function fD(s){return!!s&&s.length==1&&/[\u0300-\u036f\u1ab0-\u1aff\u1dc0-\u1dff\u20d0-\u20ff\ufe20-\ufe2f]/.test(s)}function mD(s){return!!s&&s.length==1&&/[\ud800-\udbff]/.test(s)}function gD(s){return!!s&&s.length==1&&/[\udc00-\udfff]/.test(s)}function QO(s,t){return mD(s.charAt(t-1))&&gD(s.charAt(t))}function NO(s,t){return fD(s.charAt(t))}const pD=wD();function eA(s,t){const e=String(s).matchAll(pD);return Array.from(e).some(i=>i.index<t&&t<i.index+i[0].length)}function wD(){const s=[new RegExp("\\p{Emoji}[\\u{E0020}-\\u{E007E}]+\\u{E007F}","u"),new RegExp("\\p{Emoji}\\u{FE0F}?\\u{20E3}","u"),new RegExp("\\p{Emoji}\\u{FE0F}","u"),new RegExp("(?=\\p{General_Category=Other_Symbol})\\p{Emoji}\\p{Emoji_Modifier}*","u")],t=new RegExp("\\p{Regional_Indicator}{2}","u").source,e="(?:"+s.map(n=>n.source).join("|")+")",i=`${t}|${e}(?:‍${e})*`;return new RegExp(i,"ug")}/**
 * @license Copyright (c) 2003-2025, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options
 */const Su=new WeakMap;let US=!1;function FO({view:s,element:t,text:e,isDirectHost:i=!0,keepOnFocus:n=!1}){const r=s.document;Su.has(r)||(Su.set(r,new Map),r.registerPostFixer(l=>Zw(Su.get(r),l)),r.on("change:isComposing",()=>{s.change(l=>Zw(Su.get(r),l))},{priority:"high"})),t.is("editableElement")&&t.on("change:placeholder",(l,a,c)=>o(c)),t.placeholder?o(t.placeholder):e&&o(e),e&&_D();function o(l){const a={text:l,isDirectHost:i,keepOnFocus:n,hostElement:i?t:null};Su.get(r).set(t,a),s.change(c=>Zw([[t,a]],c))}}function xD(s,t){return t.hasClass("ck-placeholder")?!1:(s.addClass("ck-placeholder",t),!0)}function bD(s,t){return t.hasClass("ck-placeholder")?(s.removeClass("ck-placeholder",t),!0):!1}function OD(s,t){if(!s.isAttached()||yD(s))return!1;const e=s.document,n=e.selection.anchor;return e.isComposing&&n&&n.parent===s?!1:t||!e.isFocused?!0:!!n&&n.parent!==s}function yD(s){for(const t of s.getChildren())if(!t.is("uiElement"))return!0;return!1}function Zw(s,t){const e=[];let i=!1;for(const[n,r]of s)r.isDirectHost&&(e.push(n),ZS(t,n,r)&&(i=!0));for(const[n,r]of s){if(r.isDirectHost)continue;const o=vD(n);o&&(e.includes(o)||(r.hostElement=o,ZS(t,n,r)&&(i=!0)))}return i}function ZS(s,t,e){const{text:i,isDirectHost:n,hostElement:r}=e;let o=!1;return r.getAttribute("data-placeholder")!==i&&(s.setAttribute("data-placeholder",i,r),o=!0),(n||t.childCount==1)&&OD(r,e.keepOnFocus)?xD(s,r)&&(o=!0):bD(s,r)&&(o=!0),o}function vD(s){if(s.childCount){const t=s.getChild(0);if(t.is("element")&&!t.is("uiElement")&&!t.is("attributeElement"))return t}return null}function _D(){US||Ue("enableplaceholder-deprecated-text-option"),US=!0}/**
 * @license Copyright (c) 2003-2025, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options
 */let Dl=class{is(){throw new Error("is() method is abstract")}},Ql=class extends pt(Dl){constructor(e){super();p(this,"document");p(this,"parent");this.document=e,this.parent=null}get index(){let e;if(!this.parent)return null;if((e=this.parent.getChildIndex(this))==-1)throw new E("view-node-not-found-in-parent",this);return e}get nextSibling(){const e=this.index;return e!==null&&this.parent.getChild(e+1)||null}get previousSibling(){const e=this.index;return e!==null&&this.parent.getChild(e-1)||null}get root(){let e=this;for(;e.parent;)e=e.parent;return e}isAttached(){return this.root.is("rootElement")}getPath(){const e=[];let i=this;for(;i.parent;)e.unshift(i.index),i=i.parent;return e}getAncestors(e={}){const i=[];let n=e.includeSelf?this:this.parent;for(;n;)i[e.parentFirst?"push":"unshift"](n),n=n.parent;return i}getCommonAncestor(e,i={}){const n=this.getAncestors(i),r=e.getAncestors(i);let o=0;for(;n[o]==r[o]&&n[o];)o++;return o===0?null:n[o-1]}isBefore(e){if(this==e||this.root!==e.root)return!1;const i=this.getPath(),n=e.getPath(),r=Ni(i,n);switch(r){case"prefix":return!0;case"extension":return!1;default:return i[r]<n[r]}}isAfter(e){return this==e||this.root!==e.root?!1:!this.isBefore(e)}_remove(){this.parent._removeChildren(this.index)}_fireChange(e,i,n){this.fire(`change:${e}`,i,n),this.parent&&this.parent._fireChange(e,i,n)}toJSON(){const e=PO(this);return delete e.parent,e}};Ql.prototype.is=function(s){return s==="node"||s==="view:node"};let Ri=class Eb extends Ql{constructor(e,i){super(e);p(this,"_textData");this._textData=i}get data(){return this._textData}get _data(){return this.data}set _data(e){this._fireChange("text",this),this._textData=e}isSimilar(e){return e instanceof Eb?this===e||this.data===e.data:!1}_clone(){return new Eb(this.document,this.data)}};Ri.prototype.is=function(s){return s==="$text"||s==="view:$text"||s==="text"||s==="view:text"||s==="node"||s==="view:node"};let Cr=class extends Dl{constructor(e,i,n){super();p(this,"textNode");p(this,"data");p(this,"offsetInText");if(this.textNode=e,i<0||i>e.data.length)throw new E("view-textproxy-wrong-offsetintext",this);if(n<0||i+n>e.data.length)throw new E("view-textproxy-wrong-length",this);this.data=e.data.substring(i,i+n),this.offsetInText=i}get offsetSize(){return this.data.length}get isPartial(){return this.data.length!==this.textNode.data.length}get parent(){return this.textNode.parent}get root(){return this.textNode.root}get document(){return this.textNode.document}getAncestors(e={}){const i=[];let n=e.includeSelf?this.textNode:this.parent;for(;n!==null;)i[e.parentFirst?"push":"unshift"](n),n=n.parent;return i}};Cr.prototype.is=function(s){return s==="$textProxy"||s==="view:$textProxy"||s==="textProxy"||s==="view:textProxy"};class pg{constructor(){p(this,"_consumables",new Map)}add(t,e){let i;if(t.is("$text")||t.is("documentFragment")){this._consumables.set(t,!0);return}this._consumables.has(t)?i=this._consumables.get(t):(i=new kD(t),this._consumables.set(t,i)),i.add(e?ju(e):t._getConsumables())}test(t,e){const i=this._consumables.get(t);return i===void 0?null:t.is("$text")||t.is("documentFragment")?i:i.test(ju(e))}consume(t,e){if(t.is("$text")||t.is("documentFragment"))return this.test(t,e)?(this._consumables.set(t,!1),!0):!1;const i=this._consumables.get(t);return i===void 0?!1:i.consume(ju(e))}revert(t,e){const i=this._consumables.get(t);i!==void 0&&(t.is("$text")||t.is("documentFragment")?this._consumables.set(t,!0):i.revert(ju(e)))}static createFrom(t,e){if(e||(e=new pg),t.is("$text"))e.add(t);else if(t.is("element")||t.is("documentFragment")){e.add(t);for(const i of t.getChildren())pg.createFrom(i,e)}return e}}class kD{constructor(t){p(this,"element");p(this,"_canConsumeName",null);p(this,"_attributes",new Map);this.element=t}add(t){t.name&&(this._canConsumeName=!0);for(const[e,i]of t.attributes)if(i){let n=this._attributes.get(e);(!n||typeof n=="boolean")&&(n=new Map,this._attributes.set(e,n)),n.set(i,!0)}else{if(e=="style"||e=="class")throw new E("viewconsumable-invalid-attribute",this);this._attributes.set(e,!0)}}test(t){if(t.name&&!this._canConsumeName)return this._canConsumeName;for(const[e,i]of t.attributes){const n=this._attributes.get(e);if(n===void 0)return null;if(n===!1)return!1;if(n!==!0){if(i){const r=n.get(i);if(r===void 0)return null;if(!r)return!1}else for(const r of n.values())if(!r)return!1}}return!0}consume(t){if(!this.test(t))return!1;t.name&&(this._canConsumeName=!1);for(const[e,i]of t.attributes){const n=this._attributes.get(e);if(typeof n=="boolean")for(const[r]of this.element._getConsumables(e,i).attributes)this._attributes.set(r,!1);else if(i)for(const[,r]of this.element._getConsumables(e,i).attributes)n.set(r,!1);else for(const r of n.keys())n.set(r,!1)}return!0}revert(t){t.name&&(this._canConsumeName=!0);for(const[e,i]of t.attributes){const n=this._attributes.get(e);if(n===!1){this._attributes.set(e,!0);continue}if(!(n===void 0||n===!0))if(i)n.get(i)===!1&&n.set(i,!0);else for(const r of n.keys())n.set(r,!0)}}}function ju(s){const t=[];return"attributes"in s&&s.attributes&&Hw(t,s.attributes),"classes"in s&&s.classes&&Hw(t,s.classes,"class"),"styles"in s&&s.styles&&Hw(t,s.styles,"style"),{name:s.name||!1,attributes:t}}function Hw(s,t,e){if(typeof t=="string"){s.push(e?[e,t]:[t]);return}for(const i of t)Array.isArray(i)?s.push(i):s.push(e?[e,i]:[i])}class kn{constructor(...t){p(this,"_patterns",[]);this.add(...t)}add(...t){for(let e of t)(typeof e=="string"||e instanceof RegExp)&&(e={name:e}),this._patterns.push(e)}match(...t){for(const e of t)for(const i of this._patterns){const n=this._isElementMatching(e,i);if(n)return{element:e,pattern:i,match:n}}return null}matchAll(...t){const e=[];for(const i of t)for(const n of this._patterns){const r=this._isElementMatching(i,n);r&&e.push({element:i,pattern:n,match:r})}return e.length>0?e:null}getElementName(){if(this._patterns.length!==1)return null;const t=this._patterns[0],e=t.name;return typeof t!="function"&&e&&!(e instanceof RegExp)?e:null}_isElementMatching(t,e){if(typeof e=="function"){const r=e(t);return!r||typeof r!="object"?r:ju(r)}const i={};if(e.name&&(i.name=SD(e.name,t.name),!i.name))return null;const n=[];return e.attributes&&!CD(e.attributes,t,n)||e.classes&&!PD(e.classes,t,n)||e.styles&&!TD(e.styles,t,n)?null:(n.length&&(i.attributes=n),i)}}function wg(s,t){return s===!0||s===t||s instanceof RegExp&&!!String(t).match(s)}function SD(s,t){return s instanceof RegExp?!!t.match(s):s===t}function zO(s,t){if(Array.isArray(s))return s.map(i=>typeof i!="object"||i instanceof RegExp?t?[t,i,!0]:[i,!0]:((i.key===void 0||i.value===void 0)&&Ue("matcher-pattern-missing-key-or-value",i),t?[t,i.key,i.value]:[i.key,i.value]));if(typeof s!="object"||s instanceof RegExp)return[t?[t,s,!0]:[s,!0]];const e=[];for(const i in s)Object.prototype.hasOwnProperty.call(s,i)&&e.push(t?[t,i,s[i]]:[i,s[i]]);return e}function CD(s,t,e){let i;return typeof s=="object"&&!(s instanceof RegExp)&&!Array.isArray(s)?(s.style!==void 0&&Ue("matcher-pattern-deprecated-attributes-style-key",s),s.class!==void 0&&Ue("matcher-pattern-deprecated-attributes-class-key",s)):i=["class","style"],t._collectAttributesMatch(zO(s),e,i)}function PD(s,t,e){return t._collectAttributesMatch(zO(s,"class"),e)}function TD(s,t,e){return t._collectAttributesMatch(zO(s,"style"),e)}class nc{constructor(t){p(this,"_styles");p(this,"_cachedStyleNames",null);p(this,"_cachedExpandedStyleNames",null);p(this,"_styleProcessor");this._styles={},this._styleProcessor=t}get isEmpty(){return!Object.entries(this._styles).length}get size(){return this.isEmpty?0:this.getStyleNames().length}setTo(t){this.clear();const e=AD(t);for(const[i,n]of e)this._styleProcessor.toNormalizedForm(i,n,this._styles);return this}has(t){if(this.isEmpty)return!1;const i=this._styleProcessor.getReducedForm(t,this._styles).find(([n])=>n===t);return Array.isArray(i)}set(t,e){if(this._cachedStyleNames=null,this._cachedExpandedStyleNames=null,ds(t))for(const[i,n]of Object.entries(t))this._styleProcessor.toNormalizedForm(i,n,this._styles);else this._styleProcessor.toNormalizedForm(t,e,this._styles)}remove(t){for(const e of dt(t)){this._cachedStyleNames=null,this._cachedExpandedStyleNames=null;const i=Ab(e);N$(this._styles,i),delete this._styles[e],this._cleanEmptyObjectsOnPath(i)}}getNormalized(t){return this._styleProcessor.getNormalized(t,this._styles)}toString(){return this.isEmpty?"":this.getStylesEntries().map(t=>t.join(":")).sort().join(";")+";"}getAsString(t){if(this.isEmpty)return;if(this._styles[t]&&!ds(this._styles[t]))return this._styles[t];const i=this._styleProcessor.getReducedForm(t,this._styles).find(([n])=>n===t);if(Array.isArray(i))return i[1]}getStyleNames(t=!1){return this.isEmpty?[]:t?(this._cachedExpandedStyleNames||(this._cachedExpandedStyleNames=this._styleProcessor.getStyleNames(this._styles)),this._cachedExpandedStyleNames):(this._cachedStyleNames||(this._cachedStyleNames=this.getStylesEntries().map(([e])=>e)),this._cachedStyleNames)}keys(){return this.getStyleNames()}clear(){this._styles={},this._cachedStyleNames=null,this._cachedExpandedStyleNames=null}isSimilar(t){if(this.size!==t.size)return!1;for(const e of this.getStyleNames())if(!t.has(e)||t.getAsString(e)!==this.getAsString(e))return!1;return!0}getStylesEntries(){const t=[],e=Object.keys(this._styles);for(const i of e)t.push(...this._styleProcessor.getReducedForm(i,this._styles));return t}_clone(){const t=new this.constructor(this._styleProcessor);return t.set(this.getNormalized()),t}_getTokensMatch(t,e){const i=[];for(const n of this.getStyleNames(!0))if(wg(t,n)){if(e===!0){i.push(n);continue}const r=this.getAsString(n);wg(e,r)&&i.push(n)}return i.length?i:void 0}_getConsumables(t){const e=[];if(t){e.push(t);for(const i of this._styleProcessor.getRelatedStyles(t))e.push(i)}else for(const i of this.getStyleNames()){for(const n of this._styleProcessor.getRelatedStyles(i))e.push(n);e.push(i)}return e}_canMergeFrom(t){for(const e of t.getStyleNames())if(this.has(e)&&this.getAsString(e)!==t.getAsString(e))return!1;return!0}_mergeFrom(t){for(const e of t.getStyleNames())this.has(e)||this.set(e,t.getAsString(e))}_isMatching(t){for(const e of t.getStyleNames())if(!this.has(e)||this.getAsString(e)!==t.getAsString(e))return!1;return!0}_cleanEmptyObjectsOnPath(t){const e=t.split(".");if(!(e.length>1))return;const n=e.splice(0,e.length-1).join("."),r=Eo(this._styles,n);if(!r)return;!Object.keys(r).length&&this.remove(n)}}class ED{constructor(){p(this,"_normalizers");p(this,"_extractors");p(this,"_reducers");p(this,"_consumables");this._normalizers=new Map,this._extractors=new Map,this._reducers=new Map,this._consumables=new Map}toNormalizedForm(t,e,i){if(ds(e)){qw(i,Ab(t),e);return}if(this._normalizers.has(t)){const n=this._normalizers.get(t),{path:r,value:o}=n(e);qw(i,r,o)}else qw(i,t,e)}getNormalized(t,e){if(!t)return RO({},e);if(e[t]!==void 0)return e[t];if(this._extractors.has(t)){const i=this._extractors.get(t);if(typeof i=="string")return Eo(e,i);const n=i(t,e);if(n)return n}return Eo(e,Ab(t))}getReducedForm(t,e){const i=this.getNormalized(t,e);return i===void 0?[]:this._reducers.has(t)?this._reducers.get(t)(i):[[t,i]]}getStyleNames(t){const e=new Set;for(const i of this._consumables.keys()){const n=this.getNormalized(i,t);n&&(typeof n!="object"||Object.keys(n).length)&&e.add(i)}for(const i of Object.keys(t))e.add(i);return Array.from(e)}getRelatedStyles(t){return this._consumables.get(t)||[]}setNormalizer(t,e){this._normalizers.set(t,e)}setExtractor(t,e){this._extractors.set(t,e)}setReducer(t,e){this._reducers.set(t,e)}setStyleRelation(t,e){this._mapStyleNames(t,e);for(const i of e)this._mapStyleNames(i,[t])}_mapStyleNames(t,e){this._consumables.has(t)||this._consumables.set(t,[]),this._consumables.get(t).push(...e)}}function AD(s){let t=null,e=0,i=0,n=null;const r=new Map;if(s==="")return r;s.charAt(s.length-1)!=";"&&(s=s+";");for(let o=0;o<s.length;o++){const l=s.charAt(o);if(t===null)switch(l){case":":n||(n=s.substr(e,o-e),i=o+1);break;case'"':case"'":t=l;break;case";":{const a=s.substr(i,o-i);n&&r.set(n.trim(),a.trim()),n=null,e=o+1;break}}else l===t&&(t=null)}return r}function Ab(s){return s.replace("-",".")}function qw(s,t,e){let i=e;ds(e)&&(i=RO({},Eo(s,t),e)),P6(s,t,i)}class jw{constructor(){p(this,"_set",new Set)}get isEmpty(){return this._set.size==0}get size(){return this._set.size}has(t){return this._set.has(t)}keys(){return Array.from(this._set.keys())}setTo(t){this.clear();for(const e of t.split(/\s+/))e&&this._set.add(e);return this}set(t){for(const e of dt(t))e&&this._set.add(e)}remove(t){for(const e of dt(t))this._set.delete(e)}clear(){this._set.clear()}toString(){return Array.from(this._set).join(" ")}isSimilar(t){if(this.size!==t.size)return!1;for(const e of this.keys())if(!t.has(e))return!1;return!0}_clone(){const t=new this.constructor;return t._set=new Set(this._set),t}_getTokensMatch(t){const e=[];if(t===!0){for(const i of this._set.keys())e.push(i);return e}if(typeof t=="string"){for(const i of t.split(/\s+/))if(this._set.has(i))e.push(i);else return;return e}for(const i of this._set.keys())i.match(t)&&e.push(i);return e.length?e:void 0}_getConsumables(t){return t?[t]:this.keys()}_canMergeFrom(){return!0}_mergeFrom(t){for(const e of t._set.keys())this._set.has(e)||this._set.add(e)}_isMatching(t){for(const e of t._set.keys())if(!this._set.has(e))return!1;return!0}}let Br=class tA extends Ql{constructor(e,i,n,r){super(e);p(this,"name");p(this,"_unsafeAttributesToRender",[]);p(this,"_attrs");p(this,"_children");p(this,"_customProperties",new Map);this.name=i,this._attrs=this._parseAttributes(n),this._children=[],r&&this._insertChild(0,r)}get _classes(){return this._attrs.get("class")}get _styles(){return this._attrs.get("style")}get childCount(){return this._children.length}get isEmpty(){return this._children.length===0}getChild(e){return this._children[e]}getChildIndex(e){return this._children.indexOf(e)}getChildren(){return this._children[Symbol.iterator]()}*getAttributeKeys(){this._classes&&(yield"class"),this._styles&&(yield"style");for(const e of this._attrs.keys())e!="class"&&e!="style"&&(yield e)}*getAttributes(){for(const[e,i]of this._attrs.entries())yield[e,String(i)]}getAttribute(e){return this._attrs.has(e)?String(this._attrs.get(e)):void 0}hasAttribute(e,i){return this._attrs.has(e)?i!==void 0?_a(this.name,e)||Cu(this.name,e)?this._attrs.get(e).has(i):this._attrs.get(e)===i:!0:!1}isSimilar(e){if(!(e instanceof tA))return!1;if(this===e)return!0;if(this.name!=e.name||this._attrs.size!==e._attrs.size)return!1;for(const[i,n]of this._attrs){const r=e._attrs.get(i);if(r===void 0)return!1;if(typeof n=="string"||typeof r=="string"){if(r!==n)return!1}else if(!n.isSimilar(r))return!1}return!0}hasClass(...e){for(const i of e)if(!this._classes||!this._classes.has(i))return!1;return!0}getClassNames(){const e=this._classes?this._classes.keys():[],i=e[Symbol.iterator]();return Object.assign(e,{next:i.next.bind(i)})}getStyle(e){return this._styles&&this._styles.getAsString(e)}getNormalizedStyle(e){return this._styles&&this._styles.getNormalized(e)}getStyleNames(e){return this._styles?this._styles.getStyleNames(e):[]}hasStyle(...e){for(const i of e)if(!this._styles||!this._styles.has(i))return!1;return!0}findAncestor(...e){const i=new kn(...e);let n=this.parent;for(;n&&!n.is("documentFragment");){if(i.match(n))return n;n=n.parent}return null}getCustomProperty(e){return this._customProperties.get(e)}*getCustomProperties(){yield*this._customProperties.entries()}getIdentity(){const e=this._classes?this._classes.keys().sort().join(","):"",i=this._styles&&String(this._styles),n=Array.from(this._attrs).filter(([r])=>r!="style"&&r!="class").map(r=>`${r[0]}="${r[1]}"`).sort().join(" ");return this.name+(e==""?"":` class="${e}"`)+(i?` style="${i}"`:"")+(n==""?"":` ${n}`)}shouldRenderUnsafeAttribute(e){return this._unsafeAttributesToRender.includes(e)}_clone(e=!1){const i=[];if(e)for(const r of this.getChildren())i.push(r._clone(e));const n=new this.constructor(this.document,this.name,this._attrs,i);return n._customProperties=new Map(this._customProperties),n.getFillerOffset=this.getFillerOffset,n._unsafeAttributesToRender=this._unsafeAttributesToRender,n}_appendChild(e){return this._insertChild(this.childCount,e)}_insertChild(e,i){this._fireChange("children",this,{index:e});let n=0;const r=ID(this.document,i);for(const o of r)o.parent!==null&&o._remove(),o.parent=this,o.document=this.document,this._children.splice(e,0,o),e++,n++;return n}_removeChildren(e,i=1){this._fireChange("children",this,{index:e});for(let n=e;n<e+i;n++)this._children[n].parent=null;return this._children.splice(e,i)}_setAttribute(e,i,n=!0){if(this._fireChange("attributes",this),_a(this.name,e)||Cu(this.name,e)){let r=this._attrs.get(e);r||(r=_a(this.name,e)?new nc(this.document.stylesProcessor):new jw,this._attrs.set(e,r)),n?r.setTo(String(i)):_a(this.name,e)?Array.isArray(i)?r.set(i[0],i[1]):r.set(i):r.set(typeof i=="string"?i.split(/\s+/):i)}else this._attrs.set(e,String(i))}_removeAttribute(e,i){if(this._fireChange("attributes",this),i!==void 0&&(_a(this.name,e)||Cu(this.name,e))){const n=this._attrs.get(e);return n?(Cu(this.name,e)&&typeof i=="string"&&(i=i.split(/\s+/)),n.remove(i),n.isEmpty?this._attrs.delete(e):!1):!1}return this._attrs.delete(e)}_addClass(e){this._setAttribute("class",e,!1)}_removeClass(e){this._removeAttribute("class",e)}_setStyle(e,i){typeof e!="string"?this._setAttribute("style",e,!1):this._setAttribute("style",[e,i],!1)}_removeStyle(e){this._removeAttribute("style",e)}_collectAttributesMatch(e,i,n){for(const[r,o,l]of e){let a=!1,c=!1;for(const[h,f]of this._attrs)if(!(n&&n.includes(h)||!wg(r,h)))if(a=!0,typeof f=="string"){if(wg(o,f))i.push([h]),c=!0;else if(!(r instanceof RegExp))return!1}else{const m=f._getTokensMatch(o,l||!0);if(m){c=!0;for(const w of m)i.push([h,w])}else if(!(r instanceof RegExp))return!1}if(!a||!c)return!1}return!0}_getConsumables(e,i){const n=[];if(e){const r=this._attrs.get(e);if(r!==void 0)if(typeof r=="string")n.push([e]);else for(const o of r._getConsumables(i))n.push([e,o])}else for(const[r,o]of this._attrs)if(typeof o=="string")n.push([r]);else for(const l of o._getConsumables())n.push([r,l]);return{name:!e,attributes:n}}_canMergeAttributesFrom(e){if(this.name!=e.name)return!1;for(const[i,n]of e._attrs){const r=this._attrs.get(i);if(r!==void 0){if(typeof r=="string"||typeof n=="string"){if(r!==n)return!1}else if(!r._canMergeFrom(n))return!1}}return!0}_mergeAttributesFrom(e){this._fireChange("attributes",this);for(const[i,n]of e._attrs){const r=this._attrs.get(i);r===void 0||typeof r=="string"||typeof n=="string"?this._setAttribute(i,n):r._mergeFrom(n)}}_canSubtractAttributesOf(e){if(this.name!=e.name)return!1;for(const[i,n]of e._attrs){const r=this._attrs.get(i);if(r===void 0)return!1;if(typeof r=="string"||typeof n=="string"){if(r!==n)return!1}else if(!r._isMatching(n))return!1}return!0}_subtractAttributesOf(e){this._fireChange("attributes",this);for(const[i,n]of e._attrs){const r=this._attrs.get(i);typeof r=="string"||typeof n=="string"?this._attrs.delete(i):(r.remove(n.keys()),r.isEmpty&&this._attrs.delete(i))}}_setCustomProperty(e,i){this._customProperties.set(e,i)}_removeCustomProperty(e){return this._customProperties.delete(e)}_parseAttributes(e){const i=ms(e);for(const[n,r]of i)if(r===null)i.delete(n);else if(_a(this.name,n)){const o=r instanceof nc?r._clone():new nc(this.document.stylesProcessor).setTo(String(r));i.set(n,o)}else if(Cu(this.name,n)){const o=r instanceof jw?r._clone():new jw().setTo(String(r));i.set(n,o)}else typeof r!="string"&&i.set(n,String(r));return i}};Br.prototype.is=function(s,t){return t?t===this.name&&(s==="element"||s==="view:element"):s==="element"||s==="view:element"||s==="node"||s==="view:node"};function ID(s,t){if(typeof t=="string")return[new Ri(s,t)];Wn(t)||(t=[t]);const e=[];for(const i of t)typeof i=="string"?e.push(new Ri(s,i)):i instanceof Cr?e.push(new Ri(s,i.data)):e.push(i);return e}function Cu(s,t){return t=="class"||s=="a"&&t=="rel"}function _a(s,t){return t=="style"}class Sh extends Br{constructor(t,e,i,n){super(t,e,i,n),this.getFillerOffset=RD}}Sh.prototype.is=function(s,t){return t?t===this.name&&(s==="containerElement"||s==="view:containerElement"||s==="element"||s==="view:element"):s==="containerElement"||s==="view:containerElement"||s==="element"||s==="view:element"||s==="node"||s==="view:node"};function RD(){const s=[...this.getChildren()],t=s[this.childCount-1];if(t&&t.is("element","br"))return this.childCount;for(const e of s)if(!e.is("uiElement"))return null;return this.childCount}class kp extends at(Sh){constructor(t,e,i,n){super(t,e,i,n),this.set("isReadOnly",!1),this.set("isFocused",!1),this.set("placeholder",void 0),this.bind("isReadOnly").to(t),this.bind("isFocused").to(t,"isFocused",r=>r&&t.selection.editableElement==this),this.listenTo(t.selection,"change",()=>{this.isFocused=t.isFocused&&t.selection.editableElement==this})}destroy(){this.stopListening()}}kp.prototype.is=function(s,t){return t?t===this.name&&(s==="editableElement"||s==="view:editableElement"||s==="containerElement"||s==="view:containerElement"||s==="element"||s==="view:element"):s==="editableElement"||s==="view:editableElement"||s==="containerElement"||s==="view:containerElement"||s==="element"||s==="view:element"||s==="node"||s==="view:node"};const HS=Symbol("rootName");class iA extends kp{constructor(t,e){super(t,e),this.rootName="main"}get rootName(){return this.getCustomProperty(HS)}set rootName(t){this._setCustomProperty(HS,t)}set _name(t){this.name=t}}iA.prototype.is=function(s,t){return t?t===this.name&&(s==="rootElement"||s==="view:rootElement"||s==="editableElement"||s==="view:editableElement"||s==="containerElement"||s==="view:containerElement"||s==="element"||s==="view:element"):s==="rootElement"||s==="view:rootElement"||s==="editableElement"||s==="view:editableElement"||s==="containerElement"||s==="view:containerElement"||s==="element"||s==="view:element"||s==="node"||s==="view:node"};let wl=class{constructor(t={}){p(this,"direction");p(this,"boundaries");p(this,"singleCharacters");p(this,"shallow");p(this,"ignoreElementEnd");p(this,"_position");p(this,"_boundaryStartParent");p(this,"_boundaryEndParent");if(!t.boundaries&&!t.startPosition)throw new E("view-tree-walker-no-start-position",null);if(t.direction&&t.direction!="forward"&&t.direction!="backward")throw new E("view-tree-walker-unknown-direction",t.startPosition,{direction:t.direction});this.boundaries=t.boundaries||null,t.startPosition?this._position=be._createAt(t.startPosition):this._position=be._createAt(t.boundaries[t.direction=="backward"?"end":"start"]),this.direction=t.direction||"forward",this.singleCharacters=!!t.singleCharacters,this.shallow=!!t.shallow,this.ignoreElementEnd=!!t.ignoreElementEnd,this._boundaryStartParent=this.boundaries?this.boundaries.start.parent:null,this._boundaryEndParent=this.boundaries?this.boundaries.end.parent:null}[Symbol.iterator](){return this}get position(){return this._position}skip(t){let e,i;do i=this.position,e=this.next();while(!e.done&&t(e.value));e.done||(this._position=i)}jumpTo(t){this._boundaryStartParent&&t.isBefore(this.boundaries.start)?t=this.boundaries.start:this._boundaryEndParent&&t.isAfter(this.boundaries.end)&&(t=this.boundaries.end),this._position=t.clone()}next(){return this.direction=="forward"?this._next():this._previous()}_next(){let t=this.position.clone();const e=this.position,i=t.parent;if(i.parent===null&&t.offset===i.childCount)return{done:!0,value:void 0};if(i===this._boundaryEndParent&&t.offset==this.boundaries.end.offset)return{done:!0,value:void 0};let n;if(i&&i.is("view:$text")){if(t.isAtEnd)return this._position=be._createAfter(i),this._next();n=i.data[t.offset]}else n=i.getChild(t.offset);if(typeof n=="string"){let r;this.singleCharacters?r=1:r=(i===this._boundaryEndParent?this.boundaries.end.offset:i.data.length)-t.offset;const o=new Cr(i,t.offset,r);return t.offset+=r,this._position=t,this._formatReturnValue("text",o,e,t,r)}if(n&&n.is("view:element")){if(!this.shallow)t=new be(n,0);else{if(this.boundaries&&this.boundaries.end.isBefore(t))return{done:!0,value:void 0};t.offset++}return this._position=t,this._formatReturnValue("elementStart",n,e,t,1)}if(n&&n.is("view:$text")){if(this.singleCharacters)return t=new be(n,0),this._position=t,this._next();let r=n.data.length,o;return n==this._boundaryEndParent?(r=this.boundaries.end.offset,o=new Cr(n,0,r),t=be._createAfter(o)):(o=new Cr(n,0,n.data.length),t.offset++),this._position=t,this._formatReturnValue("text",o,e,t,r)}return t=be._createAfter(i),this._position=t,this.ignoreElementEnd?this._next():this._formatReturnValue("elementEnd",i,e,t)}_previous(){let t=this.position.clone();const e=this.position,i=t.parent;if(i.parent===null&&t.offset===0)return{done:!0,value:void 0};if(i==this._boundaryStartParent&&t.offset==this.boundaries.start.offset)return{done:!0,value:void 0};let n;if(i.is("view:$text")){if(t.isAtStart)return this._position=be._createBefore(i),this._previous();n=i.data[t.offset-1]}else n=i.getChild(t.offset-1);if(typeof n=="string"){let r;if(this.singleCharacters)r=1;else{const l=i===this._boundaryStartParent?this.boundaries.start.offset:0;r=t.offset-l}t.offset-=r;const o=new Cr(i,t.offset,r);return this._position=t,this._formatReturnValue("text",o,e,t,r)}if(n&&n.is("view:element"))return this.shallow?(t.offset--,this._position=t,this._formatReturnValue("elementStart",n,e,t,1)):(t=new be(n,n.childCount),this._position=t,this.ignoreElementEnd?this._previous():this._formatReturnValue("elementEnd",n,e,t));if(n&&n.is("view:$text")){if(this.singleCharacters)return t=new be(n,n.data.length),this._position=t,this._previous();let r=n.data.length,o;if(n==this._boundaryStartParent){const l=this.boundaries.start.offset;o=new Cr(n,l,n.data.length-l),r=o.data.length,t=be._createBefore(o)}else o=new Cr(n,0,n.data.length),t.offset--;return this._position=t,this._formatReturnValue("text",o,e,t,r)}return t=be._createBefore(i),this._position=t,this._formatReturnValue("elementStart",i,e,t,1)}_formatReturnValue(t,e,i,n,r){return e.is("view:$textProxy")&&(e.offsetInText+e.data.length==e.textNode.data.length&&(this.direction=="forward"&&!(this.boundaries&&this.boundaries.end.isEqual(this.position))?(n=be._createAfter(e.textNode),this._position=n):i=be._createAfter(e.textNode)),e.offsetInText===0&&(this.direction=="backward"&&!(this.boundaries&&this.boundaries.start.isEqual(this.position))?(n=be._createBefore(e.textNode),this._position=n):i=be._createBefore(e.textNode))),{done:!1,value:{type:t,item:e,previousPosition:i,nextPosition:n,length:r}}}},be=class kr extends Dl{constructor(e,i){super();p(this,"parent");p(this,"offset");this.parent=e,this.offset=i}get nodeAfter(){return this.parent.is("$text")?null:this.parent.getChild(this.offset)||null}get nodeBefore(){return this.parent.is("$text")?null:this.parent.getChild(this.offset-1)||null}get isAtStart(){return this.offset===0}get isAtEnd(){const e=this.parent.is("$text")?this.parent.data.length:this.parent.childCount;return this.offset===e}get root(){return this.parent.root}get editableElement(){let e=this.parent;for(;!(e instanceof kp);)if(e.parent)e=e.parent;else return null;return e}getShiftedBy(e){const i=kr._createAt(this),n=i.offset+e;return i.offset=n<0?0:n,i}getLastMatchingPosition(e,i={}){i.startPosition=this;const n=new wl(i);return n.skip(e),n.position}getAncestors(){return this.parent.is("documentFragment")?[this.parent]:this.parent.getAncestors({includeSelf:!0})}getCommonAncestor(e){const i=this.getAncestors(),n=e.getAncestors();let r=0;for(;i[r]==n[r]&&i[r];)r++;return r===0?null:i[r-1]}isEqual(e){return this.parent==e.parent&&this.offset==e.offset}isBefore(e){return this.compareWith(e)=="before"}isAfter(e){return this.compareWith(e)=="after"}compareWith(e){if(this.root!==e.root)return"different";if(this.isEqual(e))return"same";const i=this.parent.is("node")?this.parent.getPath():[],n=e.parent.is("node")?e.parent.getPath():[];i.push(this.offset),n.push(e.offset);const r=Ni(i,n);switch(r){case"prefix":return"before";case"extension":return"after";default:return i[r]<n[r]?"before":"after"}}getWalker(e={}){return e.startPosition=this,new wl(e)}clone(){return new kr(this.parent,this.offset)}static _createAt(e,i){if(e instanceof kr)return new this(e.parent,e.offset);{const n=e;if(i=="end")i=n.is("$text")?n.data.length:n.childCount;else{if(i=="before")return this._createBefore(n);if(i=="after")return this._createAfter(n);if(i!==0&&!i)throw new E("view-createpositionat-offset-required",n)}return new kr(n,i)}}static _createAfter(e){if(e.is("$textProxy"))return new kr(e.textNode,e.offsetInText+e.data.length);if(!e.parent)throw new E("view-position-after-root",e,{root:e});return new kr(e.parent,e.index+1)}static _createBefore(e){if(e.is("$textProxy"))return new kr(e.textNode,e.offsetInText);if(!e.parent)throw new E("view-position-before-root",e,{root:e});return new kr(e.parent,e.index)}};be.prototype.is=function(s){return s==="position"||s==="view:position"};let We=class go extends Dl{constructor(e,i=null){super();p(this,"start");p(this,"end");this.start=e.clone(),this.end=i?i.clone():e.clone()}*[Symbol.iterator](){yield*new wl({boundaries:this,ignoreElementEnd:!0})}get isCollapsed(){return this.start.isEqual(this.end)}get isFlat(){return this.start.parent===this.end.parent}get root(){return this.start.root}getEnlarged(){let e=this.start.getLastMatchingPosition(Wf,{direction:"backward"}),i=this.end.getLastMatchingPosition(Wf);return e.parent.is("$text")&&e.isAtStart&&(e=be._createBefore(e.parent)),i.parent.is("$text")&&i.isAtEnd&&(i=be._createAfter(i.parent)),new go(e,i)}getTrimmed(){let e=this.start.getLastMatchingPosition(Wf);if(e.isAfter(this.end)||e.isEqual(this.end))return new go(e,e);let i=this.end.getLastMatchingPosition(Wf,{direction:"backward"});const n=e.nodeAfter,r=i.nodeBefore;return n&&n.is("$text")&&(e=new be(n,0)),r&&r.is("$text")&&(i=new be(r,r.data.length)),new go(e,i)}isEqual(e){return this==e||this.start.isEqual(e.start)&&this.end.isEqual(e.end)}containsPosition(e){return e.isAfter(this.start)&&e.isBefore(this.end)}containsRange(e,i=!1){e.isCollapsed&&(i=!1);const n=this.containsPosition(e.start)||i&&this.start.isEqual(e.start),r=this.containsPosition(e.end)||i&&this.end.isEqual(e.end);return n&&r}getDifference(e){const i=[];return this.isIntersecting(e)?(this.containsPosition(e.start)&&i.push(new go(this.start,e.start)),this.containsPosition(e.end)&&i.push(new go(e.end,this.end))):i.push(this.clone()),i}getIntersection(e){if(this.isIntersecting(e)){let i=this.start,n=this.end;return this.containsPosition(e.start)&&(i=e.start),this.containsPosition(e.end)&&(n=e.end),new go(i,n)}return null}getWalker(e={}){return e.boundaries=this,new wl(e)}getCommonAncestor(){return this.start.getCommonAncestor(this.end)}getContainedElement(){if(this.isCollapsed)return null;let e=this.start.nodeAfter,i=this.end.nodeBefore;return this.start.parent.is("$text")&&this.start.isAtEnd&&this.start.parent.nextSibling&&(e=this.start.parent.nextSibling),this.end.parent.is("$text")&&this.end.isAtStart&&this.end.parent.previousSibling&&(i=this.end.parent.previousSibling),e&&e.is("element")&&e===i?e:null}clone(){return new go(this.start,this.end)}*getItems(e={}){e.boundaries=this,e.ignoreElementEnd=!0;const i=new wl(e);for(const n of i)yield n.item}*getPositions(e={}){e.boundaries=this;const i=new wl(e);yield i.position;for(const n of i)yield n.nextPosition}isIntersecting(e){return this.start.isBefore(e.end)&&this.end.isAfter(e.start)}static _createFromParentsAndOffsets(e,i,n,r){return new this(new be(e,i),new be(n,r))}static _createFromPositionAndShift(e,i){const n=e,r=e.getShiftedBy(i);return i>0?new this(n,r):new this(r,n)}static _createIn(e){return this._createFromParentsAndOffsets(e,0,e,e.childCount)}static _createOn(e){const i=e.is("$textProxy")?e.offsetSize:1;return this._createFromPositionAndShift(be._createBefore(e),i)}};We.prototype.is=function(s){return s==="range"||s==="view:range"};function Wf(s){return!!(s.item.is("attributeElement")||s.item.is("uiElement"))}let Ir=class nA extends pt(Dl){constructor(...e){super();p(this,"_ranges");p(this,"_lastRangeBackward");p(this,"_isFake");p(this,"_fakeSelectionLabel");this._ranges=[],this._lastRangeBackward=!1,this._isFake=!1,this._fakeSelectionLabel="",e.length&&this.setTo(...e)}get isFake(){return this._isFake}get fakeSelectionLabel(){return this._fakeSelectionLabel}get anchor(){if(!this._ranges.length)return null;const e=this._ranges[this._ranges.length-1];return(this._lastRangeBackward?e.end:e.start).clone()}get focus(){if(!this._ranges.length)return null;const e=this._ranges[this._ranges.length-1];return(this._lastRangeBackward?e.start:e.end).clone()}get isCollapsed(){return this.rangeCount===1&&this._ranges[0].isCollapsed}get rangeCount(){return this._ranges.length}get isBackward(){return!this.isCollapsed&&this._lastRangeBackward}get editableElement(){return this.anchor?this.anchor.editableElement:null}*getRanges(){for(const e of this._ranges)yield e.clone()}getFirstRange(){let e=null;for(const i of this._ranges)(!e||i.start.isBefore(e.start))&&(e=i);return e?e.clone():null}getLastRange(){let e=null;for(const i of this._ranges)(!e||i.end.isAfter(e.end))&&(e=i);return e?e.clone():null}getFirstPosition(){const e=this.getFirstRange();return e?e.start.clone():null}getLastPosition(){const e=this.getLastRange();return e?e.end.clone():null}isEqual(e){if(this.isFake!=e.isFake||this.isFake&&this.fakeSelectionLabel!=e.fakeSelectionLabel||this.rangeCount!=e.rangeCount)return!1;if(this.rangeCount===0)return!0;if(!this.anchor.isEqual(e.anchor)||!this.focus.isEqual(e.focus))return!1;for(const i of this._ranges){let n=!1;for(const r of e._ranges)if(i.isEqual(r)){n=!0;break}if(!n)return!1}return!0}isSimilar(e){if(this.isBackward!=e.isBackward)return!1;const i=Pb(this.getRanges()),n=Pb(e.getRanges());if(i!=n)return!1;if(i==0)return!0;for(let r of this.getRanges()){r=r.getTrimmed();let o=!1;for(let l of e.getRanges())if(l=l.getTrimmed(),r.start.isEqual(l.start)&&r.end.isEqual(l.end)){o=!0;break}if(!o)return!1}return!0}getSelectedElement(){return this.rangeCount!==1?null:this.getFirstRange().getContainedElement()}setTo(...e){let[i,n,r]=e;if(typeof n=="object"&&(r=n,n=void 0),i===null)this._setRanges([]),this._setFakeOptions(r);else if(i instanceof nA||i instanceof WO)this._setRanges(i.getRanges(),i.isBackward),this._setFakeOptions({fake:i.isFake,label:i.fakeSelectionLabel});else if(i instanceof We)this._setRanges([i],r&&r.backward),this._setFakeOptions(r);else if(i instanceof be)this._setRanges([new We(i)]),this._setFakeOptions(r);else if(i instanceof Ql){const o=!!r&&!!r.backward;let l;if(n===void 0)throw new E("view-selection-setto-required-second-parameter",this);n=="in"?l=We._createIn(i):n=="on"?l=We._createOn(i):l=new We(be._createAt(i,n)),this._setRanges([l],o),this._setFakeOptions(r)}else if(Wn(i))this._setRanges(i,r&&r.backward),this._setFakeOptions(r);else throw new E("view-selection-setto-not-selectable",this);this.fire("change")}setFocus(e,i){if(this.anchor===null)throw new E("view-selection-setfocus-no-ranges",this);const n=be._createAt(e,i);if(n.compareWith(this.focus)=="same")return;const r=this.anchor;this._ranges.pop(),n.compareWith(r)=="before"?this._addRange(new We(n,r),!0):this._addRange(new We(r,n)),this.fire("change")}_setRanges(e,i=!1){e=Array.from(e),this._ranges=[];for(const n of e)this._addRange(n);this._lastRangeBackward=!!i}_setFakeOptions(e={}){this._isFake=!!e.fake,this._fakeSelectionLabel=e.fake&&e.label||""}_addRange(e,i=!1){if(!(e instanceof We))throw new E("view-selection-add-range-not-range",this);this._pushRange(e),this._lastRangeBackward=!!i}_pushRange(e){for(const i of this._ranges)if(e.isIntersecting(i))throw new E("view-selection-range-intersects",this,{addedRange:e,intersectingRange:i});this._ranges.push(new We(e.start,e.end))}};Ir.prototype.is=function(s){return s==="selection"||s==="view:selection"};let WO=class extends pt(Dl){constructor(...e){super();p(this,"_selection");this._selection=new Ir,this._selection.delegate("change").to(this),e.length&&this._selection.setTo(...e)}get isFake(){return this._selection.isFake}get fakeSelectionLabel(){return this._selection.fakeSelectionLabel}get anchor(){return this._selection.anchor}get focus(){return this._selection.focus}get isCollapsed(){return this._selection.isCollapsed}get rangeCount(){return this._selection.rangeCount}get isBackward(){return this._selection.isBackward}get editableElement(){return this._selection.editableElement}get _ranges(){return this._selection._ranges}*getRanges(){yield*this._selection.getRanges()}getFirstRange(){return this._selection.getFirstRange()}getLastRange(){return this._selection.getLastRange()}getFirstPosition(){return this._selection.getFirstPosition()}getLastPosition(){return this._selection.getLastPosition()}getSelectedElement(){return this._selection.getSelectedElement()}isEqual(e){return this._selection.isEqual(e)}isSimilar(e){return this._selection.isSimilar(e)}_setTo(...e){this._selection.setTo(...e)}_setFocus(e,i){this._selection.setFocus(e,i)}};WO.prototype.is=function(s){return s==="selection"||s=="documentSelection"||s=="view:selection"||s=="view:documentSelection"};class Nl extends Lr{constructor(e,i,n){super(e,i);p(this,"startRange");p(this,"_eventPhase");p(this,"_currentTarget");this.startRange=n,this._eventPhase="none",this._currentTarget=null}get eventPhase(){return this._eventPhase}get currentTarget(){return this._currentTarget}}const Xw=Symbol("bubbling contexts");function Ib(s){class t extends s{fire(i,...n){try{const r=i instanceof Lr?i:new Lr(this,i),o=Gw(this);if(!o.size)return;if(Pu(r,"capturing",this),ka(o,"$capture",r,...n))return r.return;const l=r.startRange||this.selection.getFirstRange(),a=l?l.getContainedElement():null,c=a?!!sA(o,a):!1;let h=a||VD(l);if(Pu(r,"atTarget",h),!c){if(ka(o,"$text",r,...n))return r.return;Pu(r,"bubbling",h)}for(;h;){if(h.is("rootElement")){if(ka(o,"$root",r,...n))return r.return}else if(h.is("element")&&ka(o,h.name,r,...n))return r.return;if(ka(o,h,r,...n))return r.return;h=h.parent,Pu(r,"bubbling",h)}return Pu(r,"bubbling",this),ka(o,"$document",r,...n),r.return}catch(r){/* istanbul ignore next -- @preserve */E.rethrowUnexpectedError(r,this)}}_addEventListener(i,n,r){const o=dt(r.context||"$document"),l=Gw(this);for(const a of o){let c=l.get(a);c||(c=new(pt()),l.set(a,c)),this.listenTo(c,i,n,r)}}_removeEventListener(i,n){const r=Gw(this);for(const o of r.values())this.stopListening(o,i,n)}}return t}{const s=Ib(Object);["fire","_addEventListener","_removeEventListener"].forEach(t=>{Ib[t]=s.prototype[t]})}function Pu(s,t,e){s instanceof Nl&&(s._eventPhase=t,s._currentTarget=e)}function ka(s,t,e,...i){const n=typeof t=="string"?s.get(t):sA(s,t);return n?(n.fire(e,...i),e.stop.called):!1}function sA(s,t){for(const[e,i]of s)if(typeof e=="function"&&e(t))return i;return null}function Gw(s){return s[Xw]||(s[Xw]=new Map),s[Xw]}function VD(s){if(!s)return null;const t=s.start.parent,e=s.end.parent,i=t.getPath(),n=e.getPath();return i.length>n.length?t:e}let ad=class extends Ib(at()){constructor(e){super();p(this,"selection");p(this,"roots");p(this,"stylesProcessor");p(this,"_postFixers",new Set);this.selection=new WO,this.roots=new di({idProperty:"rootName"}),this.stylesProcessor=e,this.set("isReadOnly",!1),this.set("isFocused",!1),this.set("isSelecting",!1),this.set("isComposing",!1)}getRoot(e="main"){return this.roots.get(e)}registerPostFixer(e){this._postFixers.add(e)}destroy(){this.roots.forEach(e=>e.destroy()),this.stopListening()}_callPostFixers(e){let i=!1;do for(const n of this._postFixers)if(i=n(e),i)break;while(i)}};const qS=10;class vl extends Br{constructor(e,i,n,r){super(e,i,n,r);p(this,"_priority",qS);p(this,"_id",null);p(this,"_clonesGroup",null);this.getFillerOffset=MD}get priority(){return this._priority}get id(){return this._id}getElementsWithSameId(){if(this.id===null)throw new E("attribute-element-get-elements-with-same-id-no-id",this);return new Set(this._clonesGroup)}isSimilar(e){return this.id!==null||e.id!==null?this.id===e.id:super.isSimilar(e)&&this.priority==e.priority}_clone(e=!1){const i=super._clone(e);return i._priority=this._priority,i._id=this._id,i}_canMergeAttributesFrom(e){return this.id!==null||e.id!==null||this.priority!==e.priority?!1:super._canMergeAttributesFrom(e)}_canSubtractAttributesOf(e){return this.id!==null||e.id!==null||this.priority!==e.priority?!1:super._canSubtractAttributesOf(e)}}p(vl,"DEFAULT_PRIORITY",qS);vl.prototype.is=function(s,t){return t?t===this.name&&(s==="attributeElement"||s==="view:attributeElement"||s==="element"||s==="view:element"):s==="attributeElement"||s==="view:attributeElement"||s==="element"||s==="view:element"||s==="node"||s==="view:node"};function MD(){if(Yw(this))return null;let s=this.parent;for(;s&&s.is("attributeElement");){if(Yw(s)>1)return null;s=s.parent}return!s||Yw(s)>1?null:this.childCount}function Yw(s){return Array.from(s.getChildren()).filter(t=>!t.is("uiElement")).length}class UO extends Br{constructor(t,e,i,n){super(t,e,i,n),this.getFillerOffset=LD}_insertChild(t,e){if(e&&(e instanceof Ql||Array.from(e).length>0))throw new E("view-emptyelement-cannot-add",[this,e]);return 0}}UO.prototype.is=function(s,t){return t?t===this.name&&(s==="emptyElement"||s==="view:emptyElement"||s==="element"||s==="view:element"):s==="emptyElement"||s==="view:emptyElement"||s==="element"||s==="view:element"||s==="node"||s==="view:node"};function LD(){return null}class Sp extends Br{constructor(t,e,i,n){super(t,e,i,n),this.getFillerOffset=$D}_insertChild(t,e){if(e&&(e instanceof Ql||Array.from(e).length>0))throw new E("view-uielement-cannot-add",[this,e]);return 0}render(t,e){return this.toDomElement(t)}toDomElement(t){const e=t.createElement(this.name);for(const i of this.getAttributeKeys())e.setAttribute(i,this.getAttribute(i));return e}}Sp.prototype.is=function(s,t){return t?t===this.name&&(s==="uiElement"||s==="view:uiElement"||s==="element"||s==="view:element"):s==="uiElement"||s==="view:uiElement"||s==="element"||s==="view:element"||s==="node"||s==="view:node"};function BD(s){s.document.on("arrowKey",(t,e)=>DD(t,e,s.domConverter),{priority:"low"})}function $D(){return null}function DD(s,t,e){if(t.keyCode==ze.arrowright){const i=t.domTarget.ownerDocument.defaultView.getSelection(),n=i.rangeCount==1&&i.getRangeAt(0).collapsed;if(n||t.shiftKey){const r=i.focusNode,o=i.focusOffset,l=e.domPositionToView(r,o);if(l===null)return;let a=!1;const c=l.getLastMatchingPosition(h=>(h.item.is("uiElement")&&(a=!0),!!(h.item.is("uiElement")||h.item.is("attributeElement"))));if(a){const h=e.viewPositionToDom(c);n?i.collapse(h.parent,h.offset):i.extend(h.parent,h.offset)}}}}class ZO extends Br{constructor(t,e,i,n){super(t,e,i,n),this.getFillerOffset=QD}_insertChild(t,e){if(e&&(e instanceof Ql||Array.from(e).length>0))throw new E("view-rawelement-cannot-add",[this,e]);return 0}render(t,e){}}ZO.prototype.is=function(s,t){return t?t===this.name&&(s==="rawElement"||s==="view:rawElement"||s==="element"||s==="view:element"):s==="rawElement"||s==="view:rawElement"||s===this.name||s==="view:"+this.name||s==="element"||s==="view:element"||s==="node"||s==="view:node"};function QD(){return null}let _l=class extends pt(Dl){constructor(e,i){super();p(this,"document");p(this,"_children",[]);p(this,"_customProperties",new Map);this.document=e,i&&this._insertChild(0,i)}[Symbol.iterator](){return this._children[Symbol.iterator]()}get childCount(){return this._children.length}get isEmpty(){return this.childCount===0}get root(){return this}get parent(){return null}get name(){}get getFillerOffset(){}getCustomProperty(e){return this._customProperties.get(e)}*getCustomProperties(){yield*this._customProperties.entries()}_appendChild(e){return this._insertChild(this.childCount,e)}getChild(e){return this._children[e]}getChildIndex(e){return this._children.indexOf(e)}getChildren(){return this._children[Symbol.iterator]()}_insertChild(e,i){this._fireChange("children",this,{index:e});let n=0;const r=ND(this.document,i);for(const o of r)o.parent!==null&&o._remove(),o.parent=this,this._children.splice(e,0,o),e++,n++;return n}_removeChildren(e,i=1){this._fireChange("children",this,{index:e});for(let n=e;n<e+i;n++)this._children[n].parent=null;return this._children.splice(e,i)}_fireChange(e,i,n){this.fire(`change:${e}`,i,n)}_setCustomProperty(e,i){this._customProperties.set(e,i)}_removeCustomProperty(e){return this._customProperties.delete(e)}};_l.prototype.is=function(s){return s==="documentFragment"||s==="view:documentFragment"};function ND(s,t){return typeof t=="string"?[new Ri(s,t)]:(Wn(t)||(t=[t]),Array.from(t).map(e=>typeof e=="string"?new Ri(s,e):e instanceof Cr?new Ri(s,e.data):e))}class rA{constructor(t){p(this,"document");p(this,"_cloneGroups",new Map);p(this,"_slotFactory",null);this.document=t}setSelection(...t){this.document.selection._setTo(...t)}setSelectionFocus(t,e){this.document.selection._setFocus(t,e)}createDocumentFragment(t){return new _l(this.document,t)}createText(t){return new Ri(this.document,t)}createAttributeElement(t,e,i={}){const n=new vl(this.document,t,e);return typeof i.priority=="number"&&(n._priority=i.priority),i.id&&(n._id=i.id),i.renderUnsafeAttributes&&n._unsafeAttributesToRender.push(...i.renderUnsafeAttributes),n}createContainerElement(t,e,i={},n={}){let r=null;Vs(i)?n=i:r=i;const o=new Sh(this.document,t,e,r);return n.renderUnsafeAttributes&&o._unsafeAttributesToRender.push(...n.renderUnsafeAttributes),o}createEditableElement(t,e,i={}){const n=new kp(this.document,t,e);return i.renderUnsafeAttributes&&n._unsafeAttributesToRender.push(...i.renderUnsafeAttributes),n}createEmptyElement(t,e,i={}){const n=new UO(this.document,t,e);return i.renderUnsafeAttributes&&n._unsafeAttributesToRender.push(...i.renderUnsafeAttributes),n}createUIElement(t,e,i){const n=new Sp(this.document,t,e);return i&&(n.render=i),n}createRawElement(t,e,i,n={}){const r=new ZO(this.document,t,e);return i&&(r.render=i),n.renderUnsafeAttributes&&r._unsafeAttributesToRender.push(...n.renderUnsafeAttributes),r}setAttribute(t,e,i,n){n!==void 0?n._setAttribute(t,e,i):i._setAttribute(t,e)}removeAttribute(t,e,i){i!==void 0?i._removeAttribute(t,e):e._removeAttribute(t)}addClass(t,e){e._addClass(t)}removeClass(t,e){e._removeClass(t)}setStyle(t,e,i){Vs(t)&&i===void 0?e._setStyle(t):i._setStyle(t,e)}removeStyle(t,e){e._removeStyle(t)}setCustomProperty(t,e,i){i._setCustomProperty(t,e)}removeCustomProperty(t,e){return e._removeCustomProperty(t)}breakAttributes(t){return t instanceof be?this._breakAttributes(t):this._breakAttributesRange(t)}breakContainer(t){const e=t.parent;if(!e.is("containerElement"))throw new E("view-writer-break-non-container-element",this.document);if(!e.parent)throw new E("view-writer-break-root",this.document);if(t.isAtStart)return be._createBefore(e);if(!t.isAtEnd){const i=e._clone(!1);this.insert(be._createAfter(e),i);const n=new We(t,be._createAt(e,"end")),r=new be(i,0);this.move(n,r)}return be._createAfter(e)}mergeAttributes(t){const e=t.offset,i=t.parent;if(i.is("$text"))return t;if(i.is("attributeElement")&&i.childCount===0){const o=i.parent,l=i.index;return i._remove(),this._removeFromClonedElementsGroup(i),this.mergeAttributes(new be(o,l))}const n=i.getChild(e-1),r=i.getChild(e);if(!n||!r)return t;if(n.is("$text")&&r.is("$text"))return XS(n,r);if(n.is("attributeElement")&&r.is("attributeElement")&&n.isSimilar(r)){const o=n.childCount;return n._appendChild(r.getChildren()),r._remove(),this._removeFromClonedElementsGroup(r),this.mergeAttributes(new be(n,o))}return t}mergeContainers(t){const e=t.nodeBefore,i=t.nodeAfter;if(!e||!i||!e.is("containerElement")||!i.is("containerElement"))throw new E("view-writer-merge-containers-invalid-position",this.document);const n=e.getChild(e.childCount-1),r=n instanceof Ri?be._createAt(n,"end"):be._createAt(e,"end");return this.move(We._createIn(i),be._createAt(e,"end")),this.remove(We._createOn(i)),r}insert(t,e){e=Wn(e)?[...e]:[e],oA(e,this.document);const i=e.reduce((o,l)=>{const a=o[o.length-1],c=!l.is("uiElement");return!a||a.breakAttributes!=c?o.push({breakAttributes:c,nodes:[l]}):a.nodes.push(l),o},[]);let n=null,r=t;for(const{nodes:o,breakAttributes:l}of i){const a=this._insertNodes(r,o,l);n||(n=a.start),r=a.end}return n?new We(n,r):new We(t)}remove(t){const e=t instanceof We?t:We._createOn(t);if(Tu(e,this.document),e.isCollapsed)return new _l(this.document);const{start:i,end:n}=this._breakAttributesRange(e,!0),r=i.parent,o=n.offset-i.offset,l=r._removeChildren(i.offset,o);for(const c of l)this._removeFromClonedElementsGroup(c);const a=this.mergeAttributes(i);return e.start=a,e.end=a.clone(),new _l(this.document,l)}clear(t,e){Tu(t,this.document);const i=t.getWalker({direction:"backward",ignoreElementEnd:!0});for(const n of i){const r=n.item;let o;if(r.is("element")&&e.isSimilar(r))o=We._createOn(r);else if(!n.nextPosition.isAfter(t.start)&&r.is("$textProxy")){const l=r.getAncestors().find(a=>a.is("element")&&e.isSimilar(a));l&&(o=We._createIn(l))}o&&(o.end.isAfter(t.end)&&(o.end=t.end),o.start.isBefore(t.start)&&(o.start=t.start),this.remove(o))}}move(t,e){let i;if(e.isAfter(t.end)){e=this._breakAttributes(e,!0);const n=e.parent,r=n.childCount;t=this._breakAttributesRange(t,!0),i=this.remove(t),e.offset+=n.childCount-r}else i=this.remove(t);return this.insert(e,i)}wrap(t,e){if(!(e instanceof vl))throw new E("view-writer-wrap-invalid-attribute",this.document);if(Tu(t,this.document),t.isCollapsed){let i=t.start;i.parent.is("element")&&!FD(i.parent)&&(i=i.getLastMatchingPosition(r=>r.item.is("uiElement"))),i=this._wrapPosition(i,e);const n=this.document.selection;return n.isCollapsed&&n.getFirstPosition().isEqual(t.start)&&this.setSelection(i),new We(i)}else return this._wrapRange(t,e)}unwrap(t,e){if(!(e instanceof vl))throw new E("view-writer-unwrap-invalid-attribute",this.document);if(Tu(t,this.document),t.isCollapsed)return t;const{start:i,end:n}=this._breakAttributesRange(t,!0),r=i.parent,o=this._unwrapChildren(r,i.offset,n.offset,e),l=this.mergeAttributes(o.start);l.isEqual(o.start)||o.end.offset--;const a=this.mergeAttributes(o.end);return new We(l,a)}rename(t,e){const i=new Sh(this.document,t,e.getAttributes());return this.insert(be._createAfter(e),i),this.move(We._createIn(e),be._createAt(i,0)),this.remove(We._createOn(e)),i}clearClonedElementsGroup(t){this._cloneGroups.delete(t)}createPositionAt(t,e){return be._createAt(t,e)}createPositionAfter(t){return be._createAfter(t)}createPositionBefore(t){return be._createBefore(t)}createRange(t,e){return new We(t,e)}createRangeOn(t){return We._createOn(t)}createRangeIn(t){return We._createIn(t)}createSelection(...t){return new Ir(...t)}createSlot(t="children"){if(!this._slotFactory)throw new E("view-writer-invalid-create-slot-context",this.document);return this._slotFactory(this,t)}_registerSlotFactory(t){this._slotFactory=t}_clearSlotFactory(){this._slotFactory=null}_insertNodes(t,e,i){let n;if(i?n=Rb(t):n=t.parent.is("$text")?t.parent.parent:t.parent,!n)throw new E("view-writer-invalid-position-container",this.document);let r;i?r=this._breakAttributes(t,!0):r=t.parent.is("$text")?Kw(t):t;const o=n._insertChild(r.offset,e);for(const h of e)this._addToClonedElementsGroup(h);const l=r.getShiftedBy(o),a=this.mergeAttributes(r);a.isEqual(r)||l.offset--;const c=this.mergeAttributes(l);return new We(a,c)}_wrapChildren(t,e,i,n){let r=e;const o=[];for(;r<i;){const a=t.getChild(r),c=a.is("$text"),h=a.is("attributeElement");if(h&&a._canMergeAttributesFrom(n))a._mergeAttributesFrom(n),o.push(new be(t,r));else if(c||!h||zD(n,a)){const f=n._clone();a._remove(),f._appendChild(a),t._insertChild(r,f),this._addToClonedElementsGroup(f),o.push(new be(t,r))}else this._wrapChildren(a,0,a.childCount,n);r++}let l=0;for(const a of o){if(a.offset-=l,a.offset==e)continue;this.mergeAttributes(a).isEqual(a)||(l++,i--)}return We._createFromParentsAndOffsets(t,e,t,i)}_unwrapChildren(t,e,i,n){let r=e;const o=[];for(;r<i;){const a=t.getChild(r);if(!a.is("attributeElement")){r++;continue}if(a.isSimilar(n)){const c=a.getChildren(),h=a.childCount;a._remove(),t._insertChild(r,c),this._removeFromClonedElementsGroup(a),o.push(new be(t,r),new be(t,r+h)),r+=h,i+=h-1;continue}if(a._canSubtractAttributesOf(n)){a._subtractAttributesOf(n),o.push(new be(t,r),new be(t,r+1)),r++;continue}this._unwrapChildren(a,0,a.childCount,n),r++}let l=0;for(const a of o){if(a.offset-=l,a.offset==e||a.offset==i)continue;this.mergeAttributes(a).isEqual(a)||(l++,i--)}return We._createFromParentsAndOffsets(t,e,t,i)}_wrapRange(t,e){const{start:i,end:n}=this._breakAttributesRange(t,!0),r=i.parent,o=this._wrapChildren(r,i.offset,n.offset,e),l=this.mergeAttributes(o.start);l.isEqual(o.start)||o.end.offset--;const a=this.mergeAttributes(o.end);return new We(l,a)}_wrapPosition(t,e){if(e.isSimilar(t.parent))return jS(t.clone());t.parent.is("$text")&&(t=Kw(t));const i=this.createAttributeElement("_wrapPosition-fake-element");i._priority=Number.POSITIVE_INFINITY,i.isSimilar=()=>!1,t.parent._insertChild(t.offset,i);const n=new We(t,t.getShiftedBy(1));this.wrap(n,e);const r=new be(i.parent,i.index);i._remove();const o=r.nodeBefore,l=r.nodeAfter;return o&&o.is("view:$text")&&l&&l.is("view:$text")?XS(o,l):jS(r)}_breakAttributesRange(t,e=!1){const i=t.start,n=t.end;if(Tu(t,this.document),t.isCollapsed){const a=this._breakAttributes(t.start,e);return new We(a,a)}const r=this._breakAttributes(n,e),o=r.parent.childCount,l=this._breakAttributes(i,e);return r.offset+=r.parent.childCount-o,new We(l,r)}_breakAttributes(t,e=!1){const i=t.offset,n=t.parent;if(t.parent.is("emptyElement"))throw new E("view-writer-cannot-break-empty-element",this.document);if(t.parent.is("uiElement"))throw new E("view-writer-cannot-break-ui-element",this.document);if(t.parent.is("rawElement"))throw new E("view-writer-cannot-break-raw-element",this.document);if(!e&&n.is("$text")&&Vb(n.parent)||Vb(n))return t.clone();if(n.is("$text"))return this._breakAttributes(Kw(t),e);const r=n.childCount;if(i==r){const o=new be(n.parent,n.index+1);return this._breakAttributes(o,e)}else if(i===0){const o=new be(n.parent,n.index);return this._breakAttributes(o,e)}else{const o=n.index+1,l=n._clone();n.parent._insertChild(o,l),this._addToClonedElementsGroup(l);const a=n.childCount-i,c=n._removeChildren(i,a);l._appendChild(c);const h=new be(n.parent,o);return this._breakAttributes(h,e)}}_addToClonedElementsGroup(t){if(!t.root.is("rootElement"))return;if(t.is("element"))for(const n of t.getChildren())this._addToClonedElementsGroup(n);const e=t.id;if(!e)return;let i=this._cloneGroups.get(e);i||(i=new Set,this._cloneGroups.set(e,i)),i.add(t),t._clonesGroup=i}_removeFromClonedElementsGroup(t){if(t.is("element"))for(const n of t.getChildren())this._removeFromClonedElementsGroup(n);const e=t.id;if(!e)return;const i=this._cloneGroups.get(e);i&&i.delete(t)}}function FD(s){return Array.from(s.getChildren()).some(t=>!t.is("uiElement"))}function Rb(s){let t=s.parent;for(;!Vb(t);){if(!t)return;t=t.parent}return t}function zD(s,t){return s.priority<t.priority?!0:s.priority>t.priority?!1:s.getIdentity()<t.getIdentity()}function jS(s){const t=s.nodeBefore;if(t&&t.is("$text"))return new be(t,t.data.length);const e=s.nodeAfter;return e&&e.is("$text")?new be(e,0):s}function Kw(s){if(s.offset==s.parent.data.length)return new be(s.parent.parent,s.parent.index+1);if(s.offset===0)return new be(s.parent.parent,s.parent.index);const t=s.parent.data.slice(s.offset);return s.parent._data=s.parent.data.slice(0,s.offset),s.parent.parent._insertChild(s.parent.index+1,new Ri(s.root.document,t)),new be(s.parent.parent,s.parent.index+1)}function XS(s,t){const e=s.data.length;return s._data+=t.data,t._remove(),new be(s,e)}const WD=[Ri,vl,Sh,UO,ZO,Sp];function oA(s,t){for(const e of s){if(!WD.some(i=>e instanceof i))throw new E("view-writer-insert-invalid-node-type",t);e.is("$text")||oA(e.getChildren(),t)}}function Vb(s){return s&&(s.is("containerElement")||s.is("documentFragment"))}function Tu(s,t){const e=Rb(s.start),i=Rb(s.end);if(!e||!i||e!==i)throw new E("view-writer-invalid-range-container",t)}const lA=s=>s.createTextNode(" "),aA=s=>{const t=s.createElement("span");return t.dataset.ckeFiller="true",t.innerText=" ",t},cA=s=>{const t=s.createElement("br");return t.dataset.ckeFiller="true",t},Nn=7,Ch="⁠".repeat(Nn);function Ki(s){return typeof s=="string"?s.substr(0,Nn)===Ch:Lt(s)&&s.data.substr(0,Nn)===Ch}function ja(s){return s.data.length==Nn&&Ki(s)}function GS(s){const t=typeof s=="string"?s:s.data;return Ki(s)?t.slice(Nn):t}function UD(s){s.document.on("arrowKey",ZD,{priority:"low"})}function ZD(s,t){if(t.keyCode==ze.arrowleft){const e=t.domTarget.ownerDocument.defaultView.getSelection();if(e.rangeCount==1&&e.getRangeAt(0).collapsed){const i=e.getRangeAt(0).startContainer,n=e.getRangeAt(0).startOffset;Ki(i)&&n<=Nn&&e.collapse(i,0)}}}class HD extends at(){constructor(e,i){super();p(this,"domDocuments",new Set);p(this,"domConverter");p(this,"markedAttributes",new Set);p(this,"markedChildren",new Set);p(this,"markedTexts",new Set);p(this,"selection");p(this,"_inlineFiller",null);p(this,"_fakeSelectionContainer",null);this.domConverter=e,this.selection=i,this.set("isFocused",!1),this.set("isSelecting",!1),this.set("isComposing",!1),Ie.isBlink&&!Ie.isAndroid&&this.on("change:isSelecting",()=>{this.isSelecting||this.render()})}markToSync(e,i){if(e==="text")this.domConverter.mapViewToDom(i.parent)&&this.markedTexts.add(i);else{if(!this.domConverter.mapViewToDom(i))return;if(e==="attributes")this.markedAttributes.add(i);else if(e==="children")this.markedChildren.add(i);else throw new E("view-renderer-unknown-type",this)}}render(){if(this.isComposing&&!Ie.isAndroid)return;let e=null;const i=Ie.isBlink&&!Ie.isAndroid?!this.isSelecting:!0;for(const n of this.markedChildren)this._updateChildrenMappings(n);i?(this._inlineFiller&&!this._isSelectionInInlineFiller()&&this._removeInlineFiller(),this._inlineFiller?e=this._getInlineFillerPosition():this._needsInlineFillerAtSelection()&&(e=this.selection.getFirstPosition(),this.markedChildren.add(e.parent))):this._inlineFiller&&this._inlineFiller.parentNode&&(e=this.domConverter.domPositionToView(this._inlineFiller),e&&e.parent.is("$text")&&(e=be._createBefore(e.parent)));for(const n of this.markedAttributes)this._updateAttrs(n);for(const n of this.markedChildren)this._updateChildren(n,{inlineFillerPosition:e});for(const n of this.markedTexts)!this.markedChildren.has(n.parent)&&this.domConverter.mapViewToDom(n.parent)&&this._updateText(n,{inlineFillerPosition:e});if(i)if(e){const n=this.domConverter.viewPositionToDom(e),r=n.parent.ownerDocument;Ki(n.parent)?this._inlineFiller=n.parent:this._inlineFiller=YS(r,n.parent,n.offset)}else this._inlineFiller=null;this._updateFocus(),this._updateSelection(),this.domConverter._clearTemporaryCustomProperties(),this.markedTexts.clear(),this.markedAttributes.clear(),this.markedChildren.clear()}_updateChildrenMappings(e){const i=this.domConverter.mapViewToDom(e);if(!i)return;const n=Array.from(i.childNodes),r=Array.from(this.domConverter.viewChildrenToDom(e,{withChildren:!1})),o=this._diffNodeLists(n,r),l=this._findUpdateActions(o,n,r,jD);if(l.indexOf("update")!==-1){const a={equal:0,insert:0,delete:0};for(const c of l)if(c==="update"){const h=a.equal+a.insert,f=a.equal+a.delete,m=e.getChild(h);m&&!m.is("uiElement")&&!m.is("rawElement")&&this._updateElementMappings(m,n[f]),BS(r[h]),a.equal++}else a[c]++}}_updateElementMappings(e,i){this.domConverter.unbindDomElement(i),this.domConverter.bindElements(i,e),this.markedChildren.add(e),this.markedAttributes.add(e)}_getInlineFillerPosition(){const e=this.selection.getFirstPosition();return e.parent.is("$text")?be._createBefore(e.parent):e}_isSelectionInInlineFiller(){if(this.selection.rangeCount!=1||!this.selection.isCollapsed)return!1;const e=this.selection.getFirstPosition(),i=this.domConverter.viewPositionToDom(e);return!!(i&&Lt(i.parent)&&Ki(i.parent))}_removeInlineFiller(){const e=this._inlineFiller;if(!Ki(e))throw new E("view-renderer-filler-was-lost",this);ja(e)?e.remove():e.data=e.data.substr(Nn),this._inlineFiller=null}_needsInlineFillerAtSelection(){if(this.selection.rangeCount!=1||!this.selection.isCollapsed)return!1;const e=this.selection.getFirstPosition(),i=e.parent,n=e.offset;if(!this.domConverter.mapViewToDom(i.root)||!i.is("element")||!qD(i))return!1;const r=e.nodeBefore,o=e.nodeAfter;return!(r instanceof Ri||o instanceof Ri||n===i.getFillerOffset()&&(!r||!r.is("element","br"))||Ie.isAndroid&&(r||o))}_updateText(e,i){const n=this.domConverter.findCorrespondingDomText(e);let o=this.domConverter.viewToDom(e).data;const l=i.inlineFillerPosition;l&&l.parent==e.parent&&l.offset==e.index&&(o=Ch+o),this._updateTextNode(n,o)}_updateAttrs(e){const i=this.domConverter.mapViewToDom(e);if(i){for(const n of Array.from(i.attributes)){const r=n.name;e.hasAttribute(r)||this.domConverter.removeDomElementAttribute(i,r)}for(const n of e.getAttributeKeys())this.domConverter.setDomElementAttribute(i,n,e.getAttribute(n),e)}}_updateChildren(e,i){const n=this.domConverter.mapViewToDom(e);if(!n)return;if(Ie.isAndroid){let m=null;for(const w of Array.from(n.childNodes)){if(m&&Lt(m)&&Lt(w)){n.normalize();break}m=w}}const r=i.inlineFillerPosition,o=n.childNodes,l=Array.from(this.domConverter.viewChildrenToDom(e,{bind:!0}));r&&r.parent===e&&YS(n.ownerDocument,l,r.offset);const a=this._diffNodeLists(o,l),c=this._findUpdateActions(a,o,l,XD);let h=0;const f=new Set;for(const m of c)m==="delete"?(f.add(o[h]),BS(o[h])):(m==="equal"||m==="update")&&h++;h=0;for(const m of c)m==="insert"?(q6(n,h,l[h]),h++):m==="update"?(this._updateTextNode(o[h],l[h].data),h++):m==="equal"&&(this._markDescendantTextToSync(this.domConverter.domToView(l[h])),h++);for(const m of f)m.parentNode||this.domConverter.unbindDomElement(m)}_diffNodeLists(e,i){return e=KD(e,this._fakeSelectionContainer),ic(e,i,GD.bind(null,this.domConverter))}_findUpdateActions(e,i,n,r){if(e.indexOf("insert")===-1||e.indexOf("delete")===-1)return e;let o=[],l=[],a=[];const c={equal:0,insert:0,delete:0};for(const h of e)h==="insert"?a.push(n[c.equal+c.insert]):h==="delete"?l.push(i[c.equal+c.delete]):(o=o.concat(ic(l,a,r).map(f=>f==="equal"?"update":f)),o.push("equal"),l=[],a=[]),c[h]++;return o.concat(ic(l,a,r).map(h=>h==="equal"?"update":h))}_updateTextNode(e,i){const n=e.data;n!=i&&(Ie.isAndroid&&this.isComposing&&n.replace(/\u00A0/g," ")==i.replace(/\u00A0/g," ")||this._updateTextNodeInternal(e,i))}_updateTextNodeInternal(e,i){const n=R6(e.data,i);for(const r of n)r.type==="insert"?e.insertData(r.index,r.values.join("")):e.deleteData(r.index,r.howMany)}_markDescendantTextToSync(e){if(e){if(e.is("$text"))this.markedTexts.add(e);else if(e.is("element"))for(const i of e.getChildren())this._markDescendantTextToSync(i)}}_updateSelection(){if(Ie.isBlink&&!Ie.isAndroid&&this.isSelecting&&!this.markedChildren.size)return;if(this.selection.rangeCount===0){this._removeDomSelection(),this._removeFakeSelection();return}const e=this.domConverter.mapViewToDom(this.selection.editableElement);if(!this.isFocused||!e){!this.selection.isFake&&this._fakeSelectionContainer&&this._fakeSelectionContainer.isConnected&&this._removeFakeSelection();return}this.selection.isFake?this._updateFakeSelection(e):this._fakeSelectionContainer&&this._fakeSelectionContainer.isConnected?(this._removeFakeSelection(),this._updateDomSelection(e)):this.isComposing&&Ie.isAndroid||this._updateDomSelection(e)}_updateFakeSelection(e){const i=e.ownerDocument;this._fakeSelectionContainer||(this._fakeSelectionContainer=JD(i));const n=this._fakeSelectionContainer;if(this.domConverter.bindFakeSelection(n,this.selection),!this._fakeSelectionNeedsUpdate(e))return;(!n.parentElement||n.parentElement!=e)&&e.appendChild(n),n.textContent=this.selection.fakeSelectionLabel||" ";const r=i.getSelection(),o=i.createRange();r.removeAllRanges(),o.selectNodeContents(n),r.addRange(o)}_updateDomSelection(e){const i=e.ownerDocument.defaultView.getSelection();if(!this._domSelectionNeedsUpdate(i))return;const n=this.domConverter.viewPositionToDom(this.selection.anchor),r=this.domConverter.viewPositionToDom(this.selection.focus);i.setBaseAndExtent(n.parent,n.offset,r.parent,r.offset),Ie.isGecko&&YD(r,i)}_domSelectionNeedsUpdate(e){if(!this.domConverter.isDomSelectionCorrect(e))return!0;const i=e&&this.domConverter.domSelectionToView(e);return!(i&&this.selection.isEqual(i)||!this.selection.isCollapsed&&this.selection.isSimilar(i))}_fakeSelectionNeedsUpdate(e){const i=this._fakeSelectionContainer,n=e.ownerDocument.getSelection();return!i||i.parentElement!==e||n.anchorNode!==i&&!i.contains(n.anchorNode)?!0:i.textContent!==this.selection.fakeSelectionLabel}_removeDomSelection(){for(const e of this.domDocuments){const i=e.getSelection();if(i.rangeCount){const n=e.activeElement,r=this.domConverter.mapDomToView(n);n&&r&&i.removeAllRanges()}}}_removeFakeSelection(){const e=this._fakeSelectionContainer;e&&e.remove()}_updateFocus(){if(this.isFocused){const e=this.selection.editableElement;e&&this.domConverter.focus(e)}}}function qD(s){if(s.getAttribute("contenteditable")=="false")return!1;const t=s.findAncestor(e=>e.hasAttribute("contenteditable"));return!t||t.getAttribute("contenteditable")=="true"}function YS(s,t,e){const i=t instanceof Array?t:t.childNodes,n=i[e];if(Lt(n))return n.data=Ch+n.data,n;{const r=s.createTextNode(Ch);return Array.isArray(t)?i.splice(e,0,r):q6(t,e,r),r}}function jD(s,t){return Io(s)&&Io(t)&&!Lt(s)&&!Lt(t)&&!ah(s)&&!ah(t)&&s.tagName.toLowerCase()===t.tagName.toLowerCase()}function XD(s,t){return Io(s)&&Io(t)&&Lt(s)&&Lt(t)}function GD(s,t,e){return t===e?!0:Lt(t)&&Lt(e)?t.data===e.data:!!(s.isBlockFiller(t)&&s.isBlockFiller(e))}function YD(s,t){let e=s.parent,i=s.offset;if(Lt(e)&&ja(e)&&(i=qa(e)+1,e=e.parentNode),e.nodeType!=Node.ELEMENT_NODE||i!=e.childNodes.length-1)return;const n=e.childNodes[i];n&&n.tagName=="BR"&&t.addRange(t.getRangeAt(0))}function KD(s,t){const e=Array.from(s);return e.length==0||!t||e[e.length-1]==t&&e.pop(),e}function JD(s){const t=s.createElement("div");return t.className="ck-fake-selection-container",Object.assign(t.style,{position:"fixed",top:0,left:"-9999px",width:"42px"}),t.textContent=" ",t}const e8=cA(he.document),t8=lA(he.document),i8=aA(he.document),Uf="data-ck-unsafe-attribute-",KS="data-ck-unsafe-element";class cd{constructor(t,{blockFillerMode:e,renderingMode:i="editing"}={}){p(this,"document");p(this,"renderingMode");p(this,"blockFillerMode");p(this,"preElements");p(this,"blockElements");p(this,"inlineObjectElements");p(this,"unsafeElements");p(this,"_domDocument");p(this,"_domToViewMapping",new WeakMap);p(this,"_viewToDomMapping",new WeakMap);p(this,"_fakeSelectionMapping",new WeakMap);p(this,"_rawContentElementMatcher",new kn);p(this,"_inlineObjectElementMatcher",new kn);p(this,"_elementsWithTemporaryCustomProperties",new Set);this.document=t,this.renderingMode=i,this.blockFillerMode=e||(i==="editing"?"br":"nbsp"),this.preElements=["pre","textarea"],this.blockElements=["address","article","aside","blockquote","caption","center","dd","details","dir","div","dl","dt","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","header","hgroup","legend","li","main","menu","nav","ol","p","pre","section","summary","table","tbody","td","tfoot","th","thead","tr","ul"],this.inlineObjectElements=["object","iframe","input","button","textarea","select","option","video","embed","audio","img","canvas"],this.unsafeElements=["script","style"],this._domDocument=this.renderingMode==="editing"?he.document:he.document.implementation.createHTMLDocument("")}get domDocument(){return this._domDocument}bindFakeSelection(t,e){this._fakeSelectionMapping.set(t,new Ir(e))}fakeSelectionToView(t){return this._fakeSelectionMapping.get(t)}bindElements(t,e){this._domToViewMapping.set(t,e),this._viewToDomMapping.set(e,t)}unbindDomElement(t){const e=this._domToViewMapping.get(t);if(e){this._domToViewMapping.delete(t),this._viewToDomMapping.delete(e);for(const i of t.children)this.unbindDomElement(i)}}bindDocumentFragments(t,e){this._domToViewMapping.set(t,e),this._viewToDomMapping.set(e,t)}shouldRenderAttribute(t,e,i){return this.renderingMode==="data"?!0:(t=t.toLowerCase(),t.startsWith("on")||t==="srcdoc"&&e.match(/\bon\S+\s*=|javascript:|<\s*\/*script/i)?!1:i==="img"&&(t==="src"||t==="srcset")||i==="source"&&t==="srcset"?!0:!e.match(/^\s*(javascript:|data:(image\/svg|text\/x?html))/i))}setContentOf(t,e){if(this.renderingMode==="data"){t.innerHTML=e;return}const i=new DOMParser().parseFromString(e,"text/html"),n=i.createDocumentFragment(),r=i.body.childNodes;for(;r.length>0;)n.appendChild(r[0]);const o=i.createTreeWalker(n,NodeFilter.SHOW_ELEMENT),l=[];let a;for(;a=o.nextNode();)l.push(a);for(const c of l){for(const f of c.getAttributeNames())this.setDomElementAttribute(c,f,c.getAttribute(f));const h=c.tagName.toLowerCase();this._shouldRenameElement(h)&&(iC(h),c.replaceWith(this._createReplacementDomElement(h,c)))}for(;t.firstChild;)t.firstChild.remove();t.append(n)}viewToDom(t,e={}){if(t.is("$text")){const i=this._processDataFromViewText(t);return this._domDocument.createTextNode(i)}else{const i=t;if(this.mapViewToDom(i))if(i.getCustomProperty("editingPipeline:doNotReuseOnce"))this._elementsWithTemporaryCustomProperties.add(i);else return this.mapViewToDom(i);let n;if(i.is("documentFragment"))n=this._domDocument.createDocumentFragment(),e.bind&&this.bindDocumentFragments(n,i);else{if(i.is("uiElement"))return i.name==="$comment"?n=this._domDocument.createComment(i.getCustomProperty("$rawContent")):n=i.render(this._domDocument,this),e.bind&&this.bindElements(n,i),n;this._shouldRenameElement(i.name)?(iC(i.name),n=this._createReplacementDomElement(i.name)):i.hasAttribute("xmlns")?n=this._domDocument.createElementNS(i.getAttribute("xmlns"),i.name):n=this._domDocument.createElement(i.name),i.is("rawElement")&&i.render(n,this),e.bind&&this.bindElements(n,i);for(const r of i.getAttributeKeys())this.setDomElementAttribute(n,r,i.getAttribute(r),i)}if(e.withChildren!==!1)for(const r of this.viewChildrenToDom(i,e))n instanceof HTMLTemplateElement?n.content.appendChild(r):n.appendChild(r);return n}}setDomElementAttribute(t,e,i,n){const r=this.shouldRenderAttribute(e,i,t.tagName.toLowerCase())||n&&n.shouldRenderUnsafeAttribute(e);if(r||Ue("domconverter-unsafe-attribute-detected",{domElement:t,key:e,value:i}),!j6(e)){Ue("domconverter-invalid-attribute-detected",{domElement:t,key:e,value:i});return}t.hasAttribute(e)&&!r?t.removeAttribute(e):t.hasAttribute(Uf+e)&&r&&t.removeAttribute(Uf+e),t.setAttribute(r?e:Uf+e,i)}removeDomElementAttribute(t,e){e!=KS&&(t.removeAttribute(e),t.removeAttribute(Uf+e))}*viewChildrenToDom(t,e={}){const i=t.getFillerOffset&&t.getFillerOffset();let n=0;for(const r of t.getChildren()){i===n&&(yield this._getBlockFiller());const o=r.is("element")&&!!r.getCustomProperty("dataPipeline:transparentRendering")&&!$t(r.getAttributes());if(o&&this.renderingMode=="data")if(r.is("rawElement")){const l=this._domDocument.createElement(r.name);r.render(l,this),yield*[...l.childNodes]}else yield*this.viewChildrenToDom(r,e);else o&&Ue("domconverter-transparent-rendering-unsupported-in-editing-pipeline",{viewElement:r}),yield this.viewToDom(r,e);n++}i===n&&(yield this._getBlockFiller())}viewRangeToDom(t){const e=this.viewPositionToDom(t.start),i=this.viewPositionToDom(t.end),n=this._domDocument.createRange();return n.setStart(e.parent,e.offset),n.setEnd(i.parent,i.offset),n}viewPositionToDom(t){const e=t.parent;if(e.is("$text")){const i=this.findCorrespondingDomText(e);if(!i)return null;let n=t.offset;return Ki(i)&&(n+=Nn),i.data&&n>i.data.length&&(n=i.data.length),{parent:i,offset:n}}else{let i,n,r;if(t.offset===0){if(i=this.mapViewToDom(e),!i)return null;r=i.childNodes[0]}else{const l=t.nodeBefore;if(n=l.is("$text")?this.findCorrespondingDomText(l):this.mapViewToDom(l),!n)return null;i=n.parentNode,r=n.nextSibling}if(Lt(r)&&Ki(r))return{parent:r,offset:Nn};const o=n?qa(n)+1:0;return{parent:i,offset:o}}}domToView(t,e={}){const i=[],n=this._domToView(t,e,i),r=n.next().value;return!r||(n.next(),this._processDomInlineNodes(null,i,e),this.blockFillerMode=="br"&&eC(r))||r.is("$text")&&r.data.length==0?null:r}*domChildrenToView(t,e={},i=[]){let n=[];t instanceof HTMLTemplateElement?n=[...t.content.childNodes]:n=[...t.childNodes];for(let r=0;r<n.length;r++){const o=n[r],l=this._domToView(o,e,i),a=l.next().value;a!==null&&(this._isBlockViewElement(a)&&this._processDomInlineNodes(t,i,e),this.blockFillerMode=="br"&&eC(a)||(yield a),l.next())}this._processDomInlineNodes(t,i,e)}domSelectionToView(t){if(l8(t))return new Ir([]);if(t.rangeCount===1){let n=t.getRangeAt(0).startContainer;Lt(n)&&(n=n.parentNode);const r=this.fakeSelectionToView(n);if(r)return r}const e=this.isDomSelectionBackward(t),i=[];for(let n=0;n<t.rangeCount;n++){const r=t.getRangeAt(n),o=this.domRangeToView(r);o&&i.push(o)}return new Ir(i,{backward:e})}domRangeToView(t){const e=this.domPositionToView(t.startContainer,t.startOffset),i=this.domPositionToView(t.endContainer,t.endOffset);return e&&i?new We(e,i):null}domPositionToView(t,e=0){if(this.isBlockFiller(t))return this.domPositionToView(t.parentNode,qa(t));const i=this.mapDomToView(t);if(i&&(i.is("uiElement")||i.is("rawElement")))return be._createBefore(i);if(Lt(t)){if(ja(t))return this.domPositionToView(t.parentNode,qa(t));const n=this.findCorrespondingViewText(t);let r=e;return n?(Ki(t)&&(r-=Nn,r=r<0?0:r),new be(n,r)):null}else{if(e===0){const n=this.mapDomToView(t);if(n)return new be(n,0)}else{const n=t.childNodes[e-1];if(Lt(n)&&ja(n)||n&&this.isBlockFiller(n))return this.domPositionToView(n.parentNode,qa(n));const r=Lt(n)?this.findCorrespondingViewText(n):this.mapDomToView(n);if(r&&r.parent)return new be(r.parent,r.index+1)}return null}}mapDomToView(t){return this.getHostViewElement(t)||this._domToViewMapping.get(t)}findCorrespondingViewText(t){if(ja(t))return null;const e=this.getHostViewElement(t);if(e)return e;const i=t.previousSibling;if(i){if(!this.isElement(i))return null;const n=this.mapDomToView(i);if(n){const r=n.nextSibling;return r instanceof Ri?r:null}}else{const n=this.mapDomToView(t.parentNode);if(n){const r=n.getChild(0);return r instanceof Ri?r:null}}return null}mapViewToDom(t){return this._viewToDomMapping.get(t)}findCorrespondingDomText(t){const e=t.previousSibling;return e&&this.mapViewToDom(e)?this.mapViewToDom(e).nextSibling:!e&&t.parent&&this.mapViewToDom(t.parent)?this.mapViewToDom(t.parent).childNodes[0]:null}focus(t){const e=this.mapViewToDom(t);if(!e||e.ownerDocument.activeElement===e)return;const{scrollX:i,scrollY:n}=he.window,r=[];JS(e,o=>{const{scrollLeft:l,scrollTop:a}=o;r.push([l,a])}),e.focus(),JS(e,o=>{const[l,a]=r.shift();o.scrollLeft=l,o.scrollTop=a}),he.window.scrollTo(i,n)}_clearDomSelection(){const t=this.mapViewToDom(this.document.selection.editableElement);if(!t)return;const e=t.ownerDocument.defaultView.getSelection(),i=this.domSelectionToView(e);i&&i.rangeCount>0&&e.removeAllRanges()}isElement(t){return t&&t.nodeType==Node.ELEMENT_NODE}isDocumentFragment(t){return t&&t.nodeType==Node.DOCUMENT_FRAGMENT_NODE}isBlockFiller(t){return this.blockFillerMode=="br"?t.isEqualNode(e8):tC(t,this.blockElements)?!0:t.isEqualNode(i8)||s8(t,this.blockElements)}isDomSelectionBackward(t){if(t.isCollapsed)return!1;const e=this._domDocument.createRange();try{e.setStart(t.anchorNode,t.anchorOffset),e.setEnd(t.focusNode,t.focusOffset)}catch{return!1}const i=e.collapsed;return e.detach(),i}getHostViewElement(t){const e=I9(t);for(e.pop();e.length;){const i=e.pop(),n=this._domToViewMapping.get(i);if(n&&(n.is("uiElement")||n.is("rawElement")))return n}return null}isDomSelectionCorrect(t){return this._isDomSelectionPositionCorrect(t.anchorNode,t.anchorOffset)&&this._isDomSelectionPositionCorrect(t.focusNode,t.focusOffset)}registerRawContentMatcher(t){this._rawContentElementMatcher.add(t)}registerInlineObjectMatcher(t){this._inlineObjectElementMatcher.add(t)}_clearTemporaryCustomProperties(){for(const t of this._elementsWithTemporaryCustomProperties)t._removeCustomProperty("editingPipeline:doNotReuseOnce");this._elementsWithTemporaryCustomProperties.clear()}_getBlockFiller(){switch(this.blockFillerMode){case"nbsp":return lA(this._domDocument);case"markedNbsp":return aA(this._domDocument);case"br":return cA(this._domDocument)}}_isDomSelectionPositionCorrect(t,e){if(Lt(t)&&Ki(t)&&e<Nn||this.isElement(t)&&Ki(t.childNodes[e]))return!1;const i=this.mapDomToView(t);return!(i&&(i.is("uiElement")||i.is("rawElement")))}*_domToView(t,e,i){if(this.blockFillerMode!="br"&&tC(t,this.blockElements))return null;const n=this.getHostViewElement(t);if(n)return n;if(ah(t)&&e.skipComments)return null;if(Lt(t)){if(ja(t))return null;{const r=t.data;if(r==="")return null;const o=new Ri(this.document,r);return i.push(o),o}}else{let r=this.mapDomToView(t);if(r)return this._isInlineObjectElement(r)&&i.push(r),r;if(this.isDocumentFragment(t))r=new _l(this.document),e.bind&&this.bindDocumentFragments(t,r);else{r=this._createViewElement(t,e),e.bind&&this.bindElements(t,r);const l=t.attributes;if(l)for(let a=l.length,c=0;c<a;c++)r._setAttribute(l[c].name,l[c].value);if(this._isViewElementWithRawContent(r,e))return r._setCustomProperty("$rawContent",t.innerHTML),this._isBlockViewElement(r)||i.push(r),r;if(ah(t))return r._setCustomProperty("$rawContent",t.data),r}yield r;const o=[];if(e.withChildren!==!1)for(const l of this.domChildrenToView(t,e,o))r._appendChild(l);if(this._isInlineObjectElement(r))i.push(r),this._processDomInlineNodes(null,o,e);else for(const l of o)i.push(l)}}_processDomInlineNodes(t,e,i){if(!e.length||t&&!this.isDocumentFragment(t)&&!this._isBlockDomElement(t))return;let n=!1;for(let r=0;r<e.length;r++){const o=e[r];if(!o.is("$text")){n=!1;continue}let l,a=!1;if(this._isPreFormatted(o))l=GS(o.data);else{l=o.data.replace(/[ \n\t\r]{1,}/g," "),a=/[^\S\u00A0]/.test(l.charAt(l.length-1));const c=r>0?e[r-1]:null,h=r+1<e.length?e[r+1]:null,f=!c||c.is("element")&&c.name=="br"||n,m=h?!1:!Ki(o.data);i.withChildren!==!1&&(f&&(l=l.replace(/^ /,"")),m&&(l=l.replace(/ $/,""))),l=GS(l),this.blockFillerMode!="br"&&o.parent&&(o8(o.parent,l)?(l="",o.parent.parent&&(o.parent.parent._setCustomProperty("$hasBlockFiller",!0),o.parent._remove())):r8(o.parent,l,this.blockElements)&&(l="",o.parent._setCustomProperty("$hasBlockFiller",!0))),l=l.replace(/ \u00A0/g,"  ");const w=h&&h.is("element")&&h.name!="br",O=h&&h.is("$text")&&h.data.charAt(0)==" ";(/[ \u00A0]\u00A0$/.test(l)||!h||w||O)&&(l=l.replace(/\u00A0$/," ")),(f||c&&c.is("element")&&c.name!="br")&&(l=l.replace(/^\u00A0/," "))}l.length==0&&o.parent?(o._remove(),e.splice(r,1),r--):(o._data=l,n=a)}e.length=0}_processDataFromViewText(t){let e=t.data;if(this._isPreFormatted(t))return e;if(e.charAt(0)==" "){const i=this._getTouchingInlineViewNode(t,!1);(i&&i.is("$textProxy")&&this._nodeEndsWithSpace(i)||!i)&&(e=" "+e.substr(1))}if(e.charAt(e.length-1)==" "){const i=this._getTouchingInlineViewNode(t,!0),n=i&&i.is("$textProxy")&&i.data.charAt(0)==" ";(e.charAt(e.length-2)==" "||!i||n)&&(e=e.substr(0,e.length-1)+" ")}return e.replace(/ {2}/g,"  ")}_nodeEndsWithSpace(t){if(this._isPreFormatted(t))return!1;const e=this._processDataFromViewText(t);return e.charAt(e.length-1)==" "}_isPreFormatted(t){if(n8(t,this.preElements))return!0;for(const e of t.getAncestors({parentFirst:!0}))if(!(!e.is("element")||!e.hasStyle("white-space")||e.getStyle("white-space")==="inherit"))return["pre","pre-wrap","break-spaces"].includes(e.getStyle("white-space"));return!1}_getTouchingInlineViewNode(t,e){const i=new wl({startPosition:e?be._createAfter(t):be._createBefore(t),direction:e?"forward":"backward"});for(const{item:n}of i){if(n.is("$textProxy"))return n;if(n.is("element")&&n.getCustomProperty("dataPipeline:transparentRendering"))continue;if(n.is("element","br"))return null;if(this._isInlineObjectElement(n))return n;if(n.is("containerElement"))return null}return null}_isBlockDomElement(t){return this.isElement(t)&&this.blockElements.includes(t.tagName.toLowerCase())}_isBlockViewElement(t){return t.is("element")&&this.blockElements.includes(t.name)}_isInlineObjectElement(t){return t.is("element")?t.name=="br"||this.inlineObjectElements.includes(t.name)||!!this._inlineObjectElementMatcher.match(t):!1}_createViewElement(t,e){if(ah(t))return new Sp(this.document,"$comment");const i=e.keepOriginalCase?t.tagName:t.tagName.toLowerCase();return new Br(this.document,i)}_isViewElementWithRawContent(t,e){return e.withChildren!==!1&&t.is("element")&&!!this._rawContentElementMatcher.match(t)}_shouldRenameElement(t){const e=t.toLowerCase();return this.renderingMode==="editing"&&this.unsafeElements.includes(e)}_createReplacementDomElement(t,e){const i=this._domDocument.createElement("span");if(i.setAttribute(KS,t),e){for(;e.firstChild;)i.appendChild(e.firstChild);for(const n of e.getAttributeNames())i.setAttribute(n,e.getAttribute(n))}return i}}function n8(s,t){return s.getAncestors().some(e=>e.is("element")&&t.includes(e.name))}function JS(s,t){let e=s;for(;e;)t(e),e=e.parentElement}function s8(s,t){return s.isEqualNode(t8)&&uA(s,t)&&s.parentNode.childNodes.length===1}function uA(s,t){const e=s.parentNode;return!!e&&!!e.tagName&&t.includes(e.tagName.toLowerCase())}function r8(s,t,e){return t==" "&&s&&s.is("element")&&s.childCount==1&&e.includes(s.name)}function o8(s,t){return t==" "&&s&&s.is("element","span")&&s.childCount==1&&s.hasAttribute("data-cke-filler")}function eC(s){return s.is("element","br")&&s.hasAttribute("data-cke-filler")}function tC(s,t){return s.tagName==="BR"&&uA(s,t)&&s.parentNode.childNodes.length===1}function iC(s){s==="script"&&Ue("domconverter-unsafe-script-element-detected"),s==="style"&&Ue("domconverter-unsafe-style-element-detected")}function l8(s){if(!Ie.isGecko||!s.rangeCount)return!1;const t=s.getRangeAt(0).startContainer;try{Object.prototype.toString.call(t)}catch{return!0}return!1}class hr extends qi(){constructor(e){super();p(this,"view");p(this,"document");p(this,"_isEnabled",!1);this.view=e,this.document=e.document}get isEnabled(){return this._isEnabled}enable(){this._isEnabled=!0}disable(){this._isEnabled=!1}destroy(){this.disable(),this.stopListening()}checkShouldIgnoreEventFromTarget(e){return e&&e.nodeType===3&&(e=e.parentNode),!e||e.nodeType!==1?!1:e.matches("[data-cke-ignore-events], [data-cke-ignore-events] *")}}class $r{constructor(t,e,i){p(this,"view");p(this,"document");p(this,"domEvent");p(this,"domTarget");this.view=t,this.document=t.document,this.domEvent=e,this.domTarget=e.target,E6(this,i)}get target(){return this.view.domConverter.mapDomToView(this.domTarget)}preventDefault(){this.domEvent.preventDefault()}stopPropagation(){this.domEvent.stopPropagation()}}class Nr extends hr{constructor(){super(...arguments);p(this,"useCapture",!1);p(this,"usePassive",!1)}observe(e){(typeof this.domEventType=="string"?[this.domEventType]:this.domEventType).forEach(n=>{this.listenTo(e,n,(r,o)=>{this.isEnabled&&!this.checkShouldIgnoreEventFromTarget(o.target)&&this.onDomEvent(o)},{useCapture:this.useCapture,usePassive:this.usePassive})})}stopObserving(e){this.stopListening(e)}fire(e,i,n){this.isEnabled&&this.document.fire(e,new $r(this.view,i,n))}}class a8 extends Nr{constructor(){super(...arguments);p(this,"domEventType",["keydown","keyup"])}onDomEvent(e){const i={keyCode:e.keyCode,altKey:e.altKey,ctrlKey:e.ctrlKey,shiftKey:e.shiftKey,metaKey:e.metaKey,get keystroke(){return dc(this)}};this.fire(e.type,e,i)}}class c8 extends hr{constructor(e){super(e);p(this,"_fireSelectionChangeDoneDebounced");this._fireSelectionChangeDoneDebounced=fs(i=>{this.document.fire("selectionChangeDone",i)},200)}observe(){const e=this.document;e.on("arrowKey",(i,n)=>{e.selection.isFake&&this.isEnabled&&n.preventDefault()},{context:"$capture"}),e.on("arrowKey",(i,n)=>{e.selection.isFake&&this.isEnabled&&this._handleSelectionMove(n.keyCode)},{priority:"lowest"})}stopObserving(){}destroy(){super.destroy(),this._fireSelectionChangeDoneDebounced.cancel()}_handleSelectionMove(e){const i=this.document.selection,n=new Ir(i.getRanges(),{backward:i.isBackward,fake:!1});(e==ze.arrowleft||e==ze.arrowup)&&n.setTo(n.getFirstPosition()),(e==ze.arrowright||e==ze.arrowdown)&&n.setTo(n.getLastPosition());const r={oldSelection:i,newSelection:n,domSelection:null};this.document.fire("selectionChange",r),this._fireSelectionChangeDoneDebounced(r)}}let hA=class extends hr{constructor(e){super(e);p(this,"domConverter");p(this,"_config");p(this,"_domElements");p(this,"_mutationObserver");this._config={childList:!0,characterData:!0,subtree:!0},this.domConverter=e.domConverter,this._domElements=new Set,this._mutationObserver=new window.MutationObserver(this._onMutations.bind(this))}flush(){this._onMutations(this._mutationObserver.takeRecords())}observe(e){this._domElements.add(e),this.isEnabled&&this._mutationObserver.observe(e,this._config)}stopObserving(e){if(this._domElements.delete(e),this.isEnabled){this._mutationObserver.disconnect();for(const i of this._domElements)this._mutationObserver.observe(i,this._config)}}enable(){super.enable();for(const e of this._domElements)this._mutationObserver.observe(e,this._config)}disable(){super.disable(),this._mutationObserver.disconnect()}destroy(){super.destroy(),this._mutationObserver.disconnect()}_onMutations(e){if(e.length===0)return;const i=this.domConverter,n=new Set,r=new Set;for(const l of e){const a=i.mapDomToView(l.target);a&&(a.is("uiElement")||a.is("rawElement")||l.type==="childList"&&!this._isBogusBrMutation(l)&&r.add(a))}for(const l of e){const a=i.mapDomToView(l.target);if(!(a&&(a.is("uiElement")||a.is("rawElement")))&&l.type==="characterData"){const c=i.findCorrespondingViewText(l.target);c&&!r.has(c.parent)?n.add(c):!c&&Ki(l.target)&&r.add(i.mapDomToView(l.target.parentNode))}}const o=[];for(const l of n)o.push({type:"text",node:l});for(const l of r){const a=i.mapViewToDom(l),c=Array.from(l.getChildren()),h=Array.from(i.domChildrenToView(a,{withChildren:!1}));_b(c,h,u8)||o.push({type:"children",node:l})}o.length&&this.document.fire("mutations",{mutations:o})}_isBogusBrMutation(e){let i=null;return e.nextSibling===null&&e.removedNodes.length===0&&e.addedNodes.length==1&&(i=this.domConverter.domToView(e.addedNodes[0],{withChildren:!1})),i&&i.is("element","br")}};function u8(s,t){if(!Array.isArray(s))return s===t?!0:s.is("$text")&&t.is("$text")?s.data===t.data:!1}class xg extends Nr{constructor(e){super(e);p(this,"_renderTimeoutId",null);p(this,"_isFocusChanging",!1);p(this,"domEventType",["focus","blur"]);this.useCapture=!0;const i=this.document;i.on("focus",()=>this._handleFocus()),i.on("blur",(n,r)=>this._handleBlur(r)),i.on("beforeinput",()=>{i.isFocused||this._handleFocus()},{priority:"highest"})}flush(){this._isFocusChanging&&(this._isFocusChanging=!1,this.document.isFocused=!0)}onDomEvent(e){this.fire(e.type,e)}destroy(){this._clearTimeout(),super.destroy()}_handleFocus(){this._clearTimeout(),this._isFocusChanging=!0,this._renderTimeoutId=setTimeout(()=>{this._renderTimeoutId=null,this.flush(),this.view.change(()=>{})},50)}_handleBlur(e){const i=this.document.selection.editableElement;(i===null||i===e.target)&&(this.document.isFocused=!1,this._isFocusChanging=!1,this.view.change(()=>{}))}_clearTimeout(){this._renderTimeoutId&&(clearTimeout(this._renderTimeoutId),this._renderTimeoutId=null)}}class h8 extends hr{constructor(e){super(e);p(this,"mutationObserver");p(this,"focusObserver");p(this,"selection");p(this,"domConverter");p(this,"_documents",new WeakSet);p(this,"_fireSelectionChangeDoneDebounced");p(this,"_clearInfiniteLoopInterval");p(this,"_documentIsSelectingInactivityTimeoutDebounced");p(this,"_loopbackCounter",0);p(this,"_pendingSelectionChange",new Set);this.mutationObserver=e.getObserver(hA),this.focusObserver=e.getObserver(xg),this.selection=this.document.selection,this.domConverter=e.domConverter,this._fireSelectionChangeDoneDebounced=fs(i=>{this.document.fire("selectionChangeDone",i)},200),this._clearInfiniteLoopInterval=setInterval(()=>this._clearInfiniteLoop(),1e3),this._documentIsSelectingInactivityTimeoutDebounced=fs(()=>this.document.isSelecting=!1,5e3),this.view.document.on("change:isFocused",(i,n,r)=>{if(r&&this._pendingSelectionChange.size){for(const o of Array.from(this._pendingSelectionChange))this._handleSelectionChange(o);this._pendingSelectionChange.clear()}})}observe(e){const i=e.ownerDocument,n=()=>{this.document.isSelecting=!0,this._documentIsSelectingInactivityTimeoutDebounced()},r=()=>{this.document.isSelecting&&(this._handleSelectionChange(i),this.document.isSelecting=!1,this._documentIsSelectingInactivityTimeoutDebounced.cancel())};this.listenTo(e,"selectstart",n,{priority:"highest"}),this.listenTo(e,"keydown",r,{priority:"highest",useCapture:!0}),this.listenTo(e,"keyup",r,{priority:"highest",useCapture:!0}),!this._documents.has(i)&&(this.listenTo(i,"mouseup",r,{priority:"highest",useCapture:!0}),this.listenTo(i,"selectionchange",()=>{this.document.isComposing&&!Ie.isAndroid||(this._handleSelectionChange(i),this._documentIsSelectingInactivityTimeoutDebounced())}),this.listenTo(this.view.document,"compositionstart",()=>{this._handleSelectionChange(i)},{priority:"lowest"}),this._documents.add(i))}stopObserving(e){this.stopListening(e)}destroy(){super.destroy(),clearInterval(this._clearInfiniteLoopInterval),this._fireSelectionChangeDoneDebounced.cancel(),this._documentIsSelectingInactivityTimeoutDebounced.cancel()}_reportInfiniteLoop(){}_handleSelectionChange(e){if(!this.isEnabled)return;const i=e.defaultView.getSelection();if(this.checkShouldIgnoreEventFromTarget(i.anchorNode))return;this.mutationObserver.flush();const n=this.domConverter.domSelectionToView(i);if(n.rangeCount==0){this.view.hasDomSelection=!1;return}if(this.view.hasDomSelection=!0,this.focusObserver.flush(),!this.view.document.isFocused&&!this.view.document.isReadOnly){this._pendingSelectionChange.add(e);return}if(this._pendingSelectionChange.delete(e),!(this.selection.isEqual(n)&&this.domConverter.isDomSelectionCorrect(i))){if(++this._loopbackCounter>60){this._reportInfiniteLoop();return}if(this.selection.isSimilar(n))this.view.forceRender();else{const r={oldSelection:this.selection,newSelection:n,domSelection:i};this.document.fire("selectionChange",r),this._fireSelectionChangeDoneDebounced(r)}}}_clearInfiniteLoop(){this._loopbackCounter=0}}class d8 extends Nr{constructor(e){super(e);p(this,"domEventType",["compositionstart","compositionupdate","compositionend"]);const i=this.document;i.on("compositionstart",()=>{i.isComposing=!0}),i.on("compositionend",()=>{i.isComposing=!1})}onDomEvent(e){this.fire(e.type,e,{data:e.data})}}/**
 * @license Copyright (c) 2003-2025, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options
 */class Cp{constructor(t,e={}){p(this,"_files");p(this,"_native");this._files=e.cacheFiles?nC(t):null,this._native=t}get files(){return this._files||(this._files=nC(this._native)),this._files}get types(){return this._native.types}getData(t){return this._native.getData(t)}setData(t,e){this._native.setData(t,e)}set effectAllowed(t){this._native.effectAllowed=t}get effectAllowed(){return this._native.effectAllowed}set dropEffect(t){this._native.dropEffect=t}get dropEffect(){return this._native.dropEffect}setDragImage(t,e,i){this._native.setDragImage(t,e,i)}get isCanceled(){return this._native.dropEffect=="none"||!!this._native.mozUserCancelled}}function nC(s){const t=Array.from(s.files||[]),e=Array.from(s.items||[]);return t.length?t:e.filter(i=>i.kind==="file").map(i=>i.getAsFile())}class f8 extends Nr{constructor(){super(...arguments);p(this,"domEventType","beforeinput")}onDomEvent(e){const i=e.getTargetRanges(),n=this.view,r=n.document;let o=null,l=null,a=[];if(e.dataTransfer&&(o=new Cp(e.dataTransfer)),e.data!==null?l=e.data:o&&(l=o.getData("text/plain")),r.selection.isFake)a=Array.from(r.selection.getRanges()),e.preventDefault();else if(i.length)a=i.map(c=>{let h=n.domConverter.domPositionToView(c.startContainer,c.startOffset);const f=n.domConverter.domPositionToView(c.endContainer,c.endOffset);if(h&&Ki(c.startContainer)&&c.startOffset<Nn){e.preventDefault();let m=Nn-c.startOffset;h=h.getLastMatchingPosition(w=>!!(w.item.is("attributeElement")||w.item.is("uiElement")||w.item.is("$textProxy")&&m--),{direction:"backward",singleCharacters:!0})}if(m8(c.endContainer,c.endOffset)&&e.preventDefault(),h)return n.createRange(h,f);if(f)return n.createRange(f)}).filter(c=>!!c);else if(Ie.isAndroid){const c=e.target.ownerDocument.defaultView.getSelection();a=Array.from(n.domConverter.domSelectionToView(c).getRanges())}if(Ie.isAndroid&&e.inputType=="insertCompositionText"&&l&&l.endsWith(`
`)){this.fire(e.type,e,{inputType:"insertParagraph",targetRanges:[n.createRange(a[0].end)]});return}if(["insertText","insertReplacementText"].includes(e.inputType)&&l&&l.includes(`
`)){const c=l.split(/\n{1,2}/g);let h=a;e.preventDefault();for(let f=0;f<c.length;f++){const m=c[f];m!=""&&(this.fire(e.type,e,{data:m,dataTransfer:o,targetRanges:h,inputType:e.inputType,isComposing:e.isComposing}),h=[r.selection.getFirstRange()]),f+1<c.length&&(this.fire(e.type,e,{inputType:"insertParagraph",targetRanges:h}),h=[r.selection.getFirstRange()])}return}this.fire(e.type,e,{data:l,dataTransfer:o,targetRanges:a,inputType:e.inputType,isComposing:e.isComposing})}}function m8(s,t){for(;s.parentNode;){if(Lt(s)){if(t!=s.data.length)return!1}else if(t!=s.childNodes.length)return!1;if(t=qa(s)+1,s=s.parentNode,t<s.childNodes.length&&Ki(s.childNodes[t]))return!0}return!1}class g8 extends hr{constructor(t){super(t),this.document.on("keydown",(e,i)=>{if(this.isEnabled&&U9(i.keyCode)){const n=new Nl(this.document,"arrowKey",this.document.selection.getFirstRange());this.document.fire(n,i),n.stop.called&&e.stop()}})}observe(){}stopObserving(){}}class p8 extends hr{constructor(t){super(t);const e=this.document;e.on("keydown",(i,n)=>{if(!this.isEnabled||n.keyCode!=ze.tab||n.ctrlKey)return;const r=new Nl(e,"tab",e.selection.getFirstRange());e.fire(r,n),r.stop.called&&i.stop()})}observe(){}stopObserving(){}}let w8=class extends at(){constructor(e){super();p(this,"document");p(this,"domConverter");p(this,"domRoots",new Map);p(this,"_renderer");p(this,"_initialDomRootAttributes",new WeakMap);p(this,"_observers",new Map);p(this,"_writer");p(this,"_ongoingChange",!1);p(this,"_postFixersInProgress",!1);p(this,"_renderingDisabled",!1);p(this,"_hasChangedSinceTheLastRendering",!1);this.document=new ad(e),this.domConverter=new cd(this.document),this.set("isRenderingInProgress",!1),this.set("hasDomSelection",!1),this._renderer=new HD(this.domConverter,this.document.selection),this._renderer.bind("isFocused","isSelecting","isComposing").to(this.document,"isFocused","isSelecting","isComposing"),this._writer=new rA(this.document),this.addObserver(hA),this.addObserver(xg),this.addObserver(h8),this.addObserver(a8),this.addObserver(c8),this.addObserver(d8),this.addObserver(g8),this.addObserver(f8),this.addObserver(p8),UD(this),BD(this),this.on("render",()=>{this._render(),this.document.fire("layoutChanged"),this._hasChangedSinceTheLastRendering=!1}),this.listenTo(this.document.selection,"change",()=>{this._hasChangedSinceTheLastRendering=!0}),this.listenTo(this.document,"change:isFocused",()=>{this._hasChangedSinceTheLastRendering=!0}),Ie.isiOS&&this.listenTo(this.document,"blur",(i,n)=>{this.domConverter.mapDomToView(n.domEvent.relatedTarget)||this.domConverter._clearDomSelection()}),this.listenTo(this.document,"mutations",(i,{mutations:n})=>{n.forEach(r=>this._renderer.markToSync(r.type,r.node))},{priority:"low"}),this.listenTo(this.document,"mutations",()=>{this.forceRender()},{priority:"lowest"})}attachDomRoot(e,i="main"){const n=this.document.getRoot(i);n._name=e.tagName.toLowerCase();const r={};for(const{name:l,value:a}of Array.from(e.attributes))r[l]=a,l==="class"?this._writer.addClass(a.split(" "),n):n.hasAttribute(l)||this._writer.setAttribute(l,a,n);this._initialDomRootAttributes.set(e,r);const o=()=>{this._writer.setAttribute("contenteditable",(!n.isReadOnly).toString(),n),n.isReadOnly?this._writer.addClass("ck-read-only",n):this._writer.removeClass("ck-read-only",n)};o(),this.domRoots.set(i,e),this.domConverter.bindElements(e,n),this._renderer.markToSync("children",n),this._renderer.markToSync("attributes",n),this._renderer.domDocuments.add(e.ownerDocument),n.on("change:children",(l,a)=>this._renderer.markToSync("children",a)),n.on("change:attributes",(l,a)=>this._renderer.markToSync("attributes",a)),n.on("change:text",(l,a)=>this._renderer.markToSync("text",a)),n.on("change:isReadOnly",()=>this.change(o)),n.on("change",()=>{this._hasChangedSinceTheLastRendering=!0});for(const l of this._observers.values())l.observe(e,i)}detachDomRoot(e){const i=this.domRoots.get(e);Array.from(i.attributes).forEach(({name:r})=>i.removeAttribute(r));const n=this._initialDomRootAttributes.get(i);for(const r in n)i.setAttribute(r,n[r]);this.domRoots.delete(e),this.domConverter.unbindDomElement(i);for(const r of this._observers.values())r.stopObserving(i)}getDomRoot(e="main"){return this.domRoots.get(e)}addObserver(e){let i=this._observers.get(e);if(i)return i;i=new e(this),this._observers.set(e,i);for(const[n,r]of this.domRoots)i.observe(r,n);return i.enable(),i}getObserver(e){return this._observers.get(e)}disableObservers(){for(const e of this._observers.values())e.disable()}enableObservers(){for(const e of this._observers.values())e.enable()}scrollToTheSelection({alignToTop:e,forceScroll:i,viewportOffset:n=20,ancestorOffset:r=20}={}){const o=this.document.selection.getFirstRange();if(!o)return;const l=_n({alignToTop:e,forceScroll:i,viewportOffset:n,ancestorOffset:r});typeof n=="number"&&(n={top:n,bottom:n,left:n,right:n});const a={target:this.domConverter.viewRangeToDom(o),viewportOffset:n,ancestorOffset:r,alignToTop:e,forceScroll:i};this.fire("scrollToTheSelection",a,l),$9(a)}focus(){if(!this.document.isFocused){const e=this.document.selection.editableElement;e&&(this.domConverter.focus(e),this.forceRender())}}change(e){if(this.isRenderingInProgress||this._postFixersInProgress)throw new E("cannot-change-view-tree",this);try{if(this._ongoingChange)return e(this._writer);this._ongoingChange=!0;const i=e(this._writer);return this._ongoingChange=!1,!this._renderingDisabled&&this._hasChangedSinceTheLastRendering&&(this._postFixersInProgress=!0,this.document._callPostFixers(this._writer),this._postFixersInProgress=!1,this.fire("render")),i}catch(i){/* istanbul ignore next -- @preserve */E.rethrowUnexpectedError(i,this)}}forceRender(){this._hasChangedSinceTheLastRendering=!0,this.getObserver(xg).flush(),this.change(()=>{})}destroy(){for(const e of this._observers.values())e.destroy();this.document.destroy(),this.stopListening()}createPositionAt(e,i){return be._createAt(e,i)}createPositionAfter(e){return be._createAfter(e)}createPositionBefore(e){return be._createBefore(e)}createRange(e,i){return new We(e,i)}createRangeOn(e){return We._createOn(e)}createRangeIn(e){return We._createIn(e)}createSelection(...e){return new Ir(...e)}_disableRendering(e){this._renderingDisabled=e,e==!1&&this.change(()=>{})}_render(){this.isRenderingInProgress=!0,this.disableObservers(),this._renderer.render(),this.enableObservers(),this.isRenderingInProgress=!1}};/**
 * @license Copyright (c) 2003-2025, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options
 */class Fo{is(){throw new Error("is() method is abstract")}}class Ms extends Fo{constructor(e,i,n){super();p(this,"textNode");p(this,"data");p(this,"offsetInText");if(this.textNode=e,i<0||i>e.offsetSize)throw new E("model-textproxy-wrong-offsetintext",this);if(n<0||i+n>e.offsetSize)throw new E("model-textproxy-wrong-length",this);this.data=e.data.substring(i,i+n),this.offsetInText=i}get startOffset(){return this.textNode.startOffset!==null?this.textNode.startOffset+this.offsetInText:null}get offsetSize(){return this.data.length}get endOffset(){return this.startOffset!==null?this.startOffset+this.offsetSize:null}get isPartial(){return this.offsetSize!==this.textNode.offsetSize}get parent(){return this.textNode.parent}get root(){return this.textNode.root}getPath(){const e=this.textNode.getPath();return e.length>0&&(e[e.length-1]+=this.offsetInText),e}getAncestors(e={}){const i=[];let n=e.includeSelf?this:this.parent;for(;n;)i[e.parentFirst?"push":"unshift"](n),n=n.parent;return i}hasAttribute(e){return this.textNode.hasAttribute(e)}getAttribute(e){return this.textNode.getAttribute(e)}getAttributes(){return this.textNode.getAttributes()}getAttributeKeys(){return this.textNode.getAttributeKeys()}}Ms.prototype.is=function(s){return s==="$textProxy"||s==="model:$textProxy"||s==="textProxy"||s==="model:textProxy"};class Ar{constructor(t){p(this,"direction");p(this,"boundaries");p(this,"singleCharacters");p(this,"shallow");p(this,"ignoreElementEnd");p(this,"_position");p(this,"_boundaryStartParent");p(this,"_boundaryEndParent");p(this,"_visitedParent");if(!t||!t.boundaries&&!t.startPosition)throw new E("model-tree-walker-no-start-position",null);const e=t.direction||"forward";if(e!="forward"&&e!="backward")throw new E("model-tree-walker-unknown-direction",t,{direction:e});this.direction=e,this.boundaries=t.boundaries||null,t.startPosition?this._position=t.startPosition.clone():this._position=ne._createAt(this.boundaries[this.direction=="backward"?"end":"start"]),this.position.stickiness="toNone",this.singleCharacters=!!t.singleCharacters,this.shallow=!!t.shallow,this.ignoreElementEnd=!!t.ignoreElementEnd,this._boundaryStartParent=this.boundaries?this.boundaries.start.parent:null,this._boundaryEndParent=this.boundaries?this.boundaries.end.parent:null,this._visitedParent=this.position.parent}[Symbol.iterator](){return this}get position(){return this._position}skip(t){let e,i,n,r;do n=this.position,r=this._visitedParent,{done:e,value:i}=this.next();while(!e&&t(i));e||(this._position=n,this._visitedParent=r)}jumpTo(t){this._boundaryStartParent&&t.isBefore(this.boundaries.start)?t=this.boundaries.start:this._boundaryEndParent&&t.isAfter(this.boundaries.end)&&(t=this.boundaries.end),this._position=t.clone(),this._visitedParent=t.parent}next(){return this.direction=="forward"?this._next():this._previous()}_next(){const t=this.position,e=this.position.clone(),i=this._visitedParent;if(i.parent===null&&e.offset===i.maxOffset)return{done:!0,value:void 0};if(i===this._boundaryEndParent&&e.offset==this.boundaries.end.offset)return{done:!0,value:void 0};const n=ch(e,i),r=n||dA(e,i,n);if(r&&r.is("model:element")){if(!this.shallow)e.path.push(0),this._visitedParent=r;else{if(this.boundaries&&this.boundaries.end.isBefore(e))return{done:!0,value:void 0};e.offset++}return this._position=e,ll("elementStart",r,t,e,1)}if(r&&r.is("model:$text")){let o;if(this.singleCharacters)o=1;else{let c=r.endOffset;this._boundaryEndParent==i&&this.boundaries.end.offset<c&&(c=this.boundaries.end.offset),o=c-e.offset}const l=e.offset-r.startOffset,a=new Ms(r,l,o);return e.offset+=o,this._position=e,ll("text",a,t,e,o)}return e.path.pop(),e.offset++,this._position=e,this._visitedParent=i.parent,this.ignoreElementEnd?this._next():ll("elementEnd",i,t,e)}_previous(){const t=this.position,e=this.position.clone(),i=this._visitedParent;if(i.parent===null&&e.offset===0)return{done:!0,value:void 0};if(i==this._boundaryStartParent&&e.offset==this.boundaries.start.offset)return{done:!0,value:void 0};const n=e.parent,r=ch(e,n),o=r||fA(e,n,r);if(o&&o.is("model:element"))return e.offset--,this.shallow?(this._position=e,ll("elementStart",o,t,e,1)):(e.path.push(o.maxOffset),this._position=e,this._visitedParent=o,this.ignoreElementEnd?this._previous():ll("elementEnd",o,t,e));if(o&&o.is("model:$text")){let l;if(this.singleCharacters)l=1;else{let h=o.startOffset;this._boundaryStartParent==i&&this.boundaries.start.offset>h&&(h=this.boundaries.start.offset),l=e.offset-h}const a=e.offset-o.startOffset,c=new Ms(o,a-l,l);return e.offset-=l,this._position=e,ll("text",c,t,e,l)}return e.path.pop(),this._position=e,this._visitedParent=i.parent,ll("elementStart",i,t,e,1)}}function ll(s,t,e,i,n){return{done:!1,value:{type:s,item:t,previousPosition:e,nextPosition:i,length:n}}}class ne extends Fo{constructor(e,i,n="toNone"){super();p(this,"root");p(this,"path");p(this,"stickiness");if(!e.is("element")&&!e.is("documentFragment"))throw new E("model-position-root-invalid",e);if(!Array.isArray(i)||i.length===0)throw new E("model-position-path-incorrect-format",e,{path:i});e.is("rootElement")?i=i.slice():(i=[...e.getPath(),...i],e=e.root),this.root=e,this.path=i,this.stickiness=n}get offset(){return this.path[this.path.length-1]}set offset(e){this.path[this.path.length-1]=e}get parent(){let e=this.root;for(let i=0;i<this.path.length-1;i++)if(e=e.getChildAtOffset(this.path[i]),!e)throw new E("model-position-path-incorrect",this,{position:this});if(e.is("$text"))throw new E("model-position-path-incorrect",this,{position:this});return e}get index(){return this.parent.offsetToIndex(this.offset)}get textNode(){return ch(this,this.parent)}get nodeAfter(){const e=this.parent;return dA(this,e,ch(this,e))}get nodeBefore(){const e=this.parent;return fA(this,e,ch(this,e))}get isAtStart(){return this.offset===0}get isAtEnd(){return this.offset==this.parent.maxOffset}isValid(){if(this.offset<0)return!1;let e=this.root;for(let i=0;i<this.path.length-1;i++)if(e=e.getChildAtOffset(this.path[i]),!e)return!1;return this.offset<=e.maxOffset}compareWith(e){if(this.root!=e.root)return"different";const i=Ni(this.path,e.path);switch(i){case"same":return"same";case"prefix":return"before";case"extension":return"after";default:return this.path[i]<e.path[i]?"before":"after"}}getLastMatchingPosition(e,i={}){i.startPosition=this;const n=new Ar(i);return n.skip(e),n.position}getParentPath(){return this.path.slice(0,-1)}getAncestors(){const e=this.parent;return e.is("documentFragment")?[e]:e.getAncestors({includeSelf:!0})}findAncestor(e){const i=this.parent;return i.is("element")?i.findAncestor(e,{includeSelf:!0}):null}getCommonPath(e){if(this.root!=e.root)return[];const i=Ni(this.path,e.path),n=typeof i=="string"?Math.min(this.path.length,e.path.length):i;return this.path.slice(0,n)}getCommonAncestor(e){const i=this.getAncestors(),n=e.getAncestors();let r=0;for(;i[r]==n[r]&&i[r];)r++;return r===0?null:i[r-1]}getShiftedBy(e){const i=this.clone(),n=i.offset+e;return i.offset=n<0?0:n,i}isAfter(e){return this.compareWith(e)=="after"}isBefore(e){return this.compareWith(e)=="before"}isEqual(e){return this.compareWith(e)=="same"}isTouching(e){if(this.root!==e.root)return!1;const i=Math.min(this.path.length,e.path.length);for(let n=0;n<i;n++){const r=this.path[n]-e.path[n];if(r<-1||r>1)return!1;if(r===1)return sC(e,this,n);if(r===-1)return sC(this,e,n)}return this.path.length===e.path.length?!0:this.path.length>e.path.length?Mb(this.path,i):Mb(e.path,i)}hasSameParentAs(e){if(this.root!==e.root)return!1;const i=this.getParentPath(),n=e.getParentPath();return Ni(i,n)=="same"}getTransformedByOperation(e){let i;switch(e.type){case"insert":i=this._getTransformedByInsertOperation(e);break;case"move":case"remove":case"reinsert":i=this._getTransformedByMoveOperation(e);break;case"split":i=this._getTransformedBySplitOperation(e);break;case"merge":i=this._getTransformedByMergeOperation(e);break;default:i=ne._createAt(this);break}return i}_getTransformedByInsertOperation(e){return this._getTransformedByInsertion(e.position,e.howMany)}_getTransformedByMoveOperation(e){return this._getTransformedByMove(e.sourcePosition,e.targetPosition,e.howMany)}_getTransformedBySplitOperation(e){const i=e.movedRange;return i.containsPosition(this)||i.start.isEqual(this)&&this.stickiness=="toNext"?this._getCombined(e.splitPosition,e.moveTargetPosition):e.graveyardPosition?this._getTransformedByMove(e.graveyardPosition,e.insertionPosition,1):this._getTransformedByInsertion(e.insertionPosition,1)}_getTransformedByMergeOperation(e){const i=e.movedRange,n=i.containsPosition(this)||i.start.isEqual(this);let r;return n?(r=this._getCombined(e.sourcePosition,e.targetPosition),e.sourcePosition.isBefore(e.targetPosition)&&(r=r._getTransformedByDeletion(e.deletionPosition,1))):this.isEqual(e.deletionPosition)?r=ne._createAt(e.deletionPosition):r=this._getTransformedByMove(e.deletionPosition,e.graveyardPosition,1),r}_getTransformedByDeletion(e,i){const n=ne._createAt(this);if(this.root!=e.root)return n;if(Ni(e.getParentPath(),this.getParentPath())=="same"){if(e.offset<this.offset){if(e.offset+i>this.offset)return null;n.offset-=i}}else if(Ni(e.getParentPath(),this.getParentPath())=="prefix"){const r=e.path.length-1;if(e.offset<=this.path[r]){if(e.offset+i>this.path[r])return null;n.path[r]-=i}}return n}_getTransformedByInsertion(e,i){const n=ne._createAt(this);if(this.root!=e.root)return n;if(Ni(e.getParentPath(),this.getParentPath())=="same")(e.offset<this.offset||e.offset==this.offset&&this.stickiness!="toPrevious")&&(n.offset+=i);else if(Ni(e.getParentPath(),this.getParentPath())=="prefix"){const r=e.path.length-1;e.offset<=this.path[r]&&(n.path[r]+=i)}return n}_getTransformedByMove(e,i,n){if(i=i._getTransformedByDeletion(e,n),e.isEqual(i))return ne._createAt(this);const r=this._getTransformedByDeletion(e,n);return r===null||e.isEqual(this)&&this.stickiness=="toNext"||e.getShiftedBy(n).isEqual(this)&&this.stickiness=="toPrevious"?this._getCombined(e,i):r._getTransformedByInsertion(i,n)}_getCombined(e,i){const n=e.path.length-1,r=ne._createAt(i);return r.stickiness=this.stickiness,r.offset=r.offset+this.path[n]-e.offset,r.path=[...r.path,...this.path.slice(n+1)],r}toJSON(){return{root:this.root.toJSON(),path:Array.from(this.path),stickiness:this.stickiness}}clone(){return new this.constructor(this.root,this.path,this.stickiness)}static _createAt(e,i,n="toNone"){if(e.is("model:position"))return new ne(e.root,e.path,e.stickiness);{const r=e;if(i=="end")i=r.maxOffset;else{if(i=="before")return this._createBefore(r,n);if(i=="after")return this._createAfter(r,n);if(i!==0&&!i)throw new E("model-createpositionat-offset-required",[this,e])}if(!r.is("element")&&!r.is("documentFragment"))throw new E("model-position-parent-incorrect",[this,e]);const o=r.getPath();return o.push(i),new this(r.root,o,n)}}static _createAfter(e,i){if(!e.parent)throw new E("model-position-after-root",[this,e],{root:e});return this._createAt(e.parent,e.endOffset,i)}static _createBefore(e,i){if(!e.parent)throw new E("model-position-before-root",e,{root:e});return this._createAt(e.parent,e.startOffset,i)}static fromJSON(e,i){if(e.root==="$graveyard"){const n=new ne(i.graveyard,e.path);return n.stickiness=e.stickiness,n}if(!i.getRoot(e.root))throw new E("model-position-fromjson-no-root",i,{rootName:e.root});return new ne(i.getRoot(e.root),e.path,e.stickiness)}}ne.prototype.is=function(s){return s==="position"||s==="model:position"};function ch(s,t){const e=t.getChildAtOffset(s.offset);return e&&e.is("$text")&&e.startOffset<s.offset?e:null}function dA(s,t,e){return e!==null?null:t.getChildAtOffset(s.offset)}function fA(s,t,e){return e!==null?null:t.getChild(t.offsetToIndex(s.offset)-1)}function sC(s,t,e){return!(e+1===s.path.length||!Mb(t.path,e+1)||!x8(s,e+1))}function Mb(s,t){for(;t<s.length;){if(s[t]!==0)return!1;t++}return!0}function x8(s,t){let e=s.parent,i=s.path.length-1,n=0;for(;i>=t;){if(s.path[i]+n!==e.maxOffset)return!1;n=1,i--,e=e.parent}return!0}let K=class Vt extends Fo{constructor(e,i){super();p(this,"start");p(this,"end");this.start=ne._createAt(e),this.end=i?ne._createAt(i):ne._createAt(e),this.start.stickiness=this.isCollapsed?"toNone":"toNext",this.end.stickiness=this.isCollapsed?"toNone":"toPrevious"}*[Symbol.iterator](){yield*new Ar({boundaries:this,ignoreElementEnd:!0})}get isCollapsed(){return this.start.isEqual(this.end)}get isFlat(){const e=this.start.getParentPath(),i=this.end.getParentPath();return Ni(e,i)=="same"}get root(){return this.start.root}containsPosition(e){return e.isAfter(this.start)&&e.isBefore(this.end)}containsRange(e,i=!1){e.isCollapsed&&(i=!1);const n=this.containsPosition(e.start)||i&&this.start.isEqual(e.start),r=this.containsPosition(e.end)||i&&this.end.isEqual(e.end);return n&&r}containsItem(e){const i=ne._createBefore(e);return this.containsPosition(i)||this.start.isEqual(i)}isEqual(e){return this.start.isEqual(e.start)&&this.end.isEqual(e.end)}isIntersecting(e){return this.start.isBefore(e.end)&&this.end.isAfter(e.start)}getDifference(e){const i=[];return this.isIntersecting(e)?(this.containsPosition(e.start)&&i.push(new Vt(this.start,e.start)),this.containsPosition(e.end)&&i.push(new Vt(e.end,this.end))):i.push(new Vt(this.start,this.end)),i}getIntersection(e){if(this.isIntersecting(e)){let i=this.start,n=this.end;return this.containsPosition(e.start)&&(i=e.start),this.containsPosition(e.end)&&(n=e.end),new Vt(i,n)}return null}getJoined(e,i=!1){let n=this.isIntersecting(e);if(n||(this.start.isBefore(e.start)?n=i?this.end.isTouching(e.start):this.end.isEqual(e.start):n=i?e.end.isTouching(this.start):e.end.isEqual(this.start)),!n)return null;let r=this.start,o=this.end;return e.start.isBefore(r)&&(r=e.start),e.end.isAfter(o)&&(o=e.end),new Vt(r,o)}getMinimalFlatRanges(){const e=[],i=this.start.getCommonPath(this.end).length,n=ne._createAt(this.start);let r=n.parent;for(;n.path.length>i+1;){const o=r.maxOffset-n.offset;o!==0&&e.push(new Vt(n,n.getShiftedBy(o))),n.path=n.path.slice(0,-1),n.offset++,r=r.parent}for(;n.path.length<=this.end.path.length;){const o=this.end.path[n.path.length-1],l=o-n.offset;l!==0&&e.push(new Vt(n,n.getShiftedBy(l))),n.offset=o,n.path.push(0)}return e}getWalker(e={}){return e.boundaries=this,new Ar(e)}*getItems(e={}){e.boundaries=this,e.ignoreElementEnd=!0;const i=new Ar(e);for(const n of i)yield n.item}*getPositions(e={}){e.boundaries=this;const i=new Ar(e);yield i.position;for(const n of i)yield n.nextPosition}getTransformedByOperation(e){switch(e.type){case"insert":return this._getTransformedByInsertOperation(e);case"move":case"remove":case"reinsert":return this._getTransformedByMoveOperation(e);case"split":return[this._getTransformedBySplitOperation(e)];case"merge":return[this._getTransformedByMergeOperation(e)]}return[new Vt(this.start,this.end)]}getTransformedByOperations(e){const i=[new Vt(this.start,this.end)];for(const n of e)for(let r=0;r<i.length;r++){const o=i[r].getTransformedByOperation(n);i.splice(r,1,...o),r+=o.length-1}for(let n=0;n<i.length;n++){const r=i[n];for(let o=n+1;o<i.length;o++){const l=i[o];(r.containsRange(l)||l.containsRange(r)||r.isEqual(l))&&i.splice(o,1)}}return i}getCommonAncestor(){return this.start.getCommonAncestor(this.end)}getContainedElement(){if(this.isCollapsed)return null;const e=this.start.nodeAfter,i=this.end.nodeBefore;return e&&e.is("element")&&e===i?e:null}toJSON(){return{start:this.start.toJSON(),end:this.end.toJSON()}}clone(){return new this.constructor(this.start,this.end)}_getTransformedByInsertOperation(e,i=!1){return this._getTransformedByInsertion(e.position,e.howMany,i)}_getTransformedByMoveOperation(e,i=!1){const n=e.sourcePosition,r=e.howMany,o=e.targetPosition;return this._getTransformedByMove(n,o,r,i)}_getTransformedBySplitOperation(e){const i=this.start._getTransformedBySplitOperation(e);let n=this.end._getTransformedBySplitOperation(e);return this.end.isEqual(e.insertionPosition)&&(n=this.end.getShiftedBy(1)),i.root!=n.root&&(n=this.end.getShiftedBy(-1)),new Vt(i,n)}_getTransformedByMergeOperation(e){if(this.start.isEqual(e.targetPosition)&&this.end.isEqual(e.deletionPosition))return new Vt(this.start);let i=this.start._getTransformedByMergeOperation(e),n=this.end._getTransformedByMergeOperation(e);return i.root!=n.root&&(n=this.end.getShiftedBy(-1)),i.isAfter(n)?(e.sourcePosition.isBefore(e.targetPosition)?(i=ne._createAt(n),i.offset=0):(e.deletionPosition.isEqual(i)||(n=e.deletionPosition),i=e.targetPosition),new Vt(i,n)):new Vt(i,n)}_getTransformedByInsertion(e,i,n=!1){if(n&&this.containsPosition(e))return[new Vt(this.start,e),new Vt(e.getShiftedBy(i),this.end._getTransformedByInsertion(e,i))];{const r=new Vt(this.start,this.end);return r.start=r.start._getTransformedByInsertion(e,i),r.end=r.end._getTransformedByInsertion(e,i),[r]}}_getTransformedByMove(e,i,n,r=!1){if(this.isCollapsed){const m=this.start._getTransformedByMove(e,i,n);return[new Vt(m)]}const o=Vt._createFromPositionAndShift(e,n),l=i._getTransformedByDeletion(e,n);if(this.containsPosition(i)&&!r&&(o.containsPosition(this.start)||o.containsPosition(this.end))){const m=this.start._getTransformedByMove(e,i,n),w=this.end._getTransformedByMove(e,i,n);return[new Vt(m,w)]}let a;const c=this.getDifference(o);let h=null;const f=this.getIntersection(o);if(c.length==1?h=new Vt(c[0].start._getTransformedByDeletion(e,n),c[0].end._getTransformedByDeletion(e,n)):c.length==2&&(h=new Vt(this.start,this.end._getTransformedByDeletion(e,n))),h?a=h._getTransformedByInsertion(l,n,f!==null||r):a=[],f){const m=new Vt(f.start._getCombined(o.start,l),f.end._getCombined(o.start,l));a.length==2?a.splice(1,0,m):a.push(m)}return a}_getTransformedByDeletion(e,i){let n=this.start._getTransformedByDeletion(e,i),r=this.end._getTransformedByDeletion(e,i);return n==null&&r==null?null:(n==null&&(n=e),r==null&&(r=e),new Vt(n,r))}static _createFromPositionAndShift(e,i){const n=e,r=e.getShiftedBy(i);return i>0?new this(n,r):new this(r,n)}static _createIn(e){return new this(ne._createAt(e,0),ne._createAt(e,e.maxOffset))}static _createOn(e){return this._createFromPositionAndShift(ne._createBefore(e),e.offsetSize)}static _createFromRanges(e){if(e.length===0)throw new E("range-create-from-ranges-empty-array",null);if(e.length==1)return e[0].clone();const i=e[0];e.sort((o,l)=>o.start.isAfter(l.start)?1:-1);const n=e.indexOf(i),r=new this(i.start,i.end);for(let o=n-1;o>=0&&e[o].end.isEqual(r.start);o--)r.start=ne._createAt(e[o].start);for(let o=n+1;o<e.length&&e[o].start.isEqual(r.end);o++)r.end=ne._createAt(e[o].end);return r}static fromJSON(e,i){return new this(ne.fromJSON(e.start,i),ne.fromJSON(e.end,i))}};K.prototype.is=function(s){return s==="range"||s==="model:range"};class mA extends pt(){constructor(){super();p(this,"_modelToViewMapping",new WeakMap);p(this,"_viewToModelMapping",new WeakMap);p(this,"_viewToModelLengthCallbacks",new Map);p(this,"_markerNameToElements",new Map);p(this,"_elementToMarkerNames",new Map);p(this,"_deferredBindingRemovals",new Map);p(this,"_unboundMarkerNames",new Set);p(this,"_cache",new b8);this.on("modelToViewPosition",(e,i)=>{if(i.viewPosition)return;const n=this._modelToViewMapping.get(i.modelPosition.parent);if(!n)throw new E("mapping-model-position-view-parent-not-found",this,{modelPosition:i.modelPosition});i.viewPosition=this.findPositionIn(n,i.modelPosition.offset)},{priority:"low"}),this.on("viewToModelPosition",(e,i)=>{if(i.modelPosition)return;const n=this.findMappedViewAncestor(i.viewPosition),r=this._viewToModelMapping.get(n),o=this._toModelOffset(i.viewPosition.parent,i.viewPosition.offset,n);i.modelPosition=ne._createAt(r,o)},{priority:"low"})}bindElements(e,i){this._modelToViewMapping.set(e,i),this._viewToModelMapping.set(i,e)}unbindViewElement(e,i={}){const n=this.toModelElement(e);if(this._elementToMarkerNames.has(e))for(const r of this._elementToMarkerNames.get(e))this._unboundMarkerNames.add(r);i.defer?this._deferredBindingRemovals.set(e,e.root):(this._viewToModelMapping.delete(e)&&this._cache.stopTracking(e),this._modelToViewMapping.get(n)==e&&this._modelToViewMapping.delete(n))}unbindModelElement(e){const i=this.toViewElement(e);this._modelToViewMapping.delete(e),this._viewToModelMapping.get(i)==e&&this._viewToModelMapping.delete(i)&&this._cache.stopTracking(i)}bindElementToMarker(e,i){const n=this._markerNameToElements.get(i)||new Set;n.add(e);const r=this._elementToMarkerNames.get(e)||new Set;r.add(i),this._markerNameToElements.set(i,n),this._elementToMarkerNames.set(e,r)}unbindElementFromMarkerName(e,i){const n=this._markerNameToElements.get(i);n&&(n.delete(e),n.size==0&&this._markerNameToElements.delete(i));const r=this._elementToMarkerNames.get(e);r&&(r.delete(i),r.size==0&&this._elementToMarkerNames.delete(e))}flushUnboundMarkerNames(){const e=Array.from(this._unboundMarkerNames);return this._unboundMarkerNames.clear(),e}flushDeferredBindings(){for(const[e,i]of this._deferredBindingRemovals)e.root==i&&this.unbindViewElement(e);this._deferredBindingRemovals=new Map}clearBindings(){this._modelToViewMapping=new WeakMap,this._viewToModelMapping=new WeakMap,this._markerNameToElements=new Map,this._elementToMarkerNames=new Map,this._unboundMarkerNames=new Set,this._deferredBindingRemovals=new Map}toModelElement(e){return this._viewToModelMapping.get(e)}toViewElement(e){return this._modelToViewMapping.get(e)}toModelRange(e){return new K(this.toModelPosition(e.start),this.toModelPosition(e.end))}toViewRange(e){return new We(this.toViewPosition(e.start),this.toViewPosition(e.end))}toModelPosition(e){const i={viewPosition:e,mapper:this};return this.fire("viewToModelPosition",i),i.modelPosition}toViewPosition(e,i={}){const n={modelPosition:e,mapper:this,isPhantom:i.isPhantom};return this.fire("modelToViewPosition",n),n.viewPosition}markerNameToElements(e){const i=this._markerNameToElements.get(e);if(!i)return null;const n=new Set;for(const r of i)if(r.is("attributeElement"))for(const o of r.getElementsWithSameId())n.add(o);else n.add(r);return n}registerViewToModelLength(e,i){this._viewToModelLengthCallbacks.set(e,i)}findMappedViewAncestor(e){let i=e.parent;for(;!this._viewToModelMapping.has(i);)i=i.parent;return i}_toModelOffset(e,i,n){if(n!=e){const o=this._toModelOffset(e.parent,e.index,n),l=this._toModelOffset(e,i,e);return o+l}if(e.is("$text"))return i;let r=0;for(let o=0;o<i;o++)r+=this.getModelLength(e.getChild(o));return r}getModelLength(e){const i=[e];let n=0;for(;i.length>0;){const r=i.pop(),o=r.name&&this._viewToModelLengthCallbacks.size>0&&this._viewToModelLengthCallbacks.get(r.name);if(o)n+=o(r);else if(this._viewToModelMapping.has(r))n+=1;else if(r.is("$text"))n+=r.data.length;else{if(r.is("uiElement"))continue;for(const l of r.getChildren())i.push(l)}}return n}findPositionIn(e,i){if(i===0)return this._moveViewPositionToTextNode(new be(e,0));if(this._viewToModelLengthCallbacks.size==0&&this._viewToModelMapping.has(e)){const r=this._cache.getClosest(e,i);return this._findPositionStartingFrom(r.viewPosition,r.modelOffset,i,e,!0)}else return this._findPositionStartingFrom(new be(e,0),0,i,e,!1)}_findPositionStartingFrom(e,i,n,r,o){let l=e.parent,a=e.offset;if(l.is("$text"))return new be(l,n-i);let c,h=i,f=0;for(;h<n;){if(c=l.getChild(a),!c){if(l==r)throw new E("mapping-model-offset-not-found",this,{modelOffset:n,viewContainer:r});a=l.parent.getChildIndex(l)+1,l=l.parent,o&&this._cache.save(l,a,r,h);continue}o?f=this._getModelLengthAndCache(c,r,h):f=this.getModelLength(c),h+=f,a++}let m=new be(l,a);if(o)for(;m.isAtEnd&&m.parent!==r&&m.parent.parent;){const w=m.parent.parent,O=w.getChildIndex(m.parent)+1;this._cache.save(w,O,r,h),m=new be(w,O)}return h==n?this._moveViewPositionToTextNode(m):this._findPositionStartingFrom(new be(c,0),h-f,n,r,o)}_getModelLengthAndCache(e,i,n){let r=0;if(this._viewToModelMapping.has(e))r=1;else if(e.is("$text"))r=e.data.length;else if(!e.is("uiElement"))for(const o of e.getChildren())r+=this._getModelLengthAndCache(o,i,n+r);return this._cache.save(e.parent,e.index+1,i,n+r),r}_moveViewPositionToTextNode(e){const i=e.nodeBefore,n=e.nodeAfter;return i&&i.is("view:$text")?new be(i,i.data.length):n&&n.is("view:$text")?new be(n,0):e}}class b8 extends pt(){constructor(){super(...arguments);p(this,"_cachedMapping",new WeakMap);p(this,"_nodeToCacheListIndex",new WeakMap);p(this,"_invalidateOnChildrenChangeCallback",(e,i,n)=>{this._clearCacheInsideParent(i,n.index)});p(this,"_invalidateOnTextChangeCallback",(e,i)=>{this._clearCacheAfter(i)})}save(e,i,n,r){const o=this._cachedMapping.get(n),l=o.cacheMap.get(r);if(l){const f=e.getChild(i-1),m=l.viewPosition.nodeBefore?this._nodeToCacheListIndex.get(l.viewPosition.nodeBefore):0;this._nodeToCacheListIndex.set(f,m);return}const c={viewPosition:new be(e,i),modelOffset:r};o.maxModelOffset=r>o.maxModelOffset?r:o.maxModelOffset,o.cacheMap.set(r,c);let h=o.cacheList.length-1;for(;h>=0&&o.cacheList[h].modelOffset>r;)h--;if(o.cacheList.splice(h+1,0,c),i>0){const f=e.getChild(i-1);this._nodeToCacheListIndex.set(f,h+1)}}getClosest(e,i){const n=this._cachedMapping.get(e);let r;if(n)if(i>n.maxModelOffset)r=n.cacheList[n.cacheList.length-1];else{const o=n.cacheMap.get(i);o?r=o:r=this._findInCacheList(n.cacheList,i)}else r=this.startTracking(e);return{modelOffset:r.modelOffset,viewPosition:r.viewPosition.clone()}}startTracking(e){const n={viewPosition:new be(e,0),modelOffset:0},r={maxModelOffset:0,cacheList:[n],cacheMap:new Map([[0,n]])};return this._cachedMapping.set(e,r),e.on("change:children",this._invalidateOnChildrenChangeCallback),e.on("change:text",this._invalidateOnTextChangeCallback),n}stopTracking(e){e.off("change:children",this._invalidateOnChildrenChangeCallback),e.off("change:text",this._invalidateOnTextChangeCallback),this._cachedMapping.delete(e)}_clearCacheInsideParent(e,i){if(i==0)this._cachedMapping.has(e)?this._clearCacheAll(e):this._clearCacheInsideParent(e.parent,e.index);else{const n=e.getChild(i-1);this._clearCacheAfter(n)}}_clearCacheAll(e){const i=this._cachedMapping.get(e);i.maxModelOffset>0&&(i.maxModelOffset=0,i.cacheList.length=1,i.cacheMap.clear(),i.cacheMap.set(0,i.cacheList[0]))}_clearCacheAfter(e){const i=this._nodeToCacheListIndex.get(e);if(i===void 0){const r=e.parent;this._cachedMapping.has(r)||this._clearCacheInsideParent(r.parent,r.index);return}let n=e.parent;for(;!this._cachedMapping.has(n);)n=n.parent;this._clearCacheFromCacheIndex(n,i)}_clearCacheFromCacheIndex(e,i){i===0&&(i=1);const n=this._cachedMapping.get(e),r=n.cacheList[i-1];if(!r)return;n.maxModelOffset=r.modelOffset;const o=n.cacheList.splice(i);for(const l of o){n.cacheMap.delete(l.modelOffset);const a=l.viewPosition.nodeBefore;this._nodeToCacheListIndex.delete(a)}}_findInCacheList(e,i){let n=0,r=e.length-1,o=r-n>>1,l=e[o];for(;n<r;)l.modelOffset<i?n=o+1:r=o-1,o=n+(r-n>>1),l=e[o];return l.modelOffset<=i?l:e[o-1]}}class O8{constructor(){p(this,"_consumable",new Map);p(this,"_textProxyRegistry",new Map)}add(t,e){e=Zf(e),t instanceof Ms&&(t=this._getSymbolForTextProxy(t)),this._consumable.has(t)||this._consumable.set(t,new Map),this._consumable.get(t).set(e,!0)}consume(t,e){return e=Zf(e),t instanceof Ms&&(t=this._getSymbolForTextProxy(t)),this.test(t,e)?(this._consumable.get(t).set(e,!1),!0):!1}test(t,e){e=Zf(e),t instanceof Ms&&(t=this._getSymbolForTextProxy(t));const i=this._consumable.get(t);if(i===void 0)return null;const n=i.get(e);return n===void 0?null:n}revert(t,e){e=Zf(e),t instanceof Ms&&(t=this._getSymbolForTextProxy(t));const i=this.test(t,e);return i===!1?(this._consumable.get(t).set(e,!0),!0):i===!0?!1:null}verifyAllConsumed(t){const e=[];for(const[i,n]of this._consumable)for(const[r,o]of n){const l=r.split(":")[0];o&&t==l&&e.push({event:r,item:i.name||i.description})}if(e.length)throw new E("conversion-model-consumable-not-consumed",null,{items:e})}_getSymbolForTextProxy(t){let e=null;const i=this._textProxyRegistry.get(t.startOffset);if(i){const n=i.get(t.endOffset);n&&(e=n.get(t.parent))}return e||(e=this._addSymbolForTextProxy(t)),e}_addSymbolForTextProxy(t){const e=t.startOffset,i=t.endOffset,n=t.parent,r=Symbol("$textProxy:"+t.data);let o,l;return o=this._textProxyRegistry.get(e),o||(o=new Map,this._textProxyRegistry.set(e,o)),l=o.get(i),l||(l=new Map,o.set(i,l)),l.set(n,r),r}}function Zf(s){const t=s.split(":");return t[0]=="insert"?t[0]:t[0]=="addMarker"||t[0]=="removeMarker"?s:t.length>1?t[0]+":"+t[1]:t[0]}class gA extends pt(){constructor(e){super();p(this,"_conversionApi");p(this,"_firedEventsMap");this._conversionApi={dispatcher:this,...e},this._firedEventsMap=new WeakMap}convertChanges(e,i,n){const r=this._createConversionApi(n,e.getRefreshedItems());for(const l of e.getMarkersToRemove())this._convertMarkerRemove(l.name,l.range,r);const o=this._reduceChanges(e.getChanges());for(const l of o)l.type==="insert"?this._convertInsert(K._createFromPositionAndShift(l.position,l.length),r):l.type==="reinsert"?this._convertReinsert(K._createFromPositionAndShift(l.position,l.length),r):l.type==="remove"?this._convertRemove(l.position,l.length,l.name,r):this._convertAttribute(l.range,l.attributeKey,l.attributeOldValue,l.attributeNewValue,r);r.mapper.flushDeferredBindings();for(const l of r.mapper.flushUnboundMarkerNames()){const a=i.get(l).getRange();this._convertMarkerRemove(l,a,r),this._convertMarkerAdd(l,a,r)}for(const l of e.getMarkersToAdd())this._convertMarkerAdd(l.name,l.range,r);r.consumable.verifyAllConsumed("insert")}convert(e,i,n,r={}){const o=this._createConversionApi(n,void 0,r);this._convertInsert(e,o);for(const[l,a]of i)this._convertMarkerAdd(l,a,o);o.consumable.verifyAllConsumed("insert")}convertSelection(e,i,n){const r=this._createConversionApi(n);this.fire("cleanSelection",{selection:e},r);const o=e.getFirstPosition().root;if(!r.mapper.toViewElement(o))return;const l=Array.from(i.getMarkersAtPosition(e.getFirstPosition()));if(this._addConsumablesForSelection(r.consumable,e,l),this.fire("selection",{selection:e},r),!!e.isCollapsed){for(const a of l)if(r.consumable.test(e,"addMarker:"+a.name)){const c=a.getRange();if(!y8(e.getFirstPosition(),a,r.mapper))continue;const h={item:e,markerName:a.name,markerRange:c};this.fire(`addMarker:${a.name}`,h,r)}for(const a of e.getAttributeKeys())if(r.consumable.test(e,"attribute:"+a)){const c={item:e,range:e.getFirstRange(),attributeKey:a,attributeOldValue:null,attributeNewValue:e.getAttribute(a)};this.fire(`attribute:${a}:$text`,c,r)}}}_convertInsert(e,i,n={}){n.doNotAddConsumables||this._addConsumablesForInsert(i.consumable,e);for(const r of e.getWalker({shallow:!0}))this._testAndFire("insert",rC(r),i)}_convertRemove(e,i,n,r){this.fire(`remove:${n}`,{position:e,length:i},r)}_convertAttribute(e,i,n,r,o){this._addConsumablesForRange(o.consumable,e,`attribute:${i}`);for(const l of e){const a={item:l.item,range:K._createFromPositionAndShift(l.previousPosition,l.length),attributeKey:i,attributeOldValue:n,attributeNewValue:r};this._testAndFire(`attribute:${i}`,a,o)}}_convertReinsert(e,i){const n=Array.from(e.getWalker({shallow:!0}));this._addConsumablesForInsert(i.consumable,n);for(const r of n.map(rC))this._testAndFire("insert",{...r,reconversion:!0},i)}_convertMarkerAdd(e,i,n){if(i.root.rootName=="$graveyard")return;const r=`addMarker:${e}`;if(n.consumable.add(i,r),this.fire(r,{markerName:e,markerRange:i},n),!!n.consumable.consume(i,r)){this._addConsumablesForRange(n.consumable,i,r);for(const o of i.getItems()){if(!n.consumable.test(o,r))continue;const l={item:o,range:K._createOn(o),markerName:e,markerRange:i};this.fire(r,l,n)}}}_convertMarkerRemove(e,i,n){i.root.rootName!="$graveyard"&&this.fire(`removeMarker:${e}`,{markerName:e,markerRange:i},n)}_reduceChanges(e){const i={changes:e};return this.fire("reduceChanges",i),i.changes}_addConsumablesForInsert(e,i){for(const n of i){const r=n.item;if(e.test(r,"insert")===null){e.add(r,"insert");for(const o of r.getAttributeKeys())e.add(r,"attribute:"+o)}}return e}_addConsumablesForRange(e,i,n){for(const r of i.getItems())e.add(r,n);return e}_addConsumablesForSelection(e,i,n){e.add(i,"selection");for(const r of n)e.add(i,"addMarker:"+r.name);for(const r of i.getAttributeKeys())e.add(i,"attribute:"+r);return e}_testAndFire(e,i,n){const r=v8(e,i),o=i.item.is("$textProxy")?n.consumable._getSymbolForTextProxy(i.item):i.item,l=this._firedEventsMap.get(n),a=l.get(o);if(!a)l.set(o,new Set([r]));else if(!a.has(r))a.add(r);else return;this.fire(r,i,n)}_testAndFireAddAttributes(e,i){const n={item:e,range:K._createOn(e)};for(const r of n.item.getAttributeKeys())n.attributeKey=r,n.attributeOldValue=null,n.attributeNewValue=n.item.getAttribute(r),this._testAndFire(`attribute:${r}`,n,i)}_createConversionApi(e,i=new Set,n={}){const r={...this._conversionApi,consumable:new O8,writer:e,options:n,convertItem:o=>this._convertInsert(K._createOn(o),r),convertChildren:o=>this._convertInsert(K._createIn(o),r,{doNotAddConsumables:!0}),convertAttributes:o=>this._testAndFireAddAttributes(o,r),canReuseView:o=>!i.has(r.mapper.toModelElement(o))};return this._firedEventsMap.set(r,new Map),r}}function y8(s,t,e){const i=t.getRange(),n=Array.from(s.getAncestors());return n.shift(),n.reverse(),!n.some(o=>{if(i.containsItem(o))return!!e.toViewElement(o).getCustomProperty("addHighlight")})}function v8(s,t){const e=t.item.is("element")?t.item.name:"$text";return`${s}:${e}`}function rC(s){return{item:s.item,range:K._createFromPositionAndShift(s.previousPosition,s.length)}}let Fl=class extends Fo{constructor(e){super();p(this,"parent",null);p(this,"_attrs");p(this,"_index",null);p(this,"_startOffset",null);this._attrs=ms(e)}get document(){return null}get index(){return this._index}get startOffset(){return this._startOffset}get offsetSize(){return 1}get endOffset(){return this.startOffset===null?null:this.startOffset+this.offsetSize}get nextSibling(){const e=this.index;return e!==null&&this.parent.getChild(e+1)||null}get previousSibling(){const e=this.index;return e!==null&&this.parent.getChild(e-1)||null}get root(){let e=this;for(;e.parent;)e=e.parent;return e}isAttached(){return this.parent===null?!1:this.root.isAttached()}getPath(){const e=[];let i=this;for(;i.parent;)e.unshift(i.startOffset),i=i.parent;return e}getAncestors(e={}){const i=[];let n=e.includeSelf?this:this.parent;for(;n;)i[e.parentFirst?"push":"unshift"](n),n=n.parent;return i}getCommonAncestor(e,i={}){const n=this.getAncestors(i),r=e.getAncestors(i);let o=0;for(;n[o]==r[o]&&n[o];)o++;return o===0?null:n[o-1]}isBefore(e){if(this==e||this.root!==e.root)return!1;const i=this.getPath(),n=e.getPath(),r=Ni(i,n);switch(r){case"prefix":return!0;case"extension":return!1;default:return i[r]<n[r]}}isAfter(e){return this==e||this.root!==e.root?!1:!this.isBefore(e)}hasAttribute(e){return this._attrs.has(e)}getAttribute(e){return this._attrs.get(e)}getAttributes(){return this._attrs.entries()}getAttributeKeys(){return this._attrs.keys()}toJSON(){const e={};return this._attrs.size&&(e.attributes=Array.from(this._attrs).reduce((i,n)=>(i[n[0]]=n[1],i),{})),e}_clone(e){return new this.constructor(this._attrs)}_remove(){this.parent._removeChildren(this.index)}_setAttribute(e,i){this._attrs.set(e,i)}_setAttributesTo(e){this._attrs=ms(e)}_removeAttribute(e){return this._attrs.delete(e)}_clearAttributes(){this._attrs.clear()}};Fl.prototype.is=function(s){return s==="node"||s==="model:node"};class Qn extends pt(Fo){constructor(...e){super();p(this,"_lastRangeBackward",!1);p(this,"_attrs",new Map);p(this,"_ranges",[]);e.length&&this.setTo(...e)}get anchor(){if(this._ranges.length>0){const e=this._ranges[this._ranges.length-1];return this._lastRangeBackward?e.end:e.start}return null}get focus(){if(this._ranges.length>0){const e=this._ranges[this._ranges.length-1];return this._lastRangeBackward?e.start:e.end}return null}get isCollapsed(){return this._ranges.length===1?this._ranges[0].isCollapsed:!1}get rangeCount(){return this._ranges.length}get isBackward(){return!this.isCollapsed&&this._lastRangeBackward}isEqual(e){if(this.rangeCount!=e.rangeCount)return!1;if(this.rangeCount===0)return!0;if(!this.anchor.isEqual(e.anchor)||!this.focus.isEqual(e.focus))return!1;for(const i of this._ranges){let n=!1;for(const r of e._ranges)if(i.isEqual(r)){n=!0;break}if(!n)return!1}return!0}*getRanges(){for(const e of this._ranges)yield new K(e.start,e.end)}getFirstRange(){let e=null;for(const i of this._ranges)(!e||i.start.isBefore(e.start))&&(e=i);return e?new K(e.start,e.end):null}getLastRange(){let e=null;for(const i of this._ranges)(!e||i.end.isAfter(e.end))&&(e=i);return e?new K(e.start,e.end):null}getFirstPosition(){const e=this.getFirstRange();return e?e.start.clone():null}getLastPosition(){const e=this.getLastRange();return e?e.end.clone():null}setTo(...e){let[i,n,r]=e;if(typeof n=="object"&&(r=n,n=void 0),i===null)this._setRanges([]);else if(i instanceof Qn)this._setRanges(i.getRanges(),i.isBackward);else if(i&&typeof i.getRanges=="function")this._setRanges(i.getRanges(),i.isBackward);else if(i instanceof K)this._setRanges([i],!!r&&!!r.backward);else if(i instanceof ne)this._setRanges([new K(i)]);else if(i instanceof Fl){const o=!!r&&!!r.backward;let l;if(n=="in")l=K._createIn(i);else if(n=="on")l=K._createOn(i);else if(n!==void 0)l=new K(ne._createAt(i,n));else throw new E("model-selection-setto-required-second-parameter",[this,i]);this._setRanges([l],o)}else if(Wn(i))this._setRanges(i,r&&!!r.backward);else throw new E("model-selection-setto-not-selectable",[this,i])}_setRanges(e,i=!1){const n=Array.from(e),r=n.some(o=>{if(!(o instanceof K))throw new E("model-selection-set-ranges-not-range",[this,e]);return this._ranges.every(l=>!l.isEqual(o))});n.length===this._ranges.length&&!r||(this._replaceAllRanges(n),this._lastRangeBackward=!!i,this.fire("change:range",{directChange:!0}))}setFocus(e,i){if(this.anchor===null)throw new E("model-selection-setfocus-no-ranges",[this,e]);const n=ne._createAt(e,i);if(n.compareWith(this.focus)=="same")return;const r=this.anchor;this._ranges.length&&this._popRange(),n.compareWith(r)=="before"?(this._pushRange(new K(n,r)),this._lastRangeBackward=!0):(this._pushRange(new K(r,n)),this._lastRangeBackward=!1),this.fire("change:range",{directChange:!0})}getAttribute(e){return this._attrs.get(e)}getAttributes(){return this._attrs.entries()}getAttributeKeys(){return this._attrs.keys()}hasAttribute(e){return this._attrs.has(e)}removeAttribute(e){this.hasAttribute(e)&&(this._attrs.delete(e),this.fire("change:attribute",{attributeKeys:[e],directChange:!0}))}setAttribute(e,i){this.getAttribute(e)!==i&&(this._attrs.set(e,i),this.fire("change:attribute",{attributeKeys:[e],directChange:!0}))}getSelectedElement(){return this.rangeCount!==1?null:this.getFirstRange().getContainedElement()}*getSelectedBlocks(){const e=new WeakSet;for(const i of this.getRanges()){const n=oC(i.start,e);k8(n,i)&&(yield n);const r=i.getWalker();for(const l of r){const a=l.item;l.type=="elementEnd"&&_8(a,e,i)?yield a:l.type=="elementStart"&&a.is("model:element")&&a.root.document.model.schema.isBlock(a)&&r.jumpTo(ne._createAt(a,"end"))}const o=oC(i.end,e);S8(o,i)&&(yield o)}}containsEntireContent(e=this.anchor.root){const i=ne._createAt(e,0),n=ne._createAt(e,"end");return i.isTouching(this.getFirstPosition())&&n.isTouching(this.getLastPosition())}_pushRange(e){this._checkRange(e),this._ranges.push(new K(e.start,e.end))}_checkRange(e){for(let i=0;i<this._ranges.length;i++)if(e.isIntersecting(this._ranges[i]))throw new E("model-selection-range-intersects",[this,e],{addedRange:e,intersectingRange:this._ranges[i]})}_replaceAllRanges(e){this._removeAllRanges();for(const i of e)this._pushRange(i)}_removeAllRanges(){for(;this._ranges.length>0;)this._popRange()}_popRange(){this._ranges.pop()}}Qn.prototype.is=function(s){return s==="selection"||s==="model:selection"};function pA(s,t){return t.has(s)?!1:(t.add(s),s.root.document.model.schema.isBlock(s)&&!!s.parent)}function _8(s,t,e){return pA(s,t)&&HO(s,e)}function oC(s,t){const i=s.parent.root.document.model.schema,n=s.parent.getAncestors({parentFirst:!0,includeSelf:!0});let r=!1;const o=n.find(l=>r?!1:(r=i.isLimit(l),!r&&pA(l,t)));return n.forEach(l=>t.add(l)),o}function HO(s,t){const e=C8(s);return e?!t.containsRange(K._createOn(e),!0):!0}function k8(s,t){return s?t.isCollapsed||s.isEmpty?!0:t.start.isTouching(ne._createAt(s,s.maxOffset))?!1:HO(s,t):!1}function S8(s,t){return s?t.isCollapsed||s.isEmpty?!0:t.end.isTouching(ne._createAt(s,0))?!1:HO(s,t):!1}function C8(s){const t=s.root.document.model.schema;let e=s.parent;for(;e;){if(t.isBlock(e))return e;e=e.parent}}class bn extends pt(K){constructor(t,e){super(t,e),P8.call(this)}detach(){this.stopListening()}toRange(){return new K(this.start,this.end)}static fromRange(t){return new bn(t.start,t.end)}}bn.prototype.is=function(s){return s==="liveRange"||s==="model:liveRange"||s=="range"||s==="model:range"};function P8(){this.listenTo(this.root.document.model,"applyOperation",(s,t)=>{const e=t[0];e.isDocumentOperation&&T8.call(this,e)},{priority:"low"})}function T8(s){const t=this.getTransformedByOperation(s),e=K._createFromRanges(t),i=!e.isEqual(this),n=E8(this,s);let r=null;if(i){e.root.rootName=="$graveyard"&&(s.type=="remove"?r=s.sourcePosition:r=s.deletionPosition);const o=this.toRange();this.start=e.start,this.end=e.end,this.fire("change:range",o,{deletionPosition:r})}else n&&this.fire("change:content",this.toRange(),{deletionPosition:r})}function E8(s,t){switch(t.type){case"insert":return s.containsPosition(t.position);case"move":case"remove":case"reinsert":case"merge":return s.containsPosition(t.sourcePosition)||s.start.isEqual(t.sourcePosition)||s.containsPosition(t.targetPosition);case"split":return s.containsPosition(t.splitPosition)||s.containsPosition(t.insertionPosition)}return!1}let Nt=class Lb extends Fl{constructor(e,i){super(i);p(this,"_data");this._data=e||""}get offsetSize(){return this.data.length}get data(){return this._data}toJSON(){const e=super.toJSON();return e.data=this.data,e}_clone(){return new Lb(this.data,this.getAttributes())}static fromJSON(e){return new Lb(e.data,e.attributes)}};Nt.prototype.is=function(s){return s==="$text"||s==="model:$text"||s==="text"||s==="model:text"||s==="node"||s==="model:node"};const Ph="selection:";class Bs extends pt(Fo){constructor(e){super();p(this,"_selection");this._selection=new A8(e),this._selection.delegate("change:range").to(this),this._selection.delegate("change:attribute").to(this),this._selection.delegate("change:marker").to(this)}get isCollapsed(){return this._selection.isCollapsed}get anchor(){return this._selection.anchor}get focus(){return this._selection.focus}get rangeCount(){return this._selection.rangeCount}get hasOwnRange(){return this._selection.hasOwnRange}get isBackward(){return this._selection.isBackward}get isGravityOverridden(){return this._selection.isGravityOverridden}get markers(){return this._selection.markers}get _ranges(){return this._selection._ranges}getRanges(){return this._selection.getRanges()}getFirstPosition(){return this._selection.getFirstPosition()}getLastPosition(){return this._selection.getLastPosition()}getFirstRange(){return this._selection.getFirstRange()}getLastRange(){return this._selection.getLastRange()}getSelectedBlocks(){return this._selection.getSelectedBlocks()}getSelectedElement(){return this._selection.getSelectedElement()}containsEntireContent(e){return this._selection.containsEntireContent(e)}destroy(){this._selection.destroy()}getAttributeKeys(){return this._selection.getAttributeKeys()}getAttributes(){return this._selection.getAttributes()}getAttribute(e){return this._selection.getAttribute(e)}hasAttribute(e){return this._selection.hasAttribute(e)}refresh(){this._selection.updateMarkers(),this._selection._updateAttributes(!1)}observeMarkers(e){this._selection.observeMarkers(e)}_setFocus(e,i){this._selection.setFocus(e,i)}_setTo(...e){this._selection.setTo(...e)}_setAttribute(e,i){this._selection.setAttribute(e,i)}_removeAttribute(e){this._selection.removeAttribute(e)}_getStoredAttributes(){return this._selection.getStoredAttributes()}_overrideGravity(){return this._selection.overrideGravity()}_restoreGravity(e){this._selection.restoreGravity(e)}static _getStoreAttributeKey(e){return Ph+e}static _isStoreAttributeKey(e){return e.startsWith(Ph)}}Bs.prototype.is=function(s){return s==="selection"||s=="model:selection"||s=="documentSelection"||s=="model:documentSelection"};class A8 extends Qn{constructor(e){super();p(this,"markers",new di({idProperty:"name"}));p(this,"_model");p(this,"_document");p(this,"_attributePriority",new Map);p(this,"_selectionRestorePosition",null);p(this,"_hasChangedRange",!1);p(this,"_overriddenGravityRegister",new Set);p(this,"_observedMarkers",new Set);this._model=e.model,this._document=e,this.listenTo(this._model,"applyOperation",(i,n)=>{const r=n[0];!r.isDocumentOperation||r.type=="marker"||r.type=="rename"||r.type=="noop"||(this._ranges.length==0&&this._selectionRestorePosition&&this._fixGraveyardSelection(this._selectionRestorePosition),this._selectionRestorePosition=null,this._hasChangedRange&&(this._hasChangedRange=!1,this.fire("change:range",{directChange:!1})))},{priority:"lowest"}),this.on("change:range",()=>{this._validateSelectionRanges(this.getRanges())}),this.listenTo(this._model.markers,"update",(i,n,r,o)=>{this._updateMarker(n,o)}),this.listenTo(this._document,"change",(i,n)=>{I8(this._model,n)})}get isCollapsed(){return this._ranges.length===0?this._document._getDefaultRange().isCollapsed:super.isCollapsed}get anchor(){return super.anchor||this._document._getDefaultRange().start}get focus(){return super.focus||this._document._getDefaultRange().end}get rangeCount(){return this._ranges.length?this._ranges.length:1}get hasOwnRange(){return this._ranges.length>0}get isGravityOverridden(){return!!this._overriddenGravityRegister.size}destroy(){for(let e=0;e<this._ranges.length;e++)this._ranges[e].detach();this.stopListening()}*getRanges(){this._ranges.length?yield*super.getRanges():yield this._document._getDefaultRange()}getFirstRange(){return super.getFirstRange()||this._document._getDefaultRange()}getLastRange(){return super.getLastRange()||this._document._getDefaultRange()}setTo(...e){super.setTo(...e),this._updateAttributes(!0),this.updateMarkers()}setFocus(e,i){super.setFocus(e,i),this._updateAttributes(!0),this.updateMarkers()}setAttribute(e,i){if(this._setAttribute(e,i)){const n=[e];this.fire("change:attribute",{attributeKeys:n,directChange:!0})}}removeAttribute(e){if(this._removeAttribute(e)){const i=[e];this.fire("change:attribute",{attributeKeys:i,directChange:!0})}}overrideGravity(){const e=ei();return this._overriddenGravityRegister.add(e),this._overriddenGravityRegister.size===1&&this._updateAttributes(!0),e}restoreGravity(e){if(!this._overriddenGravityRegister.has(e))throw new E("document-selection-gravity-wrong-restore",this,{uid:e});this._overriddenGravityRegister.delete(e),this.isGravityOverridden||this._updateAttributes(!0)}observeMarkers(e){this._observedMarkers.add(e),this.updateMarkers()}_replaceAllRanges(e){this._validateSelectionRanges(e),super._replaceAllRanges(e)}_popRange(){this._ranges.pop().detach()}_pushRange(e){const i=this._prepareRange(e);i&&this._ranges.push(i)}_validateSelectionRanges(e){for(const i of e)if(!this._document._validateSelectionRange(i))throw new E("document-selection-wrong-position",this,{range:i})}_prepareRange(e){if(this._checkRange(e),e.root==this._document.graveyard)return;const i=bn.fromRange(e);return i.on("change:range",(n,r,o)=>{if(this._hasChangedRange=!0,i.root==this._document.graveyard){this._selectionRestorePosition=o.deletionPosition;const l=this._ranges.indexOf(i);this._ranges.splice(l,1),i.detach()}}),i}updateMarkers(){if(!this._observedMarkers.size)return;const e=[];let i=!1;for(const r of this._model.markers){const o=r.name.split(":",1)[0];if(!this._observedMarkers.has(o))continue;const l=r.getRange();for(const a of this.getRanges())l.containsRange(a,!a.isCollapsed)&&e.push(r)}const n=Array.from(this.markers);for(const r of e)this.markers.has(r)||(this.markers.add(r),i=!0);for(const r of Array.from(this.markers))e.includes(r)||(this.markers.remove(r),i=!0);i&&this.fire("change:marker",{oldMarkers:n,directChange:!1})}_updateMarker(e,i){const n=e.name.split(":",1)[0];if(!this._observedMarkers.has(n))return;let r=!1;const o=Array.from(this.markers),l=this.markers.has(e);if(!i)l&&(this.markers.remove(e),r=!0);else{let a=!1;for(const c of this.getRanges())if(i.containsRange(c,!c.isCollapsed)){a=!0;break}a&&!l?(this.markers.add(e),r=!0):!a&&l&&(this.markers.remove(e),r=!0)}r&&this.fire("change:marker",{oldMarkers:o,directChange:!1})}_updateAttributes(e){const i=ms(this._getSurroundingAttributes()),n=ms(this.getAttributes());if(e)this._attributePriority=new Map,this._attrs=new Map;else for(const[o,l]of this._attributePriority)l=="low"&&(this._attrs.delete(o),this._attributePriority.delete(o));this._setAttributesTo(i);const r=[];for(const[o,l]of this.getAttributes())(!n.has(o)||n.get(o)!==l)&&r.push(o);for(const[o]of n)this.hasAttribute(o)||r.push(o);r.length>0&&this.fire("change:attribute",{attributeKeys:r,directChange:!1})}_setAttribute(e,i,n=!0){const r=n?"normal":"low";return r=="low"&&this._attributePriority.get(e)=="normal"||super.getAttribute(e)===i?!1:(this._attrs.set(e,i),this._attributePriority.set(e,r),!0)}_removeAttribute(e,i=!0){const n=i?"normal":"low";return n=="low"&&this._attributePriority.get(e)=="normal"||(this._attributePriority.set(e,n),!super.hasAttribute(e))?!1:(this._attrs.delete(e),!0)}_setAttributesTo(e){const i=new Set;for(const[n,r]of this.getAttributes())e.get(n)!==r&&this._removeAttribute(n,!1);for(const[n,r]of e)this._setAttribute(n,r,!1)&&i.add(n);return i}*getStoredAttributes(){const e=this.getFirstPosition().parent;if(this.isCollapsed&&e.isEmpty)for(const i of e.getAttributeKeys())i.startsWith(Ph)&&(yield[i.substr(Ph.length),e.getAttribute(i)])}_getSurroundingAttributes(){const e=this.getFirstPosition(),i=this._model.schema;if(e.root.rootName=="$graveyard")return null;let n=null;if(this.isCollapsed){const r=e.textNode?e.textNode:e.nodeBefore,o=e.textNode?e.textNode:e.nodeAfter;if(this.isGravityOverridden||(n=Eu(r,i)),n||(n=Eu(o,i)),!this.isGravityOverridden&&!n){let l=r;for(;l&&!n;)l=l.previousSibling,n=Eu(l,i)}if(!n){let l=o;for(;l&&!n;)l=l.nextSibling,n=Eu(l,i)}n||(n=this.getStoredAttributes())}else{const r=this.getFirstRange();for(const o of r){if(o.item.is("element")&&i.isObject(o.item)){n=Eu(o.item,i);break}if(o.type=="text"){n=o.item.getAttributes();break}}}return n}_fixGraveyardSelection(e){const i=this._model.schema.getNearestSelectionRange(e);i&&this._pushRange(i)}}function Eu(s,t){if(!s)return null;if(s instanceof Ms||s instanceof Nt)return s.getAttributes();if(!t.isInline(s))return null;if(!t.isObject(s))return[];const e=[];for(const[i,n]of s.getAttributes())t.checkAttribute("$text",i)&&t.getAttributeProperties(i).copyFromObject!==!1&&e.push([i,n]);return e}function I8(s,t){const e=s.document.differ;for(const i of e.getChanges()){if(i.type!="insert")continue;const n=i.position.parent;i.length===n.maxOffset&&s.enqueueChange(t,o=>{const l=Array.from(n.getAttributeKeys()).filter(a=>a.startsWith(Ph));for(const a of l)o.removeAttribute(a,n)})}}class uh{constructor(t){p(this,"_nodes",[]);p(this,"_offsetToNode",[]);t&&this._insertNodes(0,t)}[Symbol.iterator](){return this._nodes[Symbol.iterator]()}get length(){return this._nodes.length}get maxOffset(){return this._offsetToNode.length}getNode(t){return this._nodes[t]||null}getNodeAtOffset(t){return this._offsetToNode[t]||null}getNodeIndex(t){return t.index}getNodeStartOffset(t){return t.startOffset}indexToOffset(t){if(t==this._nodes.length)return this.maxOffset;const e=this._nodes[t];if(!e)throw new E("model-nodelist-index-out-of-bounds",this);return this.getNodeStartOffset(e)}offsetToIndex(t){if(t==this._offsetToNode.length)return this._nodes.length;const e=this._offsetToNode[t];if(!e)throw new E("model-nodelist-offset-out-of-bounds",this,{offset:t,nodeList:this});return this.getNodeIndex(e)}_insertNodes(t,e){const i=[];for(const r of e){if(!(r instanceof Fl))throw new E("model-nodelist-insertnodes-not-node",this);i.push(r)}let n=this.indexToOffset(t);WS(this._nodes,i,t),WS(this._offsetToNode,R8(i),n);for(let r=t;r<this._nodes.length;r++)this._nodes[r]._index=r,this._nodes[r]._startOffset=n,n+=this._nodes[r].offsetSize}_removeNodes(t,e=1){if(e==0)return[];let i=this.indexToOffset(t);const n=this._nodes.splice(t,e),r=n[n.length-1],o=r.startOffset+r.offsetSize-i;this._offsetToNode.splice(i,o);for(const l of n)l._index=null,l._startOffset=null;for(let l=t;l<this._nodes.length;l++)this._nodes[l]._index=l,this._nodes[l]._startOffset=i,i+=this._nodes[l].offsetSize;return n}_removeNodesArray(t){if(t.length==0)return;for(const i of t)i._index=null,i._startOffset=null;this._nodes=this._nodes.filter(i=>i.index!==null),this._offsetToNode=this._offsetToNode.filter(i=>i.index!==null);let e=0;for(let i=0;i<this._nodes.length;i++)this._nodes[i]._index=i,this._nodes[i]._startOffset=e,e+=this._nodes[i].offsetSize}toJSON(){return this._nodes.map(t=>t.toJSON())}}function R8(s){const t=[];let e=0;for(const i of s)for(let n=0;n<i.offsetSize;n++)t[e++]=i;return t}let Mt=class Mm extends Fl{constructor(e,i,n){super(i);p(this,"name");p(this,"_children",new uh);this.name=e,n&&this._insertChild(0,n)}get childCount(){return this._children.length}get maxOffset(){return this._children.maxOffset}get isEmpty(){return this.childCount===0}getChild(e){return this._children.getNode(e)}getChildAtOffset(e){return this._children.getNodeAtOffset(e)}getChildren(){return this._children[Symbol.iterator]()}getChildIndex(e){return this._children.getNodeIndex(e)}getChildStartOffset(e){return this._children.getNodeStartOffset(e)}offsetToIndex(e){return this._children.offsetToIndex(e)}getNodeByPath(e){let i=this;for(const n of e)i=i.getChildAtOffset(n);return i}findAncestor(e,i={}){let n=i.includeSelf?this:this.parent;for(;n;){if(n.name===e)return n;n=n.parent}return null}toJSON(){const e=super.toJSON();if(e.name=this.name,this._children.length>0){e.children=[];for(const i of this._children)e.children.push(i.toJSON())}return e}_clone(e=!1){const i=e?M8(this._children):void 0;return new Mm(this.name,this.getAttributes(),i)}_appendChild(e){this._insertChild(this.childCount,e)}_insertChild(e,i){const n=V8(i);for(const r of n)r.parent!==null&&r._remove(),r.parent=this;this._children._insertNodes(e,n)}_removeChildren(e,i=1){const n=this._children._removeNodes(e,i);for(const r of n)r.parent=null;return n}_removeChildrenArray(e){this._children._removeNodesArray(e);for(const i of e)i.parent=null}static fromJSON(e){let i;if(e.children){i=[];for(const n of e.children)n.name?i.push(Mm.fromJSON(n)):i.push(Nt.fromJSON(n))}return new Mm(e.name,e.attributes,i)}};Mt.prototype.is=function(s,t){return t?t===this.name&&(s==="element"||s==="model:element"):s==="element"||s==="model:element"||s==="node"||s==="model:node"};function V8(s){if(typeof s=="string")return[new Nt(s)];Wn(s)||(s=[s]);const t=[];for(const e of s)typeof e=="string"?t.push(new Nt(e)):e instanceof Ms?t.push(new Nt(e.data,e.getAttributes())):t.push(e);return t}function M8(s){const t=[];for(const e of s)t.push(e._clone(!0));return t}/**
 * @license Copyright (c) 2003-2025, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options
 */class wA{constructor(t){p(this,"_dispatchers");this._dispatchers=t}add(t){for(const e of this._dispatchers)t(e);return this}}class L8 extends wA{elementToElement(t){return this.add(J8(t))}elementToStructure(t){return this.add(eQ(t))}attributeToElement(t){return this.add(tQ(t))}attributeToAttribute(t){return this.add(iQ(t))}markerToElement(t){return this.add(nQ(t))}markerToHighlight(t){return this.add(rQ(t))}markerToData(t){return this.add(sQ(t))}}function xA(){return(s,t,e)=>{if(!e.consumable.consume(t.item,s.name))return;const i=e.writer,n=e.mapper.toViewPosition(t.range.start),r=i.createText(t.item.data);i.insert(n,r)}}function bA(){return(s,t,e)=>{e.convertAttributes(t.item),!t.reconversion&&t.item.is("element")&&!t.item.isEmpty&&e.convertChildren(t.item)}}function B8(){return(s,t,e)=>{const i=e.mapper.toViewPosition(t.position),n=t.position.getShiftedBy(t.length),r=e.mapper.toViewPosition(n,{isPhantom:!0}),o=e.writer.createRange(i,r),l=e.writer.remove(o.getTrimmed());for(const a of e.writer.createRangeIn(l).getItems())e.mapper.unbindViewElement(a,{defer:!0})}}function OA(s,t){const e=s.createAttributeElement("span",t.attributes);return t.classes&&e._addClass(t.classes),typeof t.priority=="number"&&(e._priority=t.priority),e._id=t.id,e}function $8(){return(s,t,e)=>{const i=t.selection;if(i.isCollapsed||!e.consumable.consume(i,"selection"))return;const n=[];for(const r of i.getRanges())n.push(e.mapper.toViewRange(r));e.writer.setSelection(n,{backward:i.isBackward})}}function D8(){return(s,t,e)=>{const i=t.selection;if(!i.isCollapsed||!e.consumable.consume(i,"selection"))return;const n=e.writer,r=i.getFirstPosition(),o=e.mapper.toViewPosition(r),l=n.breakAttributes(o);n.setSelection(l)}}function Q8(){return(s,t,e)=>{const i=e.writer,n=i.document.selection;for(const r of n.getRanges())r.isCollapsed&&r.end.parent.isAttached()&&e.writer.mergeAttributes(r.start);i.setSelection(null)}}function N8(s){return(t,e,i)=>{if(!i.consumable.test(e.item,t.name))return;const n=s(e.attributeOldValue,i,e),r=s(e.attributeNewValue,i,e);if(!n&&!r)return;i.consumable.consume(e.item,t.name);const o=i.writer,l=o.document.selection;if(e.item instanceof Qn||e.item instanceof Bs)o.wrap(l.getFirstRange(),r);else{let a=i.mapper.toViewRange(e.range);e.attributeOldValue!==null&&n&&(a=o.unwrap(a,n)),e.attributeNewValue!==null&&r&&o.wrap(a,r)}}}function F8(s,t=dQ){return(e,i,n)=>{if(!t(i.item,n.consumable,{preflight:!0}))return;const r=s(i.item,n,i);if(!r)return;t(i.item,n.consumable);const o=n.mapper.toViewPosition(i.range.start);n.mapper.bindElements(i.item,r),n.writer.insert(o,r),n.convertAttributes(i.item),SA(r,i.item.getChildren(),n,{reconversion:i.reconversion})}}function z8(s,t){return(e,i,n)=>{if(!t(i.item,n.consumable,{preflight:!0}))return;const r=new Map;n.writer._registerSlotFactory(aQ(i.item,r,n));const o=s(i.item,n,i);if(n.writer._clearSlotFactory(),!o)return;cQ(i.item,r,n),t(i.item,n.consumable);const l=n.mapper.toViewPosition(i.range.start);n.mapper.bindElements(i.item,o),n.writer.insert(l,o),n.convertAttributes(i.item),uQ(o,r,n,{reconversion:i.reconversion})}}function W8(s){return(t,e,i)=>{e.isOpening=!0;const n=s(e,i);e.isOpening=!1;const r=s(e,i);if(!n||!r)return;const o=e.markerRange;if(o.isCollapsed&&!i.consumable.consume(o,t.name))return;for(const c of o)if(!i.consumable.consume(c.item,t.name))return;const l=i.mapper,a=i.writer;a.insert(l.toViewPosition(o.start),n),i.mapper.bindElementToMarker(n,e.markerName),o.isCollapsed||(a.insert(l.toViewPosition(o.end),r),i.mapper.bindElementToMarker(r,e.markerName)),t.stop()}}function U8(){return(s,t,e)=>{const i=e.mapper.markerNameToElements(t.markerName);if(i){for(const n of i)e.mapper.unbindElementFromMarkerName(n,t.markerName),e.writer.clear(e.writer.createRangeOn(n),n);e.writer.clearClonedElementsGroup(t.markerName),s.stop()}}}function Z8(s){return(t,e,i)=>{const n=s(e.markerName,i);if(!n)return;const r=e.markerRange;i.consumable.consume(r,t.name)&&(lC(r,!1,i,e,n),lC(r,!0,i,e,n),t.stop())}}function lC(s,t,e,i,n){const r=t?s.start:s.end,o=r.nodeAfter&&r.nodeAfter.is("element")?r.nodeAfter:null,l=r.nodeBefore&&r.nodeBefore.is("element")?r.nodeBefore:null;if(o||l){let c,h;t&&o||!t&&!l?(c=o,h=!0):(c=l,h=!1);const f=e.mapper.toViewElement(c);if(f){H8(f,t,h,e,i,n);return}}const a=e.mapper.toViewPosition(r);q8(a,t,e,i,n)}function H8(s,t,e,i,n,r){const o=`data-${r.group}-${t?"start":"end"}-${e?"before":"after"}`,l=s.hasAttribute(o)?s.getAttribute(o).split(","):[];l.unshift(r.name),i.writer.setAttribute(o,l.join(","),s),i.mapper.bindElementToMarker(s,n.markerName)}function q8(s,t,e,i,n){const r=`${n.group}-${t?"start":"end"}`,o=n.name?{name:n.name}:null,l=e.writer.createUIElement(r,o);e.writer.insert(s,l),e.mapper.bindElementToMarker(l,i.markerName)}function j8(s){return(t,e,i)=>{const n=s(e.markerName,i);if(!n)return;const r=i.mapper.markerNameToElements(e.markerName);if(!r)return;for(const l of r)i.mapper.unbindElementFromMarkerName(l,e.markerName),l.is("containerElement")?(o(`data-${n.group}-start-before`,l),o(`data-${n.group}-start-after`,l),o(`data-${n.group}-end-before`,l),o(`data-${n.group}-end-after`,l)):i.writer.clear(i.writer.createRangeOn(l),l);i.writer.clearClonedElementsGroup(e.markerName),t.stop();function o(l,a){if(a.hasAttribute(l)){const c=new Set(a.getAttribute(l).split(","));c.delete(n.name),c.size==0?i.writer.removeAttribute(l,a):i.writer.setAttribute(l,Array.from(c).join(","),a)}}}}function X8(s){return(t,e,i)=>{if(!i.consumable.test(e.item,t.name))return;const n=s(e.attributeOldValue,i,e),r=s(e.attributeNewValue,i,e);if(!n&&!r)return;i.consumable.consume(e.item,t.name);const o=i.mapper.toViewElement(e.item),l=i.writer;if(!o)throw new E("conversion-attribute-to-attribute-on-text",i.dispatcher,e);if(e.attributeOldValue!==null&&n){let a=n.value;n.key=="style"&&(typeof n.value=="string"?a=new nc(l.document.stylesProcessor).setTo(n.value).getStylesEntries().map(([c])=>c):a=Object.keys(n.value)),l.removeAttribute(n.key,a,o)}if(e.attributeNewValue!==null&&r){let a=r.value;r.key=="style"&&typeof r.value=="string"&&(a=Object.fromEntries(new nc(l.document.stylesProcessor).setTo(r.value).getStylesEntries())),l.setAttribute(r.key,a,!1,o)}}}function G8(s){return(t,e,i)=>{if(!e.item||!(e.item instanceof Qn||e.item instanceof Bs)&&!e.item.is("$textProxy"))return;const n=qO(s,e,i);if(!n||!i.consumable.consume(e.item,t.name))return;const r=i.writer,o=OA(r,n),l=r.document.selection;if(e.item instanceof Qn||e.item instanceof Bs)r.wrap(l.getFirstRange(),o);else{const a=i.mapper.toViewRange(e.range),c=r.wrap(a,o);for(const h of c.getItems())if(h.is("attributeElement")&&h.isSimilar(o)){i.mapper.bindElementToMarker(h,e.markerName);break}}}}function Y8(s){return(t,e,i)=>{if(!e.item||!(e.item instanceof Mt))return;const n=qO(s,e,i);if(!n||!i.consumable.test(e.item,t.name))return;const r=i.mapper.toViewElement(e.item);if(r&&r.getCustomProperty("addHighlight")){i.consumable.consume(e.item,t.name);for(const l of K._createIn(e.item))i.consumable.consume(l.item,t.name);r.getCustomProperty("addHighlight")(r,n,i.writer),i.mapper.bindElementToMarker(r,e.markerName)}}}function K8(s){return(t,e,i)=>{if(e.markerRange.isCollapsed)return;const n=qO(s,e,i);if(!n)return;const r=OA(i.writer,n),o=i.mapper.markerNameToElements(e.markerName);if(o){for(const l of o)i.mapper.unbindElementFromMarkerName(l,e.markerName),l.is("attributeElement")?i.writer.unwrap(i.writer.createRangeOn(l),r):l.getCustomProperty("removeHighlight")(l,n.id,i.writer);i.writer.clearClonedElementsGroup(e.markerName),t.stop()}}}function J8(s){const t=yA(s.model),e=Th(s.view,"container");return t.attributes.length&&(t.children=!0),i=>{i.on(`insert:${t.name}`,F8(e,kA(t)),{priority:s.converterPriority||"normal"}),(t.children||t.attributes.length)&&i.on("reduceChanges",_A(t),{priority:"low"})}}function eQ(s){const t=yA(s.model),e=Th(s.view,"container");return t.children=!0,i=>{if(i._conversionApi.schema.checkChild(t.name,"$text"))throw new E("conversion-element-to-structure-disallowed-text",i,{elementName:t.name});i.on(`insert:${t.name}`,z8(e,kA(t)),{priority:s.converterPriority||"normal"}),i.on("reduceChanges",_A(t),{priority:"low"})}}function tQ(s){s=_n(s);let t=s.model;typeof t=="string"&&(t={key:t});let e=`attribute:${t.key}`;if(t.name&&(e+=":"+t.name),t.values)for(const n of t.values)s.view[n]=Th(s.view[n],"attribute");else s.view=Th(s.view,"attribute");const i=vA(s);return n=>{n.on(e,N8(i),{priority:s.converterPriority||"normal"})}}function iQ(s){s=_n(s);let t=s.model;typeof t=="string"&&(t={key:t});let e=`attribute:${t.key}`;if(t.name&&(e+=":"+t.name),t.values)for(const n of t.values)s.view[n]=aC(s.view[n]);else s.view=aC(s.view);const i=vA(s);return n=>{n.on(e,X8(i),{priority:s.converterPriority||"normal"})}}function nQ(s){const t=Th(s.view,"ui");return e=>{e.on(`addMarker:${s.model}`,W8(t),{priority:s.converterPriority||"normal"}),e.on(`removeMarker:${s.model}`,U8(),{priority:s.converterPriority||"normal"})}}function sQ(s){s=_n(s);const t=s.model;let e=s.view;return e||(e=i=>({group:t,name:i.substr(s.model.length+1)})),i=>{i.on(`addMarker:${t}`,Z8(e),{priority:s.converterPriority||"normal"}),i.on(`removeMarker:${t}`,j8(e),{priority:s.converterPriority||"normal"})}}function rQ(s){return t=>{t.on(`addMarker:${s.model}`,G8(s.view),{priority:s.converterPriority||"normal"}),t.on(`addMarker:${s.model}`,Y8(s.view),{priority:s.converterPriority||"normal"}),t.on(`removeMarker:${s.model}`,K8(s.view),{priority:s.converterPriority||"normal"})}}function yA(s){return typeof s=="string"&&(s={name:s}),{name:s.name,attributes:s.attributes?dt(s.attributes):[],children:!!s.children}}function Th(s,t){return typeof s=="function"?s:(e,i)=>oQ(s,i,t)}function oQ(s,t,e){typeof s=="string"&&(s={name:s});let i;const n=t.writer,r=Object.assign({},s.attributes);if(e=="container")i=n.createContainerElement(s.name,r);else if(e=="attribute"){const o={priority:s.priority||vl.DEFAULT_PRIORITY};i=n.createAttributeElement(s.name,r,o)}else i=n.createUIElement(s.name,r);if(s.styles){const o=Object.keys(s.styles);for(const l of o)n.setStyle(l,s.styles[l],i)}if(s.classes){const o=s.classes;if(typeof o=="string")n.addClass(o,i);else for(const l of o)n.addClass(l,i)}return i}function vA(s){return s.model.values?(t,e,i)=>{const n=s.view[t];return n?n(t,e,i):null}:s.view}function aC(s){return typeof s=="string"?t=>({key:s,value:t}):typeof s=="object"?s.value?()=>s:t=>({key:s.key,value:t}):s}function qO(s,t,e){const i=typeof s=="function"?s(t,e):s;return i?(i.priority||(i.priority=10),i.id||(i.id=t.markerName),i):null}function lQ(s){return(t,e)=>{if(!t.is("element",s.name))return!1;if(e.type=="attribute"){if(s.attributes.includes(e.attributeKey))return!0}else{/* istanbul ignore else: This is always true because otherwise it would not register a reducer callback. -- @preserve */if(s.children)return!0}return!1}}function _A(s){const t=lQ(s);return(e,i)=>{const n=[];i.reconvertedElements||(i.reconvertedElements=new Set);for(const r of i.changes){const o=r.type=="attribute"?r.range.start.nodeAfter:r.position.parent;if(!o||!t(o,r)){n.push(r);continue}if(!i.reconvertedElements.has(o)){i.reconvertedElements.add(o);const l=ne._createBefore(o);let a=n.length;for(let c=n.length-1;c>=0;c--){const h=n[c],m=(h.type=="attribute"?h.range.start:h.position).compareWith(l);if(m=="before"||h.type=="remove"&&m=="same")break;a=c}n.splice(a,0,{type:"remove",name:o.name,position:l,length:1},{type:"reinsert",name:o.name,position:l,length:1})}}i.changes=n}}function kA(s){return(t,e,i={})=>{const n=["insert"];for(const r of s.attributes)t.hasAttribute(r)&&n.push(`attribute:${r}`);return n.every(r=>e.test(t,r))?(i.preflight||n.forEach(r=>e.consume(t,r)),!0):!1}}function aQ(s,t,e){return(i,n)=>{const r=i.createContainerElement("$slot");let o=null;if(n==="children")o=Array.from(s.getChildren());else if(typeof n=="function")o=Array.from(s.getChildren()).filter(l=>n(l));else throw new E("conversion-slot-mode-unknown",e.dispatcher,{modeOrFilter:n});return t.set(r,o),r}}function cQ(s,t,e){const i=Array.from(t.values()).flat(),n=new Set(i);if(n.size!=i.length)throw new E("conversion-slot-filter-overlap",e.dispatcher,{element:s});if(n.size!=s.childCount)throw new E("conversion-slot-filter-incomplete",e.dispatcher,{element:s})}function uQ(s,t,e,i){e.mapper.on("modelToViewPosition",o,{priority:"highest"});let n=null,r=null;for([n,r]of t)SA(s,r,e,i),e.writer.move(e.writer.createRangeIn(n),e.writer.createPositionBefore(n)),e.writer.remove(n);e.mapper.off("modelToViewPosition",o);function o(l,a){const c=a.modelPosition.nodeAfter,h=r.indexOf(c);h<0||(a.viewPosition=a.mapper.findPositionIn(n,h))}}function SA(s,t,e,i){for(const n of t)hQ(s.root,n,e,i)||e.convertItem(n)}function hQ(s,t,e,i){const{writer:n,mapper:r}=e;if(!i.reconversion)return!1;const o=r.toViewElement(t);return!o||o.root==s||!e.canReuseView(o)?!1:(n.move(n.createRangeOn(o),r.toViewPosition(ne._createBefore(t))),!0)}function dQ(s,t,{preflight:e}={}){return e?t.test(s,"insert"):t.consume(s,"insert")}/**
 * @license Copyright (c) 2003-2025, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options
 */function CA(s){const{schema:t,document:e}=s.model;for(const i of e.getRoots())if(i.isEmpty&&!t.checkChild(i,"$text")&&t.checkChild(i,"paragraph"))return s.insertElement("paragraph",i),!0;return!1}function PA(s,t,e){const i=e.createContext(s);return!(!e.checkChild(i,"paragraph")||!e.checkChild(i.push("paragraph"),t))}function TA(s,t){const e=t.createElement("paragraph");return t.insert(e,s),t.createPositionAt(e,0)}class fQ extends wA{elementToElement(t){return this.add(EA(t))}elementToAttribute(t){return this.add(pQ(t))}attributeToAttribute(t){return this.add(wQ(t))}elementToMarker(t){return this.add(xQ(t))}dataToMarker(t){return this.add(bQ(t))}}function cC(){return(s,t,e)=>{if(!t.modelRange&&e.consumable.consume(t.viewItem,{name:!0})){const{modelRange:i,modelCursor:n}=e.convertChildren(t.viewItem,t.modelCursor);t.modelRange=i,t.modelCursor=n}}}function mQ(){return(s,t,{schema:e,consumable:i,writer:n})=>{let r=t.modelCursor;if(!i.test(t.viewItem))return;if(!e.checkChild(r,"$text")){if(!PA(r,"$text",e)||t.viewItem.data.trim().length==0)return;r=TA(r,n)}i.consume(t.viewItem);const o=n.createText(t.viewItem.data);n.insert(o,r),t.modelRange=n.createRange(r,r.getShiftedBy(o.offsetSize)),t.modelCursor=t.modelRange.end}}function gQ(s,t){return(e,i)=>{const n=i.newSelection,r=[];for(const l of n.getRanges())r.push(t.toModelRange(l));const o=s.createSelection(r,{backward:n.isBackward});o.isEqual(s.document.selection)||s.change(l=>{l.setSelection(o)})}}function EA(s){s=_n(s);const t=Bb(s),e=jO(s.view),i=e?`element:${e}`:"element";return n=>{n.on(i,t,{priority:s.converterPriority||"normal"})}}function pQ(s){s=_n(s),AA(s);const t=IA(s,!1),e=jO(s.view),i=e?`element:${e}`:"element";return n=>{n.on(i,t,{priority:s.converterPriority||"low"})}}function wQ(s){s=_n(s);let t=null;(typeof s.view=="string"||s.view.key)&&(t=vQ(s)),AA(s,t);const e=IA(s,!0);return i=>{i.on("element",e,{priority:s.converterPriority||"low"})}}function xQ(s){const t=SQ(s.model);return EA({...s,model:t})}function bQ(s){s=_n(s),s.model||(s.model=n=>n?s.view+":"+n:s.view);const t={view:s.view,model:s.model},e=Bb(uC(t,"start")),i=Bb(uC(t,"end"));return n=>{n.on(`element:${s.view}-start`,e,{priority:s.converterPriority||"normal"}),n.on(`element:${s.view}-end`,i,{priority:s.converterPriority||"normal"});const r=Ji.low,o=Ji.highest,l=Ji.get(s.converterPriority)/o;n.on("element",OQ(t),{priority:r+l})}}function OQ(s){return(t,e,i)=>{const n=`data-${s.view}`;if(!i.consumable.test(e.viewItem,{attributes:n+"-end-after"})&&!i.consumable.test(e.viewItem,{attributes:n+"-start-after"})&&!i.consumable.test(e.viewItem,{attributes:n+"-end-before"})&&!i.consumable.test(e.viewItem,{attributes:n+"-start-before"}))return;e.modelRange||Object.assign(e,i.convertChildren(e.viewItem,e.modelCursor)),i.consumable.consume(e.viewItem,{attributes:n+"-end-after"})&&r(e.modelRange.end,e.viewItem.getAttribute(n+"-end-after").split(",")),i.consumable.consume(e.viewItem,{attributes:n+"-start-after"})&&r(e.modelRange.end,e.viewItem.getAttribute(n+"-start-after").split(",")),i.consumable.consume(e.viewItem,{attributes:n+"-end-before"})&&r(e.modelRange.start,e.viewItem.getAttribute(n+"-end-before").split(",")),i.consumable.consume(e.viewItem,{attributes:n+"-start-before"})&&r(e.modelRange.start,e.viewItem.getAttribute(n+"-start-before").split(","));function r(o,l){for(const a of l){const c=s.model(a,i),h=i.writer.createElement("$marker",{"data-name":c});i.writer.insert(h,o),e.modelCursor.isEqual(o)?e.modelCursor=e.modelCursor.getShiftedBy(1):e.modelCursor=e.modelCursor._getTransformedByInsertion(o,1),e.modelRange=e.modelRange._getTransformedByInsertion(o,1)[0]}}}}function jO(s){return typeof s=="string"?s:typeof s=="object"&&typeof s.name=="string"?s.name:null}function Bb(s){const t=new kn(s.view);return(e,i,n)=>{const r=t.match(i.viewItem);if(!r)return;const o=r.match;if(o.name=!0,!n.consumable.test(i.viewItem,o))return;const l=yQ(s.model,i.viewItem,n);l&&n.safeInsert(l,i.modelCursor)&&(n.consumable.consume(i.viewItem,o),n.convertChildren(i.viewItem,l),n.updateConversionResult(l,i))}}function yQ(s,t,e){return s instanceof Function?s(t,e):e.writer.createElement(s)}function vQ(s){typeof s.view=="string"&&(s.view={key:s.view});const t=s.view.key,e=typeof s.view.value>"u"?/[\s\S]*/:s.view.value;let i;return t=="class"||t=="style"?i={[t=="class"?"classes":"styles"]:e}:i={attributes:{[t]:e}},s.view.name&&(i.name=s.view.name),s.view=i,t}function AA(s,t=null){const e=t===null?!0:r=>r.getAttribute(t),i=typeof s.model!="object"?s.model:s.model.key,n=typeof s.model!="object"||typeof s.model.value>"u"?e:s.model.value;s.model={key:i,value:n}}function IA(s,t){const e=new kn(s.view);return(i,n,r)=>{if(!n.modelRange&&t)return;const o=e.match(n.viewItem);if(!o||(_Q(s.view,n.viewItem)?o.match.name=!0:delete o.match.name,!r.consumable.test(n.viewItem,o.match)))return;const l=s.model.key,a=typeof s.model.value=="function"?s.model.value(n.viewItem,r,n):s.model.value;if(a===null)return;n.modelRange||Object.assign(n,r.convertChildren(n.viewItem,n.modelCursor)),kQ(n.modelRange,{key:l,value:a},t,r)&&(r.consumable.test(n.viewItem,{name:!0})&&(o.match.name=!0),r.consumable.consume(n.viewItem,o.match))}}function _Q(s,t){const e=typeof s=="function"?s(t):s;return typeof e=="object"&&!jO(e)?!1:!e.classes&&!e.attributes&&!e.styles}function kQ(s,t,e,i){let n=!1;for(const r of Array.from(s.getItems({shallow:e})))i.schema.checkAttribute(r,t.key)&&(n=!0,!r.hasAttribute(t.key)&&i.writer.setAttribute(t.key,t.value,r));return n}function SQ(s){return(t,e)=>{const i=typeof s=="string"?s:s(t,e);return e.writer.createElement("$marker",{"data-name":i})}}function uC(s,t){const e=(i,n)=>{const r=i.getAttribute("name"),o=s.model(r,n);return n.writer.createElement("$marker",{"data-name":o})};return{view:`${s.view}-${t}`,model:e}}class CQ extends at(){constructor(e,i){super();p(this,"model");p(this,"view");p(this,"mapper");p(this,"downcastDispatcher");this.model=e,this.view=new w8(i),this.mapper=new mA,this.downcastDispatcher=new gA({mapper:this.mapper,schema:e.schema});const n=this.model.document,r=n.selection,o=this.model.markers;this.listenTo(this.model,"_beforeChanges",()=>{this.view._disableRendering(!0)},{priority:"highest"}),this.listenTo(this.model,"_afterChanges",()=>{this.view._disableRendering(!1)},{priority:"lowest"}),this.listenTo(n,"change",()=>{this.view.change(l=>{this.downcastDispatcher.convertChanges(n.differ,o,l),this.downcastDispatcher.convertSelection(r,o,l)})},{priority:"low"}),this.listenTo(this.view.document,"selectionChange",gQ(this.model,this.mapper)),this.downcastDispatcher.on("insert:$text",xA(),{priority:"lowest"}),this.downcastDispatcher.on("insert",bA(),{priority:"lowest"}),this.downcastDispatcher.on("remove",B8(),{priority:"low"}),this.downcastDispatcher.on("cleanSelection",Q8()),this.downcastDispatcher.on("selection",$8(),{priority:"low"}),this.downcastDispatcher.on("selection",D8(),{priority:"low"}),this.view.document.roots.bindTo(this.model.document.roots).using(l=>{if(l.rootName=="$graveyard")return null;const a=new iA(this.view.document,l.name);return a.rootName=l.rootName,this.mapper.bindElements(l,a),a})}destroy(){this.view.destroy(),this.stopListening()}reconvertMarker(e){const i=typeof e=="string"?e:e.name,n=this.model.markers.get(i);if(!n)throw new E("editingcontroller-reconvertmarker-marker-not-exist",this,{markerName:i});this.model.change(()=>{this.model.markers._refresh(n)})}reconvertItem(e){this.model.change(()=>{this.model.document.differ._refreshItem(e)})}}let PQ=class extends at(){constructor(){super();p(this,"_sourceDefinitions",{});p(this,"_attributeProperties",Object.create(null));p(this,"_customChildChecks",new Map);p(this,"_customAttributeChecks",new Map);p(this,"_genericCheckSymbol",Symbol("$generic"));p(this,"_compiledDefinitions");this.decorate("checkChild"),this.decorate("checkAttribute"),this.on("checkAttribute",(e,i)=>{i[0]=new So(i[0])},{priority:"highest"}),this.on("checkChild",(e,i)=>{i[0]=new So(i[0]),i[1]=this.getDefinition(i[1])},{priority:"highest"})}register(e,i){if(this._sourceDefinitions[e])throw new E("schema-cannot-register-item-twice",this,{itemName:e});this._sourceDefinitions[e]=[Object.assign({},i)],this._clearCache()}extend(e,i){if(!this._sourceDefinitions[e])throw new E("schema-cannot-extend-missing-item",this,{itemName:e});this._sourceDefinitions[e].push(Object.assign({},i)),this._clearCache()}getDefinitions(){return this._compiledDefinitions||this._compile(),this._compiledDefinitions}getDefinition(e){let i;return typeof e=="string"?i=e:"is"in e&&(e.is("$text")||e.is("$textProxy"))?i="$text":i=e.name,this.getDefinitions()[i]}isRegistered(e){return!!this.getDefinition(e)}isBlock(e){const i=this.getDefinition(e);return!!(i&&i.isBlock)}isLimit(e){const i=this.getDefinition(e);return i?!!(i.isLimit||i.isObject):!1}isObject(e){const i=this.getDefinition(e);return i?!!(i.isObject||i.isLimit&&i.isSelectable&&i.isContent):!1}isInline(e){const i=this.getDefinition(e);return!!(i&&i.isInline)}isSelectable(e){const i=this.getDefinition(e);return i?!!(i.isSelectable||i.isObject):!1}isContent(e){const i=this.getDefinition(e);return i?!!(i.isContent||i.isObject):!1}checkChild(e,i){return i?this._checkContextMatch(e,i):!1}checkAttribute(e,i){const n=this.getDefinition(e.last);if(!n)return!1;const r=this._evaluateAttributeChecks(e,i);return r!==void 0?r:n.allowAttributes.includes(i)}checkMerge(e,i){if(e instanceof ne){const n=e.nodeBefore,r=e.nodeAfter;if(!(n instanceof Mt))throw new E("schema-check-merge-no-element-before",this);if(!(r instanceof Mt))throw new E("schema-check-merge-no-element-after",this);return this.checkMerge(n,r)}if(this.isLimit(e)||this.isLimit(i))return!1;for(const n of i.getChildren())if(!this.checkChild(e,n))return!1;return!0}addChildCheck(e,i){const n=i!==void 0?i:this._genericCheckSymbol,r=this._customChildChecks.get(n)||[];r.push(e),this._customChildChecks.set(n,r)}addAttributeCheck(e,i){const n=i!==void 0?i:this._genericCheckSymbol,r=this._customAttributeChecks.get(n)||[];r.push(e),this._customAttributeChecks.set(n,r)}setAttributeProperties(e,i){this._attributeProperties[e]=Object.assign(this.getAttributeProperties(e),i)}getAttributeProperties(e){return this._attributeProperties[e]||Object.create(null)}getLimitElement(e){let i;for(e instanceof ne?i=e.parent:i=(e instanceof K?[e]:Array.from(e.getRanges())).reduce((r,o)=>{const l=o.getCommonAncestor();return r?r.getCommonAncestor(l,{includeSelf:!0}):l},null);!this.isLimit(i)&&i.parent;)i=i.parent;return i}checkAttributeInSelection(e,i){if(e.isCollapsed){const r=[...e.getFirstPosition().getAncestors(),new Nt("",e.getAttributes())];return this.checkAttribute(r,i)}else{const n=e.getRanges();for(const r of n)for(const o of r)if(this.checkAttribute(o.item,i))return!0}return!1}*getValidRanges(e,i){e=WQ(e);for(const n of e)yield*this._getValidRangesForRange(n,i)}getNearestSelectionRange(e,i="both"){if(e.root.rootName=="$graveyard")return null;if(this.checkChild(e,"$text"))return new K(e);let n,r;const o=e.getAncestors().reverse().find(l=>this.isLimit(l))||e.root;(i=="both"||i=="backward")&&(n=new Ar({boundaries:K._createIn(o),startPosition:e,direction:"backward"})),(i=="both"||i=="forward")&&(r=new Ar({boundaries:K._createIn(o),startPosition:e}));for(const l of zQ(n,r)){const a=l.walker==n?"elementEnd":"elementStart",c=l.value;if(c.type==a&&this.isObject(c.item))return K._createOn(c.item);if(this.checkChild(c.nextPosition,"$text"))return new K(c.nextPosition)}return null}findAllowedParent(e,i){let n=e.parent;for(;n;){if(this.checkChild(n,i))return n;if(this.isLimit(n))return null;n=n.parent}return null}setAllowedAttributes(e,i,n){const r=n.model;for(const[o,l]of Object.entries(i))r.schema.checkAttribute(e,o)&&n.setAttribute(o,l,e)}removeDisallowedAttributes(e,i){for(const n of e)if(n.is("$text"))hC(this,n,i);else{const o=K._createIn(n).getPositions();for(const l of o){const a=l.nodeBefore||l.parent;hC(this,a,i)}}}getAttributesWithProperty(e,i,n){const r={};for(const[o,l]of e.getAttributes()){const a=this.getAttributeProperties(o);a[i]!==void 0&&(n===void 0||n===a[i])&&(r[o]=l)}return r}createContext(e){return new So(e)}_clearCache(){this._compiledDefinitions=null}_compile(){const e={},i=this._sourceDefinitions,n=Object.keys(i);for(const o of n)e[o]=TQ(i[o],o);const r=Object.values(e);for(const o of r)EQ(e,o),AQ(e,o),IQ(e,o),RQ(e,o);for(const o of r)VQ(e,o);for(const o of r)MQ(e,o);for(const o of r)LQ(e,o);for(const o of r)$Q(e,o);for(const o of r)DQ(e,o);this._compiledDefinitions=BQ(e)}_checkContextMatch(e,i){const n=e.last;let r=this._evaluateChildChecks(e,i);if(r=r!==void 0?r:i.allowIn.includes(n.name),!r)return!1;const o=this.getDefinition(n),l=e.trimLast();return o?l.length==0?!0:this._checkContextMatch(l,o):!1}_evaluateChildChecks(e,i){const n=this._customChildChecks.get(this._genericCheckSymbol)||[],r=this._customChildChecks.get(i.name)||[];for(const o of[...n,...r]){const l=o(e,i);if(l!==void 0)return l}}_evaluateAttributeChecks(e,i){const n=this._customAttributeChecks.get(this._genericCheckSymbol)||[],r=this._customAttributeChecks.get(i)||[];for(const o of[...n,...r]){const l=o(e,i);if(l!==void 0)return l}}*_getValidRangesForRange(e,i){let n=e.start,r=e.start;for(const o of e.getItems({shallow:!0}))o.is("element")&&(yield*this._getValidRangesForRange(K._createIn(o),i)),this.checkAttribute(o,i)||(n.isEqual(r)||(yield new K(n,r)),n=ne._createAfter(o)),r=ne._createAfter(o);n.isEqual(r)||(yield new K(n,r))}findOptimalInsertionRange(e,i){const n=e.getSelectedElement();if(n&&this.isObject(n)&&!this.isInline(n))return i=="before"||i=="after"?new K(ne._createAt(n,i)):K._createOn(n);const r=$t(e.getSelectedBlocks());if(!r)return new K(e.focus);if(r.isEmpty)return new K(ne._createAt(r,0));const o=ne._createAfter(r);return e.focus.isTouching(o)?new K(o):new K(ne._createBefore(r))}};class So{constructor(t){p(this,"_items");if(t instanceof So)return t;let e;typeof t=="string"?e=[t]:Array.isArray(t)?e=t:e=t.getAncestors({includeSelf:!0}),this._items=e.map(FQ)}get length(){return this._items.length}get last(){return this._items[this._items.length-1]}[Symbol.iterator](){return this._items[Symbol.iterator]()}push(t){const e=new So([t]);return e._items=[...this._items,...e._items],e}trimLast(){const t=new So([]);return t._items=this._items.slice(0,-1),t}getItem(t){return this._items[t]}*getNames(){yield*this._items.map(t=>t.name)}endsWith(t){return Array.from(this.getNames()).join(" ").endsWith(t)}startsWith(t){return Array.from(this.getNames()).join(" ").startsWith(t)}}function TQ(s,t){const e={name:t,allowIn:new Set,allowChildren:new Set,disallowIn:new Set,disallowChildren:new Set,allowContentOf:new Set,allowWhere:new Set,allowAttributes:new Set,disallowAttributes:new Set,allowAttributesOf:new Set,inheritTypesFrom:new Set};return QQ(s,e),qs(s,e,"allowIn"),qs(s,e,"allowChildren"),qs(s,e,"disallowIn"),qs(s,e,"disallowChildren"),qs(s,e,"allowContentOf"),qs(s,e,"allowWhere"),qs(s,e,"allowAttributes"),qs(s,e,"disallowAttributes"),qs(s,e,"allowAttributesOf"),qs(s,e,"inheritTypesFrom"),NQ(s,e),e}function EQ(s,t){for(const e of t.allowIn){const i=s[e];i?i.allowChildren.add(t.name):t.allowIn.delete(e)}}function AQ(s,t){for(const e of t.allowChildren){const i=s[e];i?i.allowIn.add(t.name):t.allowChildren.delete(e)}}function IQ(s,t){for(const e of t.disallowIn){const i=s[e];i?i.disallowChildren.add(t.name):t.disallowIn.delete(e)}}function RQ(s,t){for(const e of t.disallowChildren){const i=s[e];i?i.disallowIn.add(t.name):t.disallowChildren.delete(e)}}function VQ(s,t){for(const e of t.disallowChildren)t.allowChildren.delete(e);for(const e of t.disallowIn)t.allowIn.delete(e);for(const e of t.disallowAttributes)t.allowAttributes.delete(e)}function MQ(s,t){for(const e of t.allowContentOf){const i=s[e];i&&(i.disallowChildren.forEach(n=>{t.allowChildren.has(n)||(t.disallowChildren.add(n),s[n].disallowIn.add(t.name))}),i.allowChildren.forEach(n=>{t.disallowChildren.has(n)||(t.allowChildren.add(n),s[n].allowIn.add(t.name))}))}}function LQ(s,t){for(const e of t.allowWhere){const i=s[e];i&&(i.disallowIn.forEach(n=>{t.allowIn.has(n)||(t.disallowIn.add(n),s[n].disallowChildren.add(t.name))}),i.allowIn.forEach(n=>{t.disallowIn.has(n)||(t.allowIn.add(n),s[n].allowChildren.add(t.name))}))}}function BQ(s){const t={};for(const e of Object.values(s))t[e.name]={name:e.name,isBlock:!!e.isBlock,isContent:!!e.isContent,isInline:!!e.isInline,isLimit:!!e.isLimit,isObject:!!e.isObject,isSelectable:!!e.isSelectable,allowIn:Array.from(e.allowIn).filter(i=>!!s[i]),allowChildren:Array.from(e.allowChildren).filter(i=>!!s[i]),allowAttributes:Array.from(e.allowAttributes)};return t}function $Q(s,t){for(const e of t.allowAttributesOf){const i=s[e];if(!i)return;i.allowAttributes.forEach(n=>{t.disallowAttributes.has(n)||t.allowAttributes.add(n)})}}function DQ(s,t){for(const e of t.inheritTypesFrom){const i=s[e];if(i){const n=Object.keys(i).filter(r=>r.startsWith("is"));for(const r of n)r in t||(t[r]=i[r])}}}function QQ(s,t){for(const e of s){const i=Object.keys(e).filter(n=>n.startsWith("is"));for(const n of i)t[n]=!!e[n]}}function qs(s,t,e){for(const i of s){let n=i[e];typeof n=="string"&&(n=[n]),Array.isArray(n)&&n.forEach(r=>t[e].add(r))}}function NQ(s,t){for(const e of s){const i=e.inheritAllFrom;i&&(t.allowContentOf.add(i),t.allowWhere.add(i),t.allowAttributesOf.add(i),t.inheritTypesFrom.add(i))}}function FQ(s){return typeof s=="string"||s.is("documentFragment")?{name:typeof s=="string"?s:"$documentFragment",*getAttributeKeys(){},getAttribute(){}}:{name:s.is("element")?s.name:"$text",*getAttributeKeys(){yield*s.getAttributeKeys()},getAttribute(t){return s.getAttribute(t)}}}function*zQ(s,t){let e=!1;for(;!e;){if(e=!0,s){const i=s.next();i.done||(e=!1,yield{walker:s,value:i.value})}if(t){const i=t.next();i.done||(e=!1,yield{walker:t,value:i.value})}}}function*WQ(s){for(const t of s)yield*t.getMinimalFlatRanges()}function hC(s,t,e){for(const i of t.getAttributeKeys())s.checkAttribute(t,i)||e.removeAttribute(i,t)}class UQ extends pt(){constructor(e){super();p(this,"conversionApi");p(this,"_splitParts",new Map);p(this,"_cursorParents",new Map);p(this,"_modelCursor",null);p(this,"_emptyElementsToKeep",new Set);this.conversionApi={...e,consumable:null,writer:null,store:null,convertItem:(i,n)=>this._convertItem(i,n),convertChildren:(i,n)=>this._convertChildren(i,n),safeInsert:(i,n)=>this._safeInsert(i,n),updateConversionResult:(i,n)=>this._updateConversionResult(i,n),splitToAllowedParent:(i,n)=>this._splitToAllowedParent(i,n),getSplitParts:i=>this._getSplitParts(i),keepEmptyElement:i=>this._keepEmptyElement(i)}}convert(e,i,n=["$root"]){this.fire("viewCleanup",e),this._modelCursor=HQ(n,i),this.conversionApi.writer=i,this.conversionApi.consumable=pg.createFrom(e),this.conversionApi.store={};const{modelRange:r}=this._convertItem(e,this._modelCursor),o=i.createDocumentFragment();if(r){this._removeEmptyElements();const l=this._modelCursor.parent,a=l._removeChildren(0,l.childCount);o._insertChild(0,a),o.markers=ZQ(o,i)}return this._modelCursor=null,this._splitParts.clear(),this._cursorParents.clear(),this._emptyElementsToKeep.clear(),this.conversionApi.writer=null,this.conversionApi.store=null,o}_convertItem(e,i){const n={viewItem:e,modelCursor:i,modelRange:null};if(e.is("element")?this.fire(`element:${e.name}`,n,this.conversionApi):e.is("$text")?this.fire("text",n,this.conversionApi):this.fire("documentFragment",n,this.conversionApi),n.modelRange&&!(n.modelRange instanceof K))throw new E("view-conversion-dispatcher-incorrect-result",this);return{modelRange:n.modelRange,modelCursor:n.modelCursor}}_convertChildren(e,i){let n=i.is("position")?i:ne._createAt(i,0);const r=new K(n);for(const o of Array.from(e.getChildren())){const l=this._convertItem(o,n);l.modelRange instanceof K&&(r.end=l.modelRange.end,n=l.modelCursor)}return{modelRange:r,modelCursor:n}}_safeInsert(e,i){const n=this._splitToAllowedParent(e,i);return n?(this.conversionApi.writer.insert(e,n.position),!0):!1}_updateConversionResult(e,i){const n=this._getSplitParts(e),r=this.conversionApi.writer;i.modelRange||(i.modelRange=r.createRange(r.createPositionBefore(e),r.createPositionAfter(n[n.length-1])));const o=this._cursorParents.get(e);o?i.modelCursor=r.createPositionAt(o,0):i.modelCursor=i.modelRange.end}_splitToAllowedParent(e,i){const{schema:n,writer:r}=this.conversionApi;let o=n.findAllowedParent(i,e);if(o){if(o===i.parent)return{position:i};this._modelCursor.parent.getAncestors().includes(o)&&(o=null)}if(!o)return PA(i,e,n)?{position:TA(i,r)}:null;const l=this.conversionApi.writer.split(i,o),a=[];for(const h of l.range.getWalker())if(h.type=="elementEnd")a.push(h.item);else{const f=a.pop(),m=h.item;this._registerSplitPair(f,m)}const c=l.range.end.parent;return this._cursorParents.set(e,c),{position:l.position,cursorParent:c}}_registerSplitPair(e,i){this._splitParts.has(e)||this._splitParts.set(e,[e]);const n=this._splitParts.get(e);this._splitParts.set(i,n),n.push(i)}_getSplitParts(e){let i;return this._splitParts.has(e)?i=this._splitParts.get(e):i=[e],i}_keepEmptyElement(e){this._emptyElementsToKeep.add(e)}_removeEmptyElements(){const e=new Map;for(const i of this._splitParts.keys())if(i.isEmpty&&!this._emptyElementsToKeep.has(i)){const n=e.get(i.parent)||[];n.push(i),this._splitParts.delete(i),e.set(i.parent,n)}for(const[i,n]of e)i._removeChildrenArray(n);e.size&&this._removeEmptyElements()}}function ZQ(s,t){const e=new Set,i=new Map,n=K._createIn(s).getItems();for(const r of n)r.is("element","$marker")&&e.add(r);for(const r of e){const o=r.getAttribute("data-name"),l=t.createPositionBefore(r);i.has(o)?i.get(o).end=l.clone():i.set(o,new K(l.clone())),t.remove(r)}return i}function HQ(s,t){let e;for(const i of new So(s)){const n={};for(const o of i.getAttributeKeys())n[o]=i.getAttribute(o);const r=t.createElement(i.name,n);e&&t.insert(r,e),e=ne._createAt(r,0)}return e}class qQ{getHtml(t){const i=he.document.implementation.createHTMLDocument("").createElement("div");return i.appendChild(t),i.innerHTML}}class jQ{constructor(t){p(this,"domParser");p(this,"domConverter");p(this,"htmlWriter");p(this,"skipComments",!0);this.domParser=new DOMParser,this.domConverter=new cd(t,{renderingMode:"data"}),this.htmlWriter=new qQ}toData(t){const e=this.domConverter.viewToDom(t);return this.htmlWriter.getHtml(e)}toView(t){const e=this._toDom(t);return this.domConverter.domToView(e,{skipComments:this.skipComments})}registerRawContentMatcher(t){this.domConverter.registerRawContentMatcher(t)}useFillerType(t){this.domConverter.blockFillerMode=t=="marked"?"markedNbsp":"nbsp"}_toDom(t){/<(?:html|body|head|meta)(?:\s[^>]*)?>/i.test(t.trim().slice(0,1e4))||(t=`<body>${t}</body>`);const e=this.domParser.parseFromString(t,"text/html"),i=e.createDocumentFragment(),n=e.body.childNodes;for(;n.length>0;)i.appendChild(n[0]);return i}}class XQ extends pt(){constructor(e,i){super();p(this,"model");p(this,"mapper");p(this,"downcastDispatcher");p(this,"upcastDispatcher");p(this,"viewDocument");p(this,"stylesProcessor");p(this,"htmlProcessor");p(this,"processor");p(this,"_viewWriter");this.model=e,this.mapper=new mA,this.downcastDispatcher=new gA({mapper:this.mapper,schema:e.schema}),this.downcastDispatcher.on("insert:$text",xA(),{priority:"lowest"}),this.downcastDispatcher.on("insert",bA(),{priority:"lowest"}),this.upcastDispatcher=new UQ({schema:e.schema}),this.viewDocument=new ad(i),this.stylesProcessor=i,this.htmlProcessor=new jQ(this.viewDocument),this.processor=this.htmlProcessor,this._viewWriter=new rA(this.viewDocument),this.upcastDispatcher.on("text",mQ(),{priority:"lowest"}),this.upcastDispatcher.on("element",cC(),{priority:"lowest"}),this.upcastDispatcher.on("documentFragment",cC(),{priority:"lowest"}),at().prototype.decorate.call(this,"init"),at().prototype.decorate.call(this,"set"),at().prototype.decorate.call(this,"get"),at().prototype.decorate.call(this,"toView"),at().prototype.decorate.call(this,"toModel"),this.on("init",()=>{this.fire("ready")},{priority:"lowest"}),this.on("ready",()=>{this.model.enqueueChange({isUndoable:!1},CA)},{priority:"lowest"})}get(e={}){const{rootName:i="main",trim:n="empty"}=e;if(!this._checkIfRootsExists([i]))throw new E("datacontroller-get-non-existent-root",this);const r=this.model.document.getRoot(i);return r.isAttached()||Ue("datacontroller-get-detached-root",this),n==="empty"&&!this.model.hasContent(r,{ignoreWhitespaces:!0})?"":this.stringify(r,e)}stringify(e,i={}){const n=this.toView(e,i);return this.processor.toData(n)}toView(e,i={}){const n=this.viewDocument,r=this._viewWriter;this.mapper.clearBindings();const o=K._createIn(e),l=new _l(n);this.mapper.bindElements(e,l);const a=e.is("documentFragment")?e.markers:GQ(e);return this.downcastDispatcher.convert(o,a,r,i),l}init(e){if(this.model.document.version)throw new E("datacontroller-init-document-not-empty",this);let i={};if(typeof e=="string"?i.main=e:i=e,!this._checkIfRootsExists(Object.keys(i)))throw new E("datacontroller-init-non-existent-root",this);return this.model.enqueueChange({isUndoable:!1},n=>{for(const r of Object.keys(i)){const o=this.model.document.getRoot(r);n.insert(this.parse(i[r],o),o,0)}}),Promise.resolve()}set(e,i={}){let n={};if(typeof e=="string"?n.main=e:n=e,!this._checkIfRootsExists(Object.keys(n)))throw new E("datacontroller-set-non-existent-root",this);this.model.enqueueChange(i.batchType||{},r=>{r.setSelection(null),r.removeSelectionAttribute(this.model.document.selection.getAttributeKeys());for(const o of Object.keys(n)){const l=this.model.document.getRoot(o);r.remove(r.createRangeIn(l)),r.insert(this.parse(n[o],l),l,0)}})}parse(e,i="$root"){const n=this.processor.toView(e);return this.toModel(n,i)}toModel(e,i="$root"){return this.model.change(n=>this.upcastDispatcher.convert(e,n,i))}addStyleProcessorRules(e){e(this.stylesProcessor)}registerRawContentMatcher(e){this.processor&&this.processor!==this.htmlProcessor&&this.processor.registerRawContentMatcher(e),this.htmlProcessor.registerRawContentMatcher(e)}destroy(){this.stopListening()}_checkIfRootsExists(e){for(const i of e)if(!this.model.document.getRoot(i))return!1;return!0}}function GQ(s){const t=[],e=s.root.document;if(!e)return new Map;const i=K._createIn(s);for(const n of e.model.markers){const r=n.getRange(),o=r.isCollapsed,l=r.start.isEqual(i.start)||r.end.isEqual(i.end);if(o&&l)t.push([n.name,r]);else{const a=i.getIntersection(r);a&&t.push([n.name,a])}}return t.sort(([n,r],[o,l])=>{if(r.end.compareWith(l.start)!=="after")return 1;if(r.start.compareWith(l.end)!=="before")return-1;switch(r.start.compareWith(l.start)){case"before":return 1;case"after":return-1;default:switch(r.end.compareWith(l.end)){case"before":return 1;case"after":return-1;default:return o.localeCompare(n)}}}),new Map(t)}class YQ{constructor(t,e){p(this,"_helpers",new Map);p(this,"_downcast");p(this,"_upcast");this._downcast=dt(t),this._createConversionHelpers({name:"downcast",dispatchers:this._downcast,isDowncast:!0}),this._upcast=dt(e),this._createConversionHelpers({name:"upcast",dispatchers:this._upcast,isDowncast:!1})}addAlias(t,e){const i=this._downcast.includes(e);if(!this._upcast.includes(e)&&!i)throw new E("conversion-add-alias-dispatcher-not-registered",this);this._createConversionHelpers({name:t,dispatchers:[e],isDowncast:i})}for(t){if(!this._helpers.has(t))throw new E("conversion-for-unknown-group",this);return this._helpers.get(t)}elementToElement(t){this.for("downcast").elementToElement(t);for(const{model:e,view:i}of Jw(t))this.for("upcast").elementToElement({model:e,view:i,converterPriority:t.converterPriority})}attributeToElement(t){this.for("downcast").attributeToElement(t);for(const{model:e,view:i}of Jw(t))this.for("upcast").elementToAttribute({view:i,model:e,converterPriority:t.converterPriority})}attributeToAttribute(t){this.for("downcast").attributeToAttribute(t);for(const{model:e,view:i}of Jw(t))this.for("upcast").attributeToAttribute({view:i,model:e})}_createConversionHelpers({name:t,dispatchers:e,isDowncast:i}){if(this._helpers.has(t))throw new E("conversion-group-exists",this);const n=i?new L8(e):new fQ(e);this._helpers.set(t,n)}}function*Jw(s){if(s.model.values)for(const t of s.model.values){const e={key:s.model.key,value:t},i=s.view[t],n=s.upcastAlso?s.upcastAlso[t]:void 0;yield*dC(e,i,n)}else yield*dC(s.model,s.view,s.upcastAlso)}function*dC(s,t,e){if(yield{model:s,view:t},e)for(const i of dt(e))yield{model:s,view:i}}/**
 * @license Copyright (c) 2003-2025, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options
 */class Un{constructor(t){p(this,"baseVersion");p(this,"isDocumentOperation");p(this,"batch");this.baseVersion=t,this.isDocumentOperation=this.baseVersion!==null,this.batch=null}_validate(){}toJSON(){const t=Object.assign({},this);return t.__className=this.constructor.className,delete t.batch,delete t.isDocumentOperation,t}static get className(){return"Operation"}static fromJSON(t,e){return new this(t.baseVersion)}}function XO(s,t){const e=VA(t),i=e.reduce((o,l)=>o+l.offsetSize,0),n=s.parent;Ih(s);const r=s.index;return n._insertChild(r,e),Ah(n,r+e.length),Ah(n,r),new K(s,s.getShiftedBy(i))}function RA(s){if(!s.isFlat)throw new E("operation-utils-remove-range-not-flat",this);const t=s.start.parent;Ih(s.start),Ih(s.end);const e=t._removeChildren(s.start.index,s.end.index-s.start.index);return Ah(t,s.start.index),e}function Eh(s,t){if(!s.isFlat)throw new E("operation-utils-move-range-not-flat",this);const e=RA(s);return t=t._getTransformedByDeletion(s.start,s.end.offset-s.start.offset),XO(t,e)}function KQ(s,t,e){Ih(s.start),Ih(s.end);for(const i of s.getItems({shallow:!0})){const n=i.is("$textProxy")?i.textNode:i;e!==null?n._setAttribute(t,e):n._removeAttribute(t),Ah(n.parent,n.index)}Ah(s.end.parent,s.end.index)}function VA(s){const t=[];function e(i){if(typeof i=="string")t.push(new Nt(i));else if(i instanceof Ms)t.push(new Nt(i.data,i.getAttributes()));else if(i instanceof Fl)t.push(i);else if(Wn(i))for(const n of i)e(n)}e(s);for(let i=1;i<t.length;i++){const n=t[i],r=t[i-1];n instanceof Nt&&r instanceof Nt&&MA(n,r)&&(t.splice(i-1,2,new Nt(r.data+n.data,r.getAttributes())),i--)}return t}function Ah(s,t){const e=s.getChild(t-1),i=s.getChild(t);if(e&&i&&e.is("$text")&&i.is("$text")&&MA(e,i)){const n=new Nt(e.data+i.data,e.getAttributes());s._removeChildren(t-1,2),s._insertChild(t-1,n)}}function Ih(s){const t=s.textNode,e=s.parent;if(t){const i=s.offset-t.startOffset,n=t.index;e._removeChildren(n,1);const r=new Nt(t.data.substr(0,i),t.getAttributes()),o=new Nt(t.data.substr(i),t.getAttributes());e._insertChild(n,[r,o])}}function MA(s,t){const e=s.getAttributes(),i=t.getAttributes();for(const n of e){if(n[1]!==t.getAttribute(n[0]))return!1;i.next()}return i.next().done}class ct extends Un{constructor(e,i,n,r){super(r);p(this,"sourcePosition");p(this,"howMany");p(this,"targetPosition");this.sourcePosition=e.clone(),this.sourcePosition.stickiness="toNext",this.howMany=i,this.targetPosition=n.clone(),this.targetPosition.stickiness="toNone"}get type(){return this.targetPosition.root.rootName=="$graveyard"?"remove":this.sourcePosition.root.rootName=="$graveyard"?"reinsert":"move"}get affectedSelectable(){return[K._createFromPositionAndShift(this.sourcePosition,this.howMany),K._createFromPositionAndShift(this.targetPosition,0)]}clone(){return new ct(this.sourcePosition,this.howMany,this.targetPosition,this.baseVersion)}getMovedRangeStart(){return this.targetPosition._getTransformedByDeletion(this.sourcePosition,this.howMany)}getReversed(){const e=this.sourcePosition._getTransformedByInsertion(this.targetPosition,this.howMany);return new ct(this.getMovedRangeStart(),this.howMany,e,this.baseVersion+1)}_validate(){const e=this.sourcePosition.parent,i=this.targetPosition.parent,n=this.sourcePosition.offset,r=this.targetPosition.offset;if(n+this.howMany>e.maxOffset)throw new E("move-operation-nodes-do-not-exist",this);if(e===i&&n<r&&r<n+this.howMany)throw new E("move-operation-range-into-itself",this);if(this.sourcePosition.root==this.targetPosition.root&&Ni(this.sourcePosition.getParentPath(),this.targetPosition.getParentPath())=="prefix"){const o=this.sourcePosition.path.length-1;if(this.targetPosition.path[o]>=n&&this.targetPosition.path[o]<n+this.howMany)throw new E("move-operation-node-into-itself",this)}}_execute(){Eh(K._createFromPositionAndShift(this.sourcePosition,this.howMany),this.targetPosition)}toJSON(){const e=super.toJSON();return e.sourcePosition=this.sourcePosition.toJSON(),e.targetPosition=this.targetPosition.toJSON(),e}static get className(){return"MoveOperation"}static fromJSON(e,i){const n=ne.fromJSON(e.sourcePosition,i),r=ne.fromJSON(e.targetPosition,i);return new this(n,e.howMany,r,e.baseVersion)}}class vi extends Un{constructor(e,i,n){super(n);p(this,"position");p(this,"nodes");p(this,"shouldReceiveAttributes");this.position=e.clone(),this.position.stickiness="toNone",this.nodes=new uh(VA(i)),this.shouldReceiveAttributes=!1}get type(){return"insert"}get howMany(){return this.nodes.maxOffset}get affectedSelectable(){return this.position.clone()}clone(){const e=new uh([...this.nodes].map(n=>n._clone(!0))),i=new vi(this.position,e,this.baseVersion);return i.shouldReceiveAttributes=this.shouldReceiveAttributes,i}getReversed(){const e=this.position.root.document.graveyard,i=new ne(e,[0]);return new ct(this.position,this.nodes.maxOffset,i,this.baseVersion+1)}_validate(){const e=this.position.parent;if(!e||e.maxOffset<this.position.offset)throw new E("insert-operation-position-invalid",this)}_execute(){const e=this.nodes;this.nodes=new uh([...e].map(i=>i._clone(!0))),XO(this.position,e)}toJSON(){const e=super.toJSON();return e.position=this.position.toJSON(),e.nodes=this.nodes.toJSON(),e}static get className(){return"InsertOperation"}static fromJSON(e,i){const n=[];for(const o of e.nodes)o.name?n.push(Mt.fromJSON(o)):n.push(Nt.fromJSON(o));const r=new vi(ne.fromJSON(e.position,i),n,e.baseVersion);return r.shouldReceiveAttributes=e.shouldReceiveAttributes,r}}class bt extends Un{constructor(e,i,n,r,o){super(o);p(this,"splitPosition");p(this,"howMany");p(this,"insertionPosition");p(this,"graveyardPosition");this.splitPosition=e.clone(),this.splitPosition.stickiness="toNext",this.howMany=i,this.insertionPosition=n,this.graveyardPosition=r?r.clone():null,this.graveyardPosition&&(this.graveyardPosition.stickiness="toNext")}get type(){return"split"}get moveTargetPosition(){const e=this.insertionPosition.path.slice();return e.push(0),new ne(this.insertionPosition.root,e)}get movedRange(){const e=this.splitPosition.getShiftedBy(Number.POSITIVE_INFINITY);return new K(this.splitPosition,e)}get affectedSelectable(){const e=[K._createFromPositionAndShift(this.splitPosition,0),K._createFromPositionAndShift(this.insertionPosition,0)];return this.graveyardPosition&&e.push(K._createFromPositionAndShift(this.graveyardPosition,0)),e}clone(){return new bt(this.splitPosition,this.howMany,this.insertionPosition,this.graveyardPosition,this.baseVersion)}getReversed(){const e=this.splitPosition.root.document.graveyard,i=new ne(e,[0]);return new Zt(this.moveTargetPosition,this.howMany,this.splitPosition,i,this.baseVersion+1)}_validate(){const e=this.splitPosition.parent,i=this.splitPosition.offset;if(!e||e.maxOffset<i)throw new E("split-operation-position-invalid",this);if(e.parent){if(this.howMany!=e.maxOffset-this.splitPosition.offset)throw new E("split-operation-how-many-invalid",this);if(this.graveyardPosition&&!this.graveyardPosition.nodeAfter)throw new E("split-operation-graveyard-position-invalid",this)}else throw new E("split-operation-split-in-root",this)}_execute(){const e=this.splitPosition.parent;if(this.graveyardPosition)Eh(K._createFromPositionAndShift(this.graveyardPosition,1),this.insertionPosition);else{const n=e._clone();XO(this.insertionPosition,n)}const i=new K(ne._createAt(e,this.splitPosition.offset),ne._createAt(e,e.maxOffset));Eh(i,this.moveTargetPosition)}toJSON(){const e=super.toJSON();return e.splitPosition=this.splitPosition.toJSON(),e.insertionPosition=this.insertionPosition.toJSON(),this.graveyardPosition&&(e.graveyardPosition=this.graveyardPosition.toJSON()),e}static get className(){return"SplitOperation"}static getInsertionPosition(e){const i=e.path.slice(0,-1);return i[i.length-1]++,new ne(e.root,i,"toPrevious")}static fromJSON(e,i){const n=ne.fromJSON(e.splitPosition,i),r=ne.fromJSON(e.insertionPosition,i),o=e.graveyardPosition?ne.fromJSON(e.graveyardPosition,i):null;return new this(n,e.howMany,r,o,e.baseVersion)}}class Zt extends Un{constructor(e,i,n,r,o){super(o);p(this,"sourcePosition");p(this,"howMany");p(this,"targetPosition");p(this,"graveyardPosition");this.sourcePosition=e.clone(),this.sourcePosition.stickiness="toPrevious",this.howMany=i,this.targetPosition=n.clone(),this.targetPosition.stickiness="toNext",this.graveyardPosition=r.clone()}get type(){return"merge"}get deletionPosition(){return new ne(this.sourcePosition.root,this.sourcePosition.path.slice(0,-1))}get movedRange(){const e=this.sourcePosition.getShiftedBy(Number.POSITIVE_INFINITY);return new K(this.sourcePosition,e)}get affectedSelectable(){const e=this.sourcePosition.parent;return[K._createOn(e),K._createFromPositionAndShift(this.targetPosition,0),K._createFromPositionAndShift(this.graveyardPosition,0)]}clone(){return new Zt(this.sourcePosition,this.howMany,this.targetPosition,this.graveyardPosition,this.baseVersion)}getReversed(){const e=this.targetPosition._getTransformedByMergeOperation(this),i=this.sourcePosition.path.slice(0,-1),n=new ne(this.sourcePosition.root,i)._getTransformedByMergeOperation(this);return new bt(e,this.howMany,n,this.graveyardPosition,this.baseVersion+1)}_validate(){const e=this.sourcePosition.parent,i=this.targetPosition.parent;if(e.parent)if(i.parent){if(this.howMany!=e.maxOffset)throw new E("merge-operation-how-many-invalid",this)}else throw new E("merge-operation-target-position-invalid",this);else throw new E("merge-operation-source-position-invalid",this)}_execute(){const e=this.sourcePosition.parent,i=K._createIn(e);Eh(i,this.targetPosition),Eh(K._createOn(e),this.graveyardPosition)}toJSON(){const e=super.toJSON();return e.sourcePosition=e.sourcePosition.toJSON(),e.targetPosition=e.targetPosition.toJSON(),e.graveyardPosition=e.graveyardPosition.toJSON(),e}static get className(){return"MergeOperation"}static fromJSON(e,i){const n=ne.fromJSON(e.sourcePosition,i),r=ne.fromJSON(e.targetPosition,i),o=ne.fromJSON(e.graveyardPosition,i);return new this(n,e.howMany,r,o,e.baseVersion)}}class tn extends Un{constructor(e,i,n,r,o,l){super(l);p(this,"name");p(this,"oldRange");p(this,"newRange");p(this,"affectsData");p(this,"_markers");this.name=e,this.oldRange=i?i.clone():null,this.newRange=n?n.clone():null,this.affectsData=o,this._markers=r}get type(){return"marker"}get affectedSelectable(){const e=[];return this.oldRange&&e.push(this.oldRange.clone()),this.newRange&&(this.oldRange?e.push(...this.newRange.getDifference(this.oldRange)):e.push(this.newRange.clone())),e}clone(){return new tn(this.name,this.oldRange,this.newRange,this._markers,this.affectsData,this.baseVersion)}getReversed(){return new tn(this.name,this.newRange,this.oldRange,this._markers,this.affectsData,this.baseVersion+1)}_execute(){this.newRange?this._markers._set(this.name,this.newRange,!0,this.affectsData):this._markers._remove(this.name)}toJSON(){const e=super.toJSON();return this.oldRange&&(e.oldRange=this.oldRange.toJSON()),this.newRange&&(e.newRange=this.newRange.toJSON()),delete e._markers,e}static get className(){return"MarkerOperation"}static fromJSON(e,i){return new tn(e.name,e.oldRange?K.fromJSON(e.oldRange,i):null,e.newRange?K.fromJSON(e.newRange,i):null,i.model.markers,e.affectsData,e.baseVersion)}}class Kt extends Un{constructor(e,i,n,r,o){super(o);p(this,"range");p(this,"key");p(this,"oldValue");p(this,"newValue");this.range=e.clone(),this.key=i,this.oldValue=n===void 0?null:n,this.newValue=r===void 0?null:r}get type(){return this.oldValue===null?"addAttribute":this.newValue===null?"removeAttribute":"changeAttribute"}get affectedSelectable(){return this.range.clone()}clone(){return new Kt(this.range,this.key,this.oldValue,this.newValue,this.baseVersion)}getReversed(){return new Kt(this.range,this.key,this.newValue,this.oldValue,this.baseVersion+1)}toJSON(){const e=super.toJSON();return e.range=this.range.toJSON(),e}_validate(){if(!this.range.isFlat)throw new E("attribute-operation-range-not-flat",this);for(const e of this.range.getItems({shallow:!0})){if(this.oldValue!==null&&!Cl(e.getAttribute(this.key),this.oldValue))throw new E("attribute-operation-wrong-old-value",this,{item:e,key:this.key,value:this.oldValue});if(this.oldValue===null&&this.newValue!==null&&e.hasAttribute(this.key))throw new E("attribute-operation-attribute-exists",this,{node:e,key:this.key})}}_execute(){Cl(this.oldValue,this.newValue)||KQ(this.range,this.key,this.newValue)}static get className(){return"AttributeOperation"}static fromJSON(e,i){return new Kt(K.fromJSON(e.range,i),e.key,e.oldValue,e.newValue,e.baseVersion)}}class ui extends Un{get type(){return"noop"}get affectedSelectable(){return null}clone(){return new ui(this.baseVersion)}getReversed(){return new ui(this.baseVersion+1)}_execute(){}static get className(){return"NoOperation"}}class vn extends Un{constructor(e,i,n,r){super(r);p(this,"position");p(this,"oldName");p(this,"newName");this.position=e,this.position.stickiness="toNext",this.oldName=i,this.newName=n}get type(){return"rename"}get affectedSelectable(){return this.position.nodeAfter}clone(){return new vn(this.position.clone(),this.oldName,this.newName,this.baseVersion)}getReversed(){return new vn(this.position.clone(),this.newName,this.oldName,this.baseVersion+1)}_validate(){const e=this.position.nodeAfter;if(e instanceof Mt){if(e.name!==this.oldName)throw new E("rename-operation-wrong-name",this)}else throw new E("rename-operation-wrong-position",this)}_execute(){const e=this.position.nodeAfter;e.name=this.newName}toJSON(){const e=super.toJSON();return e.position=this.position.toJSON(),e}static get className(){return"RenameOperation"}static fromJSON(e,i){return new vn(ne.fromJSON(e.position,i),e.oldName,e.newName,e.baseVersion)}}class Rr extends Un{constructor(e,i,n,r,o){super(o);p(this,"root");p(this,"key");p(this,"oldValue");p(this,"newValue");this.root=e,this.key=i,this.oldValue=n===void 0?null:n,this.newValue=r===void 0?null:r}get type(){return this.oldValue===null?"addRootAttribute":this.newValue===null?"removeRootAttribute":"changeRootAttribute"}get affectedSelectable(){return this.root}clone(){return new Rr(this.root,this.key,this.oldValue,this.newValue,this.baseVersion)}getReversed(){return new Rr(this.root,this.key,this.newValue,this.oldValue,this.baseVersion+1)}_validate(){if(this.root!=this.root.root||this.root.is("documentFragment"))throw new E("rootattribute-operation-not-a-root",this,{root:this.root,key:this.key});if(this.oldValue!==null&&this.root.getAttribute(this.key)!==this.oldValue)throw new E("rootattribute-operation-wrong-old-value",this,{root:this.root,key:this.key});if(this.oldValue===null&&this.newValue!==null&&this.root.hasAttribute(this.key))throw new E("rootattribute-operation-attribute-exists",this,{root:this.root,key:this.key})}_execute(){this.newValue!==null?this.root._setAttribute(this.key,this.newValue):this.root._removeAttribute(this.key)}toJSON(){const e=super.toJSON();return e.root=this.root.toJSON(),e}static get className(){return"RootAttributeOperation"}static fromJSON(e,i){if(!i.getRoot(e.root))throw new E("rootattribute-operation-fromjson-no-root",this,{rootName:e.root});return new Rr(i.getRoot(e.root),e.key,e.oldValue,e.newValue,e.baseVersion)}}class rr extends Un{constructor(e,i,n,r,o){super(o);p(this,"rootName");p(this,"elementName");p(this,"isAdd");p(this,"_document");if(this.rootName=e,this.elementName=i,this.isAdd=n,this._document=r,!this._document.getRoot(this.rootName)){const l=this._document.createRoot(this.elementName,this.rootName);l._isAttached=!1}}get type(){return this.isAdd?"addRoot":"detachRoot"}get affectedSelectable(){return this._document.getRoot(this.rootName)}clone(){return new rr(this.rootName,this.elementName,this.isAdd,this._document,this.baseVersion)}getReversed(){return new rr(this.rootName,this.elementName,!this.isAdd,this._document,this.baseVersion+1)}_execute(){this._document.getRoot(this.rootName)._isAttached=this.isAdd}toJSON(){const e=super.toJSON();return delete e._document,e}static get className(){return"RootOperation"}static fromJSON(e,i){return new rr(e.rootName,e.elementName,e.isAdd,i,e.baseVersion)}}const xs={};xs[Kt.className]=Kt;xs[vi.className]=vi;xs[tn.className]=tn;xs[ct.className]=ct;xs[ui.className]=ui;xs[Un.className]=Un;xs[vn.className]=vn;xs[Rr.className]=Rr;xs[rr.className]=rr;xs[bt.className]=bt;xs[Zt.className]=Zt;class JQ{static fromJSON(t,e){return xs[t.__className].fromJSON(t,e)}}const $b=new Map;function et(s,t,e){let i=$b.get(s);i||(i=new Map,$b.set(s,i)),i.set(t,e)}function eN(s,t){const e=$b.get(s);return e&&e.has(t)?e.get(t):tN}function tN(s){return[s]}function fC(s,t,e={}){const i=eN(s.constructor,t.constructor);try{return s=s.clone(),i(s,t,e)}catch(n){throw n}}function iN(s,t,e){s=s.slice(),t=t.slice();const i=new nN(e.document,e.useRelations,e.forceWeakRemove);i.setOriginalOperations(s),i.setOriginalOperations(t);const n=i.originalOperations;if(s.length==0||t.length==0)return{operationsA:s,operationsB:t,originalOperations:n};const r=new WeakMap;for(const a of s)r.set(a,0);const o={nextBaseVersionA:s[s.length-1].baseVersion+1,nextBaseVersionB:t[t.length-1].baseVersion+1,originalOperationsACount:s.length,originalOperationsBCount:t.length};let l=0;for(;l<s.length;){const a=s[l],c=r.get(a);if(c==t.length){l++;continue}const h=t[c],f=fC(a,h,i.getContext(a,h,!0)),m=fC(h,a,i.getContext(h,a,!1));i.updateRelation(a,h),i.setOriginalOperations(f,a),i.setOriginalOperations(m,h);for(const w of f)r.set(w,c+m.length);s.splice(l,1,...f),t.splice(c,1,...m)}return gC(s),gC(t),mC(s,o.nextBaseVersionB),mC(t,o.nextBaseVersionA),{operationsA:s,operationsB:t,originalOperations:n}}class nN{constructor(t,e,i=!1){p(this,"originalOperations");p(this,"_history");p(this,"_useRelations");p(this,"_forceWeakRemove");p(this,"_relations");this.originalOperations=new Map,this._history=t.history,this._useRelations=e,this._forceWeakRemove=!!i,this._relations=new Map}setOriginalOperations(t,e=null){const i=e?this.originalOperations.get(e):null;for(const n of t)this.originalOperations.set(n,i||n)}updateRelation(t,e){if(t instanceof ct)e instanceof Zt?t.targetPosition.isEqual(e.sourcePosition)||e.movedRange.containsPosition(t.targetPosition)?this._setRelation(t,e,"insertAtSource"):t.targetPosition.isEqual(e.deletionPosition)?this._setRelation(t,e,"insertBetween"):t.targetPosition.isAfter(e.sourcePosition)&&this._setRelation(t,e,"moveTargetAfter"):e instanceof ct&&(t.targetPosition.isEqual(e.sourcePosition)||t.targetPosition.isBefore(e.sourcePosition)?this._setRelation(t,e,"insertBefore"):this._setRelation(t,e,"insertAfter"));else if(t instanceof bt){if(e instanceof Zt)t.splitPosition.isBefore(e.sourcePosition)&&this._setRelation(t,e,"splitBefore");else if(e instanceof ct)if(t.splitPosition.isEqual(e.sourcePosition)||t.splitPosition.isBefore(e.sourcePosition))this._setRelation(t,e,"splitBefore");else{const i=K._createFromPositionAndShift(e.sourcePosition,e.howMany);if(t.splitPosition.hasSameParentAs(e.sourcePosition)&&i.containsPosition(t.splitPosition)){const n=i.end.offset-t.splitPosition.offset,r=t.splitPosition.offset-i.start.offset;this._setRelation(t,e,{howMany:n,offset:r})}}}else if(t instanceof Zt)e instanceof Zt?(t.targetPosition.isEqual(e.sourcePosition)||this._setRelation(t,e,"mergeTargetNotMoved"),t.sourcePosition.isEqual(e.targetPosition)&&this._setRelation(t,e,"mergeSourceNotMoved"),t.sourcePosition.isEqual(e.sourcePosition)&&this._setRelation(t,e,"mergeSameElement")):e instanceof bt?t.sourcePosition.isEqual(e.splitPosition)&&this._setRelation(t,e,"splitAtSource"):e instanceof ct&&e.howMany>0&&(t.sourcePosition.isEqual(e.sourcePosition.getShiftedBy(e.howMany))&&this._setRelation(t,e,"mergeSourceAffected"),t.targetPosition.isEqual(e.sourcePosition)&&this._setRelation(t,e,"mergeTargetWasBefore"));else if(t instanceof tn){const i=t.newRange;if(!i)return;if(e instanceof Zt){const n=i.start.isEqual(e.targetPosition),r=i.start.isEqual(e.deletionPosition),o=i.end.isEqual(e.deletionPosition),l=i.end.isEqual(e.sourcePosition);(n||r||o||l)&&this._setRelation(t,e,{wasInLeftElement:n,wasStartBeforeMergedElement:r,wasEndBeforeMergedElement:o,wasInRightElement:l})}}}getContext(t,e,i){return{aIsStrong:i,aWasUndone:this._wasUndone(t),bWasUndone:this._wasUndone(e),abRelation:this._useRelations?this._getRelation(t,e):null,baRelation:this._useRelations?this._getRelation(e,t):null,forceWeakRemove:this._forceWeakRemove}}_wasUndone(t){const e=this.originalOperations.get(t);return e.wasUndone||this._history.isUndoneOperation(e)}_getRelation(t,e){const i=this.originalOperations.get(e),n=this._history.getUndoneOperation(i);if(!n)return null;const r=this.originalOperations.get(t),o=this._relations.get(r);return o&&o.get(n)||null}_setRelation(t,e,i){const n=this.originalOperations.get(t),r=this.originalOperations.get(e);let o=this._relations.get(n);o||(o=new Map,this._relations.set(n,o)),o.set(r,i)}}function mC(s,t){for(const e of s)e.baseVersion=t++}function gC(s){const t=new Map;for(let e=0;e<s.length;e++){const i=s[e];i instanceof tn&&(i.baseVersion!==-1?t.set(i.name,{op:i,ranges:i.newRange?[i.newRange]:[]}):(i.newRange&&t.get(i.name).ranges.push(i.newRange),s.splice(e,1),e--))}for(const{op:e,ranges:i}of t.values())i.length?e.newRange=K._createFromRanges(i):e.newRange=null}et(Kt,Kt,(s,t,e)=>{if(s.key===t.key&&s.range.start.hasSameParentAs(t.range.start)){const i=s.range.getDifference(t.range).map(r=>new Kt(r,s.key,s.oldValue,s.newValue,0)),n=s.range.getIntersection(t.range);return n&&e.aIsStrong&&i.push(new Kt(n,t.key,t.newValue,s.newValue,0)),i.length==0?[new ui(0)]:i}else return[s]});et(Kt,vi,(s,t)=>{if(s.range.start.hasSameParentAs(t.position)&&s.range.containsPosition(t.position)){const i=s.range._getTransformedByInsertion(t.position,t.howMany,!t.shouldReceiveAttributes).map(n=>new Kt(n,s.key,s.oldValue,s.newValue,s.baseVersion));if(t.shouldReceiveAttributes){const n=LA(t,s.key,s.oldValue);n&&i.unshift(n)}return i}return s.range=s.range._getTransformedByInsertion(t.position,t.howMany,!1)[0],[s]});function LA(s,t,e){const n=s.nodes.getNode(0).getAttribute(t);if(n==e)return null;const r=new K(s.position,s.position.getShiftedBy(s.howMany));return new Kt(r,t,n,e,0)}et(Kt,Zt,(s,t)=>{const e=[];s.range.start.hasSameParentAs(t.deletionPosition)&&(s.range.containsPosition(t.deletionPosition)||s.range.start.isEqual(t.deletionPosition))&&e.push(K._createFromPositionAndShift(t.graveyardPosition,1));const i=s.range._getTransformedByMergeOperation(t);return i.isCollapsed||e.push(i),e.map(n=>new Kt(n,s.key,s.oldValue,s.newValue,s.baseVersion))});et(Kt,ct,(s,t)=>sN(s.range,t).map(i=>new Kt(i,s.key,s.oldValue,s.newValue,s.baseVersion)));function sN(s,t){const e=K._createFromPositionAndShift(t.sourcePosition,t.howMany);let i=null,n=[];e.containsRange(s,!0)?i=s:s.start.hasSameParentAs(e.start)?(n=s.getDifference(e),i=s.getIntersection(e)):n=[s];const r=[];for(let o of n){o=o._getTransformedByDeletion(t.sourcePosition,t.howMany);const l=t.getMovedRangeStart(),a=o.start.hasSameParentAs(l),c=o._getTransformedByInsertion(l,t.howMany,a);r.push(...c)}return i&&r.push(i._getTransformedByMove(t.sourcePosition,t.targetPosition,t.howMany,!1)[0]),r}et(Kt,bt,(s,t)=>{if(s.range.end.isEqual(t.insertionPosition))return t.graveyardPosition||s.range.end.offset++,[s];if(s.range.start.hasSameParentAs(t.splitPosition)&&s.range.containsPosition(t.splitPosition)){const e=s.clone();return e.range=new K(t.moveTargetPosition.clone(),s.range.end._getCombined(t.splitPosition,t.moveTargetPosition)),s.range.end=t.splitPosition.clone(),s.range.end.stickiness="toPrevious",[s,e]}return s.range=s.range._getTransformedBySplitOperation(t),[s]});et(vi,Kt,(s,t)=>{const e=[s];if(s.shouldReceiveAttributes&&s.position.hasSameParentAs(t.range.start)&&t.range.containsPosition(s.position)){const i=LA(s,t.key,t.newValue);i&&e.push(i)}return e});et(vi,vi,(s,t,e)=>s.position.isEqual(t.position)&&e.aIsStrong?[s]:(s.position=s.position._getTransformedByInsertOperation(t),[s]));et(vi,ct,(s,t)=>(s.position=s.position._getTransformedByMoveOperation(t),[s]));et(vi,bt,(s,t)=>(s.position=s.position._getTransformedBySplitOperation(t),[s]));et(vi,Zt,(s,t)=>(s.position=s.position._getTransformedByMergeOperation(t),[s]));et(tn,vi,(s,t)=>(s.oldRange&&(s.oldRange=s.oldRange._getTransformedByInsertOperation(t)[0]),s.newRange&&(s.newRange=s.newRange._getTransformedByInsertOperation(t)[0]),[s]));et(tn,tn,(s,t,e)=>{if(s.name==t.name)if(e.aIsStrong)s.oldRange=t.newRange?t.newRange.clone():null;else return[new ui(0)];return[s]});et(tn,Zt,(s,t)=>(s.oldRange&&(s.oldRange=s.oldRange._getTransformedByMergeOperation(t)),s.newRange&&(s.newRange=s.newRange._getTransformedByMergeOperation(t)),[s]));et(tn,ct,(s,t)=>{const e=[s];if(s.oldRange&&(s.oldRange=K._createFromRanges(s.oldRange._getTransformedByMoveOperation(t))),s.newRange){const i=s.newRange._getTransformedByMoveOperation(t);s.newRange=i[0];for(let n=1;n<i.length;n++){const r=s.clone();r.oldRange=null,r.newRange=i[n],r.baseVersion=-1,e.push(r)}}return e});et(tn,bt,(s,t,e)=>{if(s.oldRange&&(s.oldRange=s.oldRange._getTransformedBySplitOperation(t)),s.newRange){if(e.abRelation){const i=s.newRange._getTransformedBySplitOperation(t);return s.newRange.start.isEqual(t.splitPosition)?e.abRelation.wasStartBeforeMergedElement?s.newRange.start=ne._createAt(t.insertionPosition):e.abRelation.wasInLeftElement?s.newRange.start=ne._createAt(s.newRange.start):s.newRange.start=ne._createAt(t.moveTargetPosition):s.newRange.start=i.start,s.newRange.end.isEqual(t.splitPosition)?s.newRange.end.isEqual(t.splitPosition)&&e.abRelation.wasEndBeforeMergedElement?s.newRange.end=ne._createAt(t.insertionPosition):e.abRelation.wasInRightElement?s.newRange.end=ne._createAt(t.moveTargetPosition):s.newRange.end=ne._createAt(s.newRange.end):s.newRange.end=i.end,[s]}s.newRange=s.newRange._getTransformedBySplitOperation(t)}return[s]});et(Zt,vi,(s,t)=>(s.sourcePosition.hasSameParentAs(t.position)&&(s.howMany+=t.howMany),s.sourcePosition=s.sourcePosition._getTransformedByInsertOperation(t),s.targetPosition=s.targetPosition._getTransformedByInsertOperation(t),[s]));et(Zt,Zt,(s,t,e)=>{if(s.sourcePosition.isEqual(t.sourcePosition)&&s.targetPosition.isEqual(t.targetPosition))if(e.bWasUndone){const i=t.graveyardPosition.path.slice();return i.push(0),s.sourcePosition=new ne(t.graveyardPosition.root,i),s.howMany=0,[s]}else return[new ui(0)];if(s.sourcePosition.isEqual(t.sourcePosition)&&!s.targetPosition.isEqual(t.targetPosition)&&!e.bWasUndone&&e.abRelation!="splitAtSource"){const i=s.targetPosition.root.rootName=="$graveyard",n=t.targetPosition.root.rootName=="$graveyard";if(n&&!i||!(i&&!n)&&e.aIsStrong){const a=t.targetPosition._getTransformedByMergeOperation(t),c=s.targetPosition._getTransformedByMergeOperation(t);return[new ct(a,s.howMany,c,0)]}else return[new ui(0)]}return s.sourcePosition.hasSameParentAs(t.targetPosition)&&(s.howMany+=t.howMany),s.sourcePosition=s.sourcePosition._getTransformedByMergeOperation(t),s.targetPosition=s.targetPosition._getTransformedByMergeOperation(t),(!s.graveyardPosition.isEqual(t.graveyardPosition)||!e.aIsStrong)&&(s.graveyardPosition=s.graveyardPosition._getTransformedByMergeOperation(t)),[s]});et(Zt,ct,(s,t,e)=>{const i=K._createFromPositionAndShift(t.sourcePosition,t.howMany);return t.type=="remove"&&!e.bWasUndone&&s.deletionPosition.hasSameParentAs(t.sourcePosition)&&i.containsPosition(s.sourcePosition)?[new ui(0)]:(t.sourcePosition.getShiftedBy(t.howMany).isEqual(s.sourcePosition)?s.sourcePosition.stickiness="toNone":t.targetPosition.isEqual(s.sourcePosition)&&e.abRelation=="mergeSourceAffected"?s.sourcePosition.stickiness="toNext":t.sourcePosition.isEqual(s.targetPosition)?(s.targetPosition.stickiness="toNone",s.howMany-=t.howMany):t.targetPosition.isEqual(s.targetPosition)&&e.abRelation=="mergeTargetWasBefore"?(s.targetPosition.stickiness="toPrevious",s.howMany+=t.howMany):(s.sourcePosition.hasSameParentAs(t.targetPosition)&&(s.howMany+=t.howMany),s.sourcePosition.hasSameParentAs(t.sourcePosition)&&(s.howMany-=t.howMany)),s.sourcePosition=s.sourcePosition._getTransformedByMoveOperation(t),s.targetPosition=s.targetPosition._getTransformedByMoveOperation(t),s.sourcePosition.stickiness="toPrevious",s.targetPosition.stickiness="toNext",s.graveyardPosition.isEqual(t.targetPosition)||(s.graveyardPosition=s.graveyardPosition._getTransformedByMoveOperation(t)),[s])});et(Zt,bt,(s,t,e)=>{if(t.graveyardPosition&&(s.graveyardPosition=s.graveyardPosition._getTransformedByDeletion(t.graveyardPosition,1),s.deletionPosition.isEqual(t.graveyardPosition)&&(s.howMany=t.howMany)),s.targetPosition.isEqual(t.splitPosition)&&(t.graveyardPosition&&s.deletionPosition.isEqual(t.graveyardPosition)||e.abRelation=="mergeTargetNotMoved"))return s.sourcePosition=s.sourcePosition._getTransformedBySplitOperation(t),[s];if(s.sourcePosition.isEqual(t.splitPosition)){if(e.abRelation=="mergeSourceNotMoved")return s.howMany=0,s.targetPosition=s.targetPosition._getTransformedBySplitOperation(t),[s];if(e.abRelation=="mergeSameElement"||s.sourcePosition.offset>0)return s.sourcePosition=t.moveTargetPosition.clone(),s.targetPosition=s.targetPosition._getTransformedBySplitOperation(t),[s]}return s.sourcePosition.hasSameParentAs(t.splitPosition)&&(s.howMany=t.splitPosition.offset),s.sourcePosition=s.sourcePosition._getTransformedBySplitOperation(t),s.targetPosition=s.targetPosition._getTransformedBySplitOperation(t),[s]});et(ct,vi,(s,t)=>{const i=K._createFromPositionAndShift(s.sourcePosition,s.howMany)._getTransformedByInsertOperation(t,!1)[0];return s.sourcePosition=i.start,s.howMany=i.end.offset-i.start.offset,s.targetPosition.isEqual(t.position)||(s.targetPosition=s.targetPosition._getTransformedByInsertOperation(t)),[s]});et(ct,ct,(s,t,e)=>{const i=K._createFromPositionAndShift(s.sourcePosition,s.howMany),n=K._createFromPositionAndShift(t.sourcePosition,t.howMany);let r=e.aIsStrong,o=!e.aIsStrong;e.abRelation=="insertBefore"||e.baRelation=="insertAfter"?o=!0:(e.abRelation=="insertAfter"||e.baRelation=="insertBefore")&&(o=!1);let l;if(s.targetPosition.isEqual(t.targetPosition)&&o?l=s.targetPosition._getTransformedByDeletion(t.sourcePosition,t.howMany):l=s.targetPosition._getTransformedByMove(t.sourcePosition,t.targetPosition,t.howMany),pC(s,t)&&pC(t,s))return[t.getReversed()];if(i.containsPosition(t.targetPosition)&&i.containsRange(n,!0))return i.start=i.start._getTransformedByMove(t.sourcePosition,t.targetPosition,t.howMany),i.end=i.end._getTransformedByMove(t.sourcePosition,t.targetPosition,t.howMany),Xa([i],l);if(n.containsPosition(s.targetPosition)&&n.containsRange(i,!0))return i.start=i.start._getCombined(t.sourcePosition,t.getMovedRangeStart()),i.end=i.end._getCombined(t.sourcePosition,t.getMovedRangeStart()),Xa([i],l);const h=Ni(s.sourcePosition.getParentPath(),t.sourcePosition.getParentPath());if(h=="prefix"||h=="extension")return i.start=i.start._getTransformedByMove(t.sourcePosition,t.targetPosition,t.howMany),i.end=i.end._getTransformedByMove(t.sourcePosition,t.targetPosition,t.howMany),Xa([i],l);s.type=="remove"&&t.type!="remove"&&!e.aWasUndone&&!e.forceWeakRemove?r=!0:s.type!="remove"&&t.type=="remove"&&!e.bWasUndone&&!e.forceWeakRemove&&(r=!1);const f=[],m=i.getDifference(n);for(const O of m){O.start=O.start._getTransformedByDeletion(t.sourcePosition,t.howMany),O.end=O.end._getTransformedByDeletion(t.sourcePosition,t.howMany);const _=Ni(O.start.getParentPath(),t.getMovedRangeStart().getParentPath())=="same",k=O._getTransformedByInsertion(t.getMovedRangeStart(),t.howMany,_);f.push(...k)}const w=i.getIntersection(n);return w!==null&&r&&(w.start=w.start._getCombined(t.sourcePosition,t.getMovedRangeStart()),w.end=w.end._getCombined(t.sourcePosition,t.getMovedRangeStart()),f.length===0?f.push(w):f.length==1?n.start.isBefore(i.start)||n.start.isEqual(i.start)?f.unshift(w):f.push(w):f.splice(1,0,w)),f.length===0?[new ui(s.baseVersion)]:Xa(f,l)});et(ct,bt,(s,t,e)=>{let i=s.targetPosition.clone();(!s.targetPosition.isEqual(t.insertionPosition)||!t.graveyardPosition||e.abRelation=="moveTargetAfter")&&(i=s.targetPosition._getTransformedBySplitOperation(t));const n=K._createFromPositionAndShift(s.sourcePosition,s.howMany);if(n.end.isEqual(t.insertionPosition))return t.graveyardPosition||s.howMany++,s.targetPosition=i,[s];if(n.start.hasSameParentAs(t.splitPosition)&&n.containsPosition(t.splitPosition)){let l=new K(t.splitPosition,n.end);l=l._getTransformedBySplitOperation(t);const a=[new K(n.start,t.splitPosition),l];return Xa(a,i)}s.targetPosition.isEqual(t.splitPosition)&&e.abRelation=="insertAtSource"&&(i=t.moveTargetPosition),s.targetPosition.isEqual(t.insertionPosition)&&e.abRelation=="insertBetween"&&(i=s.targetPosition);const o=[n._getTransformedBySplitOperation(t)];if(t.graveyardPosition){const l=n.start.isEqual(t.graveyardPosition)||n.containsPosition(t.graveyardPosition);s.howMany>1&&l&&!e.aWasUndone&&o.push(K._createFromPositionAndShift(t.insertionPosition,1))}return Xa(o,i)});et(ct,Zt,(s,t,e)=>{const i=K._createFromPositionAndShift(s.sourcePosition,s.howMany);if(t.deletionPosition.hasSameParentAs(s.sourcePosition)&&i.containsPosition(t.sourcePosition)){if(s.type=="remove"&&!e.forceWeakRemove){if(!e.aWasUndone){const o=[];let l=t.graveyardPosition.clone(),a=t.targetPosition._getTransformedByMergeOperation(t);const c=s.targetPosition.getTransformedByOperation(t);s.howMany>1&&(o.push(new ct(s.sourcePosition,s.howMany-1,c,0)),l=l._getTransformedByMove(s.sourcePosition,c,s.howMany-1),a=a._getTransformedByMove(s.sourcePosition,c,s.howMany-1));const h=t.deletionPosition._getCombined(s.sourcePosition,c),f=new ct(l,1,h,0),m=f.getMovedRangeStart().path.slice();m.push(0);const w=new ne(f.targetPosition.root,m);a=a._getTransformedByMove(l,h,1);const O=new ct(a,t.howMany,w,0);return o.push(f),o.push(O),o}}else if(s.howMany==1)return e.bWasUndone?(s.sourcePosition=t.graveyardPosition.clone(),s.targetPosition=s.targetPosition._getTransformedByMergeOperation(t),[s]):[new ui(0)]}const r=K._createFromPositionAndShift(s.sourcePosition,s.howMany)._getTransformedByMergeOperation(t);return s.sourcePosition=r.start,s.howMany=r.end.offset-r.start.offset,s.targetPosition=s.targetPosition._getTransformedByMergeOperation(t),[s]});et(vn,vi,(s,t)=>(s.position=s.position._getTransformedByInsertOperation(t),[s]));et(vn,Zt,(s,t)=>s.position.isEqual(t.deletionPosition)?(s.position=t.graveyardPosition.clone(),s.position.stickiness="toNext",[s]):(s.position=s.position._getTransformedByMergeOperation(t),[s]));et(vn,ct,(s,t)=>(s.position=s.position._getTransformedByMoveOperation(t),[s]));et(vn,vn,(s,t,e)=>{if(s.position.isEqual(t.position))if(e.aIsStrong)s.oldName=t.newName;else return[new ui(0)];return[s]});et(vn,bt,(s,t)=>{const e=s.position.path,i=t.splitPosition.getParentPath();if(Ni(e,i)=="same"&&!t.graveyardPosition){const n=new vn(s.position.getShiftedBy(1),s.oldName,s.newName,0);return[s,n]}return s.position=s.position._getTransformedBySplitOperation(t),[s]});et(Rr,Rr,(s,t,e)=>{if(s.root===t.root&&s.key===t.key){if(!e.aIsStrong||s.newValue===t.newValue)return[new ui(0)];s.oldValue=t.newValue}return[s]});et(rr,rr,(s,t)=>s.rootName===t.rootName&&s.isAdd===t.isAdd?[new ui(0)]:[s]);et(bt,vi,(s,t)=>(s.splitPosition.hasSameParentAs(t.position)&&s.splitPosition.offset<t.position.offset&&(s.howMany+=t.howMany),s.splitPosition=s.splitPosition._getTransformedByInsertOperation(t),s.insertionPosition=s.insertionPosition._getTransformedByInsertOperation(t),[s]));et(bt,Zt,(s,t,e)=>{if(!s.graveyardPosition&&!e.bWasUndone&&s.splitPosition.hasSameParentAs(t.sourcePosition)){const i=t.graveyardPosition.path.slice();i.push(0);const n=new ne(t.graveyardPosition.root,i),r=bt.getInsertionPosition(new ne(t.graveyardPosition.root,i)),o=new bt(n,0,r,null,0);return s.splitPosition=s.splitPosition._getTransformedByMergeOperation(t),s.insertionPosition=bt.getInsertionPosition(s.splitPosition),s.graveyardPosition=o.insertionPosition.clone(),s.graveyardPosition.stickiness="toNext",[o,s]}return s.splitPosition.hasSameParentAs(t.deletionPosition)&&!s.splitPosition.isAfter(t.deletionPosition)&&s.howMany--,s.splitPosition.hasSameParentAs(t.targetPosition)&&(s.howMany+=t.howMany),s.splitPosition=s.splitPosition._getTransformedByMergeOperation(t),s.insertionPosition=bt.getInsertionPosition(s.splitPosition),s.graveyardPosition&&(s.graveyardPosition=s.graveyardPosition._getTransformedByMergeOperation(t)),[s]});et(bt,ct,(s,t,e)=>{const i=K._createFromPositionAndShift(t.sourcePosition,t.howMany);if(s.graveyardPosition){const r=i.start.isEqual(s.graveyardPosition)||i.containsPosition(s.graveyardPosition);if(!e.bWasUndone&&r){const o=s.splitPosition._getTransformedByMoveOperation(t),l=s.graveyardPosition._getTransformedByMoveOperation(t),a=l.path.slice();a.push(0);const c=new ne(l.root,a);return[new ct(o,s.howMany,c,0)]}s.graveyardPosition=s.graveyardPosition._getTransformedByMoveOperation(t)}const n=s.splitPosition.isEqual(t.targetPosition);if(n&&(e.baRelation=="insertAtSource"||e.abRelation=="splitBefore"))return s.howMany+=t.howMany,s.splitPosition=s.splitPosition._getTransformedByDeletion(t.sourcePosition,t.howMany),s.insertionPosition=bt.getInsertionPosition(s.splitPosition),[s];if(n&&e.abRelation&&e.abRelation.howMany){const{howMany:r,offset:o}=e.abRelation;return s.howMany+=r,s.splitPosition=s.splitPosition.getShiftedBy(o),[s]}if(s.splitPosition.hasSameParentAs(t.sourcePosition)&&i.containsPosition(s.splitPosition)){const r=t.howMany-(s.splitPosition.offset-t.sourcePosition.offset);return s.howMany-=r,s.splitPosition.hasSameParentAs(t.targetPosition)&&s.splitPosition.offset<t.targetPosition.offset&&(s.howMany+=t.howMany),s.splitPosition=t.sourcePosition.clone(),s.insertionPosition=bt.getInsertionPosition(s.splitPosition),[s]}return t.sourcePosition.isEqual(t.targetPosition)||(s.splitPosition.hasSameParentAs(t.sourcePosition)&&s.splitPosition.offset<=t.sourcePosition.offset&&(s.howMany-=t.howMany),s.splitPosition.hasSameParentAs(t.targetPosition)&&s.splitPosition.offset<t.targetPosition.offset&&(s.howMany+=t.howMany)),s.splitPosition.stickiness="toNone",s.splitPosition=s.splitPosition._getTransformedByMoveOperation(t),s.splitPosition.stickiness="toNext",s.graveyardPosition?s.insertionPosition=s.insertionPosition._getTransformedByMoveOperation(t):s.insertionPosition=bt.getInsertionPosition(s.splitPosition),[s]});et(bt,bt,(s,t,e)=>{if(s.splitPosition.isEqual(t.splitPosition)){if(!s.graveyardPosition&&!t.graveyardPosition)return[new ui(0)];if(s.graveyardPosition&&t.graveyardPosition&&s.graveyardPosition.isEqual(t.graveyardPosition))return[new ui(0)];if(e.abRelation=="splitBefore")return s.howMany=0,s.graveyardPosition=s.graveyardPosition._getTransformedBySplitOperation(t),[s]}if(s.graveyardPosition&&t.graveyardPosition&&s.graveyardPosition.isEqual(t.graveyardPosition)){const i=s.splitPosition.root.rootName=="$graveyard",n=t.splitPosition.root.rootName=="$graveyard";if(n&&!i||!(i&&!n)&&e.aIsStrong){const a=[];return t.howMany&&a.push(new ct(t.moveTargetPosition,t.howMany,t.splitPosition,0)),s.howMany&&a.push(new ct(s.splitPosition,s.howMany,s.moveTargetPosition,0)),a}else return[new ui(0)]}if(s.graveyardPosition&&(s.graveyardPosition=s.graveyardPosition._getTransformedBySplitOperation(t)),s.splitPosition.isEqual(t.insertionPosition)&&e.abRelation=="splitBefore")return s.howMany++,[s];if(t.splitPosition.isEqual(s.insertionPosition)&&e.baRelation=="splitBefore"){const i=t.insertionPosition.path.slice();i.push(0);const n=new ne(t.insertionPosition.root,i),r=new ct(s.insertionPosition,1,n,0);return[s,r]}return s.splitPosition.hasSameParentAs(t.splitPosition)&&s.splitPosition.offset<t.splitPosition.offset&&(s.howMany-=t.howMany),s.splitPosition=s.splitPosition._getTransformedBySplitOperation(t),s.insertionPosition=bt.getInsertionPosition(s.splitPosition),[s]});function pC(s,t){return s.targetPosition._getTransformedByDeletion(t.sourcePosition,t.howMany)===null}function Xa(s,t){const e=[];for(let i=0;i<s.length;i++){const n=s[i],r=new ct(n.start,n.end.offset-n.start.offset,t,0);e.push(r);for(let o=i+1;o<s.length;o++)s[o]=s[o]._getTransformedByMove(r.sourcePosition,r.targetPosition,r.howMany)[0];t=t._getTransformedByMove(r.sourcePosition,r.targetPosition,r.howMany)}return e}class Xt extends pt(ne){constructor(t,e,i="toNone"){if(super(t,e,i),!this.root.is("rootElement"))throw new E("model-liveposition-root-not-rootelement",t);rN.call(this)}detach(){this.stopListening()}toPosition(){return new ne(this.root,this.path.slice(),this.stickiness)}static fromPosition(t,e){return new this(t.root,t.path.slice(),e||t.stickiness)}}Xt.prototype.is=function(s){return s==="livePosition"||s==="model:livePosition"||s=="position"||s==="model:position"};function rN(){this.listenTo(this.root.document.model,"applyOperation",(s,t)=>{const e=t[0];e.isDocumentOperation&&oN.call(this,e)},{priority:"low"})}function oN(s){const t=this.getTransformedByOperation(s);if(!this.isEqual(t)){const e=this.toPosition();this.path=t.path,this.root=t.root,this.fire("change",e)}}class Sa{constructor(t={}){p(this,"operations");p(this,"isUndoable");p(this,"isLocal");p(this,"isUndo");p(this,"isTyping");typeof t=="string"&&(t=t==="transparent"?{isUndoable:!1}:{},Ue("batch-constructor-deprecated-string-type"));const{isUndoable:e=!0,isLocal:i=!0,isUndo:n=!1,isTyping:r=!1}=t;this.operations=[],this.isUndoable=e,this.isLocal=i,this.isUndo=n,this.isTyping=r}get type(){return Ue("batch-type-deprecated"),"default"}get baseVersion(){for(const t of this.operations)if(t.baseVersion!==null)return t.baseVersion;return null}addOperation(t){return t.isDocumentOperation&&(t.batch=this,this.operations.push(t)),t}}const _h=class _h{constructor(t){p(this,"_markerCollection");p(this,"_changesInElement",new Map);p(this,"_elementsSnapshots",new Map);p(this,"_elementChildrenSnapshots",new Map);p(this,"_elementState",new Map);p(this,"_changedMarkers",new Map);p(this,"_changedRoots",new Map);p(this,"_changeCount",0);p(this,"_cachedChanges",null);p(this,"_cachedChangesWithGraveyard",null);p(this,"_refreshedItems",new Set);this._markerCollection=t}get isEmpty(){return this._changesInElement.size==0&&this._changedMarkers.size==0&&this._changedRoots.size==0}bufferOperation(t){const e=t;switch(e.type){case"insert":{if(this._isInInsertedElement(e.position.parent))return;this._markInsert(e.position.parent,e.position.offset,e.nodes.maxOffset);break}case"addAttribute":case"removeAttribute":case"changeAttribute":{for(const i of e.range.getItems({shallow:!0}))this._isInInsertedElement(i.parent)||this._markAttribute(i);break}case"remove":case"move":case"reinsert":{if(e.sourcePosition.isEqual(e.targetPosition)||e.sourcePosition.getShiftedBy(e.howMany).isEqual(e.targetPosition))return;const i=this._isInInsertedElement(e.sourcePosition.parent),n=this._isInInsertedElement(e.targetPosition.parent);i||this._markRemove(e.sourcePosition.parent,e.sourcePosition.offset,e.howMany),n||this._markInsert(e.targetPosition.parent,e.getMovedRangeStart().offset,e.howMany);const r=K._createFromPositionAndShift(e.sourcePosition,e.howMany);for(const o of r.getItems({shallow:!0}))this._setElementState(o,"move");break}case"rename":{if(this._isInInsertedElement(e.position.parent))return;this._markRemove(e.position.parent,e.position.offset,1),this._markInsert(e.position.parent,e.position.offset,1);const i=K._createFromPositionAndShift(e.position,1);for(const n of this._markerCollection.getMarkersIntersectingRange(i)){const r=n.getData();this.bufferMarkerChange(n.name,r,r)}this._setElementState(e.position.nodeAfter,"rename");break}case"split":{const i=e.splitPosition.parent;if(!this._isInInsertedElement(i)){this._markRemove(i,e.splitPosition.offset,e.howMany);const n=K._createFromPositionAndShift(e.splitPosition,e.howMany);for(const r of n.getItems({shallow:!0}))this._setElementState(r,"move")}this._isInInsertedElement(e.insertionPosition.parent)||this._markInsert(e.insertionPosition.parent,e.insertionPosition.offset,1),e.graveyardPosition&&(this._markRemove(e.graveyardPosition.parent,e.graveyardPosition.offset,1),this._setElementState(e.graveyardPosition.nodeAfter,"move"));break}case"merge":{const i=e.sourcePosition.parent;this._isInInsertedElement(i.parent)||this._markRemove(i.parent,i.startOffset,1);const n=e.graveyardPosition.parent;this._markInsert(n,e.graveyardPosition.offset,1),this._setElementState(i,"move");const r=e.targetPosition.parent;if(!this._isInInsertedElement(r)){this._markInsert(r,e.targetPosition.offset,i.maxOffset);const o=K._createFromPositionAndShift(e.sourcePosition,e.howMany);for(const l of o.getItems({shallow:!0}))this._setElementState(l,"move")}break}case"detachRoot":case"addRoot":{const i=e.affectedSelectable;if(!i._isLoaded||i.isAttached()==e.isAdd)return;this._bufferRootStateChange(e.rootName,e.isAdd);break}case"addRootAttribute":case"removeRootAttribute":case"changeRootAttribute":{if(!e.root._isLoaded)return;const i=e.root.rootName;this._bufferRootAttributeChange(i,e.key,e.oldValue,e.newValue);break}}this._cachedChanges=null}bufferMarkerChange(t,e,i){e.range&&e.range.root.is("rootElement")&&!e.range.root._isLoaded&&(e.range=null),i.range&&i.range.root.is("rootElement")&&!i.range.root._isLoaded&&(i.range=null);let n=this._changedMarkers.get(t);n?n.newMarkerData=i:(n={newMarkerData:i,oldMarkerData:e},this._changedMarkers.set(t,n)),n.oldMarkerData.range==null&&i.range==null&&this._changedMarkers.delete(t)}getMarkersToRemove(){const t=[];for(const[e,i]of this._changedMarkers)i.oldMarkerData.range!=null&&t.push({name:e,range:i.oldMarkerData.range});return t}getMarkersToAdd(){const t=[];for(const[e,i]of this._changedMarkers)i.newMarkerData.range!=null&&t.push({name:e,range:i.newMarkerData.range});return t}getChangedMarkers(){return Array.from(this._changedMarkers).map(([t,e])=>({name:t,data:{oldRange:e.oldMarkerData.range,newRange:e.newMarkerData.range}}))}hasDataChanges(){if(this.getChanges().length||this._changedRoots.size>0)return!0;for(const{newMarkerData:t,oldMarkerData:e}of this._changedMarkers.values()){if(t.affectsData!==e.affectsData)return!0;if(t.affectsData){const i=t.range&&!e.range,n=!t.range&&e.range,r=t.range&&e.range&&!t.range.isEqual(e.range);if(i||n||r)return!0}}return!1}getChanges(t={}){if(this._cachedChanges)return t.includeChangesInGraveyard?this._cachedChangesWithGraveyard.slice():this._cachedChanges.slice();let e=[];for(const i of this._changesInElement.keys()){const n=this._changesInElement.get(i).sort((h,f)=>h.offset===f.offset?h.type!=f.type?h.type=="remove"?-1:1:0:h.offset<f.offset?-1:1),r=this._elementChildrenSnapshots.get(i),o=xC(i.getChildren()),l=lN(r.length,n);let a=0,c=0;for(const h of l)if(h==="i"){const f=this._getDiffActionForNode(o[a].node,"insert"),m=this._elementsSnapshots.get(o[a].node),w=this._getInsertDiff(i,a,f,o[a],m);e.push(w),a++}else if(h==="r"){const f=this._getDiffActionForNode(r[c].node,"remove"),m=this._getRemoveDiff(i,a,f,r[c]);e.push(m),c++}else if(h==="a"){const f=r[c].attributes,m=o[a].attributes;let w;if(o[a].name=="$text")w=new K(ne._createAt(i,a),ne._createAt(i,a+1));else{const _=i.offsetToIndex(a);w=new K(ne._createAt(i,a),ne._createAt(i.getChild(_),0))}const O=this._getAttributesDiff(w,f,m);e.push(...O),a++,c++}else a++,c++}e.sort((i,n)=>i.position.root!=n.position.root?i.position.root.rootName<n.position.root.rootName?-1:1:i.position.isEqual(n.position)?i.changeCount-n.changeCount:i.position.isBefore(n.position)?-1:1);for(let i=1,n=0;i<e.length;i++){const r=e[n],o=e[i],l=r.type=="remove"&&o.type=="remove"&&r.name=="$text"&&o.name=="$text"&&r.position.isEqual(o.position),a=r.type=="insert"&&o.type=="insert"&&r.name=="$text"&&o.name=="$text"&&r.position.parent==o.position.parent&&r.position.offset+r.length==o.position.offset,c=r.type=="attribute"&&o.type=="attribute"&&r.position.parent==o.position.parent&&r.range.isFlat&&o.range.isFlat&&r.position.offset+r.length==o.position.offset&&r.attributeKey==o.attributeKey&&r.attributeOldValue==o.attributeOldValue&&r.attributeNewValue==o.attributeNewValue;l||a||c?(r.length++,c&&(r.range.end=r.range.end.getShiftedBy(1)),e[i]=null):n=i}e=e.filter(i=>i);for(const i of e)delete i.changeCount,i.type=="attribute"&&(delete i.position,delete i.length);return this._changeCount=0,this._cachedChangesWithGraveyard=e,this._cachedChanges=e.filter(aN),t.includeChangesInGraveyard?this._cachedChangesWithGraveyard.slice():this._cachedChanges.slice()}getChangedRoots(){return Array.from(this._changedRoots.values()).map(t=>{const e={...t};return e.state!==void 0&&delete e.attributes,e})}getRefreshedItems(){return new Set(this._refreshedItems)}reset(){this._changesInElement.clear(),this._elementChildrenSnapshots.clear(),this._elementsSnapshots.clear(),this._elementState.clear(),this._changedMarkers.clear(),this._changedRoots.clear(),this._refreshedItems.clear(),this._cachedChanges=null}_refreshItem(t){if(this._isInInsertedElement(t.parent))return;this._markRemove(t.parent,t.startOffset,t.offsetSize),this._markInsert(t.parent,t.startOffset,t.offsetSize),this._refreshedItems.add(t),this._setElementState(t,"refresh");const e=K._createOn(t);for(const i of this._markerCollection.getMarkersIntersectingRange(e)){const n=i.getData();this.bufferMarkerChange(i.name,n,n)}this._cachedChanges=null}_bufferRootLoad(t){if(t.isAttached()){this._bufferRootStateChange(t.rootName,!0),this._markInsert(t,0,t.maxOffset);for(const e of t.getAttributeKeys())this._bufferRootAttributeChange(t.rootName,e,null,t.getAttribute(e));for(const e of this._markerCollection)if(e.getRange().root==t){const i=e.getData();this.bufferMarkerChange(e.name,{...i,range:null},i)}}}_bufferRootStateChange(t,e){if(!this._changedRoots.has(t)){this._changedRoots.set(t,{name:t,state:e?"attached":"detached"});return}const i=this._changedRoots.get(t);i.state!==void 0?(delete i.state,i.attributes===void 0&&this._changedRoots.delete(t)):i.state=e?"attached":"detached"}_bufferRootAttributeChange(t,e,i,n){const r=this._changedRoots.get(t)||{name:t},o=r.attributes||{};if(o[e]){const l=o[e];n===l.oldValue?delete o[e]:l.newValue=n}else o[e]={oldValue:i,newValue:n};Object.entries(o).length===0?(delete r.attributes,r.state===void 0&&this._changedRoots.delete(t)):(r.attributes=o,this._changedRoots.set(t,r))}_markInsert(t,e,i){if(t.root.is("rootElement")&&!t.root._isLoaded)return;const n={type:"insert",offset:e,howMany:i,count:this._changeCount++};this._markChange(t,n)}_markRemove(t,e,i){if(t.root.is("rootElement")&&!t.root._isLoaded)return;const n={type:"remove",offset:e,howMany:i,count:this._changeCount++};this._markChange(t,n),this._removeAllNestedChanges(t,e,i)}_markAttribute(t){if(t.root.is("rootElement")&&!t.root._isLoaded)return;const e={type:"attribute",offset:t.startOffset,howMany:t.offsetSize,count:this._changeCount++};this._markChange(t.parent,e)}_markChange(t,e){this._makeSnapshots(t);const i=this._getChangesForElement(t);this._handleChange(e,i),i.push(e);for(let n=0;n<i.length;n++)i[n].howMany<1&&(i.splice(n,1),n--)}_setElementState(t,e){if(!t.is("element"))return;const i=_h._statesPriority.indexOf(this._elementState.get(t));_h._statesPriority.indexOf(e)>i&&this._elementState.set(t,e)}_getDiffActionForNode(t,e){if(!t.is("element")||!this._elementsSnapshots.has(t))return e;const i=this._elementState.get(t);return!i||i=="move"?e:i}_getChangesForElement(t){let e;return this._changesInElement.has(t)?e=this._changesInElement.get(t):(e=[],this._changesInElement.set(t,e)),e}_makeSnapshots(t){if(this._elementChildrenSnapshots.has(t))return;const e=xC(t.getChildren());this._elementChildrenSnapshots.set(t,e);for(const i of e)this._elementsSnapshots.set(i.node,i)}_handleChange(t,e){t.nodesToHandle=t.howMany;for(const i of e){const n=t.offset+t.howMany,r=i.offset+i.howMany;if(t.type=="insert"&&(i.type=="insert"&&(t.offset<=i.offset?i.offset+=t.howMany:t.offset<r&&(i.howMany+=t.nodesToHandle,t.nodesToHandle=0)),i.type=="remove"&&t.offset<i.offset&&(i.offset+=t.howMany),i.type=="attribute")){if(t.offset<=i.offset)i.offset+=t.howMany;else if(t.offset<r){const o=i.howMany;i.howMany=t.offset-i.offset,e.unshift({type:"attribute",offset:n,howMany:o-i.howMany,count:this._changeCount++})}}if(t.type=="remove"){if(i.type=="insert"){if(n<=i.offset)i.offset-=t.howMany;else if(n<=r)if(t.offset<i.offset){const o=n-i.offset;i.offset=t.offset,i.howMany-=o,t.nodesToHandle-=o}else i.howMany-=t.nodesToHandle,t.nodesToHandle=0;else if(t.offset<=i.offset)t.nodesToHandle-=i.howMany,i.howMany=0;else if(t.offset<r){const o=r-t.offset;i.howMany-=o,t.nodesToHandle-=o}}if(i.type=="remove"&&(n<=i.offset?i.offset-=t.howMany:t.offset<i.offset&&(t.nodesToHandle+=i.howMany,i.howMany=0)),i.type=="attribute"){if(n<=i.offset)i.offset-=t.howMany;else if(t.offset<i.offset){const o=n-i.offset;i.offset=t.offset,i.howMany-=o}else if(t.offset<r)if(n<=r){const o=i.howMany;i.howMany=t.offset-i.offset;const l=o-i.howMany-t.nodesToHandle;e.unshift({type:"attribute",offset:t.offset,howMany:l,count:this._changeCount++})}else i.howMany-=r-t.offset}}if(t.type=="attribute"){if(i.type=="insert")if(t.offset<i.offset&&n>i.offset){if(n>r){const o={type:"attribute",offset:r,howMany:n-r,count:this._changeCount++};this._handleChange(o,e),e.push(o)}t.nodesToHandle=i.offset-t.offset,t.howMany=t.nodesToHandle}else t.offset>=i.offset&&t.offset<r&&(n>r?(t.nodesToHandle=n-r,t.offset=r):t.nodesToHandle=0);if(i.type=="remove"&&t.offset<i.offset&&n>i.offset){const o={type:"attribute",offset:i.offset,howMany:n-i.offset,count:this._changeCount++};this._handleChange(o,e),e.push(o),t.nodesToHandle=i.offset-t.offset,t.howMany=t.nodesToHandle}i.type=="attribute"&&(t.offset>=i.offset&&n<=r?(t.nodesToHandle=0,t.howMany=0,t.offset=0):t.offset<=i.offset&&n>=r&&(i.howMany=0))}}t.howMany=t.nodesToHandle,delete t.nodesToHandle}_getInsertDiff(t,e,i,n,r){const o={type:"insert",position:ne._createAt(t,e),name:n.name,attributes:new Map(n.attributes),length:1,changeCount:this._changeCount++,action:i};return i!="insert"&&r&&(o.before={name:r.name,attributes:new Map(r.attributes)}),o}_getRemoveDiff(t,e,i,n){return{type:"remove",action:i,position:ne._createAt(t,e),name:n.name,attributes:new Map(n.attributes),length:1,changeCount:this._changeCount++}}_getAttributesDiff(t,e,i){const n=[];i=new Map(i);for(const[r,o]of e){const l=i.has(r)?i.get(r):null;l!==o&&n.push({type:"attribute",position:t.start,range:t.clone(),length:1,attributeKey:r,attributeOldValue:o,attributeNewValue:l,changeCount:this._changeCount++}),i.delete(r)}for(const[r,o]of i)n.push({type:"attribute",position:t.start,range:t.clone(),length:1,attributeKey:r,attributeOldValue:null,attributeNewValue:o,changeCount:this._changeCount++});return n}_isInInsertedElement(t){const e=t.parent;if(!e)return!1;const i=this._changesInElement.get(e),n=t.startOffset;if(i){for(const r of i)if(r.type=="insert"&&n>=r.offset&&n<r.offset+r.howMany)return!0}return this._isInInsertedElement(e)}_removeAllNestedChanges(t,e,i){const n=new K(ne._createAt(t,e),ne._createAt(t,e+i));for(const r of n.getItems({shallow:!0}))r.is("element")&&(this._changesInElement.delete(r),this._removeAllNestedChanges(r,0,r.maxOffset))}};p(_h,"_statesPriority",[void 0,"refresh","rename","move"]);let Db=_h;function wC(s){return{node:s,name:s.is("$text")?"$text":s.name,attributes:new Map(s.getAttributes())}}function xC(s){const t=[];for(const e of s)if(e.is("$text"))for(let i=0;i<e.data.length;++i)t.push(wC(e));else t.push(wC(e));return t}function lN(s,t){const e=[];let i=0,n=0;for(const r of t){if(r.offset>i){for(let o=0;o<r.offset-i;o++)e.push("e");n+=r.offset-i}if(r.type=="insert"){for(let o=0;o<r.howMany;o++)e.push("i");i=r.offset+r.howMany}else if(r.type=="remove"){for(let o=0;o<r.howMany;o++)e.push("r");i=r.offset,n+=r.howMany}else{if(r.howMany>1500)for(let o=0;o<r.howMany;o++)e.push("a");else e.push(..."a".repeat(r.howMany).split(""));i=r.offset+r.howMany,n+=r.howMany}}if(n<s)for(let r=0;r<s-n-i;r++)e.push("e");return e}function aN(s){const t="position"in s&&s.position.root.rootName=="$graveyard",e="range"in s&&s.range.root.rootName=="$graveyard";return!t&&!e}class cN{constructor(){p(this,"_operations",[]);p(this,"_undoPairs",new Map);p(this,"_undoneOperations",new Set);p(this,"_baseVersionToOperationIndex",new Map);p(this,"_version",0);p(this,"_gaps",new Map)}get version(){return this._version}set version(t){this._operations.length&&t>this._version+1&&this._gaps.set(this._version,t),this._version=t}get lastOperation(){return this._operations[this._operations.length-1]}addOperation(t){if(t.baseVersion!==this.version)throw new E("model-document-history-addoperation-incorrect-version",this,{operation:t,historyVersion:this.version});this._operations.push(t),this._version++,this._baseVersionToOperationIndex.set(t.baseVersion,this._operations.length-1)}getOperations(t,e=this.version){if(!this._operations.length)return[];const i=this._operations[0];t===void 0&&(t=i.baseVersion);let n=e-1;for(const[l,a]of this._gaps)t>l&&t<a&&(t=a),n>l&&n<a&&(n=l-1);if(n<i.baseVersion||t>this.lastOperation.baseVersion)return[];let r=this._baseVersionToOperationIndex.get(t);r===void 0&&(r=0);let o=this._baseVersionToOperationIndex.get(n);return o===void 0&&(o=this._operations.length-1),this._operations.slice(r,o+1)}getOperation(t){const e=this._baseVersionToOperationIndex.get(t);if(e!==void 0)return this._operations[e]}setOperationAsUndone(t,e){this._undoPairs.set(e,t),this._undoneOperations.add(t)}isUndoingOperation(t){return this._undoPairs.has(t)}isUndoneOperation(t){return this._undoneOperations.has(t)}getUndoneOperation(t){return this._undoPairs.get(t)}reset(){this._version=0,this._undoPairs=new Map,this._operations=[],this._undoneOperations=new Set,this._gaps=new Map,this._baseVersionToOperationIndex=new Map}}class bg extends Mt{constructor(e,i,n="main"){super(i);p(this,"rootName");p(this,"_document");p(this,"_isAttached",!0);p(this,"_isLoaded",!0);this._document=e,this.rootName=n}get document(){return this._document}isAttached(){return this._isAttached}toJSON(){return this.rootName}}bg.prototype.is=function(s,t){return t?t===this.name&&(s==="rootElement"||s==="model:rootElement"||s==="element"||s==="model:element"):s==="rootElement"||s==="model:rootElement"||s==="element"||s==="model:element"||s==="node"||s==="model:node"};const bC="$graveyard";class uN extends pt(){constructor(e){super();p(this,"model");p(this,"history");p(this,"selection");p(this,"roots");p(this,"differ");p(this,"isReadOnly");p(this,"_postFixers");p(this,"_hasSelectionChangedFromTheLastChangeBlock");this.model=e,this.history=new cN,this.selection=new Bs(this),this.roots=new di({idProperty:"rootName"}),this.differ=new Db(e.markers),this.isReadOnly=!1,this._postFixers=new Set,this._hasSelectionChangedFromTheLastChangeBlock=!1,this.createRoot("$root",bC),this.listenTo(e,"applyOperation",(i,n)=>{const r=n[0];r.isDocumentOperation&&this.differ.bufferOperation(r)},{priority:"high"}),this.listenTo(e,"applyOperation",(i,n)=>{const r=n[0];r.isDocumentOperation&&this.history.addOperation(r)},{priority:"low"}),this.listenTo(this.selection,"change",()=>{this._hasSelectionChangedFromTheLastChangeBlock=!0}),this.listenTo(e.markers,"update",(i,n,r,o,l)=>{const a={...n.getData(),range:o};this.differ.bufferMarkerChange(n.name,l,a),r===null&&n.on("change",(c,h)=>{const f=n.getData();this.differ.bufferMarkerChange(n.name,{...f,range:h},f)})}),this.registerPostFixer(i=>{let n=!1;for(const r of this.roots)!r.isAttached()&&!r.isEmpty&&(i.remove(i.createRangeIn(r)),n=!0);for(const r of this.model.markers)r.getRange().root.isAttached()||(i.removeMarker(r),n=!0);return n})}get version(){return this.history.version}set version(e){this.history.version=e}get graveyard(){return this.getRoot(bC)}createRoot(e="$root",i="main"){if(this.roots.get(i))throw new E("model-document-createroot-name-exists",this,{name:i});const n=new bg(this,e,i);return this.roots.add(n),n}destroy(){this.selection.destroy(),this.stopListening()}getRoot(e="main"){return this.roots.get(e)}getRootNames(e=!1){return this.getRoots(e).map(i=>i.rootName)}getRoots(e=!1){return this.roots.filter(i=>i!=this.graveyard&&(e||i.isAttached())&&i._isLoaded)}registerPostFixer(e){this._postFixers.add(e)}toJSON(){const e=PO(this);return e.selection="[engine.model.DocumentSelection]",e.model="[engine.model.Model]",e}_handleChangeBlock(e){this._hasDocumentChangedFromTheLastChangeBlock()&&(this._callPostFixers(e),this.selection.refresh(),this.differ.hasDataChanges()?this.fire("change:data",e.batch):this.fire("change",e.batch),this.selection.refresh(),this.differ.reset()),this._hasSelectionChangedFromTheLastChangeBlock=!1}_hasDocumentChangedFromTheLastChangeBlock(){return!this.differ.isEmpty||this._hasSelectionChangedFromTheLastChangeBlock}_getDefaultRoot(){const e=this.getRoots();return e.length?e[0]:this.graveyard}_getDefaultRange(){const e=this._getDefaultRoot(),i=this.model,n=i.schema,r=i.createPositionFromPath(e,[0]);return n.getNearestSelectionRange(r)||i.createRange(r)}_validateSelectionRange(e){return e.start.isValid()&&e.end.isValid()&&OC(e.start)&&OC(e.end)}_callPostFixers(e){let i=!1;do for(const n of this._postFixers)if(this.selection.refresh(),i=n(e),i)break;while(i)}}function OC(s){const t=s.textNode;if(t){const e=t.data,i=s.offset-t.startOffset;return!QO(e,i)&&!NO(e,i)}return!0}class hN extends pt(){constructor(){super(...arguments);p(this,"_markers",new Map)}[Symbol.iterator](){return this._markers.values()}has(e){const i=e instanceof Qa?e.name:e;return this._markers.has(i)}get(e){return this._markers.get(e)||null}_set(e,i,n=!1,r=!1){const o=e instanceof Qa?e.name:e;if(o.includes(","))throw new E("markercollection-incorrect-marker-name",this);const l=this._markers.get(o);if(l){const h=l.getData(),f=l.getRange();let m=!1;return f.isEqual(i)||(l._attachLiveRange(bn.fromRange(i)),m=!0),n!=l.managedUsingOperations&&(l._managedUsingOperations=n,m=!0),typeof r=="boolean"&&r!=l.affectsData&&(l._affectsData=r,m=!0),m&&this.fire(`update:${o}`,l,f,i,h),l}const a=bn.fromRange(i),c=new Qa(o,a,n,r);return this._markers.set(o,c),this.fire(`update:${o}`,c,null,i,{...c.getData(),range:null}),c}_remove(e){const i=e instanceof Qa?e.name:e,n=this._markers.get(i);return n?(this._markers.delete(i),this.fire(`update:${i}`,n,n.getRange(),null,n.getData()),this._destroyMarker(n),!0):!1}_refresh(e){const i=e instanceof Qa?e.name:e,n=this._markers.get(i);if(!n)throw new E("markercollection-refresh-marker-not-exists",this);const r=n.getRange();this.fire(`update:${i}`,n,r,r,n.getData())}*getMarkersAtPosition(e){for(const i of this)i.getRange().containsPosition(e)&&(yield i)}*getMarkersIntersectingRange(e){for(const i of this)i.getRange().getIntersection(e)!==null&&(yield i)}destroy(){for(const e of this._markers.values())this._destroyMarker(e);this._markers=null,this.stopListening()}*getMarkersGroup(e){for(const i of this._markers.values())i.name.startsWith(e+":")&&(yield i)}_destroyMarker(e){e.stopListening(),e._detachLiveRange()}}class Qa extends pt(Fo){constructor(e,i,n,r){super();p(this,"name");p(this,"_managedUsingOperations");p(this,"_affectsData");p(this,"_liveRange");this.name=e,this._liveRange=this._attachLiveRange(i),this._managedUsingOperations=n,this._affectsData=r}get managedUsingOperations(){if(!this._liveRange)throw new E("marker-destroyed",this);return this._managedUsingOperations}get affectsData(){if(!this._liveRange)throw new E("marker-destroyed",this);return this._affectsData}getData(){return{range:this.getRange(),affectsData:this.affectsData,managedUsingOperations:this.managedUsingOperations}}getStart(){if(!this._liveRange)throw new E("marker-destroyed",this);return this._liveRange.start.clone()}getEnd(){if(!this._liveRange)throw new E("marker-destroyed",this);return this._liveRange.end.clone()}getRange(){if(!this._liveRange)throw new E("marker-destroyed",this);return this._liveRange.toRange()}_attachLiveRange(e){return this._liveRange&&this._detachLiveRange(),e.delegate("change:range").to(this),e.delegate("change:content").to(this),this._liveRange=e,e}_detachLiveRange(){this._liveRange.stopDelegating("change:range",this),this._liveRange.stopDelegating("change:content",this),this._liveRange.detach(),this._liveRange=null}}Qa.prototype.is=function(s){return s==="marker"||s==="model:marker"};class dN extends Un{constructor(e,i){super(null);p(this,"sourcePosition");p(this,"howMany");this.sourcePosition=e.clone(),this.howMany=i}get type(){return"detach"}get affectedSelectable(){return null}toJSON(){const e=super.toJSON();return e.sourcePosition=this.sourcePosition.toJSON(),e}_validate(){if(this.sourcePosition.root.document)throw new E("detach-operation-on-document-node",this)}_execute(){RA(K._createFromPositionAndShift(this.sourcePosition,this.howMany))}static get className(){return"DetachOperation"}}class Js extends Fo{constructor(e){super();p(this,"markers",new Map);p(this,"_children",new uh);e&&this._insertChild(0,e)}[Symbol.iterator](){return this.getChildren()}get childCount(){return this._children.length}get maxOffset(){return this._children.maxOffset}get isEmpty(){return this.childCount===0}get nextSibling(){return null}get previousSibling(){return null}get root(){return this}get parent(){return null}get document(){return null}isAttached(){return!1}getAncestors(){return[]}getChild(e){return this._children.getNode(e)}getChildAtOffset(e){return this._children.getNodeAtOffset(e)}getChildren(){return this._children[Symbol.iterator]()}getChildIndex(e){return this._children.getNodeIndex(e)}getChildStartOffset(e){return this._children.getNodeStartOffset(e)}getPath(){return[]}getNodeByPath(e){let i=this;for(const n of e)i=i.getChildAtOffset(n);return i}offsetToIndex(e){return this._children.offsetToIndex(e)}toJSON(){const e=[];for(const i of this._children)e.push(i.toJSON());return e}static fromJSON(e){const i=[];for(const n of e)n.name?i.push(Mt.fromJSON(n)):i.push(Nt.fromJSON(n));return new Js(i)}_appendChild(e){this._insertChild(this.childCount,e)}_insertChild(e,i){const n=fN(i);for(const r of n)r.parent!==null&&r._remove(),r.parent=this;this._children._insertNodes(e,n)}_removeChildren(e,i=1){const n=this._children._removeNodes(e,i);for(const r of n)r.parent=null;return n}_removeChildrenArray(e){this._children._removeNodesArray(e);for(const i of e)i.parent=null}}Js.prototype.is=function(s){return s==="documentFragment"||s==="model:documentFragment"};function fN(s){return typeof s=="string"?[new Nt(s)]:(Wn(s)||(s=[s]),Array.from(s).map(t=>typeof t=="string"?new Nt(t):t instanceof Ms?new Nt(t.data,t.getAttributes()):t))}class mN{constructor(t,e){p(this,"model");p(this,"batch");this.model=t,this.batch=e}createText(t,e){return new Nt(t,e)}createElement(t,e){return new Mt(t,e)}createDocumentFragment(){return new Js}cloneElement(t,e=!0){return t._clone(e)}insert(t,e,i=0){if(this._assertWriterUsedCorrectly(),t instanceof Nt&&t.data=="")return;const n=ne._createAt(e,i);if(t.parent)if(_C(t.root,n.root)){this.move(K._createOn(t),n);return}else{if(t.root.document)throw new E("model-writer-insert-forbidden-move",this);this.remove(t)}const r=n.root.document?n.root.document.version:null,o=t instanceof Js?t._removeChildren(0,t.childCount):t,l=new vi(n,o,r);if(t instanceof Nt&&(l.shouldReceiveAttributes=!0),this.batch.addOperation(l),this.model.applyOperation(l),t instanceof Js)for(const[a,c]of t.markers){const h=ne._createAt(c.root,0),m={range:new K(c.start._getCombined(h,n),c.end._getCombined(h,n)),usingOperation:!0,affectsData:!0};this.model.markers.has(a)?this.updateMarker(a,m):this.addMarker(a,m)}}insertText(t,e,i,n){e instanceof Js||e instanceof Mt||e instanceof ne?this.insert(this.createText(t),e,i):this.insert(this.createText(t,e),i,n)}insertElement(t,e,i,n){e instanceof Js||e instanceof Mt||e instanceof ne?this.insert(this.createElement(t),e,i):this.insert(this.createElement(t,e),i,n)}append(t,e){this.insert(t,e,"end")}appendText(t,e,i){e instanceof Js||e instanceof Mt?this.insert(this.createText(t),e,"end"):this.insert(this.createText(t,e),i,"end")}appendElement(t,e,i){e instanceof Js||e instanceof Mt?this.insert(this.createElement(t),e,"end"):this.insert(this.createElement(t,e),i,"end")}setAttribute(t,e,i){if(this._assertWriterUsedCorrectly(),i instanceof K){const n=i.getMinimalFlatRanges();for(const r of n)yC(this,t,e,r)}else vC(this,t,e,i)}setAttributes(t,e){for(const[i,n]of ms(t))this.setAttribute(i,n,e)}removeAttribute(t,e){if(this._assertWriterUsedCorrectly(),e instanceof K){const i=e.getMinimalFlatRanges();for(const n of i)yC(this,t,null,n)}else vC(this,t,null,e)}clearAttributes(t){this._assertWriterUsedCorrectly();const e=i=>{for(const n of i.getAttributeKeys())this.removeAttribute(n,i)};if(!(t instanceof K))e(t);else for(const i of t.getItems())e(i)}move(t,e,i){if(this._assertWriterUsedCorrectly(),!(t instanceof K))throw new E("writer-move-invalid-range",this);if(!t.isFlat)throw new E("writer-move-range-not-flat",this);const n=ne._createAt(e,i);if(n.isEqual(t.start))return;if(this._addOperationForAffectedMarkers("move",t),!_C(t.root,n.root))throw new E("writer-move-different-document",this);const r=t.root.document?t.root.document.version:null,o=new ct(t.start,t.end.offset-t.start.offset,n,r);this.batch.addOperation(o),this.model.applyOperation(o)}remove(t){this._assertWriterUsedCorrectly();const i=(t instanceof K?t:K._createOn(t)).getMinimalFlatRanges().reverse();for(const n of i)this._addOperationForAffectedMarkers("move",n),gN(n.start,n.end.offset-n.start.offset,this.batch,this.model)}merge(t){this._assertWriterUsedCorrectly();const e=t.nodeBefore,i=t.nodeAfter;if(this._addOperationForAffectedMarkers("merge",t),!(e instanceof Mt))throw new E("writer-merge-no-element-before",this);if(!(i instanceof Mt))throw new E("writer-merge-no-element-after",this);t.root.document?this._merge(t):this._mergeDetached(t)}createPositionFromPath(t,e,i){return this.model.createPositionFromPath(t,e,i)}createPositionAt(t,e){return this.model.createPositionAt(t,e)}createPositionAfter(t){return this.model.createPositionAfter(t)}createPositionBefore(t){return this.model.createPositionBefore(t)}createRange(t,e){return this.model.createRange(t,e)}createRangeIn(t){return this.model.createRangeIn(t)}createRangeOn(t){return this.model.createRangeOn(t)}createSelection(...t){return this.model.createSelection(...t)}_mergeDetached(t){const e=t.nodeBefore,i=t.nodeAfter;this.move(K._createIn(i),ne._createAt(e,"end")),this.remove(i)}_merge(t){const e=ne._createAt(t.nodeBefore,"end"),i=ne._createAt(t.nodeAfter,0),n=t.root.document.graveyard,r=new ne(n,[0]),o=t.root.document.version,l=new Zt(i,t.nodeAfter.maxOffset,e,r,o);this.batch.addOperation(l),this.model.applyOperation(l)}rename(t,e){if(this._assertWriterUsedCorrectly(),!(t instanceof Mt))throw new E("writer-rename-not-element-instance",this);const i=t.root.document?t.root.document.version:null,n=new vn(ne._createBefore(t),t.name,e,i);this.batch.addOperation(n),this.model.applyOperation(n)}split(t,e){this._assertWriterUsedCorrectly();let i=t.parent;if(!i.parent)throw new E("writer-split-element-no-parent",this);if(e||(e=i.parent),!t.parent.getAncestors({includeSelf:!0}).includes(e))throw new E("writer-split-invalid-limit-element",this);let n,r;do{const o=i.root.document?i.root.document.version:null,l=i.maxOffset-t.offset,a=bt.getInsertionPosition(t),c=new bt(t,l,a,null,o);this.batch.addOperation(c),this.model.applyOperation(c),!n&&!r&&(n=i,r=t.parent.nextSibling),t=this.createPositionAfter(t.parent),i=t.parent}while(i!==e);return{position:t,range:new K(ne._createAt(n,"end"),ne._createAt(r,0))}}wrap(t,e){if(this._assertWriterUsedCorrectly(),!t.isFlat)throw new E("writer-wrap-range-not-flat",this);const i=e instanceof Mt?e:new Mt(e);if(i.childCount>0)throw new E("writer-wrap-element-not-empty",this);if(i.parent!==null)throw new E("writer-wrap-element-attached",this);this.insert(i,t.start);const n=new K(t.start.getShiftedBy(1),t.end.getShiftedBy(1));this.move(n,ne._createAt(i,0))}unwrap(t){if(this._assertWriterUsedCorrectly(),t.parent===null)throw new E("writer-unwrap-element-no-parent",this);this.move(K._createIn(t),this.createPositionAfter(t)),this.remove(t)}addMarker(t,e){if(this._assertWriterUsedCorrectly(),!e||typeof e.usingOperation!="boolean")throw new E("writer-addmarker-no-usingoperation",this);const i=e.usingOperation,n=e.range,r=e.affectsData===void 0?!1:e.affectsData;if(this.model.markers.has(t))throw new E("writer-addmarker-marker-exists",this);if(!n)throw new E("writer-addmarker-no-range",this);return i?(Au(this,t,null,n,r),this.model.markers.get(t)):this.model.markers._set(t,n,i,r)}updateMarker(t,e){this._assertWriterUsedCorrectly();const i=typeof t=="string"?t:t.name,n=this.model.markers.get(i);if(!n)throw new E("writer-updatemarker-marker-not-exists",this);if(!e){Ue("writer-updatemarker-reconvert-using-editingcontroller",{markerName:i}),this.model.markers._refresh(n);return}const r=typeof e.usingOperation=="boolean",o=typeof e.affectsData=="boolean",l=o?e.affectsData:n.affectsData;if(!r&&!e.range&&!o)throw new E("writer-updatemarker-wrong-options",this);const a=n.getRange(),c=e.range?e.range:a;if(r&&e.usingOperation!==n.managedUsingOperations){e.usingOperation?Au(this,i,null,c,l):(Au(this,i,a,null,l),this.model.markers._set(i,c,void 0,l));return}n.managedUsingOperations?Au(this,i,a,c,l):this.model.markers._set(i,c,void 0,l)}removeMarker(t){this._assertWriterUsedCorrectly();const e=typeof t=="string"?t:t.name;if(!this.model.markers.has(e))throw new E("writer-removemarker-no-marker",this);const i=this.model.markers.get(e);if(!i.managedUsingOperations){this.model.markers._remove(e);return}const n=i.getRange();Au(this,e,n,null,i.affectsData)}addRoot(t,e="$root"){this._assertWriterUsedCorrectly();const i=this.model.document.getRoot(t);if(i&&i.isAttached())throw new E("writer-addroot-root-exists",this);const n=this.model.document,r=new rr(t,e,!0,n,n.version);return this.batch.addOperation(r),this.model.applyOperation(r),this.model.document.getRoot(t)}detachRoot(t){this._assertWriterUsedCorrectly();const e=typeof t=="string"?this.model.document.getRoot(t):t;if(!e||!e.isAttached())throw new E("writer-detachroot-no-root",this);for(const r of this.model.markers)r.getRange().root===e&&this.removeMarker(r);for(const r of e.getAttributeKeys())this.removeAttribute(r,e);this.remove(this.createRangeIn(e));const i=this.model.document,n=new rr(e.rootName,e.name,!1,i,i.version);this.batch.addOperation(n),this.model.applyOperation(n)}setSelection(...t){this._assertWriterUsedCorrectly(),this.model.document.selection._setTo(...t)}setSelectionFocus(t,e){this._assertWriterUsedCorrectly(),this.model.document.selection._setFocus(t,e)}setSelectionAttribute(t,e){if(this._assertWriterUsedCorrectly(),typeof t=="string")this._setSelectionAttribute(t,e);else for(const[i,n]of ms(t))this._setSelectionAttribute(i,n)}removeSelectionAttribute(t){if(this._assertWriterUsedCorrectly(),typeof t=="string")this._removeSelectionAttribute(t);else for(const e of t)this._removeSelectionAttribute(e)}overrideSelectionGravity(){return this.model.document.selection._overrideGravity()}restoreSelectionGravity(t){this.model.document.selection._restoreGravity(t)}_setSelectionAttribute(t,e){const i=this.model.document.selection;if(i.isCollapsed&&i.anchor.parent.isEmpty){const n=Bs._getStoreAttributeKey(t);this.setAttribute(n,e,i.anchor.parent)}i._setAttribute(t,e)}_removeSelectionAttribute(t){const e=this.model.document.selection;if(e.isCollapsed&&e.anchor.parent.isEmpty){const i=Bs._getStoreAttributeKey(t);this.removeAttribute(i,e.anchor.parent)}e._removeAttribute(t)}_assertWriterUsedCorrectly(){if(this.model._currentWriter!==this)throw new E("writer-incorrect-use",this)}_addOperationForAffectedMarkers(t,e){for(const i of this.model.markers){if(!i.managedUsingOperations)continue;const n=i.getRange();let r=!1;if(t==="move"){const o=e;r=o.containsPosition(n.start)||o.start.isEqual(n.start)||o.containsPosition(n.end)||o.end.isEqual(n.end)}else{const o=e,l=o.nodeBefore,a=o.nodeAfter,c=n.start.parent==l&&n.start.isAtEnd,h=n.end.parent==a&&n.end.offset==0,f=n.end.nodeAfter==a,m=n.start.nodeAfter==a;r=c||h||f||m}r&&this.updateMarker(i.name,{range:n})}}}function yC(s,t,e,i){const n=s.model,r=n.document;let o=i.start,l,a,c;for(const f of i.getWalker({shallow:!0}))c=f.item.getAttribute(t),l&&a!=c&&(a!=e&&h(),o=l),l=f.nextPosition,a=c;l instanceof ne&&l!=o&&a!=e&&h();function h(){const f=new K(o,l),m=f.root.document?r.version:null,w=new Kt(f,t,a,e,m);s.batch.addOperation(w),n.applyOperation(w)}}function vC(s,t,e,i){const n=s.model,r=n.document,o=i.getAttribute(t);let l,a;if(o!=e){if(i.root===i){const h=i.document?r.version:null;a=new Rr(i,t,o,e,h)}else{l=new K(ne._createBefore(i),s.createPositionAfter(i));const h=l.root.document?r.version:null;a=new Kt(l,t,o,e,h)}s.batch.addOperation(a),n.applyOperation(a)}}function Au(s,t,e,i,n){const r=s.model,o=r.document,l=new tn(t,e,i,r.markers,!!n,o.version);s.batch.addOperation(l),r.applyOperation(l)}function gN(s,t,e,i){let n;if(s.root.document){const r=i.document,o=new ne(r.graveyard,[0]);n=new ct(s,t,o,r.version)}else n=new dN(s,t);e.addOperation(n),i.applyOperation(n)}function _C(s,t){return s===t||s instanceof bg&&t instanceof bg}function pN(s){s.document.registerPostFixer(t=>wN(t,s))}function wN(s,t){const e=t.document.selection,i=t.schema,n=[];let r=!1;for(const o of e.getRanges()){const l=GO(o,i);l&&!l.isEqual(o)?(n.push(l),r=!0):n.push(o)}return r&&s.setSelection(yN(n),{backward:e.isBackward}),!1}function GO(s,t){return s.isCollapsed?xN(s,t):bN(s,t)}function xN(s,t){const e=s.start,i=t.getNearestSelectionRange(e);if(!i){const r=e.getAncestors().reverse().find(o=>t.isObject(o));return r?K._createOn(r):null}if(!i.isCollapsed)return i;const n=i.start;return e.isEqual(n)?null:new K(n)}function bN(s,t){const{start:e,end:i}=s,n=t.checkChild(e,"$text"),r=t.checkChild(i,"$text"),o=t.getLimitElement(e),l=t.getLimitElement(i);if(o===l){if(n&&r)return null;if(ON(e,i,t)){const f=e.nodeAfter&&t.isSelectable(e.nodeAfter)?null:t.getNearestSelectionRange(e,"forward"),w=i.nodeBefore&&t.isSelectable(i.nodeBefore)?null:t.getNearestSelectionRange(i,"backward"),O=f?f.start:e,_=w?w.end:i;return new K(O,_)}}const a=o&&!o.is("rootElement"),c=l&&!l.is("rootElement");if(a||c){const h=e.nodeAfter&&i.nodeBefore&&e.nodeAfter.parent===i.nodeBefore.parent,f=a&&(!h||!SC(e.nodeAfter,t)),m=c&&(!h||!SC(i.nodeBefore,t));let w=e,O=i;return f&&(w=ne._createBefore(kC(o,t))),m&&(O=ne._createAfter(kC(l,t))),new K(w,O)}return null}function kC(s,t){let e=s,i=e;for(;t.isLimit(i)&&i.parent;)e=i,i=i.parent;return e}function ON(s,t,e){const i=s.nodeAfter&&!e.isLimit(s.nodeAfter)||e.checkChild(s,"$text"),n=t.nodeBefore&&!e.isLimit(t.nodeBefore)||e.checkChild(t,"$text");return i||n}function yN(s){const t=[...s],e=new Set;let i=1;for(;i<t.length;){const r=t[i],o=t.slice(0,i);for(const[l,a]of o.entries())if(!e.has(l)){if(r.isEqual(a))e.add(l);else if(r.isIntersecting(a)){e.add(l),e.add(i);const c=r.getJoined(a);t.push(c)}}i++}return t.filter((r,o)=>!e.has(o))}function SC(s,t){return s&&t.isSelectable(s)}function vN(s,t,e={}){if(t.isCollapsed)return;const i=t.getFirstRange();if(i.root.rootName=="$graveyard")return;const n=s.schema;s.change(r=>{if(!e.doNotResetEntireContent&&IN(n,t)){AN(r,t);return}const o={};if(!e.doNotAutoparagraph){const c=t.getSelectedElement();c&&Object.assign(o,n.getAttributesWithProperty(c,"copyOnReplace",!0))}let l,a;e.doNotFixSelection?(l=Xt.fromPosition(i.start,"toPrevious"),a=Xt.fromPosition(i.end,"toNext")):[l,a]=_N(i),l.isTouching(a)||r.remove(r.createRange(l,a)),e.leaveUnmerged||(SN(r,l,a),n.removeDisallowedAttributes(l.parent.getChildren(),r)),QA(r,t,l),!e.doNotAutoparagraph&&TN(n,l)&&DA(r,l,t,o),l.detach(),a.detach()})}function _N(s){const t=s.root.document.model,e=s.start;let i=s.end;if(t.hasContent(s,{ignoreMarkers:!0})){const n=kN(i);if(n&&i.isTouching(t.createPositionAt(n,0))){const r=t.createSelection(s);t.modifySelection(r,{direction:"backward"});const o=r.getLastPosition(),l=t.createRange(o,i);t.hasContent(l,{ignoreMarkers:!0})||(i=o)}}return[Xt.fromPosition(e,"toPrevious"),Xt.fromPosition(i,"toNext")]}function kN(s){const t=s.parent,e=t.root.document.model.schema,i=t.getAncestors({parentFirst:!0,includeSelf:!0});for(const n of i){if(e.isLimit(n))return null;if(e.isBlock(n))return n}}function SN(s,t,e){const i=s.model;if(!YO(s.model.schema,t,e))return;const[n,r]=PN(t,e);!n||!r||(!i.hasContent(n,{ignoreMarkers:!0})&&i.hasContent(r,{ignoreMarkers:!0})?$A(s,t,e,n.parent):BA(s,t,e,n.parent))}function BA(s,t,e,i){const n=t.parent,r=e.parent;if(!(n==i||r==i)){for(t=s.createPositionAfter(n),e=s.createPositionBefore(r),e.isEqual(t)||s.insert(r,t),s.merge(t);e.parent.isEmpty;){const o=e.parent;e=s.createPositionBefore(o),s.remove(o)}YO(s.model.schema,t,e)&&BA(s,t,e,i)}}function $A(s,t,e,i){const n=t.parent,r=e.parent;if(!(n==i||r==i)){for(t=s.createPositionAfter(n),e=s.createPositionBefore(r),e.isEqual(t)||s.insert(n,e);t.parent.isEmpty;){const o=t.parent;t=s.createPositionBefore(o),s.remove(o)}e=s.createPositionBefore(r),CN(s,e),YO(s.model.schema,t,e)&&$A(s,t,e,i)}}function CN(s,t){const e=t.nodeBefore,i=t.nodeAfter;e.name!=i.name&&s.rename(e,i.name),s.clearAttributes(e),s.setAttributes(Object.fromEntries(i.getAttributes()),e),s.merge(t)}function YO(s,t,e){const i=t.parent,n=e.parent;return i==n||s.isLimit(i)||s.isLimit(n)?!1:EN(t,e,s)}function PN(s,t){const e=s.getAncestors(),i=t.getAncestors();let n=0;for(;e[n]&&e[n]==i[n];)n++;return[e[n],i[n]]}function TN(s,t){const e=s.checkChild(t,"$text"),i=s.checkChild(t,"paragraph");return!e&&i}function EN(s,t,e){const i=new K(s,t);for(const n of i.getWalker())if(e.isLimit(n.item))return!1;return!0}function DA(s,t,e,i={}){const n=s.createElement("paragraph");s.model.schema.setAllowedAttributes(n,i,s),s.insert(n,t),QA(s,e,s.createPositionAt(n,0))}function AN(s,t){const e=s.model.schema.getLimitElement(t);s.remove(s.createRangeIn(e)),DA(s,s.createPositionAt(e,0),t)}function IN(s,t){const e=s.getLimitElement(t);if(!t.containsEntireContent(e))return!1;const i=t.getFirstRange();return i.start.parent==i.end.parent?!1:s.checkChild(e,"paragraph")}function QA(s,t,e){t instanceof Bs?s.setSelection(e):t.setTo(e)}/**
 * @license Copyright (c) 2003-2025, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options
 */function RN(s,t){return s.change(e=>{const i=e.createDocumentFragment(),n=t.getFirstRange();if(!n||n.isCollapsed)return i;const r=n.start.root,o=n.start.getCommonPath(n.end),l=r.getNodeByPath(o);let a;n.start.parent==n.end.parent?a=n:a=e.createRange(e.createPositionAt(l,n.start.path[o.length]),e.createPositionAt(l,n.end.path[o.length]+1));const c=a.end.offset-a.start.offset;for(const h of a.getItems({shallow:!0}))h.is("$textProxy")?e.appendText(h.data,h.getAttributes(),i):e.append(e.cloneElement(h,!0),i);if(a!=n){const h=n._getTransformedByMove(a.start,e.createPositionAt(i,0),c)[0],f=e.createRange(e.createPositionAt(i,0),h.start),m=e.createRange(h.end,e.createPositionAt(i,"end"));CC(m,e),CC(f,e)}return i})}function CC(s,t){const e=[];Array.from(s.getItems({direction:"backward"})).map(i=>t.createRangeOn(i)).filter(i=>(i.start.isAfter(s.start)||i.start.isEqual(s.start))&&(i.end.isBefore(s.end)||i.end.isEqual(s.end))).forEach(i=>{e.push(i.start.parent),t.remove(i)}),e.forEach(i=>{let n=i;for(;n.parent&&n.isEmpty;){const r=t.createRangeOn(n);n=n.parent,t.remove(r)}})}function VN(s,t,e){return s.change(i=>{const n=e||s.document.selection;n.isCollapsed||s.deleteContent(n,{doNotAutoparagraph:!0});const r=new MN(s,i,n.anchor),o=[];let l;if(t.is("documentFragment")){if(t.markers.size){const h=[];for(const[f,m]of t.markers){const{start:w,end:O}=m,_=w.isEqual(O);h.push({position:w,name:f,isCollapsed:_},{position:O,name:f,isCollapsed:_})}h.sort(({position:f},{position:m})=>f.isBefore(m)?1:-1);for(const{position:f,name:m,isCollapsed:w}of h){let O=null,_=null;const k=f.parent===t&&f.isAtStart,C=f.parent===t&&f.isAtEnd;!k&&!C?(O=i.createElement("$marker"),i.insert(O,f)):w&&(_=k?"start":"end"),o.push({name:m,element:O,collapsed:_})}}l=t.getChildren()}else l=[t];r.handleNodes(l);let a=r.getSelectionRange();if(t.is("documentFragment")&&o.length){const h=a?bn.fromRange(a):null,f={};for(let m=o.length-1;m>=0;m--){const{name:w,element:O,collapsed:_}=o[m],k=!f[w];if(k&&(f[w]=[]),O){const C=i.createPositionAt(O,"before");f[w].push(C),i.remove(O)}else{const C=r.getAffectedRange();if(!C){_&&f[w].push(r.position);continue}_?f[w].push(C[_]):f[w].push(k?C.start:C.end)}}for(const[m,[w,O]]of Object.entries(f))w&&O&&w.root===O.root&&w.root.document&&!i.model.markers.has(m)&&i.addMarker(m,{usingOperation:!0,affectsData:!0,range:new K(w,O)});h&&(a=h.toRange(),h.detach())}/* istanbul ignore else -- @preserve */a&&(n instanceof Bs?i.setSelection(a):n.setTo(a));const c=r.getAffectedRange()||s.createRange(n.anchor);return r.destroy(),c})}class MN{constructor(t,e,i){p(this,"model");p(this,"writer");p(this,"position");p(this,"canMergeWith");p(this,"schema");p(this,"_documentFragment");p(this,"_documentFragmentPosition");p(this,"_firstNode",null);p(this,"_lastNode",null);p(this,"_lastAutoParagraph",null);p(this,"_filterAttributesOf",[]);p(this,"_affectedStart",null);p(this,"_affectedEnd",null);p(this,"_nodeToSelect",null);this.model=t,this.writer=e,this.position=i,this.canMergeWith=new Set([this.position.parent]),this.schema=t.schema,this._documentFragment=e.createDocumentFragment(),this._documentFragmentPosition=e.createPositionAt(this._documentFragment,0)}handleNodes(t){for(const e of Array.from(t))this._handleNode(e);this._insertPartialFragment(),this._lastAutoParagraph&&this._updateLastNodeFromAutoParagraph(this._lastAutoParagraph),this._mergeOnRight(),this.schema.removeDisallowedAttributes(this._filterAttributesOf,this.writer),this._filterAttributesOf=[]}_updateLastNodeFromAutoParagraph(t){const e=this.writer.createPositionAfter(this._lastNode),i=this.writer.createPositionAfter(t);if(i.isAfter(e)){this._lastNode=t;/* istanbul ignore if -- @preserve */if(this.position.parent!=t||!this.position.isAtEnd)throw new E("insertcontent-invalid-insertion-position",this);this.position=i,this._setAffectedBoundaries(this.position)}}getSelectionRange(){return this._nodeToSelect?K._createOn(this._nodeToSelect):this.model.schema.getNearestSelectionRange(this.position)}getAffectedRange(){return this._affectedStart?new K(this._affectedStart,this._affectedEnd):null}destroy(){this._affectedStart&&this._affectedStart.detach(),this._affectedEnd&&this._affectedEnd.detach()}_handleNode(t){if(!this._checkAndSplitToAllowedPosition(t)){this.schema.isObject(t)||this._handleDisallowedNode(t);return}this._appendToFragment(t),this._firstNode||(this._firstNode=t),this._lastNode=t}_insertPartialFragment(){if(this._documentFragment.isEmpty)return;const t=Xt.fromPosition(this.position,"toNext");this._setAffectedBoundaries(this.position),this._documentFragment.getChild(0)==this._firstNode&&(this.writer.insert(this._firstNode,this.position),this._mergeOnLeft(),this.position=t.toPosition()),this._documentFragment.isEmpty||this.writer.insert(this._documentFragment,this.position),this._documentFragmentPosition=this.writer.createPositionAt(this._documentFragment,0),this.position=t.toPosition(),t.detach()}_handleDisallowedNode(t){t.is("element")&&this.handleNodes(t.getChildren())}_appendToFragment(t){/* istanbul ignore if -- @preserve */if(!this.schema.checkChild(this.position,t))throw new E("insertcontent-wrong-position",this,{node:t,position:this.position});this.writer.insert(t,this._documentFragmentPosition),this._documentFragmentPosition=this._documentFragmentPosition.getShiftedBy(t.offsetSize),this.schema.isObject(t)&&!this.schema.checkChild(this.position,"$text")?this._nodeToSelect=t:this._nodeToSelect=null,this._filterAttributesOf.push(t)}_setAffectedBoundaries(t){this._affectedStart||(this._affectedStart=Xt.fromPosition(t,"toPrevious")),(!this._affectedEnd||this._affectedEnd.isBefore(t))&&(this._affectedEnd&&this._affectedEnd.detach(),this._affectedEnd=Xt.fromPosition(t,"toNext"))}_mergeOnLeft(){const t=this._firstNode;if(!(t instanceof Mt)||!this._canMergeLeft(t))return;const e=Xt._createBefore(t);e.stickiness="toNext";const i=Xt.fromPosition(this.position,"toNext");this._affectedStart.isEqual(e)&&(this._affectedStart.detach(),this._affectedStart=Xt._createAt(e.nodeBefore,"end","toPrevious")),this._firstNode===this._lastNode&&(this._firstNode=e.nodeBefore,this._lastNode=e.nodeBefore),this.writer.merge(e),e.isEqual(this._affectedEnd)&&this._firstNode===this._lastNode&&(this._affectedEnd.detach(),this._affectedEnd=Xt._createAt(e.nodeBefore,"end","toNext")),this.position=i.toPosition(),i.detach(),this._filterAttributesOf.push(this.position.parent),e.detach()}_mergeOnRight(){const t=this._lastNode;if(!(t instanceof Mt)||!this._canMergeRight(t))return;const e=Xt._createAfter(t);e.stickiness="toNext";/* istanbul ignore if -- @preserve */if(!this.position.isEqual(e))throw new E("insertcontent-invalid-insertion-position",this);this.position=ne._createAt(e.nodeBefore,"end");const i=Xt.fromPosition(this.position,"toPrevious");this._affectedEnd.isEqual(e)&&(this._affectedEnd.detach(),this._affectedEnd=Xt._createAt(e.nodeBefore,"end","toNext")),this._firstNode===this._lastNode&&(this._firstNode=e.nodeBefore,this._lastNode=e.nodeBefore),this.writer.merge(e),e.getShiftedBy(-1).isEqual(this._affectedStart)&&this._firstNode===this._lastNode&&(this._affectedStart.detach(),this._affectedStart=Xt._createAt(e.nodeBefore,0,"toPrevious")),this.position=i.toPosition(),i.detach(),this._filterAttributesOf.push(this.position.parent),e.detach()}_canMergeLeft(t){const e=t.previousSibling;return e instanceof Mt&&this.canMergeWith.has(e)&&this.model.schema.checkMerge(e,t)}_canMergeRight(t){const e=t.nextSibling;return e instanceof Mt&&this.canMergeWith.has(e)&&this.model.schema.checkMerge(t,e)}_insertAutoParagraph(){this._insertPartialFragment();const t=this.writer.createElement("paragraph");this.writer.insert(t,this.position),this._setAffectedBoundaries(this.position),this._lastAutoParagraph=t,this.position=this.writer.createPositionAt(t,0)}_checkAndSplitToAllowedPosition(t){const e=this._getAllowedIn(this.position.parent,t);if(!e)return!1;for(e!=this.position.parent&&this._insertPartialFragment();e!=this.position.parent;)if(this.position.isAtStart){const i=this.position.parent;this.position=this.writer.createPositionBefore(i),i.isEmpty&&i.parent===e&&this.writer.remove(i)}else if(this.position.isAtEnd)this.position=this.writer.createPositionAfter(this.position.parent);else{const i=this.writer.createPositionAfter(this.position.parent);this._setAffectedBoundaries(this.position),this.writer.split(this.position),this.position=i,this.canMergeWith.add(this.position.nodeAfter)}return this.schema.checkChild(this.position.parent,t)||this._insertAutoParagraph(),!0}_getAllowedIn(t,e){return this.schema.checkChild(t,e)||this.schema.checkChild(t,"paragraph")&&this.schema.checkChild("paragraph",e)?t:this.schema.isLimit(t)?null:this._getAllowedIn(t.parent,e)}}function LN(s,t,e,i={}){if(!s.schema.isObject(t))throw new E("insertobject-element-not-an-object",s,{object:t});const n=e||s.document.selection;let r=n;i.findOptimalPosition&&s.schema.isBlock(t)&&(r=s.createSelection(s.schema.findOptimalInsertionRange(n,i.findOptimalPosition)));const o=$t(n.getSelectedBlocks()),l={};return o&&Object.assign(l,s.schema.getAttributesWithProperty(o,"copyOnReplace",!0)),s.change(a=>{r.isCollapsed||s.deleteContent(r,{doNotAutoparagraph:!0});let c=t;const h=r.anchor.parent;!s.schema.checkChild(h,t)&&s.schema.checkChild(h,"paragraph")&&s.schema.checkChild("paragraph",t)&&(c=a.createElement("paragraph"),a.insert(t,c)),s.schema.setAllowedAttributes(c,l,a);const f=s.insertContent(c,r);return f.isCollapsed||i.setSelection&&BN(a,t,i.setSelection,l),f})}function BN(s,t,e,i){const n=s.model;if(e=="on"){s.setSelection(t,"on");return}if(e!="after")throw new E("insertobject-invalid-place-parameter-value",n);let r=t.nextSibling;if(n.schema.isInline(t)){s.setSelection(t,"after");return}!(r&&n.schema.checkChild(r,"$text"))&&n.schema.checkChild(t.parent,"paragraph")&&(r=s.createElement("paragraph"),n.schema.setAllowedAttributes(r,i,s),n.insertContent(r,s.createPositionAfter(t))),r&&s.setSelection(r,0)}const $N=' ,.?!:;"-()';function DN(s,t,e={}){const i=s.schema,n=e.direction!="backward",r=e.unit?e.unit:"character",o=!!e.treatEmojiAsSingleUnit,l=t.focus,a=new Ar({boundaries:zN(l,n),singleCharacters:!0,direction:n?"forward":"backward"}),c={walker:a,schema:i,isForward:n,unit:r,treatEmojiAsSingleUnit:o};let h;for(;h=a.next();){if(h.done)return;const f=QN(c,h.value);if(f){t instanceof Bs?s.change(m=>{m.setSelectionFocus(f)}):t.setFocus(f);return}}}function QN(s,t){const{isForward:e,walker:i,unit:n,schema:r,treatEmojiAsSingleUnit:o}=s,{type:l,item:a,nextPosition:c}=t;if(l=="text")return s.unit==="word"?FN(i,e):NN(i,n,o);if(l==(e?"elementStart":"elementEnd")){if(r.isSelectable(a))return ne._createAt(a,e?"after":"before");if(r.checkChild(c,"$text"))return c}else{if(r.isLimit(a)){i.skip(()=>!0);return}if(r.checkChild(c,"$text"))return c}}function NN(s,t,e){const i=s.position.textNode;if(i){const n=i.data;let r=s.position.offset-i.startOffset;for(;QO(n,r)||t=="character"&&NO(n,r)||e&&eA(n,r);)s.next(),r=s.position.offset-i.startOffset}return s.position}function FN(s,t){let e=s.position.textNode;for(e||(e=t?s.position.nodeAfter:s.position.nodeBefore);e&&e.is("$text");){const i=s.position.offset-e.startOffset;if(UN(e,i,t))e=t?s.position.nodeAfter:s.position.nodeBefore;else{if(WN(e.data,i,t))break;s.next()}}return s.position}function zN(s,t){const e=s.root,i=ne._createAt(e,t?"end":0);return t?new K(s,i):new K(i,s)}function WN(s,t,e){const i=t+(e?0:-1);return $N.includes(s.charAt(i))}function UN(s,t,e){return t===(e?s.offsetSize:0)}let ZN=class extends at(){constructor(){super();p(this,"markers");p(this,"document");p(this,"schema");p(this,"_pendingChanges");p(this,"_currentWriter");this.markers=new hN,this.document=new uN(this),this.schema=new PQ,this._pendingChanges=[],this._currentWriter=null,["deleteContent","modifySelection","getSelectedContent","applyOperation"].forEach(e=>this.decorate(e)),this.on("applyOperation",(e,i)=>{i[0]._validate()},{priority:"highest"}),this.schema.register("$root",{isLimit:!0}),this.schema.register("$container",{allowIn:["$root","$container"]}),this.schema.register("$block",{allowIn:["$root","$container"],isBlock:!0}),this.schema.register("$blockObject",{allowWhere:"$block",isBlock:!0,isObject:!0}),this.schema.register("$inlineObject",{allowWhere:"$text",allowAttributesOf:"$text",isInline:!0,isObject:!0}),this.schema.register("$text",{allowIn:"$block",isInline:!0,isContent:!0}),this.schema.register("$clipboardHolder",{allowContentOf:"$root",allowChildren:"$text",isLimit:!0}),this.schema.register("$documentFragment",{allowContentOf:"$root",allowChildren:"$text",isLimit:!0}),this.schema.register("$marker"),this.schema.addChildCheck(()=>!0,"$marker"),pN(this),this.document.registerPostFixer(CA),this.on("insertContent",(e,[i,n])=>{e.return=VN(this,i,n)}),this.on("insertObject",(e,[i,n,r])=>{e.return=LN(this,i,n,r)}),this.on("canEditAt",e=>{const i=!this.document.isReadOnly;e.return=i,i||e.stop()})}change(e){try{return this._pendingChanges.length===0?(this._pendingChanges.push({batch:new Sa,callback:e}),this._runPendingChanges()[0]):e(this._currentWriter)}catch(i){/* istanbul ignore next -- @preserve */E.rethrowUnexpectedError(i,this)}}enqueueChange(e,i){try{e?typeof e=="function"?(i=e,e=new Sa):e instanceof Sa||(e=new Sa(e)):e=new Sa,this._pendingChanges.push({batch:e,callback:i}),this._pendingChanges.length==1&&this._runPendingChanges()}catch(n){/* istanbul ignore next -- @preserve */E.rethrowUnexpectedError(n,this)}}applyOperation(e){e._execute()}insertContent(e,i,n,...r){const o=ex(i,n);return this.fire("insertContent",[e,o,n,...r])}insertObject(e,i,n,r,...o){const l=ex(i,n);return this.fire("insertObject",[e,l,r,r,...o])}deleteContent(e,i){vN(this,e,i)}modifySelection(e,i){DN(this,e,i)}getSelectedContent(e){return RN(this,e)}hasContent(e,i={}){const n=e instanceof K?e:K._createIn(e);if(n.isCollapsed)return!1;const{ignoreWhitespaces:r=!1,ignoreMarkers:o=!1}=i;if(!o){for(const l of this.markers.getMarkersIntersectingRange(n))if(l.affectsData)return!0}for(const l of n.getItems())if(this.schema.isContent(l))if(l.is("$textProxy"))if(r){if(l.data.search(/\S/)!==-1)return!0}else return!0;else return!0;return!1}canEditAt(e){const i=ex(e);return this.fire("canEditAt",[i])}createPositionFromPath(e,i,n){return new ne(e,i,n)}createPositionAt(e,i){return ne._createAt(e,i)}createPositionAfter(e){return ne._createAfter(e)}createPositionBefore(e){return ne._createBefore(e)}createRange(e,i){return new K(e,i)}createRangeIn(e){return K._createIn(e)}createRangeOn(e){return K._createOn(e)}createSelection(...e){return new Qn(...e)}createBatch(e){return new Sa(e)}createOperationFromJSON(e){return JQ.fromJSON(e,this.document)}destroy(){this.document.destroy(),this.stopListening()}_runPendingChanges(){const e=[];this.fire("_beforeChanges");try{for(;this._pendingChanges.length;){const i=this._pendingChanges[0].batch;this._currentWriter=new mN(this,i);const n=this._pendingChanges[0].callback(this._currentWriter);e.push(n),this.document._handleChangeBlock(this._currentWriter),this._pendingChanges.shift(),this._currentWriter=null}}finally{this._pendingChanges.length=0,this._currentWriter=null,this.fire("_afterChanges")}return e}};function ex(s,t){if(s)return s instanceof Qn||s instanceof Bs?s:s instanceof Fl?t||t===0?new Qn(s,t):s.is("rootElement")?new Qn(s,"in"):new Qn(s,"on"):new Qn(s)}class HN extends Nr{constructor(){super(...arguments);p(this,"domEventType","click")}onDomEvent(e){this.fire(e.type,e)}}class Pp extends Nr{constructor(){super(...arguments);p(this,"domEventType",["mousedown","mouseup","mouseover","mouseout"])}onDomEvent(e){this.fire(e.type,e)}}class qN extends Nr{constructor(){super(...arguments);p(this,"domEventType",["touchstart","touchend","touchmove"])}onDomEvent(e){this.fire(e.type,e)}}class Cn{constructor(t){p(this,"document");this.document=t}createDocumentFragment(t){return new _l(this.document,t)}createElement(t,e,i){return new Br(this.document,t,e,i)}createText(t){return new Ri(this.document,t)}clone(t,e=!1){return t._clone(e)}appendChild(t,e){return e._appendChild(t)}insertChild(t,e,i){return i._insertChild(t,e)}removeChildren(t,e,i){return i._removeChildren(t,e)}remove(t){const e=t.parent;return e?this.removeChildren(e.getChildIndex(t),1,e):[]}replace(t,e){const i=t.parent;if(i){const n=i.getChildIndex(t);return this.removeChildren(n,1,i),this.insertChild(n,e,i),!0}return!1}unwrapElement(t){const e=t.parent;if(e){const i=e.getChildIndex(t);this.remove(t),this.insertChild(i,t.getChildren(),e)}}rename(t,e){const i=new Br(this.document,t,e.getAttributes(),e.getChildren());return this.replace(e,i)?i:null}setAttribute(t,e,i){i._setAttribute(t,e)}removeAttribute(t,e){e._removeAttribute(t)}addClass(t,e){e._addClass(t)}removeClass(t,e){e._removeClass(t)}setStyle(t,e,i){Vs(t)&&i===void 0?e._setStyle(t):i._setStyle(t,e)}removeStyle(t,e){e._removeStyle(t)}setCustomProperty(t,e,i){i._setCustomProperty(t,e)}removeCustomProperty(t,e){return e._removeCustomProperty(t)}createPositionAt(t,e){return be._createAt(t,e)}createPositionAfter(t){return be._createAfter(t)}createPositionBefore(t){return be._createBefore(t)}createRange(t,e){return new We(t,e)}createRangeOn(t){return We._createOn(t)}createRangeIn(t){return We._createIn(t)}createSelection(...t){return new Ir(...t)}}/**
 * @license Copyright (c) 2003-2025, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options
 */const jN=/^#([0-9a-f]{3,4}|[0-9a-f]{6}|[0-9a-f]{8})$/i,XN=/^rgb\([ ]?([0-9]{1,3}[ %]?,[ ]?){2,3}[0-9]{1,3}[ %]?\)$/i,GN=/^rgba\([ ]?([0-9]{1,3}[ %]?,[ ]?){3}(1|[0-9]+%|[0]?\.?[0-9]+)\)$/i,YN=/^hsl\([ ]?([0-9]{1,3}[ %]?[,]?[ ]*){3}(1|[0-9]+%|[0]?\.?[0-9]+)?\)$/i,KN=/^hsla\([ ]?([0-9]{1,3}[ %]?,[ ]?){2,3}(1|[0-9]+%|[0]?\.?[0-9]+)\)$/i,JN=/\w+\((?:[^()]|\([^()]*\))*\)|\S+/gi,eF=new Set(["black","silver","gray","white","maroon","red","purple","fuchsia","green","lime","olive","yellow","navy","blue","teal","aqua","orange","aliceblue","antiquewhite","aquamarine","azure","beige","bisque","blanchedalmond","blueviolet","brown","burlywood","cadetblue","chartreuse","chocolate","coral","cornflowerblue","cornsilk","crimson","cyan","darkblue","darkcyan","darkgoldenrod","darkgray","darkgreen","darkgrey","darkkhaki","darkmagenta","darkolivegreen","darkorange","darkorchid","darkred","darksalmon","darkseagreen","darkslateblue","darkslategray","darkslategrey","darkturquoise","darkviolet","deeppink","deepskyblue","dimgray","dimgrey","dodgerblue","firebrick","floralwhite","forestgreen","gainsboro","ghostwhite","gold","goldenrod","greenyellow","grey","honeydew","hotpink","indianred","indigo","ivory","khaki","lavender","lavenderblush","lawngreen","lemonchiffon","lightblue","lightcoral","lightcyan","lightgoldenrodyellow","lightgray","lightgreen","lightgrey","lightpink","lightsalmon","lightseagreen","lightskyblue","lightslategray","lightslategrey","lightsteelblue","lightyellow","limegreen","linen","magenta","mediumaquamarine","mediumblue","mediumorchid","mediumpurple","mediumseagreen","mediumslateblue","mediumspringgreen","mediumturquoise","mediumvioletred","midnightblue","mintcream","mistyrose","moccasin","navajowhite","oldlace","olivedrab","orangered","orchid","palegoldenrod","palegreen","paleturquoise","palevioletred","papayawhip","peachpuff","peru","pink","plum","powderblue","rosybrown","royalblue","saddlebrown","salmon","sandybrown","seagreen","seashell","sienna","skyblue","slateblue","slategray","slategrey","snow","springgreen","steelblue","tan","thistle","tomato","turquoise","violet","wheat","whitesmoke","yellowgreen","activeborder","activecaption","appworkspace","background","buttonface","buttonhighlight","buttonshadow","buttontext","captiontext","graytext","highlight","highlighttext","inactiveborder","inactivecaption","inactivecaptiontext","infobackground","infotext","menu","menutext","scrollbar","threeddarkshadow","threedface","threedhighlight","threedlightshadow","threedshadow","window","windowframe","windowtext","rebeccapurple","currentcolor","transparent"]);function NA(s){return s.startsWith("#")?jN.test(s):s.startsWith("rgb")?XN.test(s)||GN.test(s):s.startsWith("hsl")?YN.test(s)||KN.test(s):eF.has(s.toLowerCase())}const tF=["none","hidden","dotted","dashed","solid","double","groove","ridge","inset","outset"];function iF(s){return tF.includes(s)}const nF=/^([+-]?[0-9]*([.][0-9]+)?(px|cm|mm|in|pc|pt|ch|em|ex|rem|vh|vw|vmin|vmax)|0)$/;function KO(s){return nF.test(s)}const sF=/^[+-]?[0-9]*([.][0-9]+)?%$/;function rF(s){return sF.test(s)}const oF=["repeat-x","repeat-y","repeat","space","round","no-repeat"];function lF(s){return oF.includes(s)}const aF=["center","top","bottom","left","right"];function cF(s){return aF.includes(s)}const uF=["fixed","scroll","local"];function hF(s){return uF.includes(s)}const dF=/^url\(/;function fF(s){return dF.test(s)}function hh(s=""){if(s==="")return{top:void 0,right:void 0,bottom:void 0,left:void 0};const t=JO(s),e=t[0],i=t[2]||e,n=t[1]||e,r=t[3]||n;return{top:e,bottom:i,right:n,left:r}}function Lm(s){return t=>{const{top:e,right:i,bottom:n,left:r}=t,o=[];return[e,i,r,n].every(l=>!!l)?o.push([s,mF(t)]):(e&&o.push([s+"-top",e]),i&&o.push([s+"-right",i]),n&&o.push([s+"-bottom",n]),r&&o.push([s+"-left",r])),o}}function mF({top:s,right:t,bottom:e,left:i}){const n=[];return i!==t?n.push(s,t,e,i):e!==s?n.push(s,t,e):t!==s?n.push(s,t):n.push(s),n.join(" ")}function gF(s){return t=>({path:s,value:hh(t)})}function JO(s){const t=s.trim().slice(0,1500).matchAll(JN);return Array.from(t).map(e=>e[0])}function FA(s){s.setNormalizer("background",pF()),s.setNormalizer("background-color",wF()),s.setReducer("background",xF()),s.setStyleRelation("background",["background-color"])}function pF(){return s=>{const t={},e=JO(s);for(const i of e)lF(i)?(t.repeat=t.repeat||[],t.repeat.push(i)):cF(i)?(t.position=t.position||[],t.position.push(i)):hF(i)?t.attachment=i:NA(i)?t.color=i:fF(i)&&(t.image=i);return{path:"background",value:t}}}function wF(){return s=>({path:"background.color",value:s})}function xF(){return s=>{const t=[];return t.push(["background-color",s.color]),t}}function zA(s){s.setNormalizer("border",bF()),s.setNormalizer("border-top",Hf("top")),s.setNormalizer("border-right",Hf("right")),s.setNormalizer("border-bottom",Hf("bottom")),s.setNormalizer("border-left",Hf("left")),s.setNormalizer("border-color",tx("color")),s.setNormalizer("border-width",tx("width")),s.setNormalizer("border-style",tx("style")),s.setNormalizer("border-top-color",Kn("color","top")),s.setNormalizer("border-top-style",Kn("style","top")),s.setNormalizer("border-top-width",Kn("width","top")),s.setNormalizer("border-right-color",Kn("color","right")),s.setNormalizer("border-right-style",Kn("style","right")),s.setNormalizer("border-right-width",Kn("width","right")),s.setNormalizer("border-bottom-color",Kn("color","bottom")),s.setNormalizer("border-bottom-style",Kn("style","bottom")),s.setNormalizer("border-bottom-width",Kn("width","bottom")),s.setNormalizer("border-left-color",Kn("color","left")),s.setNormalizer("border-left-style",Kn("style","left")),s.setNormalizer("border-left-width",Kn("width","left")),s.setExtractor("border-top",qf("top")),s.setExtractor("border-right",qf("right")),s.setExtractor("border-bottom",qf("bottom")),s.setExtractor("border-left",qf("left")),s.setExtractor("border-top-color","border.color.top"),s.setExtractor("border-right-color","border.color.right"),s.setExtractor("border-bottom-color","border.color.bottom"),s.setExtractor("border-left-color","border.color.left"),s.setExtractor("border-top-width","border.width.top"),s.setExtractor("border-right-width","border.width.right"),s.setExtractor("border-bottom-width","border.width.bottom"),s.setExtractor("border-left-width","border.width.left"),s.setExtractor("border-top-style","border.style.top"),s.setExtractor("border-right-style","border.style.right"),s.setExtractor("border-bottom-style","border.style.bottom"),s.setExtractor("border-left-style","border.style.left"),s.setReducer("border-color",Lm("border-color")),s.setReducer("border-style",Lm("border-style")),s.setReducer("border-width",Lm("border-width")),s.setReducer("border-top",jf("top")),s.setReducer("border-right",jf("right")),s.setReducer("border-bottom",jf("bottom")),s.setReducer("border-left",jf("left")),s.setReducer("border",yF()),s.setStyleRelation("border",["border-color","border-style","border-width","border-top","border-right","border-bottom","border-left","border-top-color","border-right-color","border-bottom-color","border-left-color","border-top-style","border-right-style","border-bottom-style","border-left-style","border-top-width","border-right-width","border-bottom-width","border-left-width"]),s.setStyleRelation("border-color",["border-top-color","border-right-color","border-bottom-color","border-left-color"]),s.setStyleRelation("border-style",["border-top-style","border-right-style","border-bottom-style","border-left-style"]),s.setStyleRelation("border-width",["border-top-width","border-right-width","border-bottom-width","border-left-width"]),s.setStyleRelation("border-top",["border-top-color","border-top-style","border-top-width"]),s.setStyleRelation("border-right",["border-right-color","border-right-style","border-right-width"]),s.setStyleRelation("border-bottom",["border-bottom-color","border-bottom-style","border-bottom-width"]),s.setStyleRelation("border-left",["border-left-color","border-left-style","border-left-width"])}function bF(){return s=>{const{color:t,style:e,width:i}=WA(s);return{path:"border",value:{color:hh(t),style:hh(e),width:hh(i)}}}}function Hf(s){return t=>{const{color:e,style:i,width:n}=WA(t),r={};return e!==void 0&&(r.color={[s]:e}),i!==void 0&&(r.style={[s]:i}),n!==void 0&&(r.width={[s]:n}),{path:"border",value:r}}}function tx(s){return t=>({path:"border",value:OF(t,s)})}function OF(s,t){return{[t]:hh(s)}}function Kn(s,t){return e=>({path:"border",value:{[s]:{[t]:e}}})}function qf(s){return(t,e)=>{if(e.border)return Xu(e.border,s)}}function Xu(s,t){const e={};return s.width&&s.width[t]&&(e.width=s.width[t]),s.style&&s.style[t]&&(e.style=s.style[t]),s.color&&s.color[t]&&(e.color=s.color[t]),e}function WA(s){const t={},e=JO(s);for(const i of e)KO(i)||/thin|medium|thick/.test(i)?t.width=i:iF(i)?t.style=i:t.color=i;return t}function yF(){return t=>{const e=Xu(t,"top"),i=Xu(t,"right"),n=Xu(t,"bottom"),r=Xu(t,"left"),o=[e,i,n,r],l={width:s(o,"width"),style:s(o,"style"),color:s(o,"color")},a=Na(l,"all");return a.length?a:[...Object.entries(l).reduce((h,[f,m])=>(m&&(h.push([`border-${f}`,m]),o.forEach(w=>delete w[f])),h),[]),...Na(e,"top"),...Na(i,"right"),...Na(n,"bottom"),...Na(r,"left")]};function s(t,e){return t.map(i=>i[e]).reduce((i,n)=>i==n?i:null)}}function jf(s){return t=>Na(t,s)}function Na(s,t){const e=[];if(s&&s.width&&e.push("width"),s&&s.style&&e.push("style"),s&&s.color&&e.push("color"),e.length==3){const i=e.map(n=>s[n]).join(" ");return[t=="all"?["border",i]:[`border-${t}`,i]]}return t=="all"?[]:e.map(i=>[`border-${t}-${i}`,s[i]])}function vF(s){s.setNormalizer("padding",gF("padding")),s.setNormalizer("padding-top",t=>({path:"padding.top",value:t})),s.setNormalizer("padding-right",t=>({path:"padding.right",value:t})),s.setNormalizer("padding-bottom",t=>({path:"padding.bottom",value:t})),s.setNormalizer("padding-left",t=>({path:"padding.left",value:t})),s.setReducer("padding",Lm("padding")),s.setStyleRelation("padding",["padding-top","padding-right","padding-bottom","padding-left"])}/**
 * @license Copyright (c) 2003-2025, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options
 *//**
 * @license Copyright (c) 2003-2025, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options
 */class UA{constructor(t){p(this,"crashes",[]);p(this,"state","initializing");p(this,"_crashNumberLimit");p(this,"_now",Date.now);p(this,"_minimumNonErrorTimePeriod");p(this,"_boundErrorHandler");p(this,"_listeners");if(this.crashes=[],this._crashNumberLimit=typeof t.crashNumberLimit=="number"?t.crashNumberLimit:3,this._minimumNonErrorTimePeriod=typeof t.minimumNonErrorTimePeriod=="number"?t.minimumNonErrorTimePeriod:5e3,this._boundErrorHandler=e=>{const i="error"in e?e.error:e.reason;i instanceof Error&&this._handleError(i,e)},this._listeners={},!this._restart)throw new Error("The Watchdog class was split into the abstract `Watchdog` class and the `EditorWatchdog` class. Please, use `EditorWatchdog` if you have used the `Watchdog` class previously.")}destroy(){this._stopErrorHandling(),this._listeners={}}on(t,e){this._listeners[t]||(this._listeners[t]=[]),this._listeners[t].push(e)}off(t,e){this._listeners[t]=this._listeners[t].filter(i=>i!==e)}_fire(t,...e){const i=this._listeners[t]||[];for(const n of i)n.apply(this,[null,...e])}_startErrorHandling(){window.addEventListener("error",this._boundErrorHandler),window.addEventListener("unhandledrejection",this._boundErrorHandler)}_stopErrorHandling(){window.removeEventListener("error",this._boundErrorHandler),window.removeEventListener("unhandledrejection",this._boundErrorHandler)}_handleError(t,e){if(this._shouldReactToError(t)){this.crashes.push({message:t.message,stack:t.stack,filename:e instanceof ErrorEvent?e.filename:void 0,lineno:e instanceof ErrorEvent?e.lineno:void 0,colno:e instanceof ErrorEvent?e.colno:void 0,date:this._now()});const i=this._shouldRestart();this.state="crashed",this._fire("stateChange"),this._fire("error",{error:t,causesRestart:i}),i?this._restart():(this.state="crashedPermanently",this._fire("stateChange"))}}_shouldReactToError(t){return t.is&&t.is("CKEditorError")&&t.context!==void 0&&t.context!==null&&this.state==="ready"&&this._isErrorComingFromThisItem(t)}_shouldRestart(){if(this.crashes.length<=this._crashNumberLimit)return!0;const t=this.crashes[this.crashes.length-1].date,e=this.crashes[this.crashes.length-1-this._crashNumberLimit].date;return(t-e)/this._crashNumberLimit>this._minimumNonErrorTimePeriod}}/**
 * @license Copyright (c) 2003-2025, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options
 */function Qb(s,t=new Set){const e=[s],i=new Set;let n=0;for(;e.length>n;){const r=e[n++];if(!(i.has(r)||!_F(r)||t.has(r)))if(i.add(r),Symbol.iterator in r)try{for(const o of r)e.push(o)}catch{}else for(const o in r)o!=="defaultValue"&&e.push(r[o])}return i}function _F(s){const t=Object.prototype.toString.call(s),e=typeof s;return!(e==="number"||e==="boolean"||e==="string"||e==="symbol"||e==="function"||t==="[object Date]"||t==="[object RegExp]"||t==="[object Module]"||s===void 0||s===null||s._watchdogExcluded||s instanceof EventTarget||s instanceof Event)}function ZA(s,t,e=new Set){if(s===t&&kF(s))return!0;const i=Qb(s,e),n=Qb(t,e);for(const r of i)if(n.has(r))return!0;return!1}function kF(s){return typeof s=="object"&&s!==null}class HA extends UA{constructor(e,i={}){super(i);p(this,"_editor",null);p(this,"_lifecyclePromise",null);p(this,"_throttledSave");p(this,"_data");p(this,"_lastDocumentVersion");p(this,"_elementOrData");p(this,"_initUsingData",!0);p(this,"_editables",{});p(this,"_config");p(this,"_excludedProps");this._throttledSave=hc(this._save.bind(this),typeof i.saveInterval=="number"?i.saveInterval:5e3),e&&(this._creator=(n,r)=>e.create(n,r)),this._destructor=n=>n.destroy()}get editor(){return this._editor}get _item(){return this._editor}setCreator(e){this._creator=e}setDestructor(e){this._destructor=e}_restart(){return Promise.resolve().then(()=>(this.state="initializing",this._fire("stateChange"),this._destroy())).catch(e=>{console.error("An error happened during the editor destroying.",e)}).then(()=>{const e={},i=[],n=this._config.rootsAttributes||{},r={};for(const[l,a]of Object.entries(this._data.roots))a.isLoaded?(e[l]="",r[l]=n[l]||{}):i.push(l);const o={...this._config,extraPlugins:this._config.extraPlugins||[],lazyRoots:i,rootsAttributes:r,_watchdogInitialData:this._data};return delete o.initialData,o.extraPlugins.push(SF),this._initUsingData?this.create(e,o,o.context):Ao(this._elementOrData)?this.create(this._elementOrData,o,o.context):this.create(this._editables,o,o.context)}).then(()=>{this._fire("restart")})}create(e=this._elementOrData,i=this._config,n){return this._lifecyclePromise=Promise.resolve(this._lifecyclePromise).then(()=>(super._startErrorHandling(),this._elementOrData=e,this._initUsingData=typeof e=="string"||Object.keys(e).length>0&&typeof Object.values(e)[0]=="string",this._config=this._cloneEditorConfiguration(i)||{},this._config.context=n,this._creator(e,this._config))).then(r=>{this._editor=r,r.model.document.on("change:data",this._throttledSave),this._lastDocumentVersion=r.model.document.version,this._data=this._getData(),this._initUsingData||(this._editables=this._getEditables()),this.state="ready",this._fire("stateChange")}).finally(()=>{this._lifecyclePromise=null}),this._lifecyclePromise}destroy(){return this._lifecyclePromise=Promise.resolve(this._lifecyclePromise).then(()=>(this.state="destroyed",this._fire("stateChange"),super.destroy(),this._destroy())).finally(()=>{this._lifecyclePromise=null}),this._lifecyclePromise}_destroy(){return Promise.resolve().then(()=>{this._stopErrorHandling(),this._throttledSave.cancel();const e=this._editor;return this._editor=null,e.model.document.off("change:data",this._throttledSave),this._destructor(e)})}_save(){const e=this._editor.model.document.version;try{this._data=this._getData(),this._initUsingData||(this._editables=this._getEditables()),this._lastDocumentVersion=e}catch(i){console.error(i,"An error happened during restoring editor data. Editor will be restored from the previously saved data.")}}_setExcludedProperties(e){this._excludedProps=e}_getData(){const e=this._editor,i=e.model.document.roots.filter(a=>a.isAttached()&&a.rootName!="$graveyard"),{plugins:n}=e,r=n.has("CommentsRepository")&&n.get("CommentsRepository"),o=n.has("TrackChanges")&&n.get("TrackChanges"),l={roots:{},markers:{},commentThreads:JSON.stringify([]),suggestions:JSON.stringify([])};i.forEach(a=>{l.roots[a.rootName]={content:JSON.stringify(Array.from(a.getChildren())),attributes:JSON.stringify(Array.from(a.getAttributes())),isLoaded:a._isLoaded}});for(const a of e.model.markers)a._affectsData&&(l.markers[a.name]={rangeJSON:a.getRange().toJSON(),usingOperation:a._managedUsingOperations,affectsData:a._affectsData});return r&&(l.commentThreads=JSON.stringify(r.getCommentThreads({toJSON:!0,skipNotAttached:!0}))),o&&(l.suggestions=JSON.stringify(o.getSuggestions({toJSON:!0,skipNotAttached:!0}))),l}_getEditables(){const e={};for(const i of this.editor.model.document.getRootNames()){const n=this.editor.ui.getEditableElement(i);n&&(e[i]=n)}return e}_isErrorComingFromThisItem(e){return ZA(this._editor,e.context,this._excludedProps)}_cloneEditorConfiguration(e){return bp(e,(i,n)=>{if(Ao(i)||n==="context")return i})}}class SF{constructor(t){p(this,"editor");p(this,"_data");this.editor=t,this._data=t.config.get("_watchdogInitialData")}init(){this.editor.data.on("init",t=>{t.stop(),this.editor.model.enqueueChange({isUndoable:!1},e=>{this._restoreCollaborationData(),this._restoreEditorData(e)}),this.editor.data.fire("ready")},{priority:999})}_createNode(t,e){if("name"in e){const i=t.createElement(e.name,e.attributes);if(e.children)for(const n of e.children)i._appendChild(this._createNode(t,n));return i}else return t.createText(e.data,e.attributes)}_restoreEditorData(t){const e=this.editor;Object.entries(this._data.roots).forEach(([i,{content:n,attributes:r}])=>{const o=JSON.parse(n),l=JSON.parse(r),a=e.model.document.getRoot(i);for(const[c,h]of l)t.setAttribute(c,h,a);for(const c of o){const h=this._createNode(t,c);t.insert(h,a,"end")}}),Object.entries(this._data.markers).forEach(([i,n])=>{const{document:r}=e.model,{rangeJSON:{start:o,end:l},...a}=n,c=r.getRoot(o.root),h=t.createPositionFromPath(c,o.path,o.stickiness),f=t.createPositionFromPath(c,l.path,l.stickiness),m=t.createRange(h,f);t.addMarker(i,{range:m,...a})})}_restoreCollaborationData(){const t=JSON.parse(this._data.commentThreads),e=JSON.parse(this._data.suggestions);t.forEach(i=>{const n=this.editor.config.get("collaboration.channelId"),r=this.editor.plugins.get("CommentsRepository");r.hasCommentThread(i.threadId)&&r.getCommentThread(i.threadId).remove(),r.addCommentThread({channelId:n,...i})}),e.forEach(i=>{const n=this.editor.plugins.get("TrackChangesEditing");if(n.hasSuggestion(i.id)){const r=n.getSuggestion(i.id);r.attributes=i.attributes}else n.addSuggestionData(i)})}}const dh=Symbol("MainQueueId");class CF extends UA{constructor(e,i={}){super(i);p(this,"_watchdogs",new Map);p(this,"_watchdogConfig");p(this,"_context",null);p(this,"_contextProps",new Set);p(this,"_actionQueues",new PF);p(this,"_contextConfig");p(this,"_item");this._watchdogConfig=i,this._creator=n=>e.create(n),this._destructor=n=>n.destroy(),this._actionQueues.onEmpty(()=>{this.state==="initializing"&&(this.state="ready",this._fire("stateChange"))})}setCreator(e){this._creator=e}setDestructor(e){this._destructor=e}get context(){return this._context}create(e={}){return this._actionQueues.enqueue(dh,()=>(this._contextConfig=e,this._create()))}getItem(e){return this._getWatchdog(e)._item}getItemState(e){return this._getWatchdog(e).state}add(e){const i=PC(e);return Promise.all(i.map(n=>this._actionQueues.enqueue(n.id,()=>{if(this.state==="destroyed")throw new Error("Cannot add items to destroyed watchdog.");if(!this._context)throw new Error("Context was not created yet. You should call the `ContextWatchdog#create()` method first.");let r;if(this._watchdogs.has(n.id))throw new Error(`Item with the given id is already added: '${n.id}'.`);if(n.type==="editor")return r=new HA(null,this._watchdogConfig),r.setCreator(n.creator),r._setExcludedProperties(this._contextProps),n.destructor&&r.setDestructor(n.destructor),this._watchdogs.set(n.id,r),r.on("error",(o,{error:l,causesRestart:a})=>{this._fire("itemError",{itemId:n.id,error:l}),a&&this._actionQueues.enqueue(n.id,()=>new Promise(c=>{const h=()=>{r.off("restart",h),this._fire("itemRestart",{itemId:n.id}),c()};r.on("restart",h)}))}),r.create(n.sourceElementOrData,n.config,this._context);throw new Error(`Not supported item type: '${n.type}'.`)})))}remove(e){const i=PC(e);return Promise.all(i.map(n=>this._actionQueues.enqueue(n,()=>{const r=this._getWatchdog(n);return this._watchdogs.delete(n),r.destroy()})))}destroy(){return this._actionQueues.enqueue(dh,()=>(this.state="destroyed",this._fire("stateChange"),super.destroy(),this._destroy()))}_restart(){return this._actionQueues.enqueue(dh,()=>(this.state="initializing",this._fire("stateChange"),this._destroy().catch(e=>{console.error("An error happened during destroying the context or items.",e)}).then(()=>this._create()).then(()=>this._fire("restart"))))}_create(){return Promise.resolve().then(()=>(this._startErrorHandling(),this._creator(this._contextConfig))).then(e=>(this._context=e,this._contextProps=Qb(this._context),Promise.all(Array.from(this._watchdogs.values()).map(i=>(i._setExcludedProperties(this._contextProps),i.create(void 0,void 0,this._context))))))}_destroy(){return Promise.resolve().then(()=>{this._stopErrorHandling();const e=this._context;return this._context=null,this._contextProps=new Set,Promise.all(Array.from(this._watchdogs.values()).map(i=>i.destroy())).then(()=>this._destructor(e))})}_getWatchdog(e){const i=this._watchdogs.get(e);if(!i)throw new Error(`Item with the given id was not registered: ${e}.`);return i}_isErrorComingFromThisItem(e){for(const i of this._watchdogs.values())if(i._isErrorComingFromThisItem(e))return!1;return ZA(this._context,e.context)}}class PF{constructor(){p(this,"_onEmptyCallbacks",[]);p(this,"_queues",new Map);p(this,"_activeActions",0)}onEmpty(t){this._onEmptyCallbacks.push(t)}enqueue(t,e){const i=t===dh;this._activeActions++,this._queues.get(t)||this._queues.set(t,Promise.resolve());const r=(i?Promise.all(this._queues.values()):Promise.all([this._queues.get(dh),this._queues.get(t)])).then(e),o=r.catch(()=>{});return this._queues.set(t,o),r.finally(()=>{this._activeActions--,this._queues.get(t)===o&&this._activeActions===0&&this._onEmptyCallbacks.forEach(l=>l())})}}function PC(s){return Array.isArray(s)?s:[s]}/**
 * @license Copyright (c) 2003-2025, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options
 */class F extends at(){constructor(e){super();p(this,"editor");p(this,"_disableStack",new Set);this.editor=e,this.set("isEnabled",!0)}forceDisabled(e){this._disableStack.add(e),this._disableStack.size==1&&(this.on("set:isEnabled",TC,{priority:"highest"}),this.isEnabled=!1)}clearForceDisabled(e){this._disableStack.delete(e),this._disableStack.size==0&&(this.off("set:isEnabled",TC),this.isEnabled=!0)}destroy(){this.stopListening()}static get isContextPlugin(){return!1}static get isOfficialPlugin(){return!1}static get isPremiumPlugin(){return!1}}function TC(s){s.return=!1,s.stop()}class Be extends at(){constructor(e){super();p(this,"editor");p(this,"_isEnabledBasedOnSelection");p(this,"_affectsData");p(this,"_disableStack");this.editor=e,this.set("value",void 0),this.set("isEnabled",!1),this._affectsData=!0,this._isEnabledBasedOnSelection=!0,this._disableStack=new Set,this.decorate("execute"),this.listenTo(this.editor.model.document,"change",()=>{this.refresh()}),this.listenTo(e,"change:isReadOnly",()=>{this.refresh()}),this.on("set:isEnabled",i=>{if(!this.affectsData)return;const n=e.model.document.selection,o=!(n.getFirstPosition().root.rootName=="$graveyard")&&e.model.canEditAt(n);(e.isReadOnly||this._isEnabledBasedOnSelection&&!o)&&(i.return=!1,i.stop())},{priority:"highest"}),this.on("execute",i=>{this.isEnabled||i.stop()},{priority:"high"})}get affectsData(){return this._affectsData}set affectsData(e){this._affectsData=e}refresh(){this.isEnabled=!0}forceDisabled(e){this._disableStack.add(e),this._disableStack.size==1&&(this.on("set:isEnabled",EC,{priority:"highest"}),this.isEnabled=!1)}clearForceDisabled(e){this._disableStack.delete(e),this._disableStack.size==0&&(this.off("set:isEnabled",EC),this.refresh())}execute(...e){}destroy(){this.stopListening()}}function EC(s){s.return=!1,s.stop()}class qA extends pt(){constructor(e,i=[],n=[]){super();p(this,"_context");p(this,"_plugins",new Map);p(this,"_availablePlugins");p(this,"_contextPlugins");this._context=e,this._availablePlugins=new Map;for(const r of i)r.pluginName&&this._availablePlugins.set(r.pluginName,r);this._contextPlugins=new Map;for(const[r,o]of n)this._contextPlugins.set(r,o),this._contextPlugins.set(o,r),r.pluginName&&this._availablePlugins.set(r.pluginName,r)}*[Symbol.iterator](){for(const e of this._plugins)typeof e[0]=="function"&&(yield e)}get(e){const i=this._plugins.get(e);if(!i){let n=e;throw typeof e=="function"&&(n=e.pluginName||e.name),new E("plugincollection-plugin-not-loaded",this._context,{plugin:n})}return i}has(e){return this._plugins.has(e)}init(e,i=[],n=[]){const r=this,o=this._context;O(e),k(e);const l=e.filter(D=>!m(D,i)),a=[..._(l)];G(a,n);const c=Q(a);return N(c,"init").then(()=>N(c,"afterInit")).then(()=>c);function h(D){return typeof D=="function"}function f(D){return h(D)&&!!D.isContextPlugin}function m(D,b){return b.some(I=>I===D||w(D)===I||w(I)===D)}function w(D){return h(D)?D.pluginName||D.name:D}function O(D,b=new Set){D.forEach(I=>{h(I)&&(b.has(I)||(b.add(I),I.pluginName&&!r._availablePlugins.has(I.pluginName)&&r._availablePlugins.set(I.pluginName,I),I.requires&&O(I.requires,b)))})}function _(D,b=new Set){return D.map(I=>h(I)?I:r._availablePlugins.get(I)).reduce((I,B)=>b.has(B)?I:(b.add(B),B.requires&&(k(B.requires,B),_(B.requires,b).forEach(j=>I.add(j))),I.add(B)),new Set)}function k(D,b=null){D.map(I=>h(I)?I:r._availablePlugins.get(I)||I).forEach(I=>{C(I,b),P(I,b),M(I,b)})}function C(D,b){if(!h(D))throw b?new E("plugincollection-soft-required",o,{missingPlugin:D,requiredBy:w(b)}):new E("plugincollection-plugin-not-found",o,{plugin:D})}function P(D,b){if(f(b)&&!f(D))throw new E("plugincollection-context-required",o,{plugin:w(D),requiredBy:w(b)})}function M(D,b){if(b&&m(D,i))throw new E("plugincollection-required",o,{plugin:w(D),requiredBy:w(b)})}function Q(D){return D.map(b=>{let I=r._contextPlugins.get(b);return I=I||new b(o),r._add(b,I),I})}function N(D,b){return D.reduce((I,B)=>!B[b]||r._contextPlugins.has(B)?I:I.then(B[b].bind(B)),Promise.resolve())}function G(D,b){for(const I of b){if(typeof I!="function")throw new E("plugincollection-replace-plugin-invalid-type",null,{pluginItem:I});const B=I.pluginName;if(!B)throw new E("plugincollection-replace-plugin-missing-name",null,{pluginItem:I});if(I.requires&&I.requires.length)throw new E("plugincollection-plugin-for-replacing-cannot-have-dependencies",null,{pluginName:B});const j=r._availablePlugins.get(B);if(!j)throw new E("plugincollection-plugin-for-replacing-not-exist",null,{pluginName:B});const W=D.indexOf(j);if(W===-1){if(r._contextPlugins.has(j))return;throw new E("plugincollection-plugin-for-replacing-not-loaded",null,{pluginName:B})}if(j.requires&&j.requires.length)throw new E("plugincollection-replaced-plugin-cannot-have-dependencies",null,{pluginName:B});D.splice(W,1,I),r._availablePlugins.set(B,I)}}}destroy(){const e=[];for(const[,i]of this)typeof i.destroy=="function"&&!this._contextPlugins.has(i)&&e.push(i.destroy());return Promise.all(e)}_add(e,i){this._plugins.set(e,i);const n=e.pluginName;if(n){if(this._plugins.has(n))throw new E("plugincollection-plugin-name-conflict",null,{pluginName:n,plugin1:this._plugins.get(n).constructor,plugin2:e});this._plugins.set(n,i)}}}var Am;let AC=(Am=class{constructor(t){p(this,"config");p(this,"plugins");p(this,"locale");p(this,"t");p(this,"editors");p(this,"_contextOwner",null);const{translations:e,...i}=t||{};this.config=new F6(i,this.constructor.defaultConfig);const n=this.constructor.builtinPlugins;this.config.define("plugins",n),this.plugins=new qA(this,n);const r=this.config.get("language")||{};this.locale=new eD({uiLanguage:typeof r=="string"?r:r.ui,contentLanguage:this.config.get("language.content"),translations:e}),this.t=this.locale.t,this.editors=new di}initPlugins(){const t=this.config.get("plugins")||[],e=this.config.get("substitutePlugins")||[];for(const i of t.concat(e)){if(typeof i!="function")throw new E("context-initplugins-constructor-only",null,{Plugin:i});if(i.isContextPlugin!==!0)throw new E("context-initplugins-invalid-plugin",null,{Plugin:i})}return this.plugins.init(t,[],e)}destroy(){return Promise.all(Array.from(this.editors,t=>t.destroy())).then(()=>this.plugins.destroy())}_addEditor(t,e){if(this._contextOwner)throw new E("context-addeditor-private-context");this.editors.add(t),e&&(this._contextOwner=t)}_removeEditor(t){return this.editors.has(t)&&this.editors.remove(t),this._contextOwner===t?this.destroy():Promise.resolve()}_getEditorConfig(){const t={};for(const e of this.config.names())["plugins","removePlugins","extraPlugins"].includes(e)||(t[e]=this.config.get(e));return t}static create(t){return new Promise(e=>{const i=new this(t);e(i.initPlugins().then(()=>i))})}},p(Am,"defaultConfig"),p(Am,"builtinPlugins"),Am);class Tp extends at(){constructor(e){super();p(this,"context");this.context=e}destroy(){this.stopListening()}static get isContextPlugin(){return!0}static get isOfficialPlugin(){return!1}static get isPremiumPlugin(){return!1}}class TF{constructor(){p(this,"_commands");this._commands=new Map}add(t,e){this._commands.set(t,e)}get(t){return this._commands.get(t)}execute(t,...e){const i=this.get(t);if(!i)throw new E("commandcollection-command-not-found",this,{commandName:t});return i.execute(...e)}*names(){yield*this._commands.keys()}*commands(){yield*this._commands.values()}[Symbol.iterator](){return this._commands[Symbol.iterator]()}destroy(){for(const t of this.commands())t.destroy()}}class EF extends wt{constructor(e){super();p(this,"editor");this.editor=e}set(e,i,n={}){if(typeof i=="string"){const r=i;i=(o,l)=>{this.editor.execute(r),l()}}super.set(e,i,n)}}const ix="contentEditing",IC="common";class AF{constructor(t){p(this,"keystrokeInfos",new Map);p(this,"_editor");this._editor=t;const e=t.config.get("menuBar.isVisible"),i=t.locale.t;this.addKeystrokeInfoCategory({id:ix,label:i("Content editing keystrokes"),description:i("These keyboard shortcuts allow for quick access to content editing features.")});const n=[{label:i("Close contextual balloons, dropdowns, and dialogs"),keystroke:"Esc"},{label:i("Open the accessibility help dialog"),keystroke:"Alt+0"},{label:i("Move focus between form fields (inputs, buttons, etc.)"),keystroke:[["Tab"],["Shift+Tab"]]},{label:i("Move focus to the toolbar, navigate between toolbars"),keystroke:"Alt+F10",mayRequireFn:!0},{label:i("Navigate through the toolbar or menu bar"),keystroke:[["arrowup"],["arrowright"],["arrowdown"],["arrowleft"]]},{label:i("Execute the currently focused button. Executing buttons that interact with the editor content moves the focus back to the content."),keystroke:[["Enter"],["Space"]]}];e&&n.push({label:i("Move focus to the menu bar, navigate between menu bars"),keystroke:"Alt+F9",mayRequireFn:!0}),this.addKeystrokeInfoCategory({id:"navigation",label:i("User interface and content navigation keystrokes"),description:i("Use the following keystrokes for more efficient navigation in the CKEditor 5 user interface."),groups:[{id:"common",keystrokes:n}]})}addKeystrokeInfoCategory({id:t,label:e,description:i,groups:n}){this.keystrokeInfos.set(t,{id:t,label:e,description:i,groups:new Map}),this.addKeystrokeInfoGroup({categoryId:t,id:IC}),n&&n.forEach(r=>{this.addKeystrokeInfoGroup({categoryId:t,...r})})}addKeystrokeInfoGroup({categoryId:t=ix,id:e,label:i,keystrokes:n}){const r=this.keystrokeInfos.get(t);if(!r)throw new E("accessibility-unknown-keystroke-info-category",this._editor,{groupId:e,categoryId:t});r.groups.set(e,{id:e,label:i,keystrokes:n||[]})}addKeystrokeInfos({categoryId:t=ix,groupId:e=IC,keystrokes:i}){if(!this.keystrokeInfos.has(t))throw new E("accessibility-unknown-keystroke-info-category",this._editor,{categoryId:t,keystrokes:i});const n=this.keystrokeInfos.get(t);if(!n.groups.has(e))throw new E("accessibility-unknown-keystroke-info-group",this._editor,{groupId:e,categoryId:t,keystrokes:i});n.groups.get(e).keystrokes.push(...i)}}function IF(s){return{sessionId:BF(),pageSessionId:$F(),hostname:window.location.hostname,version:globalThis.CKEDITOR_VERSION,type:RF(s),plugins:VF(s.plugins),distribution:MF(),env:LF(),integration:Object.create(null),menuBar:{isVisible:!!s.config.get("menuBar.isVisible")},language:{ui:s.locale.uiLanguage,content:s.locale.contentLanguage},toolbar:{main:nx(s.config.get("toolbar")),block:nx(s.config.get("blockToolbar")),balloon:nx(s.config.get("balloonToolbar"))}}}function RF(s){return Object.getPrototypeOf(s).constructor.editorName}function VF(s){return Array.from(s).filter(([t])=>!!t.pluginName).map(([t])=>{const{pluginName:e,isContextPlugin:i,isOfficialPlugin:n,isPremiumPlugin:r}=t;return{isContext:!!i,isOfficial:!!n,isPremium:!!r,name:e}})}function nx(s){if(!s)return;const t=Array.isArray(s)?{items:s}:s,e=r(t.items||[]);return{isMultiline:e.includes("-"),shouldNotGroupWhenFull:!!t.shouldNotGroupWhenFull,items:n(e)};function n(o){return o.filter(l=>l!=="|"&&l!=="-")}function r(o){return o.flatMap(l=>typeof l=="string"?[l]:r(l.items))}}function MF(){return{channel:window[Symbol.for("cke distribution")]||"sh"}}function LF(){let s="unknown",t="unknown";return Ie.isMac?s="mac":Ie.isWindows?s="windows":Ie.isiOS?s="ios":Ie.isAndroid&&(s="android"),Ie.isGecko?t="gecko":Ie.isBlink?t="blink":Ie.isSafari&&(t="safari"),{os:s,browser:t}}function BF(){return localStorage.getItem("__ckeditor-session-id")||localStorage.setItem("__ckeditor-session-id",ei()),localStorage.getItem("__ckeditor-session-id")}function $F(){return he.window.CKEDITOR_PAGE_SESSION_ID=he.window.CKEDITOR_PAGE_SESSION_ID||ei(),he.window.CKEDITOR_PAGE_SESSION_ID}class Fa extends at(){constructor(e={}){super();p(this,"accessibility");p(this,"commands");p(this,"config");p(this,"conversion");p(this,"data");p(this,"editing");p(this,"locale");p(this,"model");p(this,"plugins");p(this,"keystrokes");p(this,"t");p(this,"_context");p(this,"_readOnlyLocks");if("sanitizeHtml"in e)throw new E("editor-config-sanitizehtml-not-supported");const i=this.constructor,{translations:n,...r}=i.defaultConfig||{},{translations:o=n,...l}=e,a=e.language||r.language;this._context=e.context||new AC({language:a,translations:o}),this._context._addEditor(this,!e.context);const c=Array.from(i.builtinPlugins||[]);this.config=new F6(l,r),this.config.define("plugins",c),this.config.define(this._context._getEditorConfig()),f(this.config),this.plugins=new qA(this,c,this._context.plugins),this.locale=this._context.locale,this.t=this.locale.t,this._readOnlyLocks=new Set,this.commands=new TF,this.set("state","initializing"),this.once("ready",()=>this.state="ready",{priority:"high"}),this.once("destroy",()=>this.state="destroyed",{priority:"high"}),this.model=new ZN,this.on("change:isReadOnly",()=>{this.model.document.isReadOnly=this.isReadOnly});const h=new ED;this.data=new XQ(this.model,h),this.editing=new CQ(this.model,h),this.editing.view.document.bind("isReadOnly").to(this),this.conversion=new YQ([this.editing.downcastDispatcher,this.data.downcastDispatcher],this.data.upcastDispatcher),this.conversion.addAlias("dataDowncast",this.data.downcastDispatcher),this.conversion.addAlias("editingDowncast",this.editing.downcastDispatcher),this.keystrokes=new EF(this),this.keystrokes.listenTo(this.editing.view.document),this.accessibility=new AF(this),m(this);function f(w){let O=w.get("licenseKey");if(!O&&window.CKEDITOR_GLOBAL_LICENSE_KEY&&(O=window.CKEDITOR_GLOBAL_LICENSE_KEY,w.set("licenseKey",O)),!O)throw new E("license-key-missing")}function m(w){const O=w.config.get("licenseKey"),_=window[Symbol.for("cke distribution")]||"sh";function k(B){w.enableReadOnlyMode(Symbol("invalidLicense")),w._showLicenseError(B)}function C(B){const j=B.split(".");return j.length!=3?null:j[1]}function P(B){return["exp","jti","vc"].every(W=>W in B)}function M(B){return Object.getOwnPropertyNames(B).sort().filter(H=>H!="vc"&&B[H]!=null).map(H=>B[H])}function Q(B){const{hostname:j}=new URL(window.location.href);if(B.includes(j))return!0;const W=j.split(".");return B.filter(H=>H.includes("*")).map(H=>H.split(".")).filter(H=>H.length<=W.length).map(H=>Array(W.length-H.length).fill(H[0]==="*"?"*":"").concat(H)).some(H=>W.every((te,de)=>H[de]===te||H[de]==="*"))}function N(B){const j=B[0].toUpperCase()+B.slice(1),W=B==="evaluation"?"an":"a";console.info(`%cCKEditor 5 ${j} License`,"color: #ffffff; background: #743CCD; font-size: 14px; padding: 4px 8px; border-radius: 4px;"),console.warn(`⚠️ You are using ${W} ${B} license of CKEditor 5${B==="trial"?" which is for evaluation purposes only":""}. For production usage, please obtain a production license at https://portal.ckeditor.com/`)}if(O=="GPL"){_=="cloud"&&k("distributionChannel");return}const G=C(O);if(!G){k("invalid");return}const D=DO(G);if(!D){k("invalid");return}if(!P(D)){k("invalid");return}if(D.distributionChannel&&!dt(D.distributionChannel).includes(_)){k("distributionChannel");return}if(aD(M(D))!=D.vc.toLowerCase()){k("invalid");return}if(new Date(D.exp*1e3)<f9){k("expired");return}const I=D.licensedHosts;if(I&&I.length>0&&!Q(I)){k("domainLimit");return}if(["evaluation","trial"].includes(D.licenseType)&&D.exp*1e3<Date.now()){k("expired");return}if(["development","evaluation","trial"].includes(D.licenseType)){const{licenseType:B}=D;window.CKEDITOR_WARNING_SUPPRESSIONS=window.CKEDITOR_WARNING_SUPPRESSIONS||{},window.CKEDITOR_WARNING_SUPPRESSIONS[B]||(N(B),window.CKEDITOR_WARNING_SUPPRESSIONS[B]=!0)}if(["evaluation","trial"].includes(D.licenseType)){const B=D.licenseType,j=setTimeout(()=>{k(`${B}Limit`)},6e5);w.on("destroy",()=>{clearTimeout(j)})}D.usageEndpoint&&w.once("ready",()=>{const B={requestId:ei(),requestTime:Math.round(Date.now()/1e3),license:O,editor:DF(w)};w._sendUsageRequest(D.usageEndpoint,B).then(j=>{const{status:W,message:H}=j;H&&console.warn(H),W!="ok"&&k("usageLimit")},()=>{fg("license-key-validation-endpoint-not-reachable",{url:D.usageEndpoint})})},{priority:"high"})}}static get editorName(){return"Editor"}get isReadOnly(){return this._readOnlyLocks.size>0}set isReadOnly(e){throw new E("editor-isreadonly-has-no-setter")}enableReadOnlyMode(e){if(typeof e!="string"&&typeof e!="symbol")throw new E("editor-read-only-lock-id-invalid",null,{lockId:e});this._readOnlyLocks.has(e)||(this._readOnlyLocks.add(e),this._readOnlyLocks.size===1&&this.fire("change:isReadOnly","isReadOnly",!0,!1))}disableReadOnlyMode(e){if(typeof e!="string"&&typeof e!="symbol")throw new E("editor-read-only-lock-id-invalid",null,{lockId:e});this._readOnlyLocks.has(e)&&(this._readOnlyLocks.delete(e),this._readOnlyLocks.size===0&&this.fire("change:isReadOnly","isReadOnly",!1,!0))}setData(e){this.data.set(e)}getData(e){return this.data.get(e)}initPlugins(){const e=this.config,i=e.get("plugins"),n=e.get("removePlugins")||[],r=e.get("extraPlugins")||[],o=e.get("substitutePlugins")||[];return this.plugins.init(i.concat(r),n,o)}destroy(){let e=Promise.resolve();return this.state=="initializing"&&(e=new Promise(i=>this.once("ready",i))),e.then(()=>{this.fire("destroy"),this.stopListening(),this.commands.destroy()}).then(()=>this.plugins.destroy()).then(()=>{this.model.destroy(),this.data.destroy(),this.editing.destroy(),this.keystrokes.destroy()}).then(()=>this._context._removeEditor(this))}execute(e,...i){try{return this.commands.execute(e,...i)}catch(n){/* istanbul ignore next -- @preserve */E.rethrowUnexpectedError(n,this)}}focus(){this.editing.view.focus()}static create(...e){throw new Error("This is an abstract method.")}_showLicenseError(e,i){setTimeout(()=>{if(e=="invalid")throw new E("invalid-license-key");if(e=="expired")throw new E("license-key-expired");if(e=="domainLimit")throw new E("license-key-domain-limit");if(e=="featureNotAllowed")throw new E("license-key-plugin-not-allowed",null,{pluginName:i});if(e=="evaluationLimit")throw new E("license-key-evaluation-limit");if(e=="trialLimit")throw new E("license-key-trial-limit");if(e=="developmentLimit")throw new E("license-key-development-limit");if(e=="usageLimit")throw new E("license-key-usage-limit");if(e=="distributionChannel")throw new E("license-key-invalid-distribution-channel")},0),this._showLicenseError=()=>{}}async _sendUsageRequest(e,i){const n=new Headers({"Content-Type":"application/json"}),r=await fetch(new URL(e),{method:"POST",headers:n,body:JSON.stringify(i)});if(!r.ok)throw new Error(`HTTP Response: ${r.status}`);return r.json()}}p(Fa,"defaultConfig"),p(Fa,"builtinPlugins"),p(Fa,"Context",AC),p(Fa,"EditorWatchdog",HA),p(Fa,"ContextWatchdog",CF);function DF(s){const t=IF(s);function e(i,n){if(Eo(t,i)!==void 0)throw new E("editor-usage-data-path-already-set",{path:i});P6(t,i,n)}return s.fire("collectUsageData",{setUsageData:e}),t}function QF(s){if(!hg(s.updateSourceElement))throw new E("attachtoform-missing-elementapi-interface",s);const t=s.sourceElement;if(NF(t)&&t.form){let e;const i=t.form,n=()=>s.updateSourceElement();hg(i.submit)&&(e=i.submit,i.submit=()=>{n(),e.apply(i)}),i.addEventListener("submit",n),s.on("destroy",()=>{i.removeEventListener("submit",n),e&&(i.submit=e)})}}function NF(s){return!!s&&s.tagName.toLowerCase()==="textarea"}function Nb(s){class t extends s{constructor(){super(...arguments);p(this,"sourceElement")}updateSourceElement(n){if(!this.sourceElement)throw new E("editor-missing-sourceelement",this);const r=this.config.get("updateSourceElementOnDestroy"),o=this.sourceElement instanceof HTMLTextAreaElement;if(!r&&!o){MS(this.sourceElement,"");return}const l=typeof n=="string"?n:this.data.get();MS(this.sourceElement,l)}}return t}Nb.updateSourceElement=Nb(Object).prototype.updateSourceElement;class Ro extends Tp{constructor(){super(...arguments);p(this,"_actions")}static get pluginName(){return"PendingActions"}static get isOfficialPlugin(){return!0}init(){this.set("hasAny",!1),this._actions=new di({idProperty:"_id"}),this._actions.delegate("add","remove").to(this)}add(e){if(typeof e!="string")throw new E("pendingactions-add-invalid-message",this);const i=new(at());return i.set("message",e),this._actions.add(i),this.hasAny=!0,i}remove(e){this._actions.remove(e),this.hasAny=!!this._actions.length}get first(){return this._actions.get(0)}[Symbol.iterator](){return this._actions[Symbol.iterator]()}}/**
 * @license Copyright (c) 2003-2025, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options
 */let FF=class extends at(){constructor(){super();p(this,"total");p(this,"_reader");p(this,"_data");const e=new window.FileReader;this._reader=e,this._data=void 0,this.set("loaded",0),e.onprogress=i=>{this.loaded=i.loaded}}get error(){return this._reader.error}get data(){return this._data}read(e){const i=this._reader;return this.total=e.size,new Promise((n,r)=>{i.onload=()=>{const o=i.result;this._data=o,n(o)},i.onerror=()=>{r("error")},i.onabort=()=>{r("aborted")},this._reader.readAsDataURL(e)})}abort(){this._reader.abort()}};class yo extends F{constructor(){super(...arguments);p(this,"loaders",new di);p(this,"_loadersMap",new Map);p(this,"_pendingAction",null)}static get pluginName(){return"FileRepository"}static get isOfficialPlugin(){return!0}static get requires(){return[Ro]}init(){this.loaders.on("change",()=>this._updatePendingAction()),this.set("uploaded",0),this.set("uploadTotal",null),this.bind("uploadedPercent").to(this,"uploaded",this,"uploadTotal",(e,i)=>i?e/i*100:0)}getLoader(e){return this._loadersMap.get(e)||null}createLoader(e){if(!this.createUploadAdapter)return Ue("filerepository-no-upload-adapter"),null;const i=new RC(Promise.resolve(e),this.createUploadAdapter);return this.loaders.add(i),this._loadersMap.set(e,i),e instanceof Promise&&i.file.then(n=>{this._loadersMap.set(n,i)}).catch(()=>{}),i.on("change:uploaded",()=>{let n=0;for(const r of this.loaders)n+=r.uploaded;this.uploaded=n}),i.on("change:uploadTotal",()=>{let n=0;for(const r of this.loaders)r.uploadTotal&&(n+=r.uploadTotal);this.uploadTotal=n}),i}destroyLoader(e){const i=e instanceof RC?e:this.getLoader(e);i._destroy(),this.loaders.remove(i),this._loadersMap.forEach((n,r)=>{n===i&&this._loadersMap.delete(r)})}_updatePendingAction(){const e=this.editor.plugins.get(Ro);if(this.loaders.length){if(!this._pendingAction){const i=this.editor.t,n=r=>`${i("Upload in progress")} ${parseInt(r)}%.`;this._pendingAction=e.add(n(this.uploadedPercent)),this._pendingAction.bind("message").to(this,"uploadedPercent",n)}}else e.remove(this._pendingAction),this._pendingAction=null}}class RC extends at(){constructor(e,i){super();p(this,"id");p(this,"_filePromiseWrapper");p(this,"_adapter");p(this,"_reader");this.id=ei(),this._filePromiseWrapper=this._createFilePromiseWrapper(e),this._adapter=i(this),this._reader=new FF,this.set("status","idle"),this.set("uploaded",0),this.set("uploadTotal",null),this.bind("uploadedPercent").to(this,"uploaded",this,"uploadTotal",(n,r)=>r?n/r*100:0),this.set("uploadResponse",null)}get file(){return this._filePromiseWrapper?this._filePromiseWrapper.promise.then(e=>this._filePromiseWrapper?e:null):Promise.resolve(null)}get data(){return this._reader.data}read(){if(this.status!="idle")throw new E("filerepository-read-wrong-status",this);return this.status="reading",this.file.then(e=>this._reader.read(e)).then(e=>{if(this.status!=="reading")throw this.status;return this.status="idle",e}).catch(e=>{throw e==="aborted"?(this.status="aborted","aborted"):(this.status="error",this._reader.error?this._reader.error:e)})}upload(){if(this.status!="idle")throw new E("filerepository-upload-wrong-status",this);return this.status="uploading",this.file.then(()=>this._adapter.upload()).then(e=>(this.uploadResponse=e,this.status="idle",e)).catch(e=>{throw this.status==="aborted"?"aborted":(this.status="error",e)})}abort(){const e=this.status;this.status="aborted",this._filePromiseWrapper.isFulfilled?e=="reading"?this._reader.abort():e=="uploading"&&this._adapter.abort&&this._adapter.abort():(this._filePromiseWrapper.promise.catch(()=>{}),this._filePromiseWrapper.rejecter("aborted")),this._destroy()}_destroy(){this._filePromiseWrapper=void 0,this._reader=void 0,this._adapter=void 0,this.uploadResponse=void 0}_createFilePromiseWrapper(e){const i={};return i.promise=new Promise((n,r)=>{i.rejecter=r,i.isFulfilled=!1,e.then(o=>{i.isFulfilled=!0,n(o)}).catch(o=>{i.isFulfilled=!0,r(o)})}),i}}/**
 * @license Copyright (c) 2003-2025, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options
 */var VC='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M10 6.628a1.5 1.5 0 1 0 0-3 1.5 1.5 0 0 0 0 3Z"/><path d="M8.5 9.125a.3.3 0 0 0-.253-.296L5.11 8.327a.75.75 0 1 1 .388-1.449l4.04.716c.267.072.624.08.893.009l4.066-.724a.75.75 0 1 1 .388 1.45l-3.132.5a.3.3 0 0 0-.253.296v1.357a.3.3 0 0 0 .018.102l1.615 4.438a.75.75 0 0 1-1.41.513l-1.35-3.71a.3.3 0 0 0-.281-.197h-.209a.3.3 0 0 0-.282.198l-1.35 3.711a.75.75 0 0 1-1.41-.513l1.64-4.509a.3.3 0 0 0 .019-.103V9.125Z"/><path clip-rule="evenodd" d="M10 18.5a8.5 8.5 0 1 1 0-17 8.5 8.5 0 0 1 0 17Zm0 1.5c5.523 0 10-4.477 10-10S15.523 0 10 0 0 4.477 0 10s4.477 10 10 10Z"/></svg>',zF='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="m9.239 13.938-2.88-1.663a.75.75 0 0 1 .75-1.3L9 12.067V4.75a.75.75 0 1 1 1.5 0v7.318l1.89-1.093a.75.75 0 0 1 .75 1.3l-2.879 1.663a.752.752 0 0 1-.511.187.752.752 0 0 1-.511-.187zM4.25 17a.75.75 0 1 1 0-1.5h10.5a.75.75 0 0 1 0 1.5H4.25z"/></svg>',WF='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M2 3.75c0 .414.336.75.75.75h14.5a.75.75 0 1 0 0-1.5H2.75a.75.75 0 0 0-.75.75zm0 8c0 .414.336.75.75.75h14.5a.75.75 0 1 0 0-1.5H2.75a.75.75 0 0 0-.75.75zm2.286 4c0 .414.336.75.75.75h9.928a.75.75 0 1 0 0-1.5H5.036a.75.75 0 0 0-.75.75zm0-8c0 .414.336.75.75.75h9.928a.75.75 0 1 0 0-1.5H5.036a.75.75 0 0 0-.75.75z"/></svg>',UF='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M2 3.75c0 .414.336.75.75.75h14.5a.75.75 0 1 0 0-1.5H2.75a.75.75 0 0 0-.75.75zm0 8c0 .414.336.75.75.75h14.5a.75.75 0 1 0 0-1.5H2.75a.75.75 0 0 0-.75.75zm0 4c0 .414.336.75.75.75h9.929a.75.75 0 1 0 0-1.5H2.75a.75.75 0 0 0-.75.75zm0-8c0 .414.336.75.75.75h14.5a.75.75 0 1 0 0-1.5H2.75a.75.75 0 0 0-.75.75z"/></svg>',jA='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M2 3.75c0 .414.336.75.75.75h14.5a.75.75 0 1 0 0-1.5H2.75a.75.75 0 0 0-.75.75zm0 8c0 .414.336.75.75.75h14.5a.75.75 0 1 0 0-1.5H2.75a.75.75 0 0 0-.75.75zm0 4c0 .414.336.75.75.75h9.929a.75.75 0 1 0 0-1.5H2.75a.75.75 0 0 0-.75.75zm0-8c0 .414.336.75.75.75h9.929a.75.75 0 1 0 0-1.5H2.75a.75.75 0 0 0-.75.75z"/></svg>',ZF='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M9.75 11.875a.752.752 0 0 1 .508.184l2.883 1.666a.75.75 0 0 1-.659 1.344l-.091-.044-1.892-1.093.001 4.318a.75.75 0 1 1-1.5 0v-4.317l-1.89 1.092a.75.75 0 0 1-.75-1.3l2.879-1.663a.752.752 0 0 1 .51-.187zM15.25 9a.75.75 0 1 1 0 1.5H4.75a.75.75 0 1 1 0-1.5h10.5zM9.75.375a.75.75 0 0 1 .75.75v4.318l1.89-1.093.092-.045a.75.75 0 0 1 .659 1.344l-2.883 1.667a.752.752 0 0 1-.508.184.752.752 0 0 1-.511-.187L6.359 5.65a.75.75 0 0 1 .75-1.299L9 5.442V1.125a.75.75 0 0 1 .75-.75z"/></svg>',HF='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M18 3.75a.75.75 0 0 1-.75.75H2.75a.75.75 0 1 1 0-1.5h14.5a.75.75 0 0 1 .75.75zm0 8a.75.75 0 0 1-.75.75H2.75a.75.75 0 1 1 0-1.5h14.5a.75.75 0 0 1 .75.75zm0 4a.75.75 0 0 1-.75.75H7.321a.75.75 0 1 1 0-1.5h9.929a.75.75 0 0 1 .75.75zm0-8a.75.75 0 0 1-.75.75H7.321a.75.75 0 1 1 0-1.5h9.929a.75.75 0 0 1 .75.75z"/></svg>',qF='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="m10.261 7.062 2.88 1.663a.75.75 0 0 1-.75 1.3L10.5 8.933v7.317a.75.75 0 1 1-1.5 0V8.932l-1.89 1.093a.75.75 0 0 1-.75-1.3l2.879-1.663a.752.752 0 0 1 .511-.187.752.752 0 0 1 .511.187zM15.25 4a.75.75 0 1 1 0 1.5H4.75a.75.75 0 0 1 0-1.5h10.5z"/></svg>',XA='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M10.187 17H5.773c-.637 0-1.092-.138-1.364-.415-.273-.277-.409-.718-.409-1.323V4.738c0-.617.14-1.062.419-1.332.279-.27.73-.406 1.354-.406h4.68c.69 0 1.288.041 1.793.124.506.083.96.242 1.36.478.341.197.644.447.906.75a3.262 3.262 0 0 1 .808 2.162c0 1.401-.722 2.426-2.167 3.075C15.05 10.175 16 11.315 16 13.01a3.756 3.756 0 0 1-2.296 3.504 6.1 6.1 0 0 1-1.517.377c-.571.073-1.238.11-2 .11zm-.217-6.217H7v4.087h3.069c1.977 0 2.965-.69 2.965-2.072 0-.707-.256-1.22-.768-1.537-.512-.319-1.277-.478-2.296-.478zM7 5.13v3.619h2.606c.729 0 1.292-.067 1.69-.2a1.6 1.6 0 0 0 .91-.765c.165-.267.247-.566.247-.897 0-.707-.26-1.176-.778-1.409-.519-.232-1.31-.348-2.375-.348H7z"/></svg>',MC='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M11.627 16.5zm5.873-.196zm0-7.001V8h-13v8.5h4.341c.191.54.457 1.044.785 1.5H2a1.5 1.5 0 0 1-1.5-1.5v-13A1.5 1.5 0 0 1 2 2h4.5a1.5 1.5 0 0 1 1.06.44L9.122 4H16a1.5 1.5 0 0 1 1.5 1.5v1A1.5 1.5 0 0 1 19 8v2.531a6.027 6.027 0 0 0-1.5-1.228zM16 6.5v-1H8.5l-2-2H2v13h1V8a1.5 1.5 0 0 1 1.5-1.5H16z"/><path d="M14.5 19.5a5 5 0 1 1 0-10 5 5 0 0 1 0 10zM15 14v-2h-1v2h-2v1h2v2h1v-2h2v-1h-2z"/></svg>',ey='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M7 5.75c0 .414.336.75.75.75h9.5a.75.75 0 1 0 0-1.5h-9.5a.75.75 0 0 0-.75.75zm-6 0C1 4.784 1.777 4 2.75 4c.966 0 1.75.777 1.75 1.75 0 .966-.777 1.75-1.75 1.75C1.784 7.5 1 6.723 1 5.75zm6 9c0 .414.336.75.75.75h9.5a.75.75 0 1 0 0-1.5h-9.5a.75.75 0 0 0-.75.75zm-6 0c0-.966.777-1.75 1.75-1.75.966 0 1.75.777 1.75 1.75 0 .966-.777 1.75-1.75 1.75-.966 0-1.75-.777-1.75-1.75z"/></svg>',Ac='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="m11.591 10.177 4.243 4.242a1 1 0 0 1-1.415 1.415l-4.242-4.243-4.243 4.243a1 1 0 0 1-1.414-1.415l4.243-4.242L4.52 5.934A1 1 0 0 1 5.934 4.52l4.243 4.243 4.242-4.243a1 1 0 1 1 1.415 1.414l-4.243 4.243z"/></svg>',GA='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M2 16h9a1 1 0 0 1 0 2H2a1 1 0 0 1 0-2z"/><path d="M17 1a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2V3a2 2 0 0 1 2-2h14zm0 1.5H3a.5.5 0 0 0-.492.41L2.5 3v9a.5.5 0 0 0 .41.492L3 12.5h14a.5.5 0 0 0 .492-.41L17.5 12V3a.5.5 0 0 0-.41-.492L17 2.5z" fill-opacity=".6"/></svg>',Ic='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M6.972 16.615a.997.997 0 0 1-.744-.292l-4.596-4.596a1 1 0 1 1 1.414-1.414l3.926 3.926 9.937-9.937a1 1 0 0 1 1.414 1.415L7.717 16.323a.997.997 0 0 1-.745.292z"/></svg>',jF='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M1.201 1C.538 1 0 1.47 0 2.1v14.363c0 .64.534 1.037 1.186 1.037H5.06l5.058-5.078L6.617 9.15a.696.696 0 0 0-.957-.033L1.5 13.6V2.5h15v4.354a3.478 3.478 0 0 1 1.5.049V2.1c0-.63-.547-1.1-1.2-1.1H1.202Zm11.713 2.803a2.147 2.147 0 0 0-2.049 1.992 2.14 2.14 0 0 0 1.28 2.096 2.13 2.13 0 0 0 2.642-3.11 2.129 2.129 0 0 0-1.873-.978ZM8.089 17.635v2.388h2.389l7.046-7.046-2.39-2.39-7.045 7.048Zm11.282-6.507a.637.637 0 0 0 .139-.692.603.603 0 0 0-.139-.205l-1.49-1.488a.63.63 0 0 0-.899 0l-1.166 1.163 2.39 2.39 1.165-1.168Z"/></svg>',LC='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M12.87 12.61a.75.75 0 0 1-.089.976l-.085.07-3.154 2.254 3.412 2.414a.75.75 0 0 1 .237.95l-.057.095a.75.75 0 0 1-.95.237l-.096-.058-4.272-3.022-.003-1.223 4.01-2.867a.75.75 0 0 1 1.047.174zm2.795-.231.095.057 4.011 2.867-.003 1.223-4.272 3.022-.095.058a.75.75 0 0 1-.88-.151l-.07-.086-.058-.095a.75.75 0 0 1 .15-.88l.087-.07 3.412-2.414-3.154-2.253-.085-.071a.75.75 0 0 1 .862-1.207zM16 0a2 2 0 0 1 2 2v9.354l-.663-.492-.837-.001V2a.5.5 0 0 0-.5-.5H2a.5.5 0 0 0-.5.5v15a.5.5 0 0 0 .5.5h3.118L7.156 19H2a2 2 0 0 1-2-2V2a2 2 0 0 1 2-2h14zM5.009 15l.003 1H3v-1h2.009zm2.188-2-1.471 1H5v-1h2.197zM10 11v.095L8.668 12H7v-1h3zm4-2v1H7V9h7zm0-2v1H7V7h7zm-4-2v1H5V5h5zM6 3v1H3V3h3z"/></svg>',XF='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="m12.5 5.7 5.2 3.9v1.3l-5.6 4c-.1.2-.3.2-.5.2-.3-.1-.6-.7-.6-1l.3-.4 4.7-3.5L11.5 7l-.2-.2c-.1-.3-.1-.6 0-.8.2-.2.5-.4.8-.4a.8.8 0 0 1 .4.1zm-5.2 0L2 9.6v1.3l5.6 4c.1.2.3.2.5.2.3-.1.7-.7.6-1 0-.1 0-.3-.2-.4l-5-3.5L8.2 7l.2-.2c.1-.3.1-.6 0-.8-.2-.2-.5-.4-.8-.4a.8.8 0 0 0-.3.1z"/></svg>',GF='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M10.209 18.717A8.5 8.5 0 1 1 18.686 9.6h-.008l.002.12a3 3 0 0 1-2.866 2.997h-.268l-.046-.002v.002h-4.791a2 2 0 1 0 0 4 1 1 0 1 1-.128 1.992 8.665 8.665 0 0 1-.372.008Zm-3.918-7.01a1.25 1.25 0 1 0-2.415-.648 1.25 1.25 0 0 0 2.415.647ZM5.723 8.18a1.25 1.25 0 1 0 .647-2.414 1.25 1.25 0 0 0-.647 2.414ZM9.76 6.155a1.25 1.25 0 1 0 .647-2.415 1.25 1.25 0 0 0-.647 2.415Zm4.028 1.759a1.25 1.25 0 1 0 .647-2.415 1.25 1.25 0 0 0-.647 2.415Z"/></svg>',YF='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path class="ck-icon__fill" d="M16.935 5.328a2 2 0 0 1 0 2.829l-7.778 7.778a2 2 0 0 1-2.829 0L3.5 13.107a1.999 1.999 0 1 1 2.828-2.829l.707.707a1 1 0 0 0 1.414 0l5.658-5.657a2 2 0 0 1 2.828 0z"/><path d="M14.814 6.035 8.448 12.4a1 1 0 0 1-1.414 0l-1.413-1.415A1 1 0 1 0 4.207 12.4l2.829 2.829a1 1 0 0 0 1.414 0l7.778-7.778a1 1 0 1 0-1.414-1.415z"/></svg>',BC='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M5 2.801a.7.7 0 0 0-.7.7v11.5a.8.8 0 0 1-1.6 0v-11.5a2.3 2.3 0 0 1 2.3-2.3h6.5a.8.8 0 0 1 0 1.6H5Zm.7 3.7a2.3 2.3 0 0 1 2.3-2.3h7a2.3 2.3 0 0 1 2.3 2.3v10a2.3 2.3 0 0 1-2.3 2.3H8a2.3 2.3 0 0 1-2.3-2.3v-10Zm2.3-.7a.7.7 0 0 0-.7.7v10a.7.7 0 0 0 .7.7h7a.7.7 0 0 0 .7-.7v-10a.7.7 0 0 0-.7-.7H8Z"/></svg>',KF='<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><path d="M4 0v1H1v3H0V.5A.5.5 0 0 1 .5 0H4zm8 0h3.5a.5.5 0 0 1 .5.5V4h-1V1h-3V0zM4 16H.5a.5.5 0 0 1-.5-.5V12h1v3h3v1zm8 0v-1h3v-3h1v3.5a.5.5 0 0 1-.5.5H12z"/><path fill-opacity=".256" d="M1 1h14v14H1z"/><g class="ck-icon__selected-indicator"><path d="M7 0h2v1H7V0zM0 7h1v2H0V7zm15 0h1v2h-1V7zm-8 8h2v1H7v-1z"/><path fill-opacity=".254" d="M1 1h14v14H1z"/></g></svg>',JF='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M5 3.25a1.5 1.5 0 1 0 3 0 1.5 1.5 0 1 0-3 0"/><path d="M12 3.25a1.5 1.5 0 1 0 3 0 1.5 1.5 0 1 0-3 0"/><path d="M5 10a1.5 1.5 0 1 0 3 0 1.5 1.5 0 1 0-3 0"/><path d="M12 10a1.5 1.5 0 1 0 3 0 1.5 1.5 0 1 0-3 0"/><path d="M5 16.75a1.5 1.5 0 1 0 3 0 1.5 1.5 0 1 0-3 0"/><path d="M12 16.75a1.5 1.5 0 1 0 3 0 1.5 1.5 0 1 0-3 0"/></svg>',ud='<svg viewBox="0 0 10 10" xmlns="http://www.w3.org/2000/svg"><path d="M.941 4.523a.75.75 0 1 1 1.06-1.06l3.006 3.005 3.005-3.005a.75.75 0 1 1 1.06 1.06l-3.549 3.55a.75.75 0 0 1-1.168-.136L.941 4.523z"/></svg>',ez='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path clip-rule="evenodd" d="M8.5 8.25a1.25 1.25 0 1 1-2.499.001A1.25 1.25 0 0 1 8.5 8.25Z"/><path clip-rule="evenodd" d="M14 8.25a1.25 1.25 0 1 1-2.499.001A1.25 1.25 0 0 1 14 8.25Z"/><path clip-rule="evenodd" d="M7.127 12.088a.75.75 0 1 0-1.254.824C6.88 14.444 8.423 15.25 10 15.25c1.578 0 3.12-.805 4.127-2.338a.75.75 0 0 0-1.254-.824C12.13 13.221 11.048 13.75 10 13.75c-1.047 0-2.13-.529-2.873-1.662Z"/><path d="M10 19a9 9 0 1 0 0-18 9 9 0 0 0 0 18Zm0-1.5a7.5 7.5 0 1 1 0-15 7.5 7.5 0 0 1 0 15Z"/></svg>',tz='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="m8.636 9.531-2.758 3.94a.5.5 0 0 0 .122.696l3.224 2.284h1.314l2.636-3.736L8.636 9.53zm.288 8.451L5.14 15.396a2 2 0 0 1-.491-2.786l6.673-9.53a2 2 0 0 1 2.785-.49l3.742 2.62a2 2 0 0 1 .491 2.785l-7.269 10.053-2.147-.066z"/><path d="M4 18h5.523v-1H4zm-2 0h1v-1H2z"/></svg>',iz='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path clip-rule="evenodd" d="M9.9 4.385a1.2 1.2 0 0 0-.44.44h.002l-5.284 9.15a1.2 1.2 0 0 0 1.04 1.8h10.564a1.2 1.2 0 0 0 1.04-1.8l-5.282-9.15a1.2 1.2 0 0 0-1.64-.44Zm.05 8.363a.301.301 0 0 1 .115-.023h.9a.301.301 0 0 1 .3.3v.9a.3.3 0 0 1-.3.3h-.9a.3.3 0 0 1-.3-.3v-.9a.3.3 0 0 1 .185-.277Zm-.185-4.723a.3.3 0 0 1 .3-.3h.9a.3.3 0 0 1 .3.3v3.4a.3.3 0 0 1-.3.3h-.9a.301.301 0 0 1-.3-.3v-3.4Z"/></svg>',nz='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M11 1a9 9 0 1 1-8.027 13.075l1.128-1.129A7.502 7.502 0 0 0 18.5 10a7.5 7.5 0 1 0-14.962.759l-.745-.746-.76.76A9 9 0 0 1 11 1z"/><path d="M.475 8.17a.75.75 0 0 1 .978.047l.075.082 1.284 1.643 1.681-1.284a.75.75 0 0 1 .978.057l.073.083a.75.75 0 0 1-.057.978l-.083.073-2.27 1.737a.75.75 0 0 1-.973-.052l-.074-.082-1.741-2.23a.75.75 0 0 1 .13-1.052z"/><path d="M11.5 5v4.999l3.196 3.196-1.06 1.06L10.1 10.72l-.1-.113V5z"/></svg>',sz='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M17 0a2 2 0 0 1 2 2v7a1 1 0 0 1 1 1v5a1 1 0 0 1-.883.993l-.118.006L19 17a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2l-.001-1.001-.116-.006A1 1 0 0 1 0 15v-5a1 1 0 0 1 .999-1L1 2a2 2 0 0 1 2-2h14zm.499 15.999h-15L2.5 17a.5.5 0 0 0 .5.5h14a.5.5 0 0 0 .5-.5l-.001-1.001zm-3.478-6.013-.014.014H14v.007l-1.525 1.525-1.46-1.46-.015.013V10h-1v5h1v-3.53l1.428 1.43.048.043.131-.129L14 11.421V15h1v-5h-.965l-.014-.014zM2 10H1v5h1v-2h2v2h1v-5H4v2H2v-2zm7 0H6v1h1v4h1v-4h1v-1zm8 0h-1v5h3v-1h-2v-4zm0-8.5H3a.5.5 0 0 0-.5.5l-.001 6.999h15L17.5 2a.5.5 0 0 0-.5-.5zM10 7v1H4V7h6zm3-2v1H4V5h9zm-3-2v1H4V3h6z"/></svg>',sx='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M1.201 1c-.662 0-1.2.47-1.2 1.1v14.248c0 .64.533 1.152 1.185 1.152h6.623v-7.236L6.617 9.15a.694.694 0 0 0-.957-.033L1.602 13.55V2.553l14.798.003V9.7H18V2.1c0-.63-.547-1.1-1.2-1.1H1.202Zm11.723 2.805a2.094 2.094 0 0 0-1.621.832 2.127 2.127 0 0 0 1.136 3.357 2.13 2.13 0 0 0 2.611-1.506 2.133 2.133 0 0 0-.76-2.244 2.13 2.13 0 0 0-1.366-.44Z"/><path clip-rule="evenodd" d="M19.898 12.369v6.187a.844.844 0 0 1-.844.844h-8.719a.844.844 0 0 1-.843-.844v-7.312a.844.844 0 0 1 .843-.844h2.531a.843.843 0 0 1 .597.248l.838.852h4.75c.223 0 .441.114.6.272a.844.844 0 0 1 .247.597Zm-1.52.654-4.377.02-1.1-1.143H11v6h7.4l-.023-4.877Z"/></svg>',rz='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M6.66 9.118a.693.693 0 0 1 .956.032l3.65 3.411 2.422-2.238a.695.695 0 0 1 .945 0L17.5 13.6V2.5h-15v11.1l4.16-4.482ZM17.8 1c.652 0 1.2.47 1.2 1.1v14.362c0 .64-.532 1.038-1.184 1.038H2.184C1.532 17.5 1 17.103 1 16.462V2.1C1 1.47 1.537 1 2.2 1h15.6Zm-5.655 6a2.128 2.128 0 0 1 .157-2.364A2.133 2.133 0 1 1 12.145 7Z"/></svg>',oz='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M1.201 1C.538 1 0 1.47 0 2.1v14.363c0 .64.534 1.037 1.186 1.037h9.494a2.97 2.97 0 0 1-.414-.287 2.998 2.998 0 0 1-1.055-2.03 3.003 3.003 0 0 1 .693-2.185l.383-.455-.02.018-3.65-3.41a.695.695 0 0 0-.957-.034L1.5 13.6V2.5h15v5.535a2.97 2.97 0 0 1 1.412.932l.088.105V2.1c0-.63-.547-1.1-1.2-1.1H1.202Zm11.713 2.803a2.146 2.146 0 0 0-2.049 1.992 2.14 2.14 0 0 0 1.28 2.096 2.13 2.13 0 0 0 2.644-3.11 2.134 2.134 0 0 0-1.875-.978Z"/><path d="M15.522 19.1a.79.79 0 0 0 .79-.79v-5.373l2.059 2.455a.79.79 0 1 0 1.211-1.015l-3.352-3.995a.79.79 0 0 0-.995-.179.784.784 0 0 0-.299.221l-3.35 3.99a.79.79 0 1 0 1.21 1.017l1.936-2.306v5.185c0 .436.353.79.79.79Z"/><path d="M15.522 19.1a.79.79 0 0 0 .79-.79v-5.373l2.059 2.455a.79.79 0 1 0 1.211-1.015l-3.352-3.995a.79.79 0 0 0-.995-.179.784.784 0 0 0-.299.221l-3.35 3.99a.79.79 0 1 0 1.21 1.017l1.936-2.306v5.185c0 .436.353.79.79.79Z"/></svg>',lz='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M1.201 1C.538 1 0 1.47 0 2.1v14.363c0 .64.534 1.037 1.186 1.037h7.029a5.401 5.401 0 0 1 .615-4.338l.762-1.232-2.975-2.78a.696.696 0 0 0-.957-.033L1.5 13.6V2.5h15v6.023c.449.131.887.32 1.307.573l.058.033c.046.028.09.057.135.086V2.1c0-.63-.547-1.1-1.2-1.1H1.202Zm11.713 2.803a2.15 2.15 0 0 0-1.611.834 2.118 2.118 0 0 0-.438 1.158 2.14 2.14 0 0 0 1.277 2.096 2.132 2.132 0 0 0 2.645-3.11 2.13 2.13 0 0 0-1.873-.978Z"/><path d="M16.63 10.294a3.003 3.003 0 0 0-4.142.887l-.117.177a.647.647 0 0 0-.096.492.664.664 0 0 0 .278.418.7.7 0 0 0 .944-.234 1.741 1.741 0 0 1 2.478-.463 1.869 1.869 0 0 1 .476 2.55.637.637 0 0 0-.071.5.646.646 0 0 0 .309.396.627.627 0 0 0 .869-.19l.027-.041a3.226 3.226 0 0 0-.956-4.492Zm-6.061 3.78-.044.066a3.228 3.228 0 0 0 .82 4.403 3.005 3.005 0 0 0 4.275-.798l.13-.197a.626.626 0 0 0 .092-.475.638.638 0 0 0-.268-.402.713.713 0 0 0-.99.26l-.018.029a1.741 1.741 0 0 1-2.477.461 1.87 1.87 0 0 1-.475-2.55l.029-.047a.647.647 0 0 0 .086-.485.66.66 0 0 0-.275-.408l-.04-.027a.609.609 0 0 0-.845.17Z"/><path d="M15.312 13.925c.24-.36.154-.838-.19-1.067-.346-.23-.82-.124-1.059.236l-1.268 1.907c-.239.36-.153.838.192 1.067.345.23.818.123 1.057-.236l1.268-1.907Z"/></svg>',az='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M19 4.5 14 0H3v12.673l.868-1.041c.185-.222.4-.402.632-.54V1.5h8v5h5v7.626a2.24 2.24 0 0 1 1.5.822V4.5ZM14 5V2l3.3 3H14Zm-3.692 12.5c.062.105.133.206.213.303L11.52 19H8v-.876a2.243 2.243 0 0 0 1.82-.624h.488Zm7.518-.657a.75.75 0 0 0-1.152-.96L15.5 17.29V12H14v5.29l-1.174-1.408a.75.75 0 0 0-1.152.96l2.346 2.816a.95.95 0 0 0 1.46 0l2.346-2.815Zm-15.056-.38a.75.75 0 0 1-.096-1.056l2.346-2.815a.95.95 0 0 1 1.46 0l2.346 2.815a.75.75 0 1 1-1.152.96L6.5 14.96V20H5v-5.04l-1.174 1.408a.75.75 0 0 1-1.056.096Z"/></svg>',cz='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="m9.586 14.633.021.004c-.036.335.095.655.393.962.082.083.173.15.274.201h1.474a.6.6 0 1 1 0 1.2H5.304a.6.6 0 0 1 0-1.2h1.15c.474-.07.809-.182 1.005-.334.157-.122.291-.32.404-.597l2.416-9.55a1.053 1.053 0 0 0-.281-.823 1.12 1.12 0 0 0-.442-.296H8.15a.6.6 0 0 1 0-1.2h6.443a.6.6 0 1 1 0 1.2h-1.195c-.376.056-.65.155-.823.296-.215.175-.423.439-.623.79l-2.366 9.347z"/></svg>',YA='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="m11.077 15 .991-1.416a.75.75 0 1 1 1.229.86l-1.148 1.64a.748.748 0 0 1-.217.206 5.251 5.251 0 0 1-8.503-5.955.741.741 0 0 1 .12-.274l1.147-1.639a.75.75 0 1 1 1.228.86L4.933 10.7l.006.003a3.75 3.75 0 0 0 6.132 4.294l.006.004zm5.494-5.335a.748.748 0 0 1-.12.274l-1.147 1.639a.75.75 0 1 1-1.228-.86l.86-1.23a3.75 3.75 0 0 0-6.144-4.301l-.86 1.229a.75.75 0 0 1-1.229-.86l1.148-1.64a.748.748 0 0 1 .217-.206 5.251 5.251 0 0 1 8.503 5.955zm-4.563-2.532a.75.75 0 0 1 .184 1.045l-3.155 4.505a.75.75 0 1 1-1.229-.86l3.155-4.506a.75.75 0 0 1 1.045-.184z"/></svg>',uz='<svg viewBox="0 0 44 44" xmlns="http://www.w3.org/2000/svg"><path d="M35 29a1 1 0 0 1 1 1v1a1 1 0 0 1-1 1H18a1 1 0 0 1-1-1v-1a1 1 0 0 1 1-1h17zm0-9a1 1 0 0 1 1 1v1a1 1 0 0 1-1 1H18a1 1 0 0 1-1-1v-1a1 1 0 0 1 1-1h17zm0-9a1 1 0 0 1 1 1v1a1 1 0 0 1-1 1H18a1 1 0 0 1-1-1v-1a1 1 0 0 1 1-1h17z" fill-opacity=".163"/><path d="M11 27a3 3 0 1 1 0 6 3 3 0 0 1 0-6zm0 1a2 2 0 1 0 0 4 2 2 0 0 0 0-4zm0-10a3 3 0 1 1 0 6 3 3 0 0 1 0-6zm0 1a2 2 0 1 0 0 4 2 2 0 0 0 0-4zm0-10a3 3 0 1 1 0 6 3 3 0 0 1 0-6zm0 1a2 2 0 1 0 0 4 2 2 0 0 0 0-4z"/></svg>',hz='<svg viewBox="0 0 44 44" xmlns="http://www.w3.org/2000/svg"><path d="M35 29a1 1 0 0 1 1 1v1a1 1 0 0 1-1 1H18a1 1 0 0 1-1-1v-1a1 1 0 0 1 1-1h17zm0-9a1 1 0 0 1 1 1v1a1 1 0 0 1-1 1H18a1 1 0 0 1-1-1v-1a1 1 0 0 1 1-1h17zm0-9a1 1 0 0 1 1 1v1a1 1 0 0 1-1 1H18a1 1 0 0 1-1-1v-1a1 1 0 0 1 1-1h17z" fill-opacity=".163"/><path d="M5.714 15.11c.624 0 1.11-.22 1.46-.66.421-.533.632-1.408.632-2.627 0-1.222-.21-2.096-.629-2.624-.351-.445-.839-.668-1.463-.668-.624 0-1.11.22-1.459.66-.422.533-.633 1.406-.633 2.619 0 1.236.192 2.095.576 2.577.384.482.89.723 1.516.723zm0-1.024a.614.614 0 0 1-.398-.14c-.115-.094-.211-.283-.287-.565-.077-.283-.115-.802-.115-1.558s.043-1.294.128-1.613c.064-.246.155-.417.272-.512a.617.617 0 0 1 .4-.143.61.61 0 0 1 .398.143c.116.095.211.284.288.567.076.283.114.802.114 1.558s-.043 1.292-.128 1.608c-.064.246-.155.417-.272.512a.617.617 0 0 1-.4.143zm6.078.914V8.531H10.79c-.14.393-.4.736-.778 1.03-.378.295-.728.495-1.05.6v1.121a4.257 4.257 0 0 0 1.595-.936V15h1.235zm3.344 0v-1.235h-1.235V15h1.235zm-9.422 9.11c.624 0 1.11-.22 1.46-.66.421-.533.632-1.408.632-2.627 0-1.222-.21-2.096-.629-2.624-.351-.445-.839-.668-1.463-.668-.624 0-1.11.22-1.459.66-.422.533-.633 1.406-.633 2.619 0 1.236.192 2.095.576 2.577.384.482.89.723 1.516.723zm0-1.024a.614.614 0 0 1-.398-.14c-.115-.094-.211-.283-.287-.565-.077-.283-.115-.802-.115-1.558s.043-1.294.128-1.613c.064-.246.155-.417.272-.512a.617.617 0 0 1 .4-.143.61.61 0 0 1 .398.143c.116.095.211.284.288.567.076.283.114.802.114 1.558s-.043 1.292-.128 1.608c-.064.246-.155.417-.272.512a.617.617 0 0 1-.4.143zm7.088.914v-1.147H10.35c.065-.111.149-.226.253-.343.104-.117.35-.354.74-.712.39-.357.66-.631.81-.821.225-.288.39-.562.493-.824.104-.263.156-.539.156-.829 0-.51-.181-.936-.544-1.279-.364-.342-.863-.514-1.499-.514-.58 0-1.063.148-1.45.444-.387.296-.617.784-.69 1.463l1.23.124c.024-.36.112-.619.264-.774.152-.155.357-.233.615-.233.261 0 .465.074.613.222.148.148.222.36.222.635 0 .25-.085.501-.255.756-.126.185-.467.536-1.024 1.055-.691.641-1.154 1.156-1.388 1.544-.235.389-.375.8-.422 1.233h4.328zm2.334 0v-1.235h-1.235V24h1.235zM5.714 34.11c.624 0 1.11-.22 1.46-.66.421-.533.632-1.408.632-2.627 0-1.222-.21-2.096-.629-2.624-.351-.445-.839-.668-1.463-.668-.624 0-1.11.22-1.459.66-.422.533-.633 1.406-.633 2.619 0 1.236.192 2.095.576 2.577.384.482.89.723 1.516.723zm0-1.024a.614.614 0 0 1-.398-.14c-.115-.094-.211-.283-.287-.565-.077-.283-.115-.802-.115-1.558s.043-1.294.128-1.613c.064-.246.155-.417.272-.512a.617.617 0 0 1 .4-.143.61.61 0 0 1 .398.143c.116.095.211.284.288.567.076.283.114.802.114 1.558s-.043 1.292-.128 1.608c-.064.246-.155.417-.272.512a.617.617 0 0 1-.4.143zm4.992 1.024c.616 0 1.13-.2 1.543-.598.413-.398.62-.88.62-1.446 0-.39-.111-.722-.332-.997a1.5 1.5 0 0 0-.886-.532c.618-.337.927-.788.927-1.353 0-.399-.15-.756-.452-1.073-.366-.386-.853-.58-1.46-.58a2.25 2.25 0 0 0-.96.2 1.617 1.617 0 0 0-.667.55c-.16.232-.28.544-.359.933l1.139.194c.032-.282.123-.495.272-.642.15-.146.33-.22.54-.22.214 0 .386.065.515.194s.193.302.193.518c0 .255-.088.46-.264.613-.175.154-.43.227-.764.218l-.136 1.006c.22-.061.408-.092.566-.092.24 0 .444.09.611.272.167.182.25.428.25.739 0 .328-.086.589-.26.782a.833.833 0 0 1-.644.29.841.841 0 0 1-.607-.242c-.167-.16-.27-.394-.308-.698l-1.195.145c.062.542.284.98.668 1.316.384.335.867.503 1.45.503zm4.43-.11v-1.235h-1.235V34h1.235z"/></svg>',dz='<svg viewBox="0 0 44 44" xmlns="http://www.w3.org/2000/svg"><path d="M35 29a1 1 0 0 1 1 1v1a1 1 0 0 1-1 1H18a1 1 0 0 1-1-1v-1a1 1 0 0 1 1-1h17zm0-9a1 1 0 0 1 1 1v1a1 1 0 0 1-1 1H18a1 1 0 0 1-1-1v-1a1 1 0 0 1 1-1h17zm0-9a1 1 0 0 1 1 1v1a1 1 0 0 1-1 1H18a1 1 0 0 1-1-1v-1a1 1 0 0 1 1-1h17z" fill-opacity=".163"/><path d="M10.29 15V8.531H9.286c-.14.393-.4.736-.778 1.03-.378.295-.728.495-1.05.6v1.121a4.257 4.257 0 0 0 1.595-.936V15h1.235zm3.343 0v-1.235h-1.235V15h1.235zM11.3 24v-1.147H8.848c.064-.111.148-.226.252-.343.104-.117.351-.354.74-.712.39-.357.66-.631.81-.821.225-.288.39-.562.494-.824.104-.263.156-.539.156-.829 0-.51-.182-.936-.545-1.279-.363-.342-.863-.514-1.499-.514-.58 0-1.063.148-1.45.444-.387.296-.617.784-.69 1.463l1.23.124c.024-.36.112-.619.264-.774.153-.155.358-.233.616-.233.26 0 .465.074.613.222.148.148.222.36.222.635 0 .25-.085.501-.255.756-.126.185-.468.536-1.024 1.055-.692.641-1.155 1.156-1.389 1.544-.234.389-.375.8-.422 1.233H11.3zm2.333 0v-1.235h-1.235V24h1.235zM9.204 34.11c.615 0 1.129-.2 1.542-.598.413-.398.62-.88.62-1.446 0-.39-.11-.722-.332-.997a1.5 1.5 0 0 0-.886-.532c.619-.337.928-.788.928-1.353 0-.399-.151-.756-.453-1.073-.366-.386-.852-.58-1.459-.58a2.25 2.25 0 0 0-.96.2 1.617 1.617 0 0 0-.668.55c-.16.232-.28.544-.358.933l1.138.194c.032-.282.123-.495.272-.642.15-.146.33-.22.54-.22.215 0 .386.065.515.194s.193.302.193.518c0 .255-.087.46-.263.613-.176.154-.43.227-.765.218l-.136 1.006c.22-.061.409-.092.567-.092.24 0 .444.09.61.272.168.182.251.428.251.739 0 .328-.087.589-.261.782a.833.833 0 0 1-.644.29.841.841 0 0 1-.607-.242c-.167-.16-.27-.394-.307-.698l-1.196.145c.062.542.285.98.668 1.316.384.335.868.503 1.45.503zm4.43-.11v-1.235h-1.236V34h1.235z"/></svg>',fz='<svg viewBox="0 0 44 44" xmlns="http://www.w3.org/2000/svg"><path d="M35 29a1 1 0 0 1 1 1v1a1 1 0 0 1-1 1H18a1 1 0 0 1-1-1v-1a1 1 0 0 1 1-1h17zm0-9a1 1 0 0 1 1 1v1a1 1 0 0 1-1 1H18a1 1 0 0 1-1-1v-1a1 1 0 0 1 1-1h17zm0-9a1 1 0 0 1 1 1v1a1 1 0 0 1-1 1H18a1 1 0 0 1-1-1v-1a1 1 0 0 1 1-1h17z" fill-opacity=".163"/><path d="M11 27a3 3 0 1 1 0 6 3 3 0 0 1 0-6zm0-9a3 3 0 1 1 0 6 3 3 0 0 1 0-6zm0-9a3 3 0 1 1 0 6 3 3 0 0 1 0-6z"/></svg>',mz='<svg viewBox="0 0 44 44" xmlns="http://www.w3.org/2000/svg"><path d="M35 29a1 1 0 0 1 1 1v1a1 1 0 0 1-1 1H18a1 1 0 0 1-1-1v-1a1 1 0 0 1 1-1h17zm0-9a1 1 0 0 1 1 1v1a1 1 0 0 1-1 1H18a1 1 0 0 1-1-1v-1a1 1 0 0 1 1-1h17zm0-9a1 1 0 0 1 1 1v1a1 1 0 0 1-1 1H18a1 1 0 0 1-1-1v-1a1 1 0 0 1 1-1h17z" fill-opacity=".163"/><path d="M9.62 14.105c.272 0 .528-.05.768-.153s.466-.257.677-.462c.009.024.023.072.044.145.047.161.086.283.119.365h1.221a2.649 2.649 0 0 1-.222-.626c-.04-.195-.059-.498-.059-.908l.013-1.441c0-.536-.055-.905-.165-1.105-.11-.201-.3-.367-.569-.497-.27-.13-.68-.195-1.23-.195-.607 0-1.064.108-1.371.325-.308.217-.525.55-.65 1.002l1.12.202c.076-.217.176-.369.299-.455.123-.086.294-.13.514-.13.325 0 .546.05.663.152.118.101.176.27.176.508v.123c-.222.093-.622.194-1.2.303-.427.082-.755.178-.982.288-.227.11-.403.268-.53.474a1.327 1.327 0 0 0-.188.706c0 .398.138.728.415.988.277.261.656.391 1.136.391zm.368-.87a.675.675 0 0 1-.492-.189.606.606 0 0 1-.193-.448c0-.176.08-.32.241-.435.106-.07.33-.142.673-.215a7.19 7.19 0 0 0 .751-.19v.247c0 .296-.016.496-.048.602a.773.773 0 0 1-.295.409 1.07 1.07 0 0 1-.637.22zm4.645.765v-1.235h-1.235V14h1.235zM10.2 25.105c.542 0 1.003-.215 1.382-.646.38-.43.57-1.044.57-1.84 0-.771-.187-1.362-.559-1.774a1.82 1.82 0 0 0-1.41-.617c-.522 0-.973.216-1.354.65v-2.32H7.594V25h1.147v-.686a1.9 1.9 0 0 0 .67.592c.26.133.523.2.79.2zm-.299-.975c-.354 0-.638-.164-.852-.492-.153-.232-.229-.59-.229-1.073 0-.468.098-.818.295-1.048a.93.93 0 0 1 .738-.345c.302 0 .55.118.743.354.193.236.29.62.29 1.154 0 .5-.096.868-.288 1.1-.192.233-.424.35-.697.35zm4.478.87v-1.235h-1.234V25h1.234zm-4.017 9.105c.6 0 1.08-.142 1.437-.426.357-.284.599-.704.725-1.261l-1.213-.207c-.061.326-.167.555-.316.688a.832.832 0 0 1-.576.2.916.916 0 0 1-.75-.343c-.185-.228-.278-.62-.278-1.173 0-.498.091-.853.274-1.066.183-.212.429-.318.736-.318.232 0 .42.061.565.184.145.123.238.306.28.55l1.216-.22c-.146-.501-.387-.874-.722-1.119-.336-.244-.788-.366-1.356-.366-.695 0-1.245.214-1.653.643-.407.43-.61 1.03-.61 1.8 0 .762.202 1.358.608 1.788.406.431.95.646 1.633.646zM14.633 34v-1.235h-1.235V34h1.235z"/></svg>',gz='<svg viewBox="0 0 44 44" xmlns="http://www.w3.org/2000/svg"><path d="M35 29a1 1 0 0 1 1 1v1a1 1 0 0 1-1 1H18a1 1 0 0 1-1-1v-1a1 1 0 0 1 1-1h17zm0-9a1 1 0 0 1 1 1v1a1 1 0 0 1-1 1H18a1 1 0 0 1-1-1v-1a1 1 0 0 1 1-1h17zm0-9a1 1 0 0 1 1 1v1a1 1 0 0 1-1 1H18a1 1 0 0 1-1-1v-1a1 1 0 0 1 1-1h17z" fill-opacity=".163"/><path d="M11.88 8.7V7.558h-1.234V8.7h1.234zm0 5.3V9.333h-1.234V14h1.234zm2.5 0v-1.235h-1.234V14h1.235zm-4.75 4.7v-1.142H8.395V18.7H9.63zm0 5.3v-4.667H8.395V24H9.63zm2.5-5.3v-1.142h-1.234V18.7h1.235zm0 5.3v-4.667h-1.234V24h1.235zm2.501 0v-1.235h-1.235V24h1.235zM7.38 28.7v-1.142H6.145V28.7H7.38zm0 5.3v-4.667H6.145V34H7.38zm2.5-5.3v-1.142H8.646V28.7H9.88zm0 5.3v-4.667H8.646V34H9.88zm2.5-5.3v-1.142h-1.234V28.7h1.235zm0 5.3v-4.667h-1.234V34h1.235zm2.501 0v-1.235h-1.235V34h1.235z"/></svg>',pz='<svg viewBox="0 0 44 44" xmlns="http://www.w3.org/2000/svg"><path d="M35 29a1 1 0 0 1 1 1v1a1 1 0 0 1-1 1H18a1 1 0 0 1-1-1v-1a1 1 0 0 1 1-1h17zm0-9a1 1 0 0 1 1 1v1a1 1 0 0 1-1 1H18a1 1 0 0 1-1-1v-1a1 1 0 0 1 1-1h17zm0-9a1 1 0 0 1 1 1v1a1 1 0 0 1-1 1H18a1 1 0 0 1-1-1v-1a1 1 0 0 1 1-1h17z" fill-opacity=".163"/><path d="M14 27v6H8v-6h6zm0-9v6H8v-6h6zm0-9v6H8V9h6z"/></svg>',wz='<svg viewBox="0 0 44 44" xmlns="http://www.w3.org/2000/svg"><path d="M35 29a1 1 0 0 1 1 1v1a1 1 0 0 1-1 1H18a1 1 0 0 1-1-1v-1a1 1 0 0 1 1-1h17zm0-9a1 1 0 0 1 1 1v1a1 1 0 0 1-1 1H18a1 1 0 0 1-1-1v-1a1 1 0 0 1 1-1h17zm0-9a1 1 0 0 1 1 1v1a1 1 0 0 1-1 1H18a1 1 0 0 1-1-1v-1a1 1 0 0 1 1-1h17z" fill-opacity=".163"/><path d="m7.88 15 .532-1.463h2.575L11.549 15h1.415l-2.58-6.442H9.01L6.5 15h1.38zm2.69-2.549H8.811l.87-2.39.887 2.39zM14.88 15v-1.235h-1.234V15h1.234zM9.352 25c.83-.006 1.352-.02 1.569-.044.346-.038.636-.14.872-.305.236-.166.422-.387.558-.664.137-.277.205-.562.205-.855 0-.372-.106-.695-.317-.97-.21-.276-.512-.471-.905-.585a1.51 1.51 0 0 0 .661-.567 1.5 1.5 0 0 0 .244-.83c0-.28-.066-.53-.197-.754a1.654 1.654 0 0 0-.495-.539 1.676 1.676 0 0 0-.672-.266c-.25-.042-.63-.063-1.14-.063H7.158V25h2.193zm.142-3.88H8.46v-1.49h.747c.612 0 .983.007 1.112.022.217.026.38.102.49.226.11.125.165.287.165.486a.68.68 0 0 1-.192.503.86.86 0 0 1-.525.23 11.47 11.47 0 0 1-.944.023h.18zm.17 2.795H8.46v-1.723h1.05c.592 0 .977.03 1.154.092.177.062.313.16.406.295a.84.84 0 0 1 .14.492c0 .228-.06.41-.181.547a.806.806 0 0 1-.473.257c-.126.026-.423.04-.892.04zM14.88 25v-1.235h-1.234V25h1.234zm-5.018 9.11c.691 0 1.262-.17 1.711-.512.45-.341.772-.864.965-1.567l-1.261-.4c-.109.472-.287.818-.536 1.037-.25.22-.547.33-.892.33-.47 0-.85-.173-1.143-.519-.293-.345-.44-.925-.44-1.74 0-.767.15-1.322.447-1.665.297-.343.684-.514 1.162-.514.346 0 .64.096.881.29.242.193.4.457.477.79l1.288-.307c-.147-.516-.367-.911-.66-1.187-.492-.465-1.132-.698-1.92-.698-.902 0-1.63.296-2.184.89-.554.593-.83 1.426-.83 2.498 0 1.014.275 1.813.825 2.397.551.585 1.254.877 2.11.877zM14.88 34v-1.235h-1.234V34h1.234z"/></svg>',xz='<svg viewBox="0 0 44 44" xmlns="http://www.w3.org/2000/svg"><path d="M35 29a1 1 0 0 1 1 1v1a1 1 0 0 1-1 1H18a1 1 0 0 1-1-1v-1a1 1 0 0 1 1-1h17zm0-9a1 1 0 0 1 1 1v1a1 1 0 0 1-1 1H18a1 1 0 0 1-1-1v-1a1 1 0 0 1 1-1h17zm0-9a1 1 0 0 1 1 1v1a1 1 0 0 1-1 1H18a1 1 0 0 1-1-1v-1a1 1 0 0 1 1-1h17z" fill-opacity=".163"/><path d="M11.916 15V8.558h-1.301V15h1.3zm2.465 0v-1.235h-1.235V15h1.235zM9.665 25v-6.442h-1.3V25h1.3zm2.5 0v-6.442h-1.3V25h1.3zm2.466 0v-1.235h-1.235V25h1.235zm-7.216 9v-6.442h-1.3V34h1.3zm2.5 0v-6.442h-1.3V34h1.3zm2.501 0v-6.442h-1.3V34h1.3zm2.465 0v-1.235h-1.235V34h1.235z"/></svg>',bz='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M12.68 13.74h-.001l4.209 4.208a1 1 0 1 0 1.414-1.414l-4.267-4.268a6 6 0 1 0-1.355 1.474ZM13 9a4 4 0 1 1-8 0 4 4 0 0 1 8 0Z"/></svg>',$C='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M15.346 9.422a.151.151 0 0 1 .284 0l.548 1.484a.152.152 0 0 0 .09.089l1.483.549a.151.151 0 0 1 0 .284l-1.483.548a.151.151 0 0 0-.09.09l-.548 1.483a.152.152 0 0 1-.142.1.151.151 0 0 1-.142-.1l-.549-1.483a.15.15 0 0 0-.09-.09l-1.483-.548a.15.15 0 0 1 0-.284l1.484-.549a.152.152 0 0 0 .089-.09l.549-1.483Z"/><path d="M16.306 1.742a.151.151 0 0 1 .284 0l.549 1.483a.15.15 0 0 0 .089.09l1.483.548a.151.151 0 0 1 .072.229.151.151 0 0 1-.072.055l-1.483.549a.15.15 0 0 0-.09.09l-.548 1.482a.151.151 0 0 1-.284 0l-.549-1.483a.15.15 0 0 0-.09-.09l-1.483-.548a.151.151 0 0 1 0-.284l1.484-.549a.152.152 0 0 0 .09-.089l.548-1.483Z"/><path d="M7.665 1.742a.151.151 0 0 1 .284 0l.549 1.483a.151.151 0 0 0 .09.09l1.482.548a.151.151 0 0 1 .072.229.151.151 0 0 1-.072.055l-1.483.549a.151.151 0 0 0-.09.09L7.95 6.267a.151.151 0 0 1-.284 0l-.549-1.483a.151.151 0 0 0-.089-.09l-1.483-.548a.151.151 0 0 1 0-.284l1.483-.549a.151.151 0 0 0 .09-.089l.548-1.483-.001.001Z"/><path d="M14.72 7.946a.848.848 0 0 0 .25-.591.824.824 0 0 0-.241-.588l-1.943-1.938a.812.812 0 0 0-.588-.241.838.838 0 0 0-.591.25l-1.545 1.539 3.115 3.115 1.542-1.546h.001Z"/><path clip-rule="evenodd" d="M1.19 15.636a.96.96 0 0 1 .281-.679l7.835-7.834 3.121 3.12-7.834 7.835a.959.959 0 0 1-1.358 0l-1.764-1.764a.96.96 0 0 1-.28-.678Zm9.22-5.391-1.121-1.12-6.479 6.478 1.121 1.121 6.479-6.479Z"/></svg>',KA='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M8.537 14.813a.888.888 0 1 1-1.254-1.255L10.84 10 7.283 6.442a.888.888 0 1 1 1.254-1.255L12.74 9.39a.888.888 0 0 1-.16 1.382l-4.043 4.042z"/></svg>',ty='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M7 5.75c0 .414.336.75.75.75h9.5a.75.75 0 1 0 0-1.5h-9.5a.75.75 0 0 0-.75.75zM3.5 3v5H2V3.7H1v-1h2.5V3zM.343 17.857l2.59-3.257H2.92a.6.6 0 1 0-1.04 0H.302a2 2 0 1 1 3.995 0h-.001c-.048.405-.16.734-.333.988-.175.254-.59.692-1.244 1.312H4.3v1h-4l.043-.043zM7 14.75a.75.75 0 0 1 .75-.75h9.5a.75.75 0 1 1 0 1.5h-9.5a.75.75 0 0 1-.75-.75z"/></svg>',Og='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path opacity=".5" d="M2 3h16v1.5H2zm0 12h16v1.5H2z"/><path d="M15.003 7v5.5a1 1 0 0 1-1 1H5.996a1 1 0 0 1-1-1V7a1 1 0 0 1 1-1h8.007a1 1 0 0 1 1 1zm-1.506.5H6.5V12h6.997V7.5z"/></svg>',Oz='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path opacity=".5" d="M2 3h16v1.5H2zm0 12h16v1.5H2z"/><path d="M18 7v5.5a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V7a1 1 0 0 1 1-1h14a1 1 0 0 1 1 1zm-1.505.5H3.504V12h12.991V7.5z"/></svg>',iy='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path opacity=".5" d="M2 3h16v1.5H2zm11.5 9H18v1.5h-4.5zm0-3H18v1.5h-4.5zm0-3H18v1.5h-4.5zM2 15h16v1.5H2z"/><path d="M12.003 7v5.5a1 1 0 0 1-1 1H2.996a1 1 0 0 1-1-1V7a1 1 0 0 1 1-1h8.007a1 1 0 0 1 1 1zm-1.506.5H3.5V12h6.997V7.5z"/></svg>',yg='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path opacity=".5" d="M2 3h16v1.5H2zm0 12h16v1.5H2zm0-9h5v1.5H2zm0 3h5v1.5H2zm0 3h5v1.5H2z"/><path d="M18.003 7v5.5a1 1 0 0 1-1 1H8.996a1 1 0 0 1-1-1V7a1 1 0 0 1 1-1h8.007a1 1 0 0 1 1 1zm-1.506.5H9.5V12h6.997V7.5z"/></svg>',JA='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path opacity=".5" d="M2 3h16v1.5H2zm11.5 9H18v1.5h-4.5zM2 15h16v1.5H2z"/><path d="M12.003 7v5.5a1 1 0 0 1-1 1H2.996a1 1 0 0 1-1-1V7a1 1 0 0 1 1-1h8.007a1 1 0 0 1 1 1zm-1.506.5H3.5V12h6.997V7.5z"/></svg>',eI='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path opacity=".5" d="M2 3h16v1.5H2zm0 12h16v1.5H2z"/><path d="M12.003 7v5.5a1 1 0 0 1-1 1H2.996a1 1 0 0 1-1-1V7a1 1 0 0 1 1-1h8.007a1 1 0 0 1 1 1zm-1.506.5H3.5V12h6.997V7.5z"/></svg>',tI='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path opacity=".5" d="M2 3h16v1.5H2zm0 12h16v1.5H2z"/><path d="M18.003 7v5.5a1 1 0 0 1-1 1H8.996a1 1 0 0 1-1-1V7a1 1 0 0 1 1-1h8.007a1 1 0 0 1 1 1zm-1.506.5H9.5V12h6.997V7.5z"/></svg>',yz='<svg xmlns="http://www.w3.org/2000/svg" xmlns:v="https://vecta.io/nano" viewBox="0 0 20 20"><path d="M.95 1.43a.95.95 0 0 0-.95.95v3.1a.95.95 0 0 0 .95.95h.75v6.3H.95a.95.95 0 0 0-.95.95v3.1a.95.95 0 0 0 .95.95h3.1a.95.95 0 0 0 .95-.95v-.65h1.932l1.539-1.5H5v-.95a.95.95 0 0 0-.95-.95H3.2v-6.3h.85A.95.95 0 0 0 5 5.48v-.55h10v.55a.95.95 0 0 0 .95.95h3.1a.95.95 0 0 0 .95-.95v-3.1a.95.95 0 0 0-.95-.95h-3.1a.95.95 0 0 0-.95.95v1.05H5V2.38a.95.95 0 0 0-.95-.95H.95zm.55 3.5v-2h2v2h-2zm0 9.3v2h2v-2h-2zm15-11.3v2h2v-2h-2z"/><path d="M8.139 20.004v-2.388l7.045-7.048 2.391 2.391-7.046 7.046h-2.39zm11.421-9.101a.64.64 0 0 1-.138.206l-1.165 1.168-2.391-2.391 1.167-1.163a.63.63 0 0 1 .206-.138.635.635 0 0 1 .243-.049.63.63 0 0 1 .449.187l1.491 1.488c.059.059.108.129.138.206s.049.16.049.243a.6.6 0 0 1-.049.243z"/></svg>',vz='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20"><path d="M2.5 17v1h-1v-1h1zm2 0v1h-1v-1h1zm2 0v1h-1v-1h1zm2 0v1h-1v-1h1zm2 0v1h-1v-1h1zm2 0v1h-1v-1h1zm2 0v1h-1v-1h1zm2 0v1h-1v-1h1zm2 0v1h-1v-1h1zM1 15.5v1H0v-1h1zm19 0v1h-1v-1h1zm-19-2v1H0v-1h1zm19 0v1h-1v-1h1zm-19-2v1H0v-1h1zm19 0v1h-1v-1h1zm-19-2v1H0v-1h1zm19 0v1h-1v-1h1zm-19-2v1H0v-1h1zm19 0v1h-1v-1h1zm-19-2v1H0v-1h1zm19 0v1h-1v-1h1zm0-2v1h-1v-1h1zm-19 0v1H0v-1h1zM14.5 2v1h-1V2h1zm2 0v1h-1V2h1zm2 0v1h-1V2h1zm-8 0v1h-1V2h1zm-2 0v1h-1V2h1zm-2 0v1h-1V2h1zm-2 0v1h-1V2h1zm8 0v1h-1V2h1zm-10 0v1h-1V2h1z"/><path d="M18.095 2H1.905C.853 2 0 2.895 0 4v12c0 1.105.853 2 1.905 2h16.19C19.147 18 20 17.105 20 16V4c0-1.105-.853-2-1.905-2zm0 1.5c.263 0 .476.224.476.5v12c0 .276-.213.5-.476.5H1.905a.489.489 0 0 1-.476-.5V4c0-.276.213-.5.476-.5h16.19z"/></svg>',_z='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M2.5 16.5v1h-1v-1h1Zm2 0v1h-1v-1h1Zm2 0v1h-1v-1h1Zm2 0v1h-1v-1h1Zm2 0v1h-1v-1h1Zm2 0v1h-1v-1h1Zm2 0v1h-1v-1h1Zm2 0v1h-1v-1h1Zm2 0v1h-1v-1h1ZM1 15v1H0v-1h1Zm19 0v1h-1v-1h1ZM1 13v1H0v-1h1Zm19 0v1h-1v-1h1ZM1 11v1H0v-1h1Zm19 0v1h-1v-1h1ZM1 9v1H0V9h1Zm19 0v1h-1V9h1ZM1 7v1H0V7h1Zm19 0v1h-1V7h1ZM1 5v1H0V5h1Zm19 0v1h-1V5h1Zm0-2v1h-1V3h1ZM1 3v1H0V3h1Zm13.5-1.5v1h-1v-1h1Zm2 0v1h-1v-1h1Zm2 0v1h-1v-1h1Zm-8 0v1h-1v-1h1Zm-2 0v1h-1v-1h1Zm-2 0v1h-1v-1h1Zm-2 0v1h-1v-1h1Zm8 0v1h-1v-1h1Zm-10 0v1h-1v-1h1Z"/><path d="M13 5.5H2a2 2 0 0 0-2 2v8a2 2 0 0 0 2 2h11a2 2 0 0 0 2-2v-8a2 2 0 0 0-2-2ZM13 7a.5.5 0 0 1 .5.5v8a.5.5 0 0 1-.5.5H2a.5.5 0 0 1-.5-.5v-8A.5.5 0 0 1 2 7h11Z"/></svg>',kz='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M2.5 16.5v1h-1v-1h1Zm2 0v1h-1v-1h1Zm2 0v1h-1v-1h1Zm2 0v1h-1v-1h1Zm2 0v1h-1v-1h1Zm2 0v1h-1v-1h1Zm2 0v1h-1v-1h1Zm2 0v1h-1v-1h1Zm2 0v1h-1v-1h1ZM1 15v1H0v-1h1Zm19 0v1h-1v-1h1ZM1 13v1H0v-1h1Zm19 0v1h-1v-1h1ZM1 11v1H0v-1h1Zm19 0v1h-1v-1h1ZM1 9v1H0V9h1Zm19 0v1h-1V9h1ZM1 7v1H0V7h1Zm19 0v1h-1V7h1ZM1 5v1H0V5h1Zm19 0v1h-1V5h1Zm0-2v1h-1V3h1ZM1 3v1H0V3h1Zm13.5-1.5v1h-1v-1h1Zm2 0v1h-1v-1h1Zm2 0v1h-1v-1h1Zm-8 0v1h-1v-1h1Zm-2 0v1h-1v-1h1Zm-2 0v1h-1v-1h1Zm-2 0v1h-1v-1h1Zm8 0v1h-1v-1h1Zm-10 0v1h-1v-1h1Z"/><path d="M10 7.5H2a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2h8a2 2 0 0 0 2-2v-6a2 2 0 0 0-2-2ZM10 9a.5.5 0 0 1 .5.5v6a.5.5 0 0 1-.5.5H2a.5.5 0 0 1-.5-.5v-6A.5.5 0 0 1 2 9h8Z"/></svg>',Sz='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M2.5 16.5v1h-1v-1h1Zm2 0v1h-1v-1h1Zm2 0v1h-1v-1h1Zm2 0v1h-1v-1h1Zm2 0v1h-1v-1h1Zm2 0v1h-1v-1h1Zm2 0v1h-1v-1h1Zm2 0v1h-1v-1h1Zm2 0v1h-1v-1h1ZM1 15v1H0v-1h1Zm19 0v1h-1v-1h1ZM1 13v1H0v-1h1Zm19 0v1h-1v-1h1ZM1 11v1H0v-1h1Zm19 0v1h-1v-1h1ZM1 9v1H0V9h1Zm19 0v1h-1V9h1ZM1 7v1H0V7h1Zm19 0v1h-1V7h1ZM1 5v1H0V5h1Zm19 0v1h-1V5h1Zm0-2v1h-1V3h1ZM1 3v1H0V3h1Zm13.5-1.5v1h-1v-1h1Zm2 0v1h-1v-1h1Zm2 0v1h-1v-1h1Zm-8 0v1h-1v-1h1Zm-2 0v1h-1v-1h1Zm-2 0v1h-1v-1h1Zm-2 0v1h-1v-1h1Zm8 0v1h-1v-1h1Zm-10 0v1h-1v-1h1Z"/><path d="M7 9.5H2a2 2 0 0 0-2 2v4a2 2 0 0 0 2 2h5a2 2 0 0 0 2-2v-4a2 2 0 0 0-2-2ZM7 11a.5.5 0 0 1 .5.5v4a.5.5 0 0 1-.5.5H2a.5.5 0 0 1-.5-.5v-4A.5.5 0 0 1 2 11h5Z"/></svg>',Cz='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M10.5 5.5H7v5h3.5a2.5 2.5 0 1 0 0-5zM5 3h6.5v.025a5 5 0 0 1 0 9.95V13H7v4a1 1 0 0 1-1 1H5a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1z"/></svg>',Fb='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="m7.3 17.37-.061.088a1.518 1.518 0 0 1-.934.535l-4.178.663-.806-4.153a1.495 1.495 0 0 1 .187-1.058l.056-.086L8.77 2.639c.958-1.351 2.803-1.076 4.296-.03 1.497 1.047 2.387 2.693 1.433 4.055L7.3 17.37zM9.14 4.728l-5.545 8.346 3.277 2.294 5.544-8.346L9.14 4.728zM6.07 16.512l-3.276-2.295.53 2.73 2.746-.435zM9.994 3.506 13.271 5.8c.316-.452-.16-1.333-1.065-1.966-.905-.634-1.895-.78-2.212-.328zM8 18.5 9.375 17H19v1.5H8z"/></svg>',Pz='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M6.999 2H15a1 1 0 0 1 0 2h-1.004v13a1 1 0 1 1-2 0V4H8.999v13a1 1 0 1 1-2 0v-7A4 4 0 0 1 3 6a4 4 0 0 1 3.999-4z"/></svg>',Tz='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M10 2a1 1 0 0 0-1 1v6H3a1 1 0 1 0 0 2h6v6a1 1 0 1 0 2 0v-6h6a1 1 0 1 0 0-2h-6V3a1 1 0 0 0-1-1Z"/></svg>',zl='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M11.463 5.187a.888.888 0 1 1 1.254 1.255L9.16 10l3.557 3.557a.888.888 0 1 1-1.254 1.255L7.26 10.61a.888.888 0 0 1 .16-1.382l4.043-4.042z"/></svg>',Ez=`<svg xmlns="http://www.w3.org/2000/svg" width="53" height="10" viewBox="0 0 53 10"><path fill="#1C2331" d="M31.724 1.492a15.139 15.139 0 0 0 .045 1.16 2.434 2.434 0 0 0-.687-.34 3.68 3.68 0 0 0-1.103-.166 2.332 2.332 0 0 0-1.14.255 1.549 1.549 0 0 0-.686.87c-.15.41-.225.98-.225 1.712 0 .939.148 1.659.444 2.161.297.503.792.754 1.487.754.452.015.9-.094 1.294-.316.296-.174.557-.4.771-.669l.14.852h1.282V.007h-1.623v1.485ZM31 6.496a1.77 1.77 0 0 1-.494.061.964.964 0 0 1-.521-.127.758.758 0 0 1-.296-.466 3.984 3.984 0 0 1-.093-.992 4.208 4.208 0 0 1 .098-1.052.753.753 0 0 1 .307-.477 1.08 1.08 0 0 1 .55-.122c.233-.004.466.026.69.089l.483.144v2.553c-.11.076-.213.143-.307.2a1.73 1.73 0 0 1-.417.189ZM35.68 0l-.702.004c-.322.002-.482.168-.48.497l.004.581c.002.33.164.493.486.49l.702-.004c.322-.002.481-.167.48-.496L36.165.49c-.002-.33-.164-.493-.486-.491ZM36.145 2.313l-1.612.01.034 5.482 1.613-.01-.035-5.482ZM39.623.79 37.989.8 38 2.306l-.946.056.006 1.009.949-.006.024 2.983c.003.476.143.844.419 1.106.275.26.658.39 1.148.387.132 0 .293-.01.483-.03.19-.02.38-.046.57-.08.163-.028.324-.068.482-.119l-.183-1.095-.702.004a.664.664 0 0 1-.456-.123.553.553 0 0 1-.14-.422l-.016-2.621 1.513-.01-.006-1.064-1.514.01-.01-1.503ZM46.226 2.388c-.41-.184-.956-.274-1.636-.27-.673.004-1.215.101-1.627.29-.402.179-.72.505-.888.91-.18.419-.268.979-.264 1.68.004.688.1 1.24.285 1.655.172.404.495.724.9.894.414.18.957.268 1.63.264.68-.004 1.224-.099 1.632-.284.4-.176.714-.501.878-.905.176-.418.263-.971.258-1.658-.004-.702-.097-1.261-.28-1.677a1.696 1.696 0 0 0-.888-.9Zm-.613 3.607a.77.77 0 0 1-.337.501 1.649 1.649 0 0 1-1.317.009.776.776 0 0 1-.343-.497 4.066 4.066 0 0 1-.105-1.02 4.136 4.136 0 0 1 .092-1.03.786.786 0 0 1 .337-.507 1.59 1.59 0 0 1 1.316-.008.79.79 0 0 1 .344.502c.078.337.113.683.105 1.03.012.343-.019.685-.092 1.02ZM52.114 2.07a2.67 2.67 0 0 0-1.128.278c-.39.191-.752.437-1.072.73l-.157-.846-1.273.008.036 5.572 1.623-.01-.024-3.78c.35-.124.646-.22.887-.286.26-.075.53-.114.8-.118l.45-.003.144-1.546-.286.001ZM22.083 7.426l-1.576-2.532a2.137 2.137 0 0 0-.172-.253 1.95 1.95 0 0 0-.304-.29.138.138 0 0 1 .042-.04 1.7 1.7 0 0 0 .328-.374l1.75-2.71c.01-.015.025-.028.024-.048-.01-.01-.021-.007-.031-.007L20.49 1.17a.078.078 0 0 0-.075.045l-.868 1.384c-.23.366-.46.732-.688 1.099a.108.108 0 0 1-.112.06c-.098-.005-.196-.001-.294-.002-.018 0-.038.006-.055-.007.002-.02.002-.039.005-.058a4.6 4.6 0 0 0 .046-.701V1.203c0-.02-.009-.032-.03-.03h-.033L16.93 1.17c-.084 0-.073-.01-.073.076v6.491c-.001.018.006.028.025.027h1.494c.083 0 .072.007.072-.071v-2.19c0-.055-.003-.11-.004-.166a3.366 3.366 0 0 0-.05-.417h.06c.104 0 .209.002.313-.002a.082.082 0 0 1 .084.05c.535.913 1.07 1.824 1.607 2.736a.104.104 0 0 0 .103.062c.554-.003 1.107-.002 1.66-.002l.069-.003-.019-.032-.188-.304ZM27.112 6.555c-.005-.08-.004-.08-.082-.08h-2.414c-.053 0-.106-.003-.159-.011a.279.279 0 0 1-.246-.209.558.558 0 0 1-.022-.15c0-.382 0-.762-.002-1.143 0-.032.007-.049.042-.044h2.504c.029.003.037-.012.034-.038V3.814c0-.089.013-.078-.076-.078h-2.44c-.07 0-.062.003-.062-.06v-.837c0-.047.004-.093.013-.14a.283.283 0 0 1 .241-.246.717.717 0 0 1 .146-.011h2.484c.024.002.035-.009.036-.033l.003-.038.03-.496c.01-.183.024-.365.034-.548.005-.085.003-.087-.082-.094-.218-.018-.437-.038-.655-.05a17.845 17.845 0 0 0-.657-.026 72.994 72.994 0 0 0-1.756-.016 1.7 1.7 0 0 0-.471.064 1.286 1.286 0 0 0-.817.655c-.099.196-.149.413-.145.633v3.875c0 .072.003.144.011.216a1.27 1.27 0 0 0 .711 1.029c.228.113.48.167.734.158.757-.005 1.515.002 2.272-.042.274-.016.548-.034.82-.053.03-.002.043-.008.04-.041-.008-.104-.012-.208-.019-.312a69.964 69.964 0 0 1-.05-.768ZM16.14 7.415l-.127-1.075c-.004-.03-.014-.04-.044-.037a13.125 13.125 0 0 1-.998.073c-.336.01-.672.02-1.008.016-.116-.001-.233-.014-.347-.039a.746.746 0 0 1-.45-.262c-.075-.1-.132-.211-.167-.33a3.324 3.324 0 0 1-.126-.773 9.113 9.113 0 0 1-.015-.749c0-.285.022-.57.065-.852.023-.158.066-.312.127-.46a.728.728 0 0 1 .518-.443 1.64 1.64 0 0 1 .397-.048c.628-.001 1.255.003 1.882.05.022.001.033-.006.036-.026l.003-.031.06-.55c.019-.177.036-.355.057-.532.004-.034-.005-.046-.04-.056a5.595 5.595 0 0 0-1.213-.21 10.783 10.783 0 0 0-.708-.02c-.24-.003-.48.01-.719.041a3.477 3.477 0 0 0-.625.14 1.912 1.912 0 0 0-.807.497c-.185.2-.33.433-.424.688a4.311 4.311 0 0 0-.24 1.096c-.031.286-.045.572-.042.86-.006.43.024.86.091 1.286.04.25.104.497.193.734.098.279.26.53.473.734.214.205.473.358.756.446.344.11.702.17 1.063.177a8.505 8.505 0 0 0 1.578-.083 6.11 6.11 0 0 0 .766-.18c.03-.008.047-.023.037-.057a.157.157 0 0 1-.003-.025Z"/><path fill="#AFE229" d="M6.016 6.69a1.592 1.592 0 0 0-.614.21c-.23.132-.422.32-.56.546-.044.072-.287.539-.287.539l-.836 1.528.009.006c.038.025.08.046.123.063.127.046.26.07.395.073.505.023 1.011-.007 1.517-.003.29.009.58.002.869-.022a.886.886 0 0 0 .395-.116.962.962 0 0 0 .312-.286c.056-.083.114-.163.164-.249.24-.408.48-.816.718-1.226.075-.128.148-.257.222-.386l.112-.192a1.07 1.07 0 0 0 .153-.518l-1.304.023s-1.258-.005-1.388.01Z"/><path fill="#771BFF" d="m2.848 9.044.76-1.39.184-.352c-.124-.067-.245-.14-.367-.21-.346-.204-.706-.384-1.045-.6a.984.984 0 0 1-.244-.207c-.108-.134-.136-.294-.144-.46-.021-.409-.002-.818-.009-1.227-.003-.195 0-.39.003-.585.004-.322.153-.553.427-.713l.833-.488c.22-.13.44-.257.662-.385.05-.029.105-.052.158-.077.272-.128.519-.047.76.085l.044.028c.123.06.242.125.358.196.318.178.635.357.952.537.095.056.187.117.275.184.194.144.254.35.266.578.016.284.007.569.006.853-.001.28.004.558 0 .838.592-.003 1.259 0 1.259 0l.723-.013c-.003-.292-.007-.584-.007-.876 0-.524.015-1.048-.016-1.571-.024-.42-.135-.8-.492-1.067a5.02 5.02 0 0 0-.506-.339A400.52 400.52 0 0 0 5.94.787C5.722.664 5.513.524 5.282.423 5.255.406 5.228.388 5.2.373 4.758.126 4.305-.026 3.807.21c-.097.046-.197.087-.29.14A699.896 699.896 0 0 0 .783 1.948c-.501.294-.773.717-.778 1.31-.004.36-.009.718-.001 1.077.016.754-.017 1.508.024 2.261.016.304.07.6.269.848.127.15.279.28.448.382.622.4 1.283.734 1.92 1.11l.183.109Z"/></svg>
`,DC='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="m14.958 9.367-2.189 1.837a.75.75 0 0 0 .965 1.149l3.788-3.18a.747.747 0 0 0 .21-.284.75.75 0 0 0-.17-.945L13.77 4.762a.75.75 0 1 0-.964 1.15l2.331 1.955H6.22A.75.75 0 0 0 6 7.9a4 4 0 1 0 1.477 7.718l-.344-1.489A2.5 2.5 0 1 1 6.039 9.4l-.008-.032h8.927z"/></svg>',Az='<svg viewBox="0 0 10 8" xmlns="http://www.w3.org/2000/svg"><path d="M9.055.263v3.972h-6.77M1 4.216l2-2.038m-2 2 2 2.038"/></svg>',QC='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M9.61 2.66a1.406 1.406 0 1 0-1.407 0v.891H3.28a2.11 2.11 0 0 0-2.11 2.11v10.312a2.11 2.11 0 0 0 2.11 2.109h5.684l-.054-1.157.18-.25H3.28a.703.703 0 0 1-.703-.702V5.66c0-.389.315-.704.703-.704h11.25c.388 0 .703.315.703.704v2.484l.358-.497a2.492 2.492 0 0 1 1.048-.84V5.66a2.11 2.11 0 0 0-2.11-2.11H9.61v-.89Z"/><path d="M5.625 10.817c.518 0 .937-.63.937-1.407 0-.776-.42-1.406-.937-1.406-.518 0-.938.63-.938 1.406 0 .777.42 1.407.938 1.407Z"/><path d="M13.125 9.41c0 .777-.42 1.407-.938 1.407s-.937-.63-.937-1.407c0-.776.42-1.406.937-1.406.518 0 .938.63.938 1.406Z"/><path d="M.937 8.004A.937.937 0 0 0 0 8.942v1.875c0 .517.42.937.937.937v-3.75Z"/><path d="M6.128 12.51a.782.782 0 0 1 1.085.216c.272.408.907.707 1.693.707s1.421-.3 1.693-.707a.782.782 0 0 1 1.302.868c-.666 1-1.906 1.403-2.995 1.403-1.089 0-2.329-.404-2.995-1.403a.782.782 0 0 1 .217-1.085Z"/><path d="m16.987 8.91-.622.864 2.879 2.074.622-.864a.71.71 0 0 0-.161-.99l-1.728-1.245a.71.71 0 0 0-.99.161Z"/><path d="M11.635 19.951a.355.355 0 0 1-.449-.31l-.214-2.38 4.978-6.911 2.88 2.074-4.978 6.91-2.217.617Z"/></svg>',Iz='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20"><path d="M.75 15.5a.75.75 0 0 1 .75.75V18l.008.09A.5.5 0 0 0 2 18.5h1.75a.75.75 0 1 1 0 1.5H1.5l-.144-.007a1.5 1.5 0 0 1-1.35-1.349L0 18.5v-2.25a.75.75 0 0 1 .75-.75zm18.5 0a.75.75 0 0 1 .75.75v2.25l-.007.144a1.5 1.5 0 0 1-1.349 1.35L18.5 20h-2.25a.75.75 0 1 1 0-1.5H18a.5.5 0 0 0 .492-.41L18.5 18v-1.75a.75.75 0 0 1 .75-.75zm-10.45 3c.11 0 .2.09.2.2v1.1a.2.2 0 0 1-.2.2H7.2a.2.2 0 0 1-.2-.2v-1.1c0-.11.09-.2.2-.2h1.6zm4 0c.11 0 .2.09.2.2v1.1a.2.2 0 0 1-.2.2h-1.6a.2.2 0 0 1-.2-.2v-1.1c0-.11.09-.2.2-.2h1.6zm.45-5.5a.75.75 0 1 1 0 1.5h-8.5a.75.75 0 1 1 0-1.5h8.5zM1.3 11c.11 0 .2.09.2.2v1.6a.2.2 0 0 1-.2.2H.2a.2.2 0 0 1-.2-.2v-1.6c0-.11.09-.2.2-.2h1.1zm18.5 0c.11 0 .2.09.2.2v1.6a.2.2 0 0 1-.2.2h-1.1a.2.2 0 0 1-.2-.2v-1.6c0-.11.09-.2.2-.2h1.1zm-4.55-2a.75.75 0 1 1 0 1.5H4.75a.75.75 0 1 1 0-1.5h10.5zM1.3 7c.11 0 .2.09.2.2v1.6a.2.2 0 0 1-.2.2H.2a.2.2 0 0 1-.2-.2V7.2c0-.11.09-.2.2-.2h1.1zm18.5 0c.11 0 .2.09.2.2v1.6a.2.2 0 0 1-.2.2h-1.1a.2.2 0 0 1-.2-.2V7.2c0-.11.09-.2.2-.2h1.1zm-4.55-2a.75.75 0 1 1 0 1.5h-2.5a.75.75 0 1 1 0-1.5h2.5zm-5 0a.75.75 0 1 1 0 1.5h-5.5a.75.75 0 0 1 0-1.5h5.5zm-6.5-5a.75.75 0 0 1 0 1.5H2a.5.5 0 0 0-.492.41L1.5 2v1.75a.75.75 0 0 1-1.5 0V1.5l.007-.144A1.5 1.5 0 0 1 1.356.006L1.5 0h2.25zM18.5 0l.144.007a1.5 1.5 0 0 1 1.35 1.349L20 1.5v2.25a.75.75 0 1 1-1.5 0V2l-.008-.09A.5.5 0 0 0 18 1.5h-1.75a.75.75 0 1 1 0-1.5h2.25zM8.8 0c.11 0 .2.09.2.2v1.1a.2.2 0 0 1-.2.2H7.2a.2.2 0 0 1-.2-.2V.2c0-.11.09-.2.2-.2h1.6zm4 0c.11 0 .2.09.2.2v1.1a.2.2 0 0 1-.2.2h-1.6a.2.2 0 0 1-.2-.2V.2c0-.11.09-.2.2-.2h1.6z"/></svg>',Rz=`<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M3.734 6.375H1.75a.75.75 0 0 1 0-1.5h1.984a2.626 2.626 0 0 1 5.032 0h9.48a.75.75 0 0 1 0 1.5h-9.48a2.626 2.626 0 0 1-5.032 0Zm1.141-.75a1.375 1.375 0 1 1 2.75 0 1.375 1.375 0 0 1-2.75 0ZM16.263 14.625h1.983a.75.75 0 0 1 0 1.5h-1.983a2.626 2.626 0 0 1-5.033 0H1.75a.75.75 0 0 1 0-1.5h9.48a2.626 2.626 0 0 1 5.033 0Zm-1.142.75a1.375 1.375 0 1 1-2.75 0 1.375 1.375 0 0 1 2.75 0Z"/></svg>
`,Vz='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="m6.395 9.196 2.545-.007V6.498a.598.598 0 0 1 .598-.598h.299a.598.598 0 0 1 .598.598v6.877a.598.598 0 0 1-.598.598h-.299a.598.598 0 0 1-.598-.598v-2.691l-2.545.007v2.691a.598.598 0 0 1-.598.598h-.299a.598.598 0 0 1-.598-.598V6.505a.598.598 0 0 1 .598-.598h.299a.598.598 0 0 1 .598.598v2.691Z"/><path d="M15.094 13.417V6.462a.562.562 0 0 0-.562-.562h-.782a1 1 0 0 0-.39.08l-1.017.43a.562.562 0 0 0-.343.517v.197c0 .4.406.67.775.519l.819-.337v6.111c0 .31.251.562.561.562h.377c.31 0 .562-.251.562-.562Z"/><path d="M0 15.417v1.5h1.5v-1.5H0Z"/><path d="M18.5 15.417v1.5H20v-1.5h-1.5Z"/><path d="M18.5 12.333v1.5H20v-1.5h-1.5Z"/><path d="M18.5 9.25v1.5H20v-1.5h-1.5Z"/><path d="M18.5 6.167v1.5H20v-1.5h-1.5Z"/><path d="M0 18.5v.5a1 1 0 0 0 1 1h.5v-1.5H0Z"/><path d="M3.083 18.5V20h1.5v-1.5h-1.5Z"/><path d="M6.167 18.5V20h1.5v-1.5h-1.5Z"/><path d="M9.25 18.5V20h1.5v-1.5h-1.5Z"/><path d="M12.333 18.5V20h1.5v-1.5h-1.5Z"/><path d="M15.417 18.5V20h1.5v-1.5h-1.5Z"/><path d="M18.5 18.5V20h.5a1 1 0 0 0 1-1v-.5h-1.5Z"/><path clip-rule="evenodd" d="M0 1a1 1 0 0 1 1-1h18a1 1 0 0 1 1 1v3.583h-1.5V1.5h-17v12.333H0V1Z"/></svg>',NC='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="m12.5 0 5 4.5v15.003h-16V0h11zM3 1.5v3.25l-1.497 1-.003 8 1.5 1v3.254L7.685 18l-.001 1.504H17.5V8.002L16 9.428l-.004-4.22-4.222-3.692L3 1.5z"/><path d="M4.06 6.64a.75.75 0 0 1 .958 1.15l-.085.07L2.29 9.75l2.646 1.89c.302.216.4.62.232.951l-.058.095a.75.75 0 0 1-.951.232l-.095-.058-3.5-2.5V9.14l3.496-2.5zm4.194 6.22a.75.75 0 0 1-.958-1.149l.085-.07 2.643-1.89-2.646-1.89a.75.75 0 0 1-.232-.952l.058-.095a.75.75 0 0 1 .95-.232l.096.058 3.5 2.5v1.22l-3.496 2.5zm7.644-.836 2.122 2.122-5.825 5.809-2.125-.005.003-2.116zm2.539-1.847 1.414 1.414a.5.5 0 0 1 0 .707l-1.06 1.06-2.122-2.12 1.061-1.061a.5.5 0 0 1 .707 0z"/></svg>',Mz='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M15.875 4.419a.75.75 0 0 0-1.5 0v7.25H6.818l2.33-1.955a.75.75 0 0 0-.963-1.15l-3.792 3.182a.75.75 0 0 0-.17.945c.046.11.118.208.21.284l3.788 3.18a.75.75 0 1 0 .965-1.149l-2.19-1.837h7.629c.69 0 1.25-.56 1.25-1.25v-7.5Z"/></svg>',Lz='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="m11.105 18-.17 1H2.5A1.5 1.5 0 0 1 1 17.5v-15A1.5 1.5 0 0 1 2.5 1h15A1.5 1.5 0 0 1 19 2.5v9.975l-.85-.124-.15-.302V8h-5v4h.021l-.172.351-1.916.28-.151.027c-.287.063-.54.182-.755.341L8 13v5h3.105zM2 12h5V8H2v4zm10-4H8v4h4V8zM2 2v5h5V2H2zm0 16h5v-5H2v5zM13 7h5V2h-5v5zM8 2v5h4V2H8z" opacity=".6"/><path d="m15.5 11.5 1.323 2.68 2.957.43-2.14 2.085.505 2.946L15.5 18.25l-2.645 1.39.505-2.945-2.14-2.086 2.957-.43L15.5 11.5zM13 6a1 1 0 0 1 1 1v3.172a2.047 2.047 0 0 0-.293.443l-.858 1.736-1.916.28-.151.027A1.976 1.976 0 0 0 9.315 14H7a1 1 0 0 1-1-1V7a1 1 0 0 1 1-1h6zm-1 2H8v4h4V8z"/></svg>',Bz='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M2.5 1h15A1.5 1.5 0 0 1 19 2.5v15a1.5 1.5 0 0 1-1.5 1.5h-15A1.5 1.5 0 0 1 1 17.5v-15A1.5 1.5 0 0 1 2.5 1zM2 2v16h16V2H2z" opacity=".6"/><path d="M18 7v1H2V7h16zm0 5v1H2v-1h16z" opacity=".6"/><path d="M14 1v18a1 1 0 0 1-1 1H7a1 1 0 0 1-1-1V1a1 1 0 0 1 1-1h6a1 1 0 0 1 1 1zm-2 1H8v4h4V2zm0 6H8v4h4V8zm0 6H8v4h4v-4z"/></svg>',$z='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M2.5 1h15A1.5 1.5 0 0 1 19 2.5v15a1.5 1.5 0 0 1-1.5 1.5h-15A1.5 1.5 0 0 1 1 17.5v-15A1.5 1.5 0 0 1 2.5 1zM2 2v16h16V2H2z" opacity=".6"/><path d="M7 2h1v16H7V2zm5 0h1v7h-1V2zm6 5v1H2V7h16zM8 12v1H2v-1h6z" opacity=".6"/><path d="M7 7h12a1 1 0 0 1 1 1v11a1 1 0 0 1-1 1H7a1 1 0 0 1-1-1V8a1 1 0 0 1 1-1zm1 2v9h10V9H8z"/></svg>',Dz='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M8 2v5h4V2h1v5h5v1h-5v4h.021l-.172.351-1.916.28-.151.027c-.287.063-.54.182-.755.341L8 13v5H7v-5H2v-1h5V8H2V7h5V2h1zm4 6H8v4h4V8z" opacity=".6"/><path d="m15.5 11.5 1.323 2.68 2.957.43-2.14 2.085.505 2.946L15.5 18.25l-2.645 1.39.505-2.945-2.14-2.086 2.957-.43L15.5 11.5zM17 1a2 2 0 0 1 2 2v9.475l-.85-.124-.857-1.736a2.048 2.048 0 0 0-.292-.44L17 3H3v14h7.808l.402.392L10.935 19H3a2 2 0 0 1-2-2V3a2 2 0 0 1 2-2h14z"/></svg>',Qz='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M2.5 1h15A1.5 1.5 0 0 1 19 2.5v15a1.5 1.5 0 0 1-1.5 1.5h-15A1.5 1.5 0 0 1 1 17.5v-15A1.5 1.5 0 0 1 2.5 1zM2 2v16h16V2H2z" opacity=".6"/><path d="M7 2h1v16H7V2zm5 0h1v16h-1V2z" opacity=".6"/><path d="M1 6h18a1 1 0 0 1 1 1v6a1 1 0 0 1-1 1H1a1 1 0 0 1-1-1V7a1 1 0 0 1 1-1zm1 2v4h4V8H2zm6 0v4h4V8H8zm6 0v4h4V8h-4z"/></svg>',FC='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M3 5.5v3h4v-3H3Zm0 4v3h4v-3H3Zm0 4v3h4v-3H3Zm5 3h4v-3H8v3Zm5 0h4v-3h-4v3Zm4-4v-3h-4v3h4Zm0-4v-3h-4v3h4Zm1.5 8A1.5 1.5 0 0 1 17 18H3a1.5 1.5 0 0 1-1.5-1.5V3c.222-.863 1.068-1.5 2-1.5h13c.932 0 1.778.637 2 1.5v13.5Zm-6.5-4v-3H8v3h4Zm0-4v-3H8v3h4Z"/></svg>',Nz='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M3.035 1C2.446 1 2 1.54 2 2.098V10.5h1.5v-8h13v8H18V2.098C18 1.539 17.48 1 16.9 1H3.035Zm10.453 2.61a1.885 1.885 0 0 0-1.442.736 1.89 1.89 0 0 0 1.011 2.976 1.903 1.903 0 0 0 2.253-1.114 1.887 1.887 0 0 0-1.822-2.598ZM7.463 8.163a.611.611 0 0 0-.432.154L5.071 10.5h5.119L7.88 8.348a.628.628 0 0 0-.417-.185Zm6.236 1.059a.62.62 0 0 0-.42.164L12.07 10.5h2.969l-.92-1.113a.618.618 0 0 0-.42-.165ZM.91 11.5a.91.91 0 0 0-.91.912v6.877c0 .505.405.91.91.91h18.178a.91.91 0 0 0 .912-.91v-6.877a.908.908 0 0 0-.912-.912H.91ZM3.668 13h1.947l2.135 5.7H5.898l-.28-.946H3.601l-.278.945H1.516L3.668 13Zm4.947 0h1.801v4.3h2.7v1.4h-4.5V13h-.001Zm4.5 0h5.4v1.4h-1.798v4.3h-1.701v-4.3h-1.9V13h-.001Zm-8.517 1.457-.614 2.059h1.262l-.648-2.059Z"/></svg>',Fz='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M9.816 11.5 7.038 4.785 4.261 11.5h5.555Zm.62 1.5H3.641l-1.666 4.028H.312l5.789-14h1.875l5.789 14h-1.663L10.436 13Z"/><path d="m12.09 17-.534-1.292.848-1.971.545 1.319L12.113 17h-.023Zm1.142-5.187.545 1.319L15.5 9.13l1.858 4.316h-3.45l.398.965h3.467L18.887 17H20l-3.873-9h-1.254l-1.641 3.813Z"/></svg>',ny='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><circle cx="9.5" cy="4.5" r="1.5"/><circle cx="9.5" cy="10.5" r="1.5"/><circle cx="9.5" cy="16.5" r="1.5"/></svg>',zC='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="m5.042 9.367 2.189 1.837a.75.75 0 0 1-.965 1.149l-3.788-3.18a.747.747 0 0 1-.21-.284.75.75 0 0 1 .17-.945L6.23 4.762a.75.75 0 1 1 .964 1.15L4.863 7.866h8.917A.75.75 0 0 1 14 7.9a4 4 0 1 1-1.477 7.718l.344-1.489a2.5 2.5 0 1 0 1.094-4.73l.008-.032H5.042z"/></svg>',zz='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="m11.077 15 .991-1.416a.75.75 0 1 1 1.229.86l-1.148 1.64a.748.748 0 0 1-.217.206 5.251 5.251 0 0 1-8.503-5.955.741.741 0 0 1 .12-.274l1.147-1.639a.75.75 0 1 1 1.228.86L4.933 10.7l.006.003a3.75 3.75 0 0 0 6.132 4.294l.006.004zm5.494-5.335a.748.748 0 0 1-.12.274l-1.147 1.639a.75.75 0 1 1-1.228-.86l.86-1.23a3.75 3.75 0 0 0-6.144-4.301l-.86 1.229a.75.75 0 0 1-1.229-.86l1.148-1.64a.748.748 0 0 1 .217-.206 5.251 5.251 0 0 1 8.503 5.955zm-4.563-2.532a.75.75 0 0 1 .184 1.045l-3.155 4.505a.75.75 0 1 1-1.229-.86l3.155-4.506a.75.75 0 0 1 1.045-.184zm4.919 10.562-1.414 1.414a.75.75 0 1 1-1.06-1.06l1.414-1.415-1.415-1.414a.75.75 0 0 1 1.061-1.06l1.414 1.414 1.414-1.415a.75.75 0 0 1 1.061 1.061l-1.414 1.414 1.414 1.415a.75.75 0 0 1-1.06 1.06l-1.415-1.414z"/></svg>',rx,WC;function iI(){return WC||(WC=1,rx={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]}),rx}var Wz=iI();const UC=ld(Wz);var ZC={red:0,orange:60,yellow:120,green:180,blue:240,purple:300};function HC(s){var t,e=[],i=1,n;if(typeof s=="string")if(UC[s])e=UC[s].slice(),n="rgb";else if(s==="transparent")i=0,n="rgb",e=[0,0,0];else if(/^#[A-Fa-f0-9]+$/.test(s)){var r=s.slice(1),o=r.length,l=o<=4;i=1,l?(e=[parseInt(r[0]+r[0],16),parseInt(r[1]+r[1],16),parseInt(r[2]+r[2],16)],o===4&&(i=parseInt(r[3]+r[3],16)/255)):(e=[parseInt(r[0]+r[1],16),parseInt(r[2]+r[3],16),parseInt(r[4]+r[5],16)],o===8&&(i=parseInt(r[6]+r[7],16)/255)),e[0]||(e[0]=0),e[1]||(e[1]=0),e[2]||(e[2]=0),n="rgb"}else if(t=/^((?:rgb|hs[lvb]|hwb|cmyk?|xy[zy]|gray|lab|lchu?v?|[ly]uv|lms)a?)\s*\(([^\)]*)\)/.exec(s)){var a=t[1],c=a==="rgb",r=a.replace(/a$/,"");n=r;var o=r==="cmyk"?4:r==="gray"?1:3;e=t[2].trim().split(/\s*[,\/]\s*|\s+/).map(function(m,w){if(/%$/.test(m))return w===o?parseFloat(m)/100:r==="rgb"?parseFloat(m)*255/100:parseFloat(m);if(r[w]==="h"){if(/deg$/.test(m))return parseFloat(m);if(ZC[m]!==void 0)return ZC[m]}return parseFloat(m)}),a===r&&e.push(1),i=c||e[o]===void 0?1:e[o],e=e.slice(0,o)}else s.length>10&&/[0-9](?:\s|\/)/.test(s)&&(e=s.match(/([0-9]+)/g).map(function(h){return parseFloat(h)}),n=s.match(/([a-z])/ig).join("").toLowerCase());else isNaN(s)?Array.isArray(s)||s.length?(e=[s[0],s[1],s[2]],n="rgb",i=s.length===4?s[3]:1):s instanceof Object&&(s.r!=null||s.red!=null||s.R!=null?(n="rgb",e=[s.r||s.red||s.R||0,s.g||s.green||s.G||0,s.b||s.blue||s.B||0]):(n="hsl",e=[s.h||s.hue||s.H||0,s.s||s.saturation||s.S||0,s.l||s.lightness||s.L||s.b||s.brightness]),i=s.a||s.alpha||s.opacity||1,s.opacity!=null&&(i/=100)):(n="rgb",e=[s>>>16,(s&65280)>>>8,s&255]);return{space:n,values:e,alpha:i}}var ox,qC;function nI(){if(qC)return ox;qC=1;const s=iI(),t={};for(const n of Object.keys(s))t[s[n]]=n;const e={rgb:{channels:3,labels:"rgb"},hsl:{channels:3,labels:"hsl"},hsv:{channels:3,labels:"hsv"},hwb:{channels:3,labels:"hwb"},cmyk:{channels:4,labels:"cmyk"},xyz:{channels:3,labels:"xyz"},lab:{channels:3,labels:"lab"},lch:{channels:3,labels:"lch"},hex:{channels:1,labels:["hex"]},keyword:{channels:1,labels:["keyword"]},ansi16:{channels:1,labels:["ansi16"]},ansi256:{channels:1,labels:["ansi256"]},hcg:{channels:3,labels:["h","c","g"]},apple:{channels:3,labels:["r16","g16","b16"]},gray:{channels:1,labels:["gray"]}};ox=e;for(const n of Object.keys(e)){if(!("channels"in e[n]))throw new Error("missing channels property: "+n);if(!("labels"in e[n]))throw new Error("missing channel labels property: "+n);if(e[n].labels.length!==e[n].channels)throw new Error("channel and label counts mismatch: "+n);const{channels:r,labels:o}=e[n];delete e[n].channels,delete e[n].labels,Object.defineProperty(e[n],"channels",{value:r}),Object.defineProperty(e[n],"labels",{value:o})}e.rgb.hsl=function(n){const r=n[0]/255,o=n[1]/255,l=n[2]/255,a=Math.min(r,o,l),c=Math.max(r,o,l),h=c-a;let f,m;c===a?f=0:r===c?f=(o-l)/h:o===c?f=2+(l-r)/h:l===c&&(f=4+(r-o)/h),f=Math.min(f*60,360),f<0&&(f+=360);const w=(a+c)/2;return c===a?m=0:w<=.5?m=h/(c+a):m=h/(2-c-a),[f,m*100,w*100]},e.rgb.hsv=function(n){let r,o,l,a,c;const h=n[0]/255,f=n[1]/255,m=n[2]/255,w=Math.max(h,f,m),O=w-Math.min(h,f,m),_=function(k){return(w-k)/6/O+1/2};return O===0?(a=0,c=0):(c=O/w,r=_(h),o=_(f),l=_(m),h===w?a=l-o:f===w?a=1/3+r-l:m===w&&(a=2/3+o-r),a<0?a+=1:a>1&&(a-=1)),[a*360,c*100,w*100]},e.rgb.hwb=function(n){const r=n[0],o=n[1];let l=n[2];const a=e.rgb.hsl(n)[0],c=1/255*Math.min(r,Math.min(o,l));return l=1-1/255*Math.max(r,Math.max(o,l)),[a,c*100,l*100]},e.rgb.cmyk=function(n){const r=n[0]/255,o=n[1]/255,l=n[2]/255,a=Math.min(1-r,1-o,1-l),c=(1-r-a)/(1-a)||0,h=(1-o-a)/(1-a)||0,f=(1-l-a)/(1-a)||0;return[c*100,h*100,f*100,a*100]};function i(n,r){return(n[0]-r[0])**2+(n[1]-r[1])**2+(n[2]-r[2])**2}return e.rgb.keyword=function(n){const r=t[n];if(r)return r;let o=1/0,l;for(const a of Object.keys(s)){const c=s[a],h=i(n,c);h<o&&(o=h,l=a)}return l},e.keyword.rgb=function(n){return s[n]},e.rgb.xyz=function(n){let r=n[0]/255,o=n[1]/255,l=n[2]/255;r=r>.04045?((r+.055)/1.055)**2.4:r/12.92,o=o>.04045?((o+.055)/1.055)**2.4:o/12.92,l=l>.04045?((l+.055)/1.055)**2.4:l/12.92;const a=r*.4124+o*.3576+l*.1805,c=r*.2126+o*.7152+l*.0722,h=r*.0193+o*.1192+l*.9505;return[a*100,c*100,h*100]},e.rgb.lab=function(n){const r=e.rgb.xyz(n);let o=r[0],l=r[1],a=r[2];o/=95.047,l/=100,a/=108.883,o=o>.008856?o**(1/3):7.787*o+16/116,l=l>.008856?l**(1/3):7.787*l+16/116,a=a>.008856?a**(1/3):7.787*a+16/116;const c=116*l-16,h=500*(o-l),f=200*(l-a);return[c,h,f]},e.hsl.rgb=function(n){const r=n[0]/360,o=n[1]/100,l=n[2]/100;let a,c,h;if(o===0)return h=l*255,[h,h,h];l<.5?a=l*(1+o):a=l+o-l*o;const f=2*l-a,m=[0,0,0];for(let w=0;w<3;w++)c=r+1/3*-(w-1),c<0&&c++,c>1&&c--,6*c<1?h=f+(a-f)*6*c:2*c<1?h=a:3*c<2?h=f+(a-f)*(2/3-c)*6:h=f,m[w]=h*255;return m},e.hsl.hsv=function(n){const r=n[0];let o=n[1]/100,l=n[2]/100,a=o;const c=Math.max(l,.01);l*=2,o*=l<=1?l:2-l,a*=c<=1?c:2-c;const h=(l+o)/2,f=l===0?2*a/(c+a):2*o/(l+o);return[r,f*100,h*100]},e.hsv.rgb=function(n){const r=n[0]/60,o=n[1]/100;let l=n[2]/100;const a=Math.floor(r)%6,c=r-Math.floor(r),h=255*l*(1-o),f=255*l*(1-o*c),m=255*l*(1-o*(1-c));switch(l*=255,a){case 0:return[l,m,h];case 1:return[f,l,h];case 2:return[h,l,m];case 3:return[h,f,l];case 4:return[m,h,l];case 5:return[l,h,f]}},e.hsv.hsl=function(n){const r=n[0],o=n[1]/100,l=n[2]/100,a=Math.max(l,.01);let c,h;h=(2-o)*l;const f=(2-o)*a;return c=o*a,c/=f<=1?f:2-f,c=c||0,h/=2,[r,c*100,h*100]},e.hwb.rgb=function(n){const r=n[0]/360;let o=n[1]/100,l=n[2]/100;const a=o+l;let c;a>1&&(o/=a,l/=a);const h=Math.floor(6*r),f=1-l;c=6*r-h,(h&1)!==0&&(c=1-c);const m=o+c*(f-o);let w,O,_;switch(h){default:case 6:case 0:w=f,O=m,_=o;break;case 1:w=m,O=f,_=o;break;case 2:w=o,O=f,_=m;break;case 3:w=o,O=m,_=f;break;case 4:w=m,O=o,_=f;break;case 5:w=f,O=o,_=m;break}return[w*255,O*255,_*255]},e.cmyk.rgb=function(n){const r=n[0]/100,o=n[1]/100,l=n[2]/100,a=n[3]/100,c=1-Math.min(1,r*(1-a)+a),h=1-Math.min(1,o*(1-a)+a),f=1-Math.min(1,l*(1-a)+a);return[c*255,h*255,f*255]},e.xyz.rgb=function(n){const r=n[0]/100,o=n[1]/100,l=n[2]/100;let a,c,h;return a=r*3.2406+o*-1.5372+l*-.4986,c=r*-.9689+o*1.8758+l*.0415,h=r*.0557+o*-.204+l*1.057,a=a>.0031308?1.055*a**(1/2.4)-.055:a*12.92,c=c>.0031308?1.055*c**(1/2.4)-.055:c*12.92,h=h>.0031308?1.055*h**(1/2.4)-.055:h*12.92,a=Math.min(Math.max(0,a),1),c=Math.min(Math.max(0,c),1),h=Math.min(Math.max(0,h),1),[a*255,c*255,h*255]},e.xyz.lab=function(n){let r=n[0],o=n[1],l=n[2];r/=95.047,o/=100,l/=108.883,r=r>.008856?r**(1/3):7.787*r+16/116,o=o>.008856?o**(1/3):7.787*o+16/116,l=l>.008856?l**(1/3):7.787*l+16/116;const a=116*o-16,c=500*(r-o),h=200*(o-l);return[a,c,h]},e.lab.xyz=function(n){const r=n[0],o=n[1],l=n[2];let a,c,h;c=(r+16)/116,a=o/500+c,h=c-l/200;const f=c**3,m=a**3,w=h**3;return c=f>.008856?f:(c-16/116)/7.787,a=m>.008856?m:(a-16/116)/7.787,h=w>.008856?w:(h-16/116)/7.787,a*=95.047,c*=100,h*=108.883,[a,c,h]},e.lab.lch=function(n){const r=n[0],o=n[1],l=n[2];let a;a=Math.atan2(l,o)*360/2/Math.PI,a<0&&(a+=360);const h=Math.sqrt(o*o+l*l);return[r,h,a]},e.lch.lab=function(n){const r=n[0],o=n[1],a=n[2]/360*2*Math.PI,c=o*Math.cos(a),h=o*Math.sin(a);return[r,c,h]},e.rgb.ansi16=function(n,r=null){const[o,l,a]=n;let c=r===null?e.rgb.hsv(n)[2]:r;if(c=Math.round(c/50),c===0)return 30;let h=30+(Math.round(a/255)<<2|Math.round(l/255)<<1|Math.round(o/255));return c===2&&(h+=60),h},e.hsv.ansi16=function(n){return e.rgb.ansi16(e.hsv.rgb(n),n[2])},e.rgb.ansi256=function(n){const r=n[0],o=n[1],l=n[2];return r===o&&o===l?r<8?16:r>248?231:Math.round((r-8)/247*24)+232:16+36*Math.round(r/255*5)+6*Math.round(o/255*5)+Math.round(l/255*5)},e.ansi16.rgb=function(n){let r=n%10;if(r===0||r===7)return n>50&&(r+=3.5),r=r/10.5*255,[r,r,r];const o=(~~(n>50)+1)*.5,l=(r&1)*o*255,a=(r>>1&1)*o*255,c=(r>>2&1)*o*255;return[l,a,c]},e.ansi256.rgb=function(n){if(n>=232){const c=(n-232)*10+8;return[c,c,c]}n-=16;let r;const o=Math.floor(n/36)/5*255,l=Math.floor((r=n%36)/6)/5*255,a=r%6/5*255;return[o,l,a]},e.rgb.hex=function(n){const o=(((Math.round(n[0])&255)<<16)+((Math.round(n[1])&255)<<8)+(Math.round(n[2])&255)).toString(16).toUpperCase();return"000000".substring(o.length)+o},e.hex.rgb=function(n){const r=n.toString(16).match(/[a-f0-9]{6}|[a-f0-9]{3}/i);if(!r)return[0,0,0];let o=r[0];r[0].length===3&&(o=o.split("").map(f=>f+f).join(""));const l=parseInt(o,16),a=l>>16&255,c=l>>8&255,h=l&255;return[a,c,h]},e.rgb.hcg=function(n){const r=n[0]/255,o=n[1]/255,l=n[2]/255,a=Math.max(Math.max(r,o),l),c=Math.min(Math.min(r,o),l),h=a-c;let f,m;return h<1?f=c/(1-h):f=0,h<=0?m=0:a===r?m=(o-l)/h%6:a===o?m=2+(l-r)/h:m=4+(r-o)/h,m/=6,m%=1,[m*360,h*100,f*100]},e.hsl.hcg=function(n){const r=n[1]/100,o=n[2]/100,l=o<.5?2*r*o:2*r*(1-o);let a=0;return l<1&&(a=(o-.5*l)/(1-l)),[n[0],l*100,a*100]},e.hsv.hcg=function(n){const r=n[1]/100,o=n[2]/100,l=r*o;let a=0;return l<1&&(a=(o-l)/(1-l)),[n[0],l*100,a*100]},e.hcg.rgb=function(n){const r=n[0]/360,o=n[1]/100,l=n[2]/100;if(o===0)return[l*255,l*255,l*255];const a=[0,0,0],c=r%1*6,h=c%1,f=1-h;let m=0;switch(Math.floor(c)){case 0:a[0]=1,a[1]=h,a[2]=0;break;case 1:a[0]=f,a[1]=1,a[2]=0;break;case 2:a[0]=0,a[1]=1,a[2]=h;break;case 3:a[0]=0,a[1]=f,a[2]=1;break;case 4:a[0]=h,a[1]=0,a[2]=1;break;default:a[0]=1,a[1]=0,a[2]=f}return m=(1-o)*l,[(o*a[0]+m)*255,(o*a[1]+m)*255,(o*a[2]+m)*255]},e.hcg.hsv=function(n){const r=n[1]/100,o=n[2]/100,l=r+o*(1-r);let a=0;return l>0&&(a=r/l),[n[0],a*100,l*100]},e.hcg.hsl=function(n){const r=n[1]/100,l=n[2]/100*(1-r)+.5*r;let a=0;return l>0&&l<.5?a=r/(2*l):l>=.5&&l<1&&(a=r/(2*(1-l))),[n[0],a*100,l*100]},e.hcg.hwb=function(n){const r=n[1]/100,o=n[2]/100,l=r+o*(1-r);return[n[0],(l-r)*100,(1-l)*100]},e.hwb.hcg=function(n){const r=n[1]/100,l=1-n[2]/100,a=l-r;let c=0;return a<1&&(c=(l-a)/(1-a)),[n[0],a*100,c*100]},e.apple.rgb=function(n){return[n[0]/65535*255,n[1]/65535*255,n[2]/65535*255]},e.rgb.apple=function(n){return[n[0]/255*65535,n[1]/255*65535,n[2]/255*65535]},e.gray.rgb=function(n){return[n[0]/100*255,n[0]/100*255,n[0]/100*255]},e.gray.hsl=function(n){return[0,0,n[0]]},e.gray.hsv=e.gray.hsl,e.gray.hwb=function(n){return[0,100,n[0]]},e.gray.cmyk=function(n){return[0,0,0,n[0]]},e.gray.lab=function(n){return[n[0],0,0]},e.gray.hex=function(n){const r=Math.round(n[0]/100*255)&255,l=((r<<16)+(r<<8)+r).toString(16).toUpperCase();return"000000".substring(l.length)+l},e.rgb.gray=function(n){return[(n[0]+n[1]+n[2])/3/255*100]},ox}var lx,jC;function Uz(){if(jC)return lx;jC=1;const s=nI();function t(){const r={},o=Object.keys(s);for(let l=o.length,a=0;a<l;a++)r[o[a]]={distance:-1,parent:null};return r}function e(r){const o=t(),l=[r];for(o[r].distance=0;l.length;){const a=l.pop(),c=Object.keys(s[a]);for(let h=c.length,f=0;f<h;f++){const m=c[f],w=o[m];w.distance===-1&&(w.distance=o[a].distance+1,w.parent=a,l.unshift(m))}}return o}function i(r,o){return function(l){return o(r(l))}}function n(r,o){const l=[o[r].parent,r];let a=s[o[r].parent][r],c=o[r].parent;for(;o[c].parent;)l.unshift(o[c].parent),a=i(s[o[c].parent][c],a),c=o[c].parent;return a.conversion=l,a}return lx=function(r){const o=e(r),l={},a=Object.keys(o);for(let c=a.length,h=0;h<c;h++){const f=a[h];o[f].parent!==null&&(l[f]=n(f,o))}return l},lx}var ax,XC;function Zz(){if(XC)return ax;XC=1;const s=nI(),t=Uz(),e={},i=Object.keys(s);function n(o){const l=function(...a){const c=a[0];return c==null?c:(c.length>1&&(a=c),o(a))};return"conversion"in o&&(l.conversion=o.conversion),l}function r(o){const l=function(...a){const c=a[0];if(c==null)return c;c.length>1&&(a=c);const h=o(a);if(typeof h=="object")for(let f=h.length,m=0;m<f;m++)h[m]=Math.round(h[m]);return h};return"conversion"in o&&(l.conversion=o.conversion),l}return i.forEach(o=>{e[o]={},Object.defineProperty(e[o],"channels",{value:s[o].channels}),Object.defineProperty(e[o],"labels",{value:s[o].labels});const l=t(o);Object.keys(l).forEach(c=>{const h=l[c];e[o][c]=r(h),e[o][c].raw=n(h)})}),ax=e,ax}var sI=Zz();const Hz=ld(sI),rI=RB({__proto__:null,default:Hz},[sI]),Rh=(s,t=0,e=1)=>s>e?e:s<t?t:s,Ii=(s,t=0,e=Math.pow(10,t))=>Math.round(e*s)/e,qz=s=>Kz(zb(s)),zb=s=>(s[0]==="#"&&(s=s.substring(1)),s.length<6?{r:parseInt(s[0]+s[0],16),g:parseInt(s[1]+s[1],16),b:parseInt(s[2]+s[2],16),a:s.length===4?Ii(parseInt(s[3]+s[3],16)/255,2):1}:{r:parseInt(s.substring(0,2),16),g:parseInt(s.substring(2,4),16),b:parseInt(s.substring(4,6),16),a:s.length===8?Ii(parseInt(s.substring(6,8),16)/255,2):1}),jz=s=>Yz(Gz(s)),Xz=({h:s,s:t,v:e,a:i})=>{const n=(200-t)*e/100;return{h:Ii(s),s:Ii(n>0&&n<200?t*e/100/(n<=100?n:200-n)*100:0),l:Ii(n/2),a:Ii(i,2)}},Wb=s=>{const{h:t,s:e,l:i}=Xz(s);return`hsl(${t}, ${e}%, ${i}%)`},Gz=({h:s,s:t,v:e,a:i})=>{s=s/360*6,t=t/100,e=e/100;const n=Math.floor(s),r=e*(1-t),o=e*(1-(s-n)*t),l=e*(1-(1-s+n)*t),a=n%6;return{r:Ii([e,o,r,r,l,e][a]*255),g:Ii([l,e,e,o,r,r][a]*255),b:Ii([r,r,l,e,e,o][a]*255),a:Ii(i,2)}},Xf=s=>{const t=s.toString(16);return t.length<2?"0"+t:t},Yz=({r:s,g:t,b:e,a:i})=>{const n=i<1?Xf(Ii(i*255)):"";return"#"+Xf(s)+Xf(t)+Xf(e)+n},Kz=({r:s,g:t,b:e,a:i})=>{const n=Math.max(s,t,e),r=n-Math.min(s,t,e),o=r?n===s?(t-e)/r:n===t?2+(e-s)/r:4+(s-t)/r:0;return{h:Ii(60*(o<0?o+6:o)),s:Ii(n?r/n*100:0),v:Ii(n/255*100),a:i}},oI=(s,t)=>{if(s===t)return!0;for(const e in s)if(s[e]!==t[e])return!1;return!0},Jz=(s,t)=>s.toLowerCase()===t.toLowerCase()?!0:oI(zb(s),zb(t)),GC={},lI=s=>{let t=GC[s];return t||(t=document.createElement("template"),t.innerHTML=s,GC[s]=t),t},sy=(s,t,e)=>{s.dispatchEvent(new CustomEvent(t,{bubbles:!0,detail:e}))};let sc=!1;const Ub=s=>"touches"in s,eW=s=>sc&&!Ub(s)?!1:(sc||(sc=Ub(s)),!0),YC=(s,t)=>{const e=Ub(t)?t.touches[0]:t,i=s.el.getBoundingClientRect();sy(s.el,"move",s.getMove({x:Rh((e.pageX-(i.left+window.pageXOffset))/i.width),y:Rh((e.pageY-(i.top+window.pageYOffset))/i.height)}))},tW=(s,t)=>{const e=t.keyCode;e>40||s.xy&&e<37||e<33||(t.preventDefault(),sy(s.el,"move",s.getMove({x:e===39?.01:e===37?-.01:e===34?.05:e===33?-.05:e===35?1:e===36?-1:0,y:e===40?.01:e===38?-.01:0},!0)))};class aI{constructor(t,e,i,n){const r=lI(`<div role="slider" tabindex="0" part="${e}" ${i}><div part="${e}-pointer"></div></div>`);t.appendChild(r.content.cloneNode(!0));const o=t.querySelector(`[part=${e}]`);o.addEventListener("mousedown",this),o.addEventListener("touchstart",this),o.addEventListener("keydown",this),this.el=o,this.xy=n,this.nodes=[o.firstChild,o]}set dragging(t){const e=t?document.addEventListener:document.removeEventListener;e(sc?"touchmove":"mousemove",this),e(sc?"touchend":"mouseup",this)}handleEvent(t){switch(t.type){case"mousedown":case"touchstart":if(t.preventDefault(),!eW(t)||!sc&&t.button!=0)return;this.el.focus(),YC(this,t),this.dragging=!0;break;case"mousemove":case"touchmove":t.preventDefault(),YC(this,t);break;case"mouseup":case"touchend":this.dragging=!1;break;case"keydown":tW(this,t);break}}style(t){t.forEach((e,i)=>{for(const n in e)this.nodes[i].style.setProperty(n,e[n])})}}class iW extends aI{constructor(t){super(t,"hue",'aria-label="Hue" aria-valuemin="0" aria-valuemax="360"',!1)}update({h:t}){this.h=t,this.style([{left:`${t/360*100}%`,color:Wb({h:t,s:100,v:100,a:1})}]),this.el.setAttribute("aria-valuenow",`${Ii(t)}`)}getMove(t,e){return{h:e?Rh(this.h+t.x*360,0,360):360*t.x}}}class nW extends aI{constructor(t){super(t,"saturation",'aria-label="Color"',!0)}update(t){this.hsva=t,this.style([{top:`${100-t.v}%`,left:`${t.s}%`,color:Wb(t)},{"background-color":Wb({h:t.h,s:100,v:100,a:1})}]),this.el.setAttribute("aria-valuetext",`Saturation ${Ii(t.s)}%, Brightness ${Ii(t.v)}%`)}getMove(t,e){return{s:e?Rh(this.hsva.s+t.x*100,0,100):t.x*100,v:e?Rh(this.hsva.v-t.y*100,0,100):Math.round(100-t.y*100)}}}const sW=':host{display:flex;flex-direction:column;position:relative;width:200px;height:200px;user-select:none;-webkit-user-select:none;cursor:default}:host([hidden]){display:none!important}[role=slider]{position:relative;touch-action:none;user-select:none;-webkit-user-select:none;outline:0}[role=slider]:last-child{border-radius:0 0 8px 8px}[part$=pointer]{position:absolute;z-index:1;box-sizing:border-box;width:28px;height:28px;display:flex;place-content:center center;transform:translate(-50%,-50%);background-color:#fff;border:2px solid #fff;border-radius:50%;box-shadow:0 2px 4px rgba(0,0,0,.2)}[part$=pointer]::after{content:"";width:100%;height:100%;border-radius:inherit;background-color:currentColor}[role=slider]:focus [part$=pointer]{transform:translate(-50%,-50%) scale(1.1)}',rW="[part=hue]{flex:0 0 24px;background:linear-gradient(to right,red 0,#ff0 17%,#0f0 33%,#0ff 50%,#00f 67%,#f0f 83%,red 100%)}[part=hue-pointer]{top:50%;z-index:2}",oW="[part=saturation]{flex-grow:1;border-color:transparent;border-bottom:12px solid #000;border-radius:8px 8px 0 0;background-image:linear-gradient(to top,#000,transparent),linear-gradient(to right,#fff,rgba(255,255,255,0));box-shadow:inset 0 0 0 1px rgba(0,0,0,.05)}[part=saturation-pointer]{z-index:3}",Gf=Symbol("same"),cx=Symbol("color"),KC=Symbol("hsva"),ux=Symbol("update"),JC=Symbol("parts"),e2=Symbol("css"),t2=Symbol("sliders");class lW extends HTMLElement{static get observedAttributes(){return["color"]}get[e2](){return[sW,rW,oW]}get[t2](){return[nW,iW]}get color(){return this[cx]}set color(t){if(!this[Gf](t)){const e=this.colorModel.toHsva(t);this[ux](e),this[cx]=t}}constructor(){super();const t=lI(`<style>${this[e2].join("")}</style>`),e=this.attachShadow({mode:"open"});e.appendChild(t.content.cloneNode(!0)),e.addEventListener("move",this),this[JC]=this[t2].map(i=>new i(e))}connectedCallback(){if(this.hasOwnProperty("color")){const t=this.color;delete this.color,this.color=t}else this.color||(this.color=this.colorModel.defaultColor)}attributeChangedCallback(t,e,i){const n=this.colorModel.fromAttr(i);this[Gf](n)||(this.color=n)}handleEvent(t){const e=this[KC],i={...e,...t.detail};this[ux](i);let n;!oI(i,e)&&!this[Gf](n=this.colorModel.fromHsva(i))&&(this[cx]=n,sy(this,"color-changed",{value:n}))}[Gf](t){return this.color&&this.colorModel.equal(t,this.color)}[ux](t){this[KC]=t,this[JC].forEach(e=>e.update(t))}}const aW={defaultColor:"#000",toHsva:qz,fromHsva:({h:s,s:t,v:e})=>jz({h:s,s:t,v:e,a:1}),equal:Jz,fromAttr:s=>s};class cW extends lW{get colorModel(){return aW}}/**
 * @license Copyright (c) 2003-2025, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options
 */class fi extends di{constructor(e=[]){super(e,{idProperty:"viewUid"});p(this,"_parentElement");this.on("add",(i,n,r)=>{this._renderViewIntoCollectionParent(n,r)}),this.on("remove",(i,n)=>{n.element&&this._parentElement&&n.element.remove()}),this._parentElement=null}destroy(){this.map(e=>e.destroy())}setParent(e){this._parentElement=e;for(const i of this)this._renderViewIntoCollectionParent(i)}delegate(...e){if(!e.length||!uW(e))throw new E("ui-viewcollection-delegate-wrong-events",this);return{to:i=>{for(const n of this)for(const r of e)n.delegate(r).to(i);this.on("add",(n,r)=>{for(const o of e)r.delegate(o).to(i)}),this.on("remove",(n,r)=>{for(const o of e)r.stopDelegating(o,i)})}}}_renderViewIntoCollectionParent(e,i){e.isRendered||e.render(),e.element&&this._parentElement&&this._parentElement.insertBefore(e.element,this._parentElement.children[i])}remove(e){return super.remove(e)}}function uW(s){return s.every(t=>typeof t=="string")}const hW="http://www.w3.org/1999/xhtml";class zn extends pt(){constructor(e){super();p(this,"ns");p(this,"tag");p(this,"text");p(this,"attributes");p(this,"children");p(this,"eventListeners");p(this,"_isRendered");p(this,"_revertData");Object.assign(this,n2(i2(e))),this._isRendered=!1,this._revertData=null}render(){const e=this._renderNode({intoFragment:!0});return this._isRendered=!0,e}apply(e){return this._revertData=o2(),this._renderNode({node:e,intoFragment:!1,isApplying:!0,revertData:this._revertData}),e}revert(e){if(!this._revertData)throw new E("ui-template-revert-not-applied",[this,e]);this._revertTemplateFromNode(e,this._revertData)}*getViews(){function*e(i){if(i.children)for(const n of i.children)vg(n)?yield n:ry(n)&&(yield*e(n))}yield*e(this)}static bind(e,i){return{to(n,r){return new dW({eventNameOrFunction:n,attribute:n,observable:e,emitter:i,callback:r})},if(n,r,o){return new cI({observable:e,emitter:i,attribute:n,valueIfTrue:r,callback:o})}}}static extend(e,i){if(e._isRendered)throw new E("template-extend-render",[this,e]);fI(e,n2(i2(i)))}_renderNode(e){let i;if(e.node?i=this.tag&&this.text:i=this.tag?this.text:!this.text,i)throw new E("ui-template-wrong-syntax",this);return this.text?this._renderText(e):this._renderElement(e)}_renderElement(e){let i=e.node;return i||(i=e.node=document.createElementNS(this.ns||hW,this.tag)),this._renderAttributes(e),this._renderElementChildren(e),this._setUpListeners(e),i}_renderText(e){let i=e.node;return i?e.revertData.text=i.textContent:i=e.node=document.createTextNode(""),Bm(this.text)?this._bindToObservable({schema:this.text,updater:mW(i),data:e}):i.textContent=this.text.join(""),i}_renderAttributes(e){if(!this.attributes)return;const i=e.node,n=e.revertData;for(const r in this.attributes){const o=i.getAttribute(r),l=this.attributes[r];n&&(n.attributes[r]=o);const a=r2(l)?l[0].ns:null;if(Bm(l)){const c=r2(l)?l[0].value:l;n&&l2(r)&&c.unshift(o),this._bindToObservable({schema:c,updater:gW(i,r,a),data:e})}else if(r=="style"&&typeof l[0]!="string")this._renderStyleAttribute(l[0],e);else{n&&o&&l2(r)&&l.unshift(o);const c=l.map(h=>h&&(h.value||h)).reduce((h,f)=>h.concat(f),[]).reduce(dI,"");fc(c)||i.setAttributeNS(a,r,c)}}}_renderStyleAttribute(e,i){const n=i.node;for(const r in e){const o=e[r];Bm(o)?this._bindToObservable({schema:[o],updater:pW(n,r),data:i}):n.style[r]=o}}_renderElementChildren(e){const i=e.node,n=e.intoFragment?document.createDocumentFragment():i,r=e.isApplying;let o=0;for(const l of this.children)if(oy(l)){if(!r){l.setParent(i);for(const a of l)n.appendChild(a.element)}}else if(vg(l))r||(l.isRendered||l.render(),n.appendChild(l.element));else if(Io(l))n.appendChild(l);else if(r){const a=e.revertData,c=o2();a.children.push(c),l._renderNode({intoFragment:!1,node:n.childNodes[o++],isApplying:!0,revertData:c})}else n.appendChild(l.render());e.intoFragment&&i.appendChild(n)}_setUpListeners(e){if(this.eventListeners)for(const i in this.eventListeners){const n=this.eventListeners[i].map(r=>{const[o,l]=i.split("@");return r.activateDomEventListener(o,l,e)});e.revertData&&e.revertData.bindings.push(n)}}_bindToObservable({schema:e,updater:i,data:n}){const r=n.revertData;uI(e,i,n);const o=e.filter(l=>!fc(l)).filter(l=>l.observable).map(l=>l.activateAttributeListener(e,i,n));r&&r.bindings.push(o)}_revertTemplateFromNode(e,i){for(const r of i.bindings)for(const o of r)o();if(i.text){e.textContent=i.text;return}const n=e;for(const r in i.attributes){const o=i.attributes[r];o===null?n.removeAttribute(r):n.setAttribute(r,o)}for(let r=0;r<i.children.length;++r)this._revertTemplateFromNode(n.childNodes[r],i.children[r])}}class hd{constructor(t){p(this,"attribute");p(this,"observable");p(this,"emitter");p(this,"callback");this.attribute=t.attribute,this.observable=t.observable,this.emitter=t.emitter,this.callback=t.callback}getValue(t){const e=this.observable[this.attribute];return this.callback?this.callback(e,t):e}activateAttributeListener(t,e,i){const n=()=>uI(t,e,i);return this.emitter.listenTo(this.observable,`change:${this.attribute}`,n),()=>{this.emitter.stopListening(this.observable,`change:${this.attribute}`,n)}}}class dW extends hd{constructor(e){super(e);p(this,"eventNameOrFunction");this.eventNameOrFunction=e.eventNameOrFunction}activateDomEventListener(e,i,n){const r=(o,l)=>{(!i||l.target.matches(i))&&(typeof this.eventNameOrFunction=="function"?this.eventNameOrFunction(l):this.observable.fire(this.eventNameOrFunction,l))};return this.emitter.listenTo(n.node,e,r),()=>{this.emitter.stopListening(n.node,e,r)}}}class cI extends hd{constructor(e){super(e);p(this,"valueIfTrue");this.valueIfTrue=e.valueIfTrue}getValue(e){const i=super.getValue(e);return fc(i)?!1:this.valueIfTrue||!0}}function Bm(s){return s?(s.value&&(s=s.value),Array.isArray(s)?s.some(Bm):s instanceof hd):!1}function fW(s,t){return s.map(e=>e instanceof hd?e.getValue(t):e)}function uI(s,t,{node:e}){const i=fW(s,e);let n;s.length==1&&s[0]instanceof cI?n=i[0]:n=i.reduce(dI,""),fc(n)?t.remove():t.set(n)}function mW(s){return{set(t){s.textContent=t},remove(){s.textContent=""}}}function gW(s,t,e){return{set(i){s.setAttributeNS(e,t,i)},remove(){s.removeAttributeNS(e,t)}}}function pW(s,t){return{set(e){s.style[t]=e},remove(){s.style[t]=null}}}function i2(s){return bp(s,e=>{if(e&&(e instanceof hd||ry(e)||vg(e)||oy(e)))return e})}function n2(s){if(typeof s=="string"?s=bW(s):s.text&&OW(s),s.on&&(s.eventListeners=xW(s.on),delete s.on),!s.text){s.attributes&&wW(s.attributes);const t=[];if(s.children)if(oy(s.children))t.push(s.children);else for(const e of s.children)ry(e)||vg(e)||Io(e)?t.push(e):t.push(new zn(e));s.children=t}return s}function wW(s){for(const t in s)s[t].value&&(s[t].value=dt(s[t].value)),hI(s,t)}function xW(s){for(const t in s)hI(s,t);return s}function bW(s){return{text:[s]}}function OW(s){s.text=dt(s.text)}function hI(s,t){s[t]=dt(s[t])}function dI(s,t){return fc(t)?s:fc(s)?t:`${s} ${t}`}function s2(s,t){for(const e in t)s[e]?s[e].push(...t[e]):s[e]=t[e]}function fI(s,t){if(t.attributes&&(s.attributes||(s.attributes={}),s2(s.attributes,t.attributes)),t.eventListeners&&(s.eventListeners||(s.eventListeners={}),s2(s.eventListeners,t.eventListeners)),t.text&&s.text.push(...t.text),t.children&&t.children.length){if(s.children.length!=t.children.length)throw new E("ui-template-extend-children-mismatch",s);let e=0;for(const i of t.children)fI(s.children[e++],i)}}function fc(s){return!s&&s!==0}function vg(s){return s instanceof ue}function ry(s){return s instanceof zn}function oy(s){return s instanceof fi}function r2(s){return ds(s[0])&&s[0].ns}function o2(){return{children:[],bindings:[],attributes:{}}}function l2(s){return s=="class"||s=="style"}class ue extends qi(at()){constructor(e){super();p(this,"element");p(this,"isRendered");p(this,"locale");p(this,"t");p(this,"template");p(this,"_viewCollections");p(this,"_unboundChildren");p(this,"_bindTemplate");this.element=null,this.isRendered=!1,this.locale=e,this.t=e&&e.t,this._viewCollections=new di,this._unboundChildren=this.createCollection(),this._viewCollections.on("add",(i,n)=>{n.locale=e,n.t=e&&e.t}),this.decorate("render")}get bindTemplate(){return this._bindTemplate?this._bindTemplate:this._bindTemplate=zn.bind(this,this)}createCollection(e){const i=new fi(e);return this._viewCollections.add(i),i}registerChild(e){Wn(e)||(e=[e]);for(const i of e)this._unboundChildren.add(i)}deregisterChild(e){Wn(e)||(e=[e]);for(const i of e)this._unboundChildren.remove(i)}setTemplate(e){this.template=new zn(e)}extendTemplate(e){zn.extend(this.template,e)}render(){if(this.isRendered)throw new E("ui-view-render-already-rendered",this);this.template&&(this.element=this.template.render(),this.registerChild(this.template.getViews())),this.isRendered=!0}destroy(){this.stopListening(),this._viewCollections.map(e=>e.destroy()),this.template&&this.template._revertData&&this.template.revert(this.element)}}/**
 * @license Copyright (c) 2003-2025, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options
 */function Fr({emitter:s,activator:t,callback:e,contextElements:i,listenerOptions:n}){s.listenTo(document,"mousedown",(r,o)=>{if(!t())return;const l=typeof o.composedPath=="function"?o.composedPath():[],a=typeof i=="function"?i():i;for(const c of a)if(c.contains(o.target)||l.includes(c))return;e()},n)}/**
 * @license Copyright (c) 2003-2025, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options
 */function _g(s){class t extends s{disableCssTransitions(){this._isCssTransitionsDisabled=!0}enableCssTransitions(){this._isCssTransitionsDisabled=!1}constructor(...i){super(...i),this.set("_isCssTransitionsDisabled",!1),this.initializeCssTransitionDisablerMixin()}initializeCssTransitionDisablerMixin(){this.extendTemplate({attributes:{class:[this.bindTemplate.if("_isCssTransitionsDisabled","ck-transitions-disabled")]}})}}return t}/**
 * @license Copyright (c) 2003-2025, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options
 */function Wl({view:s}){s.listenTo(s.element,"submit",(t,e)=>{e.preventDefault(),s.fire("submit")},{useCapture:!0})}/**
 * @license Copyright (c) 2003-2025, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options
 */function Ep({keystrokeHandler:s,focusTracker:t,gridItems:e,numberOfColumns:i,uiLanguageDirection:n}){const r=typeof i=="number"?()=>i:i;s.set("arrowright",o((c,h)=>n==="rtl"?a(c,h.length):l(c,h.length))),s.set("arrowleft",o((c,h)=>n==="rtl"?l(c,h.length):a(c,h.length))),s.set("arrowup",o((c,h)=>{let f=c-r();return f<0&&(f=c+r()*Math.floor(h.length/r()),f>h.length-1&&(f-=r())),f})),s.set("arrowdown",o((c,h)=>{let f=c+r();return f>h.length-1&&(f=c%r()),f}));function o(c){return h=>{const f=e.find(O=>O.element===t.focusedElement),m=e.getIndex(f),w=c(m,e);e.get(w).focus(),h.stopPropagation(),h.preventDefault()}}function l(c,h){return c===h-1?0:c+1}function a(c,h){return c===0?h-1:c-1}}const fp=class fp extends ue{constructor(){super();const t=this.bindTemplate;this.set("content",""),this.set("viewBox","0 0 20 20"),this.set("fillColor",""),this.set("isColorInherited",!0),this.set("isVisible",!0),this.setTemplate({tag:"svg",ns:"http://www.w3.org/2000/svg",attributes:{class:["ck","ck-icon",t.if("isVisible","ck-hidden",e=>!e),"ck-reset_all-excluded",t.if("isColorInherited","ck-icon_inherit-color")],viewBox:t.to("viewBox"),"aria-hidden":!0}})}render(){super.render(),this._updateXMLContent(),this._colorFillPaths(),this.on("change:content",()=>{this._updateXMLContent(),this._colorFillPaths()}),this.on("change:fillColor",()=>{this._colorFillPaths()})}_updateXMLContent(){if(this.content){const e=new DOMParser().parseFromString(this.content.trim(),"image/svg+xml").querySelector("svg");if(!e)throw new E("ui-iconview-invalid-svg",this);const i=e.getAttribute("viewBox");i&&(this.viewBox=i);for(const{name:n,value:r}of Array.from(e.attributes))fp.presentationalAttributeNames.includes(n)&&this.element.setAttribute(n,r);for(;this.element.firstChild;)this.element.removeChild(this.element.firstChild);for(;e.childNodes.length>0;)this.element.appendChild(e.childNodes[0])}}_colorFillPaths(){this.fillColor&&this.element.querySelectorAll(".ck-icon__fill").forEach(t=>{t.style.fill=this.fillColor})}};p(fp,"presentationalAttributeNames",["alignment-baseline","baseline-shift","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-rendering","cursor","direction","display","dominant-baseline","fill","fill-opacity","fill-rule","filter","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","image-rendering","letter-spacing","lighting-color","marker-end","marker-mid","marker-start","mask","opacity","overflow","paint-order","pointer-events","shape-rendering","stop-color","stop-opacity","stroke","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke-width","text-anchor","text-decoration","text-overflow","text-rendering","transform","unicode-bidi","vector-effect","visibility","white-space","word-spacing","writing-mode"]);let Zn=fp;class ly extends ue{constructor(){super(),this.set({style:void 0,text:void 0,id:void 0});const t=this.bindTemplate;this.setTemplate({tag:"span",attributes:{class:["ck","ck-button__label"],style:t.to("style"),id:t.to("id")},children:[{text:t.to("text")}]})}}class ye extends ue{constructor(e,i=new ly){super(e);p(this,"children");p(this,"labelView");p(this,"iconView");p(this,"keystrokeView");p(this,"_focusDelayed",null);const n=this.bindTemplate,r=ei();this.set("_ariaPressed",!1),this.set("_ariaChecked",!1),this.set("ariaLabel",void 0),this.set("ariaLabelledBy",`ck-editor__aria-label_${r}`),this.set("class",void 0),this.set("labelStyle",void 0),this.set("icon",void 0),this.set("isEnabled",!0),this.set("isOn",!1),this.set("isVisible",!0),this.set("isToggleable",!1),this.set("keystroke",void 0),this.set("label",void 0),this.set("role",void 0),this.set("tabindex",-1),this.set("tooltip",!1),this.set("tooltipPosition","s"),this.set("type","button"),this.set("withText",!1),this.set("withKeystroke",!1),this.children=this.createCollection(),this.labelView=this._setupLabelView(i),this.iconView=new Zn,this.iconView.extendTemplate({attributes:{class:"ck-button__icon"}}),this.iconView.bind("content").to(this,"icon"),this.keystrokeView=this._createKeystrokeView(),this.bind("_tooltipString").to(this,"tooltip",this,"label",this,"keystroke",this._getTooltipString.bind(this));const o={tag:"button",attributes:{class:["ck","ck-button",n.to("class"),n.if("isEnabled","ck-disabled",l=>!l),n.if("isVisible","ck-hidden",l=>!l),n.to("isOn",l=>l?"ck-on":"ck-off"),n.if("withText","ck-button_with-text"),n.if("withKeystroke","ck-button_with-keystroke")],role:n.to("role"),type:n.to("type",l=>l||"button"),tabindex:n.to("tabindex"),"aria-checked":n.to("_ariaChecked"),"aria-pressed":n.to("_ariaPressed"),"aria-label":n.to("ariaLabel"),"aria-labelledby":n.to("ariaLabelledBy"),"aria-disabled":n.if("isEnabled",!0,l=>!l),"data-cke-tooltip-text":n.to("_tooltipString"),"data-cke-tooltip-position":n.to("tooltipPosition")},children:this.children,on:{click:n.to(l=>{this.isEnabled?this.fire("execute"):l.preventDefault()})}};this.bind("_ariaPressed").to(this,"isOn",this,"isToggleable",this,"role",(l,a,c)=>!a||a2(c)?!1:String(!!l)),this.bind("_ariaChecked").to(this,"isOn",this,"isToggleable",this,"role",(l,a,c)=>!a||!a2(c)?!1:String(!!l)),Ie.isSafari&&(this._focusDelayed||(this._focusDelayed=_p(()=>this.focus(),0)),o.on.mousedown=n.to(()=>{this._focusDelayed()}),o.on.mouseup=n.to(()=>{this._focusDelayed.cancel()})),this.setTemplate(o)}render(){super.render(),this.icon&&this.children.add(this.iconView),this.on("change:icon",(e,i,n,r)=>{n&&!r?this.children.add(this.iconView,0):!n&&r&&this.children.remove(this.iconView)}),this.children.add(this.labelView),this.withKeystroke&&this.keystroke&&this.children.add(this.keystrokeView)}focus(){this.element.focus()}destroy(){this._focusDelayed&&this._focusDelayed.cancel(),super.destroy()}_setupLabelView(e){return e.bind("text","style","id").to(this,"label","labelStyle","ariaLabelledBy"),e}_createKeystrokeView(){const e=new ue;return e.setTemplate({tag:"span",attributes:{class:["ck","ck-button__keystroke"]},children:[{text:this.bindTemplate.to("keystroke",i=>gg(i))}]}),e}_getTooltipString(e,i,n){return e?typeof e=="string"?e:(n&&(n=gg(n)),e instanceof Function?e(i,n):`${i}${n?` (${n})`:""}`):""}}function a2(s){switch(s){case"radio":case"checkbox":case"option":case"switch":case"menuitemcheckbox":case"menuitemradio":return!0;default:return!1}}class zr extends ue{constructor(e,i={}){super(e);p(this,"children");p(this,"iconView");const n=this.bindTemplate;this.set("label",i.label||""),this.set("class",i.class||null),this.children=this.createCollection(),this.setTemplate({tag:"div",attributes:{class:["ck","ck-form__header",n.to("class")]},children:this.children}),i.icon&&(this.iconView=new Zn,this.iconView.content=i.icon,this.children.add(this.iconView));const r=new ue(e);r.setTemplate({tag:"h2",attributes:{class:["ck","ck-form__header__label"],role:"presentation"},children:[{text:n.to("label")}]}),this.children.add(r)}}class Ht extends pt(){constructor(e){super();p(this,"focusables");p(this,"focusTracker");p(this,"keystrokeHandler");p(this,"actions");if(this.focusables=e.focusables,this.focusTracker=e.focusTracker,this.keystrokeHandler=e.keystrokeHandler,this.actions=e.actions,e.actions&&e.keystrokeHandler)for(const i in e.actions){let n=e.actions[i];typeof n=="string"&&(n=[n]);for(const r of n)e.keystrokeHandler.set(r,(o,l)=>{this[i](),l()},e.keystrokeHandlerOptions)}this.on("forwardCycle",()=>this.focusFirst(),{priority:"low"}),this.on("backwardCycle",()=>this.focusLast(),{priority:"low"})}get first(){return this.focusables.find(hx)||null}get last(){return this.focusables.filter(hx).slice(-1)[0]||null}get next(){return this._getDomFocusableItem(1)}get previous(){return this._getDomFocusableItem(-1)}get current(){let e=null;return this.focusTracker.focusedElement===null?null:(this.focusables.find((i,n)=>{const r=i.element===this.focusTracker.focusedElement;return r&&(e=n),r}),e)}focusFirst(){this._focus(this.first,1)}focusLast(){this._focus(this.last,-1)}focusNext(){const e=this.next;if(e&&this.focusables.getIndex(e)===this.current){this.fire("forwardCycle");return}e===this.first?this.fire("forwardCycle"):this._focus(e,1)}focusPrevious(){const e=this.previous;if(e&&this.focusables.getIndex(e)===this.current){this.fire("backwardCycle");return}e===this.last?this.fire("backwardCycle"):this._focus(e,-1)}chain(e){const i=()=>this.current===null?null:this.focusables.get(this.current);this.listenTo(e,"forwardCycle",n=>{const r=i();this.focusNext(),r!==i()&&n.stop()},{priority:"low"}),this.listenTo(e,"backwardCycle",n=>{const r=i();this.focusPrevious(),r!==i()&&n.stop()},{priority:"low"})}unchain(e){this.stopListening(e)}_focus(e,i){e&&this.focusTracker.focusedElement!==e.element&&e.focus(i)}_getDomFocusableItem(e){const i=this.focusables.length;if(!i)return null;const n=this.current;if(n===null)return this[e===1?"first":"last"];let r=this.focusables.get(n),o=(n+i+e)%i;do{const l=this.focusables.get(o);if(hx(l)){r=l;break}o=(o+i+e)%i}while(o!==n);return r}}function hx(s){return Rc(s)&&Ls(s.element)}function Rc(s){return"focus"in s&&typeof s.focus=="function"}function mI(s){return Rc(s)&&"focusCycler"in s&&s.focusCycler instanceof Ht}function yW(s){class t extends s{constructor(...n){super(...n);p(this,"_onDragBound",this._onDrag.bind(this));p(this,"_onDragEndBound",this._onDragEnd.bind(this));p(this,"_lastDraggingCoordinates",{x:0,y:0});this.on("render",()=>{this._attachListeners()}),this.set("isDragging",!1)}_attachListeners(){this.listenTo(this.element,"mousedown",this._onDragStart.bind(this)),this.listenTo(this.element,"touchstart",this._onDragStart.bind(this))}_attachDragListeners(){this.listenTo(he.document,"mouseup",this._onDragEndBound),this.listenTo(he.document,"touchend",this._onDragEndBound),this.listenTo(he.document,"mousemove",this._onDragBound),this.listenTo(he.document,"touchmove",this._onDragBound)}_detachDragListeners(){this.stopListening(he.document,"mouseup",this._onDragEndBound),this.stopListening(he.document,"touchend",this._onDragEndBound),this.stopListening(he.document,"mousemove",this._onDragBound),this.stopListening(he.document,"touchmove",this._onDragBound)}_onDragStart(n,r){if(!this._isHandleElementPressed(r))return;this._attachDragListeners();let o=0,l=0;r instanceof MouseEvent?(o=r.clientX,l=r.clientY):(o=r.touches[0].clientX,l=r.touches[0].clientY),this._lastDraggingCoordinates={x:o,y:l},this.isDragging=!0}_onDrag(n,r){if(!this.isDragging){this._detachDragListeners();return}let o=0,l=0;r instanceof MouseEvent?(o=r.clientX,l=r.clientY):(o=r.touches[0].clientX,l=r.touches[0].clientY),r.preventDefault(),this.fire("drag",{deltaX:Math.round(o-this._lastDraggingCoordinates.x),deltaY:Math.round(l-this._lastDraggingCoordinates.y)}),this._lastDraggingCoordinates={x:o,y:l}}_onDragEnd(){this._detachDragListeners(),this.isDragging=!1}_isHandleElementPressed(n){return this.dragHandleElement?this.dragHandleElement===n.target||n.target instanceof HTMLElement&&this.dragHandleElement.contains(n.target):!1}}return t}class vW extends ue{constructor(e){super(e);p(this,"children");p(this,"keystrokes");p(this,"focusCycler");p(this,"_focusTracker");p(this,"_focusables");this.children=this.createCollection(),this.keystrokes=new wt,this._focusTracker=new ot,this._focusables=new fi,this.focusCycler=new Ht({focusables:this._focusables,focusTracker:this._focusTracker,keystrokeHandler:this.keystrokes,actions:{focusPrevious:"shift + tab",focusNext:"tab"}}),this.setTemplate({tag:"div",attributes:{class:["ck","ck-dialog__actions"]},children:this.children})}render(){super.render(),this.keystrokes.listenTo(this.element)}setButtons(e){for(const i of e){const n=new ye(this.locale);let r;n.on("execute",()=>i.onExecute()),i.onCreate&&i.onCreate(n);for(r in i)r!="onExecute"&&r!="onCreate"&&n.set(r,i[r]);this.children.add(n)}this._updateFocusCyclableItems()}focus(e){e===-1?this.focusCycler.focusLast():this.focusCycler.focusFirst()}_updateFocusCyclableItems(){Array.from(this.children).forEach(e=>{this._focusables.add(e),this._focusTracker.add(e.element)})}}class _W extends ue{constructor(e){super(e);p(this,"children");this.children=this.createCollection(),this.setTemplate({tag:"div",attributes:{class:["ck","ck-dialog__content"]},children:this.children})}reset(){for(;this.children.length;)this.children.remove(0)}}const ts={SCREEN_CENTER:"screen-center",EDITOR_CENTER:"editor-center",EDITOR_TOP_SIDE:"editor-top-side",EDITOR_TOP_CENTER:"editor-top-center",EDITOR_BOTTOM_CENTER:"editor-bottom-center",EDITOR_ABOVE_CENTER:"editor-above-center",EDITOR_BELOW_CENTER:"editor-below-center"},c2=No("px"),mp=class mp extends yW(ue){constructor(e,{getCurrentDomRoot:i,getViewportOffset:n,keystrokeHandlerOptions:r}){super(e);p(this,"parts");p(this,"headerView");p(this,"closeButtonView");p(this,"actionsView");p(this,"contentView");p(this,"keystrokes");p(this,"focusTracker");p(this,"wasMoved",!1);p(this,"_getCurrentDomRoot");p(this,"_getViewportOffset");p(this,"_focusables");p(this,"_focusCycler");const o=this.bindTemplate,l=e.t;this.set("className",""),this.set("ariaLabel",l("Editor dialog")),this.set("isModal",!1),this.set("position",ts.SCREEN_CENTER),this.set("_isVisible",!1),this.set("_isTransparent",!1),this.set("_top",0),this.set("_left",0),this._getCurrentDomRoot=i,this._getViewportOffset=n,this.decorate("moveTo"),this.parts=this.createCollection(),this.keystrokes=new wt,this.focusTracker=new ot,this._focusables=new fi,this._focusCycler=new Ht({focusables:this._focusables,focusTracker:this.focusTracker,keystrokeHandler:this.keystrokes,actions:{focusPrevious:"shift + tab",focusNext:"tab"},keystrokeHandlerOptions:r}),this.setTemplate({tag:"div",attributes:{class:["ck","ck-dialog-overlay",o.if("isModal","ck-dialog-overlay__transparent",a=>!a),o.if("_isVisible","ck-hidden",a=>!a)],tabindex:"-1"},children:[{tag:"div",attributes:{tabindex:"-1",class:["ck","ck-dialog",o.if("isModal","ck-dialog_modal"),o.to("className")],role:"dialog","aria-label":o.to("ariaLabel"),style:{top:o.to("_top",a=>c2(a)),left:o.to("_left",a=>c2(a)),visibility:o.if("_isTransparent","hidden")}},children:this.parts}]})}render(){super.render(),this.keystrokes.set("Esc",(e,i)=>{e.defaultPrevented||(this.fire("close",{source:"escKeyPress"}),i())}),this.on("drag",(e,{deltaX:i,deltaY:n})=>{this.wasMoved=!0,this.moveBy(i,n)}),this.listenTo(he.window,"resize",()=>{this._isVisible&&!this.wasMoved&&this.updatePosition()}),this.listenTo(he.document,"scroll",()=>{this._isVisible&&!this.wasMoved&&this.updatePosition()}),this.on("change:_isVisible",(e,i,n)=>{n&&(this._isTransparent=!0,setTimeout(()=>{this.updatePosition(),this._isTransparent=!1,this.focus()},10))}),this.keystrokes.listenTo(this.element)}get dragHandleElement(){return this.headerView&&!this.isModal?this.headerView.element:null}setupParts({icon:e,title:i,hasCloseButton:n=!0,content:r,actionButtons:o}){i&&(this.headerView=new zr(this.locale,{icon:e}),n&&(this.closeButtonView=this._createCloseButton(),this.headerView.children.add(this.closeButtonView)),this.headerView.label=i,this.ariaLabel=i,this.parts.add(this.headerView,0)),r&&(r instanceof ue&&(r=[r]),this.contentView=new _W(this.locale),this.contentView.children.addMany(r),this.parts.add(this.contentView)),o&&(this.actionsView=new vW(this.locale),this.actionsView.setButtons(o),this.parts.add(this.actionsView)),this._updateFocusCyclableItems()}focus(){this._focusCycler.focusFirst()}moveTo(e,i){const n=this._getViewportRect(),r=this._getDialogRect();e+r.width>n.right&&(e=n.right-r.width),e<n.left&&(e=n.left),i<n.top&&(i=n.top),this._moveTo(e,i)}_moveTo(e,i){this._left=e,this._top=i}moveBy(e,i){this.moveTo(this._left+e,this._top+i)}_moveOffScreen(){this._moveTo(-9999,-9999)}updatePosition(){if(!this.element||!this.element.parentNode)return;const e=this._getViewportRect();let i=this.position,n;this._getCurrentDomRoot()?n=this._getVisibleDomRootRect(e):i=ts.SCREEN_CENTER;const r=mp.defaultOffset,o=this._getDialogRect();switch(i){case ts.EDITOR_TOP_SIDE:{if(n){const l=this.locale.contentLanguageDirection==="ltr"?n.right-o.width-r:n.left+r;this.moveTo(l,n.top+r)}else this._moveOffScreen();break}case ts.EDITOR_CENTER:{n?this.moveTo(Math.round(n.left+n.width/2-o.width/2),Math.round(n.top+n.height/2-o.height/2)):this._moveOffScreen();break}case ts.SCREEN_CENTER:{this.moveTo(Math.round((e.width-o.width)/2),Math.round((e.height-o.height)/2));break}case ts.EDITOR_TOP_CENTER:{n?this.moveTo(Math.round(n.left+n.width/2-o.width/2),n.top+r):this._moveOffScreen();break}case ts.EDITOR_BOTTOM_CENTER:{n?this.moveTo(Math.round(n.left+n.width/2-o.width/2),n.bottom-o.height-r):this._moveOffScreen();break}case ts.EDITOR_ABOVE_CENTER:{n?this.moveTo(Math.round(n.left+n.width/2-o.width/2),n.top-o.height-r):this._moveOffScreen();break}case ts.EDITOR_BELOW_CENTER:{n?this.moveTo(Math.round(n.left+n.width/2-o.width/2),n.bottom+r):this._moveOffScreen();break}}}_getVisibleDomRootRect(e){let i=new Ve(this._getCurrentDomRoot()).getVisible();if(i){if(i=e.getIntersection(i),!i)return null}else return null;return i}_getDialogRect(){return new Ve(this.element.firstElementChild)}_getViewportRect(){const e=new Ve(he.window);if(this.isModal)return e;const i={top:0,bottom:0,left:0,right:0,...this._getViewportOffset()};return e.top+=i.top,e.height-=i.top,e.bottom-=i.bottom,e.height-=i.bottom,e.left+=i.left,e.right-=i.right,e.width-=i.left+i.right,e}_updateFocusCyclableItems(){const e=[];if(this.contentView)for(const i of this.contentView.children)Rc(i)&&e.push(i);this.actionsView&&e.push(this.actionsView),this.closeButtonView&&e.push(this.closeButtonView),e.forEach(i=>{this._focusables.add(i),this.focusTracker.add(i.element),mI(i)&&this._focusCycler.chain(i.focusCycler)})}_createCloseButton(){const e=new ye(this.locale),i=this.locale.t;return e.set({label:i("Close"),tooltip:!0,icon:Ac}),e.on("execute",()=>this.fire("close",{source:"closeButton"})),e}};p(mp,"defaultOffset",15);let Vh=mp;const Is=class Is extends F{constructor(e){super(e);p(this,"view");p(this,"_onHide");const i=e.t;this._initShowHideListeners(),this._initFocusToggler(),this._initMultiRootIntegration(),this.set({id:null,isOpen:!1}),e.accessibility.addKeystrokeInfos({categoryId:"navigation",keystrokes:[{label:i("Move focus in and out of an active dialog window"),keystroke:"Ctrl+F6",mayRequireFn:!0}]})}static get pluginName(){return"Dialog"}static get isOfficialPlugin(){return!0}destroy(){super.destroy(),Is._visibleDialogPlugin===this&&this._unlockBodyScroll()}_initShowHideListeners(){this.on("show",(e,i)=>{this._show(i)}),this.on("show",(e,i)=>{i.onShow&&i.onShow(this)},{priority:"low"}),this.on("hide",()=>{Is._visibleDialogPlugin&&Is._visibleDialogPlugin._hide()}),this.on("hide",()=>{this._onHide&&(this._onHide(this),this._onHide=void 0)},{priority:"low"})}_initFocusToggler(){const e=this.editor;e.keystrokes.set("Ctrl+F6",(i,n)=>{!this.isOpen||this.view.isModal||(this.view.focusTracker.isFocused?e.editing.view.focus():this.view.focus(),n())})}_initMultiRootIntegration(){const e=this.editor.model;e.document.on("change:data",()=>{if(!this.view)return;const i=e.document.differ.getChangedRoots();for(const n of i)n.state&&this.view.updatePosition()})}show(e){this.hide(),this.fire(`show:${e.id}`,e)}_show({id:e,icon:i,title:n,hasCloseButton:r=!0,content:o,actionButtons:l,className:a,isModal:c,position:h,onHide:f,keystrokeHandlerOptions:m}){const w=this.editor;this.view=new Vh(w.locale,{getCurrentDomRoot:()=>w.editing.view.getDomRoot(w.model.document.selection.anchor.root.rootName),getViewportOffset:()=>w.ui.viewportOffset,keystrokeHandlerOptions:m});const O=this.view;O.on("close",()=>{this.hide()}),w.ui.view.body.add(O),w.keystrokes.listenTo(O.element),h||(h=c?ts.SCREEN_CENTER:ts.EDITOR_CENTER),c&&this._lockBodyScroll(),O.set({position:h,_isVisible:!0,className:a,isModal:c}),O.setupParts({icon:i,title:n,hasCloseButton:r,content:o,actionButtons:l}),this.id=e,f&&(this._onHide=f),this.isOpen=!0,Is._visibleDialogPlugin=this}hide(){Is._visibleDialogPlugin&&Is._visibleDialogPlugin.fire(`hide:${Is._visibleDialogPlugin.id}`)}_hide(){if(!this.view)return;const e=this.editor,i=this.view;i.isModal&&this._unlockBodyScroll(),i.contentView&&i.contentView.reset(),e.ui.view.body.remove(i),e.ui.focusTracker.remove(i.element),e.keystrokes.stopListening(i.element),i.destroy(),e.editing.view.focus(),this.id=null,this.isOpen=!1,Is._visibleDialogPlugin=null}_lockBodyScroll(){document.documentElement.classList.add("ck-dialog-scroll-locked")}_unlockBodyScroll(){document.documentElement.classList.remove("ck-dialog-scroll-locked")}};p(Is,"_visibleDialogPlugin");let Pl=Is;class Ul extends ye{constructor(e,i=new ly){super(e,i);p(this,"_checkIconHolderView",new kW);this.set({hasCheckSpace:!1,_hasCheck:this.isToggleable});const n=this.bindTemplate;this.extendTemplate({attributes:{class:["ck-list-item-button",n.if("isToggleable","ck-list-item-button_toggleable")]}}),this.bind("_hasCheck").to(this,"hasCheckSpace",this,"isToggleable",(r,o)=>r||o)}render(){super.render(),this._hasCheck&&this.children.add(this._checkIconHolderView,0),this._watchCheckIconHolderMount()}_watchCheckIconHolderMount(){this._checkIconHolderView.bind("isOn").to(this,"isOn",e=>this.isToggleable&&e),this.on("change:_hasCheck",(e,i,n)=>{const{children:r,_checkIconHolderView:o}=this;n?r.add(o,0):r.remove(o)})}}class kW extends ue{constructor(){super();p(this,"children");p(this,"_checkIconView",this._createCheckIconView());const e=this.bindTemplate;this.children=this.createCollection(),this.set("isOn",!1),this.setTemplate({tag:"span",children:this.children,attributes:{class:["ck","ck-list-item-button__check-holder",e.to("isOn",i=>i?"ck-on":"ck-off")]}})}render(){super.render(),this.isOn&&this.children.add(this._checkIconView,0),this._watchCheckIconMount()}_watchCheckIconMount(){this.on("change:isOn",(e,i,n)=>{const{children:r,_checkIconView:o}=this;n&&!r.has(o)?r.add(o):!n&&r.has(o)&&r.remove(o)})}_createCheckIconView(){const e=new Zn;return e.content=Ic,e.extendTemplate({attributes:{class:"ck-list-item-button__check-icon"}}),e}}class ti extends Ul{constructor(t){super(t),this.set({withText:!0,withKeystroke:!0,tooltip:!1,role:"menuitem"}),this.extendTemplate({attributes:{class:["ck-menu-bar__menu__item__button"]}})}}class ns extends ue{constructor(e){super(e);p(this,"id");this.set("text",void 0),this.set("for",void 0),this.id=`ck-editor__label_${ei()}`;const i=this.bindTemplate;this.setTemplate({tag:"label",attributes:{class:["ck","ck-label"],id:this.id,for:i.to("for")},children:[{text:i.to("text")}]})}}class SW extends ue{constructor(t,e){super(t);const i=t.t,n=new ns;n.text=i("Help Contents. To close this dialog press ESC."),this.setTemplate({tag:"div",attributes:{class:["ck","ck-accessibility-help-dialog__content"],"aria-labelledby":n.id,role:"document",tabindex:-1},children:[bi(document,"p",{},i("Below, you can find a list of keyboard shortcuts that can be used in the editor.")),...this._createCategories(Array.from(e.values())),n]})}focus(){this.element.focus()}_createCategories(t){return t.map(e=>{const i=[bi(document,"h3",{},e.label),...Array.from(e.groups.values()).map(n=>this._createGroup(n)).flat()];return e.description&&i.splice(1,0,bi(document,"p",{},e.description)),bi(document,"section",{},i)})}_createGroup(t){const e=t.keystrokes.sort((n,r)=>n.label.localeCompare(r.label)).map(n=>this._createGroupRow(n)).flat(),i=[bi(document,"dl",{},e)];return t.label&&i.unshift(bi(document,"h4",{},t.label)),i}_createGroupRow(t){const e=this.locale.t,i=bi(document,"dt"),n=bi(document,"dd"),r=PW(t.keystroke),o=[];for(const l of r)o.push(l.map(CW).join(""));return i.innerHTML=t.label,n.innerHTML=o.join(", ")+(t.mayRequireFn&&Ie.isMac?` ${e("(may require <kbd>Fn</kbd>)")}`:""),[i,n]}}function CW(s){return gg(s).split("+").map(t=>`<kbd>${t}</kbd>`).join("+")}function PW(s){return typeof s=="string"?[[s]]:typeof s[0]=="string"?[s]:s}class TW extends F{constructor(){super(...arguments);p(this,"contentView",null)}static get requires(){return[Pl]}static get pluginName(){return"AccessibilityHelp"}static get isOfficialPlugin(){return!0}init(){const e=this.editor,i=e.locale.t;e.ui.componentFactory.add("accessibilityHelp",()=>{const n=this._createButton(ye);return n.set({tooltip:!0,withText:!1,label:i("Accessibility help")}),n}),e.ui.componentFactory.add("menuBar:accessibilityHelp",()=>{const n=this._createButton(ti);return n.label=i("Accessibility"),n}),e.keystrokes.set("Alt+0",(n,r)=>{this._toggleDialog(),r()}),this._setupRootLabels()}_createButton(e){const i=this.editor,n=i.plugins.get("Dialog"),r=i.locale,o=new e(r);return o.set({keystroke:"Alt+0",icon:VC,isToggleable:!0}),o.on("execute",()=>this._toggleDialog()),o.bind("isOn").to(n,"id",l=>l==="accessibilityHelp"),o}_setupRootLabels(){const e=this.editor,i=e.editing.view,n=e.t;e.ui.on("ready",()=>{i.change(o=>{for(const l of i.document.roots)r(o,l)}),e.on("addRoot",(o,l)=>{const a=e.editing.view.document.getRoot(l.rootName);i.change(c=>r(c,a))},{priority:"low"})});function r(o,l){const c=[l.getAttribute("aria-label"),n("Press %0 for help.",[gg("Alt+0")])].filter(h=>h).join(". ");o.setAttribute("aria-label",c,l)}}_toggleDialog(){const e=this.editor,i=e.plugins.get("Dialog"),n=e.locale.t;this.contentView||(this.contentView=new SW(e.locale,e.accessibility.keystrokeInfos)),i.id==="accessibilityHelp"?i.hide():i.show({id:"accessibilityHelp",className:"ck-accessibility-help-dialog",title:n("Accessibility help"),icon:VC,hasCloseButton:!0,content:this.contentView})}}const es=class es extends fi{constructor(e,i=[]){super(i);p(this,"locale");p(this,"_bodyCollectionContainer");this.locale=e}get bodyCollectionContainer(){return this._bodyCollectionContainer}attachToDom(){this._bodyCollectionContainer=new zn({tag:"div",attributes:{class:["ck","ck-reset_all","ck-body","ck-rounded-corners"],dir:this.locale.uiLanguageDirection,role:"application"},children:this}).render(),(!es._bodyWrapper||!es._bodyWrapper.isConnected)&&(es._bodyWrapper=bi(document,"div",{class:"ck-body-wrapper"}),document.body.appendChild(es._bodyWrapper)),es._bodyWrapper.appendChild(this._bodyCollectionContainer)}detachFromDom(){super.destroy(),this._bodyCollectionContainer&&this._bodyCollectionContainer.remove(),es._bodyWrapper&&!es._bodyWrapper.childElementCount&&(es._bodyWrapper.remove(),delete es._bodyWrapper)}};p(es,"_bodyWrapper");let Zb=es;class dd extends ye{constructor(e){super(e);p(this,"toggleSwitchView");this.isToggleable=!0,this.toggleSwitchView=this._createToggleView(),this.extendTemplate({attributes:{class:"ck-switchbutton"}})}render(){super.render(),this.children.add(this.toggleSwitchView)}_createToggleView(){const e=new ue;return e.setTemplate({tag:"span",attributes:{class:["ck","ck-button__toggle"]},children:[{tag:"span",attributes:{class:["ck","ck-button__toggle__inner"]}}]}),e}}class u2 extends gI(ye){}class EW extends gI(Ul){}function gI(s){class t extends s{constructor(...n){super(...n);p(this,"buttonView");p(this,"_fileInputView");this.buttonView=this,this._fileInputView=new AW(this.locale),this._fileInputView.bind("acceptedType").to(this),this._fileInputView.bind("allowMultipleFiles").to(this),this._fileInputView.delegate("done").to(this),this.on("execute",()=>{this._fileInputView.open()}),this.extendTemplate({attributes:{class:"ck-file-dialog-button"}})}render(){super.render(),this.children.add(this._fileInputView)}}return t}class AW extends ue{constructor(t){super(t),this.set("acceptedType",void 0),this.set("allowMultipleFiles",!1);const e=this.bindTemplate;this.setTemplate({tag:"input",attributes:{class:["ck-hidden"],type:"file",tabindex:"-1",accept:e.to("acceptedType"),multiple:e.to("allowMultipleFiles")},on:{change:e.to(()=>{var i,n;(n=(i=this.element)==null?void 0:i.files)!=null&&n.length&&this.fire("done",this.element.files),this.element.value=""})}})}open(){this.element.click()}}class pI extends ue{constructor(e,i){super(e);p(this,"buttonView");p(this,"children");const n=this.bindTemplate;this.set("isCollapsed",!1),this.set("label",""),this.buttonView=this._createButtonView(),this.children=this.createCollection(),this.set("_collapsibleAriaLabelUid",void 0),i&&this.children.addMany(i),this.setTemplate({tag:"div",attributes:{class:["ck","ck-collapsible",n.if("isCollapsed","ck-collapsible_collapsed")]},children:[this.buttonView,{tag:"div",attributes:{class:["ck","ck-collapsible__children"],role:"region",hidden:n.if("isCollapsed","hidden"),"aria-labelledby":n.to("_collapsibleAriaLabelUid")},children:this.children}]})}render(){super.render(),this._collapsibleAriaLabelUid=this.buttonView.labelView.element.id}focus(){this.buttonView.focus()}_createButtonView(){const e=new ye(this.locale),i=e.bindTemplate;return e.set({withText:!0,icon:ud}),e.extendTemplate({attributes:{"aria-expanded":i.to("isOn",n=>String(n))}}),e.bind("label").to(this),e.bind("isOn").to(this,"isCollapsed",n=>!n),e.on("execute",()=>{this.isCollapsed=!this.isCollapsed}),e}}/**
 * @license Copyright (c) 2003-2025, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options
 */function kg(s,t){const e=s.t,i={Black:e("Black"),"Dim grey":e("Dim grey"),Grey:e("Grey"),"Light grey":e("Light grey"),White:e("White"),Red:e("Red"),Orange:e("Orange"),Yellow:e("Yellow"),"Light green":e("Light green"),Green:e("Green"),Aquamarine:e("Aquamarine"),Turquoise:e("Turquoise"),"Light blue":e("Light blue"),Blue:e("Blue"),Purple:e("Purple")};return t.map(n=>{const r=i[n.label];return r&&r!=n.label&&(n.label=r),n})}function Sg(s){return s.map(IW).filter(t=>!!t)}function IW(s){return typeof s=="string"?{model:s,label:s,hasBorder:!1,view:{name:"span",styles:{color:s}}}:{model:s.color,label:s.label||s.color,hasBorder:s.hasBorder===void 0?!1:s.hasBorder,view:{name:"span",styles:{color:`${s.color}`}}}}class wI extends ye{constructor(t){super(t);const e=this.bindTemplate;this.set("color",void 0),this.set("hasBorder",!1),this.icon=YF,this.extendTemplate({attributes:{style:{backgroundColor:e.to("color",i=>Ie.isMediaForcedColors?null:i)},class:["ck","ck-color-grid__tile",e.if("hasBorder","ck-color-selector__color-tile_bordered")]}})}render(){super.render(),this.iconView.fillColor="hsl(0, 0%, 100%)"}}class h2 extends ue{constructor(e,i){super(e);p(this,"columns");p(this,"items");p(this,"focusTracker");p(this,"keystrokes");const n=i&&i.colorDefinitions?i.colorDefinitions:[];this.columns=(i==null?void 0:i.columns)||5;const r={gridTemplateColumns:`repeat( ${this.columns}, 1fr)`};this.set("selectedColor",void 0),this.items=this.createCollection(),this.focusTracker=new ot,this.keystrokes=new wt,this.items.on("add",(o,l)=>{l.isOn=l.color===this.selectedColor}),n.forEach(o=>{const l=new wI;l.set({color:o.color,label:o.label,tooltip:!0,hasBorder:o.options.hasBorder}),l.on("execute",()=>{this.fire("execute",{value:o.color,hasBorder:o.options.hasBorder,label:o.label})}),this.items.add(l)}),this.setTemplate({tag:"div",children:this.items,attributes:{class:["ck","ck-color-grid"],style:r}}),this.on("change:selectedColor",(o,l,a)=>{for(const c of this.items)c.isOn=c.color===a})}focus(){this.items.length&&this.items.first.focus()}focusLast(){this.items.length&&this.items.last.focus()}render(){var e;super.render();for(const i of this.items)this.focusTracker.add(i.element);this.items.on("add",(i,n)=>{this.focusTracker.add(n.element)}),this.items.on("remove",(i,n)=>{this.focusTracker.remove(n.element)}),this.keystrokes.listenTo(this.element),Ep({keystrokeHandler:this.keystrokes,focusTracker:this.focusTracker,gridItems:this.items,numberOfColumns:this.columns,uiLanguageDirection:(e=this.locale)==null?void 0:e.uiLanguageDirection})}destroy(){super.destroy(),this.focusTracker.destroy(),this.keystrokes.destroy()}}/**
 * @license Copyright (c) 2003-2025, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options
 */function xI(s,t){if(!s)return"";const e=bI(s);if(!e)return"";if(e.space===t)return s;if(!LW(e))return"";const n=rI[e.space][t];if(!n)return"";const r=n(e.space==="hex"?e.hexValue:e.values);return MW(r,t)}function RW(s){if(!s)return"";const t=bI(s);return t?t.space==="hex"?t.hexValue:xI(s,"hex"):"#000"}function VW(s,t){customElements.get(s)===void 0&&customElements.define(s,t)}function MW(s,t){switch(t){case"hex":return`#${s}`;case"rgb":return`rgb(${s[0]}, ${s[1]}, ${s[2]})`;case"hsl":return`hsl(${s[0]}, ${s[1]}%, ${s[2]}%)`;case"hwb":return`hwb(${s[0]}, ${s[1]}, ${s[2]})`;case"lab":return`lab(${s[0]}% ${s[1]} ${s[2]})`;case"lch":return`lch(${s[0]}% ${s[1]} ${s[2]})`;default:return""}}function bI(s){if(s.startsWith("#")){const e=HC(s);return{space:"hex",values:e.values,hexValue:s,alpha:e.alpha}}const t=HC(s);return t.space?t:null}function LW(s){return Object.keys(rI).includes(s.space)}class Yt extends ue{constructor(e,i){super(e);p(this,"fieldView");p(this,"labelView");p(this,"statusView");p(this,"fieldWrapperChildren");const n=`ck-labeled-field-view-${ei()}`,r=`ck-labeled-field-view-status-${ei()}`;this.fieldView=i(this,n,r),this.set("label",void 0),this.set("isEnabled",!0),this.set("isEmpty",!0),this.set("isFocused",!1),this.set("errorText",null),this.set("infoText",null),this.set("class",void 0),this.set("placeholder",void 0),this.labelView=this._createLabelView(n),this.statusView=this._createStatusView(r),this.fieldWrapperChildren=this.createCollection([this.fieldView,this.labelView]),this.bind("_statusText").to(this,"errorText",this,"infoText",(l,a)=>l||a);const o=this.bindTemplate;this.setTemplate({tag:"div",attributes:{class:["ck","ck-labeled-field-view",o.to("class"),o.if("isEnabled","ck-disabled",l=>!l),o.if("isEmpty","ck-labeled-field-view_empty"),o.if("isFocused","ck-labeled-field-view_focused"),o.if("placeholder","ck-labeled-field-view_placeholder"),o.if("errorText","ck-error")]},children:[{tag:"div",attributes:{class:["ck","ck-labeled-field-view__input-wrapper"]},children:this.fieldWrapperChildren},this.statusView]})}_createLabelView(e){const i=new ns(this.locale);return i.for=e,i.bind("text").to(this,"label"),i}_createStatusView(e){const i=new ue(this.locale),n=this.bindTemplate;return i.setTemplate({tag:"div",attributes:{class:["ck","ck-labeled-field-view__status",n.if("errorText","ck-labeled-field-view__status_error"),n.if("_statusText","ck-hidden",r=>!r)],id:e,role:n.if("errorText","alert")},children:[{text:n.to("_statusText")}]}),i}focus(e){this.fieldView.focus(e)}}class OI extends ue{constructor(e){super(e);p(this,"focusTracker");this.set("value",void 0),this.set("id",void 0),this.set("placeholder",void 0),this.set("tabIndex",void 0),this.set("isReadOnly",!1),this.set("hasError",!1),this.set("ariaDescribedById",void 0),this.set("ariaLabel",void 0),this.focusTracker=new ot,this.bind("isFocused").to(this.focusTracker),this.set("isEmpty",!0);const i=this.bindTemplate;this.setTemplate({tag:"input",attributes:{class:["ck","ck-input",i.if("isFocused","ck-input_focused"),i.if("isEmpty","ck-input-text_empty"),i.if("hasError","ck-error")],id:i.to("id"),placeholder:i.to("placeholder"),tabindex:i.to("tabIndex"),readonly:i.to("isReadOnly"),"aria-invalid":i.if("hasError",!0),"aria-describedby":i.to("ariaDescribedById"),"aria-label":i.to("ariaLabel")},on:{input:i.to((...n)=>{this.fire("input",...n),this._updateIsEmpty()}),change:i.to(this._updateIsEmpty.bind(this))}})}render(){super.render(),this.focusTracker.add(this.element),this._setDomElementValue(this.value),this._updateIsEmpty(),this.on("change:value",(e,i,n)=>{this._setDomElementValue(n),this._updateIsEmpty()})}destroy(){super.destroy(),this.focusTracker.destroy()}select(){this.element.select()}focus(){this.element.focus()}reset(){this.value=this.element.value="",this._updateIsEmpty()}_updateIsEmpty(){this.isEmpty=BW(this.element)}_setDomElementValue(e){this.element.value=!e&&e!==0?"":e}}function BW(s){return!s.value}class yI extends OI{constructor(t){super(t),this.set("inputMode","text");const e=this.bindTemplate;this.extendTemplate({attributes:{inputmode:e.to("inputMode")}})}}class vI extends yI{constructor(t){super(t),this.extendTemplate({attributes:{type:"text",class:["ck-input-text"]}})}}class $W extends yI{constructor(t,{min:e,max:i,step:n}={}){super(t);const r=this.bindTemplate;this.set("min",e),this.set("max",i),this.set("step",n),this.extendTemplate({attributes:{type:"number",class:["ck-input-number"],min:r.to("min"),max:r.to("max"),step:r.to("step")}})}}class DW extends OI{constructor(e){super(e);p(this,"_resizeObserver");p(this,"_isUpdateAutoGrowHeightPending",!1);const i=No("px");this.set("minRows",2),this.set("maxRows",5),this.set("_height",null),this.set("resize","none"),this._resizeObserver=null,this.on("change:minRows",this._validateMinMaxRows.bind(this)),this.on("change:maxRows",this._validateMinMaxRows.bind(this));const n=this.bindTemplate;this.template.tag="textarea",this.extendTemplate({attributes:{class:["ck-textarea"],style:{height:n.to("_height",r=>r?i(r):null),resize:n.to("resize")},rows:n.to("minRows")}})}render(){super.render();let e=!1;this.on("input",()=>{this._updateAutoGrowHeight(!0),this.fire("update")}),this.on("change:value",()=>{he.window.requestAnimationFrame(()=>{if(!Ls(this.element)){this._isUpdateAutoGrowHeightPending=!0;return}this._updateAutoGrowHeight(),this.fire("update")})}),this._resizeObserver=new yp(this.element,i=>{const n=!!i.contentRect.width&&!!i.contentRect.height;!e&&n&&this._isUpdateAutoGrowHeightPending&&he.window.requestAnimationFrame(()=>{this._updateAutoGrowHeight(),this.fire("update")}),e=n})}destroy(){this._resizeObserver&&this._resizeObserver.destroy()}reset(){super.reset(),this._updateAutoGrowHeight(),this.fire("update")}_updateAutoGrowHeight(e){const i=this.element;if(!i.offsetParent){this._isUpdateAutoGrowHeightPending=!0;return}this._isUpdateAutoGrowHeightPending=!1;const n=d2(i,"1"),r=d2(i,i.value),o=n.ownerDocument.defaultView.getComputedStyle(n),l=parseFloat(o.paddingTop)+parseFloat(o.paddingBottom),a=MO(n),c=parseFloat(o.lineHeight),h=a.top+a.bottom,f=new Ve(n).height,m=Math.round((r.scrollHeight-l)/c),w=this.maxRows*c+l+h,O=m===1?f:this.minRows*c+l+h;this._height=Math.min(Math.max(Math.max(m,this.minRows)*c+l+h,O),w),e&&(i.scrollTop=i.scrollHeight),n.remove(),r.remove()}_validateMinMaxRows(){if(this.minRows>this.maxRows)throw new E("ui-textarea-view-min-rows-greater-than-max-rows",{textareaView:this,minRows:this.minRows,maxRows:this.maxRows})}}function d2(s,t){const e=s.cloneNode();return e.style.position="absolute",e.style.top="-99999px",e.style.left="-99999px",e.style.height="auto",e.style.overflow="hidden",e.style.width=s.ownerDocument.defaultView.getComputedStyle(s).width,e.tabIndex=-1,e.rows=1,e.value=t,s.parentNode.insertBefore(e,s),e}class QW extends ue{constructor(e){super(e);p(this,"children");const i=this.bindTemplate;this.set("isVisible",!1),this.set("position","se"),this.children=this.createCollection(),this.setTemplate({tag:"div",attributes:{class:["ck","ck-reset","ck-dropdown__panel",i.to("position",n=>`ck-dropdown__panel_${n}`),i.if("isVisible","ck-dropdown__panel-visible")],tabindex:"-1"},children:this.children,on:{selectstart:i.to(n=>{n.target.tagName.toLocaleLowerCase()!=="input"&&n.preventDefault()})}})}focus(){if(this.children.length){const e=this.children.first;typeof e.focus=="function"?e.focus():Ue("ui-dropdown-panel-focus-child-missing-focus",{childView:this.children.first,dropdownPanel:this})}}focusLast(){if(this.children.length){const e=this.children.last;typeof e.focusLast=="function"?e.focusLast():e.focus()}}}const Ja=class Ja extends ue{constructor(e,i,n){super(e);p(this,"buttonView");p(this,"panelView");p(this,"focusTracker");p(this,"keystrokes");p(this,"listView");p(this,"toolbarView");p(this,"menuView");const r=this.bindTemplate;this.buttonView=i,this.panelView=n,this.set("isOpen",!1),this.set("isEnabled",!0),this.set("class",void 0),this.set("id",void 0),this.set("panelPosition","auto"),this.panelView.bind("isVisible").to(this,"isOpen"),this.keystrokes=new wt,this.focusTracker=new ot,this.setTemplate({tag:"div",attributes:{class:["ck","ck-dropdown",r.to("class"),r.if("isEnabled","ck-disabled",o=>!o)],id:r.to("id"),"aria-describedby":r.to("ariaDescribedById")},children:[i,n]}),i.extendTemplate({attributes:{class:["ck-dropdown__button"],"data-cke-tooltip-disabled":r.to("isOpen")}})}render(){super.render(),this.focusTracker.add(this.buttonView.element),this.focusTracker.add(this.panelView.element),this.listenTo(this.buttonView,"open",()=>{this.isOpen=!this.isOpen}),this.on("change:isOpen",(i,n,r)=>{if(r)if(this.panelPosition==="auto"){const o=Ja._getOptimalPosition({element:this.panelView.element,target:this.buttonView.element,fitInViewport:!0,positions:this._panelPositions});this.panelView.position=o?o.name:this._defaultPanelPositionName}else this.panelView.position=this.panelPosition}),this.keystrokes.listenTo(this.element);const e=(i,n)=>{this.isOpen&&(this.isOpen=!1,n())};this.keystrokes.set("arrowdown",(i,n)=>{this.buttonView.isEnabled&&!this.isOpen&&(this.isOpen=!0,n())}),this.keystrokes.set("arrowright",(i,n)=>{this.isOpen&&n()}),this.keystrokes.set("arrowleft",e),this.keystrokes.set("esc",e)}focus(){this.buttonView.focus()}get _panelPositions(){const{south:e,north:i,southEast:n,southWest:r,northEast:o,northWest:l,southMiddleEast:a,southMiddleWest:c,northMiddleEast:h,northMiddleWest:f}=Ja.defaultPanelPositions;return this.locale.uiLanguageDirection!=="rtl"?[n,r,a,c,e,o,l,h,f,i]:[r,n,c,a,e,l,o,f,h,i]}get _defaultPanelPositionName(){return this.locale.uiLanguageDirection==="rtl"?"sw":"se"}};p(Ja,"defaultPanelPositions",{south:(e,i)=>({top:e.bottom,left:e.left-(i.width-e.width)/2,name:"s"}),southEast:e=>({top:e.bottom,left:e.left,name:"se"}),southWest:(e,i)=>({top:e.bottom,left:e.left-i.width+e.width,name:"sw"}),southMiddleEast:(e,i)=>({top:e.bottom,left:e.left-(i.width-e.width)/4,name:"sme"}),southMiddleWest:(e,i)=>({top:e.bottom,left:e.left-(i.width-e.width)*3/4,name:"smw"}),north:(e,i)=>({top:e.top-i.height,left:e.left-(i.width-e.width)/2,name:"n"}),northEast:(e,i)=>({top:e.top-i.height,left:e.left,name:"ne"}),northWest:(e,i)=>({top:e.top-i.height,left:e.left-i.width+e.width,name:"nw"}),northMiddleEast:(e,i)=>({top:e.top-i.height,left:e.left-(i.width-e.width)/4,name:"nme"}),northMiddleWest:(e,i)=>({top:e.top-i.height,left:e.left-(i.width-e.width)*3/4,name:"nmw"})}),p(Ja,"_getOptimalPosition",vp);let Hb=Ja;class _I extends ye{constructor(e){super(e);p(this,"arrowView");this.arrowView=this._createArrowView(),this.extendTemplate({attributes:{"aria-haspopup":!0,"aria-expanded":this.bindTemplate.to("isOn",i=>String(i))}}),this.delegate("execute").to(this,"open")}render(){super.render(),this.children.add(this.arrowView)}_createArrowView(){const e=new Zn;return e.content=ud,e.extendTemplate({attributes:{class:"ck-dropdown__arrow"}}),e}}class kI extends ye{constructor(e,i,n){super(e);p(this,"id");this.id=i,this.set({withText:!0,withKeystroke:!0,tooltip:!1,role:"menuitem",label:n}),this.extendTemplate({attributes:{class:["ck-dropdown-menu-list__nested-menu__item__button"]}})}}class NW extends Ul{constructor(e){super(e);p(this,"arrowView");const i=this.bindTemplate;this.set({withText:!0,role:"menuitem"}),this.arrowView=this._createArrowView(),this.extendTemplate({attributes:{class:["ck-dropdown-menu-list__nested-menu__button"],"aria-haspopup":!0,"aria-expanded":this.bindTemplate.to("isOn",n=>String(n)),"data-cke-tooltip-disabled":i.to("isOn")},on:{mouseenter:i.to("mouseenter")}})}render(){super.render(),this.children.add(this.arrowView)}_createArrowView(){const e=new Zn;return e.content=ud,e.extendTemplate({attributes:{class:"ck-dropdown-menu-list__nested-menu__button__arrow"}}),e}}class Sn extends ue{constructor(e){super(e);p(this,"children");const i=this.bindTemplate;this.set("isVisible",!0),this.children=this.createCollection(),this.setTemplate({tag:"li",attributes:{class:["ck","ck-list__item",i.if("isVisible","ck-hidden",n=>!n)],role:"presentation"},children:this.children})}focus(){this.children.first&&this.children.first.focus()}}class ay extends ue{constructor(t){super(t),this.setTemplate({tag:"li",attributes:{class:["ck","ck-list__separator"]}})}}class fh extends ue{constructor(e,i=new ns){super(e);p(this,"labelView");p(this,"items");p(this,"children");const n=this.bindTemplate,r=new Wr(e);this.set({label:"",isVisible:!0}),this.labelView=i,this.labelView.bind("text").to(this,"label"),this.children=this.createCollection(),this.children.addMany([this.labelView,r]),r.set({role:"group",ariaLabelledBy:i.id}),r.focusTracker.destroy(),r.keystrokes.destroy(),this.items=r.items,this.setTemplate({tag:"li",attributes:{role:"presentation",class:["ck","ck-list__group",n.if("isVisible","ck-hidden",o=>!o)]},children:this.children})}focus(){if(this.items){const e=this.items.find(i=>!(i instanceof ay));e&&e.focus()}}}class Wr extends ue{constructor(e){super(e);p(this,"focusables");p(this,"items");p(this,"focusTracker");p(this,"keystrokes");p(this,"_focusCycler");p(this,"_listItemGroupToChangeListeners",new WeakMap);const i=this.bindTemplate;this.focusables=new fi,this.items=this.createCollection(),this.focusTracker=new ot,this.keystrokes=new wt,this._focusCycler=new Ht({focusables:this.focusables,focusTracker:this.focusTracker,keystrokeHandler:this.keystrokes,actions:{focusPrevious:"arrowup",focusNext:"arrowdown"}}),this.set("ariaLabel",void 0),this.set("ariaLabelledBy",void 0),this.set("role",void 0),this.setTemplate({tag:"ul",attributes:{class:["ck","ck-reset","ck-list"],role:i.to("role"),"aria-label":i.to("ariaLabel"),"aria-labelledby":i.to("ariaLabelledBy")},children:this.items})}render(){super.render();for(const e of this.items)e instanceof fh?this._registerFocusableItemsGroup(e):e instanceof Sn&&this._registerFocusableListItem(e);this.items.on("change",(e,i)=>{for(const n of i.removed)n instanceof fh?this._deregisterFocusableItemsGroup(n):n instanceof Sn&&this._deregisterFocusableListItem(n);for(const n of Array.from(i.added).reverse())n instanceof fh?this._registerFocusableItemsGroup(n,i.index):this._registerFocusableListItem(n,i.index)}),this.keystrokes.listenTo(this.element)}destroy(){super.destroy(),this.focusTracker.destroy(),this.keystrokes.destroy()}focus(){this._focusCycler.focusFirst()}focusFirst(){this._focusCycler.focusFirst()}focusLast(){this._focusCycler.focusLast()}_registerFocusableListItem(e,i){this.focusTracker.add(e.element),this.focusables.add(e,i)}_deregisterFocusableListItem(e){this.focusTracker.remove(e.element),this.focusables.remove(e)}_getOnGroupItemsChangeCallback(e){return(i,n)=>{for(const r of n.removed)this._deregisterFocusableListItem(r);for(const r of Array.from(n.added).reverse())this._registerFocusableListItem(r,this.items.getIndex(e)+n.index)}}_registerFocusableItemsGroup(e,i){Array.from(e.items).forEach((r,o)=>{const l=typeof i<"u"?i+o:void 0;this._registerFocusableListItem(r,l)});const n=this._getOnGroupItemsChangeCallback(e);this._listItemGroupToChangeListeners.set(e,n),e.items.on("change",n)}_deregisterFocusableItemsGroup(e){for(const i of e.items)this._deregisterFocusableListItem(i);e.items.off("change",this._listItemGroupToChangeListeners.get(e)),this._listItemGroupToChangeListeners.delete(e)}}class SI extends Wr{constructor(t){super(t);const e=this.bindTemplate;this.role="menu",this.set("isVisible",!0),this.extendTemplate({attributes:{class:["ck-dropdown-menu-list",e.if("isVisible","ck-hidden",i=>!i)]}})}}/**
 * @license Copyright (c) 2003-2025, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options
 */const Yf=5,FW={eastSouth:s=>({top:s.top,left:s.right-Yf,name:"es"}),eastNorth:(s,t)=>({top:s.top-t.height+s.height,left:s.right-Yf,name:"en"}),westSouth:(s,t)=>({top:s.top,left:s.left-t.width+Yf,name:"ws"}),westNorth:(s,t)=>({top:s.top-t.height+s.height,left:s.left-t.width+Yf,name:"wn"})};class CI extends Sn{constructor(e,i,n){super(e);p(this,"childView");const r=this.bindTemplate;this.childView=n,this.children.add(n),this.extendTemplate({attributes:{class:["ck-dropdown-menu-list__nested-menu__item"]},on:{mouseenter:r.to("mouseenter")}}),i&&(this.delegate("mouseenter").to(i),n instanceof kI&&n.delegate("execute").to(i))}}const f2={toggleMenusAndFocusItemsOnHover(s){s.on("menu:mouseenter",t=>{const[e]=t.path;t.source.focus();for(const i of s.menus){const n=e instanceof CI&&e.childView===i;i.isOpen=(t.path.includes(i)||n)&&i.isEnabled}})},closeMenuWhenAnotherOnTheSameLevelOpens(s){s.on("menu:change:isOpen",(t,e,i)=>{if(!i)return;const n=t.source;for(const r of s.menus)n.parentMenuView===r.parentMenuView&&n!==r&&(r.isOpen=!1)})}},Ca={openOnArrowRightKey(s){const t=s.locale.uiLanguageDirection==="rtl"?"arrowleft":"arrowright";s.keystrokes.set(t,(e,i)=>{s.focusTracker.focusedElement!==s.buttonView.element||!s.isEnabled||(s.isOpen||(s.isOpen=!0),s.panelView.focus(),i())})},openOnButtonClick(s){s.buttonView.on("execute",()=>{s.isEnabled&&(s.isOpen=!0)})},openAndFocusOnEnterKeyPress(s){s.keystrokes.set("enter",(t,e)=>{s.focusTracker.focusedElement===s.buttonView.element&&(s.isOpen=!0,s.panelView.focus(),e())})},closeOnArrowLeftKey(s){const t=s.locale.uiLanguageDirection==="rtl"?"arrowright":"arrowleft";s.keystrokes.set(t,(e,i)=>{s.isOpen&&(s.focus(),s.isOpen=!1,i())})},closeOnEscKey(s){s.keystrokes.set("esc",(t,e)=>{s.isOpen&&(s.focus(),s.isOpen=!1,e())})},closeOnParentClose(s,t){t.on("change:isOpen",(e,i,n)=>{!n&&e.source===t&&(s.isOpen=!1)})}},m2=No("px"),zW={top:-99999,left:-99999,name:"arrowless",config:{withArrow:!1}},Ln=class Ln extends ue{constructor(e){super(e);p(this,"content");p(this,"_pinWhenIsVisibleCallback");p(this,"_resizeObserver");const i=this.bindTemplate;this.set("top",0),this.set("left",0),this.set("position","arrow_nw"),this.set("isVisible",!1),this.set("withArrow",!0),this.set("class",void 0),this._pinWhenIsVisibleCallback=null,this._resizeObserver=null,this.content=this.createCollection(),this.setTemplate({tag:"div",attributes:{class:["ck","ck-balloon-panel",i.to("position",n=>`ck-balloon-panel_${n}`),i.if("isVisible","ck-balloon-panel_visible"),i.if("withArrow","ck-balloon-panel_with-arrow"),i.to("class")],style:{top:i.to("top",m2),left:i.to("left",m2)}},children:this.content})}destroy(){this.hide(),super.destroy()}show(){this.isVisible=!0}hide(){this.isVisible=!1}attachTo(e){const i=$m(e.target);if(i&&!Ls(i))return!1;this.show();const n=Ln.defaultPositions,r=Object.assign({},{element:this.element,positions:[n.southArrowNorth,n.southArrowNorthMiddleWest,n.southArrowNorthMiddleEast,n.southArrowNorthWest,n.southArrowNorthEast,n.northArrowSouth,n.northArrowSouthMiddleWest,n.northArrowSouthMiddleEast,n.northArrowSouthWest,n.northArrowSouthEast,n.viewportStickyNorth],limiter:he.document.body,fitInViewport:!0},e),o=Ln._getOptimalPosition(r)||zW,l=parseInt(o.left),a=parseInt(o.top),c=o.name,h=o.config||{},{withArrow:f=!0}=h;return this.top=a,this.left=l,this.position=c,this.withArrow=f,!0}pin(e){this.unpin(),this._startPinning(e)&&(this._pinWhenIsVisibleCallback=()=>{this.isVisible?this._startPinning(e):this._stopPinning()},this.listenTo(this,"change:isVisible",this._pinWhenIsVisibleCallback))}unpin(){this._pinWhenIsVisibleCallback&&(this._stopPinning(),this.stopListening(this,"change:isVisible",this._pinWhenIsVisibleCallback),this._pinWhenIsVisibleCallback=null,this.hide())}_startPinning(e){if(!this.attachTo(e))return!1;let i=$m(e.target);const n=e.limiter?$m(e.limiter):he.document.body;if(this.listenTo(he.document,"scroll",(r,o)=>{const l=o.target,a=i&&l.contains(i),c=n&&l.contains(n);(a||c||!i||!n)&&this.attachTo(e)},{useCapture:!0}),this.listenTo(he.window,"resize",()=>{this.attachTo(e)}),!this._resizeObserver&&(i&&Lt(i)&&(i=i.parentElement),i)){const r=()=>{Ls(i)||this.unpin()};this._resizeObserver=new yp(i,r)}return!0}_stopPinning(){this.stopListening(he.document,"scroll"),this.stopListening(he.window,"resize"),this._resizeObserver&&(this._resizeObserver.destroy(),this._resizeObserver=null)}static generatePositions(e={}){const{sideOffset:i=Ln.arrowSideOffset,heightOffset:n=Ln.arrowHeightOffset,stickyVerticalOffset:r=Ln.stickyVerticalOffset,config:o}=e;return{northWestArrowSouthWest:(c,h)=>({top:l(c,h),left:c.left-i,name:"arrow_sw",...o&&{config:o}}),northWestArrowSouthMiddleWest:(c,h)=>({top:l(c,h),left:c.left-h.width*.25-i,name:"arrow_smw",...o&&{config:o}}),northWestArrowSouth:(c,h)=>({top:l(c,h),left:c.left-h.width/2,name:"arrow_s",...o&&{config:o}}),northWestArrowSouthMiddleEast:(c,h)=>({top:l(c,h),left:c.left-h.width*.75+i,name:"arrow_sme",...o&&{config:o}}),northWestArrowSouthEast:(c,h)=>({top:l(c,h),left:c.left-h.width+i,name:"arrow_se",...o&&{config:o}}),northArrowSouthWest:(c,h)=>({top:l(c,h),left:c.left+c.width/2-i,name:"arrow_sw",...o&&{config:o}}),northArrowSouthMiddleWest:(c,h)=>({top:l(c,h),left:c.left+c.width/2-h.width*.25-i,name:"arrow_smw",...o&&{config:o}}),northArrowSouth:(c,h)=>({top:l(c,h),left:c.left+c.width/2-h.width/2,name:"arrow_s",...o&&{config:o}}),northArrowSouthMiddleEast:(c,h)=>({top:l(c,h),left:c.left+c.width/2-h.width*.75+i,name:"arrow_sme",...o&&{config:o}}),northArrowSouthEast:(c,h)=>({top:l(c,h),left:c.left+c.width/2-h.width+i,name:"arrow_se",...o&&{config:o}}),northEastArrowSouthWest:(c,h)=>({top:l(c,h),left:c.right-i,name:"arrow_sw",...o&&{config:o}}),northEastArrowSouthMiddleWest:(c,h)=>({top:l(c,h),left:c.right-h.width*.25-i,name:"arrow_smw",...o&&{config:o}}),northEastArrowSouth:(c,h)=>({top:l(c,h),left:c.right-h.width/2,name:"arrow_s",...o&&{config:o}}),northEastArrowSouthMiddleEast:(c,h)=>({top:l(c,h),left:c.right-h.width*.75+i,name:"arrow_sme",...o&&{config:o}}),northEastArrowSouthEast:(c,h)=>({top:l(c,h),left:c.right-h.width+i,name:"arrow_se",...o&&{config:o}}),southWestArrowNorthWest:c=>({top:a(c),left:c.left-i,name:"arrow_nw",...o&&{config:o}}),southWestArrowNorthMiddleWest:(c,h)=>({top:a(c),left:c.left-h.width*.25-i,name:"arrow_nmw",...o&&{config:o}}),southWestArrowNorth:(c,h)=>({top:a(c),left:c.left-h.width/2,name:"arrow_n",...o&&{config:o}}),southWestArrowNorthMiddleEast:(c,h)=>({top:a(c),left:c.left-h.width*.75+i,name:"arrow_nme",...o&&{config:o}}),southWestArrowNorthEast:(c,h)=>({top:a(c),left:c.left-h.width+i,name:"arrow_ne",...o&&{config:o}}),southArrowNorthWest:c=>({top:a(c),left:c.left+c.width/2-i,name:"arrow_nw",...o&&{config:o}}),southArrowNorthMiddleWest:(c,h)=>({top:a(c),left:c.left+c.width/2-h.width*.25-i,name:"arrow_nmw",...o&&{config:o}}),southArrowNorth:(c,h)=>({top:a(c),left:c.left+c.width/2-h.width/2,name:"arrow_n",...o&&{config:o}}),southArrowNorthMiddleEast:(c,h)=>({top:a(c),left:c.left+c.width/2-h.width*.75+i,name:"arrow_nme",...o&&{config:o}}),southArrowNorthEast:(c,h)=>({top:a(c),left:c.left+c.width/2-h.width+i,name:"arrow_ne",...o&&{config:o}}),southEastArrowNorthWest:c=>({top:a(c),left:c.right-i,name:"arrow_nw",...o&&{config:o}}),southEastArrowNorthMiddleWest:(c,h)=>({top:a(c),left:c.right-h.width*.25-i,name:"arrow_nmw",...o&&{config:o}}),southEastArrowNorth:(c,h)=>({top:a(c),left:c.right-h.width/2,name:"arrow_n",...o&&{config:o}}),southEastArrowNorthMiddleEast:(c,h)=>({top:a(c),left:c.right-h.width*.75+i,name:"arrow_nme",...o&&{config:o}}),southEastArrowNorthEast:(c,h)=>({top:a(c),left:c.right-h.width+i,name:"arrow_ne",...o&&{config:o}}),westArrowEast:(c,h)=>({top:c.top+c.height/2-h.height/2,left:c.left-h.width-n,name:"arrow_e",...o&&{config:o}}),eastArrowWest:(c,h)=>({top:c.top+c.height/2-h.height/2,left:c.right+n,name:"arrow_w",...o&&{config:o}}),viewportStickyNorth:(c,h,f)=>{const m=new Ve(he.document.body).getIntersection(f.getVisible());if(!m)return null;const w=m.getVisible();return!c.getIntersection(w)||!(w.top-c.top-r<h.height&&w.bottom-c.bottom<h.height)?null:{top:w.top+r,left:c.left+c.width/2-h.width/2,name:"arrowless",config:{withArrow:!1,...o}}}};function l(c,h){return c.top-h.height-n}function a(c){return c.bottom+n}}};p(Ln,"arrowSideOffset",25),p(Ln,"arrowHeightOffset",10),p(Ln,"stickyVerticalOffset",20),p(Ln,"_getOptimalPosition",vp),p(Ln,"defaultPositions",Ln.generatePositions());let Fi=Ln;function $m(s){return Ao(s)?s:Op(s)?s.commonAncestorContainer:typeof s=="function"?$m(s()):null}class WW extends Fi{constructor(t){super(t);const e=this.bindTemplate;this.set({isVisible:!1,position:"se",class:null,top:0,left:0}),this.extendTemplate({tag:"div",attributes:{class:["ck-reset","ck-dropdown-menu__nested-menu__panel"],tabindex:"-1"},on:{selectstart:e.to(i=>{i.target.tagName.toLocaleLowerCase()!=="input"&&i.preventDefault()})}})}focus(t=1){const{content:e}=this;e.length&&(t===1?e.first.focus():e.last.focus())}}const gp=class gp extends ue{constructor(e,i,n,r,o){super(e);p(this,"id");p(this,"buttonView");p(this,"panelView");p(this,"listView");p(this,"focusTracker");p(this,"keystrokes");p(this,"_bodyCollection");this._bodyCollection=i,this.id=n,this.set({isOpen:!1,isEnabled:!0,panelPosition:"w",class:void 0,parentMenuView:null}),this.keystrokes=new wt,this.focusTracker=new ot,this.buttonView=new NW(e),this.buttonView.delegate("mouseenter").to(this),this.buttonView.bind("isOn","isEnabled").to(this,"isOpen","isEnabled"),this.buttonView.label=r,this.panelView=new WW(e),this.panelView.isVisible=!0,this.listView=new SI(e),this.listView.bind("ariaLabel").to(this.buttonView,"label"),this.panelView.content.add(this.listView);const l=this.bindTemplate;this.setTemplate({tag:"div",attributes:{class:["ck","ck-dropdown-menu-list__nested-menu",l.to("class"),l.if("isEnabled","ck-disabled",a=>!a)],role:"presentation"},children:[this.buttonView]}),this.parentMenuView=o,this.parentMenuView&&this._handleParentMenuView(),this._attachBehaviors()}get _panelPositions(){const{westSouth:e,eastSouth:i,westNorth:n,eastNorth:r}=FW;return this.locale.uiLanguageDirection==="ltr"?[i,r,e,n]:[e,n,i,r]}render(){super.render(),this.panelView.render(),this.focusTracker.add(this.buttonView.element),this.focusTracker.add(this.panelView.element),this.focusTracker.add(this.listView),this.keystrokes.listenTo(this.element),this._mountPanelOnOpen()}destroy(){this._removePanelFromBody(),this.panelView.destroy(),super.destroy()}focus(){this.buttonView.focus()}_handleParentMenuView(){this.delegate(...gp.DELEGATED_EVENTS).to(this.parentMenuView),Ca.closeOnParentClose(this,this.parentMenuView)}_attachBehaviors(){Ca.openOnButtonClick(this),Ca.openAndFocusOnEnterKeyPress(this),Ca.openOnArrowRightKey(this),Ca.closeOnEscKey(this),Ca.closeOnArrowLeftKey(this)}_mountPanelOnOpen(){const{panelView:e}=this;this.on("change:isOpen",(i,n,r)=>{if(i.source===this){if(!r&&this._bodyCollection.has(e)){this._removePanelFromBody();return}r&&!this._bodyCollection.has(e)&&this._addPanelToBody()}})}_removePanelFromBody(){const{panelView:e,keystrokes:i}=this;this._bodyCollection.has(e)&&(this._bodyCollection.remove(e),i.stopListening(e.element))}_addPanelToBody(){const{panelView:e,buttonView:i,keystrokes:n}=this;this._bodyCollection.has(e)||(this._bodyCollection.add(e),n.listenTo(e.element),e.pin({positions:this._panelPositions,limiter:he.document.body,element:e.element,target:i.element,fitInViewport:!0}))}};p(gp,"DELEGATED_EVENTS",["mouseenter","execute","change:isOpen"]);let Cg=gp;class UW extends SI{constructor(e,i,n){super(e);p(this,"_definition");p(this,"_cachedMenus",[]);p(this,"_cachedButtons",[]);p(this,"_bodyCollection");this._bodyCollection=i,this._definition=n,this.set("menuPanelClass",void 0)}get menus(){return Array.from(this._cachedMenus.values())}get buttons(){return Array.from(this._cachedButtons.values())}render(){this._createStructure(this._definition,null),super.render(),f2.toggleMenusAndFocusItemsOnHover(this),f2.closeMenuWhenAnotherOnTheSameLevelOpens(this)}closeMenus(){this.menus.forEach(e=>{e.isOpen=!1})}_createStructure(e,i){const n=[];for(const o of e){let l;"menu"in o?(l=new Cg(this.locale,this._bodyCollection,o.id,o.menu,i),l.panelView.bind("class").to(this,"menuPanelClass"),i||l.delegate(...Cg.DELEGATED_EVENTS).to(this,c=>`menu:${c}`),this._cachedMenus.push(l),this._createStructure(o.children,l)):(l=new kI(this.locale,o.id,o.label),i||l.delegate("execute").to(this,"menu:execute"),this._cachedButtons.push(l));const a=new CI(this.locale,i,l);i||a.delegate("mouseenter").to(this,"menu:mouseenter"),n.push(a)}(i?i.listView:this).items.addMany(n)}}class PI extends ue{constructor(t){super(t),this.setTemplate({tag:"span",attributes:{class:["ck","ck-toolbar__separator"]}})}}class ZW extends ue{constructor(t){super(t),this.setTemplate({tag:"span",attributes:{class:["ck","ck-toolbar__line-break"]}})}}/**
 * @license Copyright (c) 2003-2025, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options
 */function HW(s){return s.bindTemplate.to(t=>{t.target===s.element&&t.preventDefault()})}/**
 * @license Copyright (c) 2003-2025, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options
 */function TI(s){if(Array.isArray(s))return{items:s,removeItems:[]};const t={items:[],removeItems:[]};return s?{...t,...s}:t}const qW={alignLeft:jA,bold:XA,importExport:az,paragraph:Cz,plus:Tz,text:Fz,threeVerticalDots:ny,pilcrow:Pz,dragIndicator:JF};class Vo extends ue{constructor(e,i){super(e);p(this,"options");p(this,"items");p(this,"focusTracker");p(this,"keystrokes");p(this,"itemsView");p(this,"children");p(this,"focusables");p(this,"_focusCycler");p(this,"_behavior");const n=this.bindTemplate,r=this.t;this.options=i||{},this.set("ariaLabel",r("Editor toolbar")),this.set("maxWidth","auto"),this.set("role","toolbar"),this.set("isGrouping",!!this.options.shouldGroupWhenFull),this.items=this.createCollection(),this.focusTracker=new ot,this.keystrokes=new wt,this.set("class",void 0),this.set("isCompact",!1),this.set("isVertical",!1),this.itemsView=new jW(e),this.children=this.createCollection(),this.children.add(this.itemsView),this.focusables=this.createCollection();const o=e.uiLanguageDirection==="rtl";this._focusCycler=new Ht({focusables:this.focusables,focusTracker:this.focusTracker,keystrokeHandler:this.keystrokes,actions:{focusPrevious:[o?"arrowright":"arrowleft","arrowup"],focusNext:[o?"arrowleft":"arrowright","arrowdown"]}});const l=["ck","ck-toolbar",n.to("class"),n.if("isCompact","ck-toolbar_compact"),n.if("isGrouping","ck-toolbar_grouping"),n.if("isVertical","ck-toolbar_vertical")];this.options.shouldGroupWhenFull&&this.options.isFloating&&l.push("ck-toolbar_floating"),this.setTemplate({tag:"div",attributes:{class:l,role:n.to("role"),"aria-label":n.to("ariaLabel"),style:{maxWidth:n.to("maxWidth")},tabindex:-1},children:this.children,on:{mousedown:HW(this)}}),this._behavior=this.options.shouldGroupWhenFull?new p2(this):new g2(this)}render(){super.render(),this.focusTracker.add(this.element);for(const e of this.items)this.focusTracker.add(e);this.items.on("add",(e,i)=>{this.focusTracker.add(i)}),this.items.on("remove",(e,i)=>{this.focusTracker.remove(i)}),this.keystrokes.listenTo(this.element),this._behavior.render(this)}destroy(){return this._behavior.destroy(),this.focusTracker.destroy(),this.keystrokes.destroy(),super.destroy()}focus(){this._focusCycler.focusFirst()}focusLast(){this._focusCycler.focusLast()}fillFromConfig(e,i,n){this.items.addMany(this._buildItemsFromConfig(e,i,n))}switchBehavior(e){this._behavior.type!==e&&(this._behavior.destroy(),this.itemsView.children.clear(),this.focusables.clear(),e==="dynamic"?(this._behavior=new p2(this),this._behavior.render(this),this._behavior.refreshItems()):(this._behavior=new g2(this),this._behavior.render(this)))}_buildItemsFromConfig(e,i,n){const r=TI(e),o=n||r.removeItems;return this._cleanItemsConfiguration(r.items,i,o).map(a=>ds(a)?this._createNestedToolbarDropdown(a,i,o):a==="|"?new PI:a==="-"?new ZW:i.create(a)).filter(a=>!!a)}_cleanItemsConfiguration(e,i,n){const r=e.filter((o,l,a)=>o==="|"?!0:n.indexOf(o)!==-1?!1:o==="-"?this.options.shouldGroupWhenFull?(Ue("toolbarview-line-break-ignored-when-grouping-items",a),!1):!0:!ds(o)&&!i.has(o)?(Ue("toolbarview-item-unavailable",{item:o}),!1):!0);return this._cleanSeparatorsAndLineBreaks(r)}_cleanSeparatorsAndLineBreaks(e){const i=l=>l!=="-"&&l!=="|",n=e.length,r=e.findIndex(i);if(r===-1)return[];const o=n-e.slice().reverse().findIndex(i);return e.slice(r,o).filter((l,a,c)=>i(l)?!0:!(a>0&&c[a-1]===l))}_createNestedToolbarDropdown(e,i,n){let{label:r,icon:o,items:l,tooltip:a=!0,withText:c=!1}=e;if(l=this._cleanItemsConfiguration(l,i,n),!l.length)return null;const h=this.locale,f=nn(h);return r||Ue("toolbarview-nested-toolbar-dropdown-missing-label",e),f.class="ck-toolbar__nested-toolbar-dropdown",f.buttonView.set({label:r,tooltip:a,withText:!!c}),o!==!1?f.buttonView.icon=qW[o]||o||ny:f.buttonView.withText=!0,cy(f,()=>f.toolbarView._buildItemsFromConfig(l,i,n)),f}}class jW extends ue{constructor(e){super(e);p(this,"children");this.children=this.createCollection(),this.setTemplate({tag:"div",attributes:{class:["ck","ck-toolbar__items"]},children:this.children})}}class g2{constructor(t){p(this,"type","static");t.isGrouping=!1,t.itemsView.children.bindTo(t.items).using(e=>e),t.focusables.bindTo(t.items).using(e=>Rc(e)?e:null)}render(){}destroy(){}}class p2{constructor(t){p(this,"type","dynamic");p(this,"view");p(this,"viewChildren");p(this,"viewFocusables");p(this,"viewItemsView");p(this,"viewFocusTracker");p(this,"viewLocale");p(this,"ungroupedItems");p(this,"groupedItems");p(this,"groupedItemsDropdown");p(this,"resizeObserver",null);p(this,"cachedPadding",null);p(this,"shouldUpdateGroupingOnNextResize",!1);p(this,"viewElement");this.view=t,this.viewChildren=t.children,this.viewFocusables=t.focusables,this.viewItemsView=t.itemsView,this.viewFocusTracker=t.focusTracker,this.viewLocale=t.locale,this.view.isGrouping=!0,this.ungroupedItems=t.createCollection(),this.groupedItems=t.createCollection(),this.groupedItemsDropdown=this._createGroupedItemsDropdown(),t.itemsView.children.bindTo(this.ungroupedItems).using(e=>e),this.ungroupedItems.on("change",this._updateFocusCyclableItems.bind(this)),t.children.on("change",this._updateFocusCyclableItems.bind(this)),t.items.on("change",(e,i)=>{const n=i.index,r=Array.from(i.added);for(const o of i.removed)n>=this.ungroupedItems.length?this.groupedItems.remove(o):this.ungroupedItems.remove(o);for(let o=n;o<n+r.length;o++){const l=r[o-n];o>this.ungroupedItems.length?this.groupedItems.add(l,o-this.ungroupedItems.length):this.ungroupedItems.add(l,o)}this._updateGrouping()})}render(t){this.viewElement=t.element,this._enableGroupingOnResize(),this._enableGroupingOnMaxWidthChange(t)}destroy(){this.groupedItemsDropdown.destroy(),this.viewChildren.length>1&&(this.viewChildren.remove(this.groupedItemsDropdown),this.viewChildren.remove(this.viewChildren.last)),this.resizeObserver.destroy()}refreshItems(){const t=this.view;if(t.items.length){for(let e=0;e<t.items.length;e++){const i=[...t.items][e];this.ungroupedItems.add(i,e)}this._updateGrouping()}}_updateGrouping(){if(!this.viewElement.ownerDocument.body.contains(this.viewElement))return;if(!Ls(this.viewElement)){this.shouldUpdateGroupingOnNextResize=!0;return}const t=this.groupedItems.length;let e;for(;this._areItemsOverflowing;)this._groupLastItem(),e=!0;if(!e&&this.groupedItems.length){for(;this.groupedItems.length&&!this._areItemsOverflowing;)this._ungroupFirstItem();this._areItemsOverflowing&&this._groupLastItem()}this.groupedItems.length!==t&&this.view.fire("groupedItemsUpdate")}get _areItemsOverflowing(){if(!this.ungroupedItems.length)return!1;const t=this.viewElement,e=this.viewLocale.uiLanguageDirection,i=new Ve(t.lastChild),n=new Ve(t);if(!this.cachedPadding){const r=he.window.getComputedStyle(t),o=e==="ltr"?"paddingRight":"paddingLeft";this.cachedPadding=Number.parseInt(r[o])}return e==="ltr"?i.right>n.right-this.cachedPadding:i.left<n.left+this.cachedPadding}_enableGroupingOnResize(){let t;this.resizeObserver=new yp(this.viewElement,e=>{(!t||t!==e.contentRect.width||this.shouldUpdateGroupingOnNextResize)&&(this.shouldUpdateGroupingOnNextResize=!1,this._updateGrouping(),t=e.contentRect.width)}),this._updateGrouping()}_enableGroupingOnMaxWidthChange(t){t.on("change:maxWidth",()=>{this._updateGrouping()})}_groupLastItem(){this.groupedItems.length||(this.viewChildren.add(new PI),this.viewChildren.add(this.groupedItemsDropdown),this.viewFocusTracker.add(this.groupedItemsDropdown.element)),this.groupedItems.add(this.ungroupedItems.remove(this.ungroupedItems.last),0)}_ungroupFirstItem(){this.ungroupedItems.add(this.groupedItems.remove(this.groupedItems.first)),this.groupedItems.length||(this.viewChildren.remove(this.groupedItemsDropdown),this.viewChildren.remove(this.viewChildren.last),this.viewFocusTracker.remove(this.groupedItemsDropdown.element))}_createGroupedItemsDropdown(){const t=this.viewLocale,e=t.t,i=nn(t);return i.class="ck-toolbar__grouped-dropdown",i.panelPosition=t.uiLanguageDirection==="ltr"?"sw":"se",cy(i,this.groupedItems),i.buttonView.set({label:e("Show more items"),tooltip:!0,tooltipPosition:t.uiLanguageDirection==="rtl"?"se":"sw",icon:ny}),i}_updateFocusCyclableItems(){this.viewFocusables.clear(),this.ungroupedItems.map(t=>{Rc(t)&&this.viewFocusables.add(t)}),this.groupedItems.length&&this.viewFocusables.add(this.groupedItemsDropdown)}}class Vc extends ue{constructor(e,i){super(e);p(this,"children");p(this,"actionView");p(this,"arrowView");p(this,"keystrokes");p(this,"focusTracker");const n=this.bindTemplate;this.set("class",void 0),this.set("labelStyle",void 0),this.set("icon",void 0),this.set("isEnabled",!0),this.set("isOn",!1),this.set("isToggleable",!1),this.set("isVisible",!0),this.set("keystroke",void 0),this.set("withKeystroke",!1),this.set("label",void 0),this.set("tabindex",-1),this.set("tooltip",!1),this.set("tooltipPosition","s"),this.set("type","button"),this.set("withText",!1),this.children=this.createCollection(),this.actionView=this._createActionView(i),this.arrowView=this._createArrowView(),this.keystrokes=new wt,this.focusTracker=new ot,this.setTemplate({tag:"div",attributes:{class:["ck","ck-splitbutton",n.to("class"),n.if("isVisible","ck-hidden",r=>!r),this.arrowView.bindTemplate.if("isOn","ck-splitbutton_open")]},children:this.children})}render(){super.render(),this.children.add(this.actionView),this.children.add(this.arrowView),this.focusTracker.add(this.actionView.element),this.focusTracker.add(this.arrowView.element),this.keystrokes.listenTo(this.element),this.keystrokes.set("arrowright",(e,i)=>{this.focusTracker.focusedElement===this.actionView.element&&(this.arrowView.focus(),i())}),this.keystrokes.set("arrowleft",(e,i)=>{this.focusTracker.focusedElement===this.arrowView.element&&(this.actionView.focus(),i())})}destroy(){super.destroy(),this.focusTracker.destroy(),this.keystrokes.destroy()}focus(){this.actionView.focus()}_createActionView(e){const i=e||new ye;return e||i.bind("icon","isEnabled","isOn","isToggleable","keystroke","label","tabindex","tooltip","tooltipPosition","type","withText").to(this),i.extendTemplate({attributes:{class:"ck-splitbutton__action"}}),i.delegate("execute").to(this),i}_createArrowView(){const e=new ye,i=e.bindTemplate;return e.icon=ud,e.extendTemplate({attributes:{class:["ck-splitbutton__arrow"],"data-cke-tooltip-disabled":i.to("isOn"),"aria-haspopup":!0,"aria-expanded":i.to("isOn",n=>String(n))}}),e.bind("isEnabled").to(this),e.bind("label").to(this),e.bind("tooltip").to(this),e.delegate("execute").to(this,"open"),e}}function nn(s,t=_I){const e=typeof t=="function"?new t(s):t,i=new QW(s),n=new Hb(s,e,i);return e.bind("isEnabled").to(n),e instanceof Vc?e.arrowView.bind("isOn").to(n,"isOpen"):e.bind("isOn").to(n,"isOpen"),GW(n),n}function XW(s,t,e,i={}){s.menuView=new UW(s.locale,t,e),s.focusTracker.add(s.menuView),s.isOpen?w2(s,i):s.once("change:isOpen",()=>{w2(s,i)},{priority:"highest"})}function w2(s,t){const e=s.menuView,i=s.locale.t;e.delegate("menu:execute").to(s,"execute"),e.listenTo(s,"change:isOpen",(n,r,o)=>{o||e.closeMenus()},{priority:"low"}),s.panelView.children.add(e);for(const n of e.menus)s.focusTracker.add(n);e.ariaLabel=t.ariaLabel||i("Dropdown menu")}function cy(s,t,e={}){s.extendTemplate({attributes:{class:["ck-toolbar-dropdown"]}}),s.isOpen?x2(s,t,e):s.once("change:isOpen",()=>x2(s,t,e),{priority:"highest"}),e.enableActiveItemFocusOnDropdownOpen&&uy(s,()=>s.toolbarView.items.find(i=>i.isOn))}function x2(s,t,e){const i=s.locale,n=i.t,r=s.toolbarView=new Vo(i),o=typeof t=="function"?t():t;r.ariaLabel=e.ariaLabel||n("Dropdown toolbar"),e.maxWidth&&(r.maxWidth=e.maxWidth),e.class&&(r.class=e.class),e.isCompact&&(r.isCompact=e.isCompact),e.isVertical&&(r.isVertical=!0),o instanceof fi?r.items.bindTo(o).using(l=>l):r.items.addMany(o),s.panelView.children.add(r),s.focusTracker.add(r),r.items.delegate("execute").to(s)}function Zl(s,t,e={}){s.isOpen?b2(s,t,e):s.once("change:isOpen",()=>b2(s,t,e),{priority:"highest"}),uy(s,()=>s.listView.items.find(i=>i instanceof Sn?i.children.first.isOn:!1))}function b2(s,t,e){const i=s.locale,n=s.listView=new Wr(i),r=typeof t=="function"?t():t;n.ariaLabel=e.ariaLabel,n.role=e.role,AI(s,n.items,r,i),s.panelView.children.add(n),n.items.delegate("execute").to(s)}function uy(s,t){s.on("change:isOpen",()=>{if(!s.isOpen)return;const e=t();e&&(typeof e.focus=="function"?e.focus():Ue("ui-dropdown-focus-child-on-open-child-missing-focus",{view:e}))},{priority:Ji.low-10})}function GW(s){YW(s),KW(s),JW(s),eU(s),tU(s),iU(s)}function YW(s){Fr({emitter:s,activator:()=>s.isRendered&&s.isOpen,callback:()=>{s.isOpen=!1},contextElements:()=>[s.element,...EI(s.focusTracker).filter(t=>!s.element.contains(t))]})}function EI(s){return[...s.elements,...s.externalViews.flatMap(t=>EI(t.focusTracker))]}function KW(s){s.on("execute",t=>{t.source instanceof dd||(s.isOpen=!1)})}function JW(s){s.focusTracker.on("change:isFocused",(t,e,i)=>{i||!s.isOpen||(s.isOpen=!1)})}function eU(s){s.keystrokes.set("arrowdown",(t,e)=>{s.isOpen&&(s.panelView.focus(),e())}),s.keystrokes.set("arrowup",(t,e)=>{s.isOpen&&(s.panelView.focusLast(),e())})}function tU(s){s.on("change:isOpen",(t,e,i)=>{if(i)return;s.focusTracker.elements.some(r=>r.contains(he.document.activeElement))&&s.buttonView.focus()})}function iU(s){s.on("change:isOpen",(t,e,i)=>{i&&s.panelView.focus()},{priority:"low"})}function AI(s,t,e,i){nU(t),t.bindTo(e).using(n=>{if(n.type==="separator")return new ay(i);if(n.type==="group"){const r=new fh(i);return r.set({label:n.label}),AI(s,r.items,n.items,i),r.items.delegate("execute").to(s),r}else if(n.type==="button"||n.type==="switchbutton"){const r=n.model.role==="menuitemcheckbox"||n.model.role==="menuitemradio",o=new Sn(i);let l;return n.type==="button"?(l=new Ul(i),l.set({isToggleable:r})):l=new dd(i),l.bind(...Object.keys(n.model)).to(n.model),l.delegate("execute").to(o),o.children.add(l),o}return null})}function nU(s){let t=0;const e=r=>!(r instanceof Sn)||!(r.children.first instanceof Ul)?null:r.children.first,i=r=>{const o=e(r);return!o||!o.isToggleable?null:o},n=r=>{for(const o of s){const l=e(o);l&&(l.hasCheckSpace=r)}};s.on("change",(r,o)=>{const l=t>0;for(const c of o.removed)i(c)&&t--;for(const c of o.added){const h=e(c);h&&(h.isToggleable&&t++,h.hasCheckSpace=t>0)}const a=t>0;l!==a&&n(a)})}const On=(s,t,e)=>{const i=new vI(s.locale);return i.set({id:t,ariaDescribedById:e}),i.bind("isReadOnly").to(s,"isEnabled",n=>!n),i.bind("hasError").to(s,"errorText",n=>!!n),i.on("input",()=>{s.errorText=null}),s.bind("isEmpty","isFocused","placeholder").to(i),i},II=(s,t,e)=>{const i=new $W(s.locale);return i.set({id:t,ariaDescribedById:e,inputMode:"numeric"}),i.bind("isReadOnly").to(s,"isEnabled",n=>!n),i.bind("hasError").to(s,"errorText",n=>!!n),i.on("input",()=>{s.errorText=null}),s.bind("isEmpty","isFocused","placeholder").to(i),i},sU=(s,t,e)=>{const i=new DW(s.locale);return i.set({id:t,ariaDescribedById:e}),i.bind("isReadOnly").to(s,"isEnabled",n=>!n),i.bind("hasError").to(s,"errorText",n=>!!n),i.on("input",()=>{s.errorText=null}),s.bind("isEmpty","isFocused","placeholder").to(i),i},RI=(s,t,e)=>{const i=nn(s.locale);return i.set({id:t,ariaDescribedById:e}),i.bind("isEnabled").to(s),i},rU=150;class oU extends ue{constructor(e,i={}){super(e);p(this,"hexInputRow");p(this,"_debounceColorPickerEvent");p(this,"_config");this.set({color:"",_hexColor:""}),this.hexInputRow=this._createInputRow();const n=this.createCollection();i.hideInput||n.add(this.hexInputRow),this.setTemplate({tag:"div",attributes:{class:["ck","ck-color-picker"],tabindex:-1},children:n}),this._config=i,this._debounceColorPickerEvent=fs(r=>{this.set("color",r),this.fire("colorSelected",{color:this.color})},rU,{leading:!0}),this.on("set:color",(r,o,l)=>{r.return=xI(l,this._config.format||"hsl")}),this.on("change:color",()=>{this._hexColor=dx(this.color)}),this.on("change:_hexColor",()=>{document.activeElement!==this.picker&&this.picker.setAttribute("color",this._hexColor),dx(this.color)!=dx(this._hexColor)&&(this.color=this._hexColor)})}render(){if(super.render(),VW("hex-color-picker",cW),this.picker=he.document.createElement("hex-color-picker"),this.picker.setAttribute("class","hex-color-picker"),this.picker.setAttribute("tabindex","-1"),this._createSlidersView(),this.element){this.hexInputRow.element?this.element.insertBefore(this.picker,this.hexInputRow.element):this.element.appendChild(this.picker);const e=document.createElement("style");e.textContent='[role="slider"]:focus [part$="pointer"] {border: 1px solid #fff;outline: 1px solid var(--ck-color-focus-border);box-shadow: 0 0 0 2px #fff;}',this.picker.shadowRoot.appendChild(e)}this.picker.addEventListener("color-changed",e=>{const i=e.detail.value;this._debounceColorPickerEvent(i)})}focus(){/* istanbul ignore next -- @preserve */!this._config.hideInput&&(Ie.isGecko||Ie.isiOS||Ie.isSafari||Ie.isBlink)&&this.hexInputRow.children.get(1).focus(),this.slidersView.first.focus()}_createSlidersView(){const n=[...this.picker.shadowRoot.children].filter(r=>r.getAttribute("role")==="slider").map(r=>new lU(r));this.slidersView=this.createCollection(),n.forEach(r=>{this.slidersView.add(r)})}_createInputRow(){const e=this._createColorInput();return new cU(this.locale,e)}_createColorInput(){const e=new Yt(this.locale,On),{t:i}=this.locale;return e.set({label:i("HEX"),class:"color-picker-hex-input"}),e.fieldView.bind("value").to(this,"_hexColor",n=>e.isFocused?e.fieldView.value:n.startsWith("#")?n.substring(1):n),e.fieldView.on("input",()=>{const n=e.fieldView.element.value;if(n){const r=VI(n);r&&this._debounceColorPickerEvent(r)}}),e}isValid(){const{t:e}=this.locale;return this._config.hideInput?!0:(this.resetValidationStatus(),this.hexInputRow.getParsedColor()?!0:(this.hexInputRow.inputView.errorText=e('Please enter a valid color (e.g. "ff0000").'),!1))}resetValidationStatus(){this.hexInputRow.inputView.errorText=null}}function dx(s){let t=RW(s);return t||(t="#000"),t.length===4&&(t="#"+[t[1],t[1],t[2],t[2],t[3],t[3]].join("")),t.toLowerCase()}class lU extends ue{constructor(t){super(),this.element=t}focus(){this.element.focus()}}class aU extends ue{constructor(t){super(t),this.setTemplate({tag:"div",attributes:{class:["ck","ck-color-picker__hash-view"]},children:"#"})}}class cU extends ue{constructor(e,i){super(e);p(this,"children");p(this,"inputView");this.inputView=i,this.children=this.createCollection([new aU,this.inputView]),this.setTemplate({tag:"div",attributes:{class:["ck","ck-color-picker__row"]},children:this.children})}getParsedColor(){return VI(this.inputView.fieldView.element.value)}}function VI(s){if(!s)return null;const t=s.trim().replace(/^#/,"");return![3,4,6,8].includes(t.length)||!/^(([0-9a-fA-F]{2}){3,4}|([0-9a-fA-F]){3,4})$/.test(t)?null:`#${t}`}class uU extends at(di){constructor(t){super(t),this.set("isEmpty",!0),this.on("change",()=>{this.set("isEmpty",this.length===0)})}add(t,e){return this.find(i=>i.color===t.color)?this:super.add(t,e)}hasColor(t){return!!this.find(e=>e.color===t)}}class hU extends ue{constructor(e,{colors:i,columns:n,removeButtonLabel:r,documentColorsLabel:o,documentColorsCount:l,colorPickerLabel:a,focusTracker:c,focusables:h}){super(e);p(this,"items");p(this,"colorDefinitions");p(this,"focusTracker");p(this,"columns");p(this,"documentColors");p(this,"documentColorsCount");p(this,"staticColorsGrid");p(this,"documentColorsGrid");p(this,"colorPickerButtonView");p(this,"removeColorButtonView");p(this,"_focusables");p(this,"_documentColorsLabel");p(this,"_removeButtonLabel");p(this,"_colorPickerLabel");const f=this.bindTemplate;this.set("isVisible",!0),this.focusTracker=c,this.items=this.createCollection(),this.colorDefinitions=i,this.columns=n,this.documentColors=new uU,this.documentColorsCount=l,this._focusables=h,this._removeButtonLabel=r,this._colorPickerLabel=a,this._documentColorsLabel=o,this.setTemplate({tag:"div",attributes:{class:["ck-color-grids-fragment",f.if("isVisible","ck-hidden",m=>!m)]},children:this.items}),this.removeColorButtonView=this._createRemoveColorButton(),this.items.add(this.removeColorButtonView)}updateDocumentColors(e,i){const n=e.document,r=this.documentColorsCount;this.documentColors.clear();for(const o of n.getRoots()){const l=e.createRangeIn(o);for(const a of l.getItems())if(a.is("$textProxy")&&a.hasAttribute(i)&&(this._addColorToDocumentColors(a.getAttribute(i)),this.documentColors.length>=r))return}}updateSelectedColors(){const e=this.documentColorsGrid,i=this.staticColorsGrid,n=this.selectedColor;i.selectedColor=n,e&&(e.selectedColor=n)}render(){if(super.render(),this.staticColorsGrid=this._createStaticColorsGrid(),this.items.add(this.staticColorsGrid),this.documentColorsCount){const e=zn.bind(this.documentColors,this.documentColors),i=new ue(this.locale);i.setTemplate({tag:"span",attributes:{class:["ck","ck-color-grid__label",e.if("isEmpty","ck-hidden")]},children:[{text:this._documentColorsLabel}]}),this.items.add(i),this.documentColorsGrid=this._createDocumentColorsGrid(),this.items.add(this.documentColorsGrid)}this._createColorPickerButton(),this._addColorSelectorElementsToFocusTracker()}focus(){this.removeColorButtonView.focus()}destroy(){super.destroy()}addColorPickerButton(){this.colorPickerButtonView&&(this.items.add(this.colorPickerButtonView),this.focusTracker.add(this.colorPickerButtonView.element),this._focusables.add(this.colorPickerButtonView))}_addColorSelectorElementsToFocusTracker(){this.focusTracker.add(this.removeColorButtonView.element),this._focusables.add(this.removeColorButtonView),this.staticColorsGrid&&(this.focusTracker.add(this.staticColorsGrid.element),this._focusables.add(this.staticColorsGrid)),this.documentColorsGrid&&(this.focusTracker.add(this.documentColorsGrid.element),this._focusables.add(this.documentColorsGrid))}_createColorPickerButton(){this.colorPickerButtonView=new ye,this.colorPickerButtonView.set({label:this._colorPickerLabel,withText:!0,icon:GF,class:"ck-color-selector__color-picker"}),this.colorPickerButtonView.on("execute",()=>{this.fire("colorPicker:show")})}_createRemoveColorButton(){const e=new ye;return e.set({withText:!0,icon:tz,label:this._removeButtonLabel}),e.class="ck-color-selector__remove-color",e.on("execute",()=>{this.fire("execute",{value:null,source:"removeColorButton"})}),e.render(),e}_createStaticColorsGrid(){const e=new h2(this.locale,{colorDefinitions:this.colorDefinitions,columns:this.columns});return e.on("execute",(i,n)=>{this.fire("execute",{value:n.value,source:"staticColorsGrid"})}),e}_createDocumentColorsGrid(){const e=zn.bind(this.documentColors,this.documentColors),i=new h2(this.locale,{columns:this.columns});return i.extendTemplate({attributes:{class:e.if("isEmpty","ck-hidden")}}),i.items.bindTo(this.documentColors).using(n=>{var o;const r=new wI;return r.set({color:n.color,hasBorder:(o=n.options)==null?void 0:o.hasBorder}),n.label&&r.set({label:n.label,tooltip:!0}),r.on("execute",()=>{this.fire("execute",{value:n.color,source:"documentColorsGrid"})}),r}),this.documentColors.on("change:isEmpty",(n,r,o)=>{o&&(i.selectedColor=null)}),i}_addColorToDocumentColors(e){const i=this.colorDefinitions.find(n=>n.color===e);i?this.documentColors.add(Object.assign({},i)):this.documentColors.add({color:e,label:e,options:{hasBorder:!1}})}}class dU extends ue{constructor(e,{focusTracker:i,focusables:n,keystrokes:r,colorPickerViewConfig:o}){super(e);p(this,"items");p(this,"colorPickerView");p(this,"saveButtonView");p(this,"cancelButtonView");p(this,"actionBarView");p(this,"focusTracker");p(this,"keystrokes");p(this,"_focusables");p(this,"_colorPickerViewConfig");this.items=this.createCollection(),this.focusTracker=i,this.keystrokes=r,this.set("isVisible",!1),this.set("selectedColor",void 0),this._focusables=n,this._colorPickerViewConfig=o;const l=this.bindTemplate,{saveButtonView:a,cancelButtonView:c}=this._createActionButtons();this.saveButtonView=a,this.cancelButtonView=c,this.actionBarView=this._createActionBarView({saveButtonView:a,cancelButtonView:c}),this.setTemplate({tag:"div",attributes:{class:["ck-color-picker-fragment",l.if("isVisible","ck-hidden",h=>!h)]},children:this.items})}render(){super.render();const e=new oU(this.locale,{...this._colorPickerViewConfig});this.colorPickerView=e,this.colorPickerView.render(),this.selectedColor&&(e.color=this.selectedColor),this.listenTo(this,"change:selectedColor",(i,n,r)=>{e.color=r}),this.items.add(this.colorPickerView),this.items.add(this.actionBarView),this._addColorPickersElementsToFocusTracker(),this._stopPropagationOnArrowsKeys(),this._executeOnEnterPress(),this._executeUponColorChange()}destroy(){super.destroy()}focus(){this.colorPickerView.focus()}resetValidationStatus(){this.colorPickerView.resetValidationStatus()}_executeOnEnterPress(){this.keystrokes.set("enter",e=>{this.isVisible&&this.focusTracker.focusedElement!==this.cancelButtonView.element&&this.colorPickerView.isValid()&&(this.fire("execute",{value:this.selectedColor}),e.stopPropagation(),e.preventDefault())})}_stopPropagationOnArrowsKeys(){const e=i=>i.stopPropagation();this.keystrokes.set("arrowright",e),this.keystrokes.set("arrowleft",e),this.keystrokes.set("arrowup",e),this.keystrokes.set("arrowdown",e)}_addColorPickersElementsToFocusTracker(){for(const i of this.colorPickerView.slidersView)this.focusTracker.add(i.element),this._focusables.add(i);const e=this.colorPickerView.hexInputRow.children.get(1);e.element&&(this.focusTracker.add(e.element),this._focusables.add(e)),this.focusTracker.add(this.saveButtonView.element),this._focusables.add(this.saveButtonView),this.focusTracker.add(this.cancelButtonView.element),this._focusables.add(this.cancelButtonView)}_createActionBarView({saveButtonView:e,cancelButtonView:i}){const n=new ue,r=this.createCollection();return r.add(e),r.add(i),n.setTemplate({tag:"div",attributes:{class:["ck","ck-color-selector_action-bar"]},children:r}),n}_createActionButtons(){const e=this.locale,i=e.t,n=new ye(e),r=new ye(e);return n.set({icon:Ic,class:"ck-button-save",type:"button",withText:!1,label:i("Accept")}),r.set({icon:Ac,class:"ck-button-cancel",type:"button",withText:!1,label:i("Cancel")}),n.on("execute",()=>{this.colorPickerView.isValid()&&this.fire("execute",{source:"colorPickerSaveButton",value:this.selectedColor})}),r.on("execute",()=>{this.fire("colorPicker:cancel")}),{saveButtonView:n,cancelButtonView:r}}_executeUponColorChange(){this.colorPickerView.on("colorSelected",(e,i)=>{this.fire("execute",{value:i.color,source:"colorPicker"}),this.set("selectedColor",i.color)})}}class fU extends ue{constructor(e,{colors:i,columns:n,removeButtonLabel:r,documentColorsLabel:o,documentColorsCount:l,colorPickerLabel:a,colorPickerViewConfig:c}){super(e);p(this,"focusTracker");p(this,"keystrokes");p(this,"items");p(this,"colorGridsFragmentView");p(this,"colorPickerFragmentView");p(this,"_focusCycler");p(this,"_focusables");p(this,"_colorPickerViewConfig");this.items=this.createCollection(),this.focusTracker=new ot,this.keystrokes=new wt,this._focusables=new fi,this._colorPickerViewConfig=c,this._focusCycler=new Ht({focusables:this._focusables,focusTracker:this.focusTracker,keystrokeHandler:this.keystrokes,actions:{focusPrevious:"shift + tab",focusNext:"tab"}}),this.colorGridsFragmentView=new hU(e,{colors:i,columns:n,removeButtonLabel:r,documentColorsLabel:o,documentColorsCount:l,colorPickerLabel:a,focusTracker:this.focusTracker,focusables:this._focusables}),this.colorPickerFragmentView=new dU(e,{focusables:this._focusables,focusTracker:this.focusTracker,keystrokes:this.keystrokes,colorPickerViewConfig:c}),this.set("_isColorGridsFragmentVisible",!0),this.set("_isColorPickerFragmentVisible",!1),this.set("selectedColor",void 0),this.colorGridsFragmentView.bind("isVisible").to(this,"_isColorGridsFragmentVisible"),this.colorPickerFragmentView.bind("isVisible").to(this,"_isColorPickerFragmentVisible"),this.on("change:selectedColor",(h,f,m)=>{this.colorGridsFragmentView.set("selectedColor",m),this.colorPickerFragmentView.set("selectedColor",m)}),this.colorGridsFragmentView.on("change:selectedColor",(h,f,m)=>{this.set("selectedColor",m)}),this.colorPickerFragmentView.on("change:selectedColor",(h,f,m)=>{this.set("selectedColor",m)}),this.setTemplate({tag:"div",attributes:{class:["ck","ck-color-selector"]},children:this.items})}render(){super.render(),this.keystrokes.listenTo(this.element)}destroy(){super.destroy(),this.focusTracker.destroy(),this.keystrokes.destroy()}appendUI(){this._appendColorGridsFragment(),this._colorPickerViewConfig&&this._appendColorPickerFragment()}showColorPickerFragment(){!this.colorPickerFragmentView.colorPickerView||this._isColorPickerFragmentVisible||(this._isColorPickerFragmentVisible=!0,this.colorPickerFragmentView.focus(),this.colorPickerFragmentView.resetValidationStatus(),this._isColorGridsFragmentVisible=!1)}showColorGridsFragment(){this._isColorGridsFragmentVisible||(this._isColorGridsFragmentVisible=!0,this.colorGridsFragmentView.focus(),this._isColorPickerFragmentVisible=!1)}focus(){this._focusCycler.focusFirst()}focusLast(){this._focusCycler.focusLast()}updateDocumentColors(e,i){this.colorGridsFragmentView.updateDocumentColors(e,i)}updateSelectedColors(){this.colorGridsFragmentView.updateSelectedColors()}_appendColorGridsFragment(){this.items.length||(this.items.add(this.colorGridsFragmentView),this.colorGridsFragmentView.delegate("execute").to(this),this.colorGridsFragmentView.delegate("colorPicker:show").to(this))}_appendColorPickerFragment(){this.items.length!==2&&(this.items.add(this.colorPickerFragmentView),this.colorGridsFragmentView.colorPickerButtonView&&this.colorGridsFragmentView.colorPickerButtonView.on("execute",()=>{this.showColorPickerFragment()}),this.colorGridsFragmentView.addColorPickerButton(),this.colorPickerFragmentView.delegate("execute").to(this),this.colorPickerFragmentView.delegate("colorPicker:cancel").to(this))}}class mU{constructor(t){p(this,"editor");p(this,"_components",new Map);this.editor=t}*names(){for(const t of this._components.values())yield t.originalName}add(t,e){this._components.set(fx(t),{callback:e,originalName:t})}create(t){if(!this.has(t))throw new E("componentfactory-item-missing",this,{name:t});return this._components.get(fx(t)).callback(this.editor.locale)}has(t){return this._components.has(fx(t))}}function fx(s){return String(s).toLowerCase()}const O2="ck-tooltip",xi=class xi extends qi(){constructor(e){super();p(this,"tooltipTextView");p(this,"balloonPanelView");p(this,"_currentElementWithTooltip",null);p(this,"_currentTooltipPosition",null);p(this,"_mutationObserver",null);p(this,"_pinTooltipDebounced");p(this,"_unpinTooltipDebounced");p(this,"_watchdogExcluded");if(xi._editors.add(e),xi._instance)return xi._instance;xi._instance=this,this.tooltipTextView=new ue(e.locale),this.tooltipTextView.set("text",""),this.tooltipTextView.setTemplate({tag:"span",attributes:{class:["ck","ck-tooltip__text"]},children:[{text:this.tooltipTextView.bindTemplate.to("text")}]}),this.balloonPanelView=new Fi(e.locale),this.balloonPanelView.class=O2,this.balloonPanelView.content.add(this.tooltipTextView),this._mutationObserver=gU(()=>{this._updateTooltipPosition()}),this._pinTooltipDebounced=fs(this._pinTooltip,600),this._unpinTooltipDebounced=fs(this._unpinTooltip,400),this.listenTo(he.document,"keydown",this._onKeyDown.bind(this),{useCapture:!0}),this.listenTo(he.document,"mouseenter",this._onEnterOrFocus.bind(this),{useCapture:!0}),this.listenTo(he.document,"mouseleave",this._onLeaveOrBlur.bind(this),{useCapture:!0}),this.listenTo(he.document,"focus",this._onEnterOrFocus.bind(this),{useCapture:!0}),this.listenTo(he.document,"blur",this._onLeaveOrBlur.bind(this),{useCapture:!0}),this.listenTo(he.document,"scroll",this._onScroll.bind(this),{useCapture:!0}),this._watchdogExcluded=!0}destroy(e){const i=e.ui.view&&e.ui.view.body;xi._editors.delete(e),this.stopListening(e.ui),i&&i.has(this.balloonPanelView)&&i.remove(this.balloonPanelView),xi._editors.size||(this._unpinTooltip(),this.balloonPanelView.destroy(),this.stopListening(),xi._instance=null)}static getPositioningFunctions(e){const i=xi.defaultBalloonPositions;return{s:[i.southArrowNorth,i.southArrowNorthEast,i.southArrowNorthWest],n:[i.northArrowSouth],e:[i.eastArrowWest],w:[i.westArrowEast],sw:[i.southArrowNorthEast],se:[i.southArrowNorthWest]}[e]}_onKeyDown(e,i){i.key==="Escape"&&this._currentElementWithTooltip&&(this._unpinTooltip(),i.stopPropagation())}_onEnterOrFocus(e,{target:i}){const n=mx(i);if(!n){e.name==="focus"&&this._unpinTooltip();return}if(n===this._currentElementWithTooltip){this._unpinTooltipDebounced.cancel();return}this._unpinTooltip(),e.name==="focus"&&!n.matches(":hover")||n.matches("[data-cke-tooltip-instant]")?this._pinTooltip(n,gx(n)):this._pinTooltipDebounced(n,gx(n))}_onLeaveOrBlur(e,{target:i,relatedTarget:n}){if(e.name==="mouseleave"){if(!Ao(i))return;const r=this.balloonPanelView.element,o=r&&(r===n||r.contains(n)),l=!o&&i===r;if(o){this._unpinTooltipDebounced.cancel();return}if(!l&&this._currentElementWithTooltip&&i!==this._currentElementWithTooltip)return;const a=mx(i),c=mx(n);(l||a&&a!==c)&&(this._pinTooltipDebounced.cancel(),this._currentElementWithTooltip&&this._currentElementWithTooltip.matches("[data-cke-tooltip-instant]")||a&&a.matches("[data-cke-tooltip-instant]")?this._unpinTooltip():this._unpinTooltipDebounced())}else{if(this._currentElementWithTooltip&&i!==this._currentElementWithTooltip)return;this._pinTooltipDebounced.cancel(),this._unpinTooltipDebounced()}}_onScroll(e,{target:i}){this._currentElementWithTooltip&&(i.contains(this.balloonPanelView.element)&&i.contains(this._currentElementWithTooltip)||this._unpinTooltip())}_pinTooltip(e,{text:i,position:n,cssClass:r}){this._unpinTooltip();const o=$t(xi._editors.values()).ui.view.body;o.has(this.balloonPanelView)||o.add(this.balloonPanelView),this.tooltipTextView.text=i,this.balloonPanelView.class=[O2,r].filter(l=>l).join(" "),this.balloonPanelView.pin({target:e,positions:xi.getPositioningFunctions(n)}),this._mutationObserver.attach(e);for(const l of xi._editors)this.listenTo(l.ui,"update",this._updateTooltipPosition.bind(this),{priority:"low"});this._currentElementWithTooltip=e,this._currentTooltipPosition=n}_unpinTooltip(){this._unpinTooltipDebounced.cancel(),this._pinTooltipDebounced.cancel(),this.balloonPanelView.unpin();for(const e of xi._editors)this.stopListening(e.ui,"update");this._currentElementWithTooltip=null,this._currentTooltipPosition=null,this.tooltipTextView.text="",this._mutationObserver.detach()}_updateTooltipPosition(){if(!this._currentElementWithTooltip)return;const e=gx(this._currentElementWithTooltip);if(!Ls(this._currentElementWithTooltip)||!e.text){this._unpinTooltip();return}this.balloonPanelView.pin({target:this._currentElementWithTooltip,positions:xi.getPositioningFunctions(e.position)})}};p(xi,"defaultBalloonPositions",Fi.generatePositions({heightOffset:5,sideOffset:13})),p(xi,"_editors",new Set),p(xi,"_instance",null);let qb=xi;function mx(s){return Ao(s)?s.closest("[data-cke-tooltip-text]:not([data-cke-tooltip-disabled])"):null}function gx(s){return{text:s.dataset.ckeTooltipText,position:s.dataset.ckeTooltipPosition||"s",cssClass:s.dataset.ckeTooltipClass||""}}function gU(s){const t=new MutationObserver(()=>{s()});return{attach(e){t.observe(e,{attributes:!0,attributeFilter:["data-cke-tooltip-text","data-cke-tooltip-position"]})},detach(){t.disconnect()}}}const pU=50,wU=350;class MI extends qi(){constructor(e,i={}){super();p(this,"editor");p(this,"_balloonView",null);p(this,"_showBalloonThrottled",hc(()=>this._showBalloon(),50,{leading:!0}));p(this,"_lastFocusedEditableElement",null);p(this,"_balloonClass");this.editor=e,this._balloonClass=i.balloonClass,e.on("ready",()=>this._handleEditorReady())}destroy(){const e=this._balloonView;e&&(e.unpin(),this._balloonView=null),this._showBalloonThrottled.cancel(),this.stopListening()}_handleEditorReady(){const e=this.editor;this._isEnabled()&&e.ui.view&&(e.ui.focusTracker.on("change:isFocused",(i,n,r)=>{this._updateLastFocusedEditableElement(),r?this._showBalloon():this._hideBalloon()}),e.ui.focusTracker.on("change:focusedElement",(i,n,r)=>{this._updateLastFocusedEditableElement(),r&&this._showBalloon()}),e.ui.on("update",()=>{this._showBalloonThrottled()}))}_getNormalizedConfig(){return{side:this.editor.locale.contentLanguageDirection==="ltr"?"right":"left",position:"border",verticalOffset:0,horizontalOffset:5}}_showBalloon(){const e=this._getBalloonAttachOptions();e&&(this._balloonView||(this._balloonView=this._createBalloonView()),this._balloonView.pin(e))}_hideBalloon(){this._balloonView&&this._balloonView.unpin()}_createBalloonView(){const e=this.editor,i=new Fi,n=this._createBadgeContent();return i.content.add(n),this._balloonClass&&(i.class=this._balloonClass),e.ui.view.body.add(i),i}_getBalloonAttachOptions(){if(!this._lastFocusedEditableElement)return null;const e=this._getNormalizedConfig(),i=e.side==="right"?xU(this._lastFocusedEditableElement,e):bU(this._lastFocusedEditableElement,e);return{target:this._lastFocusedEditableElement,positions:[i]}}_updateLastFocusedEditableElement(){const e=this.editor,i=e.ui.focusTracker.isFocused,n=e.ui.focusTracker.focusedElement;if(!i||!n){this._lastFocusedEditableElement=null;return}const r=Array.from(e.ui.getEditableElementsNames()).map(o=>e.ui.getEditableElement(o));r.includes(n)?this._lastFocusedEditableElement=n:this._lastFocusedEditableElement=r[0]}}function xU(s,t){return LI(s,t,(e,i)=>e.left+e.width-i.width-t.horizontalOffset)}function bU(s,t){return LI(s,t,e=>e.left+t.horizontalOffset)}function LI(s,t,e){return(i,n)=>{const r=new Ve(s);if(r.width<wU||r.height<pU)return null;let o;t.position==="inside"?o=r.bottom-n.height:o=r.bottom-n.height/2,o-=t.verticalOffset;const l=e(r,n),c=i.clone().moveTo(l,o).getIntersection(n.clone().moveTo(l,o)).getVisible();return!c||c.getArea()<n.getArea()?null:{top:o,left:l,name:`position_${t.position}-side_${t.side}`,config:{withArrow:!1}}}}const OU="Powered by";class yU extends MI{constructor(t){super(t,{balloonClass:"ck-powered-by-balloon"})}_isEnabled(){const t=this.editor;if(t.config.get("ui.poweredBy.forceVisible"))return!0;const i=t.config.get("licenseKey");if(i=="GPL")return!0;const n=DO(i.split(".")[1]);return n?!n.whiteLabel:!0}_createBadgeContent(){return new vU(this.editor.locale,this._getNormalizedConfig().label)}_getNormalizedConfig(){const t=super._getNormalizedConfig(),e=this.editor.config.get("ui.poweredBy")||{},i=e.position||t.position,n=i==="inside"?5:t.verticalOffset;return{position:i,side:e.side||t.side,label:e.label===void 0?OU:e.label,verticalOffset:e.verticalOffset!==void 0?e.verticalOffset:n,horizontalOffset:e.horizontalOffset!==void 0?e.horizontalOffset:t.horizontalOffset,forceVisible:!!e.forceVisible}}}class vU extends ue{constructor(t,e){super(t);const i=new Zn,n=this.bindTemplate;i.set({content:Ez,isColorInherited:!1}),this.setTemplate({tag:"div",attributes:{class:["ck","ck-powered-by"],"aria-hidden":!0},children:[{tag:"a",attributes:{href:"https://ckeditor.com/powered-by-ckeditor/?utm_source=ckeditor&utm_medium=referral&utm_campaign=701Dn000000hVgmIAE_powered_by_ckeditor_logo",target:"_blank",tabindex:"-1"},children:[...e?[{tag:"span",attributes:{class:["ck","ck-powered-by__label"]},children:[e]}]:[],i],on:{dragstart:n.to(r=>r.preventDefault())}}]})}}class _U extends MI{constructor(e){super(e,{balloonClass:"ck-evaluation-badge-balloon"});p(this,"licenseTypeMessage",{evaluation:"For evaluation purposes only",trial:"For evaluation purposes only",development:"For development purposes only"})}_isEnabled(){const i=this.editor.config.get("licenseKey"),n=y2(i);return!!(n&&this.licenseTypeMessage[n])}_createBadgeContent(){const e=this.editor.config.get("licenseKey"),i=y2(e);return new kU(this.editor.locale,this.licenseTypeMessage[i])}_getNormalizedConfig(){const e=super._getNormalizedConfig(),i=this.editor.config.get("ui.poweredBy")||{},n=i.position||e.position,r=i.side||e.side;return{position:n,side:r==="left"?"right":"left",verticalOffset:e.verticalOffset,horizontalOffset:e.horizontalOffset}}}class kU extends ue{constructor(t,e){super(t),this.setTemplate({tag:"div",attributes:{class:["ck","ck-evaluation-badge"],"aria-hidden":!0},children:[{tag:"span",attributes:{class:["ck","ck-evaluation-badge__label"]},children:[e]}]})}}function y2(s){if(s=="GPL")return"GPL";const t=DO(s.split(".")[1]);return t?t.licenseType||"production":null}const v2={POLITE:"polite",ASSERTIVE:"assertive"};class SU{constructor(t){p(this,"editor");p(this,"view");this.editor=t,t.once("ready",()=>{for(const e of Object.values(v2))this.announce("",e)})}announce(t,e=v2.POLITE){const i=this.editor;if(!i.ui.view)return;this.view||(this.view=new CU(i.locale),i.ui.view.body.add(this.view));const{politeness:n,isUnsafeHTML:r}=typeof e=="string"?{politeness:e}:e;let o=this.view.regionViews.find(l=>l.politeness===n);o||(o=new PU(i,n),this.view.regionViews.add(o)),o.announce({announcement:t,isUnsafeHTML:r})}}class CU extends ue{constructor(e){super(e);p(this,"regionViews");this.regionViews=this.createCollection(),this.setTemplate({tag:"div",attributes:{class:["ck","ck-aria-live-announcer"]},children:this.regionViews})}}class PU extends ue{constructor(e,i){super(e.locale);p(this,"politeness");p(this,"_domConverter");p(this,"_pruneAnnouncementsInterval");this.setTemplate({tag:"div",attributes:{"aria-live":i,"aria-relevant":"additions"},children:[{tag:"ul",attributes:{class:["ck","ck-aria-live-region-list"]}}]}),e.on("destroy",()=>{this._pruneAnnouncementsInterval!==null&&(clearInterval(this._pruneAnnouncementsInterval),this._pruneAnnouncementsInterval=null)}),this.politeness=i,this._domConverter=e.data.htmlProcessor.domConverter,this._pruneAnnouncementsInterval=setInterval(()=>{this.element&&this._listElement.firstChild&&this._listElement.firstChild.remove()},5e3)}announce({announcement:e,isUnsafeHTML:i}){if(!e.trim().length)return;const n=document.createElement("li");i?this._domConverter.setContentOf(n,e):n.innerText=e,this._listElement.appendChild(n)}get _listElement(){return this.element.querySelector("ul")}}class Tl extends Sn{constructor(t,e){super(t);const i=this.bindTemplate;this.extendTemplate({attributes:{class:["ck-menu-bar__menu__item"]},on:{mouseenter:i.to("mouseenter")}}),this.delegate("mouseenter").to(e)}}const Kf=5,Pa={toggleMenusAndFocusItemsOnHover(s){s.on("menu:mouseenter",t=>{if(!(!s.isFocusBorderEnabled&&!s.isOpen)){if(s.isOpen)for(const e of s.menus){const i=t.path[0],n=i instanceof Tl&&i.children.first===e;e.isOpen=(t.path.includes(e)||n)&&e.isEnabled}t.source.focus()}})},focusCycleMenusOnArrows(s){const t=s.locale.uiLanguageDirection==="rtl";s.on("menu:arrowright",i=>{e(i.source,t?-1:1)}),s.on("menu:arrowleft",i=>{e(i.source,t?1:-1)});function e(i,n){const r=s.children.getIndex(i),o=i.isOpen,l=s.children.length,a=s.children.get((r+l+n)%l);i.isOpen=!1,o&&(a.isOpen=!0),a.buttonView.focus()}},closeMenusWhenTheBarCloses(s){s.on("change:isOpen",()=>{s.isOpen||s.menus.forEach(t=>{t.isOpen=!1})})},closeMenuWhenAnotherOnTheSameLevelOpens(s){s.on("menu:change:isOpen",(t,e,i)=>{i&&s.menus.filter(n=>t.source.parentMenuView===n.parentMenuView&&t.source!==n&&n.isOpen).forEach(n=>{n.isOpen=!1})})},closeOnClickOutside(s){Fr({emitter:s,activator:()=>s.isOpen,callback:()=>s.close(),contextElements:()=>s.children.map(t=>t.element)})},enableFocusHighlightOnInteraction(s){let t=!1;s.on("change:isOpen",(e,i,n)=>{n||(t||(s.isFocusBorderEnabled=!1),t=!1)}),s.listenTo(s.element,"keydown",()=>{t=!0},{useCapture:!0}),s.listenTo(s.element,"keyup",()=>{t=!1},{useCapture:!0}),s.listenTo(s.element,"focus",()=>{t&&(s.isFocusBorderEnabled=!0)},{useCapture:!0})}},ho={openAndFocusPanelOnArrowDownKey(s){s.keystrokes.set("arrowdown",(t,e)=>{s.isEnabled&&s.focusTracker.focusedElement===s.buttonView.element&&(s.isOpen||(s.isOpen=!0),s.panelView.focus(),e())})},openOnArrowRightKey(s){const t=s.locale.uiLanguageDirection==="rtl"?"arrowleft":"arrowright";s.keystrokes.set(t,(e,i)=>{s.focusTracker.focusedElement!==s.buttonView.element||!s.isEnabled||(s.isOpen||(s.isOpen=!0),s.panelView.focus(),i())})},openOnButtonClick(s){s.buttonView.on("execute",()=>{s.isOpen=!0})},toggleOnButtonClick(s){s.buttonView.on("execute",()=>{s.isOpen=!s.isOpen})},openAndFocusOnEnterKeyPress(s){s.keystrokes.set("enter",(t,e)=>{s.focusTracker.focusedElement===s.buttonView.element&&(s.isOpen=!0,s.panelView.focus(),e())})},closeOnArrowLeftKey(s){const t=s.locale.uiLanguageDirection==="rtl"?"arrowright":"arrowleft";s.keystrokes.set(t,(e,i)=>{s.isOpen&&(s.isOpen=!1,s.focus(),i())})},closeOnEscKey(s){s.keystrokes.set("esc",(t,e)=>{s.isOpen&&(s.isOpen=!1,s.focus(),e())})},closeOnParentClose(s){s.parentMenuView.on("change:isOpen",(t,e,i)=>{!i&&t.source===s.parentMenuView&&(s.isOpen=!1)})}},TU={southEast:s=>({top:s.bottom,left:s.left,name:"se"}),southWest:(s,t)=>({top:s.bottom,left:s.left-t.width+s.width,name:"sw"}),northEast:(s,t)=>({top:s.top-t.height,left:s.left,name:"ne"}),northWest:(s,t)=>({top:s.top-t.height,left:s.left-t.width+s.width,name:"nw"}),eastSouth:s=>({top:s.top,left:s.right-Kf,name:"es"}),eastNorth:(s,t)=>({top:s.top-t.height,left:s.right-Kf,name:"en"}),westSouth:(s,t)=>({top:s.top,left:s.left-t.width+Kf,name:"ws"}),westNorth:(s,t)=>({top:s.top-t.height,left:s.left-t.width+Kf,name:"wn"})},EU=[{menuId:"file",label:"File",groups:[{groupId:"export",items:["menuBar:exportPdf","menuBar:exportWord"]},{groupId:"import",items:["menuBar:importWord"]},{groupId:"revisionHistory",items:["menuBar:revisionHistory"]}]},{menuId:"edit",label:"Edit",groups:[{groupId:"undo",items:["menuBar:undo","menuBar:redo"]},{groupId:"selectAll",items:["menuBar:selectAll"]},{groupId:"findAndReplace",items:["menuBar:findAndReplace"]}]},{menuId:"view",label:"View",groups:[{groupId:"sourceEditingEnhanced",items:["menuBar:sourceEditingEnhanced"]},{groupId:"sourceEditing",items:["menuBar:sourceEditing"]},{groupId:"showBlocks",items:["menuBar:showBlocks"]},{groupId:"previewMergeFields",items:["menuBar:previewMergeFields"]},{groupId:"fullscreen",items:["menuBar:fullscreen"]},{groupId:"restrictedEditing",items:["menuBar:restrictedEditing"]}]},{menuId:"insert",label:"Insert",groups:[{groupId:"insertMainWidgets",items:["menuBar:insertImage","menuBar:ckbox","menuBar:ckfinder","menuBar:insertTable","menuBar:insertTableLayout"]},{groupId:"insertInline",items:["menuBar:link","menuBar:bookmark","menuBar:comment","menuBar:insertMergeField","menuBar:emoji"]},{groupId:"insertMinorWidgets",items:["menuBar:mediaEmbed","menuBar:insertTemplate","menuBar:specialCharacters","menuBar:blockQuote","menuBar:codeBlock","menuBar:htmlEmbed"]},{groupId:"insertStructureWidgets",items:["menuBar:horizontalLine","menuBar:pageBreak","menuBar:tableOfContents"]},{groupId:"restrictedEditingException",items:["menuBar:restrictedEditingException"]}]},{menuId:"format",label:"Format",groups:[{groupId:"textAndFont",items:[{menuId:"text",label:"Text",groups:[{groupId:"basicStyles",items:["menuBar:bold","menuBar:italic","menuBar:underline","menuBar:strikethrough","menuBar:superscript","menuBar:subscript","menuBar:code"]},{groupId:"textPartLanguage",items:["menuBar:textPartLanguage"]}]},{menuId:"font",label:"Font",groups:[{groupId:"fontProperties",items:["menuBar:fontSize","menuBar:fontFamily"]},{groupId:"fontColors",items:["menuBar:fontColor","menuBar:fontBackgroundColor"]},{groupId:"highlight",items:["menuBar:highlight"]}]},"menuBar:heading"]},{groupId:"list",items:["menuBar:bulletedList","menuBar:numberedList","menuBar:multiLevelList","menuBar:todoList"]},{groupId:"indent",items:["menuBar:alignment","menuBar:indent","menuBar:outdent"]},{groupId:"caseChange",items:["menuBar:caseChange"]},{groupId:"removeFormat",items:["menuBar:removeFormat"]}]},{menuId:"tools",label:"Tools",groups:[{groupId:"aiTools",items:["menuBar:aiAssistant","menuBar:aiCommands"]},{groupId:"tools",items:["menuBar:trackChanges","menuBar:commentsArchive"]}]},{menuId:"help",label:"Help",groups:[{groupId:"help",items:["menuBar:accessibilityHelp"]}]}];function AU(s){let t;return!("items"in s)||!s.items?t={items:_n(EU),addItems:[],removeItems:[],isVisible:!0,isUsingDefaultConfig:!0,...s}:t={items:s.items,removeItems:[],addItems:[],isVisible:!0,isUsingDefaultConfig:!1,...s},t}function IU({normalizedConfig:s,locale:t,componentFactory:e,extraItems:i}){const n=_n(s);return _2(s,n,i),RU(s,n),_2(s,n,n.addItems),VU(s,n,e),BI(s,n),MU(n,t),n}function RU(s,t){const e=t.removeItems,i=[];t.items=t.items.filter(({menuId:n})=>e.includes(n)?(i.push(n),!1):!0),Mc(t.items,n=>{n.groups=n.groups.filter(({groupId:r})=>e.includes(r)?(i.push(r),!1):!0);for(const r of n.groups)r.items=r.items.filter(o=>{const l=$I(o);return e.includes(l)?(i.push(l),!1):!0})});for(const n of e)i.includes(n)||Ue("menu-bar-item-could-not-be-removed",{menuBarConfig:s,itemName:n})}function _2(s,t,e){const i=[];if(e.length!=0){for(const n of e){const r=$U(n.position),o=DU(n.position);if(LU(n))if(!o)r==="start"?(t.items.unshift(n.menu),i.push(n)):r==="end"&&(t.items.push(n.menu),i.push(n));else{const l=t.items.findIndex(a=>a.menuId===o);l!=-1?r==="before"?(t.items.splice(l,0,n.menu),i.push(n)):r==="after"&&(t.items.splice(l+1,0,n.menu),i.push(n)):k2(t,n.menu,o,r)&&i.push(n)}else BU(n)?Mc(t.items,l=>{if(l.menuId===o)r==="start"?(l.groups.unshift(n.group),i.push(n)):r==="end"&&(l.groups.push(n.group),i.push(n));else{const a=l.groups.findIndex(c=>c.groupId===o);a!==-1&&(r==="before"?(l.groups.splice(a,0,n.group),i.push(n)):r==="after"&&(l.groups.splice(a+1,0,n.group),i.push(n)))}}):k2(t,n.item,o,r)&&i.push(n)}for(const n of e)i.includes(n)||Ue("menu-bar-item-could-not-be-added",{menuBarConfig:s,addedItemConfig:n})}}function k2(s,t,e,i){let n=!1;return Mc(s.items,r=>{for(const{groupId:o,items:l}of r.groups){if(n)return;if(o===e)i==="start"?(l.unshift(t),n=!0):i==="end"&&(l.push(t),n=!0);else{const a=l.findIndex(c=>$I(c)===e);a!==-1&&(i==="before"?(l.splice(a,0,t),n=!0):i==="after"&&(l.splice(a+1,0,t),n=!0))}}}),n}function VU(s,t,e){Mc(t.items,i=>{for(const n of i.groups)n.items=n.items.filter(r=>{const o=typeof r=="string"&&!e.has(r);return o&&!t.isUsingDefaultConfig&&Ue("menu-bar-item-unavailable",{menuBarConfig:s,parentMenuConfig:_n(i),componentName:r}),!o})})}function BI(s,t){const e=t.isUsingDefaultConfig;let i=!1;if(t.items=t.items.filter(n=>n.groups.length?!0:(px(s,n,e),!1)),!t.items.length){px(s,s,e);return}Mc(t.items,n=>{n.groups=n.groups.filter(r=>r.items.length?!0:(i=!0,!1));for(const r of n.groups)r.items=r.items.filter(o=>DI(o)&&!o.groups.length?(px(s,o,e),i=!0,!1):!0)}),i&&BI(s,t)}function px(s,t,e){e||Ue("menu-bar-menu-empty",{menuBarConfig:s,emptyMenuConfig:t})}function MU(s,t){const e=t.t,i={File:e({string:"File",id:"MENU_BAR_MENU_FILE"}),Edit:e({string:"Edit",id:"MENU_BAR_MENU_EDIT"}),View:e({string:"View",id:"MENU_BAR_MENU_VIEW"}),Insert:e({string:"Insert",id:"MENU_BAR_MENU_INSERT"}),Format:e({string:"Format",id:"MENU_BAR_MENU_FORMAT"}),Tools:e({string:"Tools",id:"MENU_BAR_MENU_TOOLS"}),Help:e({string:"Help",id:"MENU_BAR_MENU_HELP"}),Text:e({string:"Text",id:"MENU_BAR_MENU_TEXT"}),Font:e({string:"Font",id:"MENU_BAR_MENU_FONT"})};Mc(s.items,n=>{n.label in i&&(n.label=i[n.label])})}function Mc(s,t){if(Array.isArray(s))for(const i of s)e(i);function e(i){t(i);for(const n of i.groups)for(const r of n.items)DI(r)&&e(r)}}function LU(s){return typeof s=="object"&&"menu"in s}function BU(s){return typeof s=="object"&&"group"in s}function $U(s){return s.startsWith("start")?"start":s.startsWith("end")?"end":s.startsWith("after")?"after":"before"}function DU(s){const t=s.match(/^[^:]+:(.+)/);return t?t[1]:null}function $I(s){return typeof s=="string"?s:s.menuId}function DI(s){return typeof s=="object"&&"menuId"in s}class QU extends at(){constructor(e){super();p(this,"editor");p(this,"componentFactory");p(this,"focusTracker");p(this,"tooltipManager");p(this,"poweredBy");p(this,"evaluationBadge");p(this,"ariaLiveAnnouncer");p(this,"isReady",!1);p(this,"_editableElementsMap",new Map);p(this,"_focusableToolbarDefinitions",[]);p(this,"_extraMenuBarElements",[]);p(this,"_lastFocusedForeignElement",null);p(this,"_domEmitter");const i=e.editing.view;this.editor=e,this.componentFactory=new mU(e),this.focusTracker=new ot,this.tooltipManager=new qb(e),this.poweredBy=new yU(e),this.evaluationBadge=new _U(e),this.ariaLiveAnnouncer=new SU(e),this._initViewportOffset(this._readViewportOffsetFromConfig()),this.once("ready",()=>{this._bindBodyCollectionWithFocusTracker(),this.isReady=!0}),this.listenTo(i.document,"layoutChanged",this.update.bind(this)),this.listenTo(i,"scrollToTheSelection",this._handleScrollToTheSelection.bind(this)),this._initFocusTracking(),this._initVisualViewportSupport()}get element(){return null}update(){this.fire("update")}destroy(){this.stopListening(),this.focusTracker.destroy(),this.tooltipManager.destroy(this.editor),this.poweredBy.destroy(),this.evaluationBadge.destroy();for(const e of this._editableElementsMap.values())e.ckeditorInstance=null,this.editor.keystrokes.stopListening(e);this._editableElementsMap=new Map,this._focusableToolbarDefinitions=[],this._domEmitter&&this._domEmitter.stopListening()}setEditableElement(e,i){this._editableElementsMap.set(e,i),i.ckeditorInstance||(i.ckeditorInstance=this.editor),this.focusTracker.add(i);const n=()=>{this.editor.editing.view.getDomRoot(e)||this.editor.keystrokes.listenTo(i)};this.isReady?n():this.once("ready",n)}removeEditableElement(e){const i=this._editableElementsMap.get(e);i&&(this._editableElementsMap.delete(e),this.editor.keystrokes.stopListening(i),this.focusTracker.remove(i),i.ckeditorInstance=null)}getEditableElement(e="main"){return this._editableElementsMap.get(e)}getEditableElementsNames(){return this._editableElementsMap.keys()}addToolbar(e,i={}){e.isRendered?(this.focusTracker.add(e),this.editor.keystrokes.listenTo(e.element)):e.once("render",()=>{this.focusTracker.add(e),this.editor.keystrokes.listenTo(e.element)}),this._focusableToolbarDefinitions.push({toolbarView:e,options:i})}extendMenuBar(e){this._extraMenuBarElements.push(e)}get _editableElements(){return console.warn("editor-ui-deprecated-editable-elements: The EditorUI#_editableElements property has been deprecated and will be removed in the near future.",{editorUI:this}),this._editableElementsMap}initMenuBar(e){const i=e.element;this.focusTracker.add(i),this.editor.keystrokes.listenTo(i);const n=AU(this.editor.config.get("menuBar")||{});e.fillFromConfig(n,this.componentFactory,this._extraMenuBarElements),this.editor.keystrokes.set("Esc",(r,o)=>{i.contains(this.editor.ui.focusTracker.focusedElement)&&(this._lastFocusedForeignElement?(this._lastFocusedForeignElement.focus(),this._lastFocusedForeignElement=null):this.editor.editing.view.focus(),o())}),this.editor.keystrokes.set("Alt+F9",(r,o)=>{i.contains(this.editor.ui.focusTracker.focusedElement)||(this._saveLastFocusedForeignElement(),e.isFocusBorderEnabled=!0,e.focus(),o())})}_readViewportOffsetFromConfig(){const e=this.editor,i=e.config.get("ui.viewportOffset");if(i)return i;const n=e.config.get("toolbar.viewportTopOffset");return n?(console.warn("editor-ui-deprecated-viewport-offset-config: The `toolbar.vieportTopOffset` configuration option is deprecated. It will be removed from future CKEditor versions. Use `ui.viewportOffset.top` instead."),{top:n}):{top:0}}_initFocusTracking(){const e=this.editor;let i;e.keystrokes.set("Alt+F10",(n,r)=>{this._saveLastFocusedForeignElement();const o=this._getCurrentFocusedToolbarDefinition();(!o||!i)&&(i=this._getFocusableCandidateToolbarDefinitions());for(let l=0;l<i.length;l++){const a=i.shift();if(i.push(a),a!==o&&this._focusFocusableCandidateToolbar(a)){o&&o.options.afterBlur&&o.options.afterBlur();break}}r()}),e.keystrokes.set("Esc",(n,r)=>{const o=this._getCurrentFocusedToolbarDefinition();o&&(this._lastFocusedForeignElement?(this._lastFocusedForeignElement.focus(),this._lastFocusedForeignElement=null):e.editing.view.focus(),o.options.afterBlur&&o.options.afterBlur(),r())})}_saveLastFocusedForeignElement(){const e=this.focusTracker.focusedElement;Array.from(this._editableElementsMap.values()).includes(e)&&!Array.from(this.editor.editing.view.domRoots.values()).includes(e)&&(this._lastFocusedForeignElement=e)}_getFocusableCandidateToolbarDefinitions(){const e=[];for(const i of this._focusableToolbarDefinitions){const{toolbarView:n,options:r}=i;(Ls(n.element)||r.beforeFocus)&&e.push(i)}return e.sort((i,n)=>S2(i)-S2(n)),e}_getCurrentFocusedToolbarDefinition(){for(const e of this._focusableToolbarDefinitions)if(e.toolbarView.element&&e.toolbarView.element.contains(this.focusTracker.focusedElement))return e;return null}_focusFocusableCandidateToolbar(e){const{toolbarView:i,options:{beforeFocus:n}}=e;return n&&n(),Ls(i.element)?(i.focus(),!0):!1}_handleScrollToTheSelection(e,i){const n={top:0,bottom:0,left:0,right:0,...this.viewportOffset};i.viewportOffset.top+=n.top,i.viewportOffset.bottom+=n.bottom,i.viewportOffset.left+=n.left,i.viewportOffset.right+=n.right}_bindBodyCollectionWithFocusTracker(){const e=this.view.body;for(const i of e)this.focusTracker.add(i.element);e.on("add",(i,n)=>{this.focusTracker.add(n.element)}),e.on("remove",(i,n)=>{this.focusTracker.remove(n.element)})}_initViewportOffset(e){this.on("set:viewportOffset",(i,n,r)=>{const o=this._getVisualViewportTopOffset(r);r.visualTop!==o&&(i.return={...r,visualTop:o})}),this.set("viewportOffset",e)}_initVisualViewportSupport(){if(!he.window.visualViewport)return;const e=()=>{const i=this._getVisualViewportTopOffset(this.viewportOffset);this.viewportOffset.visualTop!==i&&(this.viewportOffset={...this.viewportOffset,visualTop:i})};this._domEmitter=new(qi()),this._domEmitter.listenTo(he.window.visualViewport,"scroll",e),this._domEmitter.listenTo(he.window.visualViewport,"resize",e)}_getVisualViewportTopOffset(e){const i=Vm().top,n=e.top||0;return i>n?0:n-i}}function S2(s){const{toolbarView:t,options:e}=s;let i=10;return Ls(t.element)&&i--,e.isContextual&&(i-=2),i}class NU extends ue{constructor(e){super(e);p(this,"body");p(this,"menuBarView");p(this,"toolbar");this.body=new Zb(e)}render(){super.render(),this.body.attachToDom()}destroy(){return this.body.detachFromDom(),super.destroy()}}class FU extends NU{constructor(e){super(e);p(this,"top");p(this,"main");p(this,"_voiceLabelView");this.top=this.createCollection(),this.main=this.createCollection(),this._voiceLabelView=this._createVoiceLabel(),this.setTemplate({tag:"div",attributes:{class:["ck","ck-reset","ck-editor","ck-rounded-corners"],role:"application",dir:e.uiLanguageDirection,lang:e.uiLanguage,"aria-labelledby":this._voiceLabelView.id},children:[this._voiceLabelView,{tag:"div",attributes:{class:["ck","ck-editor__top","ck-reset_all"],role:"presentation"},children:this.top},{tag:"div",attributes:{class:["ck","ck-editor__main"],role:"presentation"},children:this.main}]})}_createVoiceLabel(){const e=this.t,i=new ns;return i.text=e("Rich Text Editor"),i.extendTemplate({attributes:{class:"ck-voice-label"}}),i}}class zU extends ue{constructor(e,i,n){super(e);p(this,"name",null);p(this,"_editingView");p(this,"_editableElement");p(this,"_hasExternalElement");this.setTemplate({tag:"div",attributes:{class:["ck","ck-content","ck-editor__editable","ck-rounded-corners"],lang:e.contentLanguage,dir:e.contentLanguageDirection}}),this.set("isFocused",!1),this._editableElement=n,this._hasExternalElement=!!this._editableElement,this._editingView=i}render(){super.render(),this._hasExternalElement?this.template.apply(this.element=this._editableElement):this._editableElement=this.element,this.on("change:isFocused",()=>this._updateIsFocusedClasses()),this._updateIsFocusedClasses()}destroy(){this._hasExternalElement&&this.template.revert(this._editableElement),super.destroy()}get hasExternalElement(){return this._hasExternalElement}_updateIsFocusedClasses(){const e=this._editingView;e.isRenderingInProgress?n(this):i(this);function i(r){e.change(o=>{const l=e.document.getRoot(r.name);o.addClass(r.isFocused?"ck-focused":"ck-blurred",l),o.removeClass(r.isFocused?"ck-blurred":"ck-focused",l)})}function n(r){e.once("change:isRenderingInProgress",(o,l,a)=>{a?n(r):i(r)})}}}class WU extends zU{constructor(e,i,n,r={}){super(e,i,n);p(this,"_options");this._options=r,this.extendTemplate({attributes:{role:"textbox",class:"ck-editor__editable_inline"}})}render(){super.render();const e=this._editingView;e.change(i=>{const n=e.document.getRoot(this.name);i.setAttribute("aria-label",this.getEditableAriaLabel(),n)})}getEditableAriaLabel(){const e=this.locale.t,i=this._options.label,n=this._editableElement,r=this.name;if(typeof i=="string")return i;if(typeof i=="object")return i[r];if(typeof i=="function")return i(this);if(n){const o=n.getAttribute("aria-label");if(o)return o}return e("Rich Text Editor. Editing area: %0",r)}}class Ei extends ue{constructor(e,i={}){super(e);p(this,"children");const n=this.bindTemplate;this.set("class",["ck","ck-form__row",...dt(i.class||[])]),this.children=this.createCollection(),i.children&&i.children.forEach(r=>this.children.add(r)),this.set("_role",null),this.set("_ariaLabelledBy",null),i.labelView&&this.set({_role:"group",_ariaLabelledBy:i.labelView.id}),this.setTemplate({tag:"div",attributes:{class:n.to("class",r=>r.join(" ")),role:n.to("_role"),"aria-labelledby":n.to("_ariaLabelledBy")},children:this.children})}}class Mh extends Tp{static get pluginName(){return"Notification"}static get isOfficialPlugin(){return!0}init(){this.on("show:warning",(t,e)=>{window.alert(e.message)},{priority:"lowest"})}showSuccess(t,e={}){this._showNotification({message:t,type:"success",namespace:e.namespace,title:e.title})}showInfo(t,e={}){this._showNotification({message:t,type:"info",namespace:e.namespace,title:e.title})}showWarning(t,e={}){this._showNotification({message:t,type:"warning",namespace:e.namespace,title:e.title})}_showNotification(t){const e=t.namespace?`show:${t.type}:${t.namespace}`:`show:${t.type}`;this.fire(e,{message:t.message,type:t.type,title:t.title||""})}}class El extends at(){constructor(t,e){super(),e&&E6(this,e),t&&this.set(t)}}const Jf=No("px");class gs extends F{constructor(e){super(e);p(this,"positionLimiter");p(this,"visibleStack");p(this,"_viewToStack",new Map);p(this,"_idToStack",new Map);p(this,"_view",null);p(this,"_rotatorView",null);p(this,"_fakePanelsView",null);this.positionLimiter=()=>{const i=this.editor.editing.view,r=i.document.selection.editableElement;return r?i.domConverter.mapViewToDom(r.root):null},this.decorate("getPositionOptions"),this.set("visibleView",null),this.set("_numberOfStacks",0),this.set("_singleViewMode",!1)}static get pluginName(){return"ContextualBalloon"}static get isOfficialPlugin(){return!0}destroy(){super.destroy(),this._view&&this._view.destroy(),this._rotatorView&&this._rotatorView.destroy(),this._fakePanelsView&&this._fakePanelsView.destroy()}get view(){return this._view||this._createPanelView(),this._view}hasView(e){return Array.from(this._viewToStack.keys()).includes(e)}add(e){if(this._view||this._createPanelView(),this.hasView(e.view))throw new E("contextualballoon-add-view-exist",[this,e]);const i=e.stackId||"main";if(!this._idToStack.has(i)){this._idToStack.set(i,new Map([[e.view,e]])),this._viewToStack.set(e.view,this._idToStack.get(i)),this._numberOfStacks=this._idToStack.size,(!this._visibleStack||e.singleViewMode)&&this.showStack(i);return}const n=this._idToStack.get(i);e.singleViewMode&&this.showStack(i),n.set(e.view,e),this._viewToStack.set(e.view,n),n===this._visibleStack&&this._showView(e)}remove(e){if(!this.hasView(e))throw new E("contextualballoon-remove-view-not-exist",[this,e]);const i=this._viewToStack.get(e);this._singleViewMode&&this.visibleView===e&&(this._singleViewMode=!1),this.visibleView===e&&(i.size===1?this._idToStack.size>1?this._showNextStack():(this.view.hide(),this.visibleView=null,this._rotatorView.hideView()):this._showView(Array.from(i.values())[i.size-2])),i.size===1?(this._idToStack.delete(this._getStackId(i)),this._numberOfStacks=this._idToStack.size):i.delete(e),this._viewToStack.delete(e)}updatePosition(e){e&&(this._visibleStack.get(this.visibleView).position=e),this.view.pin(this.getPositionOptions()),this._fakePanelsView.updatePosition()}getPositionOptions(){let e=Array.from(this._visibleStack.values()).pop().position;return e&&(e.limiter||(e=Object.assign({},e,{limiter:this.positionLimiter})),e=Object.assign({},e,{viewportOffsetConfig:{...this.editor.ui.viewportOffset,top:this.editor.ui.viewportOffset.visualTop}})),e}showStack(e){this.visibleStack=e;const i=this._idToStack.get(e);if(!i)throw new E("contextualballoon-showstack-stack-not-exist",this);this._visibleStack!==i&&this._showView(Array.from(i.values()).pop())}_createPanelView(){this._view=new Fi(this.editor.locale),this.editor.ui.view.body.add(this._view),this._rotatorView=this._createRotatorView(),this._fakePanelsView=this._createFakePanelsView()}get _visibleStack(){return this._viewToStack.get(this.visibleView)}_getStackId(e){return Array.from(this._idToStack.entries()).find(n=>n[1]===e)[0]}_showNextStack(){const e=Array.from(this._idToStack.values());let i=e.indexOf(this._visibleStack)+1;e[i]||(i=0),this.showStack(this._getStackId(e[i]))}_showPrevStack(){const e=Array.from(this._idToStack.values());let i=e.indexOf(this._visibleStack)-1;e[i]||(i=e.length-1),this.showStack(this._getStackId(e[i]))}_createRotatorView(){const e=new UU(this.editor.locale),i=this.editor.locale.t;return this.view.content.add(e),e.bind("isNavigationVisible").to(this,"_numberOfStacks",this,"_singleViewMode",(n,r)=>!r&&n>1),e.on("change:isNavigationVisible",()=>this.updatePosition(),{priority:"low"}),e.bind("counter").to(this,"visibleView",this,"_numberOfStacks",(n,r)=>{if(r<2)return"";const o=Array.from(this._idToStack.values()).indexOf(this._visibleStack)+1;return i("%0 of %1",[o,r])}),e.buttonNextView.on("execute",()=>{e.focusTracker.isFocused&&this.editor.editing.view.focus(),this._showNextStack()}),e.buttonPrevView.on("execute",()=>{e.focusTracker.isFocused&&this.editor.editing.view.focus(),this._showPrevStack()}),e}_createFakePanelsView(){const e=new ZU(this.editor.locale,this.view);return e.bind("numberOfPanels").to(this,"_numberOfStacks",this,"_singleViewMode",(i,n)=>!n&&i>=2?Math.min(i-1,2):0),e.listenTo(this.view,"change:top",()=>e.updatePosition()),e.listenTo(this.view,"change:left",()=>e.updatePosition()),this.editor.ui.view.body.add(e),e}_showView({view:e,balloonClassName:i="",withArrow:n=!0,singleViewMode:r=!1}){this.view.class=i,this.view.withArrow=n,this._rotatorView.showView(e),this.visibleView=e,this.view.pin(this.getPositionOptions()),this._fakePanelsView.updatePosition(),r&&(this._singleViewMode=!0)}}class UU extends ue{constructor(e){super(e);p(this,"focusTracker");p(this,"buttonPrevView");p(this,"buttonNextView");p(this,"content");const i=e.t,n=this.bindTemplate;this.set("isNavigationVisible",!0),this.focusTracker=new ot,this.buttonPrevView=this._createButtonView(i("Previous"),zl),this.buttonNextView=this._createButtonView(i("Next"),KA),this.content=this.createCollection(),this.setTemplate({tag:"div",attributes:{class:["ck","ck-balloon-rotator"],"z-index":"-1"},children:[{tag:"div",attributes:{class:["ck-balloon-rotator__navigation",n.to("isNavigationVisible",r=>r?"":"ck-hidden")]},children:[this.buttonPrevView,{tag:"span",attributes:{class:["ck-balloon-rotator__counter"]},children:[{text:n.to("counter")}]},this.buttonNextView]},{tag:"div",attributes:{class:"ck-balloon-rotator__content"},children:this.content}]})}render(){super.render(),this.focusTracker.add(this.element)}destroy(){super.destroy(),this.focusTracker.destroy()}showView(e){this.hideView(),this.content.add(e)}hideView(){this.content.clear()}_createButtonView(e,i){const n=new ye(this.locale);return n.set({label:e,icon:i,tooltip:!0}),n}}class ZU extends ue{constructor(e,i){super(e);p(this,"content");p(this,"_balloonPanelView");const n=this.bindTemplate;this.set("top",0),this.set("left",0),this.set("height",0),this.set("width",0),this.set("numberOfPanels",0),this.content=this.createCollection(),this._balloonPanelView=i,this.setTemplate({tag:"div",attributes:{class:["ck-fake-panel",n.to("numberOfPanels",r=>r?"":"ck-hidden")],style:{top:n.to("top",Jf),left:n.to("left",Jf),width:n.to("width",Jf),height:n.to("height",Jf)}},children:this.content}),this.on("change:numberOfPanels",(r,o,l,a)=>{l>a?this._addPanels(l-a):this._removePanels(a-l),this.updatePosition()})}_addPanels(e){for(;e--;){const i=new ue;i.setTemplate({tag:"div"}),this.content.add(i),this.registerChild(i)}}_removePanels(e){for(;e--;){const i=this.content.last;this.content.remove(i),this.deregisterChild(i),i.destroy()}}updatePosition(){if(this.numberOfPanels){const{top:e,left:i}=this._balloonPanelView,{width:n,height:r}=new Ve(this._balloonPanelView.element);Object.assign(this,{top:e,left:i,width:n,height:r})}}}const Ta=No("px");class HU extends ue{constructor(e){super(e);p(this,"content");p(this,"contentPanelElement");p(this,"_contentPanelPlaceholder");const i=this.bindTemplate;this.set("isActive",!1),this.set("isSticky",!1),this.set("limiterElement",null),this.set("limiterBottomOffset",50),this.set("viewportTopOffset",0),this.set("_marginLeft",null),this.set("_isStickyToTheBottomOfLimiter",!1),this.set("_stickyTopOffset",null),this.set("_stickyBottomOffset",null),this.content=this.createCollection(),this._contentPanelPlaceholder=new zn({tag:"div",attributes:{class:["ck","ck-sticky-panel__placeholder"],style:{display:i.to("isSticky",n=>n?"block":"none"),height:i.to("isSticky",n=>n?Ta(this._contentPanelRect.height):null)}}}).render(),this.contentPanelElement=new zn({tag:"div",attributes:{class:["ck","ck-sticky-panel__content",i.if("isSticky","ck-sticky-panel__content_sticky"),i.if("_isStickyToTheBottomOfLimiter","ck-sticky-panel__content_sticky_bottom-limit")],style:{width:i.to("isSticky",n=>n?Ta(this._contentPanelPlaceholder.getBoundingClientRect().width):null),top:i.to("_stickyTopOffset",n=>n&&Ta(n)),bottom:i.to("_stickyBottomOffset",n=>n&&Ta(n)),marginLeft:i.to("_marginLeft")}},children:this.content}).render(),this.setTemplate({tag:"div",attributes:{class:["ck","ck-sticky-panel"]},children:[this._contentPanelPlaceholder,this.contentPanelElement]})}render(){super.render(),this.checkIfShouldBeSticky(),this.listenTo(he.document,"scroll",()=>{this.checkIfShouldBeSticky()},{useCapture:!0}),this.listenTo(this,"change:isActive",()=>{this.checkIfShouldBeSticky()}),he.window.visualViewport&&(this.listenTo(he.window.visualViewport,"scroll",()=>{this.checkIfShouldBeSticky()}),this.listenTo(he.window.visualViewport,"resize",()=>{this.checkIfShouldBeSticky()}))}checkIfShouldBeSticky(){if(!this.limiterElement||!this.isActive){this._unstick();return}const e=new Ve(this.limiterElement);let i=e.getVisible();if(i){const o=new Ve(he.window);o.top+=this.viewportTopOffset,o.height-=this.viewportTopOffset,i=i.getIntersection(o)}const{left:n,top:r}=Vm();if(e.moveBy(n,r),i&&i.moveBy(n,r),i&&e.top<i.top)if(this._contentPanelRect.height+this.limiterBottomOffset>i.height){const o=Math.max(e.bottom-i.bottom,0)+this.limiterBottomOffset;this._contentPanelRect.height+o+1<e.height?this._stickToBottomOfLimiter(o):this._unstick()}else this._contentPanelRect.height+this.limiterBottomOffset<e.height?this._stickToTopOfAncestors(i.top):this._unstick();else this._unstick()}_stickToTopOfAncestors(e){this.isSticky=!0,this._isStickyToTheBottomOfLimiter=!1,this._stickyTopOffset=e,this._stickyBottomOffset=null,this._marginLeft=Ta(-he.window.scrollX+Vm().left)}_stickToBottomOfLimiter(e){this.isSticky=!0,this._isStickyToTheBottomOfLimiter=!0,this._stickyTopOffset=null,this._stickyBottomOffset=e,this._marginLeft=Ta(-he.window.scrollX+Vm().left)}_unstick(){this.isSticky=!1,this._isStickyToTheBottomOfLimiter=!1,this._stickyTopOffset=null,this._stickyBottomOffset=null,this._marginLeft=null}get _contentPanelRect(){return new Ve(this.contentPanelElement)}}class qU extends Yt{constructor(e,i){const n=e.t,r=Object.assign({},{showResetButton:!0,showIcon:!0,creator:On},i);super(e,r.creator);p(this,"iconView");p(this,"resetButtonView");p(this,"_viewConfig");this.label=i.label,this._viewConfig=r,this._viewConfig.showIcon&&(this.iconView=new Zn,this.iconView.content=bz,this.fieldWrapperChildren.add(this.iconView,0),this.extendTemplate({attributes:{class:"ck-search__query_with-icon"}})),this._viewConfig.showResetButton&&(this.resetButtonView=new ye(e),this.resetButtonView.set({label:n("Clear"),icon:Ac,class:"ck-search__reset",isVisible:!1,tooltip:!0}),this.resetButtonView.on("execute",()=>{this.reset(),this.focus(),this.fire("reset")}),this.resetButtonView.bind("isVisible").to(this.fieldView,"isEmpty",o=>!o),this.fieldWrapperChildren.add(this.resetButtonView),this.extendTemplate({attributes:{class:"ck-search__query_with-reset"}}))}reset(){this.fieldView.reset(),this._viewConfig.showResetButton&&(this.resetButtonView.isVisible=!1)}}class QI extends ue{constructor(){super();const t=this.bindTemplate;this.set({isVisible:!1,primaryText:"",secondaryText:""}),this.setTemplate({tag:"div",attributes:{class:["ck","ck-search__info",t.if("isVisible","ck-hidden",e=>!e)],tabindex:-1},children:[{tag:"span",children:[{text:[t.to("primaryText")]}]},{tag:"span",children:[{text:[t.to("secondaryText")]}]}]})}focus(){this.element.focus()}}class jU extends ue{constructor(e){super(e);p(this,"focusTracker");p(this,"children");p(this,"_focusCycler");this.children=this.createCollection(),this.focusTracker=new ot,this.setTemplate({tag:"div",attributes:{class:["ck","ck-search__results"],tabindex:-1},children:this.children}),this._focusCycler=new Ht({focusables:this.children,focusTracker:this.focusTracker})}render(){super.render();for(const e of this.children)this.focusTracker.add(e.element)}focus(){this._focusCycler.focusFirst()}focusFirst(){this._focusCycler.focusFirst()}focusLast(){this._focusCycler.focusLast()}}class NI extends ue{constructor(e,i){super(e);p(this,"focusTracker");p(this,"keystrokes");p(this,"resultsView");p(this,"filteredView");p(this,"infoView");p(this,"queryView");p(this,"focusCycler");p(this,"_config");this._config=i,this.filteredView=i.filteredView,this.queryView=this._createSearchTextQueryView(),this.focusTracker=new ot,this.keystrokes=new wt,this.resultsView=new jU(e),this.children=this.createCollection(),this.focusableChildren=this.createCollection([this.queryView,this.resultsView]),this.set("isEnabled",!0),this.set("resultsCount",0),this.set("totalItemsCount",0),i.infoView&&i.infoView.instance?this.infoView=i.infoView.instance:(this.infoView=new QI,this._enableDefaultInfoViewBehavior(),this.on("render",()=>{this.search("")})),this.resultsView.children.addMany([this.infoView,this.filteredView]),this.focusCycler=new Ht({focusables:this.focusableChildren,focusTracker:this.focusTracker,keystrokeHandler:this.keystrokes,actions:{focusPrevious:"shift + tab",focusNext:"tab"}}),this.on("search",(n,{resultsCount:r,totalItemsCount:o})=>{this.resultsCount=r,this.totalItemsCount=o}),this.setTemplate({tag:"div",attributes:{class:["ck","ck-search",i.class||null],tabindex:"-1"},children:this.children})}render(){super.render(),this.children.addMany([this.queryView,this.resultsView]);const e=i=>i.stopPropagation();for(const i of this.focusableChildren)this.focusTracker.add(i.element);this.keystrokes.listenTo(this.element),this.keystrokes.set("arrowright",e),this.keystrokes.set("arrowleft",e),this.keystrokes.set("arrowup",e),this.keystrokes.set("arrowdown",e)}focus(){this.queryView.focus()}reset(){this.queryView.reset(),this.search(""),this.filteredView.element.scrollTo(0,0)}search(e){const i=e?new RegExp(VO(e),"ig"):null,n=this.filteredView.filter(i);this.fire("search",{query:e,...n})}_createSearchTextQueryView(){const e=new qU(this.locale,this._config.queryView);return this.listenTo(e.fieldView,"input",()=>{this.search(e.fieldView.element.value)}),e.on("reset",()=>this.reset()),e.bind("isEnabled").to(this),e}_enableDefaultInfoViewBehavior(){const e=this.locale.t,i=this.infoView;this.on("search",(r,o)=>{if(o.resultsCount)i.set({isVisible:!1});else{const l=this._config.infoView&&this._config.infoView.text;let a,c;o.totalItemsCount?l!=null&&l.notFound?(a=l.notFound.primary,c=l.notFound.secondary):(a=e("No results found"),c=""):l!=null&&l.noSearchableItems?(a=l.noSearchableItems.primary,c=l.noSearchableItems.secondary):(a=e("No searchable items"),c=""),i.set({primaryText:n(a,o),secondaryText:n(c,o),isVisible:!0})}});function n(r,{query:o,resultsCount:l,totalItemsCount:a}){return typeof r=="function"?r(o,l,a):r}}}const ec=class ec extends NI{constructor(e,i){super(e,i);p(this,"_config");this._config=i;const n=No("px");this.extendTemplate({attributes:{class:["ck-autocomplete"]}});const r=this.resultsView.bindTemplate;this.resultsView.set("isVisible",!1),this.resultsView.set("_position","s"),this.resultsView.set("_width",0),this.resultsView.extendTemplate({attributes:{class:[r.if("isVisible","ck-hidden",o=>!o),r.to("_position",o=>`ck-search__results_${o}`)],style:{width:r.to("_width",n)}}}),this.focusTracker.on("change:isFocused",(o,l,a)=>{this._updateResultsVisibility(),a?this.resultsView.element.scrollTop=0:i.resetOnBlur&&this.queryView.reset()}),this.on("search",()=>{this._updateResultsVisibility(),this._updateResultsViewWidthAndPosition()}),this.keystrokes.set("esc",(o,l)=>{this.resultsView.isVisible&&(this.queryView.focus(),this.resultsView.isVisible=!1,l())}),this.listenTo(he.document,"scroll",()=>{this._updateResultsViewWidthAndPosition()}),this.on("change:isEnabled",()=>{this._updateResultsVisibility()}),this.filteredView.on("execute",(o,{value:l})=>{this.focus(),this.reset(),this.queryView.fieldView.value=this.queryView.fieldView.element.value=l,this.resultsView.isVisible=!1}),this.resultsView.on("change:isVisible",()=>{this._updateResultsViewWidthAndPosition()})}_updateResultsViewWidthAndPosition(){if(!this.resultsView.isVisible)return;this.resultsView._width=new Ve(this.queryView.fieldView.element).width;const e=ec._getOptimalPosition({element:this.resultsView.element,target:this.queryView.element,fitInViewport:!0,positions:ec.defaultResultsPositions});this.resultsView._position=e?e.name:"s"}_updateResultsVisibility(){const e=typeof this._config.queryMinChars>"u"?0:this._config.queryMinChars,i=this.queryView.fieldView.element.value.length;this.resultsView.isVisible=this.focusTracker.isFocused&&this.isEnabled&&i>=e}};p(ec,"defaultResultsPositions",[e=>({top:e.bottom,left:e.left,name:"s"}),(e,i)=>({top:e.top-i.height,left:e.left,name:"n"})]),p(ec,"_getOptimalPosition",vp);let jb=ec;class XU extends ue{constructor(){super(),this.set("isVisible",!1);const t=this.bindTemplate;this.setTemplate({tag:"span",attributes:{class:["ck","ck-spinner-container",t.if("isVisible","ck-hidden",e=>!e)]},children:[{tag:"span",attributes:{class:["ck","ck-spinner"]}}]})}}class GU extends Ul{constructor(e){super(e);p(this,"arrowView");const i=this.bindTemplate;this.set({withText:!0,role:"menuitem"}),this.arrowView=this._createArrowView(),this.extendTemplate({attributes:{class:["ck-menu-bar__menu__button"],"aria-haspopup":!0,"aria-expanded":this.bindTemplate.to("isOn",n=>String(n)),"data-cke-tooltip-disabled":i.to("isOn")},on:{mouseenter:i.to("mouseenter")}})}render(){super.render(),this.children.add(this.arrowView)}_createArrowView(){const e=new Zn;return e.content=ud,e.extendTemplate({attributes:{class:"ck-menu-bar__menu__button__arrow"}}),e}}class YU extends ue{constructor(e){super(e);p(this,"children");const i=this.bindTemplate;this.set("isVisible",!1),this.set("position","se"),this.children=this.createCollection(),this.setTemplate({tag:"div",attributes:{class:["ck","ck-reset","ck-menu-bar__menu__panel",i.to("position",n=>`ck-menu-bar__menu__panel_position_${n}`),i.if("isVisible","ck-hidden",n=>!n)],tabindex:"-1"},children:this.children,on:{selectstart:i.to(n=>{n.target.tagName.toLocaleLowerCase()!=="input"&&n.preventDefault()})}})}focus(e=1){this.children.length&&(e===1?this.children.first.focus():this.children.last.focus())}}const pp=class pp extends ue{constructor(e){super(e);p(this,"buttonView");p(this,"panelView");p(this,"focusTracker");p(this,"keystrokes");const i=this.bindTemplate;this.buttonView=new GU(e),this.buttonView.delegate("mouseenter").to(this),this.buttonView.bind("isOn","isEnabled").to(this,"isOpen","isEnabled"),this.panelView=new YU(e),this.panelView.bind("isVisible").to(this,"isOpen"),this.keystrokes=new wt,this.focusTracker=new ot,this.set("isOpen",!1),this.set("isEnabled",!0),this.set("panelPosition","w"),this.set("class",void 0),this.set("parentMenuView",null),this.setTemplate({tag:"div",attributes:{class:["ck","ck-menu-bar__menu",i.to("class"),i.if("isEnabled","ck-disabled",n=>!n),i.if("parentMenuView","ck-menu-bar__menu_top-level",n=>!n)]},children:[this.buttonView,this.panelView]})}render(){super.render(),this.focusTracker.add(this.buttonView.element),this.focusTracker.add(this.panelView.element),this.keystrokes.listenTo(this.element),ho.closeOnEscKey(this),this._repositionPanelOnOpen()}_attachBehaviors(){this.parentMenuView?(ho.openOnButtonClick(this),ho.openOnArrowRightKey(this),ho.closeOnArrowLeftKey(this),ho.openAndFocusOnEnterKeyPress(this),ho.closeOnParentClose(this)):(this._propagateArrowKeystrokeEvents(),ho.openAndFocusPanelOnArrowDownKey(this),ho.toggleOnButtonClick(this))}_propagateArrowKeystrokeEvents(){this.keystrokes.set("arrowright",(e,i)=>{this.fire("arrowright"),i()}),this.keystrokes.set("arrowleft",(e,i)=>{this.fire("arrowleft"),i()})}_repositionPanelOnOpen(){this.on("change:isOpen",(e,i,n)=>{if(!n)return;const r=pp._getOptimalPosition({element:this.panelView.element,target:this.buttonView.element,fitInViewport:!0,positions:this._panelPositions});this.panelView.position=r?r.name:this._defaultMenuPositionName})}focus(){this.buttonView.focus()}get _panelPositions(){const{southEast:e,southWest:i,northEast:n,northWest:r,westSouth:o,eastSouth:l,westNorth:a,eastNorth:c}=TU;return this.locale.uiLanguageDirection==="ltr"?this.parentMenuView?[l,c,o,a]:[e,i,n,r]:this.parentMenuView?[o,a,l,c]:[i,e,r,n]}get _defaultMenuPositionName(){return this.locale.uiLanguageDirection==="ltr"?this.parentMenuView?"es":"se":this.parentMenuView?"ws":"sw"}};p(pp,"_getOptimalPosition",vp);let cs=pp;class Al extends Wr{constructor(t){super(t),this.role="menu",this.items.on("change",this._setItemsCheckSpace.bind(this))}_setItemsCheckSpace(){const t=Array.from(this.items).some(e=>{const i=C2(e);return i&&i.isToggleable});this.items.forEach(e=>{const i=C2(e);i&&(i.hasCheckSpace=t)})}}function C2(s){return s instanceof Sn?s.children.map(t=>KU(t)?t.buttonView:t).find(t=>t instanceof Ul):null}function KU(s){return typeof s=="object"&&"buttonView"in s&&s.buttonView instanceof ye}class FI extends EW{constructor(t){super(t),this.set({withText:!0,withKeystroke:!0,tooltip:!1,role:"menuitem"}),this.extendTemplate({attributes:{class:["ck-menu-bar__menu__item__button"]}})}}const P2=["mouseenter","arrowleft","arrowright","change:isOpen"];class JU extends ue{constructor(e){super(e);p(this,"children");p(this,"menus",[]);const i=e.t,n=this.bindTemplate;this.set({isOpen:!1,isFocusBorderEnabled:!1}),this._setupIsOpenUpdater(),this.children=this.createCollection(),this.setTemplate({tag:"div",attributes:{class:["ck","ck-menu-bar",n.if("isFocusBorderEnabled","ck-menu-bar_focus-border-enabled")],"aria-label":i("Editor menu bar"),role:"menubar"},children:this.children})}fillFromConfig(e,i,n=[]){const r=this.locale,l=IU({normalizedConfig:e,locale:r,componentFactory:i,extraItems:n}).items.map(a=>this._createMenu({componentFactory:i,menuDefinition:a}));this.children.addMany(l)}render(){super.render(),Pa.toggleMenusAndFocusItemsOnHover(this),Pa.closeMenusWhenTheBarCloses(this),Pa.closeMenuWhenAnotherOnTheSameLevelOpens(this),Pa.focusCycleMenusOnArrows(this),Pa.closeOnClickOutside(this),Pa.enableFocusHighlightOnInteraction(this)}focus(){this.children.first&&this.children.first.focus()}close(){for(const e of this.children)e.isOpen=!1}disable(){for(const e of this.children)e.isEnabled=!1}enable(){for(const e of this.children)e.isEnabled=!0}registerMenu(e,i=null){i?(e.delegate(...P2).to(i),e.parentMenuView=i):e.delegate(...P2).to(this,n=>"menu:"+n),e._attachBehaviors(),this.menus.push(e)}_createMenu({componentFactory:e,menuDefinition:i,parentMenuView:n}){const r=this.locale,o=new cs(r);return this.registerMenu(o,n),o.buttonView.set({label:i.label}),o.once("change:isOpen",()=>{const l=new Al(r);l.ariaLabel=i.label,o.panelView.children.add(l),l.items.addMany(this._createMenuItems({menuDefinition:i,parentMenuView:o,componentFactory:e}))}),o}_createMenuItems({menuDefinition:e,parentMenuView:i,componentFactory:n}){const r=this.locale,o=[];for(const l of e.groups){for(const a of l.items){const c=new Tl(r,i);if(ds(a))c.children.add(this._createMenu({componentFactory:n,menuDefinition:a,parentMenuView:i}));else{const h=this._createMenuItemContentFromFactory({componentName:a,componentFactory:n,parentMenuView:i});if(!h)continue;c.children.add(h)}o.push(c)}l!==e.groups[e.groups.length-1]&&o.push(new ay(r))}return o}_createMenuItemContentFromFactory({componentName:e,parentMenuView:i,componentFactory:n}){const r=n.create(e);return r instanceof cs||r instanceof ti||r instanceof FI?(this._registerMenuTree(r,i),r.on("execute",()=>{this.close()}),r):(Ue("menu-bar-component-unsupported",{componentName:e,componentView:r}),null)}_registerMenuTree(e,i){if(!(e instanceof cs)){e.delegate("mouseenter").to(i);return}this.registerMenu(e,i);const n=e.panelView.children.filter(o=>o instanceof Al)[0];if(!n){e.delegate("mouseenter").to(i);return}const r=n.items.filter(o=>o instanceof Sn);for(const o of r)this._registerMenuTree(o.children.get(0),e)}_setupIsOpenUpdater(){let e;this.on("menu:change:isOpen",(i,n,r)=>{clearTimeout(e),r?this.isOpen=!0:e=setTimeout(()=>{this.isOpen=Array.from(this.children).some(o=>o.isOpen)},0)})}}/**
 * @license Copyright (c) 2003-2025, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options
 *//**
 * @license Copyright (c) 2003-2025, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options
 */class zI{constructor(t,e=20){p(this,"model");p(this,"limit");p(this,"_isLocked");p(this,"_size");p(this,"_batch",null);p(this,"_changeCallback");p(this,"_selectionChangeCallback");this.model=t,this._size=0,this.limit=e,this._isLocked=!1,this._changeCallback=(i,n)=>{n.isLocal&&n.isUndoable&&n!==this._batch&&this._reset(!0)},this._selectionChangeCallback=()=>{this._reset()},this.model.document.on("change",this._changeCallback),this.model.document.selection.on("change:range",this._selectionChangeCallback),this.model.document.selection.on("change:attribute",this._selectionChangeCallback)}get batch(){return this._batch||(this._batch=this.model.createBatch({isTyping:!0})),this._batch}get size(){return this._size}input(t){this._size+=t,this._size>=this.limit&&this._reset(!0)}get isLocked(){return this._isLocked}lock(){this._isLocked=!0}unlock(){this._isLocked=!1}destroy(){this.model.document.off("change",this._changeCallback),this.model.document.selection.off("change:range",this._selectionChangeCallback),this.model.document.selection.off("change:attribute",this._selectionChangeCallback)}_reset(t=!1){(!this.isLocked||t)&&(this._batch=null,this._size=0)}}class eZ extends Be{constructor(e,i){super(e);p(this,"_buffer");this._buffer=new zI(e.model,i),this._isEnabledBasedOnSelection=!1}get buffer(){return this._buffer}destroy(){super.destroy(),this._buffer.destroy()}execute(e={}){const i=this.editor.model,n=i.document,r=e.text||"",o=r.length;let l=n.selection;if(e.selection?l=e.selection:e.range&&(l=i.createSelection(e.range)),!i.canEditAt(l))return;const a=e.resultRange;i.enqueueChange(this._buffer.batch,c=>{this._buffer.lock();const h=Array.from(n.selection.getAttributes());i.deleteContent(l),r&&i.insertContent(c.createText(r,h),l),a?c.setSelection(a):l.is("documentSelection")||c.setSelection(l),this._buffer.unlock(),this._buffer.input(o)})}}const WI=["insertText","insertReplacementText"],tZ=[...WI,"insertCompositionText"];class iZ extends hr{constructor(e){super(e);p(this,"focusObserver");this.focusObserver=e.getObserver(xg);const i=Ie.isAndroid?tZ:WI,n=e.document;n.on("beforeinput",(r,o)=>{if(!this.isEnabled)return;const{data:l,targetRanges:a,inputType:c,domEvent:h,isComposing:f}=o;if(!i.includes(c))return;this.focusObserver.flush();const m=new Lr(n,"insertText");n.fire(m,new $r(e,h,{text:l,selection:e.createSelection(a),isComposing:f})),m.stop.called&&r.stop()}),Ie.isAndroid||n.on("compositionend",(r,{data:o,domEvent:l})=>{this.isEnabled&&o&&n.fire("insertText",new $r(e,l,{text:o,isComposing:!0}))},{priority:"low"})}observe(){}stopObserving(){}}class UI extends F{constructor(){super(...arguments);p(this,"_typingQueue")}static get pluginName(){return"Input"}static get isOfficialPlugin(){return!0}init(){const e=this.editor,i=e.model,n=e.editing.view,r=e.editing.mapper,o=i.document.selection;this._typingQueue=new nZ(e),n.addObserver(iZ);const l=new eZ(e,e.config.get("typing.undoStep")||20);e.commands.add("insertText",l),e.commands.add("input",l),this.listenTo(n.document,"beforeinput",()=>{this._typingQueue.flush("next beforeinput")},{priority:"high"}),this.listenTo(n.document,"insertText",(a,c)=>{const{text:h,selection:f}=c;if(n.document.selection.isFake&&f&&n.document.selection.isSimilar(f)&&c.preventDefault(),f&&Array.from(f.getRanges()).some(_=>!_.isCollapsed)&&c.preventDefault(),!l.isEnabled){c.preventDefault();return}let m;f?m=Array.from(f.getRanges()).map(_=>r.toModelRange(_)).map(_=>GO(_,i.schema)||_):m=Array.from(o.getRanges());let w=h;if(Ie.isAndroid){const _=Array.from(m[0].getItems()).reduce((k,C)=>k+(C.is("$textProxy")?C.data:""),"");if(_&&(_.length<=w.length?w.startsWith(_)&&(w=w.substring(_.length),m[0].start=m[0].start.getShiftedBy(_.length)):_.startsWith(w)&&(m[0].start=m[0].start.getShiftedBy(w.length),w="")),w.length==0&&m[0].isCollapsed)return}const O={text:w,selection:i.createSelection(m)};this._typingQueue.push(O,!!c.isComposing),c.domEvent.defaultPrevented&&this._typingQueue.flush("beforeinput default prevented")}),Ie.isAndroid?this.listenTo(n.document,"keydown",(a,c)=>{o.isCollapsed||c.keyCode!=229||!n.document.isComposing||T2(i,l)}):this.listenTo(n.document,"compositionstart",()=>{o.isCollapsed||T2(i,l)},{priority:"high"}),this.listenTo(n.document,"mutations",(a,{mutations:c})=>{if(this._typingQueue.hasAffectedElements())for(const{node:h}of c){const f=rZ(h,r),m=r.toModelElement(f);if(this._typingQueue.isElementAffected(m)){this._typingQueue.flush("mutations");return}}}),this.listenTo(n.document,"compositionend",()=>{this._typingQueue.flush("before composition end")},{priority:"high"}),this.listenTo(n.document,"compositionend",()=>{this._typingQueue.flush("after composition end");const a=[];if(this._typingQueue.hasAffectedElements())for(const c of this._typingQueue.flushAffectedElements()){const h=r.toViewElement(c);h&&a.push({type:"children",node:h})}(a.length||!Ie.isAndroid)&&n.document.fire("mutations",{mutations:a})},{priority:"lowest"})}destroy(){super.destroy(),this._typingQueue.destroy()}}class nZ{constructor(t){p(this,"editor");p(this,"flushDebounced",fs(()=>this.flush("timeout"),50));p(this,"_queue",[]);p(this,"_isComposing",!1);p(this,"_affectedElements",new Set);this.editor=t}destroy(){for(this.flushDebounced.cancel(),this._affectedElements.clear();this._queue.length;)this.shift()}get length(){return this._queue.length}push(t,e){const i={text:t.text};if(t.selection){i.selectionRanges=[];for(const n of t.selection.getRanges())i.selectionRanges.push(bn.fromRange(n)),this._affectedElements.add(n.start.parent)}this._queue.push(i),this._isComposing||(this._isComposing=e),this.flushDebounced()}shift(){const t=this._queue.shift(),e={text:t.text};if(t.selectionRanges){const i=t.selectionRanges.map(n=>sZ(n)).filter(n=>!!n);i.length&&(e.selection=this.editor.model.createSelection(i))}return e}flush(t){const e=this.editor,i=e.model,n=e.editing.view;if(this.flushDebounced.cancel(),!this._queue.length)return;const o=e.commands.get("insertText").buffer;i.enqueueChange(o.batch,()=>{for(o.lock();this._queue.length;){const l=this.shift();e.execute("insertText",l)}o.unlock(),this._isComposing||this._affectedElements.clear(),this._isComposing=!1}),n.scrollToTheSelection()}isElementAffected(t){return this._affectedElements.has(t)}hasAffectedElements(){return this._affectedElements.size>0}flushAffectedElements(){const t=Array.from(this._affectedElements);return this._affectedElements.clear(),t}}function T2(s,t){if(!t.isEnabled)return;const e=t.buffer;e.lock(),s.enqueueChange(e.batch,()=>{s.deleteContent(s.document.selection)}),e.unlock()}function sZ(s){const t=s.toRange();return s.detach(),t.root.rootName=="$graveyard"?null:t}function rZ(s,t){let e=s.is("$text")?s.parent:s;for(;!t.toModelElement(e);)e=e.parent;return e}class E2 extends Be{constructor(e,i){super(e);p(this,"direction");p(this,"_buffer");this.direction=i,this._buffer=new zI(e.model,e.config.get("typing.undoStep")),this._isEnabledBasedOnSelection=!1}get buffer(){return this._buffer}execute(e={}){const i=this.editor.model,n=i.document;i.enqueueChange(this._buffer.batch,r=>{this._buffer.lock();const o=r.createSelection(e.selection||n.selection);if(!i.canEditAt(o))return;const l=e.sequence||1,a=o.isCollapsed;if(o.isCollapsed&&i.modifySelection(o,{direction:this.direction,unit:e.unit,treatEmojiAsSingleUnit:!0}),this._shouldEntireContentBeReplacedWithParagraph(l)){this._replaceEntireContentWithParagraph(r);return}if(this._shouldReplaceFirstBlockWithParagraph(o,l)){this.editor.execute("paragraph",{selection:o});return}if(o.isCollapsed)return;let c=0;o.getFirstRange().getMinimalFlatRanges().forEach(h=>{c+=Pb(h.getWalker({singleCharacters:!0,ignoreElementEnd:!0,shallow:!0}))}),i.deleteContent(o,{doNotResetEntireContent:a,direction:this.direction}),this._buffer.input(c),r.setSelection(o),this._buffer.unlock()})}_shouldEntireContentBeReplacedWithParagraph(e){if(e>1)return!1;const i=this.editor.model,r=i.document.selection,o=i.schema.getLimitElement(r);if(!(r.isCollapsed&&r.containsEntireContent(o))||!i.schema.checkChild(o,"paragraph"))return!1;const a=o.getChild(0);return!(a&&a.is("element","paragraph"))}_replaceEntireContentWithParagraph(e){const i=this.editor.model,r=i.document.selection,o=i.schema.getLimitElement(r),l=e.createElement("paragraph");e.remove(e.createRangeIn(o)),e.insert(l,o),e.setSelection(l,0)}_shouldReplaceFirstBlockWithParagraph(e,i){const n=this.editor.model;if(i>1||this.direction!="backward"||!e.isCollapsed)return!1;const r=e.getFirstPosition(),o=n.schema.getLimitElement(r),l=o.getChild(0);return!(r.parent!=l||!e.containsEntireContent(l)||!n.schema.checkChild(o,"paragraph")||l.name=="paragraph")}}const oZ="character",A2="word",lZ="codePoint",bo="selection",za="backward",Gu="forward",ZI={deleteContent:{unit:bo,direction:za},deleteContentBackward:{unit:lZ,direction:za},deleteWordBackward:{unit:A2,direction:za},deleteHardLineBackward:{unit:bo,direction:za},deleteSoftLineBackward:{unit:bo,direction:za},deleteContentForward:{unit:oZ,direction:Gu},deleteWordForward:{unit:A2,direction:Gu},deleteHardLineForward:{unit:bo,direction:Gu},deleteSoftLineForward:{unit:bo,direction:Gu}};class aZ extends hr{constructor(t){super(t);const e=t.document;let i=0;e.on("keydown",()=>{i++}),e.on("keyup",()=>{i=0}),e.on("beforeinput",(n,r)=>{if(!this.isEnabled)return;const{targetRanges:o,domEvent:l,inputType:a}=r,c=ZI[a];if(!c)return;const h={direction:c.direction,unit:c.unit,sequence:i};h.unit==bo&&(h.selectionToRemove=t.createSelection(o[0])),a==="deleteContentBackward"&&(Ie.isAndroid&&(h.sequence=1),uZ(o)&&(h.unit=bo,h.selectionToRemove=t.createSelection(o)));const f=new Nl(e,"delete",o[0]);e.fire(f,new $r(t,l,h)),f.stop.called&&n.stop()}),Ie.isBlink&&cZ(this)}observe(){}stopObserving(){}}function cZ(s){const t=s.view,e=t.document;let i=null,n=!1;e.on("keydown",(l,{keyCode:a})=>{i=a,n=!1}),e.on("keyup",(l,{keyCode:a,domEvent:c})=>{const h=e.selection,f=s.isEnabled&&a==i&&r(a)&&!h.isCollapsed&&!n;if(i=null,f){const m=h.getFirstRange(),w=new Nl(e,"delete",m),O={unit:bo,direction:o(a),selectionToRemove:h};e.fire(w,new $r(t,c,O))}}),e.on("beforeinput",(l,{inputType:a})=>{const c=ZI[a];r(i)&&c&&c.direction==o(i)&&(n=!0)},{priority:"high"}),e.on("beforeinput",(l,{inputType:a,data:c})=>{i==ze.delete&&a=="insertText"&&c==""&&l.stop()},{priority:"high"});function r(l){return l==ze.backspace||l==ze.delete}function o(l){return l==ze.backspace?za:Gu}}function uZ(s){if(s.length!=1||s[0].isCollapsed)return!1;const t=s[0].getWalker({direction:"backward",singleCharacters:!0,ignoreElementEnd:!0});let e=0;for(const{nextPosition:i,item:n}of t){if(i.parent.is("$text")){const r=i.parent.data,o=i.offset;if(QO(r,o)||NO(r,o)||eA(r,o))continue;e++}else(n.is("containerElement")||n.is("emptyElement"))&&e++;if(e>1)return!0}return!1}class Hl extends F{constructor(){super(...arguments);p(this,"_undoOnBackspace")}static get pluginName(){return"Delete"}static get isOfficialPlugin(){return!0}init(){const e=this.editor,i=e.editing.view,n=i.document,r=e.model.document;i.addObserver(aZ),this._undoOnBackspace=!1;const o=new E2(e,"forward");e.commands.add("deleteForward",o),e.commands.add("forwardDelete",o),e.commands.add("delete",new E2(e,"backward")),this.listenTo(n,"delete",(l,a)=>{n.isComposing||a.preventDefault();const{direction:c,sequence:h,selectionToRemove:f,unit:m}=a,w=c==="forward"?"deleteForward":"delete",O={sequence:h};if(m=="selection"){const _=Array.from(f.getRanges()).map(k=>e.editing.mapper.toModelRange(k)).map(k=>GO(k,e.model.schema)||k);O.selection=e.model.createSelection(_)}else O.unit=m;e.execute(w,O),i.scrollToTheSelection()},{priority:"low"}),this.listenTo(n,"keydown",(l,a)=>{if(n.isComposing||a.keyCode!=ze.backspace||!r.selection.isCollapsed)return;const c=e.model.schema.getLimitElement(r.selection),h=e.model.createPositionAt(c,0);if(h.isTouching(r.selection.getFirstPosition())){a.preventDefault();const f=e.model.schema.getNearestSelectionRange(h,"forward");if(!f)return;const m=i.createSelection(e.editing.mapper.toViewRange(f)),w=m.getFirstRange(),O=new Nl(document,"delete",w),_={unit:"selection",direction:"backward",selectionToRemove:m};n.fire(O,new $r(i,a.domEvent,_))}}),this.editor.plugins.has("UndoEditing")&&(this.listenTo(n,"delete",(l,a)=>{this._undoOnBackspace&&a.direction=="backward"&&a.sequence==1&&a.unit=="codePoint"&&(this._undoOnBackspace=!1,e.execute("undo"),a.preventDefault(),l.stop())},{context:"$capture"}),this.listenTo(r,"change",()=>{this._undoOnBackspace=!1}))}requestUndoOnBackspace(){this.editor.plugins.has("UndoEditing")&&(this._undoOnBackspace=!0)}}class hy extends F{static get requires(){return[UI,Hl]}static get pluginName(){return"Typing"}static get isOfficialPlugin(){return!0}}/**
 * @license Copyright (c) 2003-2025, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options
 */function HI(s,t){let e=s.start;return{text:Array.from(s.getWalker({ignoreElementEnd:!1})).reduce((n,{item:r})=>r.is("$text")||r.is("$textProxy")?n+r.data:(e=t.createPositionAfter(r),""),""),range:t.createRange(e,s.end)}}class dy extends at(){constructor(e,i){super();p(this,"model");p(this,"testCallback");p(this,"_hasMatch");this.model=e,this.testCallback=i,this._hasMatch=!1,this.set("isEnabled",!0),this.on("change:isEnabled",()=>{this.isEnabled?this._startListening():(this.stopListening(e.document.selection),this.stopListening(e.document))}),this._startListening()}get hasMatch(){return this._hasMatch}_startListening(){const i=this.model.document;this.listenTo(i.selection,"change:range",(n,{directChange:r})=>{if(r){if(!i.selection.isCollapsed){this.hasMatch&&(this.fire("unmatched"),this._hasMatch=!1);return}this._evaluateTextBeforeSelection("selection")}}),this.listenTo(i,"change:data",(n,r)=>{r.isUndo||!r.isLocal||this._evaluateTextBeforeSelection("data",{batch:r})})}_evaluateTextBeforeSelection(e,i={}){const n=this.model,o=n.document.selection,l=n.createRange(n.createPositionAt(o.focus.parent,0),o.focus),{text:a,range:c}=HI(l,n),h=this.testCallback(a);if(!h&&this.hasMatch&&this.fire("unmatched"),this._hasMatch=!!h,h){const f=Object.assign(i,{text:a,range:c});typeof h=="object"&&Object.assign(f,h),this.fire(`matched:${e}`,f)}}}class Pg extends F{constructor(e){super(e);p(this,"attributes");p(this,"_overrideUid");p(this,"_isNextGravityRestorationSkipped",!1);this.attributes=new Set,this._overrideUid=null}static get pluginName(){return"TwoStepCaretMovement"}static get isOfficialPlugin(){return!0}init(){const e=this.editor,i=e.model,n=e.editing.view,r=e.locale,o=i.document.selection;this.listenTo(n.document,"arrowKey",(l,a)=>{if(!o.isCollapsed||a.shiftKey||a.altKey||a.ctrlKey)return;const c=a.keyCode==ze.arrowright,h=a.keyCode==ze.arrowleft;if(!c&&!h)return;const f=r.contentLanguageDirection;let m=!1;f==="ltr"&&c||f==="rtl"&&h?m=this._handleForwardMovement(a):m=this._handleBackwardMovement(a),m===!0&&l.stop()},{context:"$text",priority:"highest"}),this.listenTo(o,"change:range",(l,a)=>{if(this._isNextGravityRestorationSkipped){this._isNextGravityRestorationSkipped=!1;return}this._isGravityOverridden&&(!a.directChange&&Jn(o.getFirstPosition(),this.attributes)||this._restoreGravity())}),this._enableClickingAfterNode(),this._enableInsertContentSelectionAttributesFixer(),this._handleDeleteContentAfterNode()}registerAttribute(e){this.attributes.add(e)}_handleForwardMovement(e){const i=this.attributes,n=this.editor.model,r=n.document.selection,o=r.getFirstPosition();return this._isGravityOverridden||o.isAtStart&&vr(r,i)?!1:Jn(o,i)?(e&&Ru(e),vr(r,i)&&Jn(o,i,!0)?Iu(n,i):this._overrideGravity(),!0):!1}_handleBackwardMovement(e){const i=this.attributes,n=this.editor.model,r=n.document.selection,o=r.getFirstPosition();return this._isGravityOverridden?(e&&Ru(e),this._restoreGravity(),Jn(o,i,!0)?Iu(n,i):em(n,i,o),!0):o.isAtStart?vr(r,i)?(e&&Ru(e),em(n,i,o),!0):!1:!vr(r,i)&&Jn(o,i,!0)?(e&&Ru(e),em(n,i,o),!0):I2(o,i)?o.isAtEnd&&!vr(r,i)&&Jn(o,i)?(e&&Ru(e),em(n,i,o),!0):(this._isNextGravityRestorationSkipped=!0,this._overrideGravity(),!1):!1}_enableClickingAfterNode(){const e=this.editor,i=e.model,n=i.document.selection,r=e.editing.view.document;e.editing.view.addObserver(Pp),e.editing.view.addObserver(qN);let o=!1,l=!1;this.listenTo(r,"touchstart",()=>{l=!1,o=!0}),this.listenTo(r,"mousedown",()=>{l=!0}),this.listenTo(r,"selectionChange",()=>{const a=this.attributes;if(!l&&!o||(l=!1,o=!1,!n.isCollapsed)||!vr(n,a))return;const c=n.getFirstPosition();Jn(c,a)&&(c.isAtStart||Jn(c,a,!0)?Iu(i,a):this._isGravityOverridden||this._overrideGravity())})}_enableInsertContentSelectionAttributesFixer(){const i=this.editor.model,n=i.document.selection,r=this.attributes;this.listenTo(i,"insertContent",()=>{const o=n.getFirstPosition();vr(n,r)&&Jn(o,r)&&Iu(i,r)},{priority:"low"})}_handleDeleteContentAfterNode(){const e=this.editor,i=e.model,n=i.document.selection,r=e.editing.view;let o=!1,l=!1;this.listenTo(r.document,"delete",(a,c)=>{o=c.direction==="backward"},{priority:"high"}),this.listenTo(i,"deleteContent",()=>{if(!o)return;const a=n.getFirstPosition();l=vr(n,this.attributes)&&!I2(a,this.attributes)},{priority:"high"}),this.listenTo(i,"deleteContent",()=>{o&&(o=!1,!l&&e.model.enqueueChange(()=>{const a=n.getFirstPosition();vr(n,this.attributes)&&Jn(a,this.attributes)&&(a.isAtStart||Jn(a,this.attributes,!0)?Iu(i,this.attributes):this._isGravityOverridden||this._overrideGravity())}))},{priority:"low"})}get _isGravityOverridden(){return!!this._overrideUid}_overrideGravity(){this._overrideUid=this.editor.model.change(e=>e.overrideSelectionGravity())}_restoreGravity(){this.editor.model.change(e=>{e.restoreSelectionGravity(this._overrideUid),this._overrideUid=null})}}function vr(s,t){for(const e of t)if(s.hasAttribute(e))return!0;return!1}function em(s,t,e){const i=e.nodeBefore;s.change(n=>{if(i){const r=[],o=s.schema.isObject(i)&&s.schema.isInline(i);for(const[l,a]of i.getAttributes())s.schema.checkAttribute("$text",l)&&(!o||s.schema.getAttributeProperties(l).copyFromObject!==!1)&&r.push([l,a]);n.setSelectionAttribute(r)}else n.removeSelectionAttribute(t)})}function Iu(s,t){s.change(e=>{e.removeSelectionAttribute(t)})}function Ru(s){s.preventDefault()}function I2(s,t){const e=s.getShiftedBy(-1);return Jn(e,t)}function Jn(s,t,e=!1){const{nodeBefore:i,nodeAfter:n}=s;for(const r of t){const o=i?i.getAttribute(r):void 0,l=n?n.getAttribute(r):void 0;if(!(e&&(o===void 0||l===void 0))&&l!==o)return!0}return!1}const R2={copyright:{from:"(c)",to:"©"},registeredTrademark:{from:"(r)",to:"®"},trademark:{from:"(tm)",to:"™"},oneHalf:{from:/(^|[^/a-z0-9])(1\/2)([^/a-z0-9])$/i,to:[null,"½",null]},oneThird:{from:/(^|[^/a-z0-9])(1\/3)([^/a-z0-9])$/i,to:[null,"⅓",null]},twoThirds:{from:/(^|[^/a-z0-9])(2\/3)([^/a-z0-9])$/i,to:[null,"⅔",null]},oneForth:{from:/(^|[^/a-z0-9])(1\/4)([^/a-z0-9])$/i,to:[null,"¼",null]},threeQuarters:{from:/(^|[^/a-z0-9])(3\/4)([^/a-z0-9])$/i,to:[null,"¾",null]},lessThanOrEqual:{from:"<=",to:"≤"},greaterThanOrEqual:{from:">=",to:"≥"},notEqual:{from:"!=",to:"≠"},arrowLeft:{from:"<-",to:"←"},arrowRight:{from:"->",to:"→"},horizontalEllipsis:{from:"...",to:"…"},enDash:{from:/(^| )(--)( )$/,to:[null,"–",null]},emDash:{from:/(^| )(---)( )$/,to:[null,"—",null]},quotesPrimary:{from:Ea('"'),to:[null,"“",null,"”"]},quotesSecondary:{from:Ea("'"),to:[null,"‘",null,"’"]},quotesPrimaryEnGb:{from:Ea("'"),to:[null,"‘",null,"’"]},quotesSecondaryEnGb:{from:Ea('"'),to:[null,"“",null,"”"]},quotesPrimaryPl:{from:Ea('"'),to:[null,"„",null,"”"]},quotesSecondaryPl:{from:Ea("'"),to:[null,"‚",null,"’"]}},V2={symbols:["copyright","registeredTrademark","trademark"],mathematical:["oneHalf","oneThird","twoThirds","oneForth","threeQuarters","lessThanOrEqual","greaterThanOrEqual","notEqual","arrowLeft","arrowRight"],typography:["horizontalEllipsis","enDash","emDash"],quotes:["quotesPrimary","quotesSecondary"]},hZ=["symbols","mathematical","typography","quotes"];class dZ extends F{static get requires(){return["Delete","Input"]}static get pluginName(){return"TextTransformation"}static get isOfficialPlugin(){return!0}constructor(t){super(t),t.config.define("typing",{transformations:{include:hZ}})}init(){const e=this.editor.model.document.selection;e.on("change:range",()=>{this.isEnabled=!e.anchor.parent.is("element","codeBlock")}),this._enableTransformationWatchers()}_enableTransformationWatchers(){const t=this.editor,e=t.model,i=t.plugins.get("Delete"),n=pZ(t.config.get("typing.transformations")),r=l=>{for(const a of n)if(a.from.test(l))return{normalizedTransformation:a}},o=new dy(t.model,r);o.on("matched:data",(l,a)=>{if(!a.batch.isTyping)return;const{from:c,to:h}=a.normalizedTransformation,f=c.exec(a.text),m=h(f.slice(1)),w=a.range;let O=f.index;e.enqueueChange(_=>{for(let k=1;k<f.length;k++){const C=f[k],P=m[k-1];if(P==null){O+=C.length;continue}const M=w.start.getShiftedBy(O),Q=e.createRange(M,M.getShiftedBy(C.length)),N=gZ(M);e.insertContent(_.createText(P,N),Q),O+=P.length}e.enqueueChange(()=>{i.requestUndoOnBackspace()})})}),o.bind("isEnabled").to(this)}}function fZ(s){return typeof s=="string"?new RegExp(`(${VO(s)})$`):s}function mZ(s){return typeof s=="string"?()=>[s]:s instanceof Array?()=>s:s}function gZ(s){return(s.textNode?s.textNode:s.nodeAfter).getAttributes()}function Ea(s){return new RegExp(`(^|\\s)(${s})([^${s}]*)(${s})$`)}function pZ(s){const t=s.extra||[],e=s.remove||[],i=r=>!e.includes(r),n=s.include.concat(t).filter(i);return wZ(n).filter(i).map(r=>typeof r=="string"&&R2[r]?R2[r]:r).filter(r=>typeof r=="object").map(r=>({from:fZ(r.from),to:mZ(r.to)}))}function wZ(s){const t=new Set;for(const e of s)if(typeof e=="string"&&V2[e])for(const i of V2[e])t.add(i);else t.add(e);return Array.from(t)}/**
 * @license Copyright (c) 2003-2025, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options
 */function Ap(s,t,e,i){return i.createRange(M2(s,t,e,!0,i),M2(s,t,e,!1,i))}function M2(s,t,e,i,n){let r=s.textNode||(i?s.nodeBefore:s.nodeAfter),o=null;for(;r&&r.getAttribute(t)==e;)o=r,r=i?r.previousSibling:r.nextSibling;return o?n.createPositionAt(o,i?"before":"after"):s}function qI(s,t,e,i){const n=s.editing.view,r=new Set;n.document.registerPostFixer(o=>{const l=s.model.document.selection;let a=!1;if(l.hasAttribute(t)){const c=Ap(l.getFirstPosition(),t,l.getAttribute(t),s.model),h=s.editing.mapper.toViewRange(c);for(const f of h.getItems())f.is("element",e)&&!f.hasClass(i)&&(o.addClass(i,f),r.add(f),a=!0)}return a}),s.conversion.for("editingDowncast").add(o=>{o.on("insert",l,{priority:"highest"}),o.on("remove",l,{priority:"highest"}),o.on("attribute",l,{priority:"highest"}),o.on("selection",l,{priority:"highest"});function l(){n.change(a=>{for(const c of r.values())a.removeClass(i,c),r.delete(c)})}})}/**
 * @license Copyright (c) 2003-2025, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options
 */function fo(s,t,e,i){let n,r=null;typeof i=="function"?n=i:(r=s.commands.get(i),n=()=>{s.execute(i)}),s.model.document.on("change:data",(o,l)=>{if(r&&!r.isEnabled||!t.isEnabled)return;const a=$t(s.model.document.selection.getRanges());if(!a.isCollapsed||l.isUndo||!l.isLocal)return;const c=Array.from(s.model.document.differ.getChanges()),h=c[0];if(c.length!=1||h.type!=="insert"||h.name!="$text"||h.length!=1)return;const f=h.position.parent;if(f.is("element","codeBlock")||f.is("element","listItem")&&typeof i!="function"&&!["numberedList","bulletedList","todoList"].includes(i)||r&&r.value===!0)return;const m=f.getChild(0),w=s.model.createRangeOn(m);if(!w.containsRange(a)&&!a.end.isEqual(w.end))return;const O=e.exec(m.data.substr(0,a.end.offset));O&&s.model.enqueueChange(_=>{const k=_.createPositionAt(f,0),C=_.createPositionAt(f,O[0].length),P=new bn(k,C);if(n({match:O})!==!1){_.remove(P);const Q=s.model.document.selection.getFirstRange(),N=_.createRangeIn(f);f.isEmpty&&!N.isEqual(Q)&&!N.containsRange(Q,!0)&&_.remove(f)}P.detach(),s.model.enqueueChange(()=>{s.plugins.get("Delete").requestUndoOnBackspace()})})})}/**
 * @license Copyright (c) 2003-2025, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options
 */function Aa(s,t,e,i){let n,r;e instanceof RegExp?n=e:r=e,r=r||(o=>{let l;const a=[],c=[];for(;(l=n.exec(o))!==null&&!(l&&l.length<4);){let{index:h,"1":f,"2":m,"3":w}=l;const O=f+m+w;h+=l[0].length-O.length;const _=[h,h+f.length],k=[h+f.length+m.length,h+f.length+m.length+w.length];a.push(_),a.push(k),c.push([h+f.length,h+f.length+m.length])}return{remove:a,format:c}}),s.model.document.on("change:data",(o,l)=>{if(l.isUndo||!l.isLocal||!t.isEnabled)return;const a=s.model,c=a.document.selection;if(!c.isCollapsed)return;const h=Array.from(a.document.differ.getChanges()),f=h[0];if(h.length!=1||f.type!=="insert"||f.name!="$text"||f.length!=1)return;const m=c.focus,w=m.parent,{text:O,range:_}=xZ(a.createRange(a.createPositionAt(w,0),m),a),k=r(O),C=L2(_.start,k.format,a),P=L2(_.start,k.remove,a);C.length&&P.length&&a.enqueueChange(M=>{if(i(M,C)!==!1){for(const N of P.reverse())M.remove(N);a.enqueueChange(()=>{s.plugins.get("Delete").requestUndoOnBackspace()})}})})}function L2(s,t,e){return t.filter(i=>i[0]!==void 0&&i[1]!==void 0).map(i=>e.createRange(s.getShiftedBy(i[0]),s.getShiftedBy(i[1])))}function xZ(s,t){let e=s.start;return{text:Array.from(s.getItems()).reduce((n,r)=>!(r.is("$text")||r.is("$textProxy"))||r.getAttribute("code")?(e=t.createPositionAfter(r),""):n+r.data,""),range:t.createRange(e,s.end)}}class bZ extends F{static get requires(){return[Hl]}static get pluginName(){return"Autoformat"}static get isOfficialPlugin(){return!0}afterInit(){const t=this.editor,e=this.editor.t;this._addListAutoformats(),this._addBasicStylesAutoformats(),this._addHeadingAutoformats(),this._addBlockQuoteAutoformats(),this._addCodeBlockAutoformats(),this._addHorizontalLineAutoformats(),t.accessibility.addKeystrokeInfos({keystrokes:[{label:e("Revert autoformatting action"),keystroke:"Backspace"}]})}_addListAutoformats(){const t=this.editor.commands;t.get("bulletedList")&&fo(this.editor,this,/^[*-]\s$/,"bulletedList"),t.get("numberedList")&&fo(this.editor,this,/^1[.|)]\s$/,"numberedList"),t.get("todoList")&&fo(this.editor,this,/^\[\s?\]\s$/,"todoList"),t.get("checkTodoList")&&fo(this.editor,this,/^\[\s?x\s?\]\s$/,()=>{this.editor.execute("todoList"),this.editor.execute("checkTodoList")})}_addBasicStylesAutoformats(){const t=this.editor.commands;if(t.get("bold")){const e=tm(this.editor,"bold");Aa(this.editor,this,/(?:^|\s)(\*\*)([^*]+)(\*\*)$/g,e),Aa(this.editor,this,/(?:^|\s)(__)([^_]+)(__)$/g,e)}if(t.get("italic")){const e=tm(this.editor,"italic");Aa(this.editor,this,/(?:^|\s)(\*)([^*_]+)(\*)$/g,e),Aa(this.editor,this,/(?:^|\s)(_)([^_]+)(_)$/g,e)}if(t.get("code")){const e=tm(this.editor,"code");Aa(this.editor,this,/(`)([^`]+)(`)$/g,e)}if(t.get("strikethrough")){const e=tm(this.editor,"strikethrough");Aa(this.editor,this,/(~~)([^~]+)(~~)$/g,e)}}_addHeadingAutoformats(){const t=this.editor.commands.get("heading");t&&t.modelElements.filter(e=>e.match(/^heading[1-6]$/)).forEach(e=>{const i=e[7],n=new RegExp(`^(#{${i}})\\s$`);fo(this.editor,this,n,()=>{if(!t.isEnabled||t.value===e)return!1;this.editor.execute("heading",{value:e})})})}_addBlockQuoteAutoformats(){this.editor.commands.get("blockQuote")&&fo(this.editor,this,/^>\s$/,"blockQuote")}_addCodeBlockAutoformats(){const t=this.editor,e=t.model.document.selection;t.commands.get("codeBlock")&&fo(t,this,/^```$/,()=>{if(e.getFirstPosition().parent.is("element","listItem"))return!1;this.editor.execute("codeBlock",{usePreviousLanguageChoice:!0})})}_addHorizontalLineAutoformats(){this.editor.commands.get("horizontalLine")&&fo(this.editor,this,/^---$/,"horizontalLine")}}function tm(s,t){return(e,i)=>{if(!s.commands.get(t).isEnabled)return!1;const r=s.model.schema.getValidRanges(i,t);for(const o of r)e.setAttribute(t,!0,o);e.removeSelectionAttribute(t)}}/**
 * @license Copyright (c) 2003-2025, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options
 */class OZ extends F{constructor(e){super(e);p(this,"adapter");p(this,"_debouncedSave");p(this,"_lastDocumentVersion");p(this,"_savePromise");p(this,"_domEmitter");p(this,"_config");p(this,"_pendingActions");p(this,"_makeImmediateSave");p(this,"_action",null);const i=e.config.get("autosave")||{},n=i.waitingTime||1e3;this.set("state","synchronized"),this._debouncedSave=fs(this._save.bind(this),n),this._lastDocumentVersion=e.model.document.version,this._savePromise=null,this._domEmitter=new(qi()),this._config=i,this._pendingActions=e.plugins.get(Ro),this._makeImmediateSave=!1}static get pluginName(){return"Autosave"}static get isOfficialPlugin(){return!0}static get requires(){return[Ro]}init(){const e=this.editor,i=e.model.document;this.listenTo(e,"ready",()=>{this.listenTo(i,"change:data",(n,r)=>{this._saveCallbacks.length&&r.isLocal&&(this.state==="synchronized"&&(this.state="waiting",this._setPendingAction()),this.state==="waiting"&&this._debouncedSave())})}),this.listenTo(e,"destroy",()=>this._flush(),{priority:"highest"});/* istanbul ignore next -- @preserve */this._domEmitter.listenTo(window,"beforeunload",(n,r)=>{this._pendingActions.hasAny&&(r.returnValue=this._pendingActions.first.message)})}destroy(){this._domEmitter.stopListening(),super.destroy()}save(){return this._debouncedSave.cancel(),this._save()}_flush(){this._debouncedSave.flush()}_save(){return this._savePromise?(this._makeImmediateSave=this.editor.model.document.version>this._lastDocumentVersion,this._savePromise):(this._setPendingAction(),this.state="saving",this._lastDocumentVersion=this.editor.model.document.version,this._savePromise=Promise.resolve().then(()=>Promise.all(this._saveCallbacks.map(e=>e(this.editor)))).finally(()=>{this._savePromise=null}).then(()=>{if(this._makeImmediateSave)return this._makeImmediateSave=!1,this._save();this.editor.model.document.version>this._lastDocumentVersion?(this.state="waiting",this._debouncedSave()):(this.state="synchronized",this._pendingActions.remove(this._action),this._action=null)}).catch(e=>{throw this.state="error",this.state="saving",this._debouncedSave(),e}),this._savePromise)}_setPendingAction(){const e=this.editor.t;this._action||(this._action=this._pendingActions.add(e("Saving changes")))}get _saveCallbacks(){const e=[];return this.adapter&&this.adapter.save&&e.push(this.adapter.save),this._config.save&&e.push(this._config.save),e}}/**
 * @license Copyright (c) 2003-2025, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options
 */class fy extends Be{constructor(e,i){super(e);p(this,"attributeKey");this.attributeKey=i}refresh(){const e=this.editor.model,i=e.document;this.value=this._getValueFromFirstAllowedNode(),this.isEnabled=e.schema.checkAttributeInSelection(i.selection,this.attributeKey)}execute(e={}){const i=this.editor.model,r=i.document.selection,o=e.forceValue===void 0?!this.value:e.forceValue;i.change(l=>{if(r.isCollapsed)o?l.setSelectionAttribute(this.attributeKey,!0):l.removeSelectionAttribute(this.attributeKey);else{const a=i.schema.getValidRanges(r.getRanges(),this.attributeKey);for(const c of a)o?l.setAttribute(this.attributeKey,o,c):l.removeAttribute(this.attributeKey,c)}})}_getValueFromFirstAllowedNode(){const e=this.editor.model,i=e.schema,n=e.document.selection;if(n.isCollapsed)return n.hasAttribute(this.attributeKey);for(const r of n.getRanges())for(const o of r.getItems())if(i.checkAttribute(o,this.attributeKey))return o.hasAttribute(this.attributeKey);return!1}}const Ia="bold";class yZ extends F{static get pluginName(){return"BoldEditing"}static get isOfficialPlugin(){return!0}init(){const t=this.editor,e=this.editor.t;t.model.schema.extend("$text",{allowAttributes:Ia}),t.model.schema.setAttributeProperties(Ia,{isFormatting:!0,copyOnEnter:!0}),t.conversion.attributeToElement({model:Ia,view:"strong",upcastAlso:["b",i=>{const n=i.getStyle("font-weight");return n&&(n=="bold"||Number(n)>=600)?{name:!0,styles:["font-weight"]}:null}]}),t.commands.add(Ia,new fy(t,Ia)),t.keystrokes.set("CTRL+B",Ia),t.accessibility.addKeystrokeInfos({keystrokes:[{label:e("Bold text"),keystroke:"CTRL+B"}]})}}function my({editor:s,commandName:t,plugin:e,icon:i,label:n,keystroke:r}){return o=>{const l=s.commands.get(t),a=new o(s.locale);return a.set({label:n,icon:i,keystroke:r,isToggleable:!0}),a.bind("isEnabled").to(l,"isEnabled"),a.bind("isOn").to(l,"value"),a instanceof ti?a.set({role:"menuitemcheckbox"}):a.set({tooltip:!0}),e.listenTo(a,"execute",()=>{s.execute(t),s.editing.view.focus()}),a}}const wx="bold";class vZ extends F{static get pluginName(){return"BoldUI"}static get isOfficialPlugin(){return!0}init(){const t=this.editor,e=t.locale.t,i=my({editor:t,commandName:wx,plugin:this,icon:XA,label:e("Bold"),keystroke:"CTRL+B"});t.ui.componentFactory.add(wx,()=>i(ye)),t.ui.componentFactory.add("menuBar:"+wx,()=>i(ti))}}class _Z extends F{static get requires(){return[yZ,vZ]}static get pluginName(){return"Bold"}static get isOfficialPlugin(){return!0}}const al="code",kZ="ck-code_selected";class SZ extends F{static get pluginName(){return"CodeEditing"}static get isOfficialPlugin(){return!0}static get requires(){return[Pg]}init(){const t=this.editor,e=this.editor.t;t.model.schema.extend("$text",{allowAttributes:al}),t.model.schema.setAttributeProperties(al,{isFormatting:!0,copyOnEnter:!1}),t.conversion.attributeToElement({model:al,view:"code"}),t.commands.add(al,new fy(t,al)),t.plugins.get(Pg).registerAttribute(al),qI(t,al,"code",kZ),t.accessibility.addKeystrokeInfos({keystrokes:[{label:e("Move out of an inline code style"),keystroke:[["arrowleft","arrowleft"],["arrowright","arrowright"]]}]})}}const xx="code";class CZ extends F{static get pluginName(){return"CodeUI"}static get isOfficialPlugin(){return!0}init(){const t=this.editor,e=t.locale.t,i=my({editor:t,commandName:xx,plugin:this,icon:XF,label:e("Code")});t.ui.componentFactory.add(xx,()=>i(ye)),t.ui.componentFactory.add("menuBar:"+xx,()=>i(ti))}}class PZ extends F{static get requires(){return[SZ,CZ]}static get pluginName(){return"Code"}static get isOfficialPlugin(){return!0}}const Ra="italic";class TZ extends F{static get pluginName(){return"ItalicEditing"}static get isOfficialPlugin(){return!0}init(){const t=this.editor,e=this.editor.t;t.model.schema.extend("$text",{allowAttributes:Ra}),t.model.schema.setAttributeProperties(Ra,{isFormatting:!0,copyOnEnter:!0}),t.conversion.attributeToElement({model:Ra,view:"i",upcastAlso:["em",{styles:{"font-style":"italic"}}]}),t.commands.add(Ra,new fy(t,Ra)),t.keystrokes.set("CTRL+I",Ra),t.accessibility.addKeystrokeInfos({keystrokes:[{label:e("Italic text"),keystroke:"CTRL+I"}]})}}const bx="italic";class EZ extends F{static get pluginName(){return"ItalicUI"}static get isOfficialPlugin(){return!0}init(){const t=this.editor,e=t.locale.t,i=my({editor:t,commandName:bx,plugin:this,icon:cz,keystroke:"CTRL+I",label:e("Italic")});t.ui.componentFactory.add(bx,()=>i(ye)),t.ui.componentFactory.add("menuBar:"+bx,()=>i(ti))}}class AZ extends F{static get requires(){return[TZ,EZ]}static get pluginName(){return"Italic"}static get isOfficialPlugin(){return!0}}/**
 * @license Copyright (c) 2003-2025, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options
 *//**
 * @license Copyright (c) 2003-2025, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options
 */function*jI(s,t){for(const e of t)e&&s.getAttributeProperties(e[0]).copyOnEnter&&(yield e)}class IZ extends Be{execute(){this.editor.model.change(t=>{this.enterBlock(t),this.fire("afterExecute",{writer:t})})}enterBlock(t){const e=this.editor.model,i=e.document.selection,n=e.schema,r=i.isCollapsed,o=i.getFirstRange(),l=o.start.parent,a=o.end.parent;if(n.isLimit(l)||n.isLimit(a))return!r&&l==a&&e.deleteContent(i),!1;if(r){const c=jI(t.model.schema,i.getAttributes());return B2(t,o.start),t.setSelectionAttribute(c),!0}else{const c=!(o.start.isAtStart&&o.end.isAtEnd),h=l==a;if(e.deleteContent(i,{leaveUnmerged:c}),c){if(h)return B2(t,i.focus),!0;t.setSelection(a,0)}}return!1}}function B2(s,t){s.split(t),s.setSelection(t.parent.nextSibling,0)}const RZ={insertParagraph:{isSoft:!1},insertLineBreak:{isSoft:!0}};class XI extends hr{constructor(t){super(t);const e=this.document;let i=!1;e.on("keydown",(n,r)=>{i=r.shiftKey}),e.on("beforeinput",(n,r)=>{if(!this.isEnabled)return;let o=r.inputType;Ie.isSafari&&i&&o=="insertParagraph"&&(o="insertLineBreak");const l=r.domEvent,a=RZ[o];if(!a)return;const c=new Nl(e,"enter",r.targetRanges[0]);e.fire(c,new $r(t,l,{isSoft:a.isSoft})),c.stop.called&&n.stop()})}observe(){}stopObserving(){}}class Ip extends F{static get pluginName(){return"Enter"}static get isOfficialPlugin(){return!0}init(){const t=this.editor,e=t.editing.view,i=e.document,n=this.editor.t;e.addObserver(XI),t.commands.add("enter",new IZ(t)),this.listenTo(i,"enter",(r,o)=>{i.isComposing||o.preventDefault(),!o.isSoft&&(t.execute("enter"),e.scrollToTheSelection())},{priority:"low"}),t.accessibility.addKeystrokeInfos({keystrokes:[{label:n("Insert a hard break (a new paragraph)"),keystroke:"Enter"}]})}}class VZ extends Be{execute(){const t=this.editor.model,e=t.document;t.change(i=>{LZ(t,i,e.selection),this.fire("afterExecute",{writer:i})})}refresh(){const t=this.editor.model,e=t.document;this.isEnabled=MZ(t.schema,e.selection)}}function MZ(s,t){if(t.rangeCount>1)return!1;const e=t.anchor;if(!e||!s.checkChild(e,"softBreak"))return!1;const i=t.getFirstRange(),n=i.start.parent,r=i.end.parent;return!((Xb(n,s)||Xb(r,s))&&n!==r)}function LZ(s,t,e){const i=e.isCollapsed,n=e.getFirstRange(),r=n.start.parent,o=n.end.parent,l=r==o;if(i){const a=jI(s.schema,e.getAttributes());$2(s,t,n.end),t.removeSelectionAttribute(e.getAttributeKeys()),t.setSelectionAttribute(a)}else{const a=!(n.start.isAtStart&&n.end.isAtEnd);s.deleteContent(e,{leaveUnmerged:a}),l?$2(s,t,e.focus):a&&t.setSelection(o,0)}}function $2(s,t,e){const i=t.createElement("softBreak");s.insertContent(i,e),t.setSelection(i,"after")}function Xb(s,t){return s.is("rootElement")?!1:t.isLimit(s)||Xb(s.parent,t)}class GI extends F{static get pluginName(){return"ShiftEnter"}static get isOfficialPlugin(){return!0}init(){const t=this.editor,e=t.model.schema,i=t.conversion,n=t.editing.view,r=n.document,o=this.editor.t;e.register("softBreak",{allowWhere:"$text",isInline:!0}),i.for("upcast").elementToElement({model:"softBreak",view:"br"}),i.for("downcast").elementToElement({model:"softBreak",view:(l,{writer:a})=>a.createEmptyElement("br")}),n.addObserver(XI),t.commands.add("shiftEnter",new VZ(t)),this.listenTo(r,"enter",(l,a)=>{r.isComposing||a.preventDefault(),a.isSoft&&(t.execute("shiftEnter"),n.scrollToTheSelection())},{priority:"low"}),t.accessibility.addKeystrokeInfos({keystrokes:[{label:o("Insert a soft break (a <code>&lt;br&gt;</code> element)"),keystroke:"Shift+Enter"}]})}}/**
 * @license Copyright (c) 2003-2025, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options
 */class BZ extends pt(){constructor(){super(...arguments);p(this,"_stack",[])}add(e,i){const n=this._stack,r=n[0];this._insertDescriptor(e);const o=n[0];r!==o&&!Ox(r,o)&&this.fire("change:top",{oldDescriptor:r,newDescriptor:o,writer:i})}remove(e,i){const n=this._stack,r=n[0];this._removeDescriptor(e);const o=n[0];r!==o&&!Ox(r,o)&&this.fire("change:top",{oldDescriptor:r,newDescriptor:o,writer:i})}_insertDescriptor(e){const i=this._stack,n=i.findIndex(o=>o.id===e.id);if(Ox(e,i[n]))return;n>-1&&i.splice(n,1);let r=0;for(;i[r]&&$Z(i[r],e);)r++;i.splice(r,0,e)}_removeDescriptor(e){const i=this._stack,n=i.findIndex(r=>r.id===e);n>-1&&i.splice(n,1)}}function Ox(s,t){return s&&t&&s.priority==t.priority&&Tg(s.classes)==Tg(t.classes)}function $Z(s,t){return s.priority>t.priority?!0:s.priority<t.priority?!1:Tg(s.classes)>Tg(t.classes)}function Tg(s){return Array.isArray(s)?s.sort().join(","):s}const DZ="ck-widget",D2="ck-widget_selected";function Ut(s){return s.is("element")?!!s.getCustomProperty("widget"):!1}function fd(s,t,e={}){if(!s.is("containerElement"))throw new E("widget-to-widget-wrong-element-type",null,{element:s});return t.setAttribute("contenteditable","false",s),t.addClass(DZ,s),t.setCustomProperty("widget",!0,s),s.getFillerOffset=WZ,t.setCustomProperty("widgetLabel",[],s),e.label&&FZ(s,e.label),e.hasSelectionHandle&&UZ(s,t),YI(s,t),s}function QZ(s,t,e){if(t.classes&&e.addClass(dt(t.classes),s),t.attributes)for(const i in t.attributes)e.setAttribute(i,t.attributes[i],s)}function NZ(s,t,e){if(t.classes&&e.removeClass(dt(t.classes),s),t.attributes)for(const i in t.attributes)e.removeAttribute(i,s)}function YI(s,t,e=QZ,i=NZ){const n=new BZ;n.on("change:top",(l,a)=>{a.oldDescriptor&&i(s,a.oldDescriptor,a.writer),a.newDescriptor&&e(s,a.newDescriptor,a.writer)});const r=(l,a,c)=>n.add(a,c),o=(l,a,c)=>n.remove(a,c);t.setCustomProperty("addHighlight",r,s),t.setCustomProperty("removeHighlight",o,s)}function FZ(s,t){s.getCustomProperty("widgetLabel").push(t)}function zZ(s){return s.getCustomProperty("widgetLabel").reduce((e,i)=>typeof i=="function"?e?e+". "+i():i():e?e+". "+i:i,"")}function gy(s,t,e={}){return t.addClass(["ck-editor__editable","ck-editor__nested-editable"],s),e.withAriaRole!==!1&&t.setAttribute("role","textbox",s),t.setAttribute("tabindex","-1",s),e.label&&t.setAttribute("aria-label",e.label,s),t.setAttribute("contenteditable",s.isReadOnly?"false":"true",s),s.on("change:isReadOnly",(i,n,r)=>{t.setAttribute("contenteditable",r?"false":"true",s)}),s.on("change:isFocused",(i,n,r)=>{r?t.addClass("ck-editor__nested-editable_focused",s):t.removeClass("ck-editor__nested-editable_focused",s)}),YI(s,t),s}function KI(s,t){const e=s.getSelectedElement();if(e){const i=po(s);if(i)return t.createRange(t.createPositionAt(e,i))}return t.schema.findOptimalInsertionRange(s)}function WZ(){return null}function UZ(s,t){const e=t.createUIElement("div",{class:"ck ck-widget__selection-handle"},function(i){const n=this.toDomElement(i),r=new Zn;return r.set("content",KF),r.render(),n.appendChild(r.element),n});t.insert(t.createPositionAt(s,0),e),t.addClass(["ck-widget_with-selection-handle"],s)}function py(s){const t=l=>{const{width:a,paddingLeft:c,paddingRight:h}=l.ownerDocument.defaultView.getComputedStyle(l);return parseFloat(a)-(parseFloat(c)||0)-(parseFloat(h)||0)},e=s.parentElement;if(!e)return 0;let i=t(e);const n=5;let r=0,o=e;for(;isNaN(i);){if(o=o.parentElement,++r>n)return 0;i=t(o)}return i}function ZZ(s,t=new Ve(s)){const e=py(s);return e?t.width/e*100:0}const Sr="widget-type-around";function cl(s,t,e){return!!s&&Ut(s)&&!e.isInline(t)}function HZ(s){return s.closest(".ck-widget__type-around__button")}function qZ(s){return s.classList.contains("ck-widget__type-around__button_before")?"before":"after"}function jZ(s,t){const e=s.closest(".ck-widget");return t.mapDomToView(e)}function po(s){return s.getAttribute(Sr)}const JI=["before","after"],XZ=new DOMParser().parseFromString(Az,"image/svg+xml").firstChild,Q2="ck-widget__type-around_disabled";class GZ extends F{constructor(){super(...arguments);p(this,"_currentFakeCaretModelElement",null)}static get pluginName(){return"WidgetTypeAround"}static get isOfficialPlugin(){return!0}static get requires(){return[Ip,Hl]}init(){const e=this.editor,i=e.editing.view;this.on("change:isEnabled",(n,r,o)=>{i.change(l=>{for(const a of i.document.roots)o?l.removeClass(Q2,a):l.addClass(Q2,a)}),o||e.model.change(l=>{l.removeSelectionAttribute(Sr)})}),this._enableTypeAroundUIInjection(),this._enableInsertingParagraphsOnButtonClick(),this._enableInsertingParagraphsOnEnterKeypress(),this._enableInsertingParagraphsOnTypingKeystroke(),this._enableTypeAroundFakeCaretActivationUsingKeyboardArrows(),this._enableDeleteIntegration(),this._enableInsertContentIntegration(),this._enableInsertObjectIntegration(),this._enableDeleteContentIntegration()}destroy(){super.destroy(),this._currentFakeCaretModelElement=null}_insertParagraph(e,i){const n=this.editor,r=n.editing.view,o=n.model.schema.getAttributesWithProperty(e,"copyOnReplace",!0);n.execute("insertParagraph",{position:n.model.createPositionAt(e,i),attributes:o}),r.focus(),r.scrollToTheSelection()}_listenToIfEnabled(e,i,n,r){this.listenTo(e,i,(...o)=>{this.isEnabled&&n(...o)},r)}_insertParagraphAccordingToFakeCaretPosition(){const n=this.editor.model.document.selection,r=po(n);if(!r)return!1;const o=n.getSelectedElement();return this._insertParagraph(o,r),!0}_enableTypeAroundUIInjection(){const e=this.editor,i=e.model.schema,n=e.locale.t,r={before:n("Insert paragraph before block"),after:n("Insert paragraph after block")};e.editing.downcastDispatcher.on("insert",(o,l,a)=>{const c=a.mapper.toViewElement(l.item);c&&cl(c,l.item,i)&&(YZ(a.writer,r,c),c.getCustomProperty("widgetLabel").push(()=>this.isEnabled?n("Press Enter to type after or press Shift + Enter to type before the widget"):""))},{priority:"low"})}_enableTypeAroundFakeCaretActivationUsingKeyboardArrows(){const e=this.editor,i=e.model,n=i.document.selection,r=i.schema,o=e.editing.view;this._listenToIfEnabled(o.document,"arrowKey",(a,c)=>{this._handleArrowKeyPress(a,c)},{context:[Ut,"$text"],priority:"high"}),this._listenToIfEnabled(n,"change:range",(a,c)=>{c.directChange&&e.model.change(h=>{h.removeSelectionAttribute(Sr)})}),this._listenToIfEnabled(i.document,"change:data",()=>{const a=n.getSelectedElement();if(a){const c=e.editing.mapper.toViewElement(a);if(cl(c,a,r))return}e.model.change(c=>{c.removeSelectionAttribute(Sr)})}),this._listenToIfEnabled(e.editing.downcastDispatcher,"selection",(a,c,h)=>{const f=h.writer;if(this._currentFakeCaretModelElement){const _=h.mapper.toViewElement(this._currentFakeCaretModelElement);_&&(f.removeClass(JI.map(l),_),this._currentFakeCaretModelElement=null)}const m=c.selection.getSelectedElement();if(!m)return;const w=h.mapper.toViewElement(m);if(!cl(w,m,r))return;const O=po(c.selection);O&&(f.addClass(l(O),w),this._currentFakeCaretModelElement=m)}),this._listenToIfEnabled(e.ui.focusTracker,"change:isFocused",(a,c,h)=>{h||e.model.change(f=>{f.removeSelectionAttribute(Sr)})});function l(a){return`ck-widget_type-around_show-fake-caret_${a}`}}_handleArrowKeyPress(e,i){const n=this.editor,r=n.model,o=r.document.selection,l=r.schema,a=n.editing.view,c=i.keyCode,h=H9(c,n.locale.contentLanguageDirection),f=a.document.selection.getSelectedElement(),m=n.editing.mapper.toModelElement(f);let w;cl(f,m,l)?w=this._handleArrowKeyPressOnSelectedWidget(h):o.isCollapsed?w=this._handleArrowKeyPressWhenSelectionNextToAWidget(h):i.shiftKey||(w=this._handleArrowKeyPressWhenNonCollapsedSelection(h)),w&&(i.preventDefault(),e.stop())}_handleArrowKeyPressOnSelectedWidget(e){const n=this.editor.model,r=n.document.selection,o=po(r);return n.change(l=>{if(o){if(!(o===(e?"after":"before")))return l.removeSelectionAttribute(Sr),!0}else return l.setSelectionAttribute(Sr,e?"after":"before"),!0;return!1})}_handleArrowKeyPressWhenSelectionNextToAWidget(e){const i=this.editor,n=i.model,r=n.schema,o=i.plugins.get("Widget"),l=o._getObjectElementNextToSelection(e),a=i.editing.mapper.toViewElement(l);return cl(a,l,r)?(n.change(c=>{o._setSelectionOverElement(l),c.setSelectionAttribute(Sr,e?"before":"after")}),!0):!1}_handleArrowKeyPressWhenNonCollapsedSelection(e){const i=this.editor,n=i.model,r=n.schema,o=i.editing.mapper,l=n.document.selection,a=e?l.getLastPosition().nodeBefore:l.getFirstPosition().nodeAfter,c=o.toViewElement(a);return cl(c,a,r)?(n.change(h=>{h.setSelection(a,"on"),h.setSelectionAttribute(Sr,e?"after":"before")}),!0):!1}_enableInsertingParagraphsOnButtonClick(){const e=this.editor,i=e.editing.view;this._listenToIfEnabled(i.document,"mousedown",(n,r)=>{const o=HZ(r.domTarget);if(!o)return;const l=qZ(o),a=jZ(o,i.domConverter),c=e.editing.mapper.toModelElement(a);this._insertParagraph(c,l),r.preventDefault(),n.stop()})}_enableInsertingParagraphsOnEnterKeypress(){const e=this.editor,i=e.model.document.selection,n=e.editing.view;this._listenToIfEnabled(n.document,"enter",(r,o)=>{if(r.eventPhase!="atTarget")return;const l=i.getSelectedElement(),a=e.editing.mapper.toViewElement(l),c=e.model.schema;let h;this._insertParagraphAccordingToFakeCaretPosition()?h=!0:cl(a,l,c)&&(this._insertParagraph(l,o.isSoft?"before":"after"),h=!0),h&&(o.preventDefault(),r.stop())},{context:Ut})}_enableInsertingParagraphsOnTypingKeystroke(){const i=this.editor.editing.view.document;this._listenToIfEnabled(i,"insertText",(n,r)=>{this._insertParagraphAccordingToFakeCaretPosition()&&(r.selection=i.selection)},{priority:"high"}),Ie.isAndroid?this._listenToIfEnabled(i,"keydown",(n,r)=>{r.keyCode==229&&this._insertParagraphAccordingToFakeCaretPosition()}):this._listenToIfEnabled(i,"compositionstart",()=>{this._insertParagraphAccordingToFakeCaretPosition()},{priority:"highest"})}_enableDeleteIntegration(){const e=this.editor,i=e.editing.view,n=e.model,r=n.schema;this._listenToIfEnabled(i.document,"delete",(o,l)=>{if(o.eventPhase!="atTarget")return;const a=po(n.document.selection);if(!a)return;const c=l.direction,h=n.document.selection.getSelectedElement(),f=a==="before",m=c=="forward";if(f===m)e.execute("delete",{selection:n.createSelection(h,"on")});else{const O=r.getNearestSelectionRange(n.createPositionAt(h,a),c);if(O)if(!O.isCollapsed)n.change(_=>{_.setSelection(O),e.execute(m?"deleteForward":"delete")});else{const _=n.createSelection(O.start);if(n.modifySelection(_,{direction:c}),!_.focus.isEqual(O.start))n.change(k=>{k.setSelection(O),e.execute(m?"deleteForward":"delete")});else{const k=eH(r,O.start.parent);n.deleteContent(n.createSelection(k,"on"),{doNotAutoparagraph:!0})}}}l.preventDefault(),o.stop()},{context:Ut})}_enableInsertContentIntegration(){const e=this.editor,i=this.editor.model,n=i.document.selection;this._listenToIfEnabled(e.model,"insertContent",(r,[o,l])=>{if(l&&!l.is("documentSelection"))return;const a=po(n);if(a)return r.stop(),i.change(c=>{const h=n.getSelectedElement(),f=i.createPositionAt(h,a),m=c.createSelection(f),w=i.insertContent(o,m);return c.setSelection(m),w})},{priority:"high"})}_enableInsertObjectIntegration(){const e=this.editor,n=this.editor.model.document.selection;this._listenToIfEnabled(e.model,"insertObject",(r,o)=>{const[,l,a={}]=o;if(l&&!l.is("documentSelection"))return;const c=po(n);c&&(a.findOptimalPosition=c,o[3]=a)},{priority:"high"})}_enableDeleteContentIntegration(){const e=this.editor,n=this.editor.model.document.selection;this._listenToIfEnabled(e.model,"deleteContent",(r,[o])=>{if(o&&!o.is("documentSelection"))return;po(n)&&r.stop()},{priority:"high"})}}function YZ(s,t,e){const i=s.createUIElement("div",{class:"ck ck-reset_all ck-widget__type-around"},function(n){const r=this.toDomElement(n);return KZ(r,t),JZ(r),r});s.insert(s.createPositionAt(e,"end"),i)}function KZ(s,t){for(const e of JI){const i=new zn({tag:"div",attributes:{class:["ck","ck-widget__type-around__button",`ck-widget__type-around__button_${e}`],title:t[e],"aria-hidden":"true"},children:[s.ownerDocument.importNode(XZ,!0)]});s.appendChild(i.render())}}function JZ(s){const t=new zn({tag:"div",attributes:{class:["ck","ck-widget__type-around__fake-caret"]}});s.appendChild(t.render())}function eH(s,t){let e=t;for(const i of t.getAncestors({parentFirst:!0})){if(i.childCount>1||s.isLimit(i))break;e=i}return e}function tH(s){const t=s.model;return(e,i)=>{const n=i.keyCode==ze.arrowup,r=i.keyCode==ze.arrowdown,o=i.shiftKey,l=t.document.selection;if(!n&&!r)return;const a=r;if(o&&sH(l,a))return;const c=iH(s,l,a);if(c){if(c.isCollapsed){if(l.isCollapsed)return;if(o)return}(c.isCollapsed||nH(s,c,a))&&(t.change(h=>{const f=a?c.end:c.start;if(o){const m=t.createSelection(l.anchor);m.setFocus(f),h.setSelection(m)}else h.setSelection(f)}),e.stop(),i.preventDefault(),i.stopPropagation())}}}function iH(s,t,e){const i=s.model;if(e){const n=t.isCollapsed?t.focus:t.getLastPosition(),r=N2(i,n,"forward");if(!r)return null;const o=i.createRange(n,r),l=F2(i.schema,o,"backward");return l?i.createRange(n,l):null}else{const n=t.isCollapsed?t.focus:t.getFirstPosition(),r=N2(i,n,"backward");if(!r)return null;const o=i.createRange(r,n),l=F2(i.schema,o,"forward");return l?i.createRange(l,n):null}}function N2(s,t,e){const i=s.schema,n=s.createRangeIn(t.root),r=e=="forward"?"elementStart":"elementEnd";for(const{previousPosition:o,item:l,type:a}of n.getWalker({startPosition:t,direction:e})){if(i.isLimit(l)&&!i.isInline(l))return o;if(a==r&&i.isBlock(l))return null}return null}function F2(s,t,e){const i=e=="backward"?t.end:t.start;if(s.checkChild(i,"$text"))return i;for(const{nextPosition:n}of t.getWalker({direction:e}))if(s.checkChild(n,"$text"))return n;return null}function nH(s,t,e){const i=s.model,n=s.view.domConverter;if(e){const c=i.createSelection(t.start);i.modifySelection(c),!c.focus.isAtEnd&&!t.start.isEqual(c.focus)&&(t=i.createRange(c.focus,t.end))}const r=s.mapper.toViewRange(t),o=n.viewRangeToDom(r),l=Ve.getDomRangeRects(o);let a;for(const c of l){if(a===void 0){a=Math.round(c.bottom);continue}if(Math.round(c.top)>=a)return!1;a=Math.max(a,Math.round(c.bottom))}return!0}function sH(s,t){return!s.isCollapsed&&s.isBackward==t}class Lc extends F{constructor(){super(...arguments);p(this,"_previouslySelected",new Set)}static get pluginName(){return"Widget"}static get isOfficialPlugin(){return!0}static get requires(){return[GZ,Hl]}init(){const e=this.editor,i=e.editing.view,n=i.document,r=e.t;this.editor.editing.downcastDispatcher.on("selection",(o,l,a)=>{const c=a.writer,h=l.selection;if(h.isCollapsed)return;const f=h.getSelectedElement();if(!f)return;const m=e.editing.mapper.toViewElement(f);Ut(m)&&a.consumable.consume(h,"selection")&&c.setSelection(c.createRangeOn(m),{fake:!0,label:zZ(m)})}),this.editor.editing.downcastDispatcher.on("selection",(o,l,a)=>{this._clearPreviouslySelectedWidgets(a.writer);const c=a.writer,h=c.document.selection;let f=null;for(const m of h.getRanges())for(const w of m){const O=w.item;Ut(O)&&!lH(O,f)&&(c.addClass(D2,O),this._previouslySelected.add(O),f=O)}},{priority:"low"}),i.addObserver(Pp),this.listenTo(n,"mousedown",(...o)=>this._onMousedown(...o)),this.listenTo(n,"arrowKey",(...o)=>{this._handleSelectionChangeOnArrowKeyPress(...o)},{context:[Ut,"$text"]}),this.listenTo(n,"arrowKey",(...o)=>{this._preventDefaultOnArrowKeyPress(...o)},{context:"$root"}),this.listenTo(n,"arrowKey",tH(this.editor.editing),{context:"$text"}),this.listenTo(n,"delete",(o,l)=>{this._handleDelete(l.direction=="forward")&&(l.preventDefault(),o.stop())},{context:"$root"}),this.listenTo(n,"tab",(o,l)=>{o.eventPhase=="atTarget"&&(l.shiftKey||this._selectFirstNestedEditable()&&(l.preventDefault(),o.stop()))},{context:Ut,priority:"low"}),this.listenTo(n,"tab",(o,l)=>{l.shiftKey&&this._selectAncestorWidget()&&(l.preventDefault(),o.stop())},{priority:"low"}),this.listenTo(n,"keydown",(o,l)=>{l.keystroke==ze.esc&&this._selectAncestorWidget()&&(l.preventDefault(),o.stop())},{priority:"low"}),e.accessibility.addKeystrokeInfoGroup({id:"widget",label:r("Keystrokes that can be used when a widget is selected (for example: image, table, etc.)"),keystrokes:[{label:r("Move focus from an editable area back to the parent widget"),keystroke:"Esc"},{label:r("Insert a new paragraph directly after a widget"),keystroke:"Enter"},{label:r("Insert a new paragraph directly before a widget"),keystroke:"Shift+Enter"},{label:r("Move the caret to allow typing directly before a widget"),keystroke:[["arrowup"],["arrowleft"]]},{label:r("Move the caret to allow typing directly after a widget"),keystroke:[["arrowdown"],["arrowright"]]}]})}_onMousedown(e,i){const n=this.editor,r=n.editing.view,o=r.document;let l=i.target;if(!l)return;if(i.domEvent.detail>=3){this._selectBlockContent(l)&&i.preventDefault();return}if(!Ut(l)){const c=rH(l);if(!c)return;if(Ut(c))l=c;else{const h=oH(r,i);if(h&&Ut(h))l=h;else return}}Ie.isAndroid&&i.preventDefault(),o.isFocused||r.focus();const a=n.editing.mapper.toModelElement(l);this._setSelectionOverElement(a)}_selectBlockContent(e){const i=this.editor,n=i.model,r=i.editing.mapper,o=n.schema,l=r.findMappedViewAncestor(this.editor.editing.view.createPositionAt(e,0)),a=aH(r.toModelElement(l),n.schema);return a?(n.change(c=>{const h=o.isLimit(a)?null:cH(c.createPositionAfter(a),o),f=c.createPositionAt(a,0),m=h?c.createPositionAt(h,0):c.createPositionAt(a,"end");c.setSelection(c.createRange(f,m))}),!0):!1}_handleSelectionChangeOnArrowKeyPress(e,i){const n=i.keyCode,r=this.editor.model,o=r.schema,l=r.document.selection,a=l.getSelectedElement(),c=$O(n,this.editor.locale.contentLanguageDirection),h=c=="down"||c=="right",f=c=="up"||c=="down";if(a&&o.isObject(a)){const w=h?l.getLastPosition():l.getFirstPosition(),O=o.getNearestSelectionRange(w,h?"forward":"backward");O&&(r.change(_=>{_.setSelection(O)}),i.preventDefault(),e.stop());return}if(!l.isCollapsed&&!i.shiftKey){const w=l.getFirstPosition(),O=l.getLastPosition(),_=w.nodeAfter,k=O.nodeBefore;(_&&o.isObject(_)||k&&o.isObject(k))&&(r.change(C=>{C.setSelection(h?O:w)}),i.preventDefault(),e.stop());return}if(!l.isCollapsed)return;const m=this._getObjectElementNextToSelection(h);if(m&&o.isObject(m)){if(o.isInline(m)&&f)return;this._setSelectionOverElement(m),i.preventDefault(),e.stop()}}_preventDefaultOnArrowKeyPress(e,i){const n=this.editor.model,r=n.schema,o=n.document.selection.getSelectedElement();o&&r.isObject(o)&&(i.preventDefault(),e.stop())}_handleDelete(e){const n=this.editor.model.document.selection;if(!this.editor.model.canEditAt(n)||!n.isCollapsed)return;const r=this._getObjectElementNextToSelection(e);if(r)return this.editor.model.change(o=>{let l=n.anchor.parent;for(;l.isEmpty;){const a=l;l=a.parent,o.remove(a)}this._setSelectionOverElement(r)}),!0}_setSelectionOverElement(e){this.editor.model.change(i=>{i.setSelection(i.createRangeOn(e))})}_getObjectElementNextToSelection(e){const i=this.editor.model,n=i.schema,r=i.document.selection,o=i.createSelection(r);if(i.modifySelection(o,{direction:e?"forward":"backward"}),o.isEqual(r))return null;const l=e?o.focus.nodeBefore:o.focus.nodeAfter;return l&&n.isObject(l)?l:null}_clearPreviouslySelectedWidgets(e){for(const i of this._previouslySelected)e.removeClass(D2,i);this._previouslySelected.clear()}_selectFirstNestedEditable(){const e=this.editor,n=this.editor.editing.view.document;for(const r of n.selection.getFirstRange().getItems())if(r.is("editableElement")){const o=e.editing.mapper.toModelElement(r);/* istanbul ignore next -- @preserve */if(!o)continue;const l=e.model.createPositionAt(o,0),a=e.model.schema.getNearestSelectionRange(l,"forward");return e.model.change(c=>{c.setSelection(a)}),!0}return!1}_selectAncestorWidget(){const e=this.editor,i=e.editing.mapper,r=e.editing.view.document.selection.getFirstPosition().parent,l=(r.is("$text")?r.parent:r).findAncestor(Ut);if(!l)return!1;const a=i.toModelElement(l);/* istanbul ignore next -- @preserve */return a?(e.model.change(c=>{c.setSelection(a,"on")}),!0):!1}}function rH(s){let t=s;for(;t;){if(t.is("editableElement")||Ut(t))return t;t=t.parent}return null}function oH(s,t){const e=U6(t.domEvent);let i=null;if(e?i=s.domConverter.domRangeToView(e):i=s.createRange(s.createPositionAt(t.target,0)),!i)return null;const n=i.start;if(!n.parent)return null;let r=n.parent;return n.parent.is("editableElement")&&(n.isAtEnd&&n.nodeBefore?r=n.nodeBefore:n.isAtStart&&n.nodeAfter&&(r=n.nodeAfter)),r.is("$text")?r.parent:r}function lH(s,t){return t?Array.from(s.getAncestors()).includes(t):!1}function aH(s,t){for(const e of s.getAncestors({includeSelf:!0,parentFirst:!0})){if(t.checkChild(e,"$text"))return e;if(t.isLimit(e)&&!t.isObject(e))break}return null}function cH(s,t){const e=new Ar({startPosition:s});for(const{item:i}of e){if(t.isLimit(i)||!i.is("element"))return null;if(t.checkChild(i,"$text"))return i}return null}class Eg extends F{constructor(){super(...arguments);p(this,"_toolbarDefinitions",new Map);p(this,"_balloon")}static get requires(){return[gs]}static get pluginName(){return"WidgetToolbarRepository"}static get isOfficialPlugin(){return!0}init(){const e=this.editor;if(e.plugins.has("BalloonToolbar")){const i=e.plugins.get("BalloonToolbar");this.listenTo(i,"show",n=>{uH(e.editing.view.document.selection)&&n.stop()},{priority:"high"})}this._balloon=this.editor.plugins.get("ContextualBalloon"),this.on("change:isEnabled",()=>{this._updateToolbarsVisibility()}),this.listenTo(e.ui,"update",()=>{this._updateToolbarsVisibility()}),this.listenTo(e.ui.focusTracker,"change:isFocused",()=>{this._updateToolbarsVisibility()},{priority:"low"})}destroy(){super.destroy();for(const e of this._toolbarDefinitions.values())e.view.destroy()}register(e,{ariaLabel:i,items:n,getRelatedElement:r,balloonClassName:o="ck-toolbar-container",positions:l}){if(!n.length){Ue("widget-toolbar-no-items",{toolbarId:e});return}const a=this.editor,c=a.t,h=new Vo(a.locale);if(h.ariaLabel=i||c("Widget toolbar"),this._toolbarDefinitions.has(e))throw new E("widget-toolbar-duplicated",this,{toolbarId:e});const f={view:h,getRelatedElement:r,balloonClassName:o,itemsConfig:n,positions:l,initialized:!1};a.ui.addToolbar(h,{isContextual:!0,beforeFocus:()=>{const m=r(a.editing.view.document.selection);m&&this._showToolbar(f,m)},afterBlur:()=>{this._hideToolbar(f)}}),this._toolbarDefinitions.set(e,f)}_updateToolbarsVisibility(){let e=0,i=null,n=null;for(const r of this._toolbarDefinitions.values()){const o=r.getRelatedElement(this.editor.editing.view.document.selection);if(!this.isEnabled||!o)this._isToolbarInBalloon(r)&&this._hideToolbar(r);else if(!this.editor.ui.focusTracker.isFocused)this._isToolbarVisible(r)&&this._hideToolbar(r);else{const l=o.getAncestors().length;l>e&&(e=l,i=o,n=r)}}n&&this._showToolbar(n,i)}_hideToolbar(e){this._balloon.remove(e.view),this.stopListening(this._balloon,"change:visibleView")}_showToolbar(e,i){this._isToolbarVisible(e)?z2(this.editor,i,e.positions):this._isToolbarInBalloon(e)||(e.initialized||(e.initialized=!0,e.view.fillFromConfig(e.itemsConfig,this.editor.ui.componentFactory)),this._balloon.add({view:e.view,position:e7(this.editor,i,e.positions),balloonClassName:e.balloonClassName}),this.listenTo(this._balloon,"change:visibleView",()=>{for(const n of this._toolbarDefinitions.values())if(this._isToolbarVisible(n)){const r=n.getRelatedElement(this.editor.editing.view.document.selection);z2(this.editor,r,e.positions)}}))}_isToolbarVisible(e){return this._balloon.visibleView===e.view}_isToolbarInBalloon(e){return this._balloon.hasView(e.view)}}function z2(s,t,e){const i=s.plugins.get("ContextualBalloon"),n=e7(s,t,e);i.updatePosition(n)}function e7(s,t,e){const i=s.editing.view,n=Fi.defaultPositions;return{target:i.domConverter.mapViewToDom(t),positions:e||[n.northArrowSouth,n.northArrowSouthWest,n.northArrowSouthEast,n.southArrowNorth,n.southArrowNorthWest,n.southArrowNorthEast,n.viewportStickyNorth]}}function uH(s){const t=s.getSelectedElement();return!!(t&&Ut(t))}class hH extends at(){constructor(e){super();p(this,"_referenceCoordinates");p(this,"_options");p(this,"_originalWidth");p(this,"_originalHeight");p(this,"_originalWidthPercents");p(this,"_aspectRatio");this.set("activeHandlePosition",null),this.set("proposedWidthPercents",null),this.set("proposedWidth",null),this.set("proposedHeight",null),this.set("proposedHandleHostWidth",null),this.set("proposedHandleHostHeight",null),this._options=e,this._referenceCoordinates=null}get originalWidth(){return this._originalWidth}get originalHeight(){return this._originalHeight}get originalWidthPercents(){return this._originalWidthPercents}get aspectRatio(){return this._aspectRatio}begin(e,i,n){const r=new Ve(i);this.activeHandlePosition=mH(e),this._referenceCoordinates=dH(i,gH(this.activeHandlePosition)),this._originalWidth=r.width,this._originalHeight=r.height,this._aspectRatio=r.width/r.height;const o=n.style.width;o&&o.match(/^\d+(\.\d*)?%$/)?this._originalWidthPercents=parseFloat(o):this._originalWidthPercents=ZZ(n,r)}update(e){this.proposedWidth=e.width,this.proposedHeight=e.height,this.proposedWidthPercents=e.widthPercents,this.proposedHandleHostWidth=e.handleHostWidth,this.proposedHandleHostHeight=e.handleHostHeight}}function dH(s,t){const e=new Ve(s),i=t.split("-"),n={x:i[1]=="right"?e.right:e.left,y:i[0]=="bottom"?e.bottom:e.top};return n.x+=s.ownerDocument.defaultView.scrollX,n.y+=s.ownerDocument.defaultView.scrollY,n}function fH(s){return`ck-widget__resizer__handle-${s}`}function mH(s){const t=["top-left","top-right","bottom-right","bottom-left"];for(const e of t)if(s.classList.contains(fH(e)))return e}function gH(s){const t=s.split("-"),e={top:"bottom",bottom:"top",left:"right",right:"left"};return`${e[t[0]]}-${e[t[1]]}`}class pH extends ue{constructor(){super();const t=this.bindTemplate;this.setTemplate({tag:"div",attributes:{class:["ck","ck-size-view",t.to("_viewPosition",e=>e?`ck-orientation-${e}`:"")],style:{display:t.if("_isVisible","none",e=>!e)}},children:[{text:t.to("_label")}]})}_bindToState(t,e){this.bind("_isVisible").to(e,"proposedWidth",e,"proposedHeight",(i,n)=>i!==null&&n!==null),this.bind("_label").to(e,"proposedHandleHostWidth",e,"proposedHandleHostHeight",e,"proposedWidthPercents",(i,n,r)=>t.unit==="px"?`${i}×${n}`:`${r}%`),this.bind("_viewPosition").to(e,"activeHandlePosition",e,"proposedHandleHostWidth",e,"proposedHandleHostHeight",(i,n,r)=>n<50||r<50?"above-center":i)}_dismiss(){this.unbind(),this._isVisible=!1}}class W2 extends at(){constructor(e){super();p(this,"_state");p(this,"_sizeView");p(this,"_options");p(this,"_viewResizerWrapper",null);p(this,"_initialViewWidth");this._options=e,this.set("isEnabled",!0),this.set("isSelected",!1),this.bind("isVisible").to(this,"isEnabled",this,"isSelected",(i,n)=>i&&n),this.decorate("begin"),this.decorate("cancel"),this.decorate("commit"),this.decorate("updateSize"),this.on("commit",i=>{!this.state.proposedWidth&&!this.state.proposedWidthPercents&&(this._cleanup(),i.stop())},{priority:"high"})}get state(){return this._state}show(){this._options.editor.editing.view.change(i=>{i.removeClass("ck-hidden",this._viewResizerWrapper)})}hide(){this._options.editor.editing.view.change(i=>{i.addClass("ck-hidden",this._viewResizerWrapper)})}attach(){const e=this,i=this._options.viewElement;this._options.editor.editing.view.change(r=>{const o=r.createUIElement("div",{class:"ck ck-reset_all ck-widget__resizer"},function(l){const a=this.toDomElement(l);return e._appendHandles(a),e._appendSizeUI(a),a});r.insert(r.createPositionAt(i,"end"),o),r.addClass("ck-widget_with-resizer",i),this._viewResizerWrapper=o,this.isVisible||this.hide()}),this.on("change:isVisible",()=>{this.isVisible?(this.show(),this.redraw()):this.hide()})}begin(e){this._state=new hH(this._options),this._sizeView._bindToState(this._options,this.state),this._initialViewWidth=this._options.viewElement.getStyle("width"),this.state.begin(e,this._getHandleHost(),this._getResizeHost())}updateSize(e){const i=this._proposeNewSize(e);this._options.editor.editing.view.change(h=>{const f=this._options.unit||"%",m=(f==="%"?i.widthPercents:i.width)+f;h.setStyle("width",m,this._options.viewElement)});const r=this._getHandleHost(),o=new Ve(r),l=Math.round(o.width),a=Math.round(o.height),c=new Ve(r);i.width=Math.round(c.width),i.height=Math.round(c.height),this.redraw(o),this.state.update({...i,handleHostWidth:l,handleHostHeight:a})}commit(){const e=this._options.unit||"%",i=(e==="%"?this.state.proposedWidthPercents:this.state.proposedWidth)+e;this._options.editor.editing.view.change(()=>{this._cleanup(),this._options.onCommit(i)})}cancel(){this._cleanup()}destroy(){this.cancel()}redraw(e){const i=this._domResizerWrapper;if(!bH(i))return;const n=i.parentElement,r=this._getHandleHost(),o=this._viewResizerWrapper,l=[o.getStyle("width"),o.getStyle("height"),o.getStyle("left"),o.getStyle("top")];let a;if(n.isSameNode(r)){const c=e||new Ve(r);a=[c.width+"px",c.height+"px",void 0,void 0]}else a=[r.offsetWidth+"px",r.offsetHeight+"px",r.offsetLeft+"px",r.offsetTop+"px"];Ni(l,a)!=="same"&&this._options.editor.editing.view.change(c=>{c.setStyle({width:a[0],height:a[1],left:a[2],top:a[3]},o)})}containsHandle(e){return this._domResizerWrapper.contains(e)}static isResizeHandle(e){return e.classList.contains("ck-widget__resizer__handle")}_cleanup(){this._sizeView._dismiss(),this._options.editor.editing.view.change(i=>{i.setStyle("width",this._initialViewWidth,this._options.viewElement)})}_proposeNewSize(e){const i=this.state,n=xH(e),r=this._options.isCentered?this._options.isCentered(this):!0,o={x:i._referenceCoordinates.x-(n.x+i.originalWidth),y:n.y-i.originalHeight-i._referenceCoordinates.y};r&&i.activeHandlePosition.endsWith("-right")&&(o.x=n.x-(i._referenceCoordinates.x+i.originalWidth)),r&&(o.x*=2);let l=Math.abs(i.originalWidth+o.x),a=Math.abs(i.originalHeight+o.y);return(l/i.aspectRatio>a?"width":"height")=="width"?a=l/i.aspectRatio:l=a*i.aspectRatio,{width:Math.round(l),height:Math.round(a),widthPercents:Math.min(Math.round(i.originalWidthPercents/i.originalWidth*l*100)/100,100)}}_getResizeHost(){const e=this._domResizerWrapper.parentElement;return this._options.getResizeHost(e)}_getHandleHost(){const e=this._domResizerWrapper.parentElement;return this._options.getHandleHost(e)}get _domResizerWrapper(){return this._options.editor.editing.view.domConverter.mapViewToDom(this._viewResizerWrapper)}_appendHandles(e){const i=["top-left","top-right","bottom-right","bottom-left"];for(const n of i)e.appendChild(new zn({tag:"div",attributes:{class:`ck-widget__resizer__handle ${wH(n)}`}}).render())}_appendSizeUI(e){this._sizeView=new pH,this._sizeView.render(),e.appendChild(this._sizeView.element)}}function wH(s){return`ck-widget__resizer__handle-${s}`}function xH(s){return{x:s.pageX,y:s.pageY}}function bH(s){return s&&s.ownerDocument&&s.ownerDocument.contains(s)}class yx extends F{constructor(){super(...arguments);p(this,"_resizers",new Map);p(this,"_observer");p(this,"_redrawSelectedResizerThrottled")}static get pluginName(){return"WidgetResize"}static get isOfficialPlugin(){return!0}init(){const e=this.editor.editing,i=he.window.document;this.set("selectedResizer",null),this.set("_activeResizer",null),e.view.addObserver(Pp),this._observer=new(qi()),this.listenTo(e.view.document,"mousedown",this._mouseDownListener.bind(this),{priority:"high"}),this._observer.listenTo(i,"mousemove",this._mouseMoveListener.bind(this)),this._observer.listenTo(i,"mouseup",this._mouseUpListener.bind(this)),this._redrawSelectedResizerThrottled=hc(()=>this.redrawSelectedResizer(),200),this.editor.ui.on("update",this._redrawSelectedResizerThrottled),this.editor.model.document.on("change",()=>{for(const[r,o]of this._resizers)r.isAttached()||(this._resizers.delete(r),o.destroy())},{priority:"lowest"}),this._observer.listenTo(he.window,"resize",this._redrawSelectedResizerThrottled);const n=this.editor.editing.view.document.selection;n.on("change",()=>{const r=n.getSelectedElement(),o=this.getResizerByViewElement(r)||null;o?this.select(o):this.deselect()})}redrawSelectedResizer(){this.selectedResizer&&this.selectedResizer.isVisible&&this.selectedResizer.redraw()}destroy(){super.destroy(),this._observer.stopListening();for(const e of this._resizers.values())e.destroy();this._redrawSelectedResizerThrottled.cancel()}select(e){this.deselect(),this.selectedResizer=e,this.selectedResizer.isSelected=!0}deselect(){this.selectedResizer&&(this.selectedResizer.isSelected=!1),this.selectedResizer=null}attachTo(e){const i=new W2(e),n=this.editor.plugins;if(i.attach(),n.has("WidgetToolbarRepository")){const l=n.get("WidgetToolbarRepository");i.on("begin",()=>{l.forceDisabled("resize")},{priority:"lowest"}),i.on("cancel",()=>{l.clearForceDisabled("resize")},{priority:"highest"}),i.on("commit",()=>{l.clearForceDisabled("resize")},{priority:"highest"})}this._resizers.set(e.viewElement,i);const o=this.editor.editing.view.document.selection.getSelectedElement();return this.getResizerByViewElement(o)==i&&this.select(i),i}getResizerByViewElement(e){return this._resizers.get(e)}_getResizerByHandle(e){for(const i of this._resizers.values())if(i.containsHandle(e))return i}_mouseDownListener(e,i){const n=i.domTarget;W2.isResizeHandle(n)&&(this._activeResizer=this._getResizerByHandle(n)||null,this._activeResizer&&(this._activeResizer.begin(n),e.stop(),i.preventDefault()))}_mouseMoveListener(e,i){this._activeResizer&&this._activeResizer.updateSize(i)}_mouseUpListener(){this._activeResizer&&(this._activeResizer.commit(),this._activeResizer=null)}}var OH=["0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","#","$","%","*","+",",","-",".",":",";","=","?","@","[","]","^","_","{","|","}","~"],Yu=s=>{let t=0;for(let e=0;e<s.length;e++){let i=s[e],n=OH.indexOf(i);t=t*83+n}return t},vx=s=>{let t=s/255;return t<=.04045?t/12.92:Math.pow((t+.055)/1.055,2.4)},_x=s=>{let t=Math.max(0,Math.min(1,s));return t<=.0031308?Math.trunc(t*12.92*255+.5):Math.trunc((1.055*Math.pow(t,.4166666666666667)-.055)*255+.5)},yH=s=>s<0?-1:1,kx=(s,t)=>yH(s)*Math.pow(Math.abs(s),t),U2=class extends Error{constructor(t){super(t),this.name="ValidationError",this.message=t}},vH=s=>{if(!s||s.length<6)throw new U2("The blurhash string must be at least 6 characters");let t=Yu(s[0]),e=Math.floor(t/9)+1,i=t%9+1;if(s.length!==4+2*i*e)throw new U2(`blurhash length mismatch: length is ${s.length} but it should be ${4+2*i*e}`)},_H=s=>{let t=s>>16,e=s>>8&255,i=s&255;return[vx(t),vx(e),vx(i)]},kH=(s,t)=>{let e=Math.floor(s/361),i=Math.floor(s/19)%19,n=s%19;return[kx((e-9)/9,2)*t,kx((i-9)/9,2)*t,kx((n-9)/9,2)*t]},SH=(s,t,e,i)=>{vH(s),i=i|1;let n=Yu(s[0]),r=Math.floor(n/9)+1,o=n%9+1,l=(Yu(s[1])+1)/166,a=new Array(o*r);for(let f=0;f<a.length;f++)if(f===0){let m=Yu(s.substring(2,6));a[f]=_H(m)}else{let m=Yu(s.substring(4+f*2,6+f*2));a[f]=kH(m,l*i)}let c=t*4,h=new Uint8ClampedArray(c*e);for(let f=0;f<e;f++)for(let m=0;m<t;m++){let w=0,O=0,_=0;for(let M=0;M<r;M++)for(let Q=0;Q<o;Q++){let N=Math.cos(Math.PI*m*Q/t)*Math.cos(Math.PI*f*M/e),G=a[Q+M*o];w+=G[0]*N,O+=G[1]*N,_+=G[2]*N}let k=_x(w),C=_x(O),P=_x(_);h[4*m+0+f*c]=k,h[4*m+1+f*c]=C,h[4*m+2+f*c]=P,h[4*m+3+f*c]=255}return h},CH=SH;/**
 * @license Copyright (c) 2003-2025, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options
 */class PH extends F{static get pluginName(){return"CKBoxUI"}static get isOfficialPlugin(){return!0}afterInit(){const t=this.editor;t.commands.get("ckbox")&&(t.ui.componentFactory.add("ckbox",()=>this._createFileToolbarButton()),t.ui.componentFactory.add("menuBar:ckbox",()=>this._createFileMenuBarButton()),t.plugins.has("ImageInsertUI")&&t.plugins.get("ImageInsertUI").registerIntegration({name:"assetManager",observable:()=>t.commands.get("ckbox"),buttonViewCreator:()=>this._createImageToolbarButton(),formViewCreator:()=>this._createImageDropdownButton(),menuBarButtonViewCreator:e=>this._createImageMenuBarButton(e?"insertOnly":"insertNested")}))}_createButton(t){const e=this.editor,i=e.locale,n=new t(i),r=e.commands.get("ckbox");return n.bind("isOn","isEnabled").to(r,"value","isEnabled"),n.on("execute",()=>{e.execute("ckbox")}),n}_createFileToolbarButton(){const t=this.editor.locale.t,e=this._createButton(ye);return e.icon=MC,e.label=t("Open file manager"),e.tooltip=!0,e}_createImageToolbarButton(){const t=this.editor.locale.t,e=this.editor.plugins.get("ImageInsertUI"),i=this._createButton(ye);return i.icon=sx,i.bind("label").to(e,"isImageSelected",n=>t(n?"Replace image with file manager":"Insert image with file manager")),i.tooltip=!0,i}_createImageDropdownButton(){const t=this.editor.locale.t,e=this.editor.plugins.get("ImageInsertUI"),i=this._createButton(ye);return i.icon=sx,i.withText=!0,i.bind("label").to(e,"isImageSelected",n=>t(n?"Replace with file manager":"Insert with file manager")),i.on("execute",()=>{e.dropdownView.isOpen=!1}),i}_createFileMenuBarButton(){const t=this.editor.locale.t,e=this._createButton(ti);return e.icon=MC,e.withText=!0,e.label=t("File"),e}_createImageMenuBarButton(t){const e=this.editor.locale.t,i=this.editor.locale.t,n=this._createButton(ti);switch(n.icon=sx,n.withText=!0,t){case"insertOnly":n.label=e("Image");break;case"insertNested":n.label=i("With file manager");break}return n}}function t7(s){const t=[];let e=0;for(const n in s){const r=parseInt(n,10);isNaN(r)||(r>e&&(e=r),t.push(`${s[n]} ${n}w`))}const i=[{srcset:t.join(","),sizes:`(max-width: ${e}px) 100vw, ${e}px`,type:"image/webp"}];return{imageFallbackUrl:s.default,imageSources:i}}function TH(s,t){var r,o,l,a;const[,e]=s.value.split("."),i=JSON.parse(atob(e)),n=((o=(r=i.auth)==null?void 0:r.ckbox)==null?void 0:o.workspaces)||[i.aud];return t?((a=(l=i.auth)==null?void 0:l.ckbox)==null?void 0:a.role)=="superadmin"||n.includes(t)?t:null:n[0]}const Vu=32;function EH(s){if(s)try{const t=`${Vu}px`,e=document.createElement("canvas");e.setAttribute("width",t),e.setAttribute("height",t);const i=e.getContext("2d");/* istanbul ignore next -- @preserve */if(!i)return;const n=i.createImageData(Vu,Vu),r=CH(s,Vu,Vu);return n.data.set(r),i.putImageData(n,0,0),e.toDataURL()}catch{return}}function Rp({url:s,method:t="GET",data:e,onUploadProgress:i,signal:n,authorization:r}){const o=new XMLHttpRequest;o.open(t,s.toString()),o.setRequestHeader("Authorization",r),o.setRequestHeader("CKBox-Version","CKEditor 5"),o.responseType="json";const l=()=>{o.abort()};return new Promise((a,c)=>{n.throwIfAborted(),n.addEventListener("abort",l),o.addEventListener("loadstart",()=>{n.addEventListener("abort",l)}),o.addEventListener("loadend",()=>{n.removeEventListener("abort",l)}),o.addEventListener("error",()=>{c()}),o.addEventListener("abort",()=>{c()}),o.addEventListener("load",()=>{const h=o.response;if(!h||h.statusCode>=400)return c(h&&h.message);a(h)});/* istanbul ignore else -- @preserve */i&&o.upload.addEventListener("progress",h=>{i(h)}),o.send(e)})}const AH={"image/gif":"gif","image/jpeg":"jpg","image/png":"png","image/webp":"webp","image/bmp":"bmp","image/tiff":"tiff"};function IH(s){return AH[s]}async function RH(s,t){try{const e=await fetch(s,{method:"HEAD",cache:"force-cache",...t});return e.ok&&e.headers.get("content-type")||""}catch{return""}}function VH(s){const t=s.name,e=/\.(?<ext>[^.]+)$/;return t.match(e).groups.ext.toLowerCase()}const MH=1e3;class LH extends Be{constructor(e){super(e);p(this,"_chosenAssets",new Set);p(this,"_wrapper",null);this._initListeners()}refresh(){this.value=this._getValue(),this.isEnabled=this._checkEnabled()}execute(){this.fire("ckbox:open")}_getValue(){return this._wrapper!==null}_checkEnabled(){const e=this.editor.commands.get("insertImage"),i=this.editor.commands.get("link");return!(!e.isEnabled&&!i.isEnabled)}_prepareOptions(){const i=this.editor.config.get("ckbox"),n=i.dialog,r=i.categories,o=i.view,l=i.upload;return{theme:i.theme,language:i.language,tokenUrl:i.tokenUrl,serviceOrigin:i.serviceOrigin,forceDemoLabel:i.forceDemoLabel,choosableFileExtensions:i.choosableFileExtensions,assets:{onChoose:a=>this.fire("ckbox:choose",a)},dialog:{onClose:()=>this.fire("ckbox:close"),width:n&&n.width,height:n&&n.height},categories:r&&{icons:r.icons},view:o&&{openLastView:o.openLastView,startupFolderId:o.startupFolderId,startupCategoryId:o.startupCategoryId,hideMaximizeButton:o.hideMaximizeButton},upload:l&&{componentsHideTimeout:l.componentsHideTimeout,dialogMinimizeTimeout:l.dialogMinimizeTimeout}}}_initListeners(){const e=this.editor,i=e.model,n=!e.config.get("ckbox.ignoreDataId"),r=e.config.get("ckbox.downloadableFiles");this.on("ckbox",()=>{this.refresh()},{priority:"low"}),this.on("ckbox:open",()=>{!this.isEnabled||this.value||(this._wrapper=bi(document,"div",{class:"ck ckbox-wrapper"}),document.body.appendChild(this._wrapper),window.CKBox.mount(this._wrapper,this._prepareOptions()))}),this.on("ckbox:close",()=>{this.value&&(this._wrapper.remove(),this._wrapper=null,e.editing.view.focus())}),this.on("ckbox:choose",(o,l)=>{if(!this.isEnabled)return;const a=e.commands.get("insertImage"),c=e.commands.get("link"),h=BH({assets:l,downloadableFilesConfig:r,isImageAllowed:a.isEnabled,isLinkAllowed:c.isEnabled}),f=h.length;f!==0&&(i.change(m=>{for(const w of h){const O=w===h[f-1],_=f===1;this._insertAsset(w,O,m,_),n&&(setTimeout(()=>this._chosenAssets.delete(w),MH),this._chosenAssets.add(w))}}),e.editing.view.focus())}),this.listenTo(e,"destroy",()=>{this.fire("ckbox:close"),this._chosenAssets.clear()})}_insertAsset(e,i,n,r){const a=this.editor.model.document.selection;n.removeSelectionAttribute("linkHref"),e.type==="image"?this._insertImage(e):this._insertLink(e,n,r),i||n.setSelection(a.getLastPosition())}_insertImage(e){const i=this.editor,{imageFallbackUrl:n,imageSources:r,imageTextAlternative:o,imageWidth:l,imageHeight:a,imagePlaceholder:c}=e.attributes;i.execute("insertImage",{source:{src:n,sources:r,alt:o,width:l,height:a,...c?{placeholder:c}:null}})}_insertLink(e,i,n){const r=this.editor,o=r.model,l=o.document.selection,{linkName:a,linkHref:c}=e.attributes;if(l.isCollapsed){const h=ms(l.getAttributes()),f=i.createText(a,h);if(!n){const w=l.getLastPosition(),O=w.parent;O.name==="paragraph"&&O.isEmpty||r.execute("insertParagraph",{position:w});const _=o.insertContent(f);i.setSelection(_),r.execute("link",c);return}const m=o.insertContent(f);i.setSelection(m)}r.execute("link",c)}}function BH({downloadableFilesConfig:s,assets:t,isImageAllowed:e,isLinkAllowed:i}){return t.map(n=>DH(n)?{id:n.data.id,type:"image",attributes:i7(n)}:{id:n.data.id,type:"link",attributes:$H(n,s)}).filter(n=>n.type==="image"?e:i)}function i7(s){const{imageFallbackUrl:t,imageSources:e}=t7(s.data.imageUrls),{description:i,width:n,height:r,blurHash:o}=s.data.metadata,l=EH(o);return{imageFallbackUrl:t,imageSources:e,imageTextAlternative:i||"",imageWidth:n,imageHeight:r,...l?{imagePlaceholder:l}:null}}function $H(s,t){return{linkName:s.data.name,linkHref:QH(s,t)}}function DH(s){const t=s.data.metadata;return t?t.width&&t.height:!1}function QH(s,t){const e=new URL(s.data.url);return NH(s,t)&&e.searchParams.set("download","true"),e.toString()}function NH(s,t){return typeof t=="function"?t(s):!0}const FH="lark";class mc extends F{constructor(){super(...arguments);p(this,"_token")}static get pluginName(){return"CKBoxUtils"}static get isOfficialPlugin(){return!0}static get requires(){return["CloudServices"]}init(){const e=this.editor,i=!!e.config.get("ckbox"),n=!!window.CKBox;if(!i&&!n)return;e.config.define("ckbox",{serviceOrigin:"https://api.ckbox.io",defaultUploadCategories:null,ignoreDataId:!1,language:e.locale.uiLanguage,theme:FH,tokenUrl:e.config.get("cloudServices.tokenUrl")});const r=e.plugins.get("CloudServices"),o=e.config.get("cloudServices.tokenUrl"),l=e.config.get("ckbox.tokenUrl");if(!l)throw new E("ckbox-plugin-missing-token-url",this);l==o?this._token=Promise.resolve(r.token):this._token=r.registerTokenUrl(l),this._token=this._token.then(async a=>(await this._authorizePrivateCategoriesAccess(a.value),a))}getToken(){return this._token}async getWorkspaceId(){const e=this.editor.t,i=e("Cannot access default workspace."),n=this.editor.config.get("ckbox.defaultUploadWorkspaceId"),r=TH(await this._token,n);if(r==null)throw fg("ckbox-access-default-workspace-error"),i;return r}async getCategoryIdForFile(e,i){const n=this.editor.t,r=n("Cannot determine a category for the uploaded file."),o=this.editor.config.get("ckbox.defaultUploadCategories"),l=this._getAvailableCategories(i),a=typeof e=="string"?IH(await RH(e,i)):VH(e),c=await l;if(!c)throw r;if(o){const f=Object.keys(o).find(m=>o[m].find(w=>w.toLowerCase()==a));if(f){const m=c.find(w=>w.id===f||w.name===f);if(!m)throw r;return m.id}}const h=c.find(f=>f.extensions.find(m=>m.toLowerCase()==a));if(!h)throw r;return h.id}async _getAvailableCategories(e){const n=this.editor,r=this._token,{signal:o}=e,l=n.config.get("ckbox.serviceOrigin"),a=await this.getWorkspaceId();try{const h=[];let f=0,m;do{const w=await c(f);h.push(...w.items),m=w.totalCount-(f+50),f+=50}while(m>0);return h}catch{o.throwIfAborted(),fg("ckbox-fetch-category-http-error");return}async function c(h){const f=new URL("categories",l);return f.searchParams.set("limit",String(50)),f.searchParams.set("offset",String(h)),f.searchParams.set("workspaceId",a),Rp({url:f,signal:o,authorization:(await r).value})}}async _authorizePrivateCategoriesAccess(e){const i=this.editor.config.get("ckbox.serviceOrigin"),n=new FormData;n.set("token",e),await fetch(`${i}/categories/authorizePrivateAccess`,{method:"POST",credentials:"include",mode:"no-cors",body:n})}}class zH extends F{static get requires(){return["ImageUploadEditing","ImageUploadProgress",yo,wy]}static get pluginName(){return"CKBoxUploadAdapter"}static get isOfficialPlugin(){return!0}async afterInit(){const t=this.editor,e=!!t.config.get("ckbox"),i=!!window.CKBox;if(!e&&!i)return;const n=t.plugins.get(yo),r=t.plugins.get(mc);n.createUploadAdapter=a=>new WH(a,t,r);const o=!t.config.get("ckbox.ignoreDataId"),l=t.plugins.get("ImageUploadEditing");o&&l.on("uploadComplete",(a,{imageElement:c,data:h})=>{t.model.change(f=>{f.setAttribute("ckboxImageId",h.ckboxImageId,c)})})}}class WH{constructor(t,e,i){p(this,"loader");p(this,"token");p(this,"editor");p(this,"controller");p(this,"serviceOrigin");p(this,"ckboxUtils");this.loader=t,this.token=i.getToken(),this.ckboxUtils=i,this.editor=e,this.controller=new AbortController,this.serviceOrigin=e.config.get("ckbox.serviceOrigin")}async upload(){const t=this.ckboxUtils,e=this.editor.t,i=await this.loader.file,n=await t.getCategoryIdForFile(i,{signal:this.controller.signal}),r=new URL("assets",this.serviceOrigin),o=new FormData;r.searchParams.set("workspaceId",await t.getWorkspaceId()),o.append("categoryId",n),o.append("file",i);const l={method:"POST",url:r,data:o,onUploadProgress:a=>{/* istanbul ignore else -- @preserve */a.lengthComputable&&(this.loader.uploadTotal=a.total,this.loader.uploaded=a.loaded)},signal:this.controller.signal,authorization:(await this.token).value};return Rp(l).then(async a=>{const c=t7(a.imageUrls);return{ckboxImageId:a.id,default:c.imageFallbackUrl,sources:c.imageSources}}).catch(()=>{const a=e("Cannot upload file:")+` ${i.name}.`;return Promise.reject(a)})}abort(){this.controller.abort()}}const Z2="NoPermission";class wy extends F{static get pluginName(){return"CKBoxEditing"}static get isOfficialPlugin(){return!0}static get requires(){return["LinkEditing","PictureEditing",zH,mc]}init(){const t=this.editor;this._shouldBeInitialised()&&(this._checkImagePlugins(),q2()&&t.commands.add("ckbox",new LH(t)),jH(t).then(e=>{e||this._blockImageCommands()}))}afterInit(){const t=this.editor;this._shouldBeInitialised()&&(t.config.get("ckbox.ignoreDataId")||(this._initSchema(),this._initConversion(),this._initFixers()))}_shouldBeInitialised(){return!!this.editor.config.get("ckbox")||q2()}_blockImageCommands(){const t=this.editor,e=t.commands.get("uploadImage"),i=t.commands.get("ckboxImageEdit");e&&(e.isAccessAllowed=!1,e.forceDisabled(Z2)),i&&i.forceDisabled(Z2)}_checkImagePlugins(){const t=this.editor;!t.plugins.has("ImageBlockEditing")&&!t.plugins.has("ImageInlineEditing")&&fg("ckbox-plugin-image-feature-missing",t)}_initSchema(){const e=this.editor.model.schema;e.extend("$text",{allowAttributes:"ckboxLinkId"}),e.isRegistered("imageBlock")&&e.extend("imageBlock",{allowAttributes:["ckboxImageId","ckboxLinkId"]}),e.isRegistered("imageInline")&&e.extend("imageInline",{allowAttributes:["ckboxImageId","ckboxLinkId"]}),e.addAttributeCheck(i=>{if(!i.last.getAttribute("linkHref"))return!1},"ckboxLinkId")}_initConversion(){const t=this.editor;t.conversion.for("downcast").add(i=>{i.on("attribute:ckboxLinkId:imageBlock",(n,r,o)=>{const{writer:l,mapper:a,consumable:c}=o;if(!c.consume(r.item,n.name))return;const f=[...a.toViewElement(r.item).getChildren()].find(m=>m.name==="a");f&&(r.item.hasAttribute("ckboxLinkId")?l.setAttribute("data-ckbox-resource-id",r.item.getAttribute("ckboxLinkId"),f):l.removeAttribute("data-ckbox-resource-id",f))},{priority:"low"}),i.on("attribute:ckboxLinkId",(n,r,o)=>{const{writer:l,mapper:a,consumable:c}=o;if(c.consume(r.item,n.name)){if(r.attributeOldValue){const h=H2(l,r.attributeOldValue);l.unwrap(a.toViewRange(r.range),h)}if(r.attributeNewValue){const h=H2(l,r.attributeNewValue);if(r.item.is("selection")){const f=l.document.selection;l.wrap(f.getFirstRange(),h)}else l.wrap(a.toViewRange(r.range),h)}}},{priority:"low"})}),t.conversion.for("upcast").add(i=>{i.on("element:a",(n,r,o)=>{const{writer:l,consumable:a}=o;if(!r.viewItem.getAttribute("href"))return;const c={attributes:["data-ckbox-resource-id"]};if(!a.consume(r.viewItem,c))return;const h=r.viewItem.getAttribute("data-ckbox-resource-id");if(h)if(r.modelRange)for(let f of r.modelRange.getItems())f.is("$textProxy")&&(f=f.textNode),qH(f)&&l.setAttribute("ckboxLinkId",h,f);else{const f=r.modelCursor.nodeBefore||r.modelCursor.parent;l.setAttribute("ckboxLinkId",h,f)}},{priority:"low"})}),t.conversion.for("downcast").attributeToAttribute({model:"ckboxImageId",view:"data-ckbox-resource-id"}),t.conversion.for("upcast").elementToAttribute({model:{key:"ckboxImageId",value:i=>i.getAttribute("data-ckbox-resource-id")},view:{attributes:{"data-ckbox-resource-id":/[\s\S]+/}}});const e=t.commands.get("replaceImageSource");e&&this.listenTo(e,"cleanupImage",(i,[n,r])=>{n.removeAttribute("ckboxImageId",r)})}_initFixers(){const t=this.editor,e=t.model,i=e.document.selection;e.document.registerPostFixer(UH(t)),e.document.registerPostFixer(ZH(i))}}function UH(s){return t=>{let e=!1;const i=s.model,n=s.commands.get("ckbox");if(!n)return e;for(const r of i.document.differ.getChanges()){if(r.type!=="insert"&&r.type!=="attribute")continue;const o=r.type==="insert"?new K(r.position,r.position.getShiftedBy(r.length)):r.range,l=r.type==="attribute"&&r.attributeKey==="linkHref"&&r.attributeNewValue===null;for(const a of o.getItems()){if(l&&a.hasAttribute("ckboxLinkId")){t.removeAttribute("ckboxLinkId",a),e=!0;continue}const c=HH(a,n._chosenAssets);for(const h of c){const f=h.type==="image"?"ckboxImageId":"ckboxLinkId";h.id!==a.getAttribute(f)&&(t.setAttribute(f,h.id,a),e=!0)}}}return e}}function ZH(s){return t=>!s.hasAttribute("linkHref")&&s.hasAttribute("ckboxLinkId")?(t.removeSelectionAttribute("ckboxLinkId"),!0):!1}function HH(s,t){const e=s.is("element","imageInline")||s.is("element","imageBlock"),i=s.hasAttribute("linkHref");return[...t].filter(n=>{if(n.type==="image"&&e)return n.attributes.imageFallbackUrl===s.getAttribute("src");if(n.type==="link"&&i)return n.attributes.linkHref===s.getAttribute("linkHref")})}function H2(s,t){const e=s.createAttributeElement("a",{"data-ckbox-resource-id":t},{priority:5});return s.setCustomProperty("link",!0,e),e}function qH(s){return!!(s.is("$text")||s.is("element","imageInline")||s.is("element","imageBlock"))}function q2(){return!!window.CKBox}async function jH(s){const t=s.plugins.get(mc),e=s.config.get("ckbox.serviceOrigin"),i=new URL("permissions",e),{value:n}=await t.getToken(),r=await Rp({url:i,authorization:n,signal:new AbortController().signal});return Object.values(r).some(o=>o["asset:create"])}class XH extends F{static get pluginName(){return"CKBox"}static get isOfficialPlugin(){return!0}static get requires(){return[wy,PH]}}function GH(s){const t=n7(s);return e=>e.is("element","imageInline")||e.is("element","imageBlock")?e.hasAttribute("ckboxImageId")?!0:e.hasAttribute("src")?t(e.getAttribute("src")):!1:!1}function n7(s){if(Array.isArray(s)){const t=s.map(n7);return e=>t.some(i=>i(e))}if(s=="origin"){const t=he.window.location.origin;return e=>new URL(e,he.document.baseURI).origin==t}return typeof s=="function"?s:s instanceof RegExp?t=>!!(t.match(s)||t.replace(/^https?:\/\//,"").match(s)):()=>!1}class YH extends Be{constructor(e){super(e);p(this,"_wrapper",null);p(this,"_processInProgress",new Set);p(this,"_canEdit");p(this,"_prepareOptions");p(this,"_updateUiDelayed",_p(()=>this.editor.ui.update(),0));this.value=!1,this._canEdit=GH(e.config.get("ckbox.allowExternalImagesEditing")),this._prepareOptions=P9((i,n)=>this._prepareOptionsAbortable(i,n)),this._prepareListeners()}refresh(){const e=this.editor;this.value=this._getValue();const i=e.model.document.selection.getSelectedElement();this.isEnabled=!!i&&this._canEdit(i)&&!this._checkIfElementIsBeingProcessed(i)}execute(){if(this._getValue())return;const e=bi(document,"div",{class:"ck ckbox-wrapper"});this._wrapper=e,this.value=!0,document.body.appendChild(this._wrapper);const n={element:this.editor.model.document.selection.getSelectedElement(),controller:new AbortController};this._prepareOptions(n).then(r=>window.CKBox.mountImageEditor(e,r),r=>{const o=this.editor,l=o.t;o.plugins.get(Mh).showWarning(l("Failed to determine category of edited image."),{namespace:"ckbox"}),console.error(r),this._handleImageEditorClose()})}destroy(){this._handleImageEditorClose(),this._prepareOptions.abort(),this._updateUiDelayed.cancel();for(const e of this._processInProgress.values())e.controller.abort();super.destroy()}_getValue(){return this._wrapper!==null}async _prepareOptionsAbortable(e,i){const n=this.editor,r=n.config.get("ckbox"),o=n.plugins.get(mc),{element:l}=i;let a;const c=l.getAttribute("ckboxImageId");if(c)a={assetId:c};else{const h=new URL(l.getAttribute("src"),document.baseURI).href,f=await o.getCategoryIdForFile(h,{signal:e});a={imageUrl:h,uploadCategoryId:f}}return{...a,imageEditing:{allowOverwrite:!1},tokenUrl:r.tokenUrl,...r.serviceOrigin&&{serviceOrigin:r.serviceOrigin},onClose:()=>this._handleImageEditorClose(),onSave:h=>this._handleImageEditorSave(i,h)}}_prepareListeners(){this.listenTo(this.editor.model.document,"change:data",()=>{this._getProcessingStatesOfDeletedImages().forEach(i=>{i.controller.abort()})})}_getProcessingStatesOfDeletedImages(){const e=[];for(const i of this._processInProgress.values())i.element.root.rootName=="$graveyard"&&e.push(i);return e}_checkIfElementIsBeingProcessed(e){for(const{element:i}of this._processInProgress)if(Cl(i,e))return!0;return!1}_handleImageEditorClose(){this._wrapper&&(this._wrapper.remove(),this._wrapper=null,this.editor.editing.view.focus(),this._updateUiDelayed(),this.refresh())}_handleImageEditorSave(e,i){const n=this.editor.locale.t,r=this.editor.plugins.get(Mh),o=this.editor.plugins.get(Ro),l=o.add(n("Processing the edited image."));this._processInProgress.add(e),this._showImageProcessingIndicator(e.element,i),this.refresh(),this._waitForAssetProcessed(i.data.id,e.controller.signal).then(a=>{this._replaceImage(e.element,a)},a=>{this.editor.editing.reconvertItem(e.element),!e.controller.signal.aborted&&(!a||a instanceof E?r.showWarning(n("Server failed to process the image."),{namespace:"ckbox"}):console.error(a))}).finally(()=>{this._processInProgress.delete(e),o.remove(l),this.refresh()})}async _getAssetStatusFromServer(e,i){const n=this.editor.plugins.get(mc),r=new URL("assets/"+e,this.editor.config.get("ckbox.serviceOrigin")),o=await Rp({url:r,signal:i,authorization:(await n.getToken()).value}),l=o.metadata.metadataProcessingStatus;if(!l||l=="queued")throw new E("ckbox-image-not-processed");return{data:{...o}}}async _waitForAssetProcessed(e,i){const n=await rD(()=>this._getAssetStatusFromServer(e,i),{signal:i,maxAttempts:5});if(n.data.metadata.metadataProcessingStatus!="success")throw new E("ckbox-image-processing-failed");return n}_showImageProcessingIndicator(e,i){const n=this.editor;n.editing.view.change(r=>{const o=n.editing.mapper.toViewElement(e),a=this.editor.plugins.get("ImageUtils").findViewImgElement(o);r.removeStyle("aspect-ratio",a),r.setAttribute("width",i.data.metadata.width,a),r.setAttribute("height",i.data.metadata.height,a),r.setStyle("width",`${i.data.metadata.width}px`,a),r.setStyle("height",`${i.data.metadata.height}px`,a),r.addClass("image-processing",o)})}_replaceImage(e,i){const n=this.editor,{imageFallbackUrl:r,imageSources:o,imageWidth:l,imageHeight:a,imagePlaceholder:c}=i7(i),h=Array.from(n.model.document.selection.getRanges());n.model.change(f=>{f.setSelection(e,"on"),n.execute("insertImage",{imageType:e.is("element","imageInline")?"imageInline":null,source:{src:r,sources:o,width:l,height:a,...c?{placeholder:c}:null,...e.hasAttribute("alt")?{alt:e.getAttribute("alt")}:null}});const m=e.getChildren();e=n.model.document.selection.getSelectedElement();for(const w of m)f.append(f.cloneElement(w),e);f.setAttribute("ckboxImageId",i.data.id,e),f.setSelection(h)})}}class KH extends F{static get pluginName(){return"CKBoxImageEditEditing"}static get isOfficialPlugin(){return!0}static get requires(){return[wy,mc,Ro,Mh,"ImageUtils","ImageEditing"]}init(){const{editor:t}=this;t.commands.add("ckboxImageEdit",new YH(t))}}class JH extends F{static get pluginName(){return"CKBoxImageEditUI"}static get isOfficialPlugin(){return!0}init(){const t=this.editor;t.ui.componentFactory.add("ckboxImageEdit",e=>{const i=t.commands.get("ckboxImageEdit"),n=t.commands.get("uploadImage"),r=new ye(e),o=e.t;return r.set({icon:jF,tooltip:!0}),r.bind("label").to(n,"isAccessAllowed",l=>o(l?"Edit image":"You have no image editing permissions.")),r.bind("isOn").to(i,"value",i,"isEnabled",(l,a)=>l&&a),r.bind("isEnabled").to(i),this.listenTo(r,"execute",()=>{t.execute("ckboxImageEdit"),t.editing.view.focus()}),r})}}class eq extends F{static get pluginName(){return"CKBoxImageEdit"}static get isOfficialPlugin(){return!0}static get requires(){return[KH,JH]}}/**
 * @license Copyright (c) 2003-2025, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options
 */class Lh extends Nr{constructor(e){super(e);p(this,"domEventType",["paste","copy","cut","drop","dragover","dragstart","dragend","dragenter","dragleave"]);const i=this.document;this.listenTo(i,"paste",n("clipboardInput"),{priority:"low"}),this.listenTo(i,"drop",n("clipboardInput"),{priority:"low"}),this.listenTo(i,"dragover",n("dragging"),{priority:"low"});function n(r){return(o,l)=>{l.preventDefault();const a=l.dropRange?[l.dropRange]:null,c=new Lr(i,r);i.fire(c,{dataTransfer:l.dataTransfer,method:o.name,targetRanges:a,target:l.target,domEvent:l.domEvent}),c.stop.called&&l.stopPropagation()}}}onDomEvent(e){const i="clipboardData"in e?e.clipboardData:e.dataTransfer,n=e.type=="drop"||e.type=="paste",r={dataTransfer:new Cp(i,{cacheFiles:n})};if(e.type=="drop"||e.type=="dragover"){const o=U6(e);r.dropRange=o&&this.view.domConverter.domRangeToView(o)}this.fire(e.type,e,r)}}/**
 * @license Copyright (c) 2003-2025, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options
 */function tq(s){return s=s.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\r?\n\r?\n/g,"</p><p>").replace(/\r?\n/g,"<br>").replace(/\t/g,"&nbsp;&nbsp;&nbsp;&nbsp;").replace(/^\s/,"&nbsp;").replace(/\s$/,"&nbsp;").replace(/\s\s/g," &nbsp;"),(s.includes("</p><p>")||s.includes("<br>"))&&(s=`<p>${s}</p>`),s}/**
 * @license Copyright (c) 2003-2025, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options
 */function iq(s){return s.replace(/<span(?: class="Apple-converted-space"|)>(\s+)<\/span>/g,(t,e)=>e.length==1?" ":e).replace(/<!--[\s\S]*?-->/g,"")}/**
 * @license Copyright (c) 2003-2025, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options
 */const j2=["figcaption","li"],X2=["ol","ul"];function s7(s,t){if(t.is("$text")||t.is("$textProxy"))return t.data;if(t.is("element","img")&&t.hasAttribute("alt"))return t.getAttribute("alt");if(t.is("element","br"))return`
`;let e="",i=null;for(const n of t.getChildren())e+=nq(n,i)+s7(s,n),i=n;if(t.is("rawElement")){const n=document.createElement("div");t.render(n,s),e+=r7(n)}return e}function r7(s){let t="";if(s.nodeType===Node.TEXT_NODE)return s.textContent;if(s.tagName==="BR")return`
`;for(const e of s.childNodes)t+=r7(e);return t}function nq(s,t){return t?s.is("element","li")&&!s.isEmpty&&s.getChild(0).is("containerElement")||X2.includes(s.name)&&X2.includes(t.name)?`

`:!s.is("containerElement")&&!t.is("containerElement")?"":j2.includes(s.name)||j2.includes(t.name)?`
`:s.is("element")&&s.getCustomProperty("dataPipeline:transparentRendering")||t.is("element")&&t.getCustomProperty("dataPipeline:transparentRendering")?"":`

`:""}class kl extends F{constructor(){super(...arguments);p(this,"_markersToCopy",new Map)}static get pluginName(){return"ClipboardMarkersUtils"}static get isOfficialPlugin(){return!0}_registerMarkerToCopy(e,i){this._markersToCopy.set(e,i)}_copySelectedFragmentWithMarkers(e,i,n=r=>r.model.getSelectedContent(r.model.document.selection)){return this.editor.model.change(r=>{const o=r.model.document.selection;r.setSelection(i);const l=this._insertFakeMarkersIntoSelection(r,r.model.document.selection,e),a=n(r),c=this._removeFakeMarkersInsideElement(r,a);for(const[h,f]of Object.entries(l)){c[h]||(c[h]=r.createRangeIn(a));for(const m of f)r.remove(m)}a.markers.clear();for(const[h,f]of Object.entries(c))a.markers.set(h,f);return r.setSelection(o),a})}_pasteMarkersIntoTransformedElement(e,i){const n=this._getPasteMarkersFromRangeMap(e);return this.editor.model.change(r=>{const o=this._insertFakeMarkersElements(r,n),l=i(r),a=this._removeFakeMarkersInsideElement(r,l);for(const c of Object.values(o).flat())r.remove(c);for(const[c,h]of Object.entries(a))r.model.markers.has(c)||r.addMarker(c,{usingOperation:!0,affectsData:!0,range:h});return l})}_pasteFragmentWithMarkers(e){const i=this._getPasteMarkersFromRangeMap(e.markers);e.markers.clear();for(const n of i)e.markers.set(n.name,n.range);return this.editor.model.insertContent(e)}_forceMarkersCopy(e,i,n={allowedActions:"all",copyPartiallySelected:!0,duplicateOnPaste:!0}){const r=this._markersToCopy.get(e);this._markersToCopy.set(e,n),i(),r?this._markersToCopy.set(e,r):this._markersToCopy.delete(e)}_isMarkerCopyable(e,i){const n=this._getMarkerClipboardConfig(e);if(!n)return!1;if(!i)return!0;const{allowedActions:r}=n;return r==="all"||r.includes(i)}_hasMarkerConfiguration(e){return!!this._getMarkerClipboardConfig(e)}_getMarkerClipboardConfig(e){const[i]=e.split(":");return this._markersToCopy.get(i)||null}_insertFakeMarkersIntoSelection(e,i,n){const r=this._getCopyableMarkersFromSelection(e,i,n);return this._insertFakeMarkersElements(e,r)}_getCopyableMarkersFromSelection(e,i,n){const r=Array.from(i.getRanges()),o=new Set(r.flatMap(a=>Array.from(e.model.markers.getMarkersIntersectingRange(a)))),l=a=>{if(!this._isMarkerCopyable(a.name,n))return!1;const{copyPartiallySelected:h}=this._getMarkerClipboardConfig(a.name);if(!h){const f=a.getRange();return r.some(m=>m.containsRange(f,!0))}return!0};return Array.from(o).filter(l).map(a=>({name:n==="dragstart"?this._getUniqueMarkerName(a.name):a.name,range:a.getRange()}))}_getPasteMarkersFromRangeMap(e,i=null){const{model:n}=this.editor;return(e instanceof Map?Array.from(e.entries()):Object.entries(e)).flatMap(([o,l])=>{if(!this._hasMarkerConfiguration(o))return[{name:o,range:l}];if(this._isMarkerCopyable(o,i)){const a=this._getMarkerClipboardConfig(o),c=n.markers.has(o)&&n.markers.get(o).getRange().root.rootName==="$graveyard";return(a.duplicateOnPaste||c)&&(o=this._getUniqueMarkerName(o)),[{name:o,range:l}]}return[]})}_insertFakeMarkersElements(e,i){const n={},r=i.flatMap(o=>{const{start:l,end:a}=o.range;return[{position:l,marker:o,type:"start"},{position:a,marker:o,type:"end"}]}).sort(({position:o},{position:l})=>o.isBefore(l)?1:-1);for(const{position:o,marker:l,type:a}of r){const c=e.createElement("$marker",{"data-name":l.name,"data-type":a});n[l.name]||(n[l.name]=[]),n[l.name].push(c),e.insert(c,o)}return n}_removeFakeMarkersInsideElement(e,i){const r=this._getAllFakeMarkersFromElement(e,i).reduce((o,l)=>{const a=l.markerElement&&e.createPositionBefore(l.markerElement);let c=o[l.name],h=!1;return c!=null&&c.start&&(c!=null&&c.end)&&(this._getMarkerClipboardConfig(l.name).duplicateOnPaste?o[this._getUniqueMarkerName(l.name)]=o[l.name]:h=!0,c=null),h||(o[l.name]={...c,[l.type]:a}),l.markerElement&&e.remove(l.markerElement),o},{});return Q$(r,o=>new K(o.start||e.createPositionFromPath(i,[0]),o.end||e.createPositionAt(i,"end")))}_getAllFakeMarkersFromElement(e,i){const n=Array.from(e.createRangeIn(i)).flatMap(({item:l})=>{if(!l.is("element","$marker"))return[];const a=l.getAttribute("data-name"),c=l.getAttribute("data-type");return[{markerElement:l,name:a,type:c}]}),r=[],o=[];for(const l of n)l.type==="end"&&(n.some(c=>c.name===l.name&&c.type==="start")||r.push({markerElement:null,name:l.name,type:"start"})),l.type==="start"&&(n.some(c=>c.name===l.name&&c.type==="end")||o.unshift({markerElement:null,name:l.name,type:"end"}));return[...r,...n,...o]}_getUniqueMarkerName(e){const i=e.split(":"),n=ei().substring(1,6);return i.length===3?`${i.slice(0,2).join(":")}:${n}`:`${i.join(":")}:${n}`}}class on extends F{static get pluginName(){return"ClipboardPipeline"}static get isOfficialPlugin(){return!0}static get requires(){return[kl]}init(){this.editor.editing.view.addObserver(Lh),this._setupPasteDrop(),this._setupCopyCut()}_fireOutputTransformationEvent(t,e,i){const n=this.editor.plugins.get("ClipboardMarkersUtils");this.editor.model.enqueueChange({isUndoable:i==="cut"},()=>{const r=n._copySelectedFragmentWithMarkers(i,e);this.fire("outputTransformation",{dataTransfer:t,content:r,method:i})})}_setupPasteDrop(){const t=this.editor,e=t.model,i=t.editing.view,n=i.document,r=this.editor.plugins.get("ClipboardMarkersUtils");this.listenTo(n,"clipboardInput",(o,l)=>{l.method=="paste"&&!t.model.canEditAt(t.model.document.selection)&&o.stop()},{priority:"highest"}),this.listenTo(n,"clipboardInput",(o,l)=>{const a=l.dataTransfer;let c;if(l.content)c=l.content;else{let m="";a.getData("text/html")?m=iq(a.getData("text/html")):a.getData("text/plain")&&(m=tq(a.getData("text/plain"))),c=this.editor.data.htmlProcessor.toView(m)}const h=new Lr(this,"inputTransformation"),f=a.getData("application/ckeditor5-editor-id")||null;this.fire(h,{content:c,dataTransfer:a,sourceEditorId:f,targetRanges:l.targetRanges,method:l.method}),h.stop.called&&o.stop(),i.scrollToTheSelection()},{priority:"low"}),this.listenTo(this,"inputTransformation",(o,l)=>{if(l.content.isEmpty)return;const c=this.editor.data.toModel(l.content,"$clipboardHolder");c.childCount!=0&&(o.stop(),e.change(()=>{this.fire("contentInsertion",{content:c,method:l.method,sourceEditorId:l.sourceEditorId,dataTransfer:l.dataTransfer,targetRanges:l.targetRanges})}))},{priority:"low"}),this.listenTo(this,"contentInsertion",(o,l)=>{l.resultRange=r._pasteFragmentWithMarkers(l.content)},{priority:"low"})}_setupCopyCut(){const t=this.editor,e=t.model.document,n=t.editing.view.document,r=(o,l)=>{const a=l.dataTransfer;l.preventDefault(),this._fireOutputTransformationEvent(a,e.selection,o.name)};this.listenTo(n,"copy",r,{priority:"low"}),this.listenTo(n,"cut",(o,l)=>{t.model.canEditAt(t.model.document.selection)?r(o,l):l.preventDefault()},{priority:"low"}),this.listenTo(this,"outputTransformation",(o,l)=>{const a=t.data.toView(l.content,{isClipboardPipeline:!0});n.fire("clipboardOutput",{dataTransfer:l.dataTransfer,content:a,method:l.method})},{priority:"low"}),this.listenTo(n,"clipboardOutput",(o,l)=>{l.content.isEmpty||(l.dataTransfer.setData("text/html",this.editor.data.htmlProcessor.toData(l.content)),l.dataTransfer.setData("text/plain",s7(t.data.htmlProcessor.domConverter,l.content)),l.dataTransfer.setData("application/ckeditor5-editor-id",this.editor.id)),l.method=="cut"&&t.model.deleteContent(e.selection)},{priority:"low"})}}const Sx=No("px");let sq=class extends ue{constructor(){super();const t=this.bindTemplate;this.set({isVisible:!1,left:null,top:null,width:null}),this.setTemplate({tag:"div",attributes:{class:["ck","ck-clipboard-drop-target-line",t.if("isVisible","ck-hidden",e=>!e)],style:{left:t.to("left",e=>Sx(e)),top:t.to("top",e=>Sx(e)),width:t.to("width",e=>Sx(e))}}})}};class im extends F{constructor(){super(...arguments);p(this,"removeDropMarkerDelayed",_p(()=>this.removeDropMarker(),40));p(this,"_updateDropMarkerThrottled",hc(e=>this._updateDropMarker(e),40));p(this,"_reconvertMarkerThrottled",hc(()=>{this.editor.model.markers.has("drop-target")&&this.editor.editing.reconvertMarker("drop-target")},0));p(this,"_dropTargetLineView",new sq);p(this,"_domEmitter",new(qi()));p(this,"_scrollables",new Map)}static get pluginName(){return"DragDropTarget"}static get isOfficialPlugin(){return!0}init(){this._setupDropMarker()}destroy(){this._domEmitter.stopListening();for(const{resizeObserver:e}of this._scrollables.values())e.destroy();return this._updateDropMarkerThrottled.cancel(),this.removeDropMarkerDelayed.cancel(),this._reconvertMarkerThrottled.cancel(),super.destroy()}updateDropMarker(e,i,n,r,o,l){this.removeDropMarkerDelayed.cancel();const a=G2(this.editor,e,i,n,r,o,l);/* istanbul ignore next -- @preserve */if(a){if(l&&l.containsRange(a))return this.removeDropMarker();this._updateDropMarkerThrottled(a)}}getFinalDropRange(e,i,n,r,o,l){const a=G2(this.editor,e,i,n,r,o,l);return this.removeDropMarker(),a}removeDropMarker(){const e=this.editor.model;this.removeDropMarkerDelayed.cancel(),this._updateDropMarkerThrottled.cancel(),this._dropTargetLineView.isVisible=!1,e.markers.has("drop-target")&&e.change(i=>{i.removeMarker("drop-target")})}_setupDropMarker(){const e=this.editor;e.ui.view.body.add(this._dropTargetLineView),e.conversion.for("editingDowncast").markerToHighlight({model:"drop-target",view:{classes:["ck-clipboard-drop-target-range"]}}),e.conversion.for("editingDowncast").markerToElement({model:"drop-target",view:(i,{writer:n})=>{if(e.model.schema.checkChild(i.markerRange.start,"$text"))return this._dropTargetLineView.isVisible=!1,this._createDropTargetPosition(n);i.markerRange.isCollapsed?this._updateDropTargetLine(i.markerRange):this._dropTargetLineView.isVisible=!1}})}_updateDropMarker(e){const i=this.editor,n=i.model.markers;i.model.change(r=>{n.has("drop-target")?n.get("drop-target").getRange().isEqual(e)||r.updateMarker("drop-target",{range:e}):r.addMarker("drop-target",{range:e,usingOperation:!1,affectsData:!1})})}_createDropTargetPosition(e){return e.createUIElement("span",{class:"ck ck-clipboard-drop-target-position"},function(i){const n=this.toDomElement(i);return n.append("⁠",i.createElement("span"),"⁠"),n})}_updateDropTargetLine(e){const i=this.editor.editing,n=e.start.nodeBefore,r=e.start.nodeAfter,o=e.start.parent,l=n?i.mapper.toViewElement(n):null,a=l?i.view.domConverter.mapViewToDom(l):null,c=r?i.mapper.toViewElement(r):null,h=c?i.view.domConverter.mapViewToDom(c):null,f=i.mapper.toViewElement(o);if(!f)return;const m=i.view.domConverter.mapViewToDom(f),w=this._getScrollableRect(f),{scrollX:O,scrollY:_}=he.window,k=a?new Ve(a):null,C=h?new Ve(h):null,P=new Ve(m).excludeScrollbarsAndBorders(),M=k?k.bottom:P.top,Q=C?C.top:P.bottom,N=he.window.getComputedStyle(m),G=M<=Q?(M+Q)/2:Q;if(w.top<G&&G<w.bottom){const D=P.left+parseFloat(N.paddingLeft),b=P.right-parseFloat(N.paddingRight),I=Math.max(D+O,w.left),B=Math.min(b+O,w.right);this._dropTargetLineView.set({isVisible:!0,left:I,top:G+_,width:B-I})}else this._dropTargetLineView.isVisible=!1}_getScrollableRect(e){const i=e.root.rootName;let n;if(this._scrollables.has(i))n=this._scrollables.get(i).domElement;else{const r=this.editor.editing.view.domConverter.mapViewToDom(e);n=oq(r),this._domEmitter.listenTo(n,"scroll",this._reconvertMarkerThrottled,{usePassive:!0});const o=new yp(n,this._reconvertMarkerThrottled);this._scrollables.set(i,{domElement:n,resizeObserver:o})}return new Ve(n).excludeScrollbarsAndBorders()}}function G2(s,t,e,i,n,r,o){const l=s.model,a=s.editing.mapper;let h=Y2(s,t);for(;h;){if(!r){if(l.schema.checkChild(h,"$text")){if(e){const f=e[0].start,m=a.toModelPosition(f);if(!o||Array.from(o.getItems({shallow:!0})).every(O=>l.schema.checkChild(m,O))){if(l.schema.checkChild(m,"$text"))return l.createRange(m);if(f)return nm(s,Y2(s,f.parent),i,n)}}}else if(l.schema.isInline(h))return nm(s,h,i,n)}if(l.schema.isBlock(h))return nm(s,h,i,n);if(l.schema.checkChild(h,"$block")){const f=Array.from(h.getChildren()).filter(O=>O.is("element")&&!rq(s,O));let m=0,w=f.length;if(w==0)return l.createRange(l.createPositionAt(h,"end"));for(;m<w-1;){const O=Math.floor((m+w)/2);o7(s,f[O],i,n)=="before"?w=O:m=O}return nm(s,f[m],i,n)}h=h.parent}return null}function rq(s,t){const e=s.editing.mapper,i=s.editing.view.domConverter,n=e.toViewElement(t);if(!n)return!0;const r=i.mapViewToDom(n);return he.window.getComputedStyle(r).float!="none"}function nm(s,t,e,i){const n=s.model;return n.createRange(n.createPositionAt(t,o7(s,t,e,i)))}function o7(s,t,e,i){const n=s.editing.mapper,r=s.editing.view.domConverter,o=n.toViewElement(t),l=r.mapViewToDom(o),a=new Ve(l);return s.model.schema.isInline(t)?e<(a.left+a.right)/2?"before":"after":i<(a.top+a.bottom)/2?"before":"after"}function Y2(s,t){const e=s.editing.mapper,i=s.editing.view,n=e.toModelElement(t);if(n)return n;const r=i.createPositionBefore(t),o=e.findMappedViewAncestor(r);return e.toModelElement(o)}function oq(s){let t=s;do{t=t.parentElement;const e=he.window.getComputedStyle(t).overflowY;if(e=="auto"||e=="scroll")break}while(t.tagName!="BODY");return t}class lq extends F{constructor(){super(...arguments);p(this,"_isBlockDragging",!1);p(this,"_domEmitter",new(qi()))}static get pluginName(){return"DragDropBlockToolbar"}static get isOfficialPlugin(){return!0}init(){const e=this.editor;if(this.listenTo(e,"change:isReadOnly",(i,n,r)=>{r?(this.forceDisabled("readOnlyMode"),this._isBlockDragging=!1):this.clearForceDisabled("readOnlyMode")}),Ie.isAndroid&&this.forceDisabled("noAndroidSupport"),e.plugins.has("BlockToolbar")){const n=e.plugins.get("BlockToolbar").buttonView.element;this._domEmitter.listenTo(n,"dragstart",(r,o)=>this._handleBlockDragStart(o)),this._domEmitter.listenTo(he.document,"dragover",(r,o)=>this._handleBlockDragging(o)),this._domEmitter.listenTo(he.document,"drop",(r,o)=>this._handleBlockDragging(o)),this._domEmitter.listenTo(he.document,"dragend",()=>this._handleBlockDragEnd(),{useCapture:!0}),this.isEnabled&&n.setAttribute("draggable","true"),this.on("change:isEnabled",(r,o,l)=>{n.setAttribute("draggable",l?"true":"false")})}}destroy(){return this._domEmitter.stopListening(),super.destroy()}_handleBlockDragStart(e){if(!this.isEnabled)return;const i=this.editor.model,n=i.document.selection,r=this.editor.editing.view,o=Array.from(n.getSelectedBlocks()),l=i.createRange(i.createPositionBefore(o[0]),i.createPositionAfter(o[o.length-1]));i.change(a=>a.setSelection(l)),this._isBlockDragging=!0,r.focus(),r.getObserver(Lh).onDomEvent(e)}_handleBlockDragging(e){if(!this.isEnabled||!this._isBlockDragging)return;const i=e.clientX+(this.editor.locale.contentLanguageDirection=="ltr"?100:-100),n=e.clientY,r=document.elementFromPoint(i,n),o=this.editor.editing.view;!r||!r.closest(".ck-editor__editable")||o.getObserver(Lh).onDomEvent({...e,type:e.type,dataTransfer:e.dataTransfer,target:r,clientX:i,clientY:n,preventDefault:()=>e.preventDefault(),stopPropagation:()=>e.stopPropagation()})}_handleBlockDragEnd(){this._isBlockDragging=!1}}class aq extends F{constructor(){super(...arguments);p(this,"_draggedRange");p(this,"_draggingUid");p(this,"_draggableElement");p(this,"_clearDraggableAttributesDelayed",_p(()=>this._clearDraggableAttributes(),40));p(this,"_blockMode",!1);p(this,"_domEmitter",new(qi()));p(this,"_previewContainer")}static get pluginName(){return"DragDrop"}static get isOfficialPlugin(){return!0}static get requires(){return[on,Lc,im,lq]}init(){const e=this.editor,i=e.editing.view;this._draggedRange=null,this._draggingUid="",this._draggableElement=null,i.addObserver(Lh),i.addObserver(Pp),this._setupDragging(),this._setupContentInsertionIntegration(),this._setupClipboardInputIntegration(),this._setupDraggableAttributeHandling(),this.listenTo(e,"change:isReadOnly",(n,r,o)=>{o?this.forceDisabled("readOnlyMode"):this.clearForceDisabled("readOnlyMode")}),this.on("change:isEnabled",(n,r,o)=>{o||this._finalizeDragging(!1)}),Ie.isAndroid&&this.forceDisabled("noAndroidSupport")}destroy(){return this._draggedRange&&(this._draggedRange.detach(),this._draggedRange=null),this._previewContainer&&this._previewContainer.remove(),this._domEmitter.stopListening(),this._clearDraggableAttributesDelayed.cancel(),super.destroy()}_setupDragging(){const e=this.editor,i=e.model,n=e.editing.view,r=n.document,o=e.plugins.get(im);this.listenTo(r,"dragstart",(l,a)=>{var _;if((_=a.target)!=null&&_.is("editableElement")){a.preventDefault();return}if(this._prepareDraggedRange(a.target),!this._draggedRange){a.preventDefault();return}this._draggingUid=ei(),a.dataTransfer.effectAllowed=this.isEnabled?"copyMove":"copy",a.dataTransfer.setData("application/ckeditor5-dragging-uid",this._draggingUid);const c=i.createSelection(this._draggedRange.toRange());this.editor.plugins.get("ClipboardPipeline")._fireOutputTransformationEvent(a.dataTransfer,c,"dragstart");const{dataTransfer:f,domTarget:m,domEvent:w}=a,{clientX:O}=w;this._updatePreview({dataTransfer:f,domTarget:m,clientX:O}),a.stopPropagation(),this.isEnabled||(this._draggedRange.detach(),this._draggedRange=null,this._draggingUid="")},{priority:"low"}),this.listenTo(r,"dragend",(l,a)=>{this._finalizeDragging(!a.dataTransfer.isCanceled&&a.dataTransfer.dropEffect=="move")},{priority:"low"}),this._domEmitter.listenTo(he.document,"dragend",()=>{this._blockMode=!1},{useCapture:!0}),this.listenTo(r,"dragenter",()=>{this.isEnabled&&n.focus()}),this.listenTo(r,"dragleave",()=>{o.removeDropMarkerDelayed()}),this.listenTo(r,"dragging",(l,a)=>{if(!this.isEnabled){a.dataTransfer.dropEffect="none";return}const{clientX:c,clientY:h}=a.domEvent;o.updateDropMarker(a.target,a.targetRanges,c,h,this._blockMode,this._draggedRange),this._draggedRange||(a.dataTransfer.dropEffect="copy"),Ie.isGecko||(a.dataTransfer.effectAllowed=="copy"?a.dataTransfer.dropEffect="copy":["all","copyMove"].includes(a.dataTransfer.effectAllowed)&&(a.dataTransfer.dropEffect="move")),l.stop()},{priority:"low"})}_setupClipboardInputIntegration(){const e=this.editor,n=e.editing.view.document,r=e.plugins.get(im);this.listenTo(n,"clipboardInput",(o,l)=>{if(l.method!="drop")return;const{clientX:a,clientY:c}=l.domEvent,h=r.getFinalDropRange(l.target,l.targetRanges,a,c,this._blockMode,this._draggedRange);if(!h){this._finalizeDragging(!1),o.stop();return}if(this._draggedRange&&this._draggingUid!=l.dataTransfer.getData("application/ckeditor5-dragging-uid")&&(this._draggedRange.detach(),this._draggedRange=null,this._draggingUid=""),K2(l.dataTransfer)=="move"&&this._draggedRange&&this._draggedRange.containsRange(h,!0)){this._finalizeDragging(!1),o.stop();return}l.targetRanges=[e.editing.mapper.toViewRange(h)]},{priority:"high"})}_setupContentInsertionIntegration(){const e=this.editor.plugins.get(on);e.on("contentInsertion",(i,n)=>{if(!this.isEnabled||n.method!=="drop")return;const r=n.targetRanges.map(o=>this.editor.editing.mapper.toModelRange(o));this.editor.model.change(o=>o.setSelection(r))},{priority:"high"}),e.on("contentInsertion",(i,n)=>{if(!this.isEnabled||n.method!=="drop")return;const r=K2(n.dataTransfer)=="move",o=!n.resultRange||!n.resultRange.isCollapsed;this._finalizeDragging(o&&r)},{priority:"lowest"})}_setupDraggableAttributeHandling(){const e=this.editor,i=e.editing.view,n=i.document;this.listenTo(n,"mousedown",(r,o)=>{if(Ie.isAndroid||!o)return;this._clearDraggableAttributesDelayed.cancel();let l=J2(o.target);if(Ie.isBlink&&!e.isReadOnly&&!l&&!n.selection.isCollapsed){const a=n.selection.getSelectedElement();(!a||!Ut(a))&&(l=n.selection.editableElement)}l&&(i.change(a=>{a.setAttribute("draggable","true",l)}),this._draggableElement=e.editing.mapper.toModelElement(l))}),this.listenTo(n,"mouseup",()=>{Ie.isAndroid||this._clearDraggableAttributesDelayed()})}_clearDraggableAttributes(){const e=this.editor.editing;e.view.change(i=>{this._draggableElement&&this._draggableElement.root.rootName!="$graveyard"&&i.removeAttribute("draggable",e.mapper.toViewElement(this._draggableElement)),this._draggableElement=null})}_finalizeDragging(e){const i=this.editor,n=i.model;i.plugins.get(im).removeDropMarker(),this._clearDraggableAttributes(),i.plugins.has("WidgetToolbarRepository")&&i.plugins.get("WidgetToolbarRepository").clearForceDisabled("dragDrop"),this._draggingUid="",this._previewContainer&&(this._previewContainer.remove(),this._previewContainer=void 0),this._draggedRange&&(e&&this.isEnabled&&n.change(o=>{const l=n.createSelection(this._draggedRange);n.deleteContent(l,{doNotAutoparagraph:!0});const a=l.getFirstPosition().parent;a.isEmpty&&!n.schema.checkChild(a,"$text")&&n.schema.checkChild(a,"paragraph")&&o.insertElement("paragraph",a,0)}),this._draggedRange.detach(),this._draggedRange=null)}_prepareDraggedRange(e){const i=this.editor,n=i.model,r=n.document.selection,o=e?J2(e):null;if(o){const h=i.editing.mapper.toModelElement(o);this._draggedRange=bn.fromRange(n.createRangeOn(h)),this._blockMode=n.schema.isBlock(h),i.plugins.has("WidgetToolbarRepository")&&i.plugins.get("WidgetToolbarRepository").forceDisabled("dragDrop");return}if(r.isCollapsed&&!r.getFirstPosition().parent.isEmpty)return;const l=Array.from(r.getSelectedBlocks()),a=r.getFirstRange();if(l.length==0){this._draggedRange=bn.fromRange(a);return}const c=l7(n,l);if(l.length>1)this._draggedRange=bn.fromRange(c),this._blockMode=!0;else if(l.length==1){const h=a.start.isTouching(c.start)&&a.end.isTouching(c.end);this._draggedRange=bn.fromRange(h?c:a),this._blockMode=h}n.change(h=>h.setSelection(this._draggedRange.toRange()))}_updatePreview({dataTransfer:e,domTarget:i,clientX:n}){const r=this.editor.editing.view,o=r.document.selection.editableElement,l=r.domConverter.mapViewToDom(o),a=he.window.getComputedStyle(l);this._previewContainer?this._previewContainer.firstElementChild&&this._previewContainer.removeChild(this._previewContainer.firstElementChild):(this._previewContainer=bi(he.document,"div",{style:"position: fixed; left: -999999px;"}),he.document.body.appendChild(this._previewContainer));const c=new Ve(l);if(l.contains(i))return;const h=parseFloat(a.paddingLeft),f=bi(he.document,"div");f.className="ck ck-content",f.style.width=a.width,f.style.paddingLeft=`${c.left-n+h}px`,Ie.isiOS&&(f.style.backgroundColor="white"),r.domConverter.setContentOf(f,e.getData("text/html")),e.setDragImage(f,0,0),this._previewContainer.appendChild(f)}}function K2(s){return Ie.isGecko?s.dropEffect:["all","copyMove"].includes(s.effectAllowed)?"move":"copy"}function J2(s){if(s.is("editableElement"))return null;if(s.hasClass("ck-widget__selection-handle"))return s.findAncestor(Ut);if(Ut(s))return s;const t=s.findAncestor(e=>Ut(e)||e.is("editableElement"));return Ut(t)?t:null}function l7(s,t){const e=t[0],i=t[t.length-1],n=e.getCommonAncestor(i),r=s.createPositionBefore(e),o=s.createPositionAfter(i);if(n&&n.is("element")&&!s.schema.isLimit(n)){const l=s.createRangeOn(n),a=r.isTouching(l.start),c=o.isTouching(l.end);if(a&&c)return l7(s,[n])}return s.createRange(r,o)}class cq extends F{static get pluginName(){return"PastePlainText"}static get isOfficialPlugin(){return!0}static get requires(){return[on]}init(){const t=this.editor,e=t.model,i=t.editing.view,n=e.document.selection;i.addObserver(Lh),t.plugins.get(on).on("contentInsertion",(r,o)=>{uq(o.content,e)&&e.change(l=>{const a=Array.from(n.getAttributes()).filter(([h])=>e.schema.getAttributeProperties(h).isFormatting);n.isCollapsed||e.deleteContent(n,{doNotAutoparagraph:!0}),a.push(...n.getAttributes());const c=l.createRangeIn(o.content);for(const h of c.getItems())for(const f of a)e.schema.checkAttribute(h,f[0])&&l.setAttribute(f[0],f[1],h)})})}}function uq(s,t){let e=t.createRangeIn(s);if(s.childCount==1){const i=s.getChild(0);i.is("element")&&t.schema.isBlock(i)&&!t.schema.isObject(i)&&!t.schema.isLimit(i)&&(e=t.createRangeIn(i))}for(const i of e.getItems())if(!t.schema.isInline(i)||Array.from(i.getAttributeKeys()).find(r=>t.schema.getAttributeProperties(r).isFormatting))return!1;return!0}class a7 extends F{static get pluginName(){return"Clipboard"}static get isOfficialPlugin(){return!0}static get requires(){return[kl,on,aq,cq]}init(){const t=this.editor,e=this.editor.t;t.accessibility.addKeystrokeInfos({keystrokes:[{label:e("Copy selected content"),keystroke:"CTRL+C"},{label:e("Paste content"),keystroke:"CTRL+V"},{label:e("Paste content as plain text"),keystroke:"CTRL+SHIFT+V"}]})}}/**
 * @license Copyright (c) 2003-2025, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options
 */const hq={autoRefresh:!0},e5=36e5,dq=5e3;class xy extends at(){constructor(e,i={}){super();p(this,"_refresh");p(this,"_options");p(this,"_tokenRefreshTimeout");p(this,"_isDestroyed",!1);if(!e)throw new E("token-missing-token-url",this);i.initValue&&this._validateTokenValue(i.initValue),this.set("value",i.initValue),typeof e=="function"?this._refresh=e:this._refresh=()=>fq(e),this._options={...hq,...i}}init(){return new Promise((e,i)=>{if(!this.value){this.refreshToken().then(e).catch(i);return}this._options.autoRefresh&&this._registerRefreshTokenTimeout(),e(this)})}refreshToken(){const e=this._options.autoRefresh;return this._refresh().then(i=>(this._validateTokenValue(i),this.set("value",i),e&&this._registerRefreshTokenTimeout(),this)).catch(i=>{throw Ue("token-refresh-failed",{autoRefresh:e}),e&&this._registerRefreshTokenTimeout(dq),i})}destroy(){this._isDestroyed=!0,clearTimeout(this._tokenRefreshTimeout)}_validateTokenValue(e){const i=typeof e=="string",n=!/^".*"$/.test(e),r=i&&e.split(".").length===3;if(!(n&&r))throw new E("token-not-in-jwt-format",this)}_registerRefreshTokenTimeout(e){if(clearTimeout(this._tokenRefreshTimeout),this._isDestroyed)return;const i=e||this._getTokenRefreshTimeoutTime();this._tokenRefreshTimeout=setTimeout(()=>{this.refreshToken()},i)}_getTokenRefreshTimeoutTime(){try{const[,e]=this.value.split("."),{exp:i}=JSON.parse(atob(e));return i?Math.floor((i*1e3-Date.now())/2):e5}catch{return e5}}static create(e,i={}){return new xy(e,i).init()}}function fq(s){return new Promise((t,e)=>{const i=new XMLHttpRequest;i.open("GET",s),i.addEventListener("load",()=>{const n=i.status,r=i.response;return n<200||n>299?e(new E("token-cannot-download-new-token",null)):t(r)}),i.addEventListener("error",()=>e(new Error("Network Error"))),i.addEventListener("abort",()=>e(new Error("Abort"))),i.send()})}const Gb=/^data:(\S*?);base64,/;class mq extends pt(){constructor(e,i,n){super();p(this,"file");p(this,"xhr");p(this,"_token");p(this,"_apiAddress");if(!e)throw new E("fileuploader-missing-file",null);if(!i)throw new E("fileuploader-missing-token",null);if(!n)throw new E("fileuploader-missing-api-address",null);this.file=pq(e)?gq(e):e,this._token=i,this._apiAddress=n}onProgress(e){return this.on("progress",(i,n)=>e(n)),this}onError(e){return this.once("error",(i,n)=>e(n)),this}abort(){this.xhr.abort()}send(){return this._prepareRequest(),this._attachXHRListeners(),this._sendRequest()}_prepareRequest(){const e=new XMLHttpRequest;e.open("POST",this._apiAddress),e.setRequestHeader("Authorization",this._token.value),e.responseType="json",this.xhr=e}_attachXHRListeners(){const e=this.xhr,i=n=>()=>this.fire("error",n);e.addEventListener("error",i("Network Error")),e.addEventListener("abort",i("Abort"));/* istanbul ignore else -- @preserve */e.upload&&e.upload.addEventListener("progress",n=>{n.lengthComputable&&this.fire("progress",{total:n.total,uploaded:n.loaded})}),e.addEventListener("load",()=>{const n=e.status,r=e.response;if(n<200||n>299)return this.fire("error",r.message||r.error)})}_sendRequest(){const e=new FormData,i=this.xhr;return e.append("file",this.file),new Promise((n,r)=>{i.addEventListener("load",()=>{const o=i.status,l=i.response;return o<200||o>299?l.message?r(new E("fileuploader-uploading-data-failed",this,{message:l.message})):r(l.error):n(l)}),i.addEventListener("error",()=>r(new Error("Network Error"))),i.addEventListener("abort",()=>r(new Error("Abort"))),i.send(e)})}}function gq(s,t=512){try{const e=s.match(Gb)[1],i=atob(s.replace(Gb,"")),n=[];for(let r=0;r<i.length;r+=t){const o=i.slice(r,r+t),l=new Array(o.length);for(let a=0;a<o.length;a++)l[a]=o.charCodeAt(a);n.push(new Uint8Array(l))}return new Blob(n,{type:e})}catch{throw new E("fileuploader-decoding-image-data-error",null)}}function pq(s){var t;return typeof s!="string"?!1:!!((t=s.match(Gb))!=null&&t.length)}class wq{constructor(t,e){p(this,"_token");p(this,"_apiAddress");if(!t)throw new E("uploadgateway-missing-token",null);if(!e)throw new E("uploadgateway-missing-api-address",null);this._token=t,this._apiAddress=e}upload(t){return new mq(t,this._token,this._apiAddress)}}class xq extends Tp{static get pluginName(){return"CloudServicesCore"}static get isOfficialPlugin(){return!0}createToken(t,e){return new xy(t,e)}createUploadGateway(t,e){return new wq(t,e)}}class bq extends Tp{constructor(){super(...arguments);p(this,"tokenUrl");p(this,"uploadUrl");p(this,"webSocketUrl");p(this,"bundleVersion");p(this,"token",null);p(this,"_tokens",new Map)}static get pluginName(){return"CloudServices"}static get isOfficialPlugin(){return!0}static get requires(){return[xq]}async init(){const i=this.context.config.get("cloudServices")||{};for(const[o,l]of Object.entries(i))this[o]=l;if(!this.tokenUrl){this.token=null;return}const r=this.context.plugins.get("CloudServicesCore").createToken(this.tokenUrl);try{this.token=await r.init(),this._tokens.set(this.tokenUrl,this.token)}catch(o){throw r.destroy(),o}}async registerTokenUrl(e){if(this._tokens.has(e))return this.getTokenFor(e);const n=await this.context.plugins.get("CloudServicesCore").createToken(e).init();return this._tokens.set(e,n),n}getTokenFor(e){const i=this._tokens.get(e);if(!i)throw new E("cloudservices-token-not-registered",this);return i}destroy(){super.destroy();for(const e of this._tokens.values())e.destroy()}}/**
 * @license Copyright (c) 2003-2025, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options
 */function Ag(s){const t=s.t,e=s.config.get("codeBlock.languages");for(const i of e)i.label==="Plain text"&&(i.label=t("Plain text")),i.class===void 0&&(i.class=`language-${i.language}`);return e}function Ig(s,t,e){const i={};for(const n of s)if(t==="class"){const r=n[t].split(" ").shift();i[r]=n[e]}else i[n[t]]=n[e];return i}function by(s){return s.data.match(/^(\s*)/)[0]}function Oq(s,t){const e=s.createDocumentFragment(),i=t.split(`
`),n=i.reduce((r,o,l)=>(r.push(o),l<i.length-1&&r.push(s.createElement("br")),r),[]);return s.appendChild(n,e),e}function Yb(s){const t=s.document.selection,e=[];if(t.isCollapsed)return[t.anchor];const i=t.getFirstRange().getWalker({ignoreElementEnd:!0,direction:"backward"});for(const{item:n}of i){let r=n.is("$textProxy")?n.textNode:n;const o=r.parent;if(!o.is("element","codeBlock")||r.is("element","softBreak"))continue;for(;r.previousSibling&&!r.previousSibling.is("element","softBreak");)r=r.previousSibling;const l=r.is("$text")?r.startOffset+by(r).length:r.startOffset,a=s.createPositionAt(o,l);e.every(c=>!c.isEqual(a))&&e.push(a)}return e}function c7(s){const t=$t(s.getSelectedBlocks());return!!t&&t.is("element","codeBlock")}function t5(s,t){return t.is("rootElement")||s.isLimit(t)?!1:s.checkChild(t.parent,"codeBlock")}function i5(s,t,e,i){const n=Ig(t,"language","label"),r=e.getAttribute("language");if(r in n){const o=n[r];return s(i==="enter"?"Entering %0 code snippet":"Leaving %0 code snippet",o)}return s(i==="enter"?"Entering code snippet":"Leaving code snippet")}function u7(s,t){for(s.textNode&&(s=t.createPositionBefore(s.textNode));s.nodeBefore&&!s.nodeBefore.is("element","softBreak");)s=t.createPositionBefore(s.nodeBefore);const e=s.nodeAfter;return e&&e.is("$text")?e:null}class yq extends Be{constructor(e){super(e);p(this,"_lastLanguage");this._lastLanguage=null}refresh(){this.value=this._getValue(),this.isEnabled=this._checkEnabled()}execute(e={}){const i=this.editor,n=i.model,r=n.document.selection,l=Ag(i)[0],a=Array.from(r.getSelectedBlocks()),c=e.forceValue==null?!this.value:e.forceValue,h=vq(e,this._lastLanguage,l.language);n.change(f=>{c?this._applyCodeBlock(f,a,h):this._removeCodeBlock(f,a)})}_getValue(){const e=this.editor.model.document.selection,i=$t(e.getSelectedBlocks());return!!(i!=null&&i.is("element","codeBlock"))?i.getAttribute("language"):!1}_checkEnabled(){if(this.value)return!0;const e=this.editor.model.document.selection,i=this.editor.model.schema,n=$t(e.getSelectedBlocks());return n?t5(i,n):!1}_applyCodeBlock(e,i,n){this._lastLanguage=n;const r=this.editor.model.schema,o=i.filter(l=>t5(r,l));for(const l of o)e.rename(l,"codeBlock"),e.setAttribute("language",n,l),r.removeDisallowedAttributes([l],e),Array.from(l.getChildren()).filter(a=>!r.checkChild(l,a)).forEach(a=>e.remove(a));o.reverse().forEach((l,a)=>{const c=o[a+1];l.previousSibling===c&&(e.appendElement("softBreak",c),e.merge(e.createPositionBefore(l)))})}_removeCodeBlock(e,i){const n=i.filter(r=>r.is("element","codeBlock"));for(const r of n){const o=e.createRangeOn(r);for(const l of Array.from(o.getItems()).reverse())if(l.is("element","softBreak")&&l.parent.is("element","codeBlock")){const{position:a}=e.split(e.createPositionBefore(l)),c=a.nodeAfter;e.rename(c,"paragraph"),e.removeAttribute("language",c),e.remove(l)}e.rename(r,"paragraph"),e.removeAttribute("language",r)}}}function vq(s,t,e){return s.language?s.language:s.usePreviousLanguageChoice&&t?t:e}class _q extends Be{constructor(e){super(e);p(this,"_indentSequence");this._indentSequence=e.config.get("codeBlock.indentSequence")}refresh(){this.isEnabled=this._checkEnabled()}execute(){const i=this.editor.model;i.change(n=>{const r=Yb(i);for(const o of r){const l=n.createText(this._indentSequence);i.insertContent(l,o)}})}_checkEnabled(){return this._indentSequence?c7(this.editor.model.document.selection):!1}}class kq extends Be{constructor(e){super(e);p(this,"_indentSequence");this._indentSequence=e.config.get("codeBlock.indentSequence")}refresh(){this.isEnabled=this._checkEnabled()}execute(){const i=this.editor.model;i.change(()=>{const n=Yb(i);for(const r of n){const o=n5(i,r,this._indentSequence);o&&i.deleteContent(i.createSelection(o))}})}_checkEnabled(){if(!this._indentSequence)return!1;const e=this.editor.model;return c7(e.document.selection)?Yb(e).some(i=>n5(e,i,this._indentSequence)):!1}}function n5(s,t,e){const i=u7(t,s);if(!i)return null;const n=by(i),r=n.lastIndexOf(e);if(r+e.length!==n.length||r===-1)return null;const{parent:o,startOffset:l}=i;return s.createRange(s.createPositionAt(o,l+r),s.createPositionAt(o,l+r+e.length))}function s5(s,t,e=!1){const i=Ig(t,"language","class"),n=Ig(t,"language","label");return(r,o,l)=>{const{writer:a,mapper:c,consumable:h}=l;if(!h.consume(o.item,"insert"))return;const f=o.item.getAttribute("language"),m=c.toViewPosition(s.createPositionBefore(o.item)),w={};e&&(w["data-language"]=n[f],w.spellcheck="false");const O=i[f]?{class:i[f]}:void 0,_=a.createContainerElement("code",O),k=a.createContainerElement("pre",w,_);a.insert(m,k),c.bindElements(o.item,_)}}function Sq(s){return(t,e,i)=>{if(e.item.parent.name!=="codeBlock")return;const{writer:n,mapper:r,consumable:o}=i;if(!o.consume(e.item,"insert"))return;const l=r.toViewPosition(s.createPositionBefore(e.item));n.insert(l,n.createText(`
`))}}function Cq(s,t){const e=Ig(t,"class","language"),i=t[0].language;return(n,r,o)=>{const l=r.viewItem,a=l.parent;if(!a||!a.is("element","pre")||r.modelCursor.findAncestor("codeBlock"))return;const{consumable:c,writer:h}=o;if(!c.test(l,{name:!0}))return;const f=h.createElement("codeBlock"),m=[...l.getClassNames()];m.length||m.push("");for(const w of m){const O=e[w];if(O){h.setAttribute("language",O,f);break}}f.hasAttribute("language")||h.setAttribute("language",i,f),o.convertChildren(l,f),o.safeInsert(f,r.modelCursor)&&(c.consume(l,{name:!0}),o.updateConversionResult(f,r))}}function Pq(){return(s,t,{consumable:e,writer:i})=>{let n=t.modelCursor;if(!e.test(t.viewItem)||!n.findAncestor("codeBlock"))return;e.consume(t.viewItem);const o=t.viewItem.data.split(`
`).map(a=>i.createText(a)),l=o[o.length-1];for(const a of o)if(i.insert(a,n),n=n.getShiftedBy(a.offsetSize),a!==l){const c=i.createElement("softBreak");i.insert(c,n),n=i.createPositionAfter(c)}t.modelRange=i.createRange(t.modelCursor,n),t.modelCursor=n}}function Tq(){return(s,t,{consumable:e})=>{const i=t.viewItem;if(i.findAncestor("pre"))return;const n=Array.from(i.getChildren()),r=n.find(o=>o.is("element","code"));if(r)for(const o of n)o===r||!o.is("$text")||e.consume(o,{name:!0})}}const h7="paragraph";class Eq extends F{static get pluginName(){return"CodeBlockEditing"}static get isOfficialPlugin(){return!0}static get requires(){return[GI]}constructor(t){super(t),t.config.define("codeBlock",{languages:[{language:"plaintext",label:"Plain text"},{language:"c",label:"C"},{language:"cs",label:"C#"},{language:"cpp",label:"C++"},{language:"css",label:"CSS"},{language:"diff",label:"Diff"},{language:"go",label:"Go"},{language:"html",label:"HTML"},{language:"java",label:"Java"},{language:"javascript",label:"JavaScript"},{language:"php",label:"PHP"},{language:"python",label:"Python"},{language:"ruby",label:"Ruby"},{language:"typescript",label:"TypeScript"},{language:"xml",label:"XML"}],indentSequence:"	"})}init(){const t=this.editor,e=t.model.schema,i=t.model,n=t.editing.view,r=Ag(t);t.commands.add("codeBlock",new yq(t)),t.commands.add("indentCodeBlock",new _q(t)),t.commands.add("outdentCodeBlock",new kq(t)),this.listenTo(n.document,"tab",(o,l)=>{const a=l.shiftKey?"outdentCodeBlock":"indentCodeBlock";t.commands.get(a).isEnabled&&(t.execute(a),l.stopPropagation(),l.preventDefault(),o.stop())},{context:"pre"}),e.register("codeBlock",{allowWhere:"$block",allowChildren:"$text",disallowChildren:"$inlineObject",allowAttributes:["language"],allowAttributesOf:"$listItem",isBlock:!0}),e.addAttributeCheck((o,l)=>{const a=o.getItem(o.length-2);if(e.getAttributeProperties(l).isFormatting&&a&&a.name=="codeBlock")return!1}),t.editing.downcastDispatcher.on("insert:codeBlock",s5(i,r,!0)),t.data.downcastDispatcher.on("insert:codeBlock",s5(i,r)),t.data.downcastDispatcher.on("insert:softBreak",Sq(i),{priority:"high"}),t.data.upcastDispatcher.on("element:code",Cq(n,r)),t.data.upcastDispatcher.on("text",Pq()),t.data.upcastDispatcher.on("element:pre",Tq(),{priority:"high"}),this.listenTo(t.editing.view.document,"clipboardInput",(o,l)=>{let a=i.createRange(i.document.selection.anchor);if(l.targetRanges&&(a=t.editing.mapper.toModelRange(l.targetRanges[0])),!a.start.parent.is("element","codeBlock"))return;const c=l.dataTransfer.getData("text/plain"),h=new Cn(t.editing.view.document);l.content=Oq(h,c)}),t.plugins.has("ClipboardPipeline")&&t.plugins.get(on).on("contentInsertion",(o,l)=>{const a=t.model,c=a.document.selection;c.anchor.parent.is("element","codeBlock")&&a.change(h=>{const f=h.createRangeIn(l.content);for(const m of[...f.getItems()])m.is("node")&&!e.checkChild(c.anchor,m)&&h.remove(m)})}),this.listenTo(i,"getSelectedContent",(o,[l])=>{const a=l.anchor;l.isCollapsed||!a.parent.is("element","codeBlock")||!a.hasSameParentAs(l.focus)||i.change(c=>{const h=o.return;if(a.parent.is("element")&&(h.childCount>1||l.containsEntireContent(a.parent))){const m=c.createElement("codeBlock",a.parent.getAttributes());c.append(h,m);const w=c.createDocumentFragment();c.append(m,w),o.return=w;return}const f=h.getChild(0);e.checkAttribute(f,"code")&&c.setAttribute("code",!0,f)})})}afterInit(){const t=this.editor,e=t.commands,i=e.get("indent"),n=e.get("outdent");i&&i.registerChildCommand(e.get("indentCodeBlock"),{priority:"highest"}),n&&n.registerChildCommand(e.get("outdentCodeBlock")),this.listenTo(t.editing.view.document,"enter",(r,o)=>{t.model.document.selection.getLastPosition().parent.is("element","codeBlock")&&(!Iq(t,o.isSoft)&&!Rq(t,o.isSoft)&&Aq(t),o.preventDefault(),r.stop())},{context:"pre"}),this._initAriaAnnouncements()}_initAriaAnnouncements(){const{model:t,ui:e,t:i}=this.editor,n=Ag(this.editor);let r=null;t.document.selection.on("change:range",()=>{const o=t.document.selection.focus.parent;!e||r===o||!o.is("element")||(r&&r.is("element","codeBlock")&&e.ariaLiveAnnouncer.announce(i5(i,n,r,"leave")),o.is("element","codeBlock")&&e.ariaLiveAnnouncer.announce(i5(i,n,o,"enter")),r=o)})}}function Aq(s){const t=s.model,e=t.document,i=e.selection.getLastPosition();let n;const r=u7(i,t);r&&r.is("$text")&&(n=by(r)),s.model.change(o=>{s.execute("shiftEnter"),n&&o.insertText(n,e.selection.anchor)})}function Iq(s,t){const i=s.model.document,n=s.editing.view,r=i.selection.getLastPosition(),o=r.nodeAfter;return t||!i.selection.isCollapsed||!r.isAtStart||!fl(o)?!1:(s.model.change(l=>{s.execute("enter");const a=i.selection.anchor.parent.previousSibling;l.rename(a,h7),l.setSelection(a,"in"),s.model.schema.removeDisallowedAttributes([a],l),l.remove(o)}),n.scrollToTheSelection(),!0)}function Rq(s,t){const e=s.model,i=e.document,n=s.editing.view,r=i.selection.getLastPosition(),o=r.nodeBefore;let l;if(t||!i.selection.isCollapsed||!r.isAtEnd||!o||!o.previousSibling)return!1;if(fl(o)&&fl(o.previousSibling))l=e.createRange(e.createPositionBefore(o.previousSibling),e.createPositionAfter(o));else if(Cx(o)&&fl(o.previousSibling)&&fl(o.previousSibling.previousSibling))l=e.createRange(e.createPositionBefore(o.previousSibling.previousSibling),e.createPositionAfter(o));else if(Cx(o)&&fl(o.previousSibling)&&Cx(o.previousSibling.previousSibling)&&o.previousSibling.previousSibling&&fl(o.previousSibling.previousSibling.previousSibling))l=e.createRange(e.createPositionBefore(o.previousSibling.previousSibling.previousSibling),e.createPositionAfter(o));else return!1;return s.model.change(a=>{a.remove(l),s.execute("enter");const c=i.selection.anchor.parent;a.rename(c,h7),s.model.schema.removeDisallowedAttributes([c],a)}),n.scrollToTheSelection(),!0}function Cx(s){return s&&s.is("$text")&&!s.data.match(/\S/)}function fl(s){return s&&s.is("element","softBreak")}class Vq extends F{static get pluginName(){return"CodeBlockUI"}static get isOfficialPlugin(){return!0}init(){const t=this.editor,e=t.t,i=t.ui.componentFactory,n=Ag(t),r=this._getLanguageListItemDefinitions(n),o=t.commands.get("codeBlock");i.add("codeBlock",l=>{const a=nn(l,Vc),c=a.buttonView,h=e("Insert code block");return c.set({label:h,tooltip:!0,icon:LC,isToggleable:!0}),c.bind("isOn").to(o,"value",f=>!!f),c.on("execute",()=>{t.execute("codeBlock",{usePreviousLanguageChoice:!0}),t.editing.view.focus()}),a.on("execute",f=>{t.execute("codeBlock",{language:f.source._codeBlockLanguage,forceValue:!0}),t.editing.view.focus()}),a.class="ck-code-block-dropdown",a.bind("isEnabled").to(o),Zl(a,r,{role:"menu",ariaLabel:h}),a}),i.add("menuBar:codeBlock",l=>{const a=new cs(l);a.buttonView.set({role:"menuitem",label:e("Code block"),icon:LC}),a.bind("isEnabled").to(o);const c=new Al(l);c.set({ariaLabel:e("Insert code block")});for(const h of r){const f=new Tl(l,a),m=new ti(l);m.bind(...Object.keys(h.model)).to(h.model),m.set({isToggleable:!0,role:"menuitemcheckbox"}),m.delegate("execute").to(a),m.on("execute",()=>{t.execute("codeBlock",{language:h.model._codeBlockLanguage,forceValue:o.value!=h.model._codeBlockLanguage}),t.editing.view.focus()}),f.children.add(m),c.items.add(f)}return a.panelView.children.add(c),a})}_getLanguageListItemDefinitions(t){const i=this.editor.commands.get("codeBlock"),n=new di;for(const r of t){const o={type:"button",model:new El({_codeBlockLanguage:r.language,label:r.label,role:"menuitemradio",withText:!0})};o.model.bind("isOn").to(i,"value",l=>l===o.model._codeBlockLanguage),n.add(o)}return n}}class Mq extends F{static get requires(){return[Eq,Vq]}static get pluginName(){return"CodeBlock"}static get isOfficialPlugin(){return!0}}/**
 * @license Copyright (c) 2003-2025, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options
 */class Lq extends QU{constructor(e,i){super(e);p(this,"view");p(this,"_toolbarConfig");p(this,"_elementReplacer");this.view=i,this._toolbarConfig=TI(e.config.get("toolbar")),this._elementReplacer=new C9,this.listenTo(e.editing.view,"scrollToTheSelection",this._handleScrollToTheSelectionWithStickyPanel.bind(this))}get element(){return this.view.element}init(e){const i=this.editor,n=this.view,r=i.editing.view,o=n.editable,l=r.document.getRoot();o.name=l.rootName,n.render();const a=o.element;this.setEditableElement(o.name,a),n.editable.bind("isFocused").to(this.focusTracker),r.attachDomRoot(a),e&&this._elementReplacer.replace(e,this.element),this._initPlaceholder(),this._initToolbar(),n.menuBarView&&this.initMenuBar(n.menuBarView),this._initDialogPluginIntegration(),this._initContextualBalloonIntegration(),this.fire("ready")}destroy(){super.destroy();const e=this.view,i=this.editor.editing.view;this._elementReplacer.restore(),i.getDomRoot(e.editable.name)&&i.detachDomRoot(e.editable.name),e.destroy()}_initToolbar(){const e=this.view;e.stickyPanel.bind("isActive").to(this.focusTracker,"isFocused"),e.stickyPanel.limiterElement=e.element,e.stickyPanel.bind("viewportTopOffset").to(this,"viewportOffset",({visualTop:i})=>i||0),e.toolbar.fillFromConfig(this._toolbarConfig,this.componentFactory),this.addToolbar(e.toolbar)}_initPlaceholder(){const e=this.editor,i=e.editing.view,n=i.document.getRoot(),r=e.sourceElement;let o;const l=e.config.get("placeholder");l&&(o=typeof l=="string"?l:l[this.view.editable.name]),!o&&r&&r.tagName.toLowerCase()==="textarea"&&(o=r.getAttribute("placeholder")),o&&(n.placeholder=o),FO({view:i,element:n,isDirectHost:!1,keepOnFocus:!0})}_initContextualBalloonIntegration(){if(!this.editor.plugins.has("ContextualBalloon"))return;const{stickyPanel:e}=this.view,i=this.editor.plugins.get("ContextualBalloon");i.on("getPositionOptions",r=>{const o=r.return;if(!o||!e.isSticky||!e.element)return;const l=new Ve(e.element).height,a=typeof o.target=="function"?o.target():o.target,c=typeof o.limiter=="function"?o.limiter():o.limiter;if(a&&c&&new Ve(a).height>=new Ve(c).height-l)return;const h={...o.viewportOffsetConfig},f=(h.top||0)+l;r.return={...o,viewportOffsetConfig:{...h,top:f}}},{priority:"low"});const n=()=>{i.visibleView&&i.updatePosition()};this.listenTo(e,"change:isSticky",n),this.listenTo(this.editor.ui,"change:viewportOffset",n)}_handleScrollToTheSelectionWithStickyPanel(e,i,n){const r=this.view.stickyPanel;if(r.isSticky){const o=new Ve(r.element).height;i.viewportOffset.top+=o}else{const o=()=>{this.editor.editing.view.scrollToTheSelection(n)};this.listenTo(r,"change:isSticky",o),setTimeout(()=>{this.stopListening(r,"change:isSticky",o)},20)}}_initDialogPluginIntegration(){if(!this.editor.plugins.has("Dialog"))return;const e=this.view.stickyPanel,i=this.editor.plugins.get("Dialog");i.on("show",()=>{const n=i.view;n.on("moveTo",(r,o)=>{if(!e.isSticky||n.wasMoved||n.isModal)return;const l=new Ve(e.contentPanelElement);o[1]<l.bottom+Vh.defaultOffset&&(o[1]=l.bottom+Vh.defaultOffset)},{priority:"high"})},{priority:"low"})}}class Bq extends FU{constructor(e,i,n={}){super(e);p(this,"stickyPanel");p(this,"toolbar");p(this,"editable");this.stickyPanel=new HU(e),this.toolbar=new Vo(e,{shouldGroupWhenFull:n.shouldToolbarGroupWhenFull}),n.useMenuBar&&(this.menuBarView=new JU(e)),this.editable=new WU(e,i,void 0,{label:n.label})}render(){super.render(),this.menuBarView?this.stickyPanel.content.addMany([this.menuBarView,this.toolbar]):this.stickyPanel.content.add(this.toolbar),this.top.add(this.stickyPanel),this.main.add(this.editable)}}class $q extends Nb(Fa){constructor(e,i={}){if(!Dm(e)&&i.initialData!==void 0)throw new E("editor-create-initial-data",null);super(i);p(this,"ui");this.config.define("menuBar.isVisible",!1),this.config.get("initialData")===void 0&&this.config.set("initialData",Dq(e)),Dm(e)&&(this.sourceElement=e),this.model.document.createRoot();const n=!this.config.get("toolbar.shouldNotGroupWhenFull"),r=this.config.get("menuBar"),o=new Bq(this.locale,this.editing.view,{shouldToolbarGroupWhenFull:n,useMenuBar:r.isVisible,label:this.config.get("label")});this.ui=new Lq(this,o),QF(this)}static get editorName(){return"ClassicEditor"}destroy(){return this.sourceElement&&this.updateSourceElement(),this.ui.destroy(),super.destroy()}static create(e,i={}){return new Promise(n=>{const r=new this(e,i);n(r.initPlugins().then(()=>r.ui.init(Dm(e)?e:null)).then(()=>r.data.init(r.config.get("initialData"))).then(()=>r.fire("ready")).then(()=>r))})}}function Dq(s){return Dm(s)?R9(s):s}function Dm(s){return Ao(s)}var Qm={exports:{}},Qq=Qm.exports,r5;function Nq(){return r5||(r5=1,function(s){((t,e)=>{s.exports?s.exports=e():t.fuzzysort=e()})(Qq,t=>{var e=(U,$)=>{if(!U||!$)return ie;var ee=O(U);oe($)||($=w($));var pe=ee.bitflags;return(pe&$._bitflags)!==pe?ie:k(ee,$)},i=(U,$,ee)=>{if(!U)return ee!=null&&ee.all?_($,ee):Y;var pe=O(U),we=pe.bitflags,xe=pe.containsSpace,ge=f((ee==null?void 0:ee.threshold)||0),Qe=(ee==null?void 0:ee.limit)||ve,Me=0,qe=0,je=$.length;function ki(Tn){Me<Qe?(ae.add(Tn),++Me):(++qe,Tn._score>ae.peek()._score&&ae.replaceTop(Tn))}if(ee!=null&&ee.key)for(var ri=ee.key,Xe=0;Xe<je;++Xe){var mi=$[Xe],tt=de(mi,ri);if(tt&&(oe(tt)||(tt=w(tt)),(we&tt._bitflags)===we)){var it=k(pe,tt);it!==ie&&(it._score<ge||(it.obj=mi,ki(it)))}}else if(ee!=null&&ee.keys){var Xi=ee.keys,Vi=Xi.length;e:for(var Xe=0;Xe<je;++Xe){var mi=$[Xe];{for(var oi=0,Ge=0;Ge<Vi;++Ge){var ri=Xi[Ge],tt=de(mi,ri);if(!tt){H[Ge]=V;continue}oe(tt)||(tt=w(tt)),H[Ge]=tt,oi|=tt._bitflags}if((we&oi)!==we)continue}if(xe)for(let ut=0;ut<pe.spaceSearches.length;ut++)j[ut]=Z;for(var Ge=0;Ge<Vi;++Ge){if(tt=H[Ge],tt===V){te[Ge]=V;continue}if(te[Ge]=k(pe,tt,!1,xe),te[Ge]===ie){te[Ge]=V;continue}if(xe)for(let ft=0;ft<pe.spaceSearches.length;ft++){if(W[ft]>-1e3&&j[ft]>Z){var ii=(j[ft]+W[ft])/4;ii>j[ft]&&(j[ft]=ii)}W[ft]>j[ft]&&(j[ft]=W[ft])}}if(xe){for(let ut=0;ut<pe.spaceSearches.length;ut++)if(j[ut]===Z)continue e}else{var Ze=!1;for(let ut=0;ut<Vi;ut++)if(te[ut]._score!==Z){Ze=!0;break}if(!Ze)continue}var Si=new a(Vi);for(let ut=0;ut<Vi;ut++)Si[ut]=te[ut];if(xe){var It=0;for(let ut=0;ut<pe.spaceSearches.length;ut++)It+=j[ut]}else{var It=Z;for(let ft=0;ft<Vi;ft++){var it=Si[ft];if(it._score>-1e3&&It>Z){var ii=(It+it._score)/4;ii>It&&(It=ii)}it._score>It&&(It=it._score)}}if(Si.obj=mi,Si._score=It,ee!=null&&ee.scoreFn){if(It=ee.scoreFn(Si),!It)continue;It=f(It),Si._score=It}It<ge||ki(Si)}}else for(var Xe=0;Xe<je;++Xe){var tt=$[Xe];if(tt&&(oe(tt)||(tt=w(tt)),(we&tt._bitflags)===we)){var it=k(pe,tt);it!==ie&&(it._score<ge||ki(it))}}if(Me===0)return Y;for(var vs=new Array(Me),Xe=Me-1;Xe>=0;--Xe)vs[Xe]=ae.poll();return vs.total=Me+qe,vs},n=(U,$="<b>",ee="</b>")=>{for(var pe=typeof $=="function"?$:void 0,we=U.target,xe=we.length,ge=U.indexes,Qe="",Me=0,qe=0,je=!1,ki=[],ri=0;ri<xe;++ri){var Xe=we[ri];if(ge[qe]===ri){if(++qe,je||(je=!0,pe?(ki.push(Qe),Qe=""):Qe+=$),qe===ge.length){pe?(Qe+=Xe,ki.push(pe(Qe,Me++)),Qe="",ki.push(we.substr(ri+1))):Qe+=Xe+ee+we.substr(ri+1);break}}else je&&(je=!1,pe?(ki.push(pe(Qe,Me++)),Qe=""):Qe+=ee);Qe+=Xe}return pe?ki:Qe},r=U=>{typeof U=="number"?U=""+U:typeof U!="string"&&(U="");var $=M(U);return c(U,{_targetLower:$._lower,_targetLowerCodes:$.lowerCodes,_bitflags:$.bitflags})},o=()=>{G.clear(),D.clear()};class l{get indexes(){return this._indexes.slice(0,this._indexes.len).sort(($,ee)=>$-ee)}set indexes($){return this._indexes=$}highlight($,ee){return n(this,$,ee)}get score(){return h(this._score)}set score($){this._score=f($)}}class a extends Array{get score(){return h(this._score)}set score($){this._score=f($)}}var c=(U,$)=>{const ee=new l;return ee.target=U,ee.obj=$.obj??ie,ee._score=$._score??Z,ee._indexes=$._indexes??[],ee._targetLower=$._targetLower??"",ee._targetLowerCodes=$._targetLowerCodes??ie,ee._nextBeginningIndexes=$._nextBeginningIndexes??ie,ee._bitflags=$._bitflags??0,ee},h=U=>U===Z?0:U>1?U:Math.E**(((-U+1)**.04307-1)*-2),f=U=>U===0?Z:U>1?U:1-Math.pow(Math.log(U)/-2+1,1/.04307),m=U=>{typeof U=="number"?U=""+U:typeof U!="string"&&(U=""),U=U.trim();var $=M(U),ee=[];if($.containsSpace){var pe=U.split(/\s+/);pe=[...new Set(pe)];for(var we=0;we<pe.length;we++)if(pe[we]!==""){var xe=M(pe[we]);ee.push({lowerCodes:xe.lowerCodes,_lower:pe[we].toLowerCase(),containsSpace:!1})}}return{lowerCodes:$.lowerCodes,_lower:$._lower,containsSpace:$.containsSpace,bitflags:$.bitflags,spaceSearches:ee}},w=U=>{if(U.length>999)return r(U);var $=G.get(U);return $!==void 0||($=r(U),G.set(U,$)),$},O=U=>{if(U.length>999)return m(U);var $=D.get(U);return $!==void 0||($=m(U),D.set(U,$)),$},_=(U,$)=>{var ee=[];ee.total=U.length;var pe=($==null?void 0:$.limit)||ve;if($!=null&&$.key)for(var we=0;we<U.length;we++){var xe=U[we],ge=de(xe,$.key);if(ge!=ie){oe(ge)||(ge=w(ge));var Qe=c(ge.target,{_score:ge._score,obj:xe});if(ee.push(Qe),ee.length>=pe)return ee}}else if($!=null&&$.keys)for(var we=0;we<U.length;we++){for(var xe=U[we],Me=new a($.keys.length),qe=$.keys.length-1;qe>=0;--qe){var ge=de(xe,$.keys[qe]);if(!ge){Me[qe]=V;continue}oe(ge)||(ge=w(ge)),ge._score=Z,ge._indexes.len=0,Me[qe]=ge}if(Me.obj=xe,Me._score=Z,ee.push(Me),ee.length>=pe)return ee}else for(var we=0;we<U.length;we++){var ge=U[we];if(ge!=ie&&(oe(ge)||(ge=w(ge)),ge._score=Z,ge._indexes.len=0,ee.push(ge),ee.length>=pe))return ee}return ee},k=(U,$,ee=!1,pe=!1)=>{if(ee===!1&&U.containsSpace)return C(U,$,pe);for(var we=U._lower,xe=U.lowerCodes,ge=xe[0],Qe=$._targetLowerCodes,Me=xe.length,qe=Qe.length,Xe=0,je=0,ki=0;;){var ri=ge===Qe[je];if(ri){if(b[ki++]=je,++Xe,Xe===Me)break;ge=xe[Xe]}if(++je,je>=qe)return ie}var Xe=0,mi=!1,tt=0,it=$._nextBeginningIndexes;it===ie&&(it=$._nextBeginningIndexes=N($.target)),je=b[0]===0?0:it[b[0]-1];var Xi=0;if(je!==qe)for(;;)if(je>=qe){if(Xe<=0||(++Xi,Xi>200))break;--Xe;var Vi=I[--tt];je=it[Vi]}else{var ri=xe[Xe]===Qe[je];if(ri){if(I[tt++]=je,++Xe,Xe===Me){mi=!0;break}++je}else je=it[je]}var oi=Me<=1?-1:$._targetLower.indexOf(we,b[0]),Ge=!!~oi,ii=Ge?oi===0||$._nextBeginningIndexes[oi-1]===oi:!1;if(Ge&&!ii){for(var Ze=0;Ze<it.length;Ze=it[Ze])if(!(Ze<=oi)){for(var Si=0;Si<Me&&xe[Si]===$._targetLowerCodes[Ze+Si];Si++);if(Si===Me){oi=Ze,ii=!0;break}}}var It=ut=>{for(var ft=0,Nc=0,_s=1;_s<Me;++_s)ut[_s]-ut[_s-1]!==1&&(ft-=ut[_s],++Nc);var Fc=ut[Me-1]-ut[0]-(Me-1);if(ft-=(12+Fc)*Nc,ut[0]!==0&&(ft-=ut[0]*ut[0]*.2),!mi)ft*=1e3;else{for(var Zo=1,_s=it[0];_s<qe;_s=it[_s])++Zo;Zo>24&&(ft*=(Zo-24)*10)}return ft-=(qe-Me)/2,Ge&&(ft/=1+Me*Me*1),ii&&(ft/=1+Me*Me*1),ft-=(qe-Me)/2,ft};if(mi)if(ii){for(var Ze=0;Ze<Me;++Ze)b[Ze]=oi+Ze;var vs=b,Tn=It(b)}else var vs=I,Tn=It(I);else{if(Ge)for(var Ze=0;Ze<Me;++Ze)b[Ze]=oi+Ze;var vs=b,Tn=It(vs)}$._score=Tn;for(var Ze=0;Ze<Me;++Ze)$._indexes[Ze]=vs[Ze];$._indexes.len=Me;const Fs=new l;return Fs.target=$.target,Fs._score=$._score,Fs._indexes=$._indexes,Fs},C=(U,$,ee)=>{for(var pe=new Set,we=0,xe=ie,ge=0,Qe=U.spaceSearches,Me=Qe.length,qe=0,je=()=>{for(let ii=qe-1;ii>=0;ii--)$._nextBeginningIndexes[B[ii*2+0]]=B[ii*2+1]},ki=!1,Ge=0;Ge<Me;++Ge){W[Ge]=Z;var ri=Qe[Ge];if(xe=k(ri,$),ee){if(xe===ie)continue;ki=!0}else if(xe===ie)return je(),ie;var Xe=Ge===Me-1;if(!Xe){var mi=xe._indexes,tt=!0;for(let Ze=0;Ze<mi.len-1;Ze++)if(mi[Ze+1]-mi[Ze]!==1){tt=!1;break}if(tt){var it=mi[mi.len-1]+1,Xi=$._nextBeginningIndexes[it-1];for(let Ze=it-1;Ze>=0&&Xi===$._nextBeginningIndexes[Ze];Ze--)$._nextBeginningIndexes[Ze]=it,B[qe*2+0]=Ze,B[qe*2+1]=Xi,qe++}}we+=xe._score/Me,W[Ge]=xe._score/Me,xe._indexes[0]<ge&&(we-=(ge-xe._indexes[0])*2),ge=xe._indexes[0];for(var Vi=0;Vi<xe._indexes.len;++Vi)pe.add(xe._indexes[Vi])}if(ee&&!ki)return ie;je();var oi=k(U,$,!0);if(oi!==ie&&oi._score>we){if(ee)for(var Ge=0;Ge<Me;++Ge)W[Ge]=oi._score/Me;return oi}ee&&(xe=$),xe._score=we;var Ge=0;for(let ii of pe)xe._indexes[Ge++]=ii;return xe._indexes.len=Ge,xe},P=U=>U.replace(new RegExp("\\p{Script=Latin}+","gu"),$=>$.normalize("NFD")).replace(/[\u0300-\u036f]/g,""),M=U=>{U=P(U);for(var $=U.length,ee=U.toLowerCase(),pe=[],we=0,xe=!1,ge=0;ge<$;++ge){var Qe=pe[ge]=ee.charCodeAt(ge);if(Qe===32){xe=!0;continue}var Me=Qe>=97&&Qe<=122?Qe-97:Qe>=48&&Qe<=57?26:Qe<=127?30:31;we|=1<<Me}return{lowerCodes:pe,bitflags:we,containsSpace:xe,_lower:ee}},Q=U=>{for(var $=U.length,ee=[],pe=0,we=!1,xe=!1,ge=0;ge<$;++ge){var Qe=U.charCodeAt(ge),Me=Qe>=65&&Qe<=90,qe=Me||Qe>=97&&Qe<=122||Qe>=48&&Qe<=57,je=Me&&!we||!xe||!qe;we=Me,xe=qe,je&&(ee[pe++]=ge)}return ee},N=U=>{U=P(U);for(var $=U.length,ee=Q(U),pe=[],we=ee[0],xe=0,ge=0;ge<$;++ge)we>ge?pe[ge]=we:(we=ee[++xe],pe[ge]=we===void 0?$:we);return pe},G=new Map,D=new Map,b=[],I=[],B=[],j=[],W=[],H=[],te=[],de=(U,$)=>{var ee=U[$];if(ee!==void 0)return ee;if(typeof $=="function")return $(U);var pe=$;Array.isArray($)||(pe=$.split("."));for(var we=pe.length,xe=-1;U&&++xe<we;)U=U[pe[xe]];return U},oe=U=>typeof U=="object"&&typeof U._bitflags=="number",ve=1/0,Z=-ve,Y=[];Y.total=0;var ie=null,V=r(""),J=U=>{var $=[],ee=0,pe={},we=xe=>{for(var ge=0,Qe=$[ge],Me=1;Me<ee;){var qe=Me+1;ge=Me,qe<ee&&$[qe]._score<$[Me]._score&&(ge=qe),$[ge-1>>1]=$[ge],Me=1+(ge<<1)}for(var je=ge-1>>1;ge>0&&Qe._score<$[je]._score;je=(ge=je)-1>>1)$[ge]=$[je];$[ge]=Qe};return pe.add=xe=>{var ge=ee;$[ee++]=xe;for(var Qe=ge-1>>1;ge>0&&xe._score<$[Qe]._score;Qe=(ge=Qe)-1>>1)$[ge]=$[Qe];$[ge]=xe},pe.poll=xe=>{if(ee!==0){var ge=$[0];return $[0]=$[--ee],we(),ge}},pe.peek=xe=>{if(ee!==0)return $[0]},pe.replaceTop=xe=>{$[0]=xe,we()},pe},ae=J();return{single:e,go:i,prepare:r,cleanup:o}})}(Qm)),Qm.exports}var Fq=Nq();const zq=ld(Fq);/**
 * @license Copyright (c) 2003-2025, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options
 *//**
 * @license Copyright (c) 2023, Koala Interactive SAS
 * For licensing, see https://github.com/koala-interactive/is-emoji-supported/blob/master/LICENSE.md
 */function Wq(s){const t=Uq();/* istanbul ignore next -- @preserve */if(!t)return!1;const e=25,i=20,n=Math.floor(e/2);t.font=n+"px Arial, Sans-Serif",t.textBaseline="top",t.canvas.width=i*2,t.canvas.height=e,t.clearRect(0,0,i*2,e),t.fillStyle="#FF0000",t.fillText(s,0,22),t.fillStyle="#0000FF",t.fillText(s,i,22);const r=t.getImageData(0,0,i,e).data,o=r.length;let l=0;for(;l<o&&!r[l+3];l+=4);/* istanbul ignore next -- @preserve */if(l>=o)return!1;const a=i+l/4%i,c=Math.floor(l/4/i),h=t.getImageData(a,c,1,1).data;/* istanbul ignore next -- @preserve */if(r[l]!==h[0]||r[l+2]!==h[2])return!1;/* istanbul ignore next -- @preserve */return!(t.measureText(s).width>=i)}function Uq(){try{return document.createElement("canvas").getContext("2d",{willReadFrequently:!0})}catch{/* istanbul ignore next -- @preserve */return null}}const Zq={0:"default",1:"light",2:"medium-light",3:"medium",4:"medium-dark",5:"dark"},Hq={"🫩":16,"🫨":15.1,"🫠":14,"😶‍🌫️":13.1,"🧑‍💻":12.1,"🥰":11,"🤪":5,"⚕️":4,"🤣":3,"👋🏽":2,"😀":1,"😐":.7,"😂":.6},o5=24,wp=class wp extends F{static get pluginName(){return"EmojiUtils"}static get isOfficialPlugin(){return!0}isEmojiSupported(t,e,i){return t.version<=e?this.hasZwj(t.emoji)?this.isEmojiZwjSupported(t,i):!0:!1}getEmojiSupportedVersionByOs(){for(const[t,e]of Object.entries(Hq))if(wp._isEmojiSupported(t))return e;return 0}hasZwj(t){return t.includes("‍")}isEmojiZwjSupported(t,e){return this.getNodeWidth(e,t.emoji)<o5*1.8}getNodeWidth(t,e){const i=document.createElement("span");i.textContent=e,t.appendChild(i);const n=i.offsetWidth;return t.removeChild(i),n}createEmojiWidthTestingContainer(){const t=document.createElement("div");return t.setAttribute("aria-hidden","true"),t.style.position="absolute",t.style.left="-9999px",t.style.whiteSpace="nowrap",t.style.fontSize=o5+"px",t}normalizeEmojiSkinTone(t){const e={...t,skins:{default:t.emoji}};return t.skins&&t.skins.forEach(i=>{const n=Zq[i.tone];e.skins[n]=i.emoji}),e}isEmojiCategoryAllowed(t){return t.group!==2}};p(wp,"_isEmojiSupported",Wq);let Kb=wp;const qq="https://cdn.ckeditor.com/ckeditor5/data/emoji/{version}/en.json",jq=16,tc=class tc extends F{constructor(e){super(e);p(this,"_items");p(this,"_url");p(this,"_repositoryPromise");e.config.define("emoji",{version:void 0,skinTone:"default",definitionsUrl:void 0,useCustomFont:!1}),this._url=this._getUrl(),this._repositoryPromise=new Promise(i=>{this._repositoryPromiseResolveCallback=i}),this._items=null}static get requires(){return[Kb]}static get pluginName(){return"EmojiRepository"}static get isOfficialPlugin(){return!0}async init(){return this._warnAboutCdnUse(),await this._loadAndCacheEmoji(),this._items=this._getItems(),this._items?this._repositoryPromiseResolveCallback(!0):(Ue("emoji-repository-empty"),this._repositoryPromiseResolveCallback(!1))}getEmojiByQuery(e){return this._items?e.split(/\s/).filter(Boolean).some(r=>r.length>=2)?zq.go(e,this._items,{threshold:.6,keys:["emoticon","annotation",r=>e.split(/\s/).filter(Boolean).flatMap(a=>{var c;return(c=r.tags)==null?void 0:c.filter(h=>h.startsWith(a))}).join()]}).map(r=>r.obj):[]:[]}getEmojiCategories(){const e=this._getItems();if(!e)return[];const{t:i}=this.editor.locale,n=[{title:i("Smileys & Expressions"),icon:"😄",groupId:0},{title:i("Gestures & People"),icon:"👋",groupId:1},{title:i("Animals & Nature"),icon:"🐻",groupId:3},{title:i("Food & Drinks"),icon:"🍎",groupId:4},{title:i("Travel & Places"),icon:"🚘",groupId:5},{title:i("Activities"),icon:"🏀",groupId:6},{title:i("Objects"),icon:"💡",groupId:7},{title:i("Symbols"),icon:"🔵",groupId:8},{title:i("Flags"),icon:"🏁",groupId:9}],r=d$(e,o=>o.group);return n.map(o=>({...o,items:r[o.groupId]}))}getSkinTones(){const{t:e}=this.editor.locale;return[{id:"default",icon:"👋",tooltip:e("Default skin tone")},{id:"light",icon:"👋🏻",tooltip:e("Light skin tone")},{id:"medium-light",icon:"👋🏼",tooltip:e("Medium Light skin tone")},{id:"medium",icon:"👋🏽",tooltip:e("Medium skin tone")},{id:"medium-dark",icon:"👋🏾",tooltip:e("Medium Dark skin tone")},{id:"dark",icon:"👋🏿",tooltip:e("Dark skin tone")}]}isReady(){return this._repositoryPromise}_getUrl(){const{definitionsUrl:e,version:i}=this.editor.config.get("emoji");if(!e||e==="cdn"){const n=i||jq,r=new URL(qq.replace("{version}",n.toString()));return r.searchParams.set("editorVersion",L6),r}return i&&Ue("emoji-repository-redundant-version"),new URL(e)}_warnAboutCdnUse(){const e=this.editor,i=e.config.get("emoji"),n=e.config.get("licenseKey"),r=window[Symbol.for("cke distribution")];n!=="GPL"&&r!=="cloud"&&(i&&i.definitionsUrl||Ue("emoji-repository-cdn-use"))}_getItems(){const e=tc._results[this._url.href];return e&&e.length?e:null}async _loadAndCacheEmoji(){if(tc._results[this._url.href])return;const e=await fetch(this._url,{cache:"force-cache"}).then(i=>i.ok?i.json():[]).catch(()=>[]);tc._results[this._url.href]=this._normalizeEmoji(e)}_normalizeEmoji(e){const i=this.editor,n=i.config.get("emoji.useCustomFont"),r=i.plugins.get("EmojiUtils"),o=e.filter(h=>r.isEmojiCategoryAllowed(h));if(n)return o.map(h=>r.normalizeEmojiSkinTone(h));const l=r.getEmojiSupportedVersionByOs(),a=r.createEmojiWidthTestingContainer();document.body.appendChild(a);const c=o.filter(h=>r.isEmojiSupported(h,l,a)).map(h=>r.normalizeEmojiSkinTone(h));return a.remove(),c}};p(tc,"_results",{});let Rg=tc;const Va=":",Px=":__EMOJI_SHOW_ALL:",Tx=":__EMOJI_HINT:";class Xq extends F{constructor(e){super(e);p(this,"_emojiDropdownLimit");p(this,"_skinTone");this.editor.config.define("emoji",{dropdownLimit:6}),this._emojiDropdownLimit=e.config.get("emoji.dropdownLimit"),this._skinTone=e.config.get("emoji.skinTone"),this._setupMentionConfiguration(e)}static get requires(){return[Rg,hy,"Mention"]}static get pluginName(){return"EmojiMention"}static get isOfficialPlugin(){return!0}_setupMentionConfiguration(e){const i=e.config.get("mergeFields.prefix"),n=e.config.get("mention.feeds"),r=i?i[0]===Va:!1;if(n.filter(c=>!c._isEmojiMarker).some(c=>c.marker===Va)||r){Ue("emoji-config-marker-already-used",{marker:Va});return}if(n.some(c=>c._isEmojiMarker))return;const a={_isEmojiMarker:!0,marker:Va,dropdownLimit:this._emojiDropdownLimit,itemRenderer:this._customItemRendererFactory(this.editor.t),feed:this._queryEmojiCallbackFactory()};this.editor.config.set("mention.feeds",[...n,a])}async init(){const e=this.editor;this.emojiPickerPlugin=e.plugins.has("EmojiPicker")?e.plugins.get("EmojiPicker"):null,this.emojiRepositoryPlugin=e.plugins.get("EmojiRepository"),this._isEmojiRepositoryAvailable=await this.emojiRepositoryPlugin.isReady(),this._isEmojiRepositoryAvailable&&e.once("ready",this._overrideMentionExecuteListener.bind(this))}_customItemRendererFactory(e){return i=>{const n=document.createElement("button");n.classList.add("ck"),n.classList.add("ck-button"),n.classList.add("ck-button_with-text"),n.id=`mention-list-item-id${i.id.slice(0,-1)}`,n.type="button",n.tabIndex=-1;const r=document.createElement("span");return r.classList.add("ck"),r.classList.add("ck-button__label"),n.appendChild(r),i.id===Tx?(n.classList.add("ck-list-item-button"),n.classList.add("ck-disabled"),r.textContent=e("Keep on typing to see the emoji.")):i.id===Px?r.textContent=e("Show all emoji..."):r.textContent=`${i.text} ${i.id}`,n}}_overrideMentionExecuteListener(){const e=this.editor;e.commands.get("mention").on("execute",(i,n)=>{const r=n[0];if(r.marker===Va&&(i.stop(),r.mention.id!==Tx))if(r.mention.id===Px){const o=[...r.range.getItems()].filter(a=>a.is("$textProxy")).map(a=>a.data).reduce((a,c)=>a+c,"");e.model.change(a=>{e.model.deleteContent(a.createSelection(r.range))});const l=this.emojiPickerPlugin;l.showUI(o.slice(1)),setTimeout(()=>{l.emojiPickerView.focus()})}else e.execute("insertText",{text:r.mention.text,range:r.range})},{priority:"high"})}_queryEmojiCallbackFactory(){return e=>{if(e.startsWith(" "))return[];if(e.startsWith(Va))return[];if(!this._isEmojiRepositoryAvailable)return[];const i=this.emojiRepositoryPlugin.getEmojiByQuery(e).map(r=>{let o=r.skins[this._skinTone]||r.skins.default;return this.emojiPickerPlugin&&(o=r.skins[this.emojiPickerPlugin.skinTone]||r.skins.default),{id:`:${r.annotation}:`,text:o}});if(!this.emojiPickerPlugin)return i.slice(0,this._emojiDropdownLimit);const n={id:e.length>1?Px:Tx};return[...i.slice(0,this._emojiDropdownLimit-1),n]}}}class Gq extends Be{refresh(){const e=this.editor.model,i=e.schema,n=e.document.selection;this.isEnabled=i.checkChild(n.getFirstPosition(),"$text")}execute(t=""){this.editor.plugins.get("EmojiPicker").showUI(t)}}class Yq extends ue{constructor(e,{categoryName:i,emojiCategories:n,getEmojiByQuery:r,skinTone:o}){super(e);p(this,"tiles");p(this,"focusTracker");p(this,"keystrokes");p(this,"emojiCategories");p(this,"cachedTiles");p(this,"_getEmojiByQuery");this.set("isEmpty",!0),this.set("categoryName",i),this.set("skinTone",o),this.tiles=this.createCollection(),this.cachedTiles=this.createCollection(),this.focusTracker=new ot,this.keystrokes=new wt,this._getEmojiByQuery=r,this.emojiCategories=n;const l=this.bindTemplate;this.setTemplate({tag:"div",children:[{tag:"div",attributes:{role:"grid",class:["ck","ck-emoji__grid"]},children:this.tiles}],attributes:{role:"tabpanel",class:["ck","ck-emoji__tiles",l.if("isEmpty","ck-hidden",a=>a)]}}),Ep({keystrokeHandler:this.keystrokes,focusTracker:this.focusTracker,gridItems:this.tiles,numberOfColumns:()=>he.window.getComputedStyle(this.element.firstChild).getPropertyValue("grid-template-columns").split(" ").length,uiLanguageDirection:this.locale&&this.locale.uiLanguageDirection})}render(){super.render(),this.keystrokes.listenTo(this.element)}destroy(){super.destroy(),this.keystrokes.destroy(),this.focusTracker.destroy()}focus(){const e=this.tiles.first;e&&e.focus()}filter(e){const{matchingItems:i,allItems:n}=e?this._getItemsByQuery(e.source):this._getItemsByCategory();return this._updateGrid(i),this.set("isEmpty",i.length===0),{resultsCount:i.length,totalItemsCount:n.length}}_getItemsByQuery(e){return{matchingItems:this._getEmojiByQuery(e),allItems:this.emojiCategories.flatMap(i=>i.items)}}_getItemsByCategory(){const e=this.emojiCategories.find(n=>n.title===this.categoryName),{items:i}=e;return{matchingItems:i,allItems:i}}_updateGrid(e){[...this.tiles].forEach(i=>{this.focusTracker.remove(i),this.tiles.remove(i)}),e.map(i=>{const n=i.skins[this.skinTone]||i.skins.default;return this.cachedTiles.get(n)||this._createTile(n,i.annotation)}).forEach(i=>{this.tiles.add(i),this.focusTracker.add(i)})}_createTile(e,i){const n=new ye(this.locale);return n.viewUid=e,n.extendTemplate({attributes:{class:["ck-emoji__tile"]}}),n.set({label:e,tooltip:i,withText:!0,ariaLabel:i,ariaLabelledBy:void 0}),n.on("execute",()=>{this.fire("execute",{name:i,emoji:e})}),this.cachedTiles.add(n),n}}class Kq extends ue{constructor(e,{emojiCategories:i,categoryName:n}){super(e);p(this,"focusTracker");p(this,"keystrokes");p(this,"focusCycler");p(this,"buttonViews");this.buttonViews=this.createCollection(i.map(r=>this._createCategoryButton(r))),this.focusTracker=new ot,this.keystrokes=new wt,this.focusCycler=new Ht({focusables:this.buttonViews,focusTracker:this.focusTracker,keystrokeHandler:this.keystrokes,actions:{focusPrevious:"arrowleft",focusNext:"arrowright"}}),this.setTemplate({tag:"div",attributes:{class:["ck","ck-emoji__categories-list"],role:"tablist"},children:this.buttonViews}),this.on("change:categoryName",(r,o,l,a)=>{const c=this.buttonViews.find(f=>f.tooltip===a);c&&(c.isOn=!1);const h=this.buttonViews.find(f=>f.tooltip===l);h.isOn=!0}),this.set("categoryName",n)}render(){super.render(),this.buttonViews.forEach(e=>{this.focusTracker.add(e)}),this.keystrokes.listenTo(this.element)}destroy(){super.destroy(),this.focusTracker.destroy(),this.keystrokes.destroy(),this.buttonViews.destroy()}focus(){this.buttonViews.first.focus()}enableCategories(){this.buttonViews.forEach(e=>{e.isEnabled=!0})}disableCategories(){this.buttonViews.forEach(e=>{e.set({class:"",isEnabled:!1,isOn:!1})})}_createCategoryButton(e){const i=new ye,n=i.bindTemplate;return i.extendTemplate({attributes:{"aria-selected":n.to("isOn",r=>r.toString()),class:["ck-emoji__category-item"]}}),i.set({ariaLabel:e.title,label:e.icon,role:"tab",tooltip:e.title,withText:!0,ariaLabelledBy:void 0}),i.on("execute",()=>{this.categoryName=e.title}),i.on("change:isEnabled",()=>{i.isEnabled&&i.tooltip===this.categoryName&&(i.isOn=!0)}),i}}class Jq extends ue{constructor(e,{gridView:i,resultsView:n}){super(e);p(this,"inputView");p(this,"gridView");this.gridView=i;const r=e.t;this.inputView=new NI(this.locale,{queryView:{label:r("Find an emoji (min. 2 characters)"),creator:On},filteredView:this.gridView,infoView:{instance:n}}),this.setTemplate({tag:"div",attributes:{class:["ck","ck-search"],tabindex:"-1"},children:[this.inputView.queryView]}),this.inputView.delegate("search").to(this)}destroy(){super.destroy(),this.inputView.destroy()}search(e){const i=e?new RegExp(VO(e),"ig"):null,n=this.gridView.filter(i);this.inputView.fire("search",{query:e,...n})}setInputValue(e){e?this.inputView.queryView.fieldView.value=e:this.inputView.queryView.fieldView.reset()}getInputValue(){return this.inputView.queryView.fieldView.element.value}focus(){this.inputView.focus()}}class ej extends ue{constructor(e,{skinTone:i,skinTones:n}){super(e);p(this,"dropdownView");p(this,"_skinTones");this.set("skinTone",i),this._skinTones=n;const r=e.t,o=r("Select skin tone"),l=nn(e),a=new di;for(const{id:c,icon:h,tooltip:f}of this._skinTones){const m={type:"button",model:new El({value:c,label:h,ariaLabel:f,tooltip:f,tooltipPosition:"e",role:"menuitemradio",withText:!0,ariaLabelledBy:void 0})};m.model.bind("isOn").to(this,"skinTone",w=>w===c),a.add(m)}Zl(l,a,{ariaLabel:o,role:"menu"}),l.buttonView.set({label:this._getSkinTone().icon,ariaLabel:o,ariaLabelledBy:void 0,isOn:!1,withText:!0,tooltip:o}),this.dropdownView=l,this.listenTo(l,"execute",c=>{this.skinTone=c.source.value}),l.buttonView.bind("label").to(this,"skinTone",()=>this._getSkinTone().icon),l.buttonView.bind("ariaLabel").to(this,"skinTone",()=>`${this._getSkinTone().tooltip}, ${o}`),this.setTemplate({tag:"div",attributes:{class:["ck","ck-emoji__skin-tone"]},children:[l]})}focus(){this.dropdownView.buttonView.focus()}_getSkinTone(){return this._skinTones.find(e=>e.id===this.skinTone)}}class tj extends ue{constructor(e,{emojiCategories:i,getEmojiByQuery:n,skinTone:r,skinTones:o}){super(e);p(this,"items");p(this,"focusTracker");p(this,"keystrokes");p(this,"focusCycler");p(this,"searchView");p(this,"toneView");p(this,"categoriesView");p(this,"gridView");p(this,"infoView");const l=i[0].title;this.gridView=new Yq(e,{categoryName:l,emojiCategories:i,getEmojiByQuery:n,skinTone:r}),this.infoView=new QI,this.searchView=new Jq(e,{gridView:this.gridView,resultsView:this.infoView}),this.categoriesView=new Kq(e,{emojiCategories:i,categoryName:l}),this.toneView=new ej(e,{skinTone:r,skinTones:o}),this.items=this.createCollection([this.searchView,this.toneView,this.categoriesView,this.gridView,this.infoView]),this.focusTracker=new ot,this.keystrokes=new wt,this.focusCycler=new Ht({focusables:this.items,focusTracker:this.focusTracker,keystrokeHandler:this.keystrokes,actions:{focusPrevious:"shift + tab",focusNext:"tab"}}),this.setTemplate({tag:"div",children:[{tag:"div",children:[this.searchView,this.toneView],attributes:{class:["ck","ck-emoji__search"]}},this.categoriesView,this.gridView,{tag:"div",children:[this.infoView],attributes:{class:["ck","ck-search__results"]}}],attributes:{tabindex:"-1",class:["ck","ck-emoji","ck-search"]}}),this._setupEventListeners()}render(){super.render(),this.focusTracker.add(this.searchView.element),this.focusTracker.add(this.toneView.element),this.focusTracker.add(this.categoriesView.element),this.focusTracker.add(this.gridView.element),this.focusTracker.add(this.infoView.element),this.keystrokes.listenTo(this.element)}destroy(){super.destroy(),this.focusTracker.destroy(),this.keystrokes.destroy()}focus(){this.searchView.focus()}_setupEventListeners(){const e=this.locale.t;this.searchView.on("search",(i,n)=>{n.query?this.categoriesView.disableCategories():this.categoriesView.enableCategories()}),this.searchView.on("search",(i,n)=>{n.query.length===1?this.infoView.set({primaryText:e("Keep on typing to see the emoji."),secondaryText:e("The query must contain at least two characters."),isVisible:!0}):n.resultsCount?this.infoView.set({isVisible:!1}):this.infoView.set({primaryText:e('No emojis were found matching "%0".',n.query),secondaryText:e("Please try a different phrase or check the spelling."),isVisible:!0})}),this.searchView.on("search",()=>{this.fire("update"),this.gridView.element.scrollTo(0,0)}),this.categoriesView.on("change:categoryName",(i,n,r)=>{this.gridView.categoryName=r,this.searchView.search("")}),this.toneView.on("change:skinTone",(i,n,r)=>{this.gridView.skinTone=r,this.searchView.search(this.searchView.getInputValue())})}}class ij extends ue{constructor(e){super(e);p(this,"backButtonView");p(this,"focusTracker",new ot);p(this,"keystrokes",new wt);p(this,"children");p(this,"_focusables",new fi);p(this,"_focusCycler");this.backButtonView=this._createBackButton(),this.children=this.createCollection([this._createHeaderView()]),this._focusCycler=new Ht({focusables:this._focusables,focusTracker:this.focusTracker,keystrokeHandler:this.keystrokes,actions:{focusPrevious:"shift + tab",focusNext:"tab"}}),this.setTemplate({tag:"div",attributes:{class:["ck","ck-form","ck-emoji-picker-form","ck-responsive-form"],tabindex:"-1"},children:this.children})}render(){super.render(),[...this.children.filter(Rc),this.backButtonView].forEach(i=>{this._focusables.add(i),this.focusTracker.add(i.element),mI(i)&&this._focusCycler.chain(i.focusCycler)}),this.keystrokes.listenTo(this.element)}destroy(){super.destroy(),this.focusTracker.destroy(),this.keystrokes.destroy()}focus(){this._focusCycler.focusFirst()}_createBackButton(){const e=this.locale.t,i=new ye(this.locale);return i.set({class:"ck-button-back",label:e("Back"),icon:zl,tooltip:!0}),i.delegate("execute").to(this,"cancel"),i}_createHeaderView(){const e=this.locale.t,i=new zr(this.locale,{label:e("Emoji picker")});return i.children.add(this.backButtonView,0),i}}const mo="emoji-picker";class nj extends F{static get requires(){return[Rg,gs,Pl,hy]}static get pluginName(){return"EmojiPicker"}static get isOfficialPlugin(){return!0}async init(){const t=this.editor;if(this.balloonPlugin=t.plugins.get("ContextualBalloon"),this.emojiRepositoryPlugin=t.plugins.get("EmojiRepository"),!await this.emojiRepositoryPlugin.isReady())return;const e=new Gq(t);t.commands.add("emoji",e),t.ui.componentFactory.add("emoji",()=>{const i=this._createButton(ye,e);return i.set({tooltip:!0}),i}),t.ui.componentFactory.add("menuBar:emoji",()=>this._createButton(ti,e)),this._setupConversion()}destroy(){super.destroy(),this.emojiPickerView&&this.emojiPickerView.destroy()}get skinTone(){return this.emojiPickerView?this.emojiPickerView.gridView.skinTone:this.editor.config.get("emoji.skinTone")}showUI(t=""){this._showFakeVisualSelection(),this.emojiPickerView||(this.emojiPickerView=this._createEmojiPickerView()),t&&this.emojiPickerView.searchView.setInputValue(t),this.emojiPickerView.searchView.search(t),this.emojiPickerFormView||(this.emojiPickerFormView=this._createEmojiPickerFormView()),this.balloonPlugin.hasView(this.emojiPickerFormView)||(this.emojiPickerFormView.backButtonView.isVisible=!!this.balloonPlugin.visibleView,this.balloonPlugin.add({view:this.emojiPickerFormView,position:this._getBalloonPositionData(),balloonClassName:"ck-emoji-picker-balloon"})),this.emojiPickerView.focus()}_createButton(t,e){const i=new t(this.editor.locale),n=this.editor.locale.t;return i.bind("isEnabled").to(e,"isEnabled"),i.set({label:n("Emoji"),icon:ez,isToggleable:!0}),i.on("execute",()=>{this.editor.editing.view.scrollToTheSelection(),this.showUI()}),i}_createEmojiPickerView(){const t=new tj(this.editor.locale,{emojiCategories:this.emojiRepositoryPlugin.getEmojiCategories(),skinTone:this.editor.config.get("emoji.skinTone"),skinTones:this.emojiRepositoryPlugin.getSkinTones(),getEmojiByQuery:e=>this.emojiRepositoryPlugin.getEmojiByQuery(e)});return this.listenTo(t.gridView,"execute",(e,i)=>{const n=this.editor,r=i.emoji;this._hideUI(),n.execute("insertText",{text:r})}),t}_createEmojiPickerFormView(){const t=new ij(this.editor.locale);return t.children.add(this.emojiPickerView),this.listenTo(this.emojiPickerView,"update",()=>{this.balloonPlugin.visibleView===t&&this.balloonPlugin.updatePosition()}),this.listenTo(t,"cancel",()=>{this._hideUI()}),t.keystrokes.set("Esc",(e,i)=>{this._hideUI(),i()}),Fr({emitter:t,contextElements:[this.balloonPlugin.view.element],callback:()=>{this._hideUI(!1)},activator:()=>this.balloonPlugin.visibleView===t}),t}_hideUI(t=!0){this.balloonPlugin.remove(this.emojiPickerFormView),this.emojiPickerView.searchView.setInputValue(""),t&&this.editor.editing.view.focus(),this._hideFakeVisualSelection()}_setupConversion(){const t=this.editor;t.conversion.for("editingDowncast").markerToHighlight({model:mo,view:{classes:["ck-fake-emoji-selection"]}}),t.conversion.for("editingDowncast").markerToElement({model:mo,view:(e,{writer:i})=>{if(!e.markerRange.isCollapsed)return null;const n=i.createUIElement("span");return i.addClass(["ck-fake-emoji-selection","ck-fake-emoji-selection_collapsed"],n),n}})}_getBalloonPositionData(){const t=this.editor.editing.view,e=t.document;return{target:()=>t.domConverter.viewRangeToDom(e.selection.getFirstRange())}}_showFakeVisualSelection(){const t=this.editor.model;t.change(e=>{const i=t.document.selection.getFirstRange();if(t.markers.has(mo))e.updateMarker(mo,{range:i});else if(i.start.isAtEnd){const n=i.start.getLastMatchingPosition(({item:r})=>!t.schema.isContent(r),{boundaries:i});e.addMarker(mo,{usingOperation:!1,affectsData:!1,range:e.createRange(n,i.end)})}else e.addMarker(mo,{usingOperation:!1,affectsData:!1,range:i})})}_hideFakeVisualSelection(){const t=this.editor.model;t.markers.has(mo)&&t.change(e=>{e.removeMarker(mo)})}}let sj=class extends F{static get requires(){return[Xq,nj]}static get pluginName(){return"Emoji"}static get isOfficialPlugin(){return!0}};/**
 * @license Copyright (c) 2003-2025, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options
 */class rj extends Be{constructor(t){super(t),this.affectsData=!1}execute(){const t=this.editor.model,e=t.document.selection;let i=t.schema.getLimitElement(e);if(e.containsEntireContent(i)||!l5(t.schema,i))do if(i=i.parent,!i)return;while(!l5(t.schema,i));t.change(n=>{n.setSelection(i,"in")})}}function l5(s,t){return s.isLimit(t)&&(s.checkChild(t,"$text")||s.checkChild(t,"paragraph"))}const oj=BO("Ctrl+A");class lj extends F{static get pluginName(){return"SelectAllEditing"}static get isOfficialPlugin(){return!0}init(){const t=this.editor,e=t.t,n=t.editing.view.document;t.commands.add("selectAll",new rj(t)),this.listenTo(n,"keydown",(r,o)=>{dc(o)===oj&&(t.execute("selectAll"),o.preventDefault())}),t.accessibility.addKeystrokeInfos({keystrokes:[{label:e("Select all"),keystroke:"CTRL+A"}]})}}class aj extends F{static get pluginName(){return"SelectAllUI"}static get isOfficialPlugin(){return!0}init(){const t=this.editor;t.ui.componentFactory.add("selectAll",()=>{const e=this._createButton(ye);return e.set({tooltip:!0}),e}),t.ui.componentFactory.add("menuBar:selectAll",()=>this._createButton(ti))}_createButton(t){const e=this.editor,i=e.locale,n=e.commands.get("selectAll"),r=new t(e.locale),o=i.t;return r.set({label:o("Select all"),icon:Iz,keystroke:"Ctrl+A"}),r.bind("isEnabled").to(n,"isEnabled"),this.listenTo(r,"execute",()=>{e.execute("selectAll"),e.editing.view.focus()}),r}}class cj extends F{static get requires(){return[lj,aj]}static get pluginName(){return"SelectAll"}static get isOfficialPlugin(){return!0}}/**
 * @license Copyright (c) 2003-2025, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options
 */class d7 extends Be{constructor(e){super(e);p(this,"_stack",[]);p(this,"_createdBatches",new WeakSet);this.refresh(),this._isEnabledBasedOnSelection=!1,this.listenTo(e.data,"set",(i,n)=>{n[1]={...n[1]};const r=n[1];r.batchType||(r.batchType={isUndoable:!1})},{priority:"high"}),this.listenTo(e.data,"set",(i,n)=>{n[1].batchType.isUndoable||this.clearStack()})}refresh(){this.isEnabled=this._stack.length>0}get createdBatches(){return this._createdBatches}addBatch(e){const i=this.editor.model.document.selection,n={ranges:i.hasOwnRange?Array.from(i.getRanges()):[],isBackward:i.isBackward};this._stack.push({batch:e,selection:n}),this.refresh()}clearStack(){this._stack=[],this.refresh()}_restoreSelection(e,i,n){const r=this.editor.model,o=r.document,l=[],a=e.map(h=>h.getTransformedByOperations(n)),c=a.flat();for(const h of a){const f=h.filter(m=>m.root!=o.graveyard).filter(m=>!hj(m,c));f.length&&(uj(f),l.push(f[0]))}l.length&&r.change(h=>{h.setSelection(l,{backward:i})})}_undo(e,i){const n=this.editor.model,r=n.document;this._createdBatches.add(i);const o=e.operations.slice().filter(l=>l.isDocumentOperation);o.reverse();for(const l of o){const a=l.baseVersion+1,c=Array.from(r.history.getOperations(a)),f=iN([l.getReversed()],c,{useRelations:!0,document:this.editor.model.document,forceWeakRemove:!0}).operationsA;for(let m of f){const w=m.affectedSelectable;w&&!n.canEditAt(w)&&(m=new ui(m.baseVersion)),i.addOperation(m),n.applyOperation(m),r.history.setOperationAsUndone(l,m)}}}}function uj(s){s.sort((t,e)=>t.start.isBefore(e.start)?-1:1);for(let t=1;t<s.length;t++){const i=s[t-1].getJoined(s[t],!0);i&&(t--,s.splice(t,2,i))}}function hj(s,t){return t.some(e=>e!==s&&e.containsRange(s,!0))}class dj extends d7{execute(t=null){const e=t?this._stack.findIndex(r=>r.batch==t):this._stack.length-1,i=this._stack.splice(e,1)[0],n=this.editor.model.createBatch({isUndo:!0});this.editor.model.enqueueChange(n,()=>{this._undo(i.batch,n);const r=this.editor.model.document.history.getOperations(i.batch.baseVersion);this._restoreSelection(i.selection.ranges,i.selection.isBackward,r)}),this.fire("revert",i.batch,n),this.refresh()}}class fj extends d7{execute(){const t=this._stack.pop(),e=this.editor.model.createBatch({isUndo:!0});this.editor.model.enqueueChange(e,()=>{const n=t.batch.operations[t.batch.operations.length-1].baseVersion+1,r=this.editor.model.document.history.getOperations(n);this._restoreSelection(t.selection.ranges,t.selection.isBackward,r),this._undo(t.batch,e)}),this.refresh()}}class mj extends F{constructor(){super(...arguments);p(this,"_undoCommand");p(this,"_redoCommand");p(this,"_batchRegistry",new WeakSet)}static get pluginName(){return"UndoEditing"}static get isOfficialPlugin(){return!0}init(){const e=this.editor,i=e.t;this._undoCommand=new dj(e),this._redoCommand=new fj(e),e.commands.add("undo",this._undoCommand),e.commands.add("redo",this._redoCommand),this.listenTo(e.model,"applyOperation",(n,r)=>{const o=r[0];if(!o.isDocumentOperation)return;const l=o.batch,a=this._redoCommand.createdBatches.has(l),c=this._undoCommand.createdBatches.has(l);this._batchRegistry.has(l)||(this._batchRegistry.add(l),l.isUndoable&&(a?this._undoCommand.addBatch(l):c||(this._undoCommand.addBatch(l),this._redoCommand.clearStack())))},{priority:"highest"}),this.listenTo(this._undoCommand,"revert",(n,r,o)=>{this._redoCommand.addBatch(o)}),e.keystrokes.set("CTRL+Z","undo"),e.keystrokes.set("CTRL+Y","redo"),e.keystrokes.set("CTRL+SHIFT+Z","redo"),e.accessibility.addKeystrokeInfos({keystrokes:[{label:i("Undo"),keystroke:"CTRL+Z"},{label:i("Redo"),keystroke:[["CTRL+Y"],["CTRL+SHIFT+Z"]]}]})}}class gj extends F{static get pluginName(){return"UndoUI"}static get isOfficialPlugin(){return!0}init(){const t=this.editor,e=t.locale,i=t.t,n=e.uiLanguageDirection=="ltr"?zC:DC,r=e.uiLanguageDirection=="ltr"?DC:zC;this._addButtonsToFactory("undo",i("Undo"),"CTRL+Z",n),this._addButtonsToFactory("redo",i("Redo"),"CTRL+Y",r)}_addButtonsToFactory(t,e,i,n){const r=this.editor;r.ui.componentFactory.add(t,()=>{const o=this._createButton(ye,t,e,i,n);return o.set({tooltip:!0}),o}),r.ui.componentFactory.add("menuBar:"+t,()=>this._createButton(ti,t,e,i,n))}_createButton(t,e,i,n,r){const o=this.editor,l=o.locale,a=o.commands.get(e),c=new t(l);return c.set({label:i,icon:r,keystroke:n}),c.bind("isEnabled").to(a,"isEnabled"),this.listenTo(c,"execute",()=>{o.execute(e),o.editing.view.focus()}),c}}class f7 extends F{static get requires(){return[mj,gj]}static get pluginName(){return"Undo"}static get isOfficialPlugin(){return!0}}/**
 * @license Copyright (c) 2003-2025, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options
 */class pj extends F{static get requires(){return[TW,a7,Ip,cj,GI,hy,f7]}static get pluginName(){return"Essentials"}static get isOfficialPlugin(){return!0}}/**
 * @license Copyright (c) 2003-2025, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options
 */class wj extends Be{constructor(t){super(t),this._isEnabledBasedOnSelection=!1}refresh(){const t=this.editor.model,e=t.document,i=$t(e.selection.getSelectedBlocks());this.value=!!i&&i.is("element","paragraph"),this.isEnabled=!!i&&a5(i,t.schema)}execute(t={}){const e=this.editor.model,i=e.document,n=t.selection||i.selection;e.canEditAt(n)&&e.change(r=>{const o=n.getSelectedBlocks();for(const l of o)!l.is("element","paragraph")&&a5(l,e.schema)&&r.rename(l,"paragraph")})}}function a5(s,t){return t.checkChild(s.parent,"paragraph")&&!t.isObject(s)}class xj extends Be{constructor(t){super(t),this._isEnabledBasedOnSelection=!1}execute(t){const e=this.editor.model,i=t.attributes;let n=t.position;return e.canEditAt(n)?e.change(r=>{if(n=this._findPositionToInsertParagraph(n,r),!n)return null;const o=r.createElement("paragraph");return i&&e.schema.setAllowedAttributes(o,i,r),e.insertContent(o,n),r.setSelection(o,"in"),r.createPositionAt(o,0)}):null}_findPositionToInsertParagraph(t,e){const i=this.editor.model;if(i.schema.checkChild(t,"paragraph"))return t;const n=i.schema.findAllowedParent(t,"paragraph");if(!n)return null;const r=t.parent,o=i.schema.checkChild(r,"$text");return r.isEmpty||o&&t.isAtEnd?i.createPositionAfter(r):!r.isEmpty&&o&&t.isAtStart?i.createPositionBefore(r):e.split(t,n).position}}const xp=class xp extends F{static get pluginName(){return"Paragraph"}static get isOfficialPlugin(){return!0}init(){const t=this.editor,e=t.model;t.commands.add("paragraph",new wj(t)),t.commands.add("insertParagraph",new xj(t)),e.schema.register("paragraph",{inheritAllFrom:"$block"}),t.conversion.elementToElement({model:"paragraph",view:"p"}),t.conversion.for("upcast").elementToElement({model:(i,{writer:n})=>!xp.paragraphLikeElements.has(i.name)||i.isEmpty?null:n.createElement("paragraph"),view:/.+/,converterPriority:"low"})}};p(xp,"paragraphLikeElements",new Set(["blockquote","dd","div","dt","h1","h2","h3","h4","h5","h6","li","p","td","th"]));let Vg=xp;/**
 * @license Copyright (c) 2003-2025, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options
 */class bj extends Be{constructor(e,i){super(e);p(this,"modelElements");this.modelElements=i}refresh(){const e=$t(this.editor.model.document.selection.getSelectedBlocks());this.value=!!e&&this.modelElements.includes(e.name)&&e.name,this.isEnabled=!!e&&this.modelElements.some(i=>c5(e,i,this.editor.model.schema))}execute(e){const i=this.editor.model,n=i.document,r=e.value;i.change(o=>{const l=Array.from(n.selection.getSelectedBlocks()).filter(a=>c5(a,r,i.schema));for(const a of l)a.is("element",r)||o.rename(a,r)})}}function c5(s,t,e){return e.checkChild(s.parent,t)&&!e.isObject(s)}const u5="paragraph";class Oj extends F{static get pluginName(){return"HeadingEditing"}static get isOfficialPlugin(){return!0}constructor(t){super(t),t.config.define("heading",{options:[{model:"paragraph",title:"Paragraph",class:"ck-heading_paragraph"},{model:"heading1",view:"h2",title:"Heading 1",class:"ck-heading_heading1"},{model:"heading2",view:"h3",title:"Heading 2",class:"ck-heading_heading2"},{model:"heading3",view:"h4",title:"Heading 3",class:"ck-heading_heading3"}]})}static get requires(){return[Vg]}init(){const t=this.editor,e=t.config.get("heading.options"),i=[];for(const n of e)n.model!=="paragraph"&&(t.model.schema.register(n.model,{inheritAllFrom:"$block"}),t.conversion.elementToElement(n),i.push(n.model));this._addDefaultH1Conversion(t),t.commands.add("heading",new bj(t,i))}afterInit(){const t=this.editor,e=t.commands.get("enter"),i=t.config.get("heading.options");e&&this.listenTo(e,"afterExecute",(n,r)=>{const o=t.model.document.selection.getFirstPosition().parent;i.some(a=>o.is("element",a.model))&&!o.is("element",u5)&&o.childCount===0&&r.writer.rename(o,u5)})}_addDefaultH1Conversion(t){t.conversion.for("upcast").elementToElement({model:"heading1",view:"h1",converterPriority:Ji.low+1})}}/**
 * @license Copyright (c) 2003-2025, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options
 */function yj(s){const t=s.t,e={Paragraph:t("Paragraph"),"Heading 1":t("Heading 1"),"Heading 2":t("Heading 2"),"Heading 3":t("Heading 3"),"Heading 4":t("Heading 4"),"Heading 5":t("Heading 5"),"Heading 6":t("Heading 6")};return s.config.get("heading.options").map(i=>{const n=e[i.title];return n&&n!=i.title&&(i.title=n),i})}class vj extends F{static get pluginName(){return"HeadingUI"}static get isOfficialPlugin(){return!0}init(){const t=this.editor,e=t.t,i=yj(t),n=e("Choose heading"),r=e("Heading");t.ui.componentFactory.add("heading",o=>{const l={},a=new di,c=t.commands.get("heading"),h=t.commands.get("paragraph"),f=[c];for(const w of i){const O={type:"button",model:new El({label:w.title,class:w.class,role:"menuitemradio",withText:!0})};w.model==="paragraph"?(O.model.bind("isOn").to(h,"value"),O.model.set("commandName","paragraph"),f.push(h)):(O.model.bind("isOn").to(c,"value",_=>_===w.model),O.model.set({commandName:"heading",commandValue:w.model})),a.add(O),l[w.model]=w.title}const m=nn(o);return Zl(m,a,{ariaLabel:r,role:"menu"}),m.buttonView.set({ariaLabel:r,ariaLabelledBy:void 0,isOn:!1,withText:!0,tooltip:r}),m.extendTemplate({attributes:{class:["ck-heading-dropdown"]}}),m.bind("isEnabled").toMany(f,"isEnabled",(...w)=>w.some(O=>O)),m.buttonView.bind("label").to(c,"value",h,"value",(w,O)=>{const _=O?"paragraph":w;return typeof _=="boolean"||!l[_]?n:l[_]}),m.buttonView.bind("ariaLabel").to(c,"value",h,"value",(w,O)=>{const _=O?"paragraph":w;return typeof _=="boolean"||!l[_]?r:`${l[_]}, ${r}`}),this.listenTo(m,"execute",w=>{const{commandName:O,commandValue:_}=w.source;t.execute(O,_?{value:_}:void 0),t.editing.view.focus()}),m}),t.ui.componentFactory.add("menuBar:heading",o=>{const l=new cs(o),a=t.commands.get("heading"),c=t.commands.get("paragraph"),h=[a],f=new Al(o);l.set({class:"ck-heading-dropdown"}),f.set({ariaLabel:e("Heading"),role:"menu"}),l.buttonView.set({label:e("Heading")}),l.panelView.children.add(f);for(const m of i){const w=new Tl(o,l),O=new ti(o);w.children.add(O),f.items.add(w),O.set({isToggleable:!0,label:m.title,role:"menuitemradio",class:m.class}),O.delegate("execute").to(l),O.on("execute",()=>{const _=m.model==="paragraph"?"paragraph":"heading";t.execute(_,{value:m.model}),t.editing.view.focus()}),m.model==="paragraph"?(O.bind("isOn").to(c,"value"),h.push(c)):O.bind("isOn").to(a,"value",_=>_===m.model)}return l.bind("isEnabled").toMany(h,"isEnabled",(...m)=>m.some(w=>w)),l})}}class _j extends F{static get requires(){return[Oj,vj]}static get pluginName(){return"Heading"}static get isOfficialPlugin(){return!0}}/**
 * @license Copyright (c) 2003-2025, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options
 */class kj extends Be{refresh(){const t=this.editor.model,e=t.schema,i=t.document.selection,n=h5(i);this.isEnabled=Sj(i,e,t),this.value=n?n.getAttribute("value")||"":null}execute(t){const e=this.editor.model,i=e.document.selection;e.change(n=>{let r;this.value!==null?r=h5(i):(r=n.createElement("rawHtml"),e.insertObject(r,null,null,{setSelection:"on"})),n.setAttribute("value",t,r)})}}function Sj(s,t,e){const i=Cj(s,e);return t.checkChild(i,"rawHtml")}function Cj(s,t){const i=KI(s,t).start.parent;return i.isEmpty&&!i.is("rootElement")?i.parent:i}function h5(s){const t=s.getSelectedElement();return t&&t.is("element","rawHtml")?t:null}class Pj extends F{constructor(e){super(e);p(this,"_widgetButtonViewReferences",new Set);e.config.define("htmlEmbed",{showPreviews:!1,sanitizeHtml:i=>(Ue("html-embed-provide-sanitize-function"),{html:i,hasChanged:!1})})}static get pluginName(){return"HtmlEmbedEditing"}static get isOfficialPlugin(){return!0}init(){const e=this.editor;e.model.schema.register("rawHtml",{inheritAllFrom:"$blockObject",allowAttributes:["value"]}),e.commands.add("htmlEmbed",new kj(e)),this._setupConversion()}_setupConversion(){const e=this.editor,i=e.t,n=e.editing.view,r=this._widgetButtonViewReferences,o=e.config.get("htmlEmbed");this.editor.editing.view.on("render",()=>{for(const f of r){if(f.element&&f.element.isConnected)return;f.destroy(),r.delete(f)}},{priority:"lowest"}),e.data.registerRawContentMatcher({name:"div",classes:"raw-html-embed"}),e.conversion.for("upcast").elementToElement({view:{name:"div",classes:"raw-html-embed"},model:(f,{writer:m})=>m.createElement("rawHtml",{value:f.getCustomProperty("$rawContent")})}),e.conversion.for("dataDowncast").elementToElement({model:"rawHtml",view:(f,{writer:m})=>m.createRawElement("div",{class:"raw-html-embed"},function(w){w.innerHTML=f.getAttribute("value")||""})}),e.conversion.for("editingDowncast").elementToStructure({model:{name:"rawHtml",attributes:["value"]},view:(f,{writer:m})=>{let w,O,_;const k=m.createRawElement("div",{class:"raw-html-embed__content-wrapper"},function(M){w=M,l({editor:e,domElement:M,state:O,props:_}),w.addEventListener("mousedown",()=>{if(O.isEditable){const Q=e.model;Q.document.selection.getSelectedElement()!==f&&Q.change(G=>G.setSelection(f,"on"))}},!0)}),C={makeEditable(){O=Object.assign({},O,{isEditable:!0}),l({domElement:w,editor:e,state:O,props:_}),n.change(M=>{M.setAttribute("data-cke-ignore-events","true",k)}),w.querySelector("textarea").focus()},save(M){M!==O.getRawHtmlValue()?(e.execute("htmlEmbed",M),e.editing.view.focus()):this.cancel()},cancel(){O=Object.assign({},O,{isEditable:!1}),l({domElement:w,editor:e,state:O,props:_}),e.editing.view.focus(),n.change(M=>{M.removeAttribute("data-cke-ignore-events",k)})}};O={showPreviews:o.showPreviews,isEditable:!1,getRawHtmlValue:()=>f.getAttribute("value")||""},_={sanitizeHtml:o.sanitizeHtml,textareaPlaceholder:i("Paste raw HTML here..."),onEditClick(){C.makeEditable()},onSaveClick(M){C.save(M)},onCancelClick(){C.cancel()}};const P=m.createContainerElement("div",{class:"raw-html-embed","data-html-embed-label":i("HTML snippet"),dir:e.locale.uiLanguageDirection},k);return m.setCustomProperty("rawHtmlApi",C,P),m.setCustomProperty("rawHtml",!0,P),fd(P,m,{label:i("HTML snippet"),hasSelectionHandle:!0})}});function l({editor:f,domElement:m,state:w,props:O}){m.textContent="";const _=m.ownerDocument;let k;if(w.isEditable){const P={isDisabled:!1,placeholder:O.textareaPlaceholder};k=c({domDocument:_,state:w,props:P}),m.append(k)}else if(w.showPreviews){const P={sanitizeHtml:O.sanitizeHtml};m.append(h({domDocument:_,state:w,props:P,editor:f}))}else{const P={isDisabled:!0,placeholder:O.textareaPlaceholder};m.append(c({domDocument:_,state:w,props:P}))}const C={onEditClick:O.onEditClick,onSaveClick:()=>{O.onSaveClick(k.value)},onCancelClick:O.onCancelClick};m.prepend(a({editor:f,domDocument:_,state:w,props:C}))}function a({editor:f,domDocument:m,state:w,props:O}){const _=bi(m,"div",{class:"raw-html-embed__buttons-wrapper"});if(w.isEditable){const k=Ex(f,"save",O.onSaveClick),C=Ex(f,"cancel",O.onCancelClick);_.append(k.element,C.element),r.add(k).add(C)}else{const k=Ex(f,"edit",O.onEditClick);_.append(k.element),r.add(k)}return _}function c({domDocument:f,state:m,props:w}){const O=bi(f,"textarea",{placeholder:w.placeholder,class:"ck ck-reset ck-input ck-input-text raw-html-embed__source"});return O.disabled=w.isDisabled,O.value=m.getRawHtmlValue(),O}function h({editor:f,domDocument:m,state:w,props:O}){const _=O.sanitizeHtml(w.getRawHtmlValue()),k=w.getRawHtmlValue().length>0?i("No preview available"):i("Empty snippet content"),C=bi(m,"div",{class:"ck ck-reset_all raw-html-embed__preview-placeholder"},k),P=bi(m,"div",{class:"raw-html-embed__preview-content",dir:f.locale.contentLanguageDirection}),Q=m.createRange().createContextualFragment(_.html);return P.appendChild(Q),bi(m,"div",{class:"raw-html-embed__preview"},[C,P])}}}function Ex(s,t,e){const{t:i}=s.locale,n=new ye(s.locale),r=s.commands.get("htmlEmbed");return n.set({class:`raw-html-embed__${t}-button`,icon:Fb,tooltip:!0,tooltipPosition:s.locale.uiLanguageDirection==="rtl"?"e":"w"}),n.render(),t==="edit"?(n.set({icon:Fb,label:i("Edit source")}),n.bind("isEnabled").to(r)):t==="save"?(n.set({icon:Ic,label:i("Save changes")}),n.bind("isEnabled").to(r)):n.set({icon:Ac,label:i("Cancel")}),n.on("execute",e),n}class Tj extends F{static get pluginName(){return"HtmlEmbedUI"}static get isOfficialPlugin(){return!0}init(){const t=this.editor,i=t.locale.t;t.ui.componentFactory.add("htmlEmbed",()=>{const n=this._createButton(ye);return n.set({tooltip:!0,label:i("Insert HTML")}),n}),t.ui.componentFactory.add("menuBar:htmlEmbed",()=>{const n=this._createButton(ti);return n.set({label:i("HTML snippet")}),n})}_createButton(t){const e=this.editor,i=e.commands.get("htmlEmbed"),n=new t(e.locale);return n.set({icon:sz}),n.bind("isEnabled").to(i,"isEnabled"),this.listenTo(n,"execute",()=>{e.execute("htmlEmbed"),e.editing.view.focus(),e.editing.view.document.selection.getSelectedElement().getCustomProperty("rawHtmlApi").makeEditable()}),n}}class Ej extends F{static get requires(){return[Pj,Tj,Lc]}static get pluginName(){return"HtmlEmbed"}static get isOfficialPlugin(){return!0}}/**
 * @license Copyright (c) 2003-2025, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options
 */function or(s,t,e,i){t&&Aj(s,t,i),e&&lr(s,e,i)}function lr(s,t,e){if(t.attributes)for(const[i,n]of Object.entries(t.attributes))s.setAttribute(i,n,e);t.styles&&s.setStyle(t.styles,e),t.classes&&s.addClass(t.classes,e)}function Aj(s,t,e){if(t.attributes)for(const[i]of Object.entries(t.attributes))s.removeAttribute(i,e);if(t.styles)for(const i of Object.keys(t.styles))s.removeStyle(i,e);t.classes&&s.removeClass(t.classes,e)}function Ij(s,t){const e=_n(s);let i="attributes";for(i in t)i=="classes"?e[i]=Array.from(new Set([...s[i]||[],...t[i]])):e[i]={...s[i],...t[i]};return e}function Ma(s,t,e,i,n){const r=t.getAttribute(e),o={};for(const l of["attributes","styles","classes"]){if(l!=i){r&&r[l]&&(o[l]=r[l]);continue}if(i=="classes"){const c=new Set(r&&r.classes||[]);n(c),c.size&&(o[l]=Array.from(c));continue}const a=new Map(Object.entries(r&&r[l]||{}));n(a),a.size&&(o[l]=Object.fromEntries(a))}Object.keys(o).length?t.is("documentSelection")?s.setSelectionAttribute(e,o):s.setAttribute(e,o,t):r&&(t.is("documentSelection")?s.removeSelectionAttribute(e):s.removeAttribute(e,t))}function Rj(s){return H$(s).replace(/ /g,"")}function us(s){return`html${Rj(s)}Attributes`}function Oy({model:s}){return(t,e)=>e.writer.createElement(s,{htmlContent:t.getCustomProperty("$rawContent")})}function Vj(s,{view:t,isInline:e}){const i=s.t;return(n,{writer:r})=>{const o=i("HTML object"),l=Vp(t,n,r),a=n.getAttribute(us(t));r.addClass("html-object-embed__content",l),a&&lr(r,a,l);const c=r.createContainerElement(e?"span":"div",{class:"html-object-embed","data-html-object-embed-label":o},l);return fd(c,r,{label:o})}}function Vp(s,t,e){return e.createRawElement(s,null,(i,n)=>{n.setContentOf(i,t.getAttribute("htmlContent"))})}function Mj({view:s,model:t,allowEmpty:e},i){return r=>{r.on(`element:${s}`,(o,l,a)=>{let c=i.processViewAttributes(l.viewItem,a);if(!(!c&&!a.consumable.test(l.viewItem,{name:!0}))){if(c=c||{},a.consumable.consume(l.viewItem,{name:!0}),l.modelRange||(l=Object.assign(l,a.convertChildren(l.viewItem,l.modelCursor))),e&&l.modelRange.isCollapsed&&Object.keys(c).length){const h=a.writer.createElement("htmlEmptyElement");if(!a.safeInsert(h,l.modelCursor))return;const f=a.getSplitParts(h);l.modelRange=a.writer.createRange(l.modelRange.start,a.writer.createPositionAfter(f[f.length-1])),a.updateConversionResult(h,l),n(h,c,a);return}for(const h of l.modelRange.getItems())n(h,c,a)}},{priority:"low"})};function n(r,o,l){if(l.schema.checkAttribute(r,t)){const a=r.getAttribute(t),c=Ij(o,a||{});l.writer.setAttribute(t,c,r)}}}function d5({model:s,view:t},e){return(i,{writer:n,consumable:r})=>{if(!i.hasAttribute(s))return null;const o=n.createContainerElement(t),l=i.getAttribute(s);return r.consume(i,`attribute:${s}`),lr(n,l,o),o.getFillerOffset=()=>null,e?fd(o,n):o}}function Lj({priority:s,view:t}){return(e,i)=>{if(!e)return;const{writer:n}=i,r=n.createAttributeElement(t,null,{priority:s});return lr(n,e,r),r}}function gc({view:s},t){return e=>{e.on(`element:${s}`,(i,n,r)=>{if(!n.modelRange||n.modelRange.isCollapsed)return;const o=t.processViewAttributes(n.viewItem,r);o&&r.writer.setAttribute(us(n.viewItem.name),o,n.modelRange)},{priority:"low"})}}function Bh({view:s,model:t}){return e=>{e.on(`attribute:${us(s)}:${t}`,(i,n,r)=>{if(!r.consumable.consume(n.item,i.name))return;const{attributeOldValue:o,attributeNewValue:l}=n,a=r.writer,c=r.mapper.toViewElement(n.item);or(a,o,l,c)})}}/**
 * @license Copyright (c) 2003-2025, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options
 */var f5={block:[{model:"codeBlock",view:"pre"},{model:"paragraph",view:"p"},{model:"blockQuote",view:"blockquote"},{model:"listItem",view:"li"},{model:"pageBreak",view:"div"},{model:"rawHtml",view:"div"},{model:"table",view:"table"},{model:"tableRow",view:"tr"},{model:"tableCell",view:"td"},{model:"tableCell",view:"th"},{model:"tableColumnGroup",view:"colgroup"},{model:"tableColumn",view:"col"},{model:"caption",view:"caption"},{model:"caption",view:"figcaption"},{model:"imageBlock",view:"img"},{model:"imageInline",view:"img"},{model:"horizontalLine",view:"hr"},{model:"htmlP",view:"p",modelSchema:{inheritAllFrom:"$block"}},{model:"htmlBlockquote",view:"blockquote",modelSchema:{inheritAllFrom:"$container"}},{model:"htmlTable",view:"table",modelSchema:{allowWhere:"$block",isBlock:!0}},{model:"htmlTbody",view:"tbody",modelSchema:{allowIn:"htmlTable",isBlock:!1}},{model:"htmlThead",view:"thead",modelSchema:{allowIn:"htmlTable",isBlock:!1}},{model:"htmlTfoot",view:"tfoot",modelSchema:{allowIn:"htmlTable",isBlock:!1}},{model:"htmlCaption",view:"caption",modelSchema:{allowIn:"htmlTable",allowChildren:"$text",isBlock:!1}},{model:"htmlColgroup",view:"colgroup",modelSchema:{allowIn:"htmlTable",allowChildren:"col",isBlock:!1}},{model:"htmlCol",view:"col",modelSchema:{allowIn:"htmlColgroup",isBlock:!1}},{model:"htmlTr",view:"tr",modelSchema:{allowIn:["htmlTable","htmlThead","htmlTbody"],isLimit:!0}},{model:"htmlTd",view:"td",modelSchema:{allowIn:"htmlTr",allowContentOf:"$container",isLimit:!0,isBlock:!1}},{model:"htmlTh",view:"th",modelSchema:{allowIn:"htmlTr",allowContentOf:"$container",isLimit:!0,isBlock:!1}},{model:"htmlFigure",view:"figure",modelSchema:{inheritAllFrom:"$container",isBlock:!1}},{model:"htmlFigcaption",view:"figcaption",modelSchema:{allowIn:"htmlFigure",allowChildren:"$text",isBlock:!1}},{model:"htmlAddress",view:"address",modelSchema:{inheritAllFrom:"$container",isBlock:!1}},{model:"htmlAside",view:"aside",modelSchema:{inheritAllFrom:"$container",isBlock:!1}},{model:"htmlMain",view:"main",modelSchema:{inheritAllFrom:"$container",isBlock:!1}},{model:"htmlDetails",view:"details",modelSchema:{inheritAllFrom:"$container",isBlock:!1}},{model:"htmlSummary",view:"summary",modelSchema:{allowChildren:["htmlH1","htmlH2","htmlH3","htmlH4","htmlH5","htmlH6","$text"],allowIn:"htmlDetails",isBlock:!1}},{model:"htmlDiv",view:"div",paragraphLikeModel:"htmlDivParagraph",modelSchema:{inheritAllFrom:"$container"}},{model:"htmlFieldset",view:"fieldset",modelSchema:{inheritAllFrom:"$container",isBlock:!1}},{model:"htmlLegend",view:"legend",modelSchema:{allowIn:"htmlFieldset",allowChildren:"$text"}},{model:"htmlHeader",view:"header",modelSchema:{inheritAllFrom:"$container",isBlock:!1}},{model:"htmlFooter",view:"footer",modelSchema:{inheritAllFrom:"$container",isBlock:!1}},{model:"htmlForm",view:"form",modelSchema:{inheritAllFrom:"$container",isBlock:!0}},{model:"htmlHgroup",view:"hgroup",modelSchema:{allowIn:["$root","$container"],allowChildren:["paragraph","htmlP","htmlH1","htmlH2","htmlH3","htmlH4","htmlH5","htmlH6"],isBlock:!1}},{model:"htmlH1",view:"h1",modelSchema:{inheritAllFrom:"$block"}},{model:"htmlH2",view:"h2",modelSchema:{inheritAllFrom:"$block"}},{model:"htmlH3",view:"h3",modelSchema:{inheritAllFrom:"$block"}},{model:"htmlH4",view:"h4",modelSchema:{inheritAllFrom:"$block"}},{model:"htmlH5",view:"h5",modelSchema:{inheritAllFrom:"$block"}},{model:"htmlH6",view:"h6",modelSchema:{inheritAllFrom:"$block"}},{model:"$htmlList",modelSchema:{allowWhere:"$container",allowChildren:["$htmlList","htmlLi"],isBlock:!1}},{model:"htmlDir",view:"dir",modelSchema:{inheritAllFrom:"$htmlList"}},{model:"htmlMenu",view:"menu",modelSchema:{inheritAllFrom:"$htmlList"}},{model:"htmlUl",view:"ul",modelSchema:{inheritAllFrom:"$htmlList"}},{model:"htmlOl",view:"ol",modelSchema:{inheritAllFrom:"$htmlList"}},{model:"htmlLi",view:"li",modelSchema:{allowIn:"$htmlList",allowChildren:"$text",isBlock:!1}},{model:"htmlPre",view:"pre",modelSchema:{inheritAllFrom:"$block"}},{model:"htmlArticle",view:"article",modelSchema:{inheritAllFrom:"$container",isBlock:!1}},{model:"htmlSection",view:"section",modelSchema:{inheritAllFrom:"$container",isBlock:!1}},{model:"htmlNav",view:"nav",modelSchema:{inheritAllFrom:"$container",isBlock:!1}},{model:"htmlDivDl",view:"div",modelSchema:{allowChildren:["htmlDt","htmlDd"],allowIn:"htmlDl"}},{model:"htmlDl",view:"dl",modelSchema:{allowWhere:"$container",allowChildren:["htmlDt","htmlDd","htmlDivDl"],isBlock:!1}},{model:"htmlDt",view:"dt",modelSchema:{allowChildren:"$block",isBlock:!1}},{model:"htmlDd",view:"dd",modelSchema:{allowChildren:"$block",isBlock:!1}},{model:"htmlCenter",view:"center",modelSchema:{inheritAllFrom:"$container",isBlock:!1}},{model:"htmlHr",view:"hr",isEmpty:!0,modelSchema:{inheritAllFrom:"$blockObject"}}],inline:[{model:"htmlLiAttributes",view:"li",appliesToBlock:!0,coupledAttribute:"listItemId"},{model:"htmlOlAttributes",view:"ol",appliesToBlock:!0,coupledAttribute:"listItemId"},{model:"htmlUlAttributes",view:"ul",appliesToBlock:!0,coupledAttribute:"listItemId"},{model:"htmlFigureAttributes",view:"figure",appliesToBlock:"table"},{model:"htmlTheadAttributes",view:"thead",appliesToBlock:"table"},{model:"htmlTbodyAttributes",view:"tbody",appliesToBlock:"table"},{model:"htmlFigureAttributes",view:"figure",appliesToBlock:"imageBlock"},{model:"htmlAcronym",view:"acronym",attributeProperties:{copyOnEnter:!0,isFormatting:!0}},{model:"htmlTt",view:"tt",attributeProperties:{copyOnEnter:!0,isFormatting:!0}},{model:"htmlFont",view:"font",attributeProperties:{copyOnEnter:!0,isFormatting:!0}},{model:"htmlTime",view:"time",attributeProperties:{copyOnEnter:!0,isFormatting:!0}},{model:"htmlVar",view:"var",attributeProperties:{copyOnEnter:!0,isFormatting:!0}},{model:"htmlBig",view:"big",attributeProperties:{copyOnEnter:!0,isFormatting:!0}},{model:"htmlSmall",view:"small",attributeProperties:{copyOnEnter:!0,isFormatting:!0}},{model:"htmlSamp",view:"samp",attributeProperties:{copyOnEnter:!0,isFormatting:!0}},{model:"htmlQ",view:"q",attributeProperties:{copyOnEnter:!0,isFormatting:!0}},{model:"htmlOutput",view:"output",attributeProperties:{copyOnEnter:!0,isFormatting:!0}},{model:"htmlKbd",view:"kbd",attributeProperties:{copyOnEnter:!0,isFormatting:!0}},{model:"htmlBdi",view:"bdi",attributeProperties:{copyOnEnter:!0,isFormatting:!0}},{model:"htmlBdo",view:"bdo",attributeProperties:{copyOnEnter:!0,isFormatting:!0}},{model:"htmlAbbr",view:"abbr",attributeProperties:{copyOnEnter:!0,isFormatting:!0}},{model:"htmlA",view:"a",priority:5,coupledAttribute:"linkHref"},{model:"htmlStrong",view:"strong",coupledAttribute:"bold",attributeProperties:{copyOnEnter:!0,isFormatting:!0}},{model:"htmlB",view:"b",coupledAttribute:"bold",attributeProperties:{copyOnEnter:!0,isFormatting:!0}},{model:"htmlI",view:"i",coupledAttribute:"italic",attributeProperties:{copyOnEnter:!0,isFormatting:!0}},{model:"htmlEm",view:"em",coupledAttribute:"italic",attributeProperties:{copyOnEnter:!0,isFormatting:!0}},{model:"htmlS",view:"s",coupledAttribute:"strikethrough",attributeProperties:{copyOnEnter:!0,isFormatting:!0}},{model:"htmlDel",view:"del",coupledAttribute:"strikethrough",attributeProperties:{copyOnEnter:!0,isFormatting:!0}},{model:"htmlIns",view:"ins",attributeProperties:{copyOnEnter:!0,isFormatting:!0}},{model:"htmlU",view:"u",coupledAttribute:"underline",attributeProperties:{copyOnEnter:!0,isFormatting:!0}},{model:"htmlSub",view:"sub",coupledAttribute:"subscript",attributeProperties:{copyOnEnter:!0,isFormatting:!0}},{model:"htmlSup",view:"sup",coupledAttribute:"superscript",attributeProperties:{copyOnEnter:!0,isFormatting:!0}},{model:"htmlCode",view:"code",coupledAttribute:"code",attributeProperties:{copyOnEnter:!0,isFormatting:!0}},{model:"htmlMark",view:"mark",attributeProperties:{copyOnEnter:!0,isFormatting:!0}},{model:"htmlSpan",view:"span",attributeProperties:{copyOnEnter:!0,isFormatting:!0}},{model:"htmlCite",view:"cite",attributeProperties:{copyOnEnter:!0,isFormatting:!0}},{model:"htmlLabel",view:"label",attributeProperties:{copyOnEnter:!0,isFormatting:!0}},{model:"htmlDfn",view:"dfn",attributeProperties:{copyOnEnter:!0,isFormatting:!0}},{model:"htmlObject",view:"object",isObject:!0,modelSchema:{inheritAllFrom:"$inlineObject"}},{model:"htmlIframe",view:"iframe",isObject:!0,modelSchema:{inheritAllFrom:"$inlineObject"}},{model:"htmlInput",view:"input",isObject:!0,modelSchema:{inheritAllFrom:"$inlineObject"}},{model:"htmlButton",view:"button",isObject:!0,modelSchema:{inheritAllFrom:"$inlineObject"}},{model:"htmlTextarea",view:"textarea",isObject:!0,modelSchema:{inheritAllFrom:"$inlineObject"}},{model:"htmlSelect",view:"select",isObject:!0,modelSchema:{inheritAllFrom:"$inlineObject"}},{model:"htmlVideo",view:"video",isObject:!0,modelSchema:{inheritAllFrom:"$inlineObject"}},{model:"htmlEmbed",view:"embed",isObject:!0,modelSchema:{inheritAllFrom:"$inlineObject"}},{model:"htmlOembed",view:"oembed",isObject:!0,modelSchema:{inheritAllFrom:"$inlineObject"}},{model:"htmlAudio",view:"audio",isObject:!0,modelSchema:{inheritAllFrom:"$inlineObject"}},{model:"htmlImg",view:"img",isObject:!0,modelSchema:{inheritAllFrom:"$inlineObject"}},{model:"htmlCanvas",view:"canvas",isObject:!0,modelSchema:{inheritAllFrom:"$inlineObject"}},{model:"htmlMeter",view:"meter",isObject:!0,modelSchema:{inheritAllFrom:"$inlineObject"}},{model:"htmlProgress",view:"progress",isObject:!0,modelSchema:{inheritAllFrom:"$inlineObject"}},{model:"htmlScript",view:"script",modelSchema:{allowWhere:["$text","$block"],isInline:!0}},{model:"htmlStyle",view:"style",modelSchema:{allowWhere:["$text","$block"],isInline:!0}},{model:"htmlCustomElement",view:"$customElement",modelSchema:{allowWhere:["$text","$block"],allowAttributesOf:"$inlineObject",isInline:!0}}]};class pc extends F{constructor(){super(...arguments);p(this,"_definitions",[])}static get pluginName(){return"DataSchema"}static get isOfficialPlugin(){return!0}init(){for(const e of f5.block)this.registerBlockElement(e);for(const e of f5.inline)this.registerInlineElement(e)}registerBlockElement(e){this._definitions.push({...e,isBlock:!0})}registerInlineElement(e){this._definitions.push({...e,isInline:!0})}extendBlockElement(e){this._extendDefinition({...e,isBlock:!0})}extendInlineElement(e){this._extendDefinition({...e,isInline:!0})}getDefinitionsForView(e,i=!1){const n=new Set;for(const r of this._getMatchingViewDefinitions(e)){if(i)for(const o of this._getReferences(r.model))n.add(o);n.add(r)}return n}getDefinitionsForModel(e){return this._definitions.filter(i=>i.model==e)}_getMatchingViewDefinitions(e){return this._definitions.filter(i=>i.view&&Bj(e,i.view))}*_getReferences(e){const i=["inheritAllFrom","inheritTypesFrom","allowWhere","allowContentOf","allowAttributesOf"],n=this._definitions.filter(r=>r.model==e);for(const{modelSchema:r}of n)if(r)for(const o of i)for(const l of dt(r[o]||[])){const a=this._definitions.filter(c=>c.model==l);for(const c of a)l!==e&&(yield*this._getReferences(c.model),yield c)}}_extendDefinition(e){const i=Array.from(this._definitions.entries()).filter(([,n])=>n.model==e.model);if(i.length==0){this._definitions.push(e);return}for(const[n,r]of i)this._definitions[n]=A6({},r,e,(o,l)=>Array.isArray(o)?o.concat(l):void 0)}}function Bj(s,t){return typeof s=="string"?s===t:s instanceof RegExp?s.test(t):!1}class Ft extends F{constructor(e){super(e);p(this,"_dataSchema");p(this,"_allowedAttributes");p(this,"_disallowedAttributes");p(this,"_allowedElements");p(this,"_disallowedElements");p(this,"_dataInitialized");p(this,"_coupledAttributes");this._dataSchema=e.plugins.get("DataSchema"),this._allowedAttributes=new kn,this._disallowedAttributes=new kn,this._allowedElements=new Set,this._disallowedElements=new Set,this._dataInitialized=!1,this._coupledAttributes=null,this._registerElementsAfterInit(),this._registerElementHandlers(),this._registerCoupledAttributesPostFixer(),this._registerAssociatedHtmlAttributesPostFixer()}static get pluginName(){return"DataFilter"}static get isOfficialPlugin(){return!0}static get requires(){return[pc,Lc]}loadAllowedConfig(e){for(const i of e){const n=i.name||/[\s\S]+/,r=g5(i);this.allowElement(n),r.forEach(o=>this.allowAttributes(o))}}loadDisallowedConfig(e){for(const i of e){const n=i.name||/[\s\S]+/,r=g5(i);r.length==0?this.disallowElement(n):r.forEach(o=>this.disallowAttributes(o))}}loadAllowedEmptyElementsConfig(e){for(const i of e)this.allowEmptyElement(i)}allowElement(e){for(const i of this._dataSchema.getDefinitionsForView(e,!0))this._addAllowedElement(i),this._coupledAttributes=null}disallowElement(e){for(const i of this._dataSchema.getDefinitionsForView(e,!1))this._disallowedElements.add(i.view)}allowEmptyElement(e){for(const i of this._dataSchema.getDefinitionsForView(e,!0))i.isInline&&this._dataSchema.extendInlineElement({...i,allowEmpty:!0})}allowAttributes(e){this._allowedAttributes.add(e)}disallowAttributes(e){this._disallowedAttributes.add(e)}processViewAttributes(e,i){const{consumable:n}=i;return m5(e,this._disallowedAttributes,n),$j(e,m5(e,this._allowedAttributes,n))}_addAllowedElement(e){if(!this._allowedElements.has(e)){if(this._allowedElements.add(e),"appliesToBlock"in e&&typeof e.appliesToBlock=="string")for(const i of this._dataSchema.getDefinitionsForModel(e.appliesToBlock))i.isBlock&&this._addAllowedElement(i);this._dataInitialized&&this.editor.data.once("set",()=>{this._fireRegisterEvent(e)},{priority:Ji.highest+1})}}_registerElementsAfterInit(){this.editor.data.on("init",()=>{this._dataInitialized=!0;for(const e of this._allowedElements)this._fireRegisterEvent(e)},{priority:Ji.highest+1})}_registerElementHandlers(){this.on("register",(e,i)=>{const n=this.editor.model.schema;if(i.isObject&&!n.isRegistered(i.model))this._registerObjectElement(i);else if(i.isBlock)this._registerBlockElement(i);else if(i.isInline)this._registerInlineElement(i);else throw new E("data-filter-invalid-definition",null,i);e.stop()},{priority:"lowest"})}_registerCoupledAttributesPostFixer(){const e=this.editor.model,i=e.document.selection;e.document.registerPostFixer(n=>{const r=e.document.differ.getChanges();let o=!1;const l=this._getCoupledAttributesMap();for(const a of r){if(a.type!="attribute"||a.attributeNewValue!==null)continue;const c=l.get(a.attributeKey);if(c)for(const{item:h}of a.range.getWalker())for(const f of c)h.hasAttribute(f)&&(n.removeAttribute(f,h),o=!0)}return o}),this.listenTo(i,"change:attribute",(n,{attributeKeys:r})=>{const o=new Set,l=this._getCoupledAttributesMap();for(const a of r){if(i.hasAttribute(a))continue;const c=l.get(a);if(c)for(const h of c)i.hasAttribute(h)&&o.add(h)}o.size!=0&&e.change(a=>{for(const c of o)a.removeSelectionAttribute(c)})})}_registerAssociatedHtmlAttributesPostFixer(){const e=this.editor.model;e.document.registerPostFixer(i=>{const n=e.document.differ.getChanges();let r=!1;for(const o of n)if(!(o.type!=="insert"||o.name==="$text"))for(const l of o.attributes.keys())!l.startsWith("html")||!l.endsWith("Attributes")||e.schema.checkAttribute(o.name,l)||(i.removeAttribute(l,o.position.nodeAfter),r=!0);return r})}_getCoupledAttributesMap(){if(this._coupledAttributes)return this._coupledAttributes;this._coupledAttributes=new Map;for(const e of this._allowedElements)if(e.coupledAttribute&&e.model){const i=this._coupledAttributes.get(e.coupledAttribute);i?i.push(e.model):this._coupledAttributes.set(e.coupledAttribute,[e.model])}return this._coupledAttributes}_fireRegisterEvent(e){e.view&&this._disallowedElements.has(e.view)||this.fire(e.view?`register:${e.view}`:"register",e)}_registerObjectElement(e){const i=this.editor,n=i.model.schema,r=i.conversion,{view:o,model:l}=e;n.register(l,e.modelSchema);/* istanbul ignore next: paranoid check -- @preserve */o&&(n.extend(e.model,{allowAttributes:[us(o),"htmlContent"]}),i.data.registerRawContentMatcher({name:o}),r.for("upcast").elementToElement({view:o,model:Oy(e),converterPriority:Ji.low+2}),r.for("upcast").add(gc(e,this)),r.for("editingDowncast").elementToStructure({model:{name:l,attributes:[us(o)]},view:Vj(i,e)}),r.for("dataDowncast").elementToElement({model:l,view:(a,{writer:c})=>Vp(o,a,c)}),r.for("dataDowncast").add(Bh(e)))}_registerBlockElement(e){const i=this.editor,n=i.model.schema,r=i.conversion,{view:o,model:l}=e;if(!n.isRegistered(e.model)){if(!e.modelSchema||(n.register(e.model,e.modelSchema),!o))return;r.for("upcast").elementToElement({model:l,view:o,converterPriority:Ji.low+2}),r.for("downcast").elementToElement({model:l,view:(a,{writer:c})=>e.isEmpty?c.createEmptyElement(o):c.createContainerElement(o)})}o&&(n.extend(e.model,{allowAttributes:us(o)}),r.for("upcast").add(gc(e,this)),r.for("downcast").add(Bh(e)))}_registerInlineElement(e){const i=this.editor,n=i.model.schema,r=i.conversion,o=e.model;if(!e.appliesToBlock&&(n.extend("$text",{allowAttributes:o}),e.attributeProperties&&n.setAttributeProperties(o,e.attributeProperties),r.for("upcast").add(Mj(e,this)),r.for("downcast").attributeToElement({model:o,view:Lj(e)}),!!e.allowEmpty)){if(n.setAttributeProperties(o,{copyFromObject:!1}),!n.isRegistered("htmlEmptyElement")){n.register("htmlEmptyElement",{inheritAllFrom:"$inlineObject"});const l=a=>Array.from(a.getAttributeKeys()).some(c=>c.startsWith("html"));i.model.document.registerPostFixer(a=>{const c=i.model.document.differ.getChanges(),h=new Set;for(const f of c)if(f.type!=="remove"){if(f.type==="attribute"&&f.attributeNewValue===null)for(const{item:m}of f.range)m.is("element","htmlEmptyElement")&&!l(m)&&h.add(m);if(f.type==="insert"&&f.position.nodeAfter){const m=f.position.nodeAfter;for(const{item:w}of a.createRangeOn(m))w.is("element","htmlEmptyElement")&&!l(w)&&h.add(w)}}for(const f of h)a.remove(f);return h.size>0})}i.data.htmlProcessor.domConverter.registerInlineObjectMatcher(l=>l.name==e.view&&l.isEmpty&&Array.from(l.getAttributeKeys()).length?{name:!0}:null),r.for("editingDowncast").elementToElement({model:"htmlEmptyElement",view:d5(e,!0)}),r.for("dataDowncast").elementToElement({model:"htmlEmptyElement",view:d5(e)})}}}function m5(s,t,e){const i=t.matchAll(s)||[],n=s.document.stylesProcessor;return i.reduce((r,{match:o})=>{for(const[l,a]of o.attributes||[])if(l=="style"){const c=a,h=n.getRelatedStyles(c).filter(f=>f.split("-").length>c.split("-").length).sort((f,m)=>m.split("-").length-f.split("-").length);for(const f of h)e.consume(s,{styles:[f]})&&r.styles.push(f);e.consume(s,{styles:[c]})&&r.styles.push(c)}else if(l=="class"){const c=a;e.consume(s,{classes:[c]})&&r.classes.push(c)}else e.consume(s,{attributes:[l]})&&r.attributes.push(l);return r},{attributes:[],classes:[],styles:[]})}function $j(s,{attributes:t,classes:e,styles:i}){return!t.length&&!e.length&&!i.length?null:{...t.length&&{attributes:Dj(s,t)},...i.length&&{styles:Qj(s,i)},...e.length&&{classes:e}}}function Dj(s,t){const e={};for(const i of t){const n=s.getAttribute(i);n!==void 0&&j6(i)&&(e[i]=n)}return e}function Qj(s,t){const e=new nc(s.document.stylesProcessor);for(const i of t){const n=s.getStyle(i);n!==void 0&&e.set(i,n)}return Object.fromEntries(e.getStylesEntries())}function Ax(s,t){const{name:e}=s,i=s[t];return Vs(i)?Object.entries(i).map(([n,r])=>({name:e,[t]:{[n]:r}})):Array.isArray(i)?i.map(n=>({name:e,[t]:[n]})):[s]}function g5(s){const{name:t,attributes:e,classes:i,styles:n}=s,r=[];return e&&r.push(...Ax({name:t,attributes:e},"attributes")),i&&r.push(...Ax({name:t,classes:i},"classes")),n&&r.push(...Ax({name:t,styles:n},"styles")),r}class Nj extends F{static get requires(){return[Ft]}static get pluginName(){return"CodeBlockElementSupport"}static get isOfficialPlugin(){return!0}init(){if(!this.editor.plugins.has("CodeBlockEditing"))return;const t=this.editor.plugins.get(Ft);t.on("register:pre",(e,i)=>{if(i.model!=="codeBlock")return;const n=this.editor,r=n.model.schema,o=n.conversion;r.extend("codeBlock",{allowAttributes:["htmlPreAttributes","htmlContentAttributes"]}),o.for("upcast").add(Fj(t)),o.for("downcast").add(zj()),e.stop()})}}function Fj(s){return t=>{t.on("element:code",(e,i,n)=>{const r=i.viewItem,o=r.parent;if(!o||!o.is("element","pre"))return;l(o,"htmlPreAttributes"),l(r,"htmlContentAttributes");function l(a,c){const h=s.processViewAttributes(a,n);h&&n.writer.setAttribute(c,h,i.modelRange)}},{priority:"low"})}}function zj(){return s=>{s.on("attribute:htmlPreAttributes:codeBlock",(t,e,i)=>{if(!i.consumable.consume(e.item,t.name))return;const{attributeOldValue:n,attributeNewValue:r}=e,l=i.mapper.toViewElement(e.item).parent;or(i.writer,n,r,l)}),s.on("attribute:htmlContentAttributes:codeBlock",(t,e,i)=>{if(!i.consumable.consume(e.item,t.name))return;const{attributeOldValue:n,attributeNewValue:r}=e,o=i.mapper.toViewElement(e.item);or(i.writer,n,r,o)})}}class Wj extends F{static get requires(){return[Ft]}static get pluginName(){return"DualContentModelElementSupport"}static get isOfficialPlugin(){return!0}init(){this.editor.plugins.get(Ft).on("register",(e,i)=>{const n=i,r=this.editor,o=r.model.schema,l=r.conversion;if(!n.paragraphLikeModel||o.isRegistered(n.model)||o.isRegistered(n.paragraphLikeModel))return;const a={model:n.paragraphLikeModel,view:n.view};o.register(n.model,n.modelSchema),o.register(a.model,{inheritAllFrom:"$block"}),l.for("upcast").elementToElement({view:n.view,model:(c,{writer:h})=>this._hasBlockContent(c)?h.createElement(n.model):h.createElement(a.model),converterPriority:Ji.low+.5}),l.for("downcast").elementToElement({view:n.view,model:n.model}),this._addAttributeConversion(n),l.for("downcast").elementToElement({view:a.view,model:a.model}),this._addAttributeConversion(a),e.stop()})}_hasBlockContent(t){const e=this.editor.editing.view,i=e.domConverter.blockElements;for(const n of e.createRangeIn(t).getItems())if(n.is("element")&&i.includes(n.name))return!0;return!1}_addAttributeConversion(t){const e=this.editor,i=e.conversion,n=e.plugins.get(Ft);e.model.schema.extend(t.model,{allowAttributes:us(t.view)}),i.for("upcast").add(gc(t,n)),i.for("downcast").add(Bh(t))}}class Uj extends F{static get requires(){return[pc,Ip]}static get pluginName(){return"HeadingElementSupport"}static get isOfficialPlugin(){return!0}init(){const t=this.editor;if(!t.plugins.has("HeadingEditing"))return;const e=t.config.get("heading.options");this.registerHeadingElements(t,e)}registerHeadingElements(t,e){const i=t.plugins.get(pc),n=[];for(const r of e)"model"in r&&"view"in r&&(i.registerBlockElement({view:r.view,model:r.model}),n.push(r.model));i.extendBlockElement({model:"htmlHgroup",modelSchema:{allowChildren:n}}),i.extendBlockElement({model:"htmlSummary",modelSchema:{allowChildren:n}})}}/**
 * @license Copyright (c) 2003-2025, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options
 */function $h(s,t,e){const i=s.createRangeOn(t);for(const{item:n}of i.getWalker())if(n.is("element",e))return n}class Zj extends F{static get requires(){return[Ft]}static get pluginName(){return"ImageElementSupport"}static get isOfficialPlugin(){return!0}init(){const t=this.editor;if(!t.plugins.has("ImageInlineEditing")&&!t.plugins.has("ImageBlockEditing"))return;const e=t.model.schema,i=t.conversion,n=t.plugins.get(Ft);n.on("register:figure",()=>{i.for("upcast").add(jj(n))}),n.on("register:img",(r,o)=>{o.model!=="imageBlock"&&o.model!=="imageInline"||(e.isRegistered("imageBlock")&&e.extend("imageBlock",{allowAttributes:["htmlImgAttributes","htmlFigureAttributes","htmlLinkAttributes"]}),e.isRegistered("imageInline")&&e.extend("imageInline",{allowAttributes:["htmlA","htmlImgAttributes"]}),i.for("upcast").add(Hj(n)),i.for("downcast").add(Xj()),t.plugins.has("LinkImage")&&i.for("upcast").add(qj(n,t)),r.stop())})}}function Hj(s){return t=>{t.on("element:img",(e,i,n)=>{if(!i.modelRange)return;const r=i.viewItem,o=s.processViewAttributes(r,n);o&&n.writer.setAttribute("htmlImgAttributes",o,i.modelRange)},{priority:"low"})}}function qj(s,t){const e=t.plugins.get("ImageUtils");return i=>{i.on("element:a",(n,r,o)=>{const l=r.viewItem;if(!e.findViewImgElement(l))return;const c=r.modelCursor.parent;if(!c.is("element","imageBlock"))return;const h=s.processViewAttributes(l,o);h&&o.writer.setAttribute("htmlLinkAttributes",h,c)},{priority:"low"})}}function jj(s){return t=>{t.on("element:figure",(e,i,n)=>{const r=i.viewItem;if(!i.modelRange||!r.hasClass("image"))return;const o=s.processViewAttributes(r,n);o&&n.writer.setAttribute("htmlFigureAttributes",o,i.modelRange)},{priority:"low"})}}function Xj(){return s=>{t("htmlImgAttributes"),e("img","htmlImgAttributes"),e("figure","htmlFigureAttributes"),e("a","htmlLinkAttributes");function t(i){s.on(`attribute:${i}:imageInline`,(n,r,o)=>{if(!o.consumable.consume(r.item,n.name))return;const{attributeOldValue:l,attributeNewValue:a}=r,c=o.mapper.toViewElement(r.item);or(o.writer,l,a,c)},{priority:"low"})}function e(i,n){s.on(`attribute:${n}:imageBlock`,(r,o,l)=>{if(!l.consumable.test(o.item,r.name))return;const{attributeOldValue:a,attributeNewValue:c}=o,h=l.mapper.toViewElement(o.item),f=$h(l.writer,h,i);f&&(or(l.writer,a,c,f),l.consumable.consume(o.item,r.name))},{priority:"low"}),i==="a"&&s.on("attribute:linkHref:imageBlock",(r,o,l)=>{if(!l.consumable.consume(o.item,"attribute:htmlLinkAttributes:imageBlock"))return;const a=l.mapper.toViewElement(o.item),c=$h(l.writer,a,"a");lr(l.writer,o.item.getAttribute("htmlLinkAttributes"),c)},{priority:"low"})}}}class Gj extends F{static get requires(){return[Ft]}static get pluginName(){return"MediaEmbedElementSupport"}static get isOfficialPlugin(){return!0}init(){const t=this.editor;if(!t.plugins.has("MediaEmbed")||t.config.get("mediaEmbed.previewsInData"))return;const e=t.model.schema,i=t.conversion,n=this.editor.plugins.get(Ft),r=this.editor.plugins.get(pc),o=t.config.get("mediaEmbed.elementName");r.registerBlockElement({model:"media",view:o}),n.on("register:figure",()=>{i.for("upcast").add(Kj(n))}),n.on(`register:${o}`,(l,a)=>{a.model==="media"&&(e.extend("media",{allowAttributes:[us(o),"htmlFigureAttributes"]}),i.for("upcast").add(Yj(n,o)),i.for("dataDowncast").add(Jj(o)),l.stop())})}}function Yj(s,t){const e=(i,n,r)=>{const o=n.viewItem;l(o,us(t));function l(a,c){const h=s.processViewAttributes(a,r);h&&r.writer.setAttribute(c,h,n.modelRange)}};return i=>{i.on(`element:${t}`,e,{priority:"low"})}}function Kj(s){return t=>{t.on("element:figure",(e,i,n)=>{const r=i.viewItem;if(!i.modelRange||!r.hasClass("media"))return;const o=s.processViewAttributes(r,n);o&&n.writer.setAttribute("htmlFigureAttributes",o,i.modelRange)},{priority:"low"})}}function Jj(s){return t=>{e(s,us(s)),e("figure","htmlFigureAttributes");function e(i,n){t.on(`attribute:${n}:media`,(r,o,l)=>{if(!l.consumable.consume(o.item,r.name))return;const{attributeOldValue:a,attributeNewValue:c}=o,h=l.mapper.toViewElement(o.item),f=$h(l.writer,h,i);or(l.writer,a,c,f)})}}}class eX extends F{static get requires(){return[Ft]}static get pluginName(){return"ScriptElementSupport"}static get isOfficialPlugin(){return!0}init(){const t=this.editor.plugins.get(Ft);t.on("register:script",(e,i)=>{const n=this.editor,r=n.model.schema,o=n.conversion;r.register("htmlScript",i.modelSchema),r.extend("htmlScript",{allowAttributes:["htmlScriptAttributes","htmlContent"],isContent:!0}),n.data.registerRawContentMatcher({name:"script"}),o.for("upcast").elementToElement({view:"script",model:Oy(i)}),o.for("upcast").add(gc(i,t)),o.for("downcast").elementToElement({model:"htmlScript",view:(l,{writer:a})=>Vp("script",l,a)}),o.for("downcast").add(Bh(i)),e.stop()})}}const tX=["width","max-width","min-width","height","min-height","max-height"];class iX extends F{static get requires(){return[Ft]}static get pluginName(){return"TableElementSupport"}static get isOfficialPlugin(){return!0}init(){const t=this.editor;if(!t.plugins.has("TableEditing"))return;const e=t.model.schema,i=t.conversion,n=t.plugins.get(Ft),r=t.plugins.get("TableUtils");n.on("register:figure",()=>{i.for("upcast").add(rX(n))}),n.on("register:table",(o,l)=>{l.model==="table"&&(e.extend("table",{allowAttributes:["htmlTableAttributes","htmlFigureAttributes","htmlTheadAttributes","htmlTbodyAttributes"]}),i.for("upcast").add(sX(n)),i.for("downcast").add(oX()),t.model.document.registerPostFixer(nX(t.model,r)),o.stop())})}}function nX(s,t){return e=>{const i=s.document.differ.getChanges();let n=!1;for(const r of i){if(r.type!="attribute"||r.attributeKey!="headingRows")continue;const o=r.range.start.nodeAfter,l=o.getAttribute("htmlTheadAttributes"),a=o.getAttribute("htmlTbodyAttributes");l&&!r.attributeNewValue?(e.removeAttribute("htmlTheadAttributes",o),n=!0):a&&r.attributeNewValue==t.getRows(o)&&(e.removeAttribute("htmlTbodyAttributes",o),n=!0)}return n}}function sX(s){return t=>{t.on("element:table",(e,i,n)=>{if(!i.modelRange)return;const r=i.viewItem;o(r,"htmlTableAttributes");for(const l of r.getChildren())l.is("element","thead")&&o(l,"htmlTheadAttributes"),l.is("element","tbody")&&o(l,"htmlTbodyAttributes");function o(l,a){const c=s.processViewAttributes(l,n);c&&n.writer.setAttribute(a,c,i.modelRange)}},{priority:"low"})}}function rX(s){return t=>{t.on("element:figure",(e,i,n)=>{const r=i.viewItem;if(!i.modelRange||!r.hasClass("table"))return;const o=s.processViewAttributes(r,n);o&&n.writer.setAttribute("htmlFigureAttributes",o,i.modelRange)},{priority:"low"})}}function oX(){return s=>{t("table","htmlTableAttributes"),t("figure","htmlFigureAttributes"),t("thead","htmlTheadAttributes"),t("tbody","htmlTbodyAttributes");function t(e,i){s.on(`attribute:${i}:table`,(n,r,o)=>{if(!o.consumable.test(r.item,n.name))return;const l=o.mapper.toViewElement(r.item),a=$h(o.writer,l,e);if(a)if(o.consumable.consume(r.item,n.name),i==="htmlTableAttributes"&&l!==a){const c=p5(r.attributeOldValue),h=p5(r.attributeNewValue);or(o.writer,c.tableAttributes,h.tableAttributes,a),or(o.writer,c.figureAttributes,h.figureAttributes,l)}else or(o.writer,r.attributeOldValue,r.attributeNewValue,a)})}}}function p5(s){const t={},e={...s};if(!s||!("styles"in s))return{figureAttributes:t,tableAttributes:e};e.styles={};for(const[i,n]of Object.entries(s.styles))tX.includes(i)?t.styles={...t.styles,[i]:n}:e.styles={...e.styles,[i]:n};return{figureAttributes:t,tableAttributes:e}}class lX extends F{static get requires(){return[Ft]}static get pluginName(){return"StyleElementSupport"}static get isOfficialPlugin(){return!0}init(){const t=this.editor.plugins.get(Ft);t.on("register:style",(e,i)=>{const n=this.editor,r=n.model.schema,o=n.conversion;r.register("htmlStyle",i.modelSchema),r.extend("htmlStyle",{allowAttributes:["htmlStyleAttributes","htmlContent"],isContent:!0}),n.data.registerRawContentMatcher({name:"style"}),o.for("upcast").elementToElement({view:"style",model:Oy(i)}),o.for("upcast").add(gc(i,t)),o.for("downcast").elementToElement({model:"htmlStyle",view:(l,{writer:a})=>Vp("style",l,a)}),o.for("downcast").add(Bh(i)),e.stop()})}}class aX extends F{static get requires(){return[Ft]}static get pluginName(){return"ListElementSupport"}static get isOfficialPlugin(){return!0}init(){const t=this.editor;if(!t.plugins.has("ListEditing"))return;const e=t.model.schema,i=t.conversion,n=t.plugins.get(Ft),r=t.plugins.get("ListEditing"),o=t.plugins.get("ListUtils"),l=["ul","ol","li"];r.registerDowncastStrategy({scope:"item",attributeName:"htmlLiAttributes",setAttributeOnDowncast:lr}),r.registerDowncastStrategy({scope:"list",attributeName:"htmlUlAttributes",setAttributeOnDowncast:lr}),r.registerDowncastStrategy({scope:"list",attributeName:"htmlOlAttributes",setAttributeOnDowncast:lr}),n.on("register",(a,c)=>{if(!l.includes(c.view)||(a.stop(),e.checkAttribute("$block","htmlLiAttributes")))return;const h=l.map(f=>us(f));e.extend("$listItem",{allowAttributes:h}),i.for("upcast").add(f=>{f.on("element:ul",Ix("htmlUlAttributes",n),{priority:"low"}),f.on("element:ol",Ix("htmlOlAttributes",n),{priority:"low"}),f.on("element:li",Ix("htmlLiAttributes",n),{priority:"low"})})}),r.on("postFixer",(a,{listNodes:c,writer:h})=>{for(const{node:f,previousNodeInList:m}of c)if(m){if(m.getAttribute("listType")==f.getAttribute("listType")){const w=w5(m.getAttribute("listType")),O=m.getAttribute(w);!Cl(f.getAttribute(w),O)&&h.model.schema.checkAttribute(f,w)&&(h.setAttribute(w,O,f),a.return=!0)}if(m.getAttribute("listItemId")==f.getAttribute("listItemId")){const w=m.getAttribute("htmlLiAttributes");!Cl(f.getAttribute("htmlLiAttributes"),w)&&h.model.schema.checkAttribute(f,"htmlLiAttributes")&&(h.setAttribute("htmlLiAttributes",w,f),a.return=!0)}}}),r.on("postFixer",(a,{listNodes:c,writer:h})=>{for(const{node:f}of c){const m=f.getAttribute("listType");!o.isNumberedListType(m)&&f.getAttribute("htmlOlAttributes")&&(h.removeAttribute("htmlOlAttributes",f),a.return=!0),o.isNumberedListType(m)&&f.getAttribute("htmlUlAttributes")&&(h.removeAttribute("htmlUlAttributes",f),a.return=!0)}})}afterInit(){const t=this.editor;if(!t.commands.get("indentList"))return;const e=t.commands.get("indentList");this.listenTo(e,"afterExecute",(i,n)=>{t.model.change(r=>{for(const o of n){const l=w5(o.getAttribute("listType"));t.model.schema.checkAttribute(o,l)&&r.setAttribute(l,{},o)}})})}}function Ix(s,t){return(e,i,n)=>{const r=i.viewItem;i.modelRange||Object.assign(i,n.convertChildren(i.viewItem,i.modelCursor));const o=t.processViewAttributes(r,n);for(const l of i.modelRange.getItems({shallow:!0}))l.hasAttribute("listItemId")&&(l.hasAttribute("htmlUlAttributes")||l.hasAttribute("htmlOlAttributes")||n.writer.model.schema.checkAttribute(l,s)&&n.writer.setAttribute(s,o||{},l))}}function w5(s){return s==="numbered"||s=="customNumbered"?"htmlOlAttributes":"htmlUlAttributes"}class cX extends F{static get requires(){return[Ft]}static get pluginName(){return"HorizontalLineElementSupport"}static get isOfficialPlugin(){return!0}init(){const t=this.editor;if(!t.plugins.has("HorizontalLineEditing"))return;const e=t.model.schema,i=t.conversion,n=t.plugins.get(Ft);n.on("register:hr",(r,o)=>{o.model==="horizontalLine"&&(e.extend("horizontalLine",{allowAttributes:["htmlHrAttributes"]}),i.for("upcast").add(gc(o,n)),i.for("downcast").add(uX()),r.stop())})}}function uX(){return s=>{s.on("attribute:htmlHrAttributes:horizontalLine",(t,e,i)=>{if(!i.consumable.test(e.item,t.name))return;const{attributeOldValue:n,attributeNewValue:r}=e,o=i.mapper.toViewElement(e.item),l=$h(i.writer,o,"hr");l&&(or(i.writer,n,r,l),i.consumable.consume(e.item,t.name))},{priority:"low"})}}class hX extends F{static get requires(){return[Ft,pc]}static get pluginName(){return"CustomElementSupport"}static get isOfficialPlugin(){return!0}init(){const t=this.editor.plugins.get(Ft),e=this.editor.plugins.get(pc);t.on("register:$customElement",(i,n)=>{i.stop();const r=this.editor,o=r.model.schema,l=r.conversion,a=r.editing.view.domConverter.unsafeElements,c=r.data.htmlProcessor.domConverter.preElements;o.register(n.model,n.modelSchema),o.extend(n.model,{allowAttributes:["htmlElementName","htmlCustomElementAttributes","htmlContent"],isContent:!0}),r.data.htmlProcessor.domConverter.registerRawContentMatcher({name:"template"}),l.for("upcast").elementToElement({view:/.*/,model:(h,f)=>{if(h.name=="$comment"||!dX(h.name)||e.getDefinitionsForView(h.name).size)return null;a.includes(h.name)||a.push(h.name),c.includes(h.name)||c.push(h.name);const m=f.writer.createElement(n.model,{htmlElementName:h.name}),w=t.processViewAttributes(h,f);w&&f.writer.setAttribute("htmlCustomElementAttributes",w,m);let O;if(h.is("element","template")&&h.getCustomProperty("$rawContent"))O=h.getCustomProperty("$rawContent");else{const k=new Cn(h.document).createDocumentFragment(h),C=r.data.htmlProcessor.domConverter.viewToDom(k),P=C.firstChild;for(;P.firstChild;)C.appendChild(P.firstChild);P.remove(),O=r.data.htmlProcessor.htmlWriter.getHtml(C)}f.writer.setAttribute("htmlContent",O,m);for(const{item:_}of r.editing.view.createRangeIn(h))f.consumable.consume(_,{name:!0});return m},converterPriority:"low"}),l.for("editingDowncast").elementToElement({model:{name:n.model,attributes:["htmlElementName","htmlCustomElementAttributes","htmlContent"]},view:(h,{writer:f})=>{const m=h.getAttribute("htmlElementName"),w=f.createRawElement(m);return h.hasAttribute("htmlCustomElementAttributes")&&lr(f,h.getAttribute("htmlCustomElementAttributes"),w),w}}),l.for("dataDowncast").elementToElement({model:{name:n.model,attributes:["htmlElementName","htmlCustomElementAttributes","htmlContent"]},view:(h,{writer:f})=>{const m=h.getAttribute("htmlElementName"),w=h.getAttribute("htmlContent"),O=f.createRawElement(m,null,(_,k)=>{k.setContentOf(_,w)});return h.hasAttribute("htmlCustomElementAttributes")&&lr(f,h.getAttribute("htmlCustomElementAttributes"),O),O}})})}}function dX(s){try{document.createElement(s)}catch{return!1}return!0}class fX extends F{static get pluginName(){return"GeneralHtmlSupport"}static get isOfficialPlugin(){return!0}static get requires(){return[Ft,Nj,Wj,Uj,Zj,Gj,eX,iX,lX,aX,cX,hX]}init(){const t=this.editor,e=t.plugins.get(Ft);e.loadAllowedEmptyElementsConfig(t.config.get("htmlSupport.allowEmpty")||[]),e.loadAllowedConfig(t.config.get("htmlSupport.allow")||[]),e.loadDisallowedConfig(t.config.get("htmlSupport.disallow")||[])}getGhsAttributeNameForElement(t){const e=this.editor.plugins.get("DataSchema"),i=Array.from(e.getDefinitionsForView(t,!1)),n=i.find(r=>r.isInline&&!i[0].isObject);return n?n.model:us(t)}addModelHtmlClass(t,e,i){const n=this.editor.model,r=this.getGhsAttributeNameForElement(t);n.change(o=>{for(const l of La(n,i,r))Ma(o,l,r,"classes",a=>{for(const c of dt(e))a.add(c)})})}removeModelHtmlClass(t,e,i){const n=this.editor.model,r=this.getGhsAttributeNameForElement(t);n.change(o=>{for(const l of La(n,i,r))Ma(o,l,r,"classes",a=>{for(const c of dt(e))a.delete(c)})})}setModelHtmlAttributes(t,e,i){const n=this.editor.model,r=this.getGhsAttributeNameForElement(t);n.change(o=>{for(const l of La(n,i,r))Ma(o,l,r,"attributes",a=>{for(const[c,h]of Object.entries(e))a.set(c,h)})})}removeModelHtmlAttributes(t,e,i){const n=this.editor.model,r=this.getGhsAttributeNameForElement(t);n.change(o=>{for(const l of La(n,i,r))Ma(o,l,r,"attributes",a=>{for(const c of dt(e))a.delete(c)})})}setModelHtmlStyles(t,e,i){const n=this.editor.model,r=this.getGhsAttributeNameForElement(t);n.change(o=>{for(const l of La(n,i,r))Ma(o,l,r,"styles",a=>{for(const[c,h]of Object.entries(e))a.set(c,h)})})}removeModelHtmlStyles(t,e,i){const n=this.editor.model,r=this.getGhsAttributeNameForElement(t);n.change(o=>{for(const l of La(n,i,r))Ma(o,l,r,"styles",a=>{for(const c of dt(e))a.delete(c)})})}}function*La(s,t,e){if(t)if(!(Symbol.iterator in t)&&t.is("documentSelection")&&t.isCollapsed)s.schema.checkAttributeInSelection(t,e)&&(yield t);else for(const i of mX(s,t,e))yield*i.getItems({shallow:!0})}function mX(s,t,e){return!(Symbol.iterator in t)&&(t.is("node")||t.is("$text")||t.is("$textProxy"))?s.schema.checkAttribute(t,e)?[s.createRangeOn(t)]:[]:s.schema.getValidRanges(s.createSelection(t).getRanges(),e)}class gX extends F{static get pluginName(){return"HtmlComment"}static get isOfficialPlugin(){return!0}init(){const t=this.editor,e=new Map;t.data.processor.skipComments=!1,t.model.schema.addAttributeCheck((i,n)=>{if(i.endsWith("$root")&&n.startsWith("$comment"))return!0}),t.conversion.for("upcast").elementToMarker({view:"$comment",model:i=>{const r=`$comment:${ei()}`,o=i.getCustomProperty("$rawContent");return e.set(r,o),r}}),t.conversion.for("dataDowncast").markerToElement({model:"$comment",view:(i,{writer:n})=>{let r;for(const c of this.editor.model.document.getRootNames())if(r=this.editor.model.document.getRoot(c),r.hasAttribute(i.markerName))break;const o=i.markerName,l=r.getAttribute(o),a=n.createUIElement("$comment");return n.setCustomProperty("$rawContent",l,a),a}}),t.model.document.registerPostFixer(i=>{let n=!1;const r=t.model.document.differ.getChangedMarkers().filter(o=>o.name.startsWith("$comment:"));for(const o of r){const{oldRange:l,newRange:a}=o.data;if(!(l&&a&&l.root==a.root)){if(l){const c=l.root;c.hasAttribute(o.name)&&(i.removeAttribute(o.name,c),n=!0)}if(a){const c=a.root;c.rootName=="$graveyard"?(i.removeMarker(o.name),n=!0):c.hasAttribute(o.name)||(i.setAttribute(o.name,e.get(o.name)||"",c),n=!0)}}}return n}),t.data.on("set",()=>{for(const i of t.model.markers.getMarkersGroup("$comment"))this.removeHtmlComment(i.name)},{priority:"high"}),t.model.on("deleteContent",(i,[n])=>{for(const r of n.getRanges()){const o=t.model.schema.getLimitElement(r),l=t.model.createPositionAt(o,0),a=t.model.createPositionAt(o,"end");let c;l.isTouching(r.start)&&a.isTouching(r.end)?c=this.getHtmlCommentsInRange(t.model.createRange(l,a)):c=this.getHtmlCommentsInRange(r,{skipBoundaries:!0});for(const h of c)this.removeHtmlComment(h)}},{priority:"high"})}createHtmlComment(t,e){const i=ei(),r=this.editor.model,o=r.document.getRoot(t.root.rootName),l=`$comment:${i}`;return r.change(a=>{const c=a.createRange(t);return a.addMarker(l,{usingOperation:!0,affectsData:!0,range:c}),a.setAttribute(l,e,o),l})}removeHtmlComment(t){const e=this.editor,i=e.model.markers.get(t);return i?(e.model.change(n=>{n.removeMarker(i)}),!0):!1}getHtmlCommentData(t){const i=this.editor.model.markers.get(t);if(!i)return null;let n="";for(const r of this.editor.model.document.getRoots())if(r.hasAttribute(t)){n=r.getAttribute(t);break}return{content:n,position:i.getStart()}}getHtmlCommentsInRange(t,{skipBoundaries:e=!1}={}){const i=!e;return Array.from(this.editor.model.markers.getMarkersGroup("$comment")).filter(r=>n(r,t)).map(r=>r.name);function n(r,o){const l=r.getRange().start;return(l.isAfter(o.start)||i&&l.isEqual(o.start))&&(l.isBefore(o.end)||i&&l.isEqual(o.end))}}}/**
 * @license Copyright (c) 2003-2025, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options
 */function pX(s){return s.createContainerElement("span",{class:"image-inline"},s.createEmptyElement("img"))}function x5(s){return s.createContainerElement("figure",{class:"image"},[s.createEmptyElement("img"),s.createSlot("children")])}function m7(s,t){const e=s.plugins.get("ImageUtils"),i=s.plugins.has("ImageInlineEditing")&&s.plugins.has("ImageBlockEditing");return r=>e.isInlineImageView(r)?i&&(r.getStyle("display")=="block"||r.findAncestor(e.isBlockImageView)?"imageBlock":"imageInline")!==t?null:n(r):null;function n(r){const o={name:!0};return r.hasAttribute("src")&&(o.attributes=["src"]),o}}function yy(s,t){const e=$t(t.getSelectedBlocks());return!e||s.isObject(e)||e.isEmpty&&e.name!="listItem"?"imageBlock":"imageInline"}function Mg(s){return s&&s.endsWith("px")?parseInt(s):null}function Lg(s){const t=Mg(s.getStyle("width")),e=Mg(s.getStyle("height"));return!!(t&&e)}const wX=/^(image|image-inline)$/;class _i extends F{constructor(){super(...arguments);p(this,"_domEmitter",new(qi()))}static get pluginName(){return"ImageUtils"}static get isOfficialPlugin(){return!0}isImage(e){return this.isInlineImage(e)||this.isBlockImage(e)}isInlineImageView(e){return!!e&&e.is("element","img")}isBlockImageView(e){return!!e&&e.is("element","figure")&&e.hasClass("image")}insertImage(e={},i=null,n=null,r={}){const o=this.editor,l=o.model,a=l.document.selection,c=g7(o,i||a,n);e={...Object.fromEntries(a.getAttributes()),...e};for(const h in e)l.schema.checkAttribute(c,h)||delete e[h];return l.change(h=>{const{setImageSizes:f=!0}=r,m=h.createElement(c,e);return l.insertObject(m,i,null,{setSelection:"on",findOptimalPosition:!i&&c!="imageInline"?"auto":void 0}),m.parent?(f&&this.setImageNaturalSizeAttributes(m),m):null})}setImageNaturalSizeAttributes(e){const i=e.getAttribute("src");i&&(e.getAttribute("width")||e.getAttribute("height")||this.editor.model.change(n=>{const r=new he.window.Image;this._domEmitter.listenTo(r,"load",()=>{!e.getAttribute("width")&&!e.getAttribute("height")&&this.editor.model.enqueueChange(n.batch,o=>{o.setAttribute("width",r.naturalWidth,e),o.setAttribute("height",r.naturalHeight,e)}),this._domEmitter.stopListening(r,"load")}),r.src=i}))}getClosestSelectedImageWidget(e){const i=e.getFirstPosition();if(!i)return null;const n=e.getSelectedElement();if(n&&this.isImageWidget(n))return n;let r=i.parent;for(;r;){if(r.is("element")&&this.isImageWidget(r))return r;r=r.parent}return null}getClosestSelectedImageElement(e){const i=e.getSelectedElement();return this.isImage(i)?i:e.getFirstPosition().findAncestor("imageBlock")}getImageWidgetFromImageView(e){return e.findAncestor({classes:wX})}isImageAllowed(){const i=this.editor.model.document.selection;return xX(this.editor,i)&&bX(i)}toImageWidget(e,i,n){return i.setCustomProperty("image",!0,e),fd(e,i,{label:()=>{const l=this.findViewImgElement(e).getAttribute("alt");return l?`${l} ${n}`:n}})}isImageWidget(e){return!!e.getCustomProperty("image")&&Ut(e)}isBlockImage(e){return!!e&&e.is("element","imageBlock")}isInlineImage(e){return!!e&&e.is("element","imageInline")}findViewImgElement(e){if(this.isInlineImageView(e))return e;const i=this.editor.editing.view;for(const{item:n}of i.createRangeIn(e))if(this.isInlineImageView(n))return n}destroy(){return this._domEmitter.stopListening(),super.destroy()}}function xX(s,t){if(g7(s,t,null)=="imageBlock"){const i=OX(t,s.model);if(s.model.schema.checkChild(i,"imageBlock"))return!0}else if(s.model.schema.checkChild(t.focus,"imageInline"))return!0;return!1}function bX(s){return[...s.focus.getAncestors()].every(t=>!t.is("element","imageBlock"))}function OX(s,t){const i=KI(s,t).start.parent;return i.isEmpty&&!i.is("element","$root")?i.parent:i}function g7(s,t,e){const i=s.model.schema,n=s.config.get("image.insert.type");return s.plugins.has("ImageBlockEditing")?s.plugins.has("ImageInlineEditing")?e||(n==="inline"?"imageInline":n!=="auto"?"imageBlock":t.is("selection")?yy(i,t):i.checkChild(t,"imageInline")?"imageInline":"imageBlock"):"imageBlock":"imageInline"}const yX=new RegExp(String(/^(http(s)?:\/\/)?[\w-]+\.[\w.~:/[\]@!$&'()*+,;=%-]+/.source+/\.(jpg|jpeg|png|gif|ico|webp|JPG|JPEG|PNG|GIF|ICO|WEBP)/.source+/(\?[\w.~:/[\]@!$&'()*+,;=%-]*)?/.source+/(#[\w.~:/[\]@!$&'()*+,;=%-]*)?$/.source));class vX extends F{constructor(e){super(e);p(this,"_timeoutId");p(this,"_positionToInsert");this._timeoutId=null,this._positionToInsert=null}static get requires(){return[a7,_i,f7,Hl]}static get pluginName(){return"AutoImage"}static get isOfficialPlugin(){return!0}init(){const e=this.editor,i=e.model.document,n=e.plugins.get("ClipboardPipeline");this.listenTo(n,"inputTransformation",()=>{const r=i.selection.getFirstRange(),o=Xt.fromPosition(r.start);o.stickiness="toPrevious";const l=Xt.fromPosition(r.end);l.stickiness="toNext",i.once("change:data",()=>{this._embedImageBetweenPositions(o,l),o.detach(),l.detach()},{priority:"high"})}),e.commands.get("undo").on("execute",()=>{this._timeoutId&&(he.window.clearTimeout(this._timeoutId),this._positionToInsert.detach(),this._timeoutId=null,this._positionToInsert=null)},{priority:"high"})}_embedImageBetweenPositions(e,i){const n=this.editor,r=new bn(e,i),o=r.getWalker({ignoreElementEnd:!0}),l=Object.fromEntries(n.model.document.selection.getAttributes()),a=this.editor.plugins.get("ImageUtils");let c="";for(const h of o)h.item.is("$textProxy")&&(c+=h.item.data);if(c=c.trim(),!c.match(yX)){r.detach();return}this._positionToInsert=Xt.fromPosition(e),this._timeoutId=setTimeout(()=>{if(!n.commands.get("insertImage").isEnabled){r.detach();return}n.model.change(m=>{this._timeoutId=null,m.remove(r),r.detach();let w;this._positionToInsert.root.rootName!=="$graveyard"&&(w=this._positionToInsert.toPosition()),a.insertImage({...l,src:c},w),this._positionToInsert.detach(),this._positionToInsert=null}),n.plugins.get("Delete").requestUndoOnBackspace()},100)}}class _X extends Be{refresh(){const i=this.editor.plugins.get("ImageUtils").getClosestSelectedImageElement(this.editor.model.document.selection);this.isEnabled=!!i,this.isEnabled&&i.hasAttribute("alt")?this.value=i.getAttribute("alt"):this.value=!1}execute(t){const e=this.editor,i=e.plugins.get("ImageUtils"),n=e.model,r=i.getClosestSelectedImageElement(n.document.selection);n.change(o=>{o.setAttribute("alt",t.newValue,r)})}}class kX extends F{static get requires(){return[_i]}static get pluginName(){return"ImageTextAlternativeEditing"}static get isOfficialPlugin(){return!0}init(){this.editor.commands.add("imageTextAlternative",new _X(this.editor))}}class SX extends ue{constructor(e){super(e);p(this,"focusTracker");p(this,"keystrokes");p(this,"labeledInput");p(this,"backButtonView");p(this,"saveButtonView");p(this,"children");p(this,"_focusables");p(this,"_focusCycler");this.focusTracker=new ot,this.keystrokes=new wt,this.backButtonView=this._createBackButton(),this.saveButtonView=this._createSaveButton(),this.labeledInput=this._createLabeledInputView(),this.children=this.createCollection([this._createHeaderView()]),this.children.add(new Ei(e,{children:[this.labeledInput,this.saveButtonView],class:["ck-form__row_with-submit","ck-form__row_large-top-padding"]})),this._focusables=new fi,this.keystrokes.set("Esc",(i,n)=>{this.fire("cancel"),n()}),this._focusCycler=new Ht({focusables:this._focusables,focusTracker:this.focusTracker,keystrokeHandler:this.keystrokes,actions:{focusPrevious:"shift + tab",focusNext:"tab"}}),this.setTemplate({tag:"form",attributes:{class:["ck","ck-form","ck-text-alternative-form","ck-responsive-form"],tabindex:"-1"},children:this.children})}render(){super.render(),Wl({view:this}),[this.backButtonView,this.labeledInput,this.saveButtonView].forEach(i=>{this._focusables.add(i),this.focusTracker.add(i.element)}),this.keystrokes.listenTo(this.element)}destroy(){super.destroy(),this.focusTracker.destroy(),this.keystrokes.destroy()}_createBackButton(){const e=this.locale.t,i=new ye(this.locale);return i.set({class:"ck-button-back",label:e("Back"),icon:zl,tooltip:!0}),i.delegate("execute").to(this,"cancel"),i}_createSaveButton(){const e=this.locale.t,i=new ye(this.locale);return i.set({label:e("Save"),withText:!0,type:"submit",class:"ck-button-action ck-button-bold"}),i}_createHeaderView(){const e=this.locale.t,i=new zr(this.locale,{label:e("Text Alternative")});return i.children.add(this.backButtonView,0),i}_createLabeledInputView(){const e=this.locale.t,i=new Yt(this.locale,On);return i.label=e("Text alternative"),i.class="ck-labeled-field-view_full-width",i}}function CX(s){const t=s.plugins.get("ContextualBalloon");if(s.plugins.get("ImageUtils").getClosestSelectedImageWidget(s.editing.view.document.selection)){const i=vy(s);t.updatePosition(i)}}function vy(s){const t=s.editing.view,e=Fi.defaultPositions,i=s.plugins.get("ImageUtils");return{target:t.domConverter.mapViewToDom(i.getClosestSelectedImageWidget(t.document.selection)),positions:[e.northArrowSouth,e.northArrowSouthWest,e.northArrowSouthEast,e.southArrowNorth,e.southArrowNorthWest,e.southArrowNorthEast,e.viewportStickyNorth]}}class PX extends F{constructor(){super(...arguments);p(this,"_balloon");p(this,"_form")}static get requires(){return[gs]}static get pluginName(){return"ImageTextAlternativeUI"}static get isOfficialPlugin(){return!0}init(){this._createButton()}destroy(){super.destroy(),this._form&&this._form.destroy()}_createButton(){const e=this.editor,i=e.t;e.ui.componentFactory.add("imageTextAlternative",n=>{const r=e.commands.get("imageTextAlternative"),o=new ye(n);return o.set({label:i("Change image text alternative"),icon:Nz,tooltip:!0}),o.bind("isEnabled").to(r,"isEnabled"),o.bind("isOn").to(r,"value",l=>!!l),this.listenTo(o,"execute",()=>{this._showForm()}),o})}_createForm(){const e=this.editor,n=e.editing.view.document,r=e.plugins.get("ImageUtils");this._balloon=this.editor.plugins.get("ContextualBalloon"),this._form=new(_g(SX))(e.locale),this._form.render(),this.listenTo(this._form,"submit",()=>{e.execute("imageTextAlternative",{newValue:this._form.labeledInput.fieldView.element.value}),this._hideForm(!0)}),this.listenTo(this._form,"cancel",()=>{this._hideForm(!0)}),this.listenTo(e.ui,"update",()=>{r.getClosestSelectedImageWidget(n.selection)?this._isVisible&&CX(e):this._hideForm(!0)}),Fr({emitter:this._form,activator:()=>this._isVisible,contextElements:()=>[this._balloon.view.element],callback:()=>this._hideForm()})}_showForm(){if(this._isVisible)return;this._form||this._createForm();const e=this.editor,i=e.commands.get("imageTextAlternative"),n=this._form.labeledInput;this._form.disableCssTransitions(),this._isInBalloon||this._balloon.add({view:this._form,position:vy(e)}),n.fieldView.value=n.fieldView.element.value=i.value||"",this._form.labeledInput.fieldView.select(),this._form.enableCssTransitions()}_hideForm(e=!1){this._isInBalloon&&(this._form.focusTracker.isFocused&&this._form.saveButtonView.focus(),this._balloon.remove(this._form),e&&this.editor.editing.view.focus())}get _isVisible(){return!!this._balloon&&this._balloon.visibleView===this._form}get _isInBalloon(){return!!this._balloon&&this._balloon.hasView(this._form)}}class _y extends F{static get requires(){return[kX,PX]}static get pluginName(){return"ImageTextAlternative"}static get isOfficialPlugin(){return!0}}function TX(s){const t=(e,i,n)=>{if(!n.consumable.test(i.viewItem,{name:!0,classes:"image"}))return;const r=s.findViewImgElement(i.viewItem);if(!r||!n.consumable.test(r,{name:!0}))return;n.consumable.consume(i.viewItem,{name:!0,classes:"image"});const o=n.convertItem(r,i.modelCursor),l=$t(o.modelRange.getItems());if(!l){n.consumable.revert(i.viewItem,{name:!0,classes:"image"});return}n.convertChildren(i.viewItem,l),n.updateConversionResult(l,i)};return e=>{e.on("element:figure",t)}}function EX(s){const t=["srcset","media","type","sizes"],e=(i,n,r)=>{const o=n.viewItem;if(!r.consumable.test(o,{name:!0}))return;const l=new Map;for(const h of o.getChildren())if(h.is("element","source")){const f={};for(const m of t)h.hasAttribute(m)&&r.consumable.test(h,{attributes:m})&&(f[m]=h.getAttribute(m));Object.keys(f).length&&l.set(h,f)}const a=s.findViewImgElement(o);if(!a)return;let c=n.modelCursor.parent;if(!c.is("element","imageBlock")){const h=r.convertItem(a,n.modelCursor);n.modelRange=h.modelRange,n.modelCursor=h.modelCursor,c=$t(h.modelRange.getItems())}r.consumable.consume(o,{name:!0});for(const[h,f]of l)r.consumable.consume(h,{attributes:Object.keys(f)});l.size&&r.writer.setAttribute("sources",Array.from(l.values()),c),r.convertChildren(o,c)};return i=>{i.on("element:picture",e)}}function p7(s,t){const e=(i,n,r)=>{if(!r.consumable.consume(n.item,i.name))return;const o=r.writer,l=r.mapper.toViewElement(n.item),a=s.findViewImgElement(l);n.attributeNewValue===null?(o.removeAttribute("srcset",a),o.removeAttribute("sizes",a)):n.attributeNewValue&&(o.setAttribute("srcset",n.attributeNewValue,a),o.setAttribute("sizes","100vw",a))};return i=>{i.on(`attribute:srcset:${t}`,e)}}function AX(s){const t=(e,i,n)=>{if(!n.consumable.consume(i.item,e.name))return;const r=n.writer,o=n.mapper.toViewElement(i.item),l=s.findViewImgElement(o),a=i.attributeNewValue;if(a&&a.length){const c=[];let h=l.parent;for(;h&&h.is("attributeElement");){const w=h.parent;r.unwrap(r.createRangeOn(l),h),c.unshift(h),h=w}const f=l.parent.is("element","picture"),m=f?l.parent:r.createContainerElement("picture",null);f||r.insert(r.createPositionBefore(l),m),r.remove(r.createRangeIn(m)),r.insert(r.createPositionAt(m,"end"),a.map(w=>r.createEmptyElement("source",w))),r.move(r.createRangeOn(l),r.createPositionAt(m,"end"));for(const w of c)r.wrap(r.createRangeOn(m),w)}else if(l.parent.is("element","picture")){const c=l.parent;r.move(r.createRangeOn(l),r.createPositionBefore(c)),r.remove(c)}};return e=>{e.on("attribute:sources:imageBlock",t),e.on("attribute:sources:imageInline",t)}}function Bg(s,t,e){const i=(n,r,o)=>{if(!o.consumable.consume(r.item,n.name))return;const l=o.writer,a=o.mapper.toViewElement(r.item),c=s.findViewImgElement(a);l.setAttribute(r.attributeKey,r.attributeNewValue||"",c)};return n=>{n.on(`attribute:${e}:${t}`,i)}}class ky extends hr{observe(t){this.listenTo(t,"load",(e,i)=>{const n=i.target;this.checkShouldIgnoreEventFromTarget(n)||n.tagName=="IMG"&&this._fireEvents(i)},{useCapture:!0})}stopObserving(t){this.stopListening(t)}_fireEvents(t){this.isEnabled&&(this.document.fire("layoutChanged"),this.document.fire("imageLoaded",t))}}class IX extends Be{constructor(t){super(t);const e=t.config.get("image.insert.type");t.plugins.has("ImageBlockEditing")||e==="block"&&Ue("image-block-plugin-required"),t.plugins.has("ImageInlineEditing")||e==="inline"&&Ue("image-inline-plugin-required")}refresh(){const t=this.editor.plugins.get("ImageUtils");this.isEnabled=t.isImageAllowed()}execute(t){const e=dt(t.source),i=this.editor.model.document.selection,n=this.editor.plugins.get("ImageUtils"),r=Object.fromEntries(i.getAttributes());e.forEach((o,l)=>{const a=i.getSelectedElement();if(typeof o=="string"&&(o={src:o}),l&&a&&n.isImage(a)){const c=this.editor.model.createPositionAfter(a);n.insertImage({...o,...r},c,t.imageType)}else t.breakBlock?n.insertImage({...o,...r},i.getFirstPosition(),t.imageType):n.insertImage({...o,...r},null,t.imageType)})}}class RX extends Be{constructor(t){super(t),this.decorate("cleanupImage")}refresh(){const e=this.editor.plugins.get("ImageUtils"),i=this.editor.model.document.selection.getSelectedElement();this.isEnabled=e.isImage(i),this.value=this.isEnabled?i.getAttribute("src"):null}execute(t){const e=this.editor.model.document.selection.getSelectedElement(),i=this.editor.plugins.get("ImageUtils");this.editor.model.change(n=>{n.setAttribute("src",t.source,e),this.cleanupImage(n,e),i.setImageNaturalSizeAttributes(e)})}cleanupImage(t,e){t.removeAttribute("srcset",e),t.removeAttribute("sizes",e),t.removeAttribute("sources",e),t.removeAttribute("width",e),t.removeAttribute("height",e),t.removeAttribute("alt",e)}}class Sy extends F{static get requires(){return[_i]}static get pluginName(){return"ImageEditing"}static get isOfficialPlugin(){return!0}init(){const t=this.editor,e=t.conversion;t.editing.view.addObserver(ky),e.for("upcast").attributeToAttribute({view:{name:"img",key:"alt"},model:"alt"}).attributeToAttribute({view:{name:"img",key:"srcset"},model:"srcset"});const i=new IX(t),n=new RX(t);t.commands.add("insertImage",i),t.commands.add("replaceImageSource",n),t.commands.add("imageInsert",i)}}class w7 extends F{static get requires(){return[_i]}static get pluginName(){return"ImageSizeAttributes"}static get isOfficialPlugin(){return!0}afterInit(){this._registerSchema(),this._registerConverters("imageBlock"),this._registerConverters("imageInline")}_registerSchema(){this.editor.plugins.has("ImageBlockEditing")&&this.editor.model.schema.extend("imageBlock",{allowAttributes:["width","height"]}),this.editor.plugins.has("ImageInlineEditing")&&this.editor.model.schema.extend("imageInline",{allowAttributes:["width","height"]})}_registerConverters(t){const e=this.editor,i=e.plugins.get("ImageUtils"),n=t==="imageBlock"?"figure":"img";e.conversion.for("upcast").attributeToAttribute({view:{name:n,styles:{width:/.+/}},model:{key:"width",value:o=>Lg(o)?Mg(o.getStyle("width")):null}}).attributeToAttribute({view:{name:n,key:"width"},model:"width"}).attributeToAttribute({view:{name:n,styles:{height:/.+/}},model:{key:"height",value:o=>Lg(o)?Mg(o.getStyle("height")):null}}).attributeToAttribute({view:{name:n,key:"height"},model:"height"}),e.conversion.for("editingDowncast").add(o=>{r(o,"width","width",!0,!0),r(o,"height","height",!0,!0)}),e.conversion.for("dataDowncast").add(o=>{r(o,"width","width",!1),r(o,"height","height",!1)}),e.conversion.for("upcast").add(o=>{o.on("element:img",(l,a,c)=>{const h=a.viewItem.getAttribute("width"),f=a.viewItem.getAttribute("height");h&&f&&c.consumable.consume(a.viewItem,{styles:["aspect-ratio"]})})});function r(o,l,a,c,h=!1){o.on(`attribute:${l}:${t}`,(f,m,w)=>{if(!w.consumable.consume(m.item,f.name))return;const O=w.writer,_=w.mapper.toViewElement(m.item),k=i.findViewImgElement(_);m.attributeNewValue!==null?O.setAttribute(a,m.attributeNewValue,k):O.removeAttribute(a,k);const C=m.item.getAttribute("width"),P=m.item.getAttribute("height"),M=C&&P;if(M&&h&&O.setAttribute("loading","lazy",k),m.item.hasAttribute("sources"))return;const Q=m.item.hasAttribute("resizedWidth");t==="imageInline"&&!Q&&!c||M&&O.setStyle("aspect-ratio",`${C}/${P}`,k)})}}}class x7 extends Be{constructor(e,i){super(e);p(this,"_modelElementName");this._modelElementName=i}refresh(){const i=this.editor.plugins.get("ImageUtils"),n=i.getClosestSelectedImageElement(this.editor.model.document.selection);this._modelElementName==="imageBlock"?this.isEnabled=i.isInlineImage(n):this.isEnabled=i.isBlockImage(n)}execute(e={}){const i=this.editor,n=this.editor.model,r=i.plugins.get("ImageUtils"),o=r.getClosestSelectedImageElement(n.document.selection),l=Object.fromEntries(o.getAttributes());return!l.src&&!l.uploadId?null:n.change(a=>{const{setImageSizes:c=!0}=e,h=Array.from(n.markers).filter(w=>w.getRange().containsItem(o)),f=r.insertImage(l,n.createSelection(o,"on"),this._modelElementName,{setImageSizes:c});if(!f)return null;const m=a.createRangeOn(f);for(const w of h){const O=w.getRange(),_=O.root.rootName!="$graveyard"?O.getJoined(m,!0):m;a.updateMarker(w,{range:_})}return{oldElement:o,newElement:f}})}}class b7 extends F{static get requires(){return[_i]}static get pluginName(){return"ImagePlaceholder"}static get isOfficialPlugin(){return!0}afterInit(){this._setupSchema(),this._setupConversion(),this._setupLoadListener()}_setupSchema(){const t=this.editor.model.schema;t.isRegistered("imageBlock")&&t.extend("imageBlock",{allowAttributes:["placeholder"]}),t.isRegistered("imageInline")&&t.extend("imageInline",{allowAttributes:["placeholder"]})}_setupConversion(){const t=this.editor,e=t.conversion,i=t.plugins.get("ImageUtils");e.for("editingDowncast").add(n=>{n.on("attribute:placeholder",(r,o,l)=>{if(!l.consumable.test(o.item,r.name)||!o.item.is("element","imageBlock")&&!o.item.is("element","imageInline"))return;l.consumable.consume(o.item,r.name);const a=l.writer,c=l.mapper.toViewElement(o.item),h=i.findViewImgElement(c);o.attributeNewValue?(a.addClass("image_placeholder",h),a.setStyle("background-image",`url(${o.attributeNewValue})`,h),a.setCustomProperty("editingPipeline:doNotReuseOnce",!0,h)):(a.removeClass("image_placeholder",h),a.removeStyle("background-image",h))})})}_setupLoadListener(){const t=this.editor,e=t.model,i=t.editing,n=i.view,r=t.plugins.get("ImageUtils");n.addObserver(ky),this.listenTo(n.document,"imageLoaded",(o,l)=>{const a=n.domConverter.mapDomToView(l.target);if(!a)return;const c=r.getImageWidgetFromImageView(a);if(!c)return;const h=i.mapper.toModelElement(c);!h||!h.hasAttribute("placeholder")||e.enqueueChange({isUndoable:!1},f=>{f.removeAttribute("placeholder",h)})})}}class O7 extends F{static get requires(){return[Sy,w7,_i,b7,on]}static get pluginName(){return"ImageBlockEditing"}static get isOfficialPlugin(){return!0}init(){const t=this.editor;t.model.schema.register("imageBlock",{inheritAllFrom:"$blockObject",allowAttributes:["alt","src","srcset"]}),this._setupConversion(),t.plugins.has("ImageInlineEditing")&&(t.commands.add("imageTypeBlock",new x7(this.editor,"imageBlock")),this._setupClipboardIntegration())}_setupConversion(){const t=this.editor,e=t.t,i=t.conversion,n=t.plugins.get("ImageUtils");i.for("dataDowncast").elementToStructure({model:"imageBlock",view:(r,{writer:o})=>x5(o)}),i.for("editingDowncast").elementToStructure({model:"imageBlock",view:(r,{writer:o})=>n.toImageWidget(x5(o),o,e("image widget"))}),i.for("downcast").add(Bg(n,"imageBlock","src")).add(Bg(n,"imageBlock","alt")).add(p7(n,"imageBlock")),i.for("upcast").elementToElement({view:m7(t,"imageBlock"),model:(r,{writer:o})=>o.createElement("imageBlock",r.hasAttribute("src")?{src:r.getAttribute("src")}:void 0)}).add(TX(n))}_setupClipboardIntegration(){const t=this.editor,e=t.model,i=t.editing.view,n=t.plugins.get("ImageUtils"),r=t.plugins.get("ClipboardPipeline");this.listenTo(r,"inputTransformation",(o,l)=>{const a=Array.from(l.content.getChildren());let c;if(!a.every(n.isInlineImageView))return;l.targetRanges?c=t.editing.mapper.toModelRange(l.targetRanges[0]):c=e.document.selection.getFirstRange();const h=e.createSelection(c);if(yy(e.schema,h)==="imageBlock"){const f=new Cn(i.document),m=a.map(w=>f.createElement("figure",{class:"image"},w));l.content=f.createDocumentFragment(m)}}),this.listenTo(r,"contentInsertion",(o,l)=>{l.method==="paste"&&e.change(a=>{const c=a.createRangeIn(l.content);for(const h of c.getItems())h.is("element","imageBlock")&&n.setImageNaturalSizeAttributes(h)})})}}class VX extends ue{constructor(e,i=[]){super(e);p(this,"focusTracker");p(this,"keystrokes");p(this,"_focusables");p(this,"_focusCycler");p(this,"children");this.focusTracker=new ot,this.keystrokes=new wt,this._focusables=new fi,this.children=this.createCollection(),this._focusCycler=new Ht({focusables:this._focusables,focusTracker:this.focusTracker,keystrokeHandler:this.keystrokes,actions:{focusPrevious:"shift + tab",focusNext:"tab"}});for(const n of i)this.children.add(n),this._focusables.add(n),n instanceof pI&&this._focusables.addMany(n.children);this.setTemplate({tag:"form",attributes:{class:["ck","ck-image-insert-form"],tabindex:-1},children:this.children})}render(){super.render(),Wl({view:this});for(const i of this._focusables)this.focusTracker.add(i.element);this.keystrokes.listenTo(this.element);const e=i=>i.stopPropagation();this.keystrokes.set("arrowright",e),this.keystrokes.set("arrowleft",e),this.keystrokes.set("arrowup",e),this.keystrokes.set("arrowdown",e)}destroy(){super.destroy(),this.focusTracker.destroy(),this.keystrokes.destroy()}focus(){this._focusCycler.focusFirst()}}class md extends F{constructor(e){super(e);p(this,"dropdownView");p(this,"_integrations",new Map);e.config.define("image.insert.integrations",["upload","assetManager","url"])}static get pluginName(){return"ImageInsertUI"}static get isOfficialPlugin(){return!0}static get requires(){return[_i]}init(){const e=this.editor,i=e.model.document.selection,n=e.plugins.get("ImageUtils");this.set("isImageSelected",!1),this.listenTo(e.model.document,"change",()=>{this.isImageSelected=n.isImage(i.getSelectedElement())});const r=l=>this._createToolbarComponent(l),o=l=>this._createMenuBarComponent(l);e.ui.componentFactory.add("insertImage",r),e.ui.componentFactory.add("imageInsert",r),e.ui.componentFactory.add("menuBar:insertImage",o)}registerIntegration({name:e,observable:i,buttonViewCreator:n,formViewCreator:r,menuBarButtonViewCreator:o,requiresForm:l=!1,override:a=!1}){this._integrations.has(e)&&!a&&Ue("image-insert-integration-exists",{name:e}),this._integrations.set(e,{observable:i,buttonViewCreator:n,menuBarButtonViewCreator:o,formViewCreator:r,requiresForm:l})}_createToolbarComponent(e){const i=this.editor,n=e.t,r=this._prepareIntegrations();if(!r.length)return null;let o;const l=r[0];if(r.length==1){if(!l.requiresForm)return l.buttonViewCreator(!0);o=l.buttonViewCreator(!0)}else{const h=l.buttonViewCreator(!1);o=new Vc(e,h),o.tooltip=!0,o.bind("label").to(this,"isImageSelected",f=>n(f?"Replace image":"Insert image"))}const a=this.dropdownView=nn(e,o),c=r.map(({observable:h})=>typeof h=="function"?h():h);return a.bind("isEnabled").toMany(c,"isEnabled",(...h)=>h.some(f=>f)),a.once("change:isOpen",()=>{const h=r.flatMap(({formViewCreator:m})=>m(r.length==1)),f=new VX(i.locale,h);a.panelView.children.add(f)}),a}_createMenuBarComponent(e){const i=e.t,n=this._prepareIntegrations();if(!n.length)return null;const r=n.flatMap(({menuBarButtonViewCreator:a})=>a(n.length==1)),o=new cs(e),l=new Al(e);o.panelView.children.add(l),o.buttonView.set({icon:rz,label:i("Image")});for(const a of r){const c=new Tl(e,o);c.children.add(a),l.items.add(c),a.delegate("execute").to(o)}return o}_prepareIntegrations(){const i=this.editor.config.get("image.insert.integrations"),n=[];if(!i.length)return Ue("image-insert-integrations-not-specified"),n;for(const r of i){if(!this._integrations.has(r)){["upload","assetManager","url"].includes(r)||Ue("image-insert-unknown-integration",{item:r});continue}n.push(this._integrations.get(r))}return n.length||Ue("image-insert-integrations-not-registered"),n}}class MX extends F{static get requires(){return[O7,Lc,_y,md]}static get pluginName(){return"ImageBlock"}static get isOfficialPlugin(){return!0}}class LX extends F{static get requires(){return[Sy,w7,_i,b7,on]}static get pluginName(){return"ImageInlineEditing"}static get isOfficialPlugin(){return!0}init(){const t=this.editor;t.model.schema.register("imageInline",{inheritAllFrom:"$inlineObject",allowAttributes:["alt","src","srcset"],disallowIn:["caption"]}),this._setupConversion(),t.plugins.has("ImageBlockEditing")&&(t.commands.add("imageTypeInline",new x7(this.editor,"imageInline")),this._setupClipboardIntegration())}_setupConversion(){const t=this.editor,e=t.t,i=t.conversion,n=t.plugins.get("ImageUtils");i.for("dataDowncast").elementToElement({model:"imageInline",view:(r,{writer:o})=>o.createEmptyElement("img")}),i.for("editingDowncast").elementToStructure({model:"imageInline",view:(r,{writer:o})=>n.toImageWidget(pX(o),o,e("image widget"))}),i.for("downcast").add(Bg(n,"imageInline","src")).add(Bg(n,"imageInline","alt")).add(p7(n,"imageInline")),i.for("upcast").elementToElement({view:m7(t,"imageInline"),model:(r,{writer:o})=>o.createElement("imageInline",r.hasAttribute("src")?{src:r.getAttribute("src")}:void 0)})}_setupClipboardIntegration(){const t=this.editor,e=t.model,i=t.editing.view,n=t.plugins.get("ImageUtils"),r=t.plugins.get("ClipboardPipeline");this.listenTo(r,"inputTransformation",(o,l)=>{const a=Array.from(l.content.getChildren());let c;if(!a.every(n.isBlockImageView))return;l.targetRanges?c=t.editing.mapper.toModelRange(l.targetRanges[0]):c=e.document.selection.getFirstRange();const h=e.createSelection(c);if(yy(e.schema,h)==="imageInline"){const f=new Cn(i.document),m=a.map(w=>w.childCount===1?(Array.from(w.getAttributes()).forEach(O=>f.setAttribute(...O,n.findViewImgElement(w))),w.getChild(0)):w);l.content=f.createDocumentFragment(m)}}),this.listenTo(r,"contentInsertion",(o,l)=>{l.method==="paste"&&e.change(a=>{const c=a.createRangeIn(l.content);for(const h of c.getItems())h.is("element","imageInline")&&n.setImageNaturalSizeAttributes(h)})})}}class BX extends F{static get requires(){return[LX,Lc,_y,md]}static get pluginName(){return"ImageInline"}static get isOfficialPlugin(){return!0}}class y7 extends F{static get pluginName(){return"ImageCaptionUtils"}static get isOfficialPlugin(){return!0}static get requires(){return[_i]}getCaptionFromImageModelElement(t){for(const e of t.getChildren())if(e&&e.is("element","caption"))return e;return null}getCaptionFromModelSelection(t){const e=this.editor.plugins.get("ImageUtils"),i=t.getFirstPosition().findAncestor("caption");return i&&e.isBlockImage(i.parent)?i:null}matchImageCaptionViewElement(t){const e=this.editor.plugins.get("ImageUtils");return t.name=="figcaption"&&e.isBlockImageView(t.parent)?{name:!0}:null}}class $X extends Be{refresh(){const t=this.editor,e=t.plugins.get("ImageCaptionUtils"),i=t.plugins.get("ImageUtils");if(!t.plugins.has(O7)){this.isEnabled=!1,this.value=!1;return}const n=t.model.document.selection,r=n.getSelectedElement();if(!r){const o=e.getCaptionFromModelSelection(n);this.isEnabled=!!o,this.value=!!o;return}this.isEnabled=i.isImage(r),this.isEnabled?this.value=!!e.getCaptionFromImageModelElement(r):this.value=!1}execute(t={}){const{focusCaptionOnShow:e}=t;this.editor.model.change(i=>{this.value?this._hideImageCaption(i):this._showImageCaption(i,e)})}_showImageCaption(t,e){const n=this.editor.model.document.selection,r=this.editor.plugins.get("ImageCaptionEditing"),o=this.editor.plugins.get("ImageUtils");let l=n.getSelectedElement();const a=r._getSavedCaption(l);o.isInlineImage(l)&&(this.editor.execute("imageTypeBlock"),l=n.getSelectedElement());const c=a||t.createElement("caption");t.append(c,l),e&&t.setSelection(c,"in")}_hideImageCaption(t){const e=this.editor,i=e.model.document.selection,n=e.plugins.get("ImageCaptionEditing"),r=e.plugins.get("ImageCaptionUtils");let o=i.getSelectedElement(),l;o?l=r.getCaptionFromImageModelElement(o):(l=r.getCaptionFromModelSelection(i),o=l.parent),n._saveCaption(o,l),t.setSelection(o,"on"),t.remove(l)}}class DX extends F{constructor(e){super(e);p(this,"_savedCaptionsMap");this._savedCaptionsMap=new WeakMap}static get requires(){return[_i,y7]}static get pluginName(){return"ImageCaptionEditing"}static get isOfficialPlugin(){return!0}init(){const e=this.editor,i=e.model.schema;i.isRegistered("caption")?i.extend("caption",{allowIn:"imageBlock"}):i.register("caption",{allowIn:"imageBlock",allowContentOf:"$block",isLimit:!0}),e.commands.add("toggleImageCaption",new $X(this.editor)),this._setupConversion(),this._setupImageTypeCommandsIntegration(),this._registerCaptionReconversion()}_setupConversion(){const e=this.editor,i=e.editing.view,n=e.plugins.get("ImageUtils"),r=e.plugins.get("ImageCaptionUtils"),o=e.t;e.conversion.for("upcast").elementToElement({view:l=>r.matchImageCaptionViewElement(l),model:"caption"}),e.conversion.for("dataDowncast").elementToElement({model:"caption",view:(l,{writer:a})=>n.isBlockImage(l.parent)?a.createContainerElement("figcaption"):null}),e.conversion.for("editingDowncast").elementToElement({model:"caption",view:(l,{writer:a})=>{if(!n.isBlockImage(l.parent))return null;const c=a.createEditableElement("figcaption");a.setCustomProperty("imageCaption",!0,c),c.placeholder=o("Enter image caption"),FO({view:i,element:c,keepOnFocus:!0});const h=l.parent.getAttribute("alt"),f=h?o("Caption for image: %0",[h]):o("Caption for the image");return gy(c,a,{label:f})}})}_setupImageTypeCommandsIntegration(){const e=this.editor,i=e.plugins.get("ImageUtils"),n=e.plugins.get("ImageCaptionUtils"),r=e.commands.get("imageTypeInline"),o=e.commands.get("imageTypeBlock"),l=a=>{if(!a.return)return;const{oldElement:c,newElement:h}=a.return;/* istanbul ignore if: paranoid check -- @preserve */if(!c)return;if(i.isBlockImage(c)){const m=n.getCaptionFromImageModelElement(c);if(m){this._saveCaption(h,m);return}}const f=this._getSavedCaption(c);f&&this._saveCaption(h,f)};r&&this.listenTo(r,"execute",l,{priority:"low"}),o&&this.listenTo(o,"execute",l,{priority:"low"})}_getSavedCaption(e){const i=this._savedCaptionsMap.get(e);return i?Mt.fromJSON(i):null}_saveCaption(e,i){this._savedCaptionsMap.set(e,i.toJSON())}_registerCaptionReconversion(){const e=this.editor,i=e.model,n=e.plugins.get("ImageUtils"),r=e.plugins.get("ImageCaptionUtils");i.document.on("change:data",()=>{const o=i.document.differ.getChanges();for(const l of o){if(l.attributeKey!=="alt")continue;const a=l.range.start.nodeAfter;if(n.isBlockImage(a)){const c=r.getCaptionFromImageModelElement(a);if(!c)return;e.editing.reconvertItem(c)}}})}}class QX extends F{static get requires(){return[y7]}static get pluginName(){return"ImageCaptionUI"}static get isOfficialPlugin(){return!0}init(){const t=this.editor,e=t.editing.view,i=t.plugins.get("ImageCaptionUtils"),n=t.t;t.ui.componentFactory.add("toggleImageCaption",r=>{const o=t.commands.get("toggleImageCaption"),l=new ye(r);return l.set({icon:GA,tooltip:!0,isToggleable:!0}),l.bind("isOn","isEnabled").to(o,"value","isEnabled"),l.bind("label").to(o,"value",a=>n(a?"Toggle caption off":"Toggle caption on")),this.listenTo(l,"execute",()=>{t.execute("toggleImageCaption",{focusCaptionOnShow:!0});const a=i.getCaptionFromModelSelection(t.model.document.selection);if(a){const c=t.editing.mapper.toViewElement(a);e.scrollToTheSelection(),e.change(h=>{h.addClass("image__caption_highlighted",c)})}t.editing.view.focus()}),l})}}class NX extends F{static get requires(){return[DX,QX]}static get pluginName(){return"ImageCaption"}static get isOfficialPlugin(){return!0}}function v7(s){const t=s.map(e=>e.replace("+","\\+"));return new RegExp(`^image\\/(${t.join("|")})$`)}function FX(s){return new Promise((t,e)=>{const i=s.getAttribute("src");fetch(i).then(n=>n.blob()).then(n=>{const r=_7(n,i),l=`image.${r.replace("image/","")}`,a=new File([n],l,{type:r});t(a)}).catch(n=>n&&n.name==="TypeError"?WX(i).then(t).catch(e):e(n))})}function zX(s,t){return!s.isInlineImageView(t)||!t.getAttribute("src")?!1:!!t.getAttribute("src").match(/^data:image\/\w+;base64,/g)||!!t.getAttribute("src").match(/^blob:/g)}function _7(s,t){return s.type?s.type:t.match(/data:(image\/\w+);base64/)?t.match(/data:(image\/\w+);base64/)[1].toLowerCase():"image/jpeg"}function WX(s){return UX(s).then(t=>{const e=_7(t,s),n=`image.${e.replace("image/","")}`;return new File([t],n,{type:e})})}function UX(s){return new Promise((t,e)=>{const i=he.document.createElement("img");i.addEventListener("load",()=>{const n=he.document.createElement("canvas");n.width=i.width,n.height=i.height,n.getContext("2d").drawImage(i,0,0),n.toBlob(o=>o?t(o):e())}),i.addEventListener("error",()=>e()),i.src=s})}class ZX extends F{static get pluginName(){return"ImageUploadUI"}static get isOfficialPlugin(){return!0}init(){const t=this.editor;t.ui.componentFactory.add("uploadImage",()=>this._createToolbarButton()),t.ui.componentFactory.add("imageUpload",()=>this._createToolbarButton()),t.ui.componentFactory.add("menuBar:uploadImage",()=>this._createMenuBarButton("standalone")),t.plugins.has("ImageInsertUI")&&t.plugins.get("ImageInsertUI").registerIntegration({name:"upload",observable:()=>t.commands.get("uploadImage"),buttonViewCreator:()=>this._createToolbarButton(),formViewCreator:()=>this._createDropdownButton(),menuBarButtonViewCreator:e=>this._createMenuBarButton(e?"insertOnly":"insertNested")})}_createButton(t){const e=this.editor,i=e.locale,n=e.commands.get("uploadImage"),r=e.config.get("image.upload.types"),o=v7(r),l=new t(e.locale),a=i.t;return l.set({acceptedType:r.map(c=>`image/${c}`).join(","),allowMultipleFiles:!0,label:a("Upload from computer"),icon:oz}),l.bind("isEnabled").to(n),l.on("done",(c,h)=>{const f=Array.from(h).filter(m=>o.test(m.type));f.length&&(e.execute("uploadImage",{file:f}),e.editing.view.focus())}),l}_createToolbarButton(){const t=this.editor.locale.t,e=this.editor.plugins.get("ImageInsertUI"),i=this.editor.commands.get("uploadImage"),n=this._createButton(u2);return n.tooltip=!0,n.bind("label").to(e,"isImageSelected",i,"isAccessAllowed",(r,o)=>t(o?r?"Replace image from computer":"Upload image from computer":"You have no image upload permissions.")),n}_createDropdownButton(){const t=this.editor.locale.t,e=this.editor.plugins.get("ImageInsertUI"),i=this._createButton(u2);return i.withText=!0,i.bind("label").to(e,"isImageSelected",n=>t(n?"Replace from computer":"Upload from computer")),i.on("execute",()=>{e.dropdownView.isOpen=!1}),i}_createMenuBarButton(t){const e=this.editor.locale.t,i=this._createButton(FI);switch(i.withText=!0,t){case"standalone":i.label=e("Image from computer");break;case"insertOnly":i.label=e("Image");break;case"insertNested":i.label=e("From computer");break}return i}}class HX extends F{constructor(e){super(e);p(this,"placeholder");p(this,"uploadStatusChange",(e,i,n)=>{const r=this.editor,o=i.item,l=o.getAttribute("uploadId");if(!n.consumable.consume(i.item,e.name))return;const a=r.plugins.get("ImageUtils"),c=r.plugins.get(yo),h=l?i.attributeNewValue:null,f=this.placeholder,m=r.editing.mapper.toViewElement(o),w=n.writer;if(h=="reading"){b5(m,w),O5(a,f,m,w);return}if(h=="uploading"){const O=c.loaders.get(l);b5(m,w),O?(y5(m,w),jX(m,w,O,r.editing.view),JX(a,m,w,O)):O5(a,f,m,w);return}h=="complete"&&c.loaders.get(l)&&GX(m,w,r.editing.view),XX(m,w),y5(m,w),qX(m,w)});this.placeholder="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw=="}static get pluginName(){return"ImageUploadProgress"}static get isOfficialPlugin(){return!0}init(){const e=this.editor;e.plugins.has("ImageBlockEditing")&&e.editing.downcastDispatcher.on("attribute:uploadStatus:imageBlock",this.uploadStatusChange),e.plugins.has("ImageInlineEditing")&&e.editing.downcastDispatcher.on("attribute:uploadStatus:imageInline",this.uploadStatusChange)}}function b5(s,t){s.hasClass("ck-appear")||t.addClass("ck-appear",s)}function qX(s,t){t.removeClass("ck-appear",s)}function O5(s,t,e,i){e.hasClass("ck-image-upload-placeholder")||i.addClass("ck-image-upload-placeholder",e);const n=s.findViewImgElement(e);n.getAttribute("src")!==t&&i.setAttribute("src",t,n),k7(e,"placeholder")||i.insert(i.createPositionAfter(n),KX(i))}function y5(s,t){s.hasClass("ck-image-upload-placeholder")&&t.removeClass("ck-image-upload-placeholder",s),S7(s,t,"placeholder")}function jX(s,t,e,i){const n=YX(t);t.insert(t.createPositionAt(s,"end"),n),e.on("change:uploadedPercent",(r,o,l)=>{i.change(a=>{a.setStyle("width",l+"%",n)})})}function XX(s,t){S7(s,t,"progressBar")}function GX(s,t,e){const i=t.createUIElement("div",{class:"ck-image-upload-complete-icon"});t.insert(t.createPositionAt(s,"end"),i),setTimeout(()=>{e.change(n=>n.remove(n.createRangeOn(i)))},3e3)}function YX(s){const t=s.createUIElement("div",{class:"ck-progress-bar"});return s.setCustomProperty("progressBar",!0,t),t}function KX(s){const t=s.createUIElement("div",{class:"ck-upload-placeholder-loader"});return s.setCustomProperty("placeholder",!0,t),t}function k7(s,t){for(const e of s.getChildren())if(e.getCustomProperty(t))return e}function S7(s,t,e){const i=k7(s,e);i&&t.remove(t.createRangeOn(i))}function JX(s,t,e,i){if(i.data){const n=s.findViewImgElement(t);e.setAttribute("src",i.data,n)}}class eG extends Be{constructor(t){super(t),this.set("isAccessAllowed",!0)}refresh(){const t=this.editor,e=t.plugins.get("ImageUtils"),i=t.model.document.selection.getSelectedElement();this.isEnabled=e.isImageAllowed()||e.isImage(i)}execute(t){const e=dt(t.file),i=this.editor.model.document.selection,n=this.editor.plugins.get("ImageUtils"),r=Object.fromEntries(i.getAttributes());e.forEach((o,l)=>{const a=i.getSelectedElement();if(l&&a&&n.isImage(a)){const c=this.editor.model.createPositionAfter(a);this._uploadImage(o,r,c)}else this._uploadImage(o,r)})}_uploadImage(t,e,i){const n=this.editor,o=n.plugins.get(yo).createLoader(t),l=n.plugins.get("ImageUtils");o&&l.insertImage({...e,uploadId:o.id},i)}}class tG extends F{constructor(e){super(e);p(this,"_uploadImageElements");p(this,"_uploadedImages",new Map);e.config.define("image",{upload:{types:["jpeg","png","gif","bmp","webp","tiff"]}}),this._uploadImageElements=new Map}static get requires(){return[yo,Mh,on,_i]}static get pluginName(){return"ImageUploadEditing"}static get isOfficialPlugin(){return!0}init(){const e=this.editor,i=e.model.document,n=e.conversion,r=e.plugins.get(yo),o=e.plugins.get("ImageUtils"),l=e.plugins.get("ClipboardPipeline"),a=v7(e.config.get("image.upload.types")),c=new eG(e);e.commands.add("uploadImage",c),e.commands.add("imageUpload",c),n.for("upcast").attributeToAttribute({view:{name:"img",key:"uploadId"},model:"uploadId"}).add(h=>h.on("element:img",(f,m,w)=>{if(!w.consumable.test(m.viewItem,{attributes:["data-ck-upload-id"]}))return;const O=m.viewItem.getAttribute("data-ck-upload-id");if(!O)return;const[_]=Array.from(m.modelRange.getItems({shallow:!0})),k=r.loaders.get(O);_&&(w.writer.setAttribute("uploadId",O,_),w.consumable.consume(m.viewItem,{attributes:["data-ck-upload-id"]}),k&&k.data&&w.writer.setAttribute("uploadStatus",k.status,_))},{priority:"low"})),this.listenTo(e.editing.view.document,"clipboardInput",(h,f)=>{if(iG(f.dataTransfer))return;const m=Array.from(f.dataTransfer.files).filter(O=>O?a.test(O.type):!1);if(!m.length)return;if(h.stop(),e.model.change(O=>{f.targetRanges&&O.setSelection(f.targetRanges.map(_=>e.editing.mapper.toModelRange(_))),e.execute("uploadImage",{file:m})}),!e.commands.get("uploadImage").isAccessAllowed){const O=e.plugins.get("Notification"),_=e.locale.t;O.showWarning(_("You have no image upload permissions."),{namespace:"image"})}}),this.listenTo(l,"inputTransformation",(h,f)=>{const m=Array.from(e.editing.view.createRangeIn(f.content)).map(O=>O.item).filter(O=>zX(o,O)&&!O.getAttribute("uploadProcessed")).map(O=>({promise:FX(O),imageElement:O}));if(!m.length)return;const w=new Cn(e.editing.view.document);for(const O of m){w.setAttribute("uploadProcessed",!0,O.imageElement);const _=r.createLoader(O.promise);_&&(w.setAttribute("src","",O.imageElement),w.setAttribute("uploadId",_.id,O.imageElement))}}),e.editing.view.document.on("dragover",(h,f)=>{f.preventDefault()}),i.on("change",()=>{const h=i.differ.getChanges({includeChangesInGraveyard:!0}).reverse(),f=new Set;for(const m of h)if(m.type=="insert"&&m.name!="$text"){const w=m.position.nodeAfter,O=m.position.root.rootName=="$graveyard";for(const _ of nG(e,w)){const k=_.getAttribute("uploadId");if(!k)continue;const C=r.loaders.get(k);if(!C){!O&&this._uploadedImages.has(k)&&e.model.enqueueChange({isUndoable:!1},P=>{P.setAttribute("uploadStatus","complete",_),this.fire("uploadComplete",{data:this._uploadedImages.get(k),imageElement:_})});continue}O?f.has(k)||Array.from(this._uploadImageElements.get(k)).every(M=>M.root.rootName=="$graveyard")&&C.abort():(f.add(k),this._uploadImageElements.has(k)?this._uploadImageElements.get(k).add(_):this._uploadImageElements.set(k,new Set([_])),C.status=="idle"&&this._readAndUpload(C))}}}),this.on("uploadComplete",(h,{imageElement:f,data:m})=>{const w=m.urls?m.urls:m;this.editor.model.change(O=>{O.setAttribute("src",w.default,f),this._parseAndSetSrcsetAttributeOnImage(w,f,O),o.setImageNaturalSizeAttributes(f)})},{priority:"low"})}afterInit(){const e=this.editor.model.schema;this.editor.plugins.has("ImageBlockEditing")&&(e.extend("imageBlock",{allowAttributes:["uploadId","uploadStatus"]}),this._registerConverters("imageBlock")),this.editor.plugins.has("ImageInlineEditing")&&(e.extend("imageInline",{allowAttributes:["uploadId","uploadStatus"]}),this._registerConverters("imageInline"))}_readAndUpload(e){const i=this.editor,n=i.model,r=i.locale.t,o=i.plugins.get(yo),l=i.plugins.get(Mh),a=i.plugins.get("ImageUtils"),c=this._uploadImageElements;return n.enqueueChange({isUndoable:!1},f=>{const m=c.get(e.id);for(const w of m)f.setAttribute("uploadStatus","reading",w)}),e.read().then(()=>{const f=e.upload();i.ui&&i.ui.ariaLiveAnnouncer.announce(r("Uploading image"));for(const m of c.get(e.id)){/* istanbul ignore next -- @preserve */if(Ie.isSafari){const w=i.editing.mapper.toViewElement(m),O=a.findViewImgElement(w);i.editing.view.once("render",()=>{if(!O.parent)return;const _=i.editing.view.domConverter.mapViewToDom(O.parent);if(!_)return;const k=_.style.display;_.style.display="none",_._ckHack=_.offsetHeight,_.style.display=k})}n.enqueueChange({isUndoable:!1},w=>{w.setAttribute("uploadStatus","uploading",m)})}return f}).then(f=>{n.enqueueChange({isUndoable:!1},m=>{for(const w of c.get(e.id))m.setAttribute("uploadStatus","complete",w),this.fire("uploadComplete",{data:f,imageElement:w});i.ui&&i.ui.ariaLiveAnnouncer.announce(r("Image upload complete")),this._uploadedImages.set(e.id,f)}),h()}).catch(f=>{if(i.ui&&i.ui.ariaLiveAnnouncer.announce(r("Error during image upload")),e.status!=="error"&&e.status!=="aborted")throw f;e.status=="error"&&f&&l.showWarning(f,{title:r("Upload failed"),namespace:"upload"}),n.enqueueChange({isUndoable:!1},m=>{for(const w of c.get(e.id))w.root.rootName!=="$graveyard"&&m.remove(w)}),h()});function h(){n.enqueueChange({isUndoable:!1},f=>{for(const m of c.get(e.id))f.removeAttribute("uploadId",m),f.removeAttribute("uploadStatus",m);c.delete(e.id)}),o.destroyLoader(e)}}_parseAndSetSrcsetAttributeOnImage(e,i,n){let r=0;const o=Object.keys(e).filter(l=>{const a=parseInt(l,10);if(!isNaN(a))return r=Math.max(r,a),!0}).map(l=>`${e[l]} ${l}w`).join(", ");if(o!=""){const l={srcset:o};!i.hasAttribute("width")&&!i.hasAttribute("height")&&(l.width=r),n.setAttributes(l,i)}}_registerConverters(e){const{conversion:i,plugins:n}=this.editor,r=n.get(yo),o=n.get(_i);i.for("dataDowncast").add(l=>{l.on(`attribute:uploadId:${e}`,(a,c,h)=>{if(!h.consumable.test(c.item,a.name))return;const f=r.loaders.get(c.attributeNewValue);if(!f||!f.data)return null;const m=h.mapper.toViewElement(c.item),w=o.findViewImgElement(m);w&&(h.consumable.consume(c.item,a.name),h.writer.setAttribute("data-ck-upload-id",f.id,w))})})}}function iG(s){return Array.from(s.types).includes("text/html")&&s.getData("text/html")!==""}function nG(s,t){const e=s.plugins.get("ImageUtils");return Array.from(s.model.createRangeOn(t)).filter(i=>e.isImage(i.item)).map(i=>i.item)}class C7 extends F{static get pluginName(){return"ImageUpload"}static get isOfficialPlugin(){return!0}static get requires(){return[tG,ZX,HX]}}class sG extends ue{constructor(e){super(e);p(this,"urlInputView");p(this,"keystrokes");this.set("imageURLInputValue",""),this.set("isImageSelected",!1),this.set("isEnabled",!0),this.keystrokes=new wt,this.urlInputView=this._createUrlInputView(),this.setTemplate({tag:"form",attributes:{class:["ck","ck-image-insert-url"],tabindex:"-1"},children:[this.urlInputView,{tag:"div",attributes:{class:["ck","ck-image-insert-url__action-row"]}}]})}render(){super.render(),Wl({view:this}),this.keystrokes.listenTo(this.element)}destroy(){super.destroy(),this.keystrokes.destroy()}_createUrlInputView(){const e=this.locale,i=e.t,n=new Yt(e,On);return n.bind("label").to(this,"isImageSelected",r=>i(r?"Update image URL":"Insert image via URL")),n.bind("isEnabled").to(this),n.fieldView.inputMode="url",n.fieldView.placeholder="https://example.com/image.png",n.fieldView.bind("value").to(this,"imageURLInputValue",r=>r||""),n.fieldView.on("input",()=>{this.imageURLInputValue=n.fieldView.element.value.trim()}),n}focus(){this.urlInputView.focus()}}class rG extends F{constructor(){super(...arguments);p(this,"_imageInsertUI");p(this,"_formView")}static get pluginName(){return"ImageInsertViaUrlUI"}static get isOfficialPlugin(){return!0}static get requires(){return[md,Pl]}init(){this.editor.ui.componentFactory.add("insertImageViaUrl",()=>this._createToolbarButton()),this.editor.ui.componentFactory.add("menuBar:insertImageViaUrl",()=>this._createMenuBarButton("standalone"))}afterInit(){this._imageInsertUI=this.editor.plugins.get("ImageInsertUI"),this._imageInsertUI.registerIntegration({name:"url",observable:()=>this.editor.commands.get("insertImage"),buttonViewCreator:()=>this._createToolbarButton(),formViewCreator:()=>this._createDropdownButton(),menuBarButtonViewCreator:e=>this._createMenuBarButton(e?"insertOnly":"insertNested")})}_createInsertUrlButton(e){const i=new e(this.editor.locale);return i.icon=lz,i.on("execute",()=>{this._showModal()}),i}_createToolbarButton(){const e=this.editor.locale.t,i=this._createInsertUrlButton(ye);return i.tooltip=!0,i.bind("label").to(this._imageInsertUI,"isImageSelected",n=>e(n?"Update image URL":"Insert image via URL")),i}_createDropdownButton(){const e=this.editor.locale.t,i=this._createInsertUrlButton(ye);return i.withText=!0,i.bind("label").to(this._imageInsertUI,"isImageSelected",n=>e(n?"Update image URL":"Insert via URL")),i}_createMenuBarButton(e){const i=this.editor.locale.t,n=this._createInsertUrlButton(ti);switch(n.withText=!0,e){case"standalone":n.label=i("Image via URL");break;case"insertOnly":n.label=i("Image");break;case"insertNested":n.label=i("Via URL");break}return n}_createInsertUrlView(){const e=this.editor,i=e.locale,n=e.commands.get("replaceImageSource"),r=e.commands.get("insertImage"),o=new sG(i);return o.bind("isImageSelected").to(this._imageInsertUI),o.bind("isEnabled").toMany([r,n],"isEnabled",(...l)=>l.some(a=>a)),o}_showModal(){const e=this.editor,n=e.locale.t,r=e.plugins.get("Dialog");this._formView||(this._formView=this._createInsertUrlView(),this._formView.on("submit",()=>this._handleSave()));const o=e.commands.get("replaceImageSource");this._formView.imageURLInputValue=o.value||"",r.show({id:"insertImageViaUrl",title:n("Image via URL"),isModal:!0,content:this._formView,actionButtons:[{label:n("Cancel"),withText:!0,onExecute:()=>r.hide()},{label:this._imageInsertUI.isImageSelected?n("Save"):n("Insert"),class:"ck-button-action",withText:!0,onExecute:()=>this._handleSave()}]})}_handleSave(){this.editor.commands.get("replaceImageSource").isEnabled?this.editor.execute("replaceImageSource",{source:this._formView.imageURLInputValue}):this.editor.execute("insertImage",{source:this._formView.imageURLInputValue}),this.editor.plugins.get("Dialog").hide()}}class P7 extends F{static get pluginName(){return"ImageInsertViaUrl"}static get isOfficialPlugin(){return!0}static get requires(){return[rG,md]}}class oG extends F{static get pluginName(){return"ImageInsert"}static get isOfficialPlugin(){return!0}static get requires(){return[C7,P7,md]}}class lG extends Be{refresh(){const t=this.editor,i=t.plugins.get("ImageUtils").getClosestSelectedImageElement(t.model.document.selection);this.isEnabled=!!i,!i||!i.hasAttribute("resizedWidth")?this.value=null:this.value={width:i.getAttribute("resizedWidth"),height:null}}execute(t){const e=this.editor,i=e.model,n=e.plugins.get("ImageUtils"),r=n.getClosestSelectedImageElement(i.document.selection);this.value={width:t.width,height:null},r&&i.change(o=>{o.setAttribute("resizedWidth",t.width,r),o.removeAttribute("resizedHeight",r),n.setImageNaturalSizeAttributes(r)})}}class T7 extends F{static get requires(){return[_i]}static get pluginName(){return"ImageResizeEditing"}static get isOfficialPlugin(){return!0}constructor(t){super(t),t.config.define("image",{resizeUnit:"%",resizeOptions:[{name:"resizeImage:original",value:null,icon:"original"},{name:"resizeImage:custom",value:"custom",icon:"custom"},{name:"resizeImage:25",value:"25",icon:"small"},{name:"resizeImage:50",value:"50",icon:"medium"},{name:"resizeImage:75",value:"75",icon:"large"}]})}init(){const t=this.editor,e=new lG(t);this._registerConverters("imageBlock"),this._registerConverters("imageInline"),t.commands.add("resizeImage",e),t.commands.add("imageResize",e)}afterInit(){this._registerSchema()}_registerSchema(){this.editor.plugins.has("ImageBlockEditing")&&this.editor.model.schema.extend("imageBlock",{allowAttributes:["resizedWidth","resizedHeight"]}),this.editor.plugins.has("ImageInlineEditing")&&this.editor.model.schema.extend("imageInline",{allowAttributes:["resizedWidth","resizedHeight"]})}_registerConverters(t){const e=this.editor,i=e.plugins.get("ImageUtils");e.conversion.for("downcast").add(n=>n.on(`attribute:resizedWidth:${t}`,(r,o,l)=>{if(!l.consumable.consume(o.item,r.name))return;const a=l.writer,c=l.mapper.toViewElement(o.item);o.attributeNewValue!==null?(a.setStyle("width",o.attributeNewValue,c),a.addClass("image_resized",c)):(a.removeStyle("width",c),a.removeClass("image_resized",c))})),e.conversion.for("dataDowncast").attributeToAttribute({model:{name:t,key:"resizedHeight"},view:n=>({key:"style",value:{height:n}})}),e.conversion.for("editingDowncast").add(n=>n.on(`attribute:resizedHeight:${t}`,(r,o,l)=>{if(!l.consumable.consume(o.item,r.name))return;const a=l.writer,c=l.mapper.toViewElement(o.item),h=t==="imageInline"?i.findViewImgElement(c):c;o.attributeNewValue!==null?a.setStyle("height",o.attributeNewValue,h):a.removeStyle("height",h)})),e.conversion.for("upcast").attributeToAttribute({view:{name:t==="imageBlock"?"figure":"img",styles:{width:/.+/}},model:{key:"resizedWidth",value:n=>Lg(n)?null:n.getStyle("width")}}),e.conversion.for("upcast").attributeToAttribute({view:{name:t==="imageBlock"?"figure":"img",styles:{height:/.+/}},model:{key:"resizedHeight",value:n=>Lg(n)?null:n.getStyle("height")}}),e.conversion.for("upcast").add(n=>{n.on(`element:${t==="imageBlock"?"figure":"img"}`,(r,o,l)=>{l.consumable.consume(o.viewItem,{classes:["image_resized"]})})})}}const Rx={small:Sz,medium:kz,large:_z,custom:yz,original:vz};class aG extends F{constructor(e){super(e);p(this,"_resizeUnit");this._resizeUnit=e.config.get("image.resizeUnit")}static get requires(){return[T7]}static get pluginName(){return"ImageResizeButtons"}static get isOfficialPlugin(){return!0}init(){const e=this.editor,i=e.config.get("image.resizeOptions"),n=e.commands.get("resizeImage");this.bind("isEnabled").to(n);for(const r of i)this._registerImageResizeButton(r);this._registerImageResizeDropdown(i)}_registerImageResizeButton(e){const i=this.editor,{name:n,value:r,icon:o}=e;i.ui.componentFactory.add(n,l=>{const a=new ye(l),c=i.commands.get("resizeImage"),h=this._getOptionLabelValue(e,!0);if(!Rx[o])throw new E("imageresizebuttons-missing-icon",i,e);if(a.set({label:h,icon:Rx[o],tooltip:h,isToggleable:!0}),a.bind("isEnabled").to(this),i.plugins.has("ImageCustomResizeUI")&&Mu(e)){const f=i.plugins.get("ImageCustomResizeUI");this.listenTo(a,"execute",()=>{f._showForm(this._resizeUnit)})}else{const f=r?r+this._resizeUnit:null;a.bind("isOn").to(c,"value",c,"isEnabled",Jb(f)),this.listenTo(a,"execute",()=>{i.execute("resizeImage",{width:f})})}return a})}_registerImageResizeDropdown(e){const i=this.editor,n=i.t,r=e.find(l=>!l.value),o=l=>{const a=i.commands.get("resizeImage"),c=nn(l,_I),h=c.buttonView,f=n("Resize image");return h.set({tooltip:f,commandValue:r.value,icon:Rx.medium,isToggleable:!0,label:this._getOptionLabelValue(r),withText:!0,class:"ck-resize-image-button",ariaLabel:f,ariaLabelledBy:void 0}),h.bind("label").to(a,"value",m=>m&&m.width?m.width:this._getOptionLabelValue(r)),c.bind("isEnabled").to(this),Zl(c,()=>this._getResizeDropdownListItemDefinitions(e,a),{ariaLabel:n("Image resize list"),role:"menu"}),this.listenTo(c,"execute",m=>{"onClick"in m.source?m.source.onClick():(i.execute(m.source.commandName,{width:m.source.commandValue}),i.editing.view.focus())}),c};i.ui.componentFactory.add("resizeImage",o),i.ui.componentFactory.add("imageResize",o)}_getOptionLabelValue(e,i=!1){const n=this.editor.t;return e.label?e.label:i?Mu(e)?n("Custom image size"):e.value?n("Resize image to %0",e.value+this._resizeUnit):n("Resize image to the original size"):Mu(e)?n("Custom"):e.value?e.value+this._resizeUnit:n("Original")}_getResizeDropdownListItemDefinitions(e,i){const{editor:n}=this,r=new di,o=e.map(l=>Mu(l)?{...l,valueWithUnits:"custom"}:l.value?{...l,valueWithUnits:`${l.value}${this._resizeUnit}`}:{...l,valueWithUnits:null});for(const l of o){let a=null;if(n.plugins.has("ImageCustomResizeUI")&&Mu(l)){const c=n.plugins.get("ImageCustomResizeUI");a={type:"button",model:new El({label:this._getOptionLabelValue(l),role:"menuitemradio",withText:!0,icon:null,onClick:()=>{c._showForm(this._resizeUnit)}})};const h=Object.values(o).map(f=>f.valueWithUnits);a.model.bind("isOn").to(i,"value",i,"isEnabled",cG(h))}else a={type:"button",model:new El({commandName:"resizeImage",commandValue:l.valueWithUnits,label:this._getOptionLabelValue(l),role:"menuitemradio",withText:!0,icon:null})},a.model.bind("isOn").to(i,"value",i,"isEnabled",Jb(l.valueWithUnits));a.model.bind("isEnabled").to(i,"isEnabled"),r.add(a)}return r}}function Mu(s){return s.value==="custom"}function Jb(s){return(t,e)=>{const i=t;return i===void 0||!e?!1:s===null&&i===s?!0:i!==null&&i.width===s}}function cG(s){return(t,e)=>!s.some(i=>Jb(i)(t,e))}const uG="figure.image.ck-widget > img,figure.image.ck-widget > picture > img,figure.image.ck-widget > a > img,figure.image.ck-widget > a > picture > img,span.image-inline.ck-widget > img,span.image-inline.ck-widget > picture > img",Vx="image_resized";class hG extends F{static get requires(){return[yx,_i]}static get pluginName(){return"ImageResizeHandles"}static get isOfficialPlugin(){return!0}init(){const t=this.editor.commands.get("resizeImage");this.bind("isEnabled").to(t),this._setupResizerCreator()}_setupResizerCreator(){const t=this.editor,e=t.editing.view,i=t.plugins.get("ImageUtils");e.addObserver(ky),this.listenTo(e.document,"imageLoaded",(n,r)=>{if(!r.target.matches(uG))return;const o=t.editing.view.domConverter,l=o.domToView(r.target),a=i.getImageWidgetFromImageView(l);let c=this.editor.plugins.get(yx).getResizerByViewElement(a);if(c){c.redraw();return}const h=t.editing.mapper,f=h.toModelElement(a);c=t.plugins.get(yx).attachTo({unit:t.config.get("image.resizeUnit"),modelElement:f,viewElement:a,editor:t,getHandleHost(m){return m.querySelector("img")},getResizeHost(){return o.mapViewToDom(h.toViewElement(f))},isCentered(){return f.getAttribute("imageStyle")=="alignCenter"},onCommit(m){e.change(w=>{w.removeClass(Vx,a)}),t.execute("resizeImage",{width:m})}}),c.on("updateSize",()=>{a.hasClass(Vx)||e.change(w=>{w.addClass(Vx,a)});const m=f.name==="imageInline"?l:a;m.getStyle("height")&&e.change(w=>{w.removeStyle("height",m)})}),c.bind("isEnabled").to(this)})}}/**
 * @license Copyright (c) 2003-2025, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options
 */function E7(s){if(!s)return null;const[,t,e]=s.trim().match(/([.,\d]+)(%|px)$/)||[],i=Number.parseFloat(t);return Number.isNaN(i)?null:{value:i,unit:e}}function A7(s,t,e){return e==="px"?{value:t.value,unit:"px"}:{value:t.value/s*100,unit:"%"}}/**
 * @license Copyright (c) 2003-2025, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options
 */function I7(s){const{editing:t}=s,i=s.plugins.get("ImageUtils").getClosestSelectedImageElement(s.model.document.selection);if(!i)return null;const n=t.mapper.toViewElement(i),r=t.view.domConverter.mapViewToDom(n);return{model:i,view:n,dom:r}}function dG(s,t){const e=I7(s);if(!e)return null;const i=E7(e.model.getAttribute("resizedWidth")||null);if(!i)return null;if(i.unit===t)return i;const n=py(e.dom),r={value:new Ve(e.dom).width};return A7(n,r,t)}class fG extends ue{constructor(e,i,n){super(e);p(this,"focusTracker");p(this,"keystrokes");p(this,"unit");p(this,"backButtonView");p(this,"saveButtonView");p(this,"labeledInput");p(this,"children");p(this,"_focusables");p(this,"_focusCycler");p(this,"_validators");this.focusTracker=new ot,this.keystrokes=new wt,this.unit=i,this.backButtonView=this._createBackButton(),this.saveButtonView=this._createSaveButton(),this.labeledInput=this._createLabeledInputView(),this.children=this.createCollection([this._createHeaderView()]),this.children.add(new Ei(e,{children:[this.labeledInput,this.saveButtonView],class:["ck-form__row_with-submit","ck-form__row_large-top-padding"]})),this._focusables=new fi,this._validators=n,this.keystrokes.set("Esc",(r,o)=>{this.fire("cancel"),o()}),this._focusCycler=new Ht({focusables:this._focusables,focusTracker:this.focusTracker,keystrokeHandler:this.keystrokes,actions:{focusPrevious:"shift + tab",focusNext:"tab"}}),this.setTemplate({tag:"form",attributes:{class:["ck","ck-form","ck-image-custom-resize-form","ck-responsive-form"],tabindex:"-1"},children:this.children})}render(){super.render(),Wl({view:this}),[this.backButtonView,this.labeledInput,this.saveButtonView].forEach(i=>{this._focusables.add(i),this.focusTracker.add(i.element)}),this.keystrokes.listenTo(this.element)}destroy(){super.destroy(),this.focusTracker.destroy(),this.keystrokes.destroy()}_createBackButton(){const e=this.locale.t,i=new ye(this.locale);return i.set({class:"ck-button-back",label:e("Back"),icon:zl,tooltip:!0}),i.delegate("execute").to(this,"cancel"),i}_createSaveButton(){const e=this.locale.t,i=new ye(this.locale);return i.set({label:e("Save"),withText:!0,type:"submit",class:"ck-button-action ck-button-bold"}),i}_createHeaderView(){const e=this.locale.t,i=new zr(this.locale,{label:e("Image Resize")});return i.children.add(this.backButtonView,0),i}_createLabeledInputView(){const e=this.locale.t,i=new Yt(this.locale,II);return i.label=e("Resize image (in %0)",this.unit),i.class="ck-labeled-field-view_full-width",i.fieldView.set({step:.1}),i}isValid(){this.resetFormStatus();for(const e of this._validators){const i=e(this);if(i)return this.labeledInput.errorText=i,!1}return!0}resetFormStatus(){this.labeledInput.errorText=null}get rawSize(){const{element:e}=this.labeledInput.fieldView;return e?e.value:null}get parsedSize(){const{rawSize:e}=this;if(e===null)return null;const i=Number.parseFloat(e);return Number.isNaN(i)?null:i}get sizeWithUnits(){const{parsedSize:e,unit:i}=this;return e===null?null:`${e}${i}`}}function mG(s,t){const e=I7(s);if(!e)return null;const i=py(e.dom),n=E7(window.getComputedStyle(e.dom).minWidth)||{value:1},r=Math.max(.1,A7(i,n,t).value);return{unit:t,lower:r,upper:t==="px"?i:100}}class gG extends F{constructor(){super(...arguments);p(this,"_balloon");p(this,"_form")}static get requires(){return[gs]}static get pluginName(){return"ImageCustomResizeUI"}static get isOfficialPlugin(){return!0}destroy(){super.destroy(),this._form&&this._form.destroy()}_createForm(e){const i=this.editor;this._balloon=this.editor.plugins.get("ContextualBalloon"),this._form=new(_g(fG))(i.locale,e,pG(i)),this._form.render(),this.listenTo(this._form,"submit",()=>{this._form.isValid()&&(i.execute("resizeImage",{width:this._form.sizeWithUnits}),this._hideForm(!0))}),this.listenTo(this._form.labeledInput,"change:errorText",()=>{i.ui.update()}),this.listenTo(this._form,"cancel",()=>{this._hideForm(!0)}),Fr({emitter:this._form,activator:()=>this._isVisible,contextElements:()=>[this._balloon.view.element],callback:()=>this._hideForm()})}_showForm(e){if(this._isVisible)return;this._form||this._createForm(e);const i=this.editor,n=this._form.labeledInput;this._form.disableCssTransitions(),this._form.resetFormStatus(),this._isInBalloon||this._balloon.add({view:this._form,position:vy(i)});const r=dG(i,e),o=r?r.value.toFixed(1):"",l=mG(i,e);n.fieldView.value=n.fieldView.element.value=o,l&&Object.assign(n.fieldView,{min:l.lower.toFixed(1),max:Math.ceil(l.upper).toFixed(1)}),this._form.labeledInput.fieldView.select(),this._form.enableCssTransitions()}_hideForm(e=!1){this._isInBalloon&&(this._form.focusTracker.isFocused&&this._form.saveButtonView.focus(),this._balloon.remove(this._form),e&&this.editor.editing.view.focus())}get _isVisible(){return!!this._balloon&&this._balloon.visibleView===this._form}get _isInBalloon(){return!!this._balloon&&this._balloon.hasView(this._form)}}function pG(s){const t=s.t;return[e=>{if(e.rawSize.trim()==="")return t("The value must not be empty.");if(e.parsedSize===null)return t("The value should be a plain number.")}]}class wG extends F{static get requires(){return[T7,hG,gG,aG]}static get pluginName(){return"ImageResize"}static get isOfficialPlugin(){return!0}}class xG extends Be{constructor(e,i){super(e);p(this,"_defaultStyles");p(this,"_styles");this._defaultStyles={imageBlock:!1,imageInline:!1},this._styles=new Map(i.map(n=>{if(n.isDefault)for(const r of n.modelElements)this._defaultStyles[r]=n.name;return[n.name,n]}))}refresh(){const n=this.editor.plugins.get("ImageUtils").getClosestSelectedImageElement(this.editor.model.document.selection);this.isEnabled=!!n,this.isEnabled?n.hasAttribute("imageStyle")?this.value=n.getAttribute("imageStyle"):this.value=this._defaultStyles[n.name]:this.value=!1}execute(e={}){const i=this.editor,n=i.model,r=i.plugins.get("ImageUtils");n.change(o=>{const l=e.value,{setImageSizes:a=!0}=e;let c=r.getClosestSelectedImageElement(n.document.selection);l&&this.shouldConvertImageType(l,c)&&(this.editor.execute(r.isBlockImage(c)?"imageTypeInline":"imageTypeBlock",{setImageSizes:a}),c=r.getClosestSelectedImageElement(n.document.selection)),!l||this._styles.get(l).isDefault?o.removeAttribute("imageStyle",c):o.setAttribute("imageStyle",l,c),a&&r.setImageNaturalSizeAttributes(c)})}shouldConvertImageType(e,i){return!this._styles.get(e).modelElements.includes(i.name)}}const Nm={get inline(){return{name:"inline",title:"In line",icon:JA,modelElements:["imageInline"],isDefault:!0}},get alignLeft(){return{name:"alignLeft",title:"Left aligned image",icon:iy,modelElements:["imageBlock","imageInline"],className:"image-style-align-left"}},get alignBlockLeft(){return{name:"alignBlockLeft",title:"Left aligned image",icon:eI,modelElements:["imageBlock"],className:"image-style-block-align-left"}},get alignCenter(){return{name:"alignCenter",title:"Centered image",icon:Og,modelElements:["imageBlock"],className:"image-style-align-center"}},get alignRight(){return{name:"alignRight",title:"Right aligned image",icon:yg,modelElements:["imageBlock","imageInline"],className:"image-style-align-right"}},get alignBlockRight(){return{name:"alignBlockRight",title:"Right aligned image",icon:tI,modelElements:["imageBlock"],className:"image-style-block-align-right"}},get block(){return{name:"block",title:"Centered image",icon:Og,modelElements:["imageBlock"],isDefault:!0}},get side(){return{name:"side",title:"Side image",icon:yg,modelElements:["imageBlock"],className:"image-style-side"}}},R7={full:Oz,left:eI,right:tI,center:Og,inlineLeft:iy,inlineRight:yg,inline:JA},V7=[{name:"imageStyle:wrapText",title:"Wrap text",defaultItem:"imageStyle:alignLeft",items:["imageStyle:alignLeft","imageStyle:alignRight"]},{name:"imageStyle:breakText",title:"Break text",defaultItem:"imageStyle:block",items:["imageStyle:alignBlockLeft","imageStyle:block","imageStyle:alignBlockRight"]}];function bG(s){return(s.configuredStyles.options||[]).map(i=>vG(i)).filter(i=>_G(i,s))}function OG(s,t){return s&&t?{options:["inline","alignLeft","alignRight","alignCenter","alignBlockLeft","alignBlockRight","block","side"]}:s?{options:["block","side"]}:t?{options:["inline","alignLeft","alignRight"]}:{}}function yG(s){return s.has("ImageBlockEditing")&&s.has("ImageInlineEditing")?[...V7]:[]}function vG(s){return typeof s=="string"?Nm[s]?s={...Nm[s]}:s={name:s}:s=kG(Nm[s.name],s),typeof s.icon=="string"&&(s.icon=R7[s.icon]||s.icon),s}function _G(s,{isBlockPluginLoaded:t,isInlinePluginLoaded:e}){const{modelElements:i,name:n}=s;if(!i||!i.length||!n)return M7({style:s}),!1;{const r=[t?"imageBlock":null,e?"imageInline":null];if(!i.some(o=>r.includes(o)))return Ue("image-style-missing-dependency",{style:s,missingPlugins:i.map(o=>o==="imageBlock"?"ImageBlockEditing":"ImageInlineEditing")}),!1}return!0}function kG(s,t){const e={...t};for(const i in s)Object.prototype.hasOwnProperty.call(t,i)||(e[i]=s[i]);return e}function M7(s){Ue("image-style-configuration-definition-invalid",s)}var e1={normalizeStyles:bG,getDefaultStylesConfiguration:OG,getDefaultDropdownDefinitions:yG,warnInvalidStyle:M7,DEFAULT_OPTIONS:Nm,DEFAULT_ICONS:R7,DEFAULT_DROPDOWN_DEFINITIONS:V7};function SG(s){return(t,e,i)=>{if(!i.consumable.consume(e.item,t.name))return;const n=v5(e.attributeNewValue,s),r=v5(e.attributeOldValue,s),o=i.mapper.toViewElement(e.item),l=i.writer;r&&l.removeClass(r.className,o),n&&l.addClass(n.className,o)}}function CG(s){const t={imageInline:s.filter(e=>!e.isDefault&&e.modelElements.includes("imageInline")),imageBlock:s.filter(e=>!e.isDefault&&e.modelElements.includes("imageBlock"))};return(e,i,n)=>{if(!i.modelRange)return;const r=i.viewItem,o=$t(i.modelRange.getItems());if(o&&n.schema.checkAttribute(o,"imageStyle"))for(const l of t[o.name])n.consumable.consume(r,{classes:l.className})&&n.writer.setAttribute("imageStyle",l.name,o)}}function v5(s,t){for(const e of t)if(e.name===s)return e}class L7 extends F{constructor(){super(...arguments);p(this,"normalizedStyles")}static get pluginName(){return"ImageStyleEditing"}static get isOfficialPlugin(){return!0}static get requires(){return[_i]}init(){const{normalizeStyles:e,getDefaultStylesConfiguration:i}=e1,n=this.editor,r=n.plugins.has("ImageBlockEditing"),o=n.plugins.has("ImageInlineEditing");n.config.define("image.styles",i(r,o)),this.normalizedStyles=e({configuredStyles:n.config.get("image.styles"),isBlockPluginLoaded:r,isInlinePluginLoaded:o}),this._setupConversion(r,o),this._setupPostFixer(),n.commands.add("imageStyle",new xG(n,this.normalizedStyles))}_setupConversion(e,i){const n=this.editor,r=n.model.schema,o=SG(this.normalizedStyles),l=CG(this.normalizedStyles);n.editing.downcastDispatcher.on("attribute:imageStyle",o),n.data.downcastDispatcher.on("attribute:imageStyle",o),e&&(r.extend("imageBlock",{allowAttributes:"imageStyle"}),n.data.upcastDispatcher.on("element:figure",l,{priority:"low"})),i&&(r.extend("imageInline",{allowAttributes:"imageStyle"}),n.data.upcastDispatcher.on("element:img",l,{priority:"low"}))}_setupPostFixer(){const e=this.editor,i=e.model.document,n=e.plugins.get(_i),r=new Map(this.normalizedStyles.map(o=>[o.name,o]));i.registerPostFixer(o=>{let l=!1;for(const a of i.differ.getChanges())if(a.type=="insert"||a.type=="attribute"&&a.attributeKey=="imageStyle"){let c=a.type=="insert"?a.position.nodeAfter:a.range.start.nodeAfter;if(c&&c.is("element","paragraph")&&c.childCount>0&&(c=c.getChild(0)),!n.isImage(c))continue;const h=c.getAttribute("imageStyle");if(!h)continue;const f=r.get(h);(!f||!f.modelElements.includes(c.name))&&(o.removeAttribute("imageStyle",c),l=!0)}return l})}}class PG extends F{static get requires(){return[L7]}static get pluginName(){return"ImageStyleUI"}static get isOfficialPlugin(){return!0}get localizedDefaultStylesTitles(){const t=this.editor.t;return{"Wrap text":t("Wrap text"),"Break text":t("Break text"),"In line":t("In line"),"Full size image":t("Full size image"),"Side image":t("Side image"),"Left aligned image":t("Left aligned image"),"Centered image":t("Centered image"),"Right aligned image":t("Right aligned image")}}init(){const t=this.editor.plugins,e=this.editor.config.get("image.toolbar")||[],i=t.get("ImageStyleEditing"),n=_5(i.normalizedStyles,this.localizedDefaultStylesTitles);for(const o of n)this._createButton(o);const r=_5([...e.filter(ds),...e1.getDefaultDropdownDefinitions(t)],this.localizedDefaultStylesTitles);for(const o of r)this._createDropdown(o,n)}_createDropdown(t,e){const i=this.editor.ui.componentFactory;i.add(t.name,n=>{let r;const{defaultItem:o,items:l,title:a}=t,c=l.filter(w=>e.find(({name:O})=>k5(O)===w)).map(w=>{const O=i.create(w);return w===o&&(r=O),O});l.length!==c.length&&e1.warnInvalidStyle({dropdown:t});const h=nn(n,Vc),f=h.buttonView,m=f.arrowView;return cy(h,c,{enableActiveItemFocusOnDropdownOpen:!0}),f.set({label:S5(a,r.label),class:null,tooltip:!0}),m.unbind("label"),m.set({label:a}),f.bind("icon").toMany(c,"isOn",(...w)=>{const O=w.findIndex($a);return O<0?r.icon:c[O].icon}),f.bind("label").toMany(c,"isOn",(...w)=>{const O=w.findIndex($a);return S5(a,O<0?r.label:c[O].label)}),f.bind("isOn").toMany(c,"isOn",(...w)=>w.some($a)),f.bind("class").toMany(c,"isOn",(...w)=>w.some($a)?"ck-splitbutton_flatten":void 0),f.on("execute",()=>{c.some(({isOn:w})=>w)?h.isOpen=!h.isOpen:r.fire("execute")}),h.bind("isEnabled").toMany(c,"isEnabled",(...w)=>w.some($a)),this.listenTo(h,"execute",()=>{this.editor.editing.view.focus()}),h})}_createButton(t){const e=t.name;this.editor.ui.componentFactory.add(k5(e),i=>{const n=this.editor.commands.get("imageStyle"),r=new ye(i);return r.set({label:t.title,icon:t.icon,tooltip:!0,isToggleable:!0}),r.bind("isEnabled").to(n,"isEnabled"),r.bind("isOn").to(n,"value",o=>o===e),r.on("execute",this._executeCommand.bind(this,e)),r})}_executeCommand(t){this.editor.execute("imageStyle",{value:t}),this.editor.editing.view.focus()}}function _5(s,t){for(const e of s)t[e.title]&&(e.title=t[e.title]);return s}function k5(s){return`imageStyle:${s}`}function S5(s,t){return(s?s+": ":"")+t}class TG extends F{static get requires(){return[L7,PG]}static get pluginName(){return"ImageStyle"}static get isOfficialPlugin(){return!0}}class EG extends F{static get requires(){return[Eg,_i]}static get pluginName(){return"ImageToolbar"}static get isOfficialPlugin(){return!0}afterInit(){const t=this.editor,e=t.t,i=t.plugins.get(Eg),n=t.plugins.get("ImageUtils");i.register("image",{ariaLabel:e("Image toolbar"),items:AG(t.config.get("image.toolbar")||[]),getRelatedElement:r=>n.getClosestSelectedImageWidget(r)})}}function AG(s){return s.map(t=>ds(t)?t.name:t)}class IG extends F{static get requires(){return[Sy,_i]}static get pluginName(){return"PictureEditing"}static get isOfficialPlugin(){return!0}afterInit(){const t=this.editor;t.plugins.has("ImageBlockEditing")&&t.model.schema.extend("imageBlock",{allowAttributes:["sources"]}),t.plugins.has("ImageInlineEditing")&&t.model.schema.extend("imageInline",{allowAttributes:["sources"]}),this._setupConversion(),this._setupImageUploadEditingIntegration()}_setupConversion(){const t=this.editor,e=t.conversion,i=t.plugins.get("ImageUtils");e.for("upcast").add(EX(i)),e.for("downcast").add(AX(i))}_setupImageUploadEditingIntegration(){const t=this.editor;if(!t.plugins.has("ImageUploadEditing"))return;const e=t.plugins.get("ImageUploadEditing");this.listenTo(e,"uploadComplete",(i,{imageElement:n,data:r})=>{const o=r.sources;o&&t.model.change(l=>{l.setAttributes({sources:o},n)})})}}/**
 * @license Copyright (c) 2003-2025, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options
 */class RG{constructor(){p(this,"_definitions",new Set)}get length(){return this._definitions.size}add(t){Array.isArray(t)?t.forEach(e=>this._definitions.add(e)):this._definitions.add(t)}getDispatcher(){return t=>{t.on("attribute:linkHref",(e,i,n)=>{if(!n.consumable.test(i.item,"attribute:linkHref")||!(i.item.is("selection")||n.schema.isInline(i.item)))return;const r=n.writer,o=r.document.selection;for(const l of this._definitions){const a=r.createAttributeElement("a",l.attributes,{priority:5});l.classes&&r.addClass(l.classes,a);for(const c in l.styles)r.setStyle(c,l.styles[c],a);r.setCustomProperty("link",!0,a),l.callback(i.attributeNewValue)?i.item.is("selection")?r.wrap(o.getFirstRange(),a):r.wrap(n.mapper.toViewRange(i.range),a):r.unwrap(n.mapper.toViewRange(i.range),a)}},{priority:"high"})}}getDispatcherForLinkedImage(){return t=>{t.on("attribute:linkHref:imageBlock",(e,i,{writer:n,mapper:r})=>{const o=r.toViewElement(i.item),l=Array.from(o.getChildren()).find(a=>a.is("element","a"));if(l)for(const a of this._definitions){const c=ms(a.attributes);if(a.callback(i.attributeNewValue)){for(const[h,f]of c)h==="class"?n.addClass(f,l):n.setAttribute(h,f,l);a.classes&&n.addClass(a.classes,l);for(const h in a.styles)n.setStyle(h,a.styles[h],l)}else{for(const[h,f]of c)h==="class"?n.removeClass(f,l):n.removeAttribute(h,l);a.classes&&n.removeClass(a.classes,l);for(const h in a.styles)n.removeStyle(h,l)}}})}}}const VG=/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205f\u3000]/g,MG="^(?:(?:<protocols>):|[^a-z]|[a-z+.-]+(?:[^a-z+.:-]|$))",LG=/^[\S]+@((?![-_])(?:[-\w\u00a1-\uffff]{0,63}[^-_]\.))+(?:[a-z\u00a1-\uffff]{2,})$/i,BG=/^((\w+:(\/{2,})?)|(\W))/i,$G=["https?","ftps?","mailto"],Ku="Ctrl+K";function DG(s){return s.is("attributeElement")&&!!s.getCustomProperty("link")}function C5(s,{writer:t}){const e=t.createAttributeElement("a",{href:s},{priority:5});return t.setCustomProperty("link",!0,e),e}function B7(s,t=$G){const e=String(s),i=t.join("|"),n=new RegExp(`${MG.replace("<protocols>",i)}`,"i");return QG(e,n)?e:"#"}function QG(s,t){return!!s.replace(VG,"").match(t)}function NG(s,t){const e={"Open in a new tab":s("Open in a new tab"),Downloadable:s("Downloadable")};return t.forEach(i=>("label"in i&&e[i.label]&&(i.label=e[i.label]),i)),t}function FG(s){const t=[];if(s)for(const[e,i]of Object.entries(s)){const n=Object.assign({},i,{id:`link${Y$(e)}`});t.push(n)}return t}function t1(s,t){return s?t.checkAttribute(s.name,"linkHref"):!1}function zG(s){return LG.test(s)}function Cy(s,t){const e=zG(s)?"mailto:":t,i=!!e&&!$7(s);return s&&i?e+s:s}function $7(s){return BG.test(s)}function WG(s){window.open(s,"_blank","noopener")}function i1(s){let t="";for(const e of s.getItems()){if(!e.is("$text")&&!e.is("$textProxy"))return;t+=e.data}return t}class UG extends Be{constructor(){super(...arguments);p(this,"manualDecorators",new di);p(this,"automaticDecorators",new RG)}restoreManualDecoratorStates(){for(const e of this.manualDecorators)e.value=this._getDecoratorStateFromModel(e.id)}refresh(){const e=this.editor.model,i=e.document.selection,n=i.getSelectedElement()||$t(i.getSelectedBlocks());t1(n,e.schema)?(this.value=n.getAttribute("linkHref"),this.isEnabled=e.schema.checkAttribute(n,"linkHref")):(this.value=i.getAttribute("linkHref"),this.isEnabled=e.schema.checkAttributeInSelection(i,"linkHref"));for(const r of this.manualDecorators)r.value=this._getDecoratorStateFromModel(r.id)}execute(e,i={},n){const r=this.editor.model,o=r.document.selection,l=[],a=[];for(const c in i)i[c]?l.push(c):a.push(c);r.change(c=>{const h=w=>{c.setAttribute("linkHref",e,w),l.forEach(O=>c.setAttribute(O,!0,w)),a.forEach(O=>c.removeAttribute(O,w))},f=(w,O)=>{const _=i1(w);if(!_)return w;let k=n;if(k||(k=O&&O==_?e:_),k!=_){const C=ZG(_,k);let P=0;for(const{offset:M,actual:Q,expected:N}of C){const G=M+P,D=c.createRange(w.start.getShiftedBy(G),w.start.getShiftedBy(G+Q.length)),I=HG(D,w).getAttributes(),B=Array.from(I).filter(([W])=>r.schema.getAttributeProperties(W).isFormatting),j=c.createText(N,B);h(j),r.insertContent(j,D),P+=N.length}return c.createRange(w.start,w.start.getShiftedBy(k.length))}},m=w=>{const{plugins:O}=this.editor;if(c.setSelection(w.end),O.has("TwoStepCaretMovement"))O.get("TwoStepCaretMovement")._handleForwardMovement();else for(const _ of["linkHref",...l,...a])c.removeSelectionAttribute(_)};if(o.isCollapsed){const w=o.getFirstPosition();if(o.hasAttribute("linkHref")){const O=o.getAttribute("linkHref"),_=Ap(w,"linkHref",O,r),k=f(_,O);h(k||_),k&&m(k)}else if(e!==""){const O=ms(o.getAttributes());O.set("linkHref",e),l.forEach(k=>{O.set(k,!0)});const _=r.insertContent(c.createText(n||e,O),w);m(_)}}else{const w=Array.from(o.getRanges()),O=r.schema.getValidRanges(w,"linkHref"),_=[];for(const P of o.getSelectedBlocks())r.schema.checkAttribute(P,"linkHref")&&_.push(c.createRangeOn(P));const k=_.slice();for(const P of O)this._isRangeToUpdate(P,_)&&k.push(P);const C=w.map(P=>({start:Xt.fromPosition(P.start,"toPrevious"),end:Xt.fromPosition(P.end,"toNext")}));for(let P of k){const M=(P.start.textNode||P.start.nodeAfter).getAttribute("linkHref");P=f(P,M)||P,h(P)}c.setSelection(C.map(P=>{const M=P.start.toPosition(),Q=P.end.toPosition();return P.start.detach(),P.end.detach(),r.createRange(M,Q)}))}})}_getDecoratorStateFromModel(e){const i=this.editor.model,n=i.document.selection,r=n.getSelectedElement();return t1(r,i.schema)?r.getAttribute(e):n.getAttribute(e)}_isRangeToUpdate(e,i){for(const n of i)if(n.containsRange(e))return!1;return!0}}function ZG(s,t){const e=ic(s,t),i={equal:0,insert:0,delete:0},n=[];let r="",o="";for(const l of[...e,null])l=="insert"?o+=t[i.equal+i.insert]:l=="delete"?r+=s[i.equal+i.delete]:(r.length||o.length)&&(n.push({offset:i.equal,actual:r,expected:o}),r="",o=""),l&&i[l]++;return n}function HG(s,t){if(!s.isCollapsed)return $t(s.getItems());const e=s.start;return e.textNode?e.textNode:!e.nodeBefore||e.isEqual(t.start)?e.nodeAfter:e.nodeBefore}class qG extends Be{refresh(){const t=this.editor.model,e=t.document.selection,i=e.getSelectedElement();t1(i,t.schema)?this.isEnabled=t.schema.checkAttribute(i,"linkHref"):this.isEnabled=t.schema.checkAttributeInSelection(e,"linkHref")}execute(){const t=this.editor,e=this.editor.model,i=e.document.selection,n=t.commands.get("link");e.change(r=>{const o=i.isCollapsed?[Ap(i.getFirstPosition(),"linkHref",i.getAttribute("linkHref"),e)]:e.schema.getValidRanges(i.getRanges(),"linkHref");for(const l of o)if(r.removeAttribute("linkHref",l),n)for(const a of n.manualDecorators)r.removeAttribute(a.id,l)})}}class jG extends at(){constructor({id:e,label:i,attributes:n,classes:r,styles:o,defaultValue:l}){super();p(this,"id");p(this,"defaultValue");p(this,"label");p(this,"attributes");p(this,"classes");p(this,"styles");this.id=e,this.set("value",void 0),this.defaultValue=l,this.label=i,this.attributes=n,this.classes=r,this.styles=o}_createPattern(){return{attributes:this.attributes,classes:this.classes,styles:this.styles}}}const XG="ck-link_selected",P5="automatic",GG="manual",YG=/^(https?:)?\/\//;class wc extends F{constructor(e){super(e);p(this,"_linkOpeners",[]);e.config.define("link",{allowCreatingEmptyLinks:!1,addTargetToExternalLinks:!1,toolbar:["linkPreview","|","editLink","linkProperties","unlink"]})}static get pluginName(){return"LinkEditing"}static get isOfficialPlugin(){return!0}static get requires(){return[Pg,UI,on]}init(){const e=this.editor,i=this.editor.config.get("link.allowedProtocols");e.model.schema.extend("$text",{allowAttributes:"linkHref"}),e.conversion.for("dataDowncast").attributeToElement({model:"linkHref",view:C5}),e.conversion.for("editingDowncast").attributeToElement({model:"linkHref",view:(o,l)=>C5(B7(o,i),l)}),e.conversion.for("upcast").elementToAttribute({view:{name:"a",attributes:{href:!0}},model:{key:"linkHref",value:o=>o.getAttribute("href")}}),e.commands.add("link",new UG(e)),e.commands.add("unlink",new qG(e));const n=NG(e.t,FG(e.config.get("link.decorators")));this._enableAutomaticDecorators(n.filter(o=>o.mode===P5)),this._enableManualDecorators(n.filter(o=>o.mode===GG)),e.plugins.get(Pg).registerAttribute("linkHref"),qI(e,"linkHref","a",XG),this._enableLinkOpen(),this._enableSelectionAttributesFixer(),this._enableClipboardIntegration()}_registerLinkOpener(e){this._linkOpeners.push(e)}_enableAutomaticDecorators(e){const i=this.editor,r=i.commands.get("link").automaticDecorators;i.config.get("link.addTargetToExternalLinks")&&r.add({id:"linkIsExternal",mode:P5,callback:o=>!!o&&YG.test(o),attributes:{target:"_blank",rel:"noopener noreferrer"}}),r.add(e),r.length&&i.conversion.for("downcast").add(r.getDispatcher())}_enableManualDecorators(e){if(!e.length)return;const i=this.editor,r=i.commands.get("link").manualDecorators;e.forEach(o=>{i.model.schema.extend("$text",{allowAttributes:o.id});const l=new jG(o);r.add(l),i.conversion.for("downcast").attributeToElement({model:l.id,view:(a,{writer:c,schema:h},{item:f})=>{if((f.is("selection")||h.isInline(f))&&a){const m=c.createAttributeElement("a",l.attributes,{priority:5});l.classes&&c.addClass(l.classes,m);for(const w in l.styles)c.setStyle(w,l.styles[w],m);return c.setCustomProperty("link",!0,m),m}}}),i.conversion.for("upcast").elementToAttribute({view:{name:"a",...l._createPattern()},model:{key:l.id}})})}_enableLinkOpen(){const e=this.editor,n=e.editing.view.document,r=o=>{this._linkOpeners.some(l=>l(o))||WG(o)};this.listenTo(n,"click",(o,l)=>{if(!(Ie.isMac?l.domEvent.metaKey:l.domEvent.ctrlKey))return;let c=l.domTarget;if(c.tagName.toLowerCase()!="a"&&(c=c.closest("a")),!c)return;const h=c.getAttribute("href");h&&(o.stop(),l.preventDefault(),r(h))},{context:"$capture"}),this.listenTo(n,"keydown",(o,l)=>{const c=e.commands.get("link").value;c&&l.keyCode===ze.enter&&l.altKey&&(o.stop(),r(c))})}_enableSelectionAttributesFixer(){const i=this.editor.model,n=i.document.selection;this.listenTo(n,"change:attribute",(r,{attributeKeys:o})=>{!o.includes("linkHref")||n.hasAttribute("linkHref")||i.change(l=>{KG(l,JG(i.schema))})})}_enableClipboardIntegration(){const e=this.editor,i=e.model,n=this.editor.config.get("link.defaultProtocol");n&&this.listenTo(e.plugins.get("ClipboardPipeline"),"contentInsertion",(r,o)=>{i.change(l=>{const a=l.createRangeIn(o.content);for(const c of a.getItems())if(c.hasAttribute("linkHref")){const h=Cy(c.getAttribute("linkHref"),n);l.setAttribute("linkHref",h,c)}})})}}function KG(s,t){s.removeSelectionAttribute("linkHref");for(const e of t)s.removeSelectionAttribute(e)}function JG(s){return s.getDefinition("$text").allowAttributes.filter(e=>e.startsWith("link"))}class eY extends ye{constructor(t){super(t);const e=this.bindTemplate;this.set({href:void 0,withText:!0}),this.extendTemplate({attributes:{class:["ck-link-toolbar__preview"],href:e.to("href"),target:"_blank",rel:"noopener noreferrer"},on:{click:e.to(i=>{if(this.href){const n=()=>i.preventDefault();this.fire("navigate",this.href,n)}})}}),this.template.tag="a"}}class tY extends ue{constructor(e,i){super(e);p(this,"focusTracker",new ot);p(this,"keystrokes",new wt);p(this,"backButtonView");p(this,"saveButtonView");p(this,"displayedTextInputView");p(this,"urlInputView");p(this,"children");p(this,"providersListChildren");p(this,"_validators");p(this,"_focusables",new fi);p(this,"_focusCycler");this._validators=i,this.backButtonView=this._createBackButton(),this.saveButtonView=this._createSaveButton(),this.displayedTextInputView=this._createDisplayedTextInput(),this.urlInputView=this._createUrlInput(),this.providersListChildren=this.createCollection(),this.children=this.createCollection([this._createHeaderView()]),this._createFormChildren(),this.listenTo(this.providersListChildren,"add",()=>{this.stopListening(this.providersListChildren,"add"),this.children.add(this._createProvidersListView())}),this._focusCycler=new Ht({focusables:this._focusables,focusTracker:this.focusTracker,keystrokeHandler:this.keystrokes,actions:{focusPrevious:"shift + tab",focusNext:"tab"}}),this.setTemplate({tag:"form",attributes:{class:["ck","ck-form","ck-link-form","ck-responsive-form"],tabindex:"-1"},children:this.children})}render(){super.render(),Wl({view:this}),[this.urlInputView,this.saveButtonView,...this.providersListChildren,this.backButtonView,this.displayedTextInputView].forEach(i=>{this._focusables.add(i),this.focusTracker.add(i.element)}),this.keystrokes.listenTo(this.element)}destroy(){super.destroy(),this.focusTracker.destroy(),this.keystrokes.destroy()}focus(){this._focusCycler.focusFirst()}isValid(){this.resetFormStatus();for(const e of this._validators){const i=e(this);if(i)return this.urlInputView.errorText=i,!1}return!0}resetFormStatus(){this.urlInputView.errorText=null}_createBackButton(){const e=this.locale.t,i=new ye(this.locale);return i.set({class:"ck-button-back",label:e("Back"),icon:zl,tooltip:!0}),i.delegate("execute").to(this,"cancel"),i}_createSaveButton(){const e=this.locale.t,i=new ye(this.locale);return i.set({label:e("Insert"),tooltip:!1,withText:!0,type:"submit",class:"ck-button-action ck-button-bold"}),i}_createHeaderView(){const e=this.locale.t,i=new zr(this.locale,{label:e("Link")});return i.children.add(this.backButtonView,0),i}_createProvidersListView(){const e=new Wr(this.locale);return e.extendTemplate({attributes:{class:["ck-link-form__providers-list"]}}),e.items.bindTo(this.providersListChildren).using(i=>{const n=new Sn(this.locale);return n.children.add(i),n}),e}_createDisplayedTextInput(){const e=this.locale.t,i=new Yt(this.locale,On);return i.label=e("Displayed text"),i.class="ck-labeled-field-view_full-width",i}_createUrlInput(){const e=this.locale.t,i=new Yt(this.locale,On);return i.fieldView.inputMode="url",i.label=e("Link URL"),i.class="ck-labeled-field-view_full-width",i}_createFormChildren(){this.children.add(new Ei(this.locale,{children:[this.displayedTextInputView],class:["ck-form__row_large-top-padding"]})),this.children.add(new Ei(this.locale,{children:[this.urlInputView,this.saveButtonView],class:["ck-form__row_with-submit","ck-form__row_large-top-padding","ck-form__row_large-bottom-padding"]}))}get url(){const{element:e}=this.urlInputView.fieldView;return e?e.value.trim():null}}class iY extends ue{constructor(e){super(e);p(this,"focusTracker",new ot);p(this,"keystrokes",new wt);p(this,"backButtonView");p(this,"listView");p(this,"listChildren");p(this,"emptyListInformation");p(this,"children");p(this,"_focusables",new fi);p(this,"_focusCycler");this.listChildren=this.createCollection(),this.backButtonView=this._createBackButton(),this.listView=this._createListView(),this.emptyListInformation=this._createEmptyLinksListItemView(),this.children=this.createCollection([this._createHeaderView(),this.emptyListInformation]),this.set("title",""),this.set("emptyListPlaceholder",""),this.set("hasItems",!1),this.listenTo(this.listChildren,"change",()=>{this.hasItems=this.listChildren.length>0}),this.on("change:hasItems",(i,n,r)=>{r?(this.children.remove(this.emptyListInformation),this.children.add(this.listView)):(this.children.remove(this.listView),this.children.add(this.emptyListInformation))}),this.keystrokes.set("Esc",(i,n)=>{this.fire("cancel"),n()}),this._focusCycler=new Ht({focusables:this._focusables,focusTracker:this.focusTracker,keystrokeHandler:this.keystrokes,actions:{focusPrevious:"shift + tab",focusNext:"tab"}}),this.setTemplate({tag:"div",attributes:{class:["ck","ck-link-providers"],tabindex:"-1"},children:this.children})}render(){super.render(),[this.listView,this.backButtonView].forEach(i=>{this._focusables.add(i),this.focusTracker.add(i.element)}),this.keystrokes.listenTo(this.element)}destroy(){super.destroy(),this.focusTracker.destroy(),this.keystrokes.destroy()}focus(){this._focusCycler.focusFirst()}_createListView(){const e=new Wr(this.locale);return e.extendTemplate({attributes:{class:["ck-link-providers__list"]}}),e.items.bindTo(this.listChildren).using(i=>{const n=new Sn(this.locale);return n.children.add(i),n}),e}_createBackButton(){const e=this.locale.t,i=new ye(this.locale);return i.set({class:"ck-button-back",label:e("Back"),icon:zl,tooltip:!0}),i.delegate("execute").to(this,"cancel"),i}_createHeaderView(){const e=new zr(this.locale);return e.bind("label").to(this,"title"),e.children.add(this.backButtonView,0),e}_createEmptyLinksListItemView(){const e=new ue(this.locale);return e.setTemplate({tag:"p",attributes:{class:["ck","ck-link__empty-list-info"]},children:[{text:this.bindTemplate.to("emptyListPlaceholder")}]}),e}}class nY extends ue{constructor(e){super(e);p(this,"focusTracker",new ot);p(this,"keystrokes",new wt);p(this,"backButtonView");p(this,"children");p(this,"listChildren");p(this,"_focusables",new fi);p(this,"_focusCycler");this.backButtonView=this._createBackButton(),this.listChildren=this.createCollection(),this.children=this.createCollection([this._createHeaderView(),this._createListView()]),this._focusCycler=new Ht({focusables:this._focusables,focusTracker:this.focusTracker,keystrokeHandler:this.keystrokes,actions:{focusPrevious:"shift + tab",focusNext:"tab"}}),this.setTemplate({tag:"div",attributes:{class:["ck","ck-link-properties"],tabindex:"-1"},children:this.children}),this.keystrokes.set("Esc",(i,n)=>{this.fire("back"),n()})}render(){super.render(),[...this.listChildren,this.backButtonView].forEach(i=>{this._focusables.add(i),this.focusTracker.add(i.element)}),this.keystrokes.listenTo(this.element)}destroy(){super.destroy(),this.focusTracker.destroy(),this.keystrokes.destroy()}focus(){this._focusCycler.focusFirst()}_createBackButton(){const e=this.locale.t,i=new ye(this.locale);return i.set({class:"ck-button-back",label:e("Back"),icon:zl,tooltip:!0}),i.delegate("execute").to(this,"back"),i}_createHeaderView(){const e=this.locale.t,i=new zr(this.locale,{label:e("Link properties")});return i.children.add(this.backButtonView,0),i}_createListView(){const e=new Wr(this.locale);return e.extendTemplate({attributes:{class:["ck-link__list"]}}),e.items.bindTo(this.listChildren).using(i=>{const n=new Sn(this.locale);return n.children.add(i),n}),e}}class sY extends ye{constructor(e){super(e);p(this,"arrowView");this.set({withText:!0}),this.arrowView=this._createArrowView(),this.extendTemplate({attributes:{class:["ck-link__button"]}})}render(){super.render(),this.children.add(this.arrowView)}_createArrowView(){const e=new Zn;return e.content=KA,e}}const js="link-ui";class D7 extends F{constructor(){super(...arguments);p(this,"toolbarView",null);p(this,"formView",null);p(this,"linkProviderItemsView",null);p(this,"propertiesView",null);p(this,"_balloon");p(this,"_linksProviders",new di)}static get requires(){return[gs,wc]}static get pluginName(){return"LinkUI"}static get isOfficialPlugin(){return!0}init(){const e=this.editor,i=this.editor.t;this.set("selectedLinkableText",void 0),e.editing.view.addObserver(HN),this._balloon=e.plugins.get(gs),this._registerComponents(),this._registerEditingOpeners(),this._enableBalloonActivators(),e.conversion.for("editingDowncast").markerToHighlight({model:js,view:{classes:["ck-fake-link-selection"]}}),e.conversion.for("editingDowncast").markerToElement({model:js,view:(n,{writer:r})=>{if(!n.markerRange.isCollapsed)return null;const o=r.createUIElement("span");return r.addClass(["ck-fake-link-selection","ck-fake-link-selection_collapsed"],o),o}}),e.accessibility.addKeystrokeInfos({keystrokes:[{label:i("Create link"),keystroke:Ku},{label:i("Move out of a link"),keystroke:[["arrowleft","arrowleft"],["arrowright","arrowright"]]}]})}destroy(){super.destroy(),this.propertiesView&&this.propertiesView.destroy(),this.formView&&this.formView.destroy(),this.toolbarView&&this.toolbarView.destroy(),this.linkProviderItemsView&&this.linkProviderItemsView.destroy()}registerLinksListProvider(e){const i=this._linksProviders.filter(n=>(n.order||0)<=(e.order||0)).length;this._linksProviders.add(e,i)}_createViews(){const e=this.editor.commands.get("link");this.toolbarView=this._createToolbarView(),this.formView=this._createFormView(),e.manualDecorators.length&&(this.propertiesView=this._createPropertiesView()),this._enableUserBalloonInteractions()}_createToolbarView(){const e=this.editor,i=new Vo(e.locale),n=e.commands.get("link");i.class="ck-link-toolbar";let r=e.config.get("link.toolbar");return n.manualDecorators.length||(r=r.filter(o=>o!=="linkProperties")),i.fillFromConfig(r,e.ui.componentFactory),i.keystrokes.set("Esc",(o,l)=>{this._hideUI(),l()}),i.keystrokes.set(Ku,(o,l)=>{this._addFormView(),l()}),e.ui.addToolbar(i,{isContextual:!0,beforeFocus:()=>{this._getSelectedLinkElement()&&!this._isToolbarVisible&&this._showUI(!0)},afterBlur:()=>{this._hideUI(!1)}}),i}_createFormView(){const e=this.editor,i=e.locale.t,n=e.commands.get("link"),r=e.config.get("link.defaultProtocol"),o=new(_g(tY))(e.locale,rY(e));return o.displayedTextInputView.bind("isEnabled").to(this,"selectedLinkableText",l=>l!==void 0),o.urlInputView.bind("isEnabled").to(n,"isEnabled"),o.saveButtonView.bind("isEnabled").to(n,"isEnabled"),o.saveButtonView.bind("label").to(n,"value",l=>i(l?"Update":"Insert")),this.listenTo(o,"submit",()=>{if(o.isValid()){const l=o.urlInputView.fieldView.element.value,a=Cy(l,r),c=o.displayedTextInputView.fieldView.element.value;e.execute("link",a,this._getDecoratorSwitchesState(),c!==this.selectedLinkableText?c:void 0),this._closeFormView()}}),this.listenTo(o.urlInputView,"change:errorText",()=>{e.ui.update()}),this.listenTo(o,"cancel",()=>{this._closeFormView()}),o.keystrokes.set("Esc",(l,a)=>{this._closeFormView(),a()}),o.providersListChildren.bindTo(this._linksProviders).using(l=>this._createLinksListProviderButton(l)),o}_createLinkProviderListView(e){return e.getListItems().map(({href:i,label:n,icon:r})=>{const o=new ye;return o.set({label:n,icon:r,tooltip:!1,withText:!0}),o.on("execute",()=>{this.formView.resetFormStatus(),this.formView.urlInputView.fieldView.value=i,this.editor.editing.view.focus(),this._removeLinksProviderView(),this.formView.focus()}),o})}_createLinkProviderItemsView(e){const i=this.editor,n=i.locale.t,r=new iY(i.locale),{emptyListPlaceholder:o,label:l}=e;return r.emptyListPlaceholder=o||n("No links available"),r.title=l,this.listenTo(r,"cancel",()=>{i.editing.view.focus(),this._removeLinksProviderView(),this.formView.focus()}),r}_createPropertiesView(){const e=this.editor,i=this.editor.commands.get("link"),n=new(_g(nY))(e.locale);return this.listenTo(n,"back",()=>{e.editing.view.focus(),this._removePropertiesView()}),n.listChildren.bindTo(i.manualDecorators).using(r=>{const o=new dd(e.locale);return o.set({label:r.label,withText:!0}),o.bind("isOn").toMany([r,i],"value",(l,a)=>a===void 0&&l===void 0?!!r.defaultValue:!!l),o.on("execute",()=>{r.set("value",!o.isOn),e.execute("link",i.value,this._getDecoratorSwitchesState())}),o}),n}_getDecoratorSwitchesState(){const e=this.editor.commands.get("link");return Array.from(e.manualDecorators).reduce((i,n)=>{const r=e.value===void 0&&n.value===void 0?n.defaultValue:n.value;return{...i,[n.id]:!!r}},{})}_registerEditingOpeners(){this.editor.plugins.get(wc)._registerLinkOpener(i=>{const n=this._getLinkProviderLinkByHref(i);if(!n)return!1;const{item:r,provider:o}=n;return o.navigate?o.navigate(r):!1})}_registerComponents(){const e=this.editor;e.ui.componentFactory.add("link",()=>{const i=this._createButton(ye);return i.set({tooltip:!0}),i}),e.ui.componentFactory.add("menuBar:link",()=>{const i=this._createButton(ti);return i.set({role:"menuitemcheckbox"}),i}),e.ui.componentFactory.add("linkPreview",i=>{const n=new eY(i),r=e.config.get("link.allowedProtocols"),o=e.commands.get("link"),l=i.t;n.bind("isEnabled").to(o,"value",c=>!!c),n.bind("href").to(o,"value",c=>c&&B7(c,r));const a=c=>{if(!c){n.label=void 0,n.icon=void 0,n.tooltip=l("Open link in new tab");return}const h=this._getLinkProviderLinkByHref(c);if(h){const{label:f,tooltip:m,icon:w}=h.item;n.label=f,n.tooltip=m||!1,n.icon=w}else n.label=c,n.icon=void 0,n.tooltip=l("Open link in new tab")};return a(o.value),this.listenTo(o,"change:value",(c,h,f)=>{a(f)}),this.listenTo(n,"navigate",(c,h,f)=>{const m=this._getLinkProviderLinkByHref(h);if(!m)return;const{provider:w,item:O}=m,{navigate:_}=w;_&&_(O)&&(c.stop(),f())}),n}),e.ui.componentFactory.add("unlink",i=>{const n=e.commands.get("unlink"),r=new ye(i),o=i.t;return r.set({label:o("Unlink"),icon:zz,tooltip:!0}),r.bind("isEnabled").to(n),this.listenTo(r,"execute",()=>{e.execute("unlink"),this._hideUI()}),r}),e.ui.componentFactory.add("editLink",i=>{const n=e.commands.get("link"),r=new ye(i),o=i.t;return r.set({label:o("Edit link"),icon:Fb,tooltip:!0}),r.bind("isEnabled").to(n),this.listenTo(r,"execute",()=>{this._addFormView()}),r}),e.ui.componentFactory.add("linkProperties",i=>{const n=e.commands.get("link"),r=new ye(i),o=i.t;return r.set({label:o("Link properties"),icon:Rz,tooltip:!0}),r.bind("isEnabled").to(n,"isEnabled",n,"value",n,"manualDecorators",(l,a,c)=>l&&!!a&&c.length>0),this.listenTo(r,"execute",()=>{this._addPropertiesView()}),r})}_createLinksListProviderButton(e){const i=this.editor.locale,n=new sY(i);return n.set({label:e.label}),this.listenTo(n,"execute",()=>{this._showLinksProviderView(e)}),n}_createButton(e){const i=this.editor,n=i.locale,r=i.commands.get("link"),o=new e(i.locale),l=n.t;return o.set({label:l("Link"),icon:YA,keystroke:Ku,isToggleable:!0}),o.bind("isEnabled").to(r,"isEnabled"),o.bind("isOn").to(r,"value",a=>!!a),this.listenTo(o,"execute",()=>{i.editing.view.scrollToTheSelection(),this._showUI(!0),this._getSelectedLinkElement()&&this._addFormView()}),o}_enableBalloonActivators(){const e=this.editor,i=e.editing.view.document;this.listenTo(i,"click",()=>{this._getSelectedLinkElement()&&this._showUI()}),e.keystrokes.set(Ku,(n,r)=>{r(),e.commands.get("link").isEnabled&&(e.editing.view.scrollToTheSelection(),this._showUI(!0))})}_enableUserBalloonInteractions(){this.editor.keystrokes.set("Tab",(e,i)=>{this._isToolbarVisible&&!this.toolbarView.focusTracker.isFocused&&(this.toolbarView.focus(),i())},{priority:"high"}),this.editor.keystrokes.set("Esc",(e,i)=>{this._isUIVisible&&(this._hideUI(),i())}),Fr({emitter:this.formView,activator:()=>this._isUIInPanel,contextElements:()=>[this._balloon.view.element],callback:()=>{this._hideUI(!1)}})}_addToolbarView(){this.toolbarView||this._createViews(),!this._isToolbarInPanel&&this._balloon.add({view:this.toolbarView,position:this._getBalloonPositionData(),balloonClassName:"ck-toolbar-container"})}_addFormView(){if(this.formView||this._createViews(),this._isFormInPanel)return;const e=this.editor.commands.get("link");this.formView.disableCssTransitions(),this.formView.resetFormStatus(),this.formView.backButtonView.isVisible=e.isEnabled&&!!e.value,this._balloon.add({view:this.formView,position:this._getBalloonPositionData()}),this.selectedLinkableText=this._getSelectedLinkableText(),this.formView.displayedTextInputView.fieldView.value=this.selectedLinkableText||"",this.formView.urlInputView.fieldView.value=e.value||"",this._balloon.visibleView===this.formView&&this.formView.urlInputView.fieldView.select(),this.formView.enableCssTransitions()}_addPropertiesView(){this.propertiesView||this._createViews(),!this._arePropertiesInPanel&&(this.propertiesView.disableCssTransitions(),this._balloon.add({view:this.propertiesView,position:this._getBalloonPositionData()}),this.propertiesView.enableCssTransitions(),this.propertiesView.focus())}_showLinksProviderView(e){this.linkProviderItemsView&&this._removeLinksProviderView(),this.linkProviderItemsView=this._createLinkProviderItemsView(e),this._addLinkProviderItemsView(e)}_addLinkProviderItemsView(e){this.linkProviderItemsView.listChildren.clear(),this.linkProviderItemsView.listChildren.addMany(this._createLinkProviderListView(e)),this._balloon.add({view:this.linkProviderItemsView,position:this._getBalloonPositionData()}),this.linkProviderItemsView.focus()}_closeFormView(){const e=this.editor.commands.get("link");this.selectedLinkableText=void 0,e.value!==void 0?this._removeFormView():this._hideUI()}_removePropertiesView(){this._arePropertiesInPanel&&this._balloon.remove(this.propertiesView)}_removeLinksProviderView(){this._isLinksListInPanel&&this._balloon.remove(this.linkProviderItemsView)}_removeFormView(e=!0){this._isFormInPanel&&(this.formView.saveButtonView.focus(),this.formView.displayedTextInputView.fieldView.reset(),this.formView.urlInputView.fieldView.reset(),this._balloon.remove(this.formView),e&&this.editor.editing.view.focus(),this._hideFakeVisualSelection())}_showUI(e=!1){this.formView||this._createViews(),this._getSelectedLinkElement()?(this._isToolbarVisible?this._addFormView():this._addToolbarView(),e&&this._balloon.showStack("main")):(this._showFakeVisualSelection(),this._addToolbarView(),e&&this._balloon.showStack("main"),this._addFormView()),this._startUpdatingUI()}_hideUI(e=!0){const i=this.editor;this._isUIInPanel&&(this.stopListening(i.ui,"update"),this.stopListening(this._balloon,"change:visibleView"),e&&i.editing.view.focus(),this._removeLinksProviderView(),this._removePropertiesView(),this._removeFormView(e),this._isToolbarInPanel&&this._balloon.remove(this.toolbarView),this._hideFakeVisualSelection())}_startUpdatingUI(){const e=this.editor,i=e.editing.view.document;let n=this._getSelectedLinkElement(),r=l();const o=()=>{const a=this._getSelectedLinkElement(),c=l();n&&!a||!n&&c!==r?this._hideUI():this._isUIVisible&&this._balloon.updatePosition(this._getBalloonPositionData()),n=a,r=c};function l(){return i.selection.focus.getAncestors().reverse().find(a=>a.is("element"))}this.listenTo(e.ui,"update",o),this.listenTo(this._balloon,"change:visibleView",o)}get _arePropertiesInPanel(){return!!this.propertiesView&&this._balloon.hasView(this.propertiesView)}get _isLinksListInPanel(){return!!this.linkProviderItemsView&&this._balloon.hasView(this.linkProviderItemsView)}get _isFormInPanel(){return!!this.formView&&this._balloon.hasView(this.formView)}get _isToolbarInPanel(){return!!this.toolbarView&&this._balloon.hasView(this.toolbarView)}get _isPropertiesVisible(){return!!this.propertiesView&&this._balloon.visibleView===this.propertiesView}get _isFormVisible(){return!!this.formView&&this._balloon.visibleView==this.formView}get _isToolbarVisible(){return!!this.toolbarView&&this._balloon.visibleView===this.toolbarView}get _isUIInPanel(){return this._arePropertiesInPanel||this._isLinksListInPanel||this._isFormInPanel||this._isToolbarInPanel}get _isUIVisible(){return this._isPropertiesVisible||this._isLinksListInPanel||this._isFormVisible||this._isToolbarVisible}_getBalloonPositionData(){const e=this.editor.editing.view,i=e.document;if(this.editor.model.markers.has(js)){const r=this.editor.editing.mapper.markerNameToElements(js);if(r){const o=Array.from(r),l=e.createRange(e.createPositionBefore(o[0]),e.createPositionAfter(o[o.length-1]));return{target:e.domConverter.viewRangeToDom(l)}}}return{target:()=>{const r=this._getSelectedLinkElement();return r?e.domConverter.mapViewToDom(r):e.domConverter.viewRangeToDom(i.selection.getFirstRange())}}}_getSelectedLinkElement(){const e=this.editor.editing.view,i=e.document.selection,n=i.getSelectedElement();if(i.isCollapsed||n&&Ut(n))return Mx(i.getFirstPosition());{const r=i.getFirstRange().getTrimmed(),o=Mx(r.start),l=Mx(r.end);return!o||o!=l?null:e.createRangeIn(o).getTrimmed().isEqual(r)?o:null}}_getSelectedLinkableText(){const e=this.editor.model,i=this.editor.editing,n=this._getSelectedLinkElement();if(!n)return i1(e.document.selection.getFirstRange());const r=i.view.createRangeOn(n),o=i.mapper.toModelRange(r);return i1(o)}_getLinkProviderLinkByHref(e){if(!e)return null;for(const i of this._linksProviders){const n=i.getItem?i.getItem(e):i.getListItems().find(r=>r.href===e);if(n)return{provider:i,item:n}}return null}_showFakeVisualSelection(){const e=this.editor.model;e.change(i=>{const n=e.document.selection.getFirstRange();if(e.markers.has(js))i.updateMarker(js,{range:n});else if(n.start.isAtEnd){const r=n.start.getLastMatchingPosition(({item:o})=>!e.schema.isContent(o),{boundaries:n});i.addMarker(js,{usingOperation:!1,affectsData:!1,range:i.createRange(r,n.end)})}else i.addMarker(js,{usingOperation:!1,affectsData:!1,range:n})})}_hideFakeVisualSelection(){const e=this.editor.model;e.markers.has(js)&&e.change(i=>{i.removeMarker(js)})}}function Mx(s){return s.getAncestors().find(t=>DG(t))||null}function rY(s){const t=s.t,e=s.config.get("link.allowCreatingEmptyLinks");return[i=>{if(!e&&!i.url.length)return t("Link URL must not be empty.")}]}const oY=4,Q7=new RegExp("(^|\\s)(((?:(?:(?:https?|ftp):)?\\/\\/)(?:\\S+(?::\\S*)?@)?(?:(?:[1-9]\\d?|1\\d\\d|2[01]\\d|22[0-3])(?:\\.(?:1?\\d{1,2}|2[0-4]\\d|25[0-5])){2}(?:\\.(?:[1-9]\\d?|1\\d\\d|2[0-4]\\d|25[0-4]))|(((?!www\\.)|(www\\.))(?![-_])(?:[-_a-z0-9\\u00a1-\\uffff]{1,63}\\.)+(?:[a-z\\u00a1-\\uffff]{2,63}))|localhost)(?::\\d{2,5})?(?:[/?#]\\S*)?)|((www.|(\\S+@))((?![-_])(?:[-_a-z0-9\\u00a1-\\uffff]{1,63}\\.))+(?:[a-z\\u00a1-\\uffff]{2,63})))$","i"),lY=2;class N7 extends F{static get requires(){return[Hl,wc]}static get pluginName(){return"AutoLink"}static get isOfficialPlugin(){return!0}init(){const e=this.editor.model.document.selection;e.on("change:range",()=>{this.isEnabled=!e.anchor.parent.is("element","codeBlock")}),this._enableTypingHandling()}afterInit(){this._enableEnterHandling(),this._enableShiftEnterHandling(),this._enablePasteLinking()}_expandLinkRange(t,e){return e.textNode&&e.textNode.hasAttribute("linkHref")?Ap(e,"linkHref",e.textNode.getAttribute("linkHref"),t):null}_selectEntireLinks(t,e){const n=this.editor.model,r=n.document.selection,o=r.getFirstPosition(),l=r.getLastPosition();let a=e.getJoined(this._expandLinkRange(n,o)||e);a&&(a=a.getJoined(this._expandLinkRange(n,l)||e)),a&&(a.start.isBefore(o)||a.end.isAfter(l))&&t.setSelection(a)}_enablePasteLinking(){const t=this.editor,e=t.model,i=e.document.selection,n=t.plugins.get("ClipboardPipeline"),r=t.commands.get("link");n.on("inputTransformation",(o,l)=>{if(!this.isEnabled||!r.isEnabled||i.isCollapsed||l.method!=="paste"||i.rangeCount>1)return;const a=i.getFirstRange(),c=l.dataTransfer.getData("text/plain");if(!c)return;const h=c.match(Q7);h&&h[2]===c&&(e.change(f=>{this._selectEntireLinks(f,a),r.execute(c)}),o.stop())},{priority:"high"})}_enableTypingHandling(){const t=this.editor,e=new dy(t.model,i=>{let n=i;if(!aY(n))return;n=n.slice(0,-1),"!.:,;?".includes(n[n.length-1])&&(n=n.slice(0,-1));const r=T5(n);if(r)return{url:r,removedTrailingCharacters:i.length-n.length}});e.on("matched:data",(i,n)=>{const{batch:r,range:o,url:l,removedTrailingCharacters:a}=n;if(!r.isTyping)return;const c=o.end.getShiftedBy(-a),h=c.getShiftedBy(-l.length),f=t.model.createRange(h,c);this._applyAutoLink(l,f)}),e.bind("isEnabled").to(this)}_enableEnterHandling(){const t=this.editor,e=t.model,i=t.commands.get("enter");i&&i.on("execute",()=>{var o;const n=e.document.selection.getFirstPosition();let r;(o=n.parent.previousSibling)!=null&&o.is("element")?r=e.createRangeIn(n.parent.previousSibling):r=e.createRange(e.createPositionAt(n.parent,0),n),this._checkAndApplyAutoLinkOnRange(r)})}_enableShiftEnterHandling(){const t=this.editor,e=t.model,i=t.commands.get("shiftEnter");i&&i.on("execute",()=>{const n=e.document.selection.getFirstPosition(),r=e.createRange(e.createPositionAt(n.parent,0),n.getShiftedBy(-1));this._checkAndApplyAutoLinkOnRange(r)})}_checkAndApplyAutoLinkOnRange(t){const e=this.editor.model,{text:i,range:n}=HI(t,e),r=T5(i);if(r){const o=e.createRange(n.end.getShiftedBy(-r.length),n.end);this._applyAutoLink(r,o)}}_applyAutoLink(t,e){const i=this.editor.model,n=this.editor.config.get("link.defaultProtocol"),r=Cy(t,n);!this.isEnabled||!cY(e,i)||!$7(r)||uY(e)||this._persistAutoLink(r,e)}_persistAutoLink(t,e){const i=this.editor.model,n=this.editor.plugins.get("Delete");i.enqueueChange(r=>{r.setAttribute("linkHref",t,e),i.enqueueChange(()=>{n.requestUndoOnBackspace()})})}}function aY(s){return s.length>oY&&s[s.length-1]===" "&&s[s.length-2]!==" "}function T5(s){const t=Q7.exec(s);return t?t[lY]:null}function cY(s,t){return t.schema.checkAttributeInSelection(t.createSelection(s),"linkHref")}function uY(s){const t=s.start.nodeAfter;return!!t&&t.hasAttribute("linkHref")}class hY extends F{static get requires(){return[wc,D7,N7]}static get pluginName(){return"Link"}static get isOfficialPlugin(){return!0}}class dY extends F{static get requires(){return["ImageEditing","ImageUtils",wc]}static get pluginName(){return"LinkImageEditing"}static get isOfficialPlugin(){return!0}afterInit(){const t=this.editor,e=t.model.schema;t.plugins.has("ImageBlockEditing")&&e.extend("imageBlock",{allowAttributes:["linkHref"]}),t.conversion.for("upcast").add(fY(t)),t.conversion.for("downcast").add(mY(t)),this._enableAutomaticDecorators(),this._enableManualDecorators()}_enableAutomaticDecorators(){const t=this.editor,i=t.commands.get("link").automaticDecorators;i.length&&t.conversion.for("downcast").add(i.getDispatcherForLinkedImage())}_enableManualDecorators(){const t=this.editor,e=t.commands.get("link");for(const i of e.manualDecorators)t.plugins.has("ImageBlockEditing")&&t.model.schema.extend("imageBlock",{allowAttributes:i.id}),t.plugins.has("ImageInlineEditing")&&t.model.schema.extend("imageInline",{allowAttributes:i.id}),t.conversion.for("downcast").add(gY(i)),t.conversion.for("upcast").add(pY(t,i))}}function fY(s){const t=s.plugins.has("ImageInlineEditing"),e=s.plugins.get("ImageUtils");return i=>{i.on("element:a",(n,r,o)=>{const l=r.viewItem,a=e.findViewImgElement(l);if(!a)return;const c=a.findAncestor(w=>e.isBlockImageView(w));if(t&&!c)return;const h={attributes:["href"]};if(!o.consumable.consume(l,h))return;const f=l.getAttribute("href");if(!f)return;let m=r.modelCursor.parent;if(!m.is("element","imageBlock")){const w=o.convertItem(a,r.modelCursor);r.modelRange=w.modelRange,r.modelCursor=w.modelCursor,m=r.modelCursor.nodeBefore}m&&m.is("element","imageBlock")&&o.writer.setAttribute("linkHref",f,m)},{priority:"high"})}}function mY(s){const t=s.plugins.get("ImageUtils");return e=>{e.on("attribute:linkHref:imageBlock",(i,n,r)=>{if(!r.consumable.consume(n.item,i.name))return;const o=r.mapper.toViewElement(n.item),l=r.writer,a=Array.from(o.getChildren()).find(f=>f.is("element","a")),c=t.findViewImgElement(o),h=c.parent.is("element","picture")?c.parent:c;if(a)n.attributeNewValue?l.setAttribute("href",n.attributeNewValue,a):(l.move(l.createRangeOn(h),l.createPositionAt(o,0)),l.remove(a));else{const f=l.createContainerElement("a",{href:n.attributeNewValue});l.insert(l.createPositionAt(o,0),f),l.move(l.createRangeOn(h),l.createPositionAt(f,0))}},{priority:"high"})}}function gY(s){return t=>{t.on(`attribute:${s.id}:imageBlock`,(e,i,n)=>{const r=n.mapper.toViewElement(i.item),o=Array.from(r.getChildren()).find(l=>l.is("element","a"));if(o){if(s.value===void 0){for(const l in s.attributes)n.writer.removeAttribute(l,o);s.classes&&n.writer.removeClass(s.classes,o);for(const l in s.styles)n.writer.removeStyle(l,o);return}for(const[l,a]of ms(s.attributes))n.writer.setAttribute(l,a,o);s.classes&&n.writer.addClass(s.classes,o);for(const l in s.styles)n.writer.setStyle(l,s.styles[l],o)}})}}function pY(s,t){const e=s.plugins.has("ImageInlineEditing"),i=s.plugins.get("ImageUtils");return n=>{n.on("element:a",(r,o,l)=>{const a=o.viewItem,c=i.findViewImgElement(a);if(!c)return;const h=c.findAncestor(O=>i.isBlockImageView(O));if(e&&!h)return;const m=new kn(t._createPattern()).match(a);if(!m||!l.consumable.consume(a,m.match))return;const w=o.modelCursor.nodeBefore||o.modelCursor.parent;l.writer.setAttribute(t.id,!0,w)},{priority:"high"})}}class wY extends F{static get requires(){return[wc,D7,"ImageBlockEditing"]}static get pluginName(){return"LinkImageUI"}static get isOfficialPlugin(){return!0}init(){const t=this.editor,e=t.editing.view.document;this.listenTo(e,"click",(i,n)=>{this._isSelectedLinkedImage(t.model.document.selection)&&(n.preventDefault(),i.stop())},{priority:"high"}),this._createToolbarLinkImageButton()}_createToolbarLinkImageButton(){const t=this.editor,e=t.t;t.ui.componentFactory.add("linkImage",i=>{const n=new ye(i),r=t.plugins.get("LinkUI"),o=t.commands.get("link");return n.set({isEnabled:!0,label:e("Link image"),icon:YA,keystroke:Ku,tooltip:!0,isToggleable:!0}),n.bind("isEnabled").to(o,"isEnabled"),n.bind("isOn").to(o,"value",l=>!!l),this.listenTo(n,"execute",()=>{this._isSelectedLinkedImage(t.model.document.selection)?r._addToolbarView():r._showUI(!0)}),n})}_isSelectedLinkedImage(t){const e=t.getSelectedElement();return this.editor.plugins.get("ImageUtils").isImage(e)&&e.hasAttribute("linkHref")}}class xY extends F{static get requires(){return[dY,wY]}static get pluginName(){return"LinkImage"}static get isOfficialPlugin(){return!0}}/**
 * @license Copyright (c) 2003-2025, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options
 */class ps{constructor(t,e){p(this,"_startElement");p(this,"_referenceIndent");p(this,"_isForward");p(this,"_includeSelf");p(this,"_sameAttributes");p(this,"_sameIndent");p(this,"_lowerIndent");p(this,"_higherIndent");this._startElement=t,this._referenceIndent=t.getAttribute("listIndent"),this._isForward=e.direction=="forward",this._includeSelf=!!e.includeSelf,this._sameAttributes=dt(e.sameAttributes||[]),this._sameIndent=!!e.sameIndent,this._lowerIndent=!!e.lowerIndent,this._higherIndent=!!e.higherIndent}static first(t,e){const n=new this(t,e)[Symbol.iterator]();return $t(n)}*[Symbol.iterator](){const t=[];for(const{node:e}of new gd(this._getStartNode(),this._isForward?"forward":"backward")){const i=e.getAttribute("listIndent");if(i<this._referenceIndent){if(!this._lowerIndent)break;this._referenceIndent=i}else if(i>this._referenceIndent){if(!this._higherIndent)continue;if(!this._isForward){t.push(e);continue}}else{if(!this._sameIndent){if(this._higherIndent){t.length&&(yield*t,t.length=0);break}continue}if(this._sameAttributes.some(n=>e.getAttribute(n)!==this._startElement.getAttribute(n)))break}t.length&&(yield*t,t.length=0),yield e}}_getStartNode(){return this._includeSelf?this._startElement:this._isForward?this._startElement.nextSibling:this._startElement.previousSibling}}class gd{constructor(t,e="forward"){p(this,"_node");p(this,"_isForward");p(this,"_previousNodesByIndent",[]);p(this,"_previous",null);p(this,"_previousNodeIndent",null);this._node=t,this._isForward=e==="forward"}[Symbol.iterator](){return this}next(){if(!At(this._node))return{done:!0,value:void 0};const t=this._node.getAttribute("listIndent");let e=null;if(this._previous){const n=this._previousNodeIndent;t>n?this._previousNodesByIndent[n]=this._previous:t<n?(e=this._previousNodesByIndent[t]||null,this._previousNodesByIndent.length=t):e=this._previous}const i={node:this._node,previous:this._previous,previousNodeInList:e};return this._previous=this._node,this._previousNodeIndent=t,this._node=this._isForward?this._node.nextSibling:this._node.previousSibling,{value:i,done:!1}}}class bY{constructor(t){p(this,"_listHead");this._listHead=t}[Symbol.iterator](){return new gd(this._listHead)}}class xc{static next(){return ei()}}function At(s){return!!s&&s.is("element")&&s.hasAttribute("listItemId")}function Py(s,t={}){return[...Mo(s,{...t,direction:"backward"}),...Mo(s,{...t,direction:"forward"})]}function Mo(s,t={}){const e=t.direction=="forward",i=Array.from(new ps(s,{...t,includeSelf:e,sameIndent:!0,sameAttributes:"listItemId"}));return e?i:i.reverse()}function OY(s){return Array.from(new ps(s,{direction:"forward",higherIndent:!0}))}function F7(s,t){const e=new ps(s,{sameIndent:!0,sameAttributes:"listType",...t}),i=new ps(s,{sameIndent:!0,sameAttributes:"listType",includeSelf:!0,direction:"forward",...t});return[...Array.from(e).reverse(),...i]}function Il(s){return!ps.first(s,{sameIndent:!0,sameAttributes:"listItemId"})}function E5(s){return!ps.first(s,{direction:"forward",sameIndent:!0,sameAttributes:"listItemId"})}function pd(s,t={}){s=dt(s);const e=t.withNested!==!1,i=new Set;for(const n of s)for(const r of Py(n,{higherIndent:e}))i.add(r);return ql(i)}function Mp(s){s=dt(s);const t=new Set;for(const e of s)for(const i of F7(e))t.add(i);return ql(t)}function Ty(s,t){const e=Mo(s,{direction:"forward"}),i=xc.next();for(const n of e)t.setAttribute("listItemId",i,n);return e}function n1(s,t,e){const i={};for(const[r,o]of t.getAttributes())r.startsWith("list")&&(i[r]=o);const n=Mo(s,{direction:"forward"});for(const r of n)e.setAttributes(i,r);return n}function s1(s,t,{expand:e,indentBy:i=1}={}){s=dt(s);const n=e?pd(s):s;for(const r of n){const o=r.getAttribute("listIndent")+i;o<0?Lp(r,t):t.setAttribute("listIndent",o,r)}return n}function yY(s,t){s=dt(s);const e=pd(s),i=new Set,n=Math.min(...e.map(o=>o.getAttribute("listIndent"))),r=new Map;for(const o of e)r.set(o,ps.first(o,{lowerIndent:!0}));for(const o of e){if(i.has(o))continue;i.add(o);const l=o.getAttribute("listIndent")-1;if(l<0){Lp(o,t);continue}if(o.getAttribute("listIndent")==n){const a=_Y(o,r.get(o),t);for(const c of a)i.add(c);if(a.length)continue}t.setAttribute("listIndent",l,o)}return ql(i)}function Lp(s,t){s=dt(s);for(const e of s)e.is("element","listItem")&&t.rename(e,"paragraph");for(const e of s)for(const i of e.getAttributeKeys())i.startsWith("list")&&t.removeAttribute(i,e);return s}function Dh(s){if(!s.length)return!1;const t=s[0].getAttribute("listItemId");return t?!s.some(e=>e.getAttribute("listItemId")!=t):!1}function vY(s,t){const e=[];let i=Number.POSITIVE_INFINITY;for(const{node:n}of new gd(s.nextSibling)){const r=n.getAttribute("listIndent");if(r==0)break;r<i&&(i=r);const o=r-i;t.setAttribute("listIndent",o,n),e.push(n)}return e}function ql(s){return Array.from(s).filter(t=>t.root.rootName!=="$graveyard").sort((t,e)=>t.index-e.index)}function Qh(s){const t=s.document.selection.getSelectedElement();return t&&s.schema.isObject(t)&&s.schema.isBlock(t)?t:null}function Lx(s,t){return t.checkChild(s.parent,"listItem")&&t.checkChild(s,"$text")&&!t.isObject(s)}function $g(s){return s=="numbered"||s=="customNumbered"}function _Y(s,t,e){return Mo(t,{direction:"forward"}).pop().index>s.index?n1(s,t,e):[]}class A5 extends Be{constructor(e,i){super(e);p(this,"_direction");this._direction=i}refresh(){this.isEnabled=this._checkEnabled()}execute(){const e=this.editor.model,i=I5(e.document.selection);e.change(n=>{const r=[];Dh(i)&&!Il(i[0])?(this._direction=="forward"&&r.push(...s1(i,n)),r.push(...Ty(i[0],n))):this._direction=="forward"?r.push(...s1(i,n,{expand:!0})):r.push(...yY(i,n));for(const o of r){if(!o.hasAttribute("listType"))continue;const l=ps.first(o,{sameIndent:!0});l&&n.setAttribute("listType",l.getAttribute("listType"),o)}this._fireAfterExecute(r)})}_fireAfterExecute(e){this.fire("afterExecute",ql(new Set(e)))}_checkEnabled(){let e=I5(this.editor.model.document.selection),i=e[0];if(!i)return!1;if(this._direction=="backward"||Dh(e)&&!Il(e[0]))return!0;e=pd(e),i=e[0];const n=ps.first(i,{sameIndent:!0});return n?n.getAttribute("listType")==i.getAttribute("listType"):!1}}function I5(s){const t=Array.from(s.getSelectedBlocks()),e=t.findIndex(i=>!At(i));return e!=-1&&(t.length=e),t}class sm extends Be{constructor(e,i,n={}){super(e);p(this,"type");p(this,"_listWalkerOptions");this.type=i,this._listWalkerOptions=n.multiLevel?{higherIndent:!0,lowerIndent:!0,sameAttributes:[]}:void 0}refresh(){this.value=this._getValue(),this.isEnabled=this._checkEnabled()}execute(e={}){const i=this.editor.model,n=i.document,r=Qh(i),o=Array.from(n.selection.getSelectedBlocks()).filter(a=>i.schema.checkAttribute(a,"listType")||Lx(a,i.schema)),l=e.forceValue!==void 0?!e.forceValue:this.value;i.change(a=>{if(l){const c=o[o.length-1],h=Mo(c,{direction:"forward"}),f=[];h.length>1&&f.push(...Ty(h[1],a)),f.push(...Lp(o,a)),f.push(...vY(c,a)),this._fireAfterExecute(f)}else if((r||n.selection.isCollapsed)&&At(o[0])){const c=F7(r||o[0],this._listWalkerOptions);for(const h of c)a.setAttributes({...e.additionalAttributes,listType:this.type},h);this._fireAfterExecute(c)}else{const c=[];for(const h of o)if(!h.hasAttribute("listType"))!h.is("element","listItem")&&Lx(h,i.schema)&&a.rename(h,"listItem"),a.setAttributes({...e.additionalAttributes,listIndent:0,listItemId:xc.next(),listType:this.type},h),c.push(h);else for(const f of pd(h,{withNested:!1}))f.getAttribute("listType")!=this.type&&(a.setAttributes({...e.additionalAttributes,listType:this.type},f),c.push(f));this._fireAfterExecute(c)}})}_fireAfterExecute(e){this.fire("afterExecute",ql(new Set(e)))}_getValue(){const e=this.editor.model.document.selection,i=Array.from(e.getSelectedBlocks());if(!i.length)return!1;for(const n of i)if(n.getAttribute("listType")!=this.type)return!1;return!0}_checkEnabled(){const e=this.editor.model,i=e.schema,n=e.document.selection,r=Array.from(n.getSelectedBlocks());if(!r.length)return!1;if(this.value)return!0;for(const o of r)if(i.checkAttribute(o,"listType")||Lx(o,i))return!0;return!1}}class R5 extends Be{constructor(e,i){super(e);p(this,"_direction");this._direction=i}refresh(){this.isEnabled=this._checkEnabled()}execute({shouldMergeOnBlocksContentLevel:e=!1}={}){const i=this.editor.model,n=i.document.selection,r=[];i.change(o=>{const{firstElement:l,lastElement:a}=this._getMergeSubjectElements(n,e),c=l.getAttribute("listIndent")||0,h=a.getAttribute("listIndent"),f=a.getAttribute("listItemId");if(c!=h){const m=OY(a);r.push(...s1([a,...m],o,{indentBy:c-h,expand:c<h}))}if(e){let m=n;n.isCollapsed&&(m=o.createSelection(o.createRange(o.createPositionAt(l,"end"),o.createPositionAt(a,0)))),i.deleteContent(m,{doNotResetEntireContent:n.isCollapsed});const w=m.getLastPosition().parent,O=w.nextSibling;r.push(w),O&&O!==a&&O.getAttribute("listItemId")==f&&r.push(...n1(O,w,o))}else r.push(...n1(a,l,o));this._fireAfterExecute(r)})}_fireAfterExecute(e){this.fire("afterExecute",ql(new Set(e)))}_checkEnabled(){const e=this.editor.model,i=e.document.selection,n=Qh(e);if(i.isCollapsed||n){const r=n||i.getFirstPosition().parent;if(!At(r))return!1;const o=this._direction=="backward"?r.previousSibling:r.nextSibling;if(!o||Dh([r,o]))return!1}else{const r=i.getLastPosition(),o=i.getFirstPosition();if(r.parent===o.parent||!At(r.parent))return!1}return!0}_getMergeSubjectElements(e,i){const n=this.editor.model,r=Qh(n);let o,l;if(e.isCollapsed||r){const a=r||e.getFirstPosition().parent,c=Il(a);this._direction=="backward"?(l=a,c&&!i?o=ps.first(a,{sameIndent:!0,lowerIndent:!0}):o=a.previousSibling):(o=a,l=a.nextSibling)}else o=e.getFirstPosition().parent,l=e.getLastPosition().parent;return{firstElement:o,lastElement:l}}}class V5 extends Be{constructor(e,i){super(e);p(this,"_direction");this._direction=i}refresh(){this.isEnabled=this._checkEnabled()}execute(){this.editor.model.change(i=>{const n=Ty(this._getStartBlock(),i);this._fireAfterExecute(n)})}_fireAfterExecute(e){this.fire("afterExecute",ql(new Set(e)))}_checkEnabled(){const e=this.editor.model.document.selection,i=this._getStartBlock();return e.isCollapsed&&At(i)&&!Il(i)}_getStartBlock(){const i=this.editor.model.document.selection.getFirstPosition().parent;return this._direction=="before"?i:i.nextSibling}}class kY extends F{static get pluginName(){return"ListUtils"}static get isOfficialPlugin(){return!0}expandListBlocksToCompleteList(t){return Mp(t)}isFirstBlockOfListItem(t){return Il(t)}isListItemBlock(t){return At(t)}expandListBlocksToCompleteItems(t,e={}){return pd(t,e)}isNumberedListType(t){return $g(t)}}/**
 * @license Copyright (c) 2003-2025, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options
 */function SY(s){return s.is("element","ol")||s.is("element","ul")}function r1(s){return s.is("element","li")}function CY(s){let t=0,e=s.parent;for(;e;){if(r1(e))t++;else{const i=e.previousSibling;i&&r1(i)&&t++}e=e.parent}return t}function PY(s,t,e,i=W7(e,t)){return s.createAttributeElement(z7(e),null,{priority:2*t/100-100,id:i})}function TY(s,t,e){return s.createAttributeElement("li",null,{priority:(2*t+1)/100-100,id:e})}function z7(s){return s=="numbered"||s=="customNumbered"?"ol":"ul"}function W7(s,t){return`list-${s}-${t}`}function Rs(s,t,e){const i=s.nodeBefore;if(At(i)){let n=i;for(const{node:r}of new gd(n,"backward"))if(n=r,e.has(n)||(e.add(n),t.has(i)))return;t.add(n)}else{const n=s.nodeAfter;At(n)&&t.add(n)}}function EY(s,t){let e=0,i=-1,n=null,r=!1;for(const{node:o}of s){const l=o.getAttribute("listIndent");if(l>e){let a;n===null?(n=l-e,a=e):(n>l&&(n=l),a=l-n),a>i+1&&(a=i+1),t.setAttribute("listIndent",a,o),r=!0,i=a}else n=null,e=l+1,i=l}return r}function AY(s,t,e){const i=new Set;let n=!1;for(const{node:r}of s){if(i.has(r))continue;let o=r.getAttribute("listType"),l=r.getAttribute("listItemId");if(t.has(l)&&(l=xc.next()),t.add(l),r.is("element","listItem")){r.getAttribute("listItemId")!=l&&(e.setAttribute("listItemId",l,r),n=!0);continue}for(const a of Mo(r,{direction:"forward"}))i.add(a),a.getAttribute("listType")!=o&&(l=xc.next(),o=a.getAttribute("listType")),a.getAttribute("listItemId")!=l&&(e.setAttribute("listItemId",l,a),n=!0)}return n}function IY(){return(s,t,e)=>{const{writer:i,schema:n}=e;if(!t.modelRange)return;const r=Array.from(t.modelRange.getItems({shallow:!0})).filter(f=>n.checkAttribute(f,"listItemId"));if(!r.length)return;const o=xc.next(),l=CY(t.viewItem);let a=t.viewItem.parent&&t.viewItem.parent.is("element","ol")?"numbered":"bulleted";const c=r[0].getAttribute("listType");c&&(a=c);const h={listItemId:o,listIndent:l,listType:a};for(const f of r)f.hasAttribute("listItemId")||i.setAttributes(h,f);r.length>1&&r[1].getAttribute("listItemId")!=h.listItemId&&e.keepEmptyElement(r[0])}}function RY(s,t,e,i){return()=>{const l=s.document.differ.getChanges(),a=[],c=new Set,h=new Set,f=new Set;for(const m of l)if(m.type=="insert"&&m.name!="$text")Rs(m.position,c,f),m.attributes.has("listItemId")?h.add(m.position.nodeAfter):Rs(m.position.getShiftedBy(m.length),c,f);else if(m.type=="remove"&&m.attributes.has("listItemId"))Rs(m.position,c,f);else if(m.type=="attribute"){const w=m.range.start.nodeAfter;e.includes(m.attributeKey)?(Rs(m.range.start,c,f),m.attributeNewValue===null?(Rs(m.range.start.getShiftedBy(1),c,f),r(w)&&a.push(w)):h.add(w)):At(w)&&r(w)&&a.push(w)}for(const m of c.values())a.push(...n(m,h));for(const m of new Set(a))t.reconvertItem(m)};function n(l,a){const c=[],h=new Set,f=[];for(const{node:m,previous:w}of new gd(l)){if(h.has(m))continue;const O=m.getAttribute("listIndent");w&&O<w.getAttribute("listIndent")&&(f.length=O+1),f[O]=Object.fromEntries(Array.from(m.getAttributes()).filter(([k])=>e.includes(k)));const _=Mo(m,{direction:"forward"});for(const k of _)h.add(k),(r(k,_)||o(k,f,a))&&c.push(k)}return c}function r(l,a){const c=t.mapper.toViewElement(l);if(!c)return!1;if(i.fire("checkElement",{modelElement:l,viewElement:c}))return!0;if(!l.is("element","paragraph")&&!l.is("element","listItem"))return!1;const f=Z7(l,e,a);return f&&c.is("element","p")?!0:!!(!f&&c.is("element","span"))}function o(l,a,c){if(c.has(l))return!1;const h=t.mapper.toViewElement(l);let f=a.length-1;for(let m=h.parent;!m.is("editableElement");m=m.parent){const w=r1(m),O=SY(m);if(!O&&!w)continue;const _=`checkAttributes:${w?"item":"list"}`;if(i.fire(_,{viewElement:m,modelAttributes:a[f]}))break;if(O&&(f--,f<0))return!1}return!0}}function M5(s,t,e,{dataPipeline:i}={}){const n=QY(s);return(r,o,l)=>{const{writer:a,mapper:c,consumable:h}=l,f=o.item;if(!s.includes(o.attributeKey)||!n(f,h))return;const m=MY(f,c,e);U7(m,a,c),$Y(m,a);const w=BY(f,m,t,a,{dataPipeline:i});DY(f,w,t,a)}}function VY(s){return(t,e,i)=>{const{writer:n,mapper:r}=i,o=t.name.split(":")[1];if(!s.checkAttribute(o,"listItemId"))return;const l=r.toViewPosition(e.position),a=e.position.getShiftedBy(e.length),c=r.toViewPosition(a,{isPhantom:!0}),f=n.createRange(l,c).getTrimmed().end.nodeBefore;/* istanbul ignore next -- @preserve */f&&U7(f,n,r)}}function L5(s,{dataPipeline:t}={}){return(e,{writer:i})=>{if(!Z7(e,s))return null;if(!t)return i.createContainerElement("span",{class:"ck-list-bogus-paragraph"});const n=i.createContainerElement("p");return i.setCustomProperty("dataPipeline:transparentRendering",!0,n),n}}function MY(s,t,e){const i=e.createRangeOn(s);return t.toViewRange(i).getTrimmed().end.nodeBefore}function LY(s,t){return(e,i)=>{if(i.modelPosition.offset>0)return;const n=i.modelPosition.parent;if(!At(n)||!s.some(c=>c.scope=="itemMarker"&&c.canInjectMarkerIntoElement&&c.canInjectMarkerIntoElement(n)))return;const r=i.mapper.toViewElement(n),o=t.createRangeIn(r),l=o.getWalker();let a=o.start;for(const{item:c}of l){if(c.is("element")&&i.mapper.toModelElement(c)||c.is("$textProxy"))break;c.is("element")&&c.getCustomProperty("listItemMarker")&&(a=t.createPositionAfter(c),l.skip(({previousPosition:h})=>!h.isEqual(a)))}i.viewPosition=a}}function U7(s,t,e){for(;s.parent.is("attributeElement")&&s.parent.getCustomProperty("listItemWrapper");)t.unwrap(t.createRangeOn(s),s.parent);const i=[];n(t.createPositionBefore(s).getWalker({direction:"backward"})),n(t.createRangeIn(s).getWalker());for(const r of i)t.remove(r);function n(r){for(const{item:o}of r){if(o.is("element")&&e.toModelElement(o))break;o.is("element")&&o.getCustomProperty("listItemMarker")&&i.push(o)}}}function BY(s,t,e,i,{dataPipeline:n}){let r=i.createRangeOn(t);if(!Il(s))return r;for(const o of e){if(o.scope!="itemMarker")continue;const l=o.createElement(i,s,{dataPipeline:n});if(!l||(i.setCustomProperty("listItemMarker",!0,l),o.canInjectMarkerIntoElement&&o.canInjectMarkerIntoElement(s)?i.insert(i.createPositionAt(t,0),l):(i.insert(r.start,l),r=i.createRange(i.createPositionBefore(l),i.createPositionAfter(t))),!o.createWrapperElement||!o.canWrapElement))continue;const a=o.createWrapperElement(i,s,{dataPipeline:n});i.setCustomProperty("listItemWrapper",!0,a),o.canWrapElement(s)?r=i.wrap(r,a):(r=i.wrap(i.createRangeOn(l),a),r=i.createRange(r.start,i.createPositionAfter(t)))}return r}function $Y(s,t){let e=s.parent;for(;e.is("attributeElement")&&["ul","ol","li"].includes(e.name);){const i=e.parent;t.unwrap(t.createRangeOn(s),e),e=i}}function DY(s,t,e,i){if(!s.hasAttribute("listIndent"))return;const n=s.getAttribute("listIndent");let r=s;for(let o=n;o>=0;o--){const l=TY(i,o,r.getAttribute("listItemId")),a=PY(i,o,r.getAttribute("listType"));for(const c of e)(c.scope=="list"||c.scope=="item")&&r.hasAttribute(c.attributeName)&&c.setAttributeOnDowncast(i,r.getAttribute(c.attributeName),c.scope=="list"?a:l);if(t=i.wrap(t,l),t=i.wrap(t,a),o==0||(r=ps.first(r,{lowerIndent:!0}),!r))break}}function QY(s){return(t,e)=>{const i=[];for(const n of s)t.hasAttribute(n)&&i.push(`attribute:${n}`);return i.every(n=>e.test(t,n)!==!1)?(i.forEach(n=>e.consume(t,n)),!0):!1}}function Z7(s,t,e=Py(s)){if(!At(s))return!1;for(const i of s.getAttributeKeys())if(!(i.startsWith("selection:")||i=="htmlEmptyBlock")&&!t.includes(i))return!1;return e.length<2}const Fm=["listType","listIndent","listItemId"];class o1 extends F{constructor(e){super(e);p(this,"_downcastStrategies",[]);e.config.define("list.multiBlock",!0)}static get pluginName(){return"ListEditing"}static get isOfficialPlugin(){return!0}static get requires(){return[Ip,Hl,kY,on]}init(){const e=this.editor,i=e.model,n=e.config.get("list.multiBlock");if(e.plugins.has("LegacyListEditing"))throw new E("list-feature-conflict",this,{conflictPlugin:"LegacyListEditing"});i.schema.register("$listItem",{allowAttributes:Fm}),n?(i.schema.extend("$container",{allowAttributesOf:"$listItem"}),i.schema.extend("$block",{allowAttributesOf:"$listItem"}),i.schema.extend("$blockObject",{allowAttributesOf:"$listItem"})):i.schema.register("listItem",{inheritAllFrom:"$block",allowAttributesOf:"$listItem"});for(const r of Fm)i.schema.setAttributeProperties(r,{copyOnReplace:!0});e.commands.add("numberedList",new sm(e,"numbered")),e.commands.add("bulletedList",new sm(e,"bulleted")),e.commands.add("customNumberedList",new sm(e,"customNumbered",{multiLevel:!0})),e.commands.add("customBulletedList",new sm(e,"customBulleted",{multiLevel:!0})),e.commands.add("indentList",new A5(e,"forward")),e.commands.add("outdentList",new A5(e,"backward")),e.commands.add("splitListItemBefore",new V5(e,"before")),e.commands.add("splitListItemAfter",new V5(e,"after")),n&&(e.commands.add("mergeListItemBackward",new R5(e,"backward")),e.commands.add("mergeListItemForward",new R5(e,"forward"))),this._setupDeleteIntegration(),this._setupEnterIntegration(),this._setupTabIntegration(),this._setupClipboardIntegration(),this._setupAccessibilityIntegration()}afterInit(){const i=this.editor.commands,n=i.get("indent"),r=i.get("outdent");n&&n.registerChildCommand(i.get("indentList"),{priority:"high"}),r&&r.registerChildCommand(i.get("outdentList"),{priority:"lowest"}),this._setupModelPostFixing(),this._setupConversion()}registerDowncastStrategy(e){this._downcastStrategies.push(e)}getListAttributeNames(){return[...Fm,...this._downcastStrategies.map(e=>e.attributeName)]}_setupDeleteIntegration(){const e=this.editor,i=e.commands.get("mergeListItemBackward"),n=e.commands.get("mergeListItemForward");this.listenTo(e.editing.view.document,"delete",(r,o)=>{const l=e.model.document.selection;Qh(e.model)||e.model.change(()=>{const a=l.getFirstPosition();if(l.isCollapsed&&o.direction=="backward"){if(!a.isAtStart)return;const c=a.parent;if(!At(c))return;if(!ps.first(c,{sameAttributes:"listType",sameIndent:!0})&&c.getAttribute("listIndent")===0)E5(c)||e.execute("splitListItemAfter"),e.execute("outdentList");else{if(!i||!i.isEnabled)return;i.execute({shouldMergeOnBlocksContentLevel:B5(e.model,"backward")})}o.preventDefault(),r.stop()}else{if(l.isCollapsed&&!l.getLastPosition().isAtEnd||!n||!n.isEnabled)return;n.execute({shouldMergeOnBlocksContentLevel:B5(e.model,"forward")}),o.preventDefault(),r.stop()}})},{context:"li"})}_setupEnterIntegration(){const e=this.editor,i=e.model,n=e.commands,r=n.get("enter");this.listenTo(e.editing.view.document,"enter",(o,l)=>{const a=i.document,c=a.selection.getFirstPosition().parent;if(a.selection.isCollapsed&&At(c)&&c.isEmpty&&!l.isSoft){const h=Il(c),f=E5(c);h&&f?(e.execute("outdentList"),l.preventDefault(),o.stop()):h&&!f?(e.execute("splitListItemAfter"),l.preventDefault(),o.stop()):f&&(e.execute("splitListItemBefore"),l.preventDefault(),o.stop())}},{context:"li"}),this.listenTo(r,"afterExecute",()=>{const o=n.get("splitListItemBefore");if(o.refresh(),!o.isEnabled)return;const a=e.model.document.selection.getLastPosition().parent;Py(a).length===2&&o.execute()})}_setupTabIntegration(){const e=this.editor;this.listenTo(e.editing.view.document,"tab",(i,n)=>{const r=n.shiftKey?"outdentList":"indentList";this.editor.commands.get(r).isEnabled&&(e.execute(r),n.stopPropagation(),n.preventDefault(),i.stop())},{context:"li"})}_setupConversion(){const e=this.editor,i=e.model,n=this.getListAttributeNames(),r=e.config.get("list.multiBlock"),o=r?"paragraph":"listItem";e.conversion.for("upcast").elementToElement({view:"li",model:(a,{writer:c})=>c.createElement(o,{listType:""})}).elementToElement({view:"p",model:(a,{writer:c})=>a.parent&&a.parent.is("element","li")?c.createElement(o,{listType:""}):null,converterPriority:"high"}).add(a=>{a.on("element:li",IY())}),r||e.conversion.for("downcast").elementToElement({model:"listItem",view:"p"}),e.conversion.for("editingDowncast").elementToElement({model:o,view:L5(n),converterPriority:"high"}).add(a=>{a.on("attribute",M5(n,this._downcastStrategies,i)),a.on("remove",VY(i.schema))}),e.conversion.for("dataDowncast").elementToElement({model:o,view:L5(n,{dataPipeline:!0}),converterPriority:"high"}).add(a=>{a.on("attribute",M5(n,this._downcastStrategies,i,{dataPipeline:!0}))});const l=LY(this._downcastStrategies,e.editing.view);e.editing.mapper.on("modelToViewPosition",l),e.data.mapper.on("modelToViewPosition",l),this.listenTo(i.document,"change:data",RY(i,e.editing,n,this),{priority:"high"}),this.on("checkAttributes:item",(a,{viewElement:c,modelAttributes:h})=>{c.id!=h.listItemId&&(a.return=!0,a.stop())}),this.on("checkAttributes:list",(a,{viewElement:c,modelAttributes:h})=>{(c.name!=z7(h.listType)||c.id!=W7(h.listType,h.listIndent))&&(a.return=!0,a.stop())})}_setupModelPostFixing(){const e=this.editor.model,i=this.getListAttributeNames();e.document.registerPostFixer(n=>NY(e,n,i,this)),this.on("postFixer",(n,{listNodes:r,writer:o})=>{n.return=EY(r,o)||n.return},{priority:"high"}),this.on("postFixer",(n,{listNodes:r,writer:o,seenIds:l})=>{n.return=AY(r,l,o)||n.return},{priority:"high"})}_setupClipboardIntegration(){const e=this.editor.model,i=this.editor.plugins.get("ClipboardPipeline");this.listenTo(e,"insertContent",FY(e),{priority:"high"}),this.listenTo(i,"outputTransformation",(n,r)=>{e.change(o=>{const l=Array.from(r.content.getChildren()),a=l[l.length-1];if(l.length>1&&a.is("element")&&a.isEmpty&&l.slice(0,-1).every(At)&&o.remove(a),r.method=="copy"||r.method=="cut"){const c=Array.from(r.content.getChildren());Dh(c)&&Lp(c,o)}})})}_setupAccessibilityIntegration(){const e=this.editor,i=e.t;e.accessibility.addKeystrokeInfoGroup({id:"list",label:i("Keystrokes that can be used in a list"),keystrokes:[{label:i("Increase list item indent"),keystroke:"Tab"},{label:i("Decrease list item indent"),keystroke:"Shift+Tab"}]})}}function NY(s,t,e,i){const n=s.document.differ.getChanges(),r=new Set,o=new Set,l=i.editor.config.get("list.multiBlock");let a=!1;for(const h of n){if(h.type=="insert"&&h.name!="$text"){const f=h.position.nodeAfter;if(!s.schema.checkAttribute(f,"listItemId"))for(const m of Array.from(f.getAttributeKeys()))e.includes(m)&&(t.removeAttribute(m,f),a=!0);Rs(h.position,o,r),h.attributes.has("listItemId")||Rs(h.position.getShiftedBy(h.length),o,r);for(const{item:m,previousPosition:w}of s.createRangeIn(f))At(m)&&Rs(w,o,r)}else h.type=="remove"?Rs(h.position,o,r):h.type=="attribute"&&e.includes(h.attributeKey)&&(Rs(h.range.start,o,r),h.attributeNewValue===null&&Rs(h.range.start.getShiftedBy(1),o,r));if(!l&&h.type=="attribute"&&Fm.includes(h.attributeKey)){const f=h.range.start.nodeAfter;h.attributeNewValue===null&&f&&f.is("element","listItem")?(t.rename(f,"paragraph"),a=!0):h.attributeOldValue===null&&f&&f.is("element")&&f.name!="listItem"&&(t.rename(f,"listItem"),a=!0)}}const c=new Set;for(const h of o.values())a=i.fire("postFixer",{listNodes:new bY(h),listHead:h,writer:t,seenIds:c})||a;return a}function FY(s){return(t,[e,i])=>{const n=e.is("documentFragment")?Array.from(e.getChildren()):[e];if(!n.length)return;const o=(i?s.createSelection(i):s.document.selection).getFirstPosition();let l;if(At(o.parent))l=o.parent;else if(At(o.nodeBefore)&&At(o.nodeAfter))l=o.nodeBefore;else return;s.change(a=>{const c=l.getAttribute("listType"),h=l.getAttribute("listIndent"),f=n[0].getAttribute("listIndent")||0,m=Math.max(h-f,0);for(const w of n){const O=At(w);l.is("element","listItem")&&w.is("element","paragraph")&&a.rename(w,"listItem"),a.setAttributes({listIndent:(O?w.getAttribute("listIndent"):0)+m,listItemId:O?w.getAttribute("listItemId"):xc.next(),listType:c},w)}})}}function B5(s,t){const e=s.document.selection;if(!e.isCollapsed)return!Qh(s);if(t==="forward")return!0;const n=e.getFirstPosition().parent,r=n.previousSibling;return s.schema.isObject(r)?!1:r.isEmpty?!0:Dh([n,r])}function $5(s,t,e,i){s.ui.componentFactory.add(t,()=>{const n=D5(ye,s,t,e,i);return n.set({tooltip:!0,isToggleable:!0}),n}),s.ui.componentFactory.add(`menuBar:${t}`,()=>{const n=D5(ti,s,t,e,i);return n.set({role:"menuitemcheckbox",isToggleable:!0}),n})}function D5(s,t,e,i,n){const r=t.commands.get(e),o=new s(t.locale);return o.set({label:i,icon:n}),o.bind("isOn","isEnabled").to(r,"value","isEnabled"),o.on("execute",()=>{t.execute(e),t.editing.view.focus()}),o}class zY extends F{static get pluginName(){return"ListUI"}static get isOfficialPlugin(){return!0}init(){const t=this.editor.t;this.editor.ui.componentFactory.has("numberedList")||$5(this.editor,"numberedList",t("Numbered List"),ty),this.editor.ui.componentFactory.has("bulletedList")||$5(this.editor,"bulletedList",t("Bulleted List"),ey)}}class WY extends F{static get requires(){return[o1,zY]}static get pluginName(){return"List"}static get isOfficialPlugin(){return!0}}class UY extends Be{refresh(){const t=this._getValue();this.value=t,this.isEnabled=t!=null}execute({startIndex:t=1}={}){const e=this.editor.model,i=e.document;let n=Array.from(i.selection.getSelectedBlocks()).filter(r=>At(r)&&$g(r.getAttribute("listType")));n=Mp(n),e.change(r=>{for(const o of n)r.setAttribute("listStart",t>=0?t:1,o)})}_getValue(){const e=this.editor.model.document,i=$t(e.selection.getSelectedBlocks());return i&&At(i)&&$g(i.getAttribute("listType"))?i.getAttribute("listStart"):null}}/**
 * @license Copyright (c) 2003-2025, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options
 */const H7={},q7={},j7={},X7=[{listStyle:"disc",typeAttribute:"disc",listType:"bulleted"},{listStyle:"circle",typeAttribute:"circle",listType:"bulleted"},{listStyle:"square",typeAttribute:"square",listType:"bulleted"},{listStyle:"decimal",typeAttribute:"1",listType:"numbered"},{listStyle:"decimal-leading-zero",typeAttribute:null,listType:"numbered"},{listStyle:"lower-roman",typeAttribute:"i",listType:"numbered"},{listStyle:"upper-roman",typeAttribute:"I",listType:"numbered"},{listStyle:"lower-alpha",typeAttribute:"a",listType:"numbered"},{listStyle:"upper-alpha",typeAttribute:"A",listType:"numbered"},{listStyle:"lower-latin",typeAttribute:"a",listType:"numbered"},{listStyle:"upper-latin",typeAttribute:"A",listType:"numbered"}];for(const{listStyle:s,typeAttribute:t,listType:e}of X7)H7[s]=e,q7[s]=t,t&&(j7[t]=s);function G7(){return X7.map(s=>s.listStyle)}function Ey(s){return H7[s]||null}function Y7(s){return j7[s]||null}function l1(s){return q7[s]||null}function ZY(s){switch(s){case"lower-alpha":return"lower-latin";case"upper-alpha":return"upper-latin";default:return s}}class HY extends Be{constructor(e,i,n){super(e);p(this,"defaultType");p(this,"_supportedTypes");this.defaultType=i,this._supportedTypes=n}refresh(){this.value=this._getValue(),this.isEnabled=this._checkEnabled()}execute(e={}){const i=this.editor.model,n=i.document;i.change(r=>{this._tryToConvertItemsToList(e);let o=Array.from(n.selection.getSelectedBlocks()).filter(l=>l.hasAttribute("listType"));if(o.length){o=Mp(o);for(const l of o)r.setAttribute("listStyle",e.type||this.defaultType,l)}})}isStyleTypeSupported(e){return this._supportedTypes?this._supportedTypes.includes(e):!0}_getValue(){const e=$t(this.editor.model.document.selection.getSelectedBlocks());return At(e)?e.getAttribute("listStyle"):null}_checkEnabled(){const e=this.editor,i=e.commands.get("numberedList"),n=e.commands.get("bulletedList");return i.isEnabled||n.isEnabled}_tryToConvertItemsToList(e){if(!e.type)return;const i=Ey(e.type);if(!i)return;const n=this.editor,r=`${i}List`;n.commands.get(r).value||n.execute(r)}}class qY extends Be{refresh(){const t=this._getValue();this.value=t,this.isEnabled=t!=null}execute(t={}){const e=this.editor.model,i=e.document;let n=Array.from(i.selection.getSelectedBlocks()).filter(r=>At(r)&&r.getAttribute("listType")=="numbered");n=Mp(n),e.change(r=>{for(const o of n)r.setAttribute("listReversed",!!t.reversed,o)})}_getValue(){const e=this.editor.model.document,i=$t(e.selection.getSelectedBlocks());return At(i)&&i.getAttribute("listType")=="numbered"?i.getAttribute("listReversed"):null}}/**
 * @license Copyright (c) 2003-2025, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options
 */function Q5(s){return(t,e,i)=>{const{writer:n,schema:r,consumable:o}=i;if(o.test(e.viewItem,s.viewConsumables)===!1)return;e.modelRange||Object.assign(e,i.convertChildren(e.viewItem,e.modelCursor));let l=!1;for(const a of e.modelRange.getItems({shallow:!0}))r.checkAttribute(a,s.attributeName)&&s.appliesToListItem(a)&&(a.hasAttribute(s.attributeName)||(n.setAttribute(s.attributeName,s.getAttributeOnUpcast(e.viewItem),a),l=!0));l&&o.consume(e.viewItem,s.viewConsumables)}}class jY extends F{static get pluginName(){return"ListPropertiesUtils"}static get isOfficialPlugin(){return!0}getAllSupportedStyleTypes(){return G7()}getListTypeFromListStyleType(t){return Ey(t)}getListStyleTypeFromTypeAttribute(t){return Y7(t)}getTypeAttributeFromListStyleType(t){return l1(t)}}function K7(s){const{startIndex:t,reversed:e,styles:i}=s;return{styles:XY(i),startIndex:t||!1,reversed:e||!1}}function XY(s){const t={listTypes:["bulleted","numbered"],useAttribute:!1};return s===!0||(s?Array.isArray(s)||typeof s=="string"?t.listTypes=dt(s):(t.listTypes=s.listTypes?dt(s.listTypes):t.listTypes,t.useAttribute=!!s.useAttribute,s.listStyleTypes&&(t.listStyleTypes=s.listStyleTypes)):t.listTypes=[]),t}const Lu="default";class GY extends F{static get requires(){return[o1,jY]}static get pluginName(){return"ListPropertiesEditing"}static get isOfficialPlugin(){return!0}constructor(t){super(t),t.config.define("list.properties",{styles:!0,startIndex:!1,reversed:!1})}init(){const t=this.editor,e=t.model,i=t.plugins.get(o1),n=t.config.get("list.properties"),r=YY(n);for(const o of r)o.addCommand(t),e.schema.extend("$listItem",{allowAttributes:o.attributeName}),i.registerDowncastStrategy({scope:"list",attributeName:o.attributeName,setAttributeOnDowncast(l,a,c){o.setAttributeOnDowncast(l,a,c)}});t.conversion.for("upcast").add(o=>{for(const l of r)o.on("element:ol",Q5(l)),o.on("element:ul",Q5(l))}),i.on("checkAttributes:list",(o,{viewElement:l,modelAttributes:a})=>{for(const c of r)c.getAttributeOnUpcast(l)!=a[c.attributeName]&&(o.return=!0,o.stop())}),this.listenTo(t.commands.get("indentList"),"afterExecute",(o,l)=>{e.change(a=>{for(const c of l)for(const h of r)h.appliesToListItem(c)&&a.setAttribute(h.attributeName,h.defaultValue,c)})}),i.on("postFixer",(o,{listNodes:l,writer:a})=>{for(const{node:c}of l)for(const h of r)h.hasValidAttribute(c)||(h.appliesToListItem(c)?a.setAttribute(h.attributeName,h.defaultValue,c):a.removeAttribute(h.attributeName,c),o.return=!0)}),i.on("postFixer",(o,{listNodes:l,writer:a})=>{for(const{node:c,previousNodeInList:h}of l)if(h&&h.getAttribute("listType")==c.getAttribute("listType"))for(const f of r){const{attributeName:m}=f;if(!f.appliesToListItem(c))continue;const w=h.getAttribute(m);c.getAttribute(m)!=w&&(a.setAttribute(m,w,c),o.return=!0)}})}}function YY(s){const t=[],e=K7(s);if(s.styles){const i=e.styles.useAttribute;t.push({attributeName:"listStyle",defaultValue:Lu,viewConsumables:{styles:"list-style-type"},addCommand(n){let r=G7();i&&(r=r.filter(o=>!!l1(o))),n.commands.add("listStyle",new HY(n,Lu,r))},appliesToListItem(n){return n.getAttribute("listType")=="numbered"||n.getAttribute("listType")=="bulleted"},hasValidAttribute(n){if(!this.appliesToListItem(n))return!n.hasAttribute("listStyle");if(!n.hasAttribute("listStyle"))return!1;const r=n.getAttribute("listStyle");return r==Lu?!0:Ey(r)==n.getAttribute("listType")},setAttributeOnDowncast(n,r,o){if(r&&r!==Lu)if(i){const l=l1(r);if(l){n.setAttribute("type",l,o);return}}else{n.setStyle("list-style-type",r,o);return}n.removeStyle("list-style-type",o),n.removeAttribute("type",o)},getAttributeOnUpcast(n){const r=n.getStyle("list-style-type");if(r)return ZY(r);const o=n.getAttribute("type");return o?Y7(o):Lu}})}return s.reversed&&t.push({attributeName:"listReversed",defaultValue:!1,viewConsumables:{attributes:"reversed"},addCommand(i){i.commands.add("listReversed",new qY(i))},appliesToListItem(i){return i.getAttribute("listType")=="numbered"},hasValidAttribute(i){return this.appliesToListItem(i)==i.hasAttribute("listReversed")},setAttributeOnDowncast(i,n,r){n?i.setAttribute("reversed","reversed",r):i.removeAttribute("reversed",r)},getAttributeOnUpcast(i){return i.hasAttribute("reversed")}}),s.startIndex&&t.push({attributeName:"listStart",defaultValue:1,viewConsumables:{attributes:"start"},addCommand(i){i.commands.add("listStart",new UY(i))},appliesToListItem(i){return $g(i.getAttribute("listType"))},hasValidAttribute(i){return this.appliesToListItem(i)==i.hasAttribute("listStart")},setAttributeOnDowncast(i,n,r){n==0||n>1?i.setAttribute("start",n,r):i.removeAttribute("start",r)},getAttributeOnUpcast(i){const n=i.getAttribute("start");return n>=0?n:1}}),t}class J7 extends ue{constructor(e,{enabledProperties:i,styleButtonViews:n,styleGridAriaLabel:r}){super(e);p(this,"children");p(this,"stylesView",null);p(this,"additionalPropertiesCollapsibleView",null);p(this,"startIndexFieldView",null);p(this,"reversedSwitchButtonView",null);p(this,"focusTracker",new ot);p(this,"keystrokes",new wt);p(this,"focusables",new fi);p(this,"focusCycler");const o=["ck","ck-list-properties"];this.children=this.createCollection(),this.focusCycler=new Ht({focusables:this.focusables,focusTracker:this.focusTracker,keystrokeHandler:this.keystrokes,actions:{focusPrevious:"shift + tab",focusNext:"tab"}}),n&&n.length?(this.stylesView=this._createStylesView(n,r),this.children.add(this.stylesView)):o.push("ck-list-properties_without-styles"),(i.startIndex||i.reversed)&&(this._addNumberedListPropertyViews(i),o.push("ck-list-properties_with-numbered-properties")),this.setTemplate({tag:"div",attributes:{class:o},children:this.children})}render(){if(super.render(),this.stylesView){this.focusables.add(this.stylesView),this.focusTracker.add(this.stylesView.element),(this.startIndexFieldView||this.reversedSwitchButtonView)&&(this.focusables.add(this.children.last.buttonView),this.focusTracker.add(this.children.last.buttonView.element));for(const e of this.stylesView.children)this.stylesView.focusTracker.add(e.element);Ep({keystrokeHandler:this.stylesView.keystrokes,focusTracker:this.stylesView.focusTracker,gridItems:this.stylesView.children,numberOfColumns:()=>he.window.getComputedStyle(this.stylesView.element).getPropertyValue("grid-template-columns").split(" ").length,uiLanguageDirection:this.locale&&this.locale.uiLanguageDirection})}if(this.startIndexFieldView){this.focusables.add(this.startIndexFieldView),this.focusTracker.add(this.startIndexFieldView.element);const e=i=>i.stopPropagation();this.keystrokes.set("arrowright",e),this.keystrokes.set("arrowleft",e),this.keystrokes.set("arrowup",e),this.keystrokes.set("arrowdown",e)}this.reversedSwitchButtonView&&(this.focusables.add(this.reversedSwitchButtonView),this.focusTracker.add(this.reversedSwitchButtonView.element)),this.keystrokes.listenTo(this.element)}focus(){this.focusCycler.focusFirst()}focusLast(){this.focusCycler.focusLast()}destroy(){super.destroy(),this.focusTracker.destroy(),this.keystrokes.destroy()}_createStylesView(e,i){const n=new ue(this.locale);return n.children=n.createCollection(),n.children.addMany(e),n.setTemplate({tag:"div",attributes:{"aria-label":i,class:["ck","ck-list-styles-list"]},children:n.children}),n.children.delegate("execute").to(this),n.focus=function(){for(const r of this.children)if(r instanceof ye&&r.isOn){r.focus();return}this.children.first.focus()},n.focusTracker=new ot,n.keystrokes=new wt,n.render(),n.keystrokes.listenTo(n.element),n}_addNumberedListPropertyViews(e){const i=this.locale.t,n=[];e.startIndex&&(this.startIndexFieldView=this._createStartIndexField(),n.push(this.startIndexFieldView)),e.reversed&&(this.reversedSwitchButtonView=this._createReversedSwitchButton(),n.push(this.reversedSwitchButtonView)),this.stylesView?(this.additionalPropertiesCollapsibleView=new pI(this.locale,n),this.additionalPropertiesCollapsibleView.set({label:i("List properties"),isCollapsed:!0}),this.additionalPropertiesCollapsibleView.buttonView.bind("isEnabled").toMany(n,"isEnabled",(...r)=>r.some(o=>o)),this.additionalPropertiesCollapsibleView.buttonView.on("change:isEnabled",(r,o,l)=>{l||(this.additionalPropertiesCollapsibleView.isCollapsed=!0)}),this.children.add(this.additionalPropertiesCollapsibleView)):this.children.addMany(n)}_createStartIndexField(){const e=this.locale.t,i=new Yt(this.locale,II);return i.set({label:e("Start at"),class:"ck-numbered-list-properties__start-index"}),i.fieldView.set({min:0,step:1,value:1,inputMode:"numeric"}),i.fieldView.on("input",()=>{const n=i.fieldView.element,r=n.valueAsNumber;if(Number.isNaN(r)){i.errorText=e("Invalid start index value.");return}n.checkValidity()?this.fire("listStart",{startIndex:r}):i.errorText=e("Start index must be greater than 0.")}),i}_createReversedSwitchButton(){const e=this.locale.t,i=new dd(this.locale);return i.set({withText:!0,label:e("Reversed order"),class:"ck-numbered-list-properties__reversed-order"}),i.delegate("execute").to(this,"listReversed"),i}}class KY extends F{static get pluginName(){return"ListPropertiesUI"}static get isOfficialPlugin(){return!0}init(){const t=this.editor,e=t.locale.t,i=t.config.get("list.properties"),n=K7(i),r=n.styles.listTypes;if(r.includes("bulleted")){const o=[{label:e("Toggle the disc list style"),tooltip:e("Disc"),type:"disc",icon:fz},{label:e("Toggle the circle list style"),tooltip:e("Circle"),type:"circle",icon:uz},{label:e("Toggle the square list style"),tooltip:e("Square"),type:"square",icon:pz}],l=e("Bulleted List"),a=e("Bulleted list styles toolbar"),c="bulletedList";t.ui.componentFactory.add(c,N5({editor:t,normalizedConfig:n,parentCommandName:c,buttonLabel:l,buttonIcon:ey,styleGridAriaLabel:a,styleDefinitions:o})),t.ui.componentFactory.add(`menuBar:${c}`,F5({editor:t,normalizedConfig:n,parentCommandName:c,buttonLabel:l,styleGridAriaLabel:a,styleDefinitions:o}))}if(r.includes("numbered")||i.startIndex||i.reversed){const o=[{label:e("Toggle the decimal list style"),tooltip:e("Decimal"),type:"decimal",icon:dz},{label:e("Toggle the decimal with leading zero list style"),tooltip:e("Decimal with leading zero"),type:"decimal-leading-zero",icon:hz},{label:e("Toggle the lower–roman list style"),tooltip:e("Lower–roman"),type:"lower-roman",icon:gz},{label:e("Toggle the upper–roman list style"),tooltip:e("Upper-roman"),type:"upper-roman",icon:xz},{label:e("Toggle the lower–latin list style"),tooltip:e("Lower-latin"),type:"lower-latin",icon:mz},{label:e("Toggle the upper–latin list style"),tooltip:e("Upper-latin"),type:"upper-latin",icon:wz}],l=e("Numbered List"),a=e("Numbered list styles toolbar"),c="numberedList";t.ui.componentFactory.add(c,N5({editor:t,normalizedConfig:n,parentCommandName:c,buttonLabel:l,buttonIcon:ty,styleGridAriaLabel:a,styleDefinitions:o})),r.includes("numbered")&&t.ui.componentFactory.add(`menuBar:${c}`,F5({editor:t,normalizedConfig:n,parentCommandName:c,buttonLabel:l,styleGridAriaLabel:a,styleDefinitions:o}))}}}function N5({editor:s,normalizedConfig:t,parentCommandName:e,buttonLabel:i,buttonIcon:n,styleGridAriaLabel:r,styleDefinitions:o}){const l=s.commands.get(e);return a=>{const c=nn(a,Vc),h=c.buttonView;return c.bind("isEnabled").to(l),c.class="ck-list-styles-dropdown",h.on("execute",()=>{s.execute(e),s.editing.view.focus()}),h.set({label:i,icon:n,tooltip:!0,isToggleable:!0}),h.bind("isOn").to(l,"value",f=>!!f),c.once("change:isOpen",()=>{const f=JY({editor:s,normalizedConfig:t,dropdownView:c,parentCommandName:e,styleGridAriaLabel:r,styleDefinitions:o});c.panelView.children.add(f)}),c.on("execute",()=>{s.editing.view.focus()}),c}}function e4({editor:s,listStyleCommand:t,parentCommandName:e}){const i=s.locale,n=s.commands.get(e);return({label:r,type:o,icon:l,tooltip:a})=>{const c=new ye(i);return c.set({label:r,icon:l,tooltip:a}),c.bind("isOn").to(t,"value",h=>h===o),c.on("execute",()=>{n.value?t.value===o?s.execute(e):t.value!==o&&s.execute("listStyle",{type:o}):s.model.change(()=>{s.execute("listStyle",{type:o})})}),c}}function JY({editor:s,normalizedConfig:t,dropdownView:e,parentCommandName:i,styleDefinitions:n,styleGridAriaLabel:r}){const o=s.locale,l={...t,...i!="numberedList"?{startIndex:!1,reversed:!1}:null},a=i.replace("List","");let c=null;if(t.styles.listTypes.includes(a)){const f=s.commands.get("listStyle"),m=e4({editor:s,parentCommandName:i,listStyleCommand:f}),w=t.styles.listStyleTypes;let O=n;if(w){const k=w[a];k&&(O=n.filter(C=>k.includes(C.type)))}const _=t4(f);c=O.filter(_).map(m)}const h=new J7(o,{styleGridAriaLabel:r,enabledProperties:l,styleButtonViews:c});if(t.styles.listTypes.includes(a)&&uy(e,()=>h.stylesView.children.find(f=>f.isOn)),l.startIndex){const f=s.commands.get("listStart");h.startIndexFieldView.bind("isEnabled").to(f),h.startIndexFieldView.fieldView.bind("value").to(f),h.on("listStart",(m,w)=>s.execute("listStart",w))}if(l.reversed){const f=s.commands.get("listReversed");h.reversedSwitchButtonView.bind("isEnabled").to(f),h.reversedSwitchButtonView.bind("isOn").to(f,"value",m=>!!m),h.on("listReversed",()=>{const m=f.value;s.execute("listReversed",{reversed:!m})})}return h.delegate("execute").to(e),h}function F5({editor:s,normalizedConfig:t,parentCommandName:e,buttonLabel:i,styleGridAriaLabel:n,styleDefinitions:r}){return o=>{const l=new cs(o),a=s.commands.get(e),c=s.commands.get("listStyle"),h=t4(c),f=e4({editor:s,parentCommandName:e,listStyleCommand:c}),m=t.styles.listStyleTypes;let w=r;if(m){const k=a.type,C=m[k];C&&(w=r.filter(P=>C.includes(P.type)))}const O=w.filter(h).map(f),_=new J7(o,{styleGridAriaLabel:n,enabledProperties:{...t,startIndex:!1,reversed:!1},styleButtonViews:O});return _.delegate("execute").to(l),l.buttonView.set({label:i,icon:e==="bulletedList"?ey:ty}),l.panelView.children.add(_),l.bind("isEnabled").to(a,"isEnabled"),l.on("execute",()=>{s.editing.view.focus()}),l}}function t4(s){return typeof s.isStyleTypeSupported=="function"?t=>s.isStyleTypeSupported(t.type):()=>!0}class eK extends F{static get requires(){return[GY,KY]}static get pluginName(){return"ListProperties"}static get isOfficialPlugin(){return!0}}/**
 * @license Copyright (c) 2003-2025, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options
 */const z5={"(":")","[":"]","{":"}"};class tK extends Be{constructor(t){super(t),this._isEnabledBasedOnSelection=!1}refresh(){const t=this.editor.model,e=t.document;this.isEnabled=t.schema.checkAttributeInSelection(e.selection,"mention")}execute(t){const e=this.editor.model,n=e.document.selection,r=typeof t.mention=="string"?{id:t.mention}:t.mention,o=r.id,l=t.range||n.getFirstRange();if(!e.canEditAt(l))return;const a=t.text||o,c=i4({_text:a,id:o},r);if(!o.startsWith(t.marker))throw new E("mentioncommand-incorrect-id",this);e.change(h=>{const f=ms(n.getAttributes()),m=new Map(f.entries());m.set("mention",c);const w=e.insertContent(h.createText(a,m),l),O=w.start.nodeBefore,_=w.end.nodeAfter,k=_&&_.is("$text")&&_.data.startsWith(" ");let C=!1;if(O&&_&&O.is("$text")&&_.is("$text")){const P=O.data.slice(-1),M=P in z5,Q=M&&_.data.startsWith(z5[P]);C=M&&Q}!C&&!k&&e.insertContent(h.createText(" ",f),l.start.getShiftedBy(a.length))})}}class iK extends F{static get pluginName(){return"MentionEditing"}static get isOfficialPlugin(){return!0}init(){const t=this.editor,e=t.model,i=e.document;e.schema.extend("$text",{allowAttributes:"mention"}),t.conversion.for("upcast").elementToAttribute({view:{name:"span",attributes:"data-mention",classes:"mention"},model:{key:"mention",value:n=>n4(n)}}),t.conversion.for("downcast").attributeToElement({model:"mention",view:sK}),t.conversion.for("downcast").add(nK),i.registerPostFixer(n=>lK(n,i,e.schema)),i.registerPostFixer(n=>aK(n,i)),i.registerPostFixer(n=>rK(n,i)),t.commands.add("mention",new tK(t))}}function i4(s,t){return Object.assign({uid:ei()},s,t||{})}function n4(s,t){const e=s.getAttribute("data-mention"),i=s.getChild(0);if(!i)return;const n={id:e,_text:i.data};return i4(n,t)}function nK(s){s.on("attribute:mention",(t,e,i)=>{const n=e.attributeNewValue;if(!e.item.is("$textProxy")||!n)return;const r=e.range.start;(r.textNode||r.nodeAfter).data!=n._text&&i.consumable.consume(e.item,t.name)},{priority:"highest"})}function sK(s,{writer:t}){if(!s)return;const e={class:"mention","data-mention":s.id},i={id:s.uid,priority:20};return t.createAttributeElement("span",e,i)}function rK(s,t){const e=t.selection,i=e.focus;return e.isCollapsed&&e.hasAttribute("mention")&&oK(i)?(s.removeSelectionAttribute("mention"),!0):!1}function oK(s){const t=s.isAtStart;return s.nodeBefore&&s.nodeBefore.is("$text")||t}function lK(s,t,e){const i=t.differ.getChanges();let n=!1;for(const r of i){if(r.type=="attribute")continue;const o=r.position;if(r.name=="$text"){const l=o.textNode&&o.textNode.nextSibling;n=ul(o.textNode,s)||n,n=ul(l,s)||n,n=ul(o.nodeBefore,s)||n,n=ul(o.nodeAfter,s)||n}if(r.name!="$text"&&r.type=="insert"){const l=o.nodeAfter;for(const a of s.createRangeIn(l).getItems())n=ul(a,s)||n}if(r.type=="insert"&&e.isInline(r.name)){const l=o.nodeAfter&&o.nodeAfter.nextSibling;n=ul(o.nodeBefore,s)||n,n=ul(l,s)||n}}return n}function aK(s,t){const e=t.differ.getChanges();let i=!1;for(const n of e)if(n.type==="attribute"&&n.attributeKey!="mention"){const r=n.range.start.nodeBefore,o=n.range.end.nodeAfter;for(const l of[r,o])s4(l)&&l.getAttribute(n.attributeKey)!=n.attributeNewValue&&(s.setAttribute(n.attributeKey,n.attributeNewValue,l),i=!0)}return i}function s4(s){if(!s||!(s.is("$text")||s.is("$textProxy"))||!s.hasAttribute("mention"))return!1;const t=s.data,i=s.getAttribute("mention")._text;return t!=i}function ul(s,t){return s4(s)?(t.removeAttribute("mention",s),!0):!1}class cK extends Wr{constructor(e){super(e);p(this,"selected");p(this,"position");this.extendTemplate({attributes:{class:["ck-mentions"],tabindex:"-1"}})}selectFirst(){this.select(0)}selectNext(){const e=this.selected,i=this.items.getIndex(e);this.select(i+1)}selectPrevious(){const e=this.selected,i=this.items.getIndex(e);this.select(i-1)}select(e){let i=0;e>0&&e<this.items.length?i=e:e<0&&(i=this.items.length-1);const n=this.items.get(i);this.selected!==n&&(this.selected&&this.selected.removeHighlight(),n.highlight(),this.selected=n,this._isItemVisibleInScrolledArea(n)||(this.element.scrollTop=n.element.offsetTop))}executeSelected(){this.selected.fire("execute")}_isItemVisibleInScrolledArea(e){return new Ve(this.element).contains(new Ve(e.element))}}class uK extends ue{constructor(e,i){super(e);p(this,"domElement");this.template=void 0,this.domElement=i,this.domElement.classList.add("ck-button"),this.set("isOn",!1),this.on("change:isOn",(n,r,o)=>{o?(this.domElement.classList.add("ck-on"),this.domElement.classList.remove("ck-off")):(this.domElement.classList.add("ck-off"),this.domElement.classList.remove("ck-on"))}),this.listenTo(this.domElement,"click",()=>{this.fire("execute")})}render(){super.render(),this.element=this.domElement}focus(){this.domElement.focus()}}class hK extends Sn{constructor(){super(...arguments);p(this,"item");p(this,"marker")}highlight(){const e=this.children.first;e.isOn=!0}removeHighlight(){const e=this.children.first;e.isOn=!1}}const rm=3,dK=[ze.arrowup,ze.arrowdown,ze.esc],fK=[ze.enter,ze.tab];class mK extends F{constructor(e){super(e);p(this,"_mentionsView");p(this,"_mentionsConfigurations");p(this,"_balloon");p(this,"_items",new di);p(this,"_lastRequested");p(this,"_requestFeedDebounced");this._mentionsView=this._createMentionView(),this._mentionsConfigurations=new Map,this._requestFeedDebounced=fs(this._requestFeed,100),e.config.define("mention",{feeds:[]})}static get pluginName(){return"MentionUI"}static get isOfficialPlugin(){return!0}static get requires(){return[gs]}init(){const e=this.editor,i=e.config.get("mention.commitKeys")||fK,n=dK.concat(i);this._balloon=e.plugins.get(gs),e.editing.view.document.on("keydown",(l,a)=>{o(a.keyCode)&&this._isUIVisible&&(a.preventDefault(),l.stop(),a.keyCode==ze.arrowdown&&this._mentionsView.selectNext(),a.keyCode==ze.arrowup&&this._mentionsView.selectPrevious(),i.includes(a.keyCode)&&this._mentionsView.executeSelected(),a.keyCode==ze.esc&&this._hideUIAndRemoveMarker())},{priority:"highest"}),Fr({emitter:this._mentionsView,activator:()=>this._isUIVisible,contextElements:()=>[this._balloon.view.element],callback:()=>this._hideUIAndRemoveMarker()});const r=e.config.get("mention.feeds");for(const l of r){const{feed:a,marker:c,dropdownLimit:h}=l;if(!yK(c))throw new E("mentionconfig-incorrect-marker",null,{marker:c});const f=typeof a=="function"?a.bind(this.editor):xK(a),m=l.itemRenderer,w={marker:c,feedCallback:f,itemRenderer:m,dropdownLimit:h};this._mentionsConfigurations.set(c,w)}this._setupTextWatcher(r),this.listenTo(e,"change:isReadOnly",()=>{this._hideUIAndRemoveMarker()}),this.on("requestFeed:response",(l,a)=>this._handleFeedResponse(a)),this.on("requestFeed:error",()=>this._hideUIAndRemoveMarker());function o(l){return n.includes(l)}}destroy(){super.destroy(),this._mentionsView.destroy()}get _isUIVisible(){return this._balloon.visibleView===this._mentionsView}_createMentionView(){const e=this.editor.locale,i=new cK(e);return i.items.bindTo(this._items).using(n=>{const{item:r,marker:o}=n,{dropdownLimit:l}=this._mentionsConfigurations.get(o),a=l||this.editor.config.get("mention.dropdownLimit")||10;if(i.items.length>=a)return null;const c=new hK(e),h=this._renderItem(r,o);return h.delegate("execute").to(c),c.children.add(h),c.item=r,c.marker=o,c.on("execute",()=>{i.fire("execute",{item:r,marker:o})}),c}),i.on("execute",(n,r)=>{const o=this.editor,l=o.model,a=r.item,c=r.marker,h=o.model.markers.get("mention"),f=l.createPositionAt(l.document.selection.focus),m=l.createPositionAt(h.getStart()),w=l.createRange(m,f);this._hideUIAndRemoveMarker(),o.execute("mention",{mention:a,text:a.text,marker:c,range:w}),o.editing.view.focus()}),i}_getItemRenderer(e){const{itemRenderer:i}=this._mentionsConfigurations.get(e);return i}_requestFeed(e,i){this._lastRequested=i;const{feedCallback:n}=this._mentionsConfigurations.get(e),r=n(i);if(!(r instanceof Promise)){this.fire("requestFeed:response",{feed:r,marker:e,feedText:i});return}r.then(l=>{this._lastRequested==i?this.fire("requestFeed:response",{feed:l,marker:e,feedText:i}):this.fire("requestFeed:discarded",{feed:l,marker:e,feedText:i})}).catch(l=>{this.fire("requestFeed:error",{error:l}),Ue("mention-feed-callback-error",{marker:e})})}_setupTextWatcher(e){const i=this.editor,n=e.map(l=>({...l,pattern:o4(l.marker,l.minimumCharacters||0)})),r=new dy(i.model,pK(n));r.on("matched",(l,a)=>{const c=r4(n,a.text),f=i.model.document.selection.focus,m=i.model.createPositionAt(f.parent,c.position);if(bK(f)||OK(m)){this._hideUIAndRemoveMarker();return}const w=wK(c,a.text),O=c.marker.length+w.length,_=f.getShiftedBy(-O),k=f.getShiftedBy(-w.length),C=i.model.createRange(_,k);if(Bx(i)){const P=i.model.markers.get("mention");i.model.change(M=>{M.updateMarker(P,{range:C})})}else i.model.change(P=>{P.addMarker("mention",{range:C,usingOperation:!1,affectsData:!1})});this._requestFeedDebounced(c.marker,w)}),r.on("unmatched",()=>{this._hideUIAndRemoveMarker()});const o=i.commands.get("mention");return r.bind("isEnabled").to(o),r}_handleFeedResponse(e){const{feed:i,marker:n}=e;if(!Bx(this.editor))return;this._items.clear();for(const o of i){const l=typeof o!="object"?{id:o,text:o}:o;this._items.add({item:l,marker:n})}const r=this.editor.model.markers.get("mention");this._items.length?this._showOrUpdateUI(r):this._hideUIAndRemoveMarker()}_showOrUpdateUI(e){this._isUIVisible?this._balloon.updatePosition(this._getBalloonPanelPositionData(e,this._mentionsView.position)):this._balloon.add({view:this._mentionsView,position:this._getBalloonPanelPositionData(e,this._mentionsView.position),singleViewMode:!0,balloonClassName:"ck-mention-balloon"}),this._mentionsView.position=this._balloon.view.position,this._mentionsView.selectFirst()}_hideUIAndRemoveMarker(){this._balloon.hasView(this._mentionsView)&&this._balloon.remove(this._mentionsView),Bx(this.editor)&&this.editor.model.change(e=>e.removeMarker("mention")),this._mentionsView.position=void 0}_renderItem(e,i){const n=this.editor;let r,o=e.id;const l=this._getItemRenderer(i);if(l){const a=l(e);typeof a!="string"?r=new uK(n.locale,a):o=a}if(!r){const a=new ye(n.locale);a.label=o,a.withText=!0,r=a}return r}_getBalloonPanelPositionData(e,i){const n=this.editor,r=n.editing,o=r.view.domConverter,l=r.mapper,a=n.locale.uiLanguageDirection;return{target:()=>{let c=e.getRange();c.start.root.rootName=="$graveyard"&&(c=n.model.document.selection.getFirstRange());const h=l.toViewRange(c);return Ve.getDomRangeRects(o.viewRangeToDom(h)).pop()},limiter:()=>{const c=this.editor.editing.view,f=c.document.selection.editableElement;return f?c.domConverter.mapViewToDom(f.root):null},positions:gK(i,a)}}}function gK(s,t){const e={caret_se:i=>({top:i.bottom+rm,left:i.right,name:"caret_se",config:{withArrow:!1}}),caret_ne:(i,n)=>({top:i.top-n.height-rm,left:i.right,name:"caret_ne",config:{withArrow:!1}}),caret_sw:(i,n)=>({top:i.bottom+rm,left:i.right-n.width,name:"caret_sw",config:{withArrow:!1}}),caret_nw:(i,n)=>({top:i.top-n.height-rm,left:i.right-n.width,name:"caret_nw",config:{withArrow:!1}})};return Object.prototype.hasOwnProperty.call(e,s)?[e[s]]:t!=="rtl"?[e.caret_se,e.caret_sw,e.caret_ne,e.caret_nw]:[e.caret_sw,e.caret_se,e.caret_nw,e.caret_ne]}function r4(s,t){let e;for(const i of s){const n=t.lastIndexOf(i.marker);n>0&&!t.substring(n-1).match(i.pattern)||(!e||n>=e.position)&&(e={marker:i.marker,position:n,minimumCharacters:i.minimumCharacters,pattern:i.pattern})}return e}function o4(s,t){const e=t==0?"*":`{${t},}`,i=Ie.features.isRegExpUnicodePropertySupported?`\\p{Ps}\\p{Pi}"'`:`\\(\\[{"'`,n=".";s=s.replace(/[.*+?^${}()\-|[\]\\]/g,"\\$&");const r=`(?:^|[ ${i}])(${s})(${n}${e})$`;return new RegExp(r,"u")}function pK(s){return e=>{const i=r4(s,e);if(!i)return!1;let n=0;i.position!==0&&(n=i.position-1);const r=e.substring(n);return i.pattern.test(r)}}function wK(s,t){let e=0;s.position!==0&&(e=s.position-1);const i=o4(s.marker,0);return t.substring(e).match(i)[2]}function xK(s){return t=>s.filter(i=>(typeof i=="string"?i:String(i.id)).toLowerCase().includes(t.toLowerCase()))}function bK(s){const t=s.textNode&&s.textNode.hasAttribute("mention"),e=s.nodeBefore;return t||e&&e.is("$text")&&e.hasAttribute("mention")}function OK(s){const t=s.nodeAfter;return t&&t.is("$text")&&t.hasAttribute("mention")}function yK(s){return!!s}function Bx(s){return s.model.markers.has("mention")}class vK extends F{toMentionAttribute(t,e){return n4(t,e)}static get pluginName(){return"Mention"}static get isOfficialPlugin(){return!0}static get requires(){return[iK,mK]}}/**
 * @license Copyright (c) 2003-2025, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options
 *//**
 * @license Copyright (c) 2003-2025, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options
 */function _K(s,t){const e=[];for(const i of t.createRangeIn(s)){const n=i.item;n.is("element","a")&&!n.hasAttribute("href")&&(n.hasAttribute("id")||n.hasAttribute("name"))&&e.push(n)}for(const i of e){const n=i.parent.getChildIndex(i)+1,r=i.getChildren();t.insertChild(n,r,i.parent)}}/**
 * @license Copyright (c) 2003-2025, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options
 */function l4(s){const t=parseFloat(s);return s.endsWith("pt")?Wa(t*96/72):s.endsWith("pc")?Wa(t*12*96/72):s.endsWith("in")?Wa(t*96):s.endsWith("cm")?Wa(t*96/2.54):s.endsWith("mm")?Wa(t/10*96/2.54):s}function W5(s){return s!==void 0&&s.endsWith("px")}function Wa(s){return Math.round(s)+"px"}function kK(s,t,e){if(!s.childCount)return;const i=new Cn(s.document),n=CK(s,i);if(!n.length)return;const r={},o=[];for(const l of n)if(l.indent!==void 0){PK(l)||(o.length=0);const a=`${l.id}:${l.indent}`,c=Math.min(l.indent-1,o.length);if(c<o.length&&o[c].id!==l.id&&(o.length=c),c<o.length-1)o.length=c+1;else{const f=TK(l,t);if(c>o.length-1||o[c].listElement.name!=f.type){c==0&&f.type=="ol"&&l.id!==void 0&&r[a]&&(f.startIndex=r[a]);const m=RK(f,i,e);if(W5(l.marginLeft)&&(c==0||W5(o[c-1].marginLeft))){let w=l.marginLeft;c>0&&(w=Wa(parseFloat(w)-parseFloat(o[c-1].marginLeft))),i.setStyle("padding-left",w,m)}if(o.length==0){const w=l.element.parent,O=w.getChildIndex(l.element)+1;i.insertChild(O,m,w)}else{const w=o[c-1].listItemElements;i.appendChild(m,w[w.length-1])}o[c]={...l,listElement:m,listItemElements:[]},c==0&&l.id!==void 0&&(r[a]=f.startIndex||1)}}const h=l.element.name=="li"?l.element:i.createElement("li");i.appendChild(h,o[c].listElement),o[c].listItemElements.push(h),c==0&&l.id!==void 0&&r[a]++,l.element!=h&&i.appendChild(l.element,h),MK(l.element,i),i.removeStyle("text-indent",l.element),i.removeStyle("margin-left",l.element)}else{const a=o.find(c=>c.marginLeft==l.marginLeft);if(a){const c=a.listItemElements;i.appendChild(l.element,c[c.length-1]),i.removeStyle("margin-left",l.element)}else o.length=0}}function SK(s,t){for(const e of t.createRangeIn(s)){const i=e.item;if(i.is("element","li")){const n=i.getChild(0);n&&n.is("element","p")&&t.unwrapElement(n)}}}function CK(s,t){const e=t.createRangeIn(s),i=[],n=new Set;for(const r of e.getItems()){if(!r.is("element")||!r.name.match(/^(p|h\d+|li|div)$/))continue;let o=LK(r);if(o!==void 0&&parseFloat(o)==0&&!Array.from(r.getClassNames()).find(l=>l.startsWith("MsoList"))&&(o=void 0),r.hasStyle("mso-list")||o!==void 0&&n.has(o)){const l=VK(r);i.push({element:r,id:l.id,order:l.order,indent:l.indent,marginLeft:o}),o!==void 0&&n.add(o)}else n.clear()}return i}function PK(s){const t=s.element.previousSibling;return U5(t||s.element.parent)}function U5(s){return s.is("element","ol")||s.is("element","ul")}function TK(s,t){const e=new RegExp(`@list l${s.id}:level${s.indent}\\s*({[^}]*)`,"gi"),i=/mso-level-number-format:([^;]{0,100});/gi,n=/mso-level-start-at:\s{0,100}([0-9]{0,10})\s{0,100};/gi,r=new RegExp(`@list\\s+l${s.id}:level\\d\\s*{[^{]*mso-level-text:"%\\d\\\\.`,"gi"),o=new RegExp(`@list l${s.id}:level\\d\\s*{[^{]*mso-level-number-format:`,"gi"),l=r.exec(t),a=o.exec(t),c=l&&!a,h=e.exec(t);let f="decimal",m="ol",w=null;if(h&&h[1]){const O=i.exec(h[1]);if(O&&O[1]&&(f=O[1].trim(),m=f!=="bullet"&&f!=="image"?"ol":"ul"),f==="bullet"){const _=EK(s.element);_&&(f=_)}else{const _=n.exec(h[1]);_&&_[1]&&(w=parseInt(_[1]))}c&&(m="ol")}return{type:m,startIndex:w,style:IK(f),isLegalStyleList:c}}function EK(s){if(s.name=="li"&&s.parent.name=="ul"&&s.parent.hasAttribute("type"))return s.parent.getAttribute("type");const t=AK(s);if(!t)return null;const e=t._data;return e==="o"?"circle":e==="·"?"disc":e==="§"?"square":null}function AK(s){if(s.getChild(0).is("$text"))return null;for(const t of s.getChildren()){if(!t.is("element","span"))continue;const e=t.getChild(0);if(e)return e.is("$text")?e:e.getChild(0)}/* istanbul ignore next -- @preserve */return null}function IK(s){if(s.startsWith("arabic-leading-zero"))return"decimal-leading-zero";switch(s){case"alpha-upper":return"upper-alpha";case"alpha-lower":return"lower-alpha";case"roman-upper":return"upper-roman";case"roman-lower":return"lower-roman";case"circle":case"disc":case"square":return s;default:return null}}function RK(s,t,e){const i=t.createElement(s.type);return s.style&&t.setStyle("list-style-type",s.style,i),s.startIndex&&s.startIndex>1&&t.setAttribute("start",s.startIndex,i),s.isLegalStyleList&&e&&t.addClass("legal-list",i),i}function VK(s){const t=s.getStyle("mso-list");if(t===void 0)return{};const e=t.match(/(^|\s{1,100})l(\d+)/i),i=t.match(/\s{0,100}lfo(\d+)/i),n=t.match(/\s{0,100}level(\d+)/i);return e&&i&&n?{id:e[2],order:i[1],indent:parseInt(n[1])}:{indent:1}}function MK(s,t){const e=new kn({name:"span",styles:{"mso-list":"Ignore"}}),i=t.createRangeIn(s);for(const n of i)n.type==="elementStart"&&e.match(n.item)&&t.remove(n.item)}function LK(s){const t=s.getStyle("margin-left");return t===void 0||t.endsWith("px")?t:l4(t)}function BK(s,t){if(!s.childCount)return;const e=new Cn(s.document),i=DK(s,e);QK(i,s,e),FK(i,s,e),NK(s,e);const n=zK(s,e);n.length&&UK(n,WK(t),e)}function $K(s){return btoa(s.match(/\w{2}/g).map(t=>String.fromCharCode(parseInt(t,16))).join(""))}function DK(s,t){const e=t.createRangeIn(s),i=new kn({name:/v:(.+)/}),n=[];for(const r of e){if(r.type!="elementStart")continue;const o=r.item,l=o.previousSibling,a=l&&l.is("element")?l.name:null,c=["Chart"],h=i.match(o),f=o.getAttribute("o:gfxdata"),m=a==="v:shapetype",w=f&&c.some(O=>o.getAttribute("id").includes(O));h&&f&&!m&&!w&&n.push(r.item.getAttribute("id"))}return n}function QK(s,t,e){const i=e.createRangeIn(t),n=new kn({name:"img"}),r=[];for(const o of i)if(o.item.is("element")&&n.match(o.item)){const l=o.item,a=l.getAttribute("v:shapes")?l.getAttribute("v:shapes").split(" "):[];a.length&&a.every(c=>s.indexOf(c)>-1)?r.push(l):l.getAttribute("src")||r.push(l)}for(const o of r)e.remove(o)}function NK(s,t){const e=t.createRangeIn(s),i=new kn({name:/v:(.+)/}),n=[];for(const r of e)r.type=="elementStart"&&i.match(r.item)&&n.push(r.item);for(const r of n)t.remove(r)}function FK(s,t,e){const i=e.createRangeIn(t),n=[];for(const l of i)if(l.type=="elementStart"&&l.item.is("element","v:shape")){const a=l.item.getAttribute("id");if(s.includes(a))continue;r(l.item.parent.getChildren(),a)||n.push(l.item)}for(const l of n){const a={src:o(l)};l.hasAttribute("alt")&&(a.alt=l.getAttribute("alt"));const c=e.createElement("img",a);e.insertChild(l.index+1,c,l.parent)}function r(l,a){for(const c of l){/* istanbul ignore else -- @preserve */if(c.is("element")&&(c.name=="img"&&c.getAttribute("v:shapes")==a||r(c.getChildren(),a)))return!0}return!1}function o(l){for(const a of l.getChildren()){/* istanbul ignore else -- @preserve */if(a.is("element")&&a.getAttribute("src"))return a.getAttribute("src")}}}function zK(s,t){const e=t.createRangeIn(s),i=new kn({name:"img"}),n=[];let r=0;for(const o of e)o.item.is("element")&&i.match(o.item)&&(o.item.getAttribute("src").startsWith("file://")&&n.push({element:o.item,imageIndex:r}),r++);return n}function WK(s){if(!s)return[];const t=/{\\pict[\s\S]+?\\bliptag-?\d+(\\blipupi-?\d+)?({\\\*\\blipuid\s?[\da-fA-F]+)?[\s}]*?/,e=new RegExp("(?:("+t.source+"))([\\da-fA-F\\s]+)\\}","g"),i=s.match(e),n=[];if(i)for(const r of i){let o=!1;r.includes("\\pngblip")?o="image/png":r.includes("\\jpegblip")&&(o="image/jpeg"),o&&n.push({hex:r.replace(t,"").replace(/[^\da-fA-F]/g,""),type:o})}return n}function UK(s,t,e){for(let i=0;i<s.length;i++){const{element:n,imageIndex:r}=s[i],o=t[r];if(o){const l=`data:${o.type};base64,${$K(o.hex)}`;e.setAttribute("src",l,n)}}}function ZK(s){const t=[],e=new Cn(s.document);for(const{item:i}of e.createRangeIn(s))if(i.is("element")){for(const n of i.getClassNames())/\bmso/gi.exec(n)&&e.removeClass(n,i);for(const n of i.getStyleNames())/\bmso/gi.exec(n)&&e.removeStyle(n,i);(i.is("element","w:sdt")||i.is("element","w:sdtpr")&&i.isEmpty||i.is("element","o:p")&&i.isEmpty)&&t.push(i)}for(const i of t){const n=i.parent,r=n.getChildIndex(i);e.insertChild(r,i.getChildren(),n),e.remove(i)}}function HK(s,t){for(const e of t.createRangeIn(s).getItems()){if(!e.is("element","table")&&!e.is("element","td")&&!e.is("element","th"))continue;const i=["left","top","right","bottom"];if(i.every(r=>!e.hasStyle(`border-${r}-style`)))t.setStyle("border-style","none",e);else for(const r of i)e.hasStyle(`border-${r}-style`)||t.setStyle(`border-${r}-style`,"none",e);const n=["width","height",...i.map(r=>`border-${r}-width`),...i.map(r=>`padding-${r}`)];for(const r of n)e.hasStyle(r)&&t.setStyle(r,l4(e.getStyle(r)),e)}}const qK=/<meta\s*name="?generator"?\s*content="?microsoft\s*word\s*\d+"?\/?>/i,jK=/xmlns:o="urn:schemas-microsoft-com/i;class Ay{constructor(t,e=!1){p(this,"document");p(this,"hasMultiLevelListPlugin");this.document=t,this.hasMultiLevelListPlugin=e}isActive(t){return qK.test(t)||jK.test(t)}execute(t){const e=new Cn(this.document),{body:i,stylesString:n}=t._parsedData;_K(i,e),kK(i,n,this.hasMultiLevelListPlugin),BK(i,t.dataTransfer.getData("text/rtf")),HK(i,e),ZK(i),t.content=i}}/**
 * @license Copyright (c) 2003-2025, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options
 */function XK(s,t){for(const e of s.getChildren())if(e.is("element","b")&&e.getStyle("font-weight")==="normal"){const i=s.getChildIndex(e);t.remove(e),t.insertChild(i,e.getChildren(),s)}}function GK(s,t){const e=new ad(t.document.stylesProcessor),i=new cd(e,{renderingMode:"data"}),n=i.blockElements,r=i.inlineObjectElements,o=[];for(const l of t.createRangeIn(s)){const a=l.item;if(a.is("element","br")){const c=Z5(a,"forward",t,{blockElements:n,inlineObjectElements:r}),h=Z5(a,"backward",t,{blockElements:n,inlineObjectElements:r}),f=H5(c,n);(H5(h,n)||f)&&o.push(a)}}for(const l of o)l.hasClass("Apple-interchange-newline")?t.remove(l):t.replace(l,t.createElement("p"))}function Z5(s,t,e,{blockElements:i,inlineObjectElements:n}){let r=e.createPositionAt(s,t=="forward"?"after":"before");return r=r.getLastMatchingPosition(({item:o})=>o.is("element")&&!i.includes(o.name)&&!n.includes(o.name),{direction:t}),t=="forward"?r.nodeAfter:r.nodeBefore}function H5(s,t){return!!s&&s.is("element")&&t.includes(s.name)}const YK=/id=("|')docs-internal-guid-[-0-9a-f]+("|')/i;class KK{constructor(t){p(this,"document");this.document=t}isActive(t){return YK.test(t)}execute(t){const e=new Cn(this.document),{body:i}=t._parsedData;XK(i,e),SK(i,e),GK(i,e),t.content=i}}/**
 * @license Copyright (c) 2003-2025, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options
 */function JK(s,t){for(const e of s.getChildren())e.is("element","table")&&e.hasAttribute("xmlns")&&t.removeAttribute("xmlns",e)}/**
 * @license Copyright (c) 2003-2025, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options
 */function eJ(s,t){for(const e of s.getChildren())if(e.is("element","google-sheets-html-origin")){const i=s.getChildIndex(e);t.remove(e),t.insertChild(i,e.getChildren(),s)}}/**
 * @license Copyright (c) 2003-2025, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options
 */function tJ(s,t){for(const e of s.getChildren())e.is("element","table")&&e.getStyle("width")==="0px"&&t.removeStyle("width",e)}/**
 * @license Copyright (c) 2003-2025, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options
 */function iJ(s,t){for(const e of Array.from(s.getChildren()))e.is("element","style")&&t.remove(e)}const nJ=/<google-sheets-html-origin/i;class sJ{constructor(t){p(this,"document");this.document=t}isActive(t){return nJ.test(t)}execute(t){const e=new Cn(this.document),{body:i}=t._parsedData;eJ(i,e),JK(i,e),tJ(i,e),iJ(i,e),t.content=i}}/**
 * @license Copyright (c) 2003-2025, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options
 */function rJ(s){return q5(q5(s)).replace(/(<span\s+style=['"]mso-spacerun:yes['"]>[^\S\r\n]*?)[\r\n]+([^\S\r\n]*<\/span>)/g,"$1$2").replace(/<span\s+style=['"]mso-spacerun:yes['"]><\/span>/g,"").replace(/(<span\s+style=['"]letter-spacing:[^'"]+?['"]>)[\r\n]+(<\/span>)/g,"$1 $2").replace(/ <\//g," </").replace(/ <o:p><\/o:p>/g," <o:p></o:p>").replace(/<o:p>(&nbsp;|\u00A0)<\/o:p>/g,"").replace(/>([^\S\r\n]*[\r\n]\s*)</g,"><")}function oJ(s){s.querySelectorAll("span[style*=spacerun]").forEach(t=>{const e=t,i=e.innerText.length||0;e.innerText=Array(i+1).join("  ").substr(0,i)})}function q5(s){return s.replace(/<span(?: class="Apple-converted-space"|)>(\s+)<\/span>/g,(t,e)=>e.length===1?" ":Array(e.length+1).join("  ").substr(0,e.length))}function Iy(s,t){const e=new DOMParser;s=s.replace(/<!--\[if gte vml 1]>/g,""),s=s.replace(/<o:SmartTagType(?:\s+[^\s>=]+(?:="[^"]*")?)*\s*\/?>/gi,"");const i=rJ(cJ(s)),n=e.parseFromString(i,"text/html");oJ(n);const r=n.body.innerHTML,o=lJ(n,t),l=aJ(n);return{body:o,bodyString:r,styles:l.styles,stylesString:l.stylesString}}function lJ(s,t){const e=new ad(t),i=new cd(e,{renderingMode:"data"}),n=s.createDocumentFragment(),r=s.body.childNodes;for(;r.length>0;)n.appendChild(r[0]);return i.domToView(n,{skipComments:!0})}function aJ(s){const t=[],e=[],i=Array.from(s.getElementsByTagName("style"));for(const n of i)n.sheet&&n.sheet.cssRules&&n.sheet.cssRules.length&&(t.push(n.sheet),e.push(n.innerHTML));return{styles:t,stylesString:e.join(" ")}}function cJ(s){const t="</body>",e="</html>",i=s.indexOf(t);if(i<0)return s;const n=s.indexOf(e,i+t.length);return s.substring(0,i+t.length)+(n>=0?s.substring(n):"")}class uJ extends F{static get pluginName(){return"PasteFromOffice"}static get isOfficialPlugin(){return!0}static get requires(){return[on]}init(){const t=this.editor,e=t.plugins.get("ClipboardPipeline"),i=t.editing.view.document,n=[],r=this.editor.plugins.has("MultiLevelList");n.push(new Ay(i,r)),n.push(new KK(i)),n.push(new sJ(i)),e.on("inputTransformation",(o,l)=>{if(l._isTransformedWithPasteFromOffice||t.model.document.selection.getFirstPosition().parent.is("element","codeBlock"))return;const c=l.dataTransfer.getData("text/html"),h=n.find(f=>f.isActive(c));h&&(l._parsedData||(l._parsedData=Iy(c,i.stylesProcessor)),h.execute(l),l._isTransformedWithPasteFromOffice=!0)},{priority:"high"})}}/**
 * @license Copyright (c) 2003-2025, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options
 */class hJ extends Be{constructor(t){super(t),this.affectsData=!1,this.value=!1}execute(){const t="ck-show-blocks",e=this.editor.editing.view;e.change(i=>{for(const n of e.document.roots)n.hasClass(t)?(i.removeClass(t,n),this.value=!1):(i.addClass(t,n),this.value=!0)})}}class dJ extends F{static get pluginName(){return"ShowBlocksEditing"}static get isOfficialPlugin(){return!0}init(){const{editor:t}=this;t.commands.add("showBlocks",new hJ(t))}}class fJ extends F{static get pluginName(){return"ShowBlocksUI"}static get isOfficialPlugin(){return!0}init(){const t=this.editor;t.ui.componentFactory.add("showBlocks",()=>{const e=this._createButton(ye);return e.set({tooltip:!0,icon:Vz}),e}),t.ui.componentFactory.add("menuBar:showBlocks",()=>this._createButton(ti))}_createButton(t){const e=this.editor,i=e.locale,n=e.commands.get("showBlocks"),r=new t(i),o=i.t;return r.set({label:o("Show blocks"),isToggleable:!0,role:"menuitemcheckbox"}),r.bind("isEnabled").to(n),r.bind("isOn").to(n,"value",n,"isEnabled",(l,a)=>l&&a),this.listenTo(r,"execute",()=>{e.execute("showBlocks"),e.editing.view.focus()}),r}}class mJ extends F{static get pluginName(){return"ShowBlocks"}static get isOfficialPlugin(){return!0}static get requires(){return[dJ,fJ]}}/**
 * @license Copyright (c) 2003-2025, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options
 */function Ry(s,t){const{modelAttribute:e,styleName:i,viewElement:n,defaultValue:r,reduceBoxSides:o=!1,shouldUpcast:l=()=>!0}=t;s.for("upcast").attributeToAttribute({view:{name:n,styles:{[i]:/[\s\S]+/}},model:{key:e,value:(a,c,h)=>{if(!l(a))return;const f=Co(r,"",h),m=a.getNormalizedStyle(i),w=o?Wm(m):m;if(f!==w)return w}}})}function a1(s,t,e,i){s.for("upcast").add(n=>n.on("element:"+t,(r,o,l)=>{if(!o.modelRange)return;const a=["border-top-width","border-top-color","border-top-style","border-bottom-width","border-bottom-color","border-bottom-style","border-right-width","border-right-color","border-right-style","border-left-width","border-left-color","border-left-style"].filter(_=>o.viewItem.hasStyle(_));if(!a.length)return;const c={styles:a};if(!l.consumable.test(o.viewItem,c))return;const h=[...o.modelRange.getItems({shallow:!0})].pop(),f=h.findAncestor("table",{includeSelf:!0});let m=i;f&&f.getAttribute("tableType")=="layout"&&(m={style:"none",color:"",width:""}),l.consumable.consume(o.viewItem,c);const w={style:o.viewItem.getNormalizedStyle("border-style"),color:o.viewItem.getNormalizedStyle("border-color"),width:o.viewItem.getNormalizedStyle("border-width")},O={style:Wm(w.style),color:Wm(w.color),width:Wm(w.width)};O.style!==m.style&&l.writer.setAttribute(e.style,O.style,h),O.color!==m.color&&l.writer.setAttribute(e.color,O.color,h),O.width!==m.width&&l.writer.setAttribute(e.width,O.width,h)}))}function mh(s,t){const{modelElement:e,modelAttribute:i,styleName:n}=t;s.for("downcast").attributeToAttribute({model:{name:e,key:i},view:r=>({key:"style",value:{[n]:r}})})}function zm(s,t){const{modelAttribute:e,styleName:i}=t;s.for("downcast").add(n=>n.on(`attribute:${e}:table`,(r,o,l)=>{const{item:a,attributeNewValue:c}=o,{mapper:h,writer:f}=l;if(!l.consumable.consume(o.item,r.name))return;const m=[...h.toViewElement(a).getChildren()].find(w=>w.is("element","table"));c?f.setStyle(i,c,m):f.removeStyle(i,m)}))}function Co(s,t,e){const i=e.modelRange&&$t(e.modelRange.getItems({shallow:!0})),n=i&&i.is("element")&&i.findAncestor("table",{includeSelf:!0});return n&&n.getAttribute("tableType")==="layout"?t:s}function Wm(s){if(!s)return;const t=["top","right","bottom","left"];if(!t.every(r=>s[r]))return s;const i=s.top;return t.every(r=>s[r]===i)?i:s}function Wt(s,t,e,i,n=1){t!=null&&n!==void 0&&n!==null&&t>n?i.setAttribute(s,t,e):i.removeAttribute(s,e)}function jl(s,t,e={}){const i=s.createElement("tableCell",e);return s.insertElement("paragraph",i),s.insert(i,t),i}function c1(s,t){const e=t.parent.parent,i=parseInt(e.getAttribute("headingColumns")||"0"),{column:n}=s.getCellLocation(t);return!!i&&n<i}function Um(s,t,e){const{modelAttribute:i}=e;s.extend("tableCell",{allowAttributes:[i]}),Ry(t,{viewElement:/^(td|th)$/,...e}),mh(t,{modelElement:"tableCell",...e})}function Po(s){const t=s.getSelectedElement();return t&&t.is("element","table")?t:s.getFirstPosition().findAncestor("table")}function gJ(){return s=>{s.on("element:figure",(t,e,i)=>{if(!i.consumable.test(e.viewItem,{name:!0,classes:"table"}))return;const n=xJ(e.viewItem);if(!n||!i.consumable.test(n,{name:!0}))return;i.consumable.consume(e.viewItem,{name:!0,classes:"table"});const r=i.convertItem(n,e.modelCursor),o=$t(r.modelRange.getItems());if(!o){i.consumable.revert(e.viewItem,{name:!0,classes:"table"});return}i.convertChildren(e.viewItem,i.writer.createPositionAt(o,"end")),i.updateConversionResult(o,e)})}}function pJ(){return s=>{s.on("element:table",(t,e,i)=>{const n=e.viewItem;if(!i.consumable.test(n,{name:!0}))return;const{rows:r,headingRows:o,headingColumns:l}=bJ(n),a={};l&&(a.headingColumns=l),o&&(a.headingRows=o);const c=i.writer.createElement("table",a);if(i.safeInsert(c,e.modelCursor)){if(i.consumable.consume(n,{name:!0}),r.forEach(h=>i.convertItem(h,i.writer.createPositionAt(c,"end"))),i.convertChildren(n,i.writer.createPositionAt(c,"end")),c.isEmpty){const h=i.writer.createElement("tableRow");i.writer.insert(h,i.writer.createPositionAt(c,"end")),jl(i.writer,i.writer.createPositionAt(h,"end"))}i.updateConversionResult(c,e)}})}}function wJ(){return s=>{s.on("element:tr",(t,e)=>{e.viewItem.isEmpty&&e.modelCursor.index==0&&t.stop()},{priority:"high"})}}function j5(s){return t=>{t.on(`element:${s}`,(e,i,{writer:n})=>{if(!i.modelRange)return;const r=i.modelRange.start.nodeAfter,o=n.createPositionAt(r,0);if(i.viewItem.isEmpty){n.insertElement("paragraph",o);return}const l=Array.from(r.getChildren());if(l.every(a=>a.is("element","$marker"))){const a=n.createElement("paragraph");n.insert(a,n.createPositionAt(r,0));for(const c of l)n.move(n.createRangeOn(c),n.createPositionAt(a,"end"))}},{priority:"low"})}}function xJ(s){for(const t of s.getChildren())if(t.is("element","table"))return t}function bJ(s){let t=0,e;const i=[],n=[];let r;for(const o of Array.from(s.getChildren())){if(o.name!=="tbody"&&o.name!=="thead"&&o.name!=="tfoot")continue;o.name==="thead"&&!r&&(r=o);const l=Array.from(o.getChildren()).filter(c=>c.is("element","tr"));let a=null;for(const c of l){const h=Array.from(c.getChildren()).filter(f=>f.is("element","td")||f.is("element","th"));if(r&&o===r||o.name==="tbody"&&h.length>0&&(a===null||h.length===a)&&h.every(f=>f.is("element","th")))t++,i.push(c);else{n.push(c);const f=OJ(c);(!e||f<e)&&(e=f)}a=Math.max(a||0,h.length)}}return{headingRows:t,headingColumns:e||0,rows:[...i,...n]}}function OJ(s){let t=0,e=0;const i=Array.from(s.getChildren()).filter(n=>n.name==="th"||n.name==="td");for(;e<i.length&&i[e].name==="th";){const n=i[e],r=parseInt(n.getAttribute("colspan")||"1");t=t+r,e++}return t}/**
 * @license Copyright (c) 2003-2025, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options
 */class mt{constructor(t,e={}){p(this,"_table");p(this,"_startRow");p(this,"_endRow");p(this,"_startColumn");p(this,"_endColumn");p(this,"_includeAllSlots");p(this,"_skipRows");p(this,"_row");p(this,"_rowIndex");p(this,"_column");p(this,"_cellIndex");p(this,"_spannedCells");p(this,"_nextCellAtColumn");p(this,"_jumpedToStartRow",!1);this._table=t,this._startRow=e.row!==void 0?e.row:e.startRow||0,this._endRow=e.row!==void 0?e.row:e.endRow,this._startColumn=e.column!==void 0?e.column:e.startColumn||0,this._endColumn=e.column!==void 0?e.column:e.endColumn,this._includeAllSlots=!!e.includeAllSlots,this._skipRows=new Set,this._row=0,this._rowIndex=0,this._column=0,this._cellIndex=0,this._spannedCells=new Map,this._nextCellAtColumn=-1}[Symbol.iterator](){return this}next(){this._canJumpToStartRow()&&this._jumpToNonSpannedRowClosestToStartRow();const t=this._table.getChild(this._rowIndex);if(!t||this._isOverEndRow())return{done:!0,value:void 0};if(!t.is("element","tableRow"))return this._rowIndex++,this.next();if(this._isOverEndColumn())return this._advanceToNextRow();let e=null;const i=this._getSpanned();if(i)this._includeAllSlots&&!this._shouldSkipSlot()&&(e=this._formatOutValue(i.cell,i.row,i.column));else{const n=t.getChild(this._cellIndex);if(!n)return this._advanceToNextRow();const r=parseInt(n.getAttribute("colspan")||"1"),o=parseInt(n.getAttribute("rowspan")||"1");(r>1||o>1)&&this._recordSpans(n,o,r),this._shouldSkipSlot()||(e=this._formatOutValue(n)),this._nextCellAtColumn=this._column+r}return this._column++,this._column==this._nextCellAtColumn&&this._cellIndex++,e||this.next()}skipRow(t){this._skipRows.add(t)}_advanceToNextRow(){return this._row++,this._rowIndex++,this._column=0,this._cellIndex=0,this._nextCellAtColumn=-1,this.next()}_isOverEndRow(){return this._endRow!==void 0&&this._row>this._endRow}_isOverEndColumn(){return this._endColumn!==void 0&&this._column>this._endColumn}_formatOutValue(t,e=this._row,i=this._column){return{done:!1,value:new yJ(this,t,e,i)}}_shouldSkipSlot(){const t=this._skipRows.has(this._row),e=this._row<this._startRow,i=this._column<this._startColumn,n=this._endColumn!==void 0&&this._column>this._endColumn;return t||e||i||n}_getSpanned(){const t=this._spannedCells.get(this._row);return t&&t.get(this._column)||null}_recordSpans(t,e,i){const n={cell:t,row:this._row,column:this._column};for(let r=this._row;r<this._row+e;r++)for(let o=this._column;o<this._column+i;o++)(r!=this._row||o!=this._column)&&this._markSpannedCell(r,o,n)}_markSpannedCell(t,e,i){this._spannedCells.has(t)||this._spannedCells.set(t,new Map),this._spannedCells.get(t).set(e,i)}_canJumpToStartRow(){return!!this._startRow&&this._startRow>0&&!this._jumpedToStartRow}_jumpToNonSpannedRowClosestToStartRow(){const t=this._getRowLength(0);for(let e=this._startRow;!this._jumpedToStartRow;e--)t===this._getRowLength(e)&&(this._row=e,this._rowIndex=e,this._jumpedToStartRow=!0)}_getRowLength(t){return[...this._table.getChild(t).getChildren()].reduce((i,n)=>i+parseInt(n.getAttribute("colspan")||"1"),0)}}class yJ{constructor(t,e,i,n){p(this,"cell");p(this,"row");p(this,"column");p(this,"cellAnchorRow");p(this,"cellAnchorColumn");p(this,"_cellIndex");p(this,"_rowIndex");p(this,"_table");this.cell=e,this.row=t._row,this.column=t._column,this.cellAnchorRow=i,this.cellAnchorColumn=n,this._cellIndex=t._cellIndex,this._rowIndex=t._rowIndex,this._table=t._table}get isAnchor(){return this.row===this.cellAnchorRow&&this.column===this.cellAnchorColumn}get cellWidth(){return parseInt(this.cell.getAttribute("colspan")||"1")}get cellHeight(){return parseInt(this.cell.getAttribute("rowspan")||"1")}get rowIndex(){return this._rowIndex}getPositionBefore(){return this._table.root.document.model.createPositionAt(this._table.getChild(this.row),this._cellIndex)}}function X5(s,t){return(e,{writer:i})=>{const n=e.getAttribute("headingRows")||0,r=i.createContainerElement("table",null,[]),o=i.createContainerElement("figure",{class:"table"},r);n>0&&i.insert(i.createPositionAt(r,"end"),i.createContainerElement("thead",null,i.createSlot(l=>l.is("element","tableRow")&&l.index<n))),n<s.getRows(e)&&i.insert(i.createPositionAt(r,"end"),i.createContainerElement("tbody",null,i.createSlot(l=>l.is("element","tableRow")&&l.index>=n)));for(const{positionOffset:l,filter:a}of t.additionalSlots)i.insert(i.createPositionAt(r,l),i.createSlot(a));return i.insert(i.createPositionAt(r,"after"),i.createSlot(l=>l.is("element","tableRow")?!1:!t.additionalSlots.some(({filter:a})=>a(l)))),t.asWidget?_J(o,i):o}}function vJ(){return(s,{writer:t})=>s.isEmpty?t.createEmptyElement("tr"):t.createContainerElement("tr")}function G5(s={}){return(t,{writer:e})=>{const i=t.parent,n=i.parent,r=n.getChildIndex(i),o=new mt(n,{row:r}),l=n.getAttribute("headingRows")||0,a=n.getAttribute("headingColumns")||0;let c=null;for(const h of o)if(h.cell==t){const m=h.row<l||h.column<a?"th":"td";c=s.asWidget?gy(e.createEditableElement(m),e,{withAriaRole:!1}):e.createContainerElement(m);break}return c}}function Y5(s={}){return(t,{writer:e})=>{if(!t.parent.is("element","tableCell")||!a4(t))return null;if(s.asWidget)return e.createContainerElement("span",{class:"ck-table-bogus-paragraph"});{const i=e.createContainerElement("p");return e.setCustomProperty("dataPipeline:transparentRendering",!0,i),i}}}function a4(s){return s.parent.childCount==1&&!kJ(s)}function _J(s,t){return t.setCustomProperty("table",!0,s),fd(s,t,{hasSelectionHandle:!0})}function kJ(s){for(const t of s.getAttributeKeys())if(!(t.startsWith("selection:")||t=="htmlEmptyBlock"))return!0;return!1}class SJ extends Be{refresh(){const t=this.editor.model,e=t.document.selection,i=t.schema;this.isEnabled=CJ(e,i)}execute(t={}){const e=this.editor,i=e.model,n=e.plugins.get("TableUtils"),r=e.config.get("table.defaultHeadings.rows"),o=e.config.get("table.defaultHeadings.columns");t.headingRows===void 0&&r&&(t.headingRows=r),t.headingColumns===void 0&&o&&(t.headingColumns=o),i.change(l=>{const a=n.createTable(l,t);i.insertObject(a,null,null,{findOptimalPosition:"auto"}),l.setSelection(l.createPositionAt(a.getNodeByPath([0,0,0]),0))})}}function CJ(s,t){const e=s.getFirstPosition().parent,i=e===e.root?e:e.parent;return t.checkChild(i,"table")}class K5 extends Be{constructor(e,i={}){super(e);p(this,"order");this.order=i.order||"below"}refresh(){const e=this.editor.model.document.selection,n=!!this.editor.plugins.get("TableUtils").getSelectionAffectedTableCells(e).length;this.isEnabled=n}execute(){const e=this.editor,i=e.model.document.selection,n=e.plugins.get("TableUtils"),r=this.order==="above",o=n.getSelectionAffectedTableCells(i),l=n.getRowIndexes(o),a=r?l.first:l.last,c=o[0].findAncestor("table");n.insertRows(c,{at:r?a:a+1,copyStructureFromAbove:!r})}}class J5 extends Be{constructor(e,i={}){super(e);p(this,"order");this.order=i.order||"right"}refresh(){const e=this.editor.model.document.selection,n=!!this.editor.plugins.get("TableUtils").getSelectionAffectedTableCells(e).length;this.isEnabled=n}execute(){const e=this.editor,i=e.model.document.selection,n=e.plugins.get("TableUtils"),r=this.order==="left",o=n.getSelectionAffectedTableCells(i),l=n.getColumnIndexes(o),a=r?l.first:l.last,c=o[0].findAncestor("table");n.insertColumns(c,{columns:1,at:r?a:a+1})}}class eP extends Be{constructor(e,i={}){super(e);p(this,"direction");this.direction=i.direction||"horizontally"}refresh(){const i=this.editor.plugins.get("TableUtils").getSelectionAffectedTableCells(this.editor.model.document.selection);this.isEnabled=i.length===1}execute(){const e=this.editor.plugins.get("TableUtils"),i=e.getSelectionAffectedTableCells(this.editor.model.document.selection)[0];this.direction==="horizontally"?e.splitCellHorizontally(i,2):e.splitCellVertically(i,2)}}function c4(s,t,e){const{startRow:i,startColumn:n,endRow:r,endColumn:o}=t,l=e.createElement("table"),a=s.getAttribute("tableType");a&&e.setAttribute("tableType",a,l);const c=r-i+1;for(let f=0;f<c;f++)e.insertElement("tableRow",l,"end");const h=[...new mt(s,{startRow:i,endRow:r,startColumn:n,endColumn:o,includeAllSlots:!0})];for(const{row:f,column:m,cell:w,isAnchor:O,cellAnchorRow:_,cellAnchorColumn:k}of h){const C=f-i,P=l.getChild(C);if(!O)(_<i||k<n)&&jl(e,e.createPositionAt(P,"end"));else{const M=e.cloneElement(w);e.append(M,P),m4(M,f,m,r,o,e)}}return PJ(l,s,i,n,e),l}function u4(s,t,e=0){const i=[],n=new mt(s,{startRow:e,endRow:t-1});for(const r of n){const{row:o,cellHeight:l}=r,a=o+l-1;o<t&&t<=a&&i.push(r)}return i}function h4(s,t,e){const i=s.parent,n=i.parent,r=i.index,o=parseInt(s.getAttribute("rowspan")),l=t-r,a={},c=o-l;c>1&&(a.rowspan=c);const h=parseInt(s.getAttribute("colspan")||"1");h>1&&(a.colspan=h);const f=r,m=f+l,w=[...new mt(n,{startRow:f,endRow:m,includeAllSlots:!0})];let O=null,_;for(const k of w){const{row:C,column:P,cell:M}=k;M===s&&_===void 0&&(_=P),_!==void 0&&_===P&&C===m&&(O=jl(e,k.getPositionBefore(),a))}return Wt("rowspan",l,s,e),O}function d4(s,t){const e=[],i=new mt(s);for(const n of i){const{column:r,cellWidth:o}=n,l=r+o-1;r<t&&t<=l&&e.push(n)}return e}function f4(s,t,e,i){const n=parseInt(s.getAttribute("colspan")),r=e-t,o={},l=n-r;l>1&&(o.colspan=l);const a=parseInt(s.getAttribute("rowspan")||"1");a>1&&(o.rowspan=a);const c=jl(i,i.createPositionAfter(s),o);return Wt("colspan",r,s,i),c}function m4(s,t,e,i,n,r){const o=parseInt(s.getAttribute("colspan")||"1"),l=parseInt(s.getAttribute("rowspan")||"1");if(e+o-1>n){const h=n-e+1;Wt("colspan",h,s,r,1)}if(t+l-1>i){const h=i-t+1;Wt("rowspan",h,s,r,1)}}function PJ(s,t,e,i,n){const r=parseInt(t.getAttribute("headingRows")||"0");if(r>0){const l=r-e;Wt("headingRows",l,s,n,0)}const o=parseInt(t.getAttribute("headingColumns")||"0");if(o>0){const l=o-i;Wt("headingColumns",l,s,n,0)}}function u1(s,t){const e=t.getColumns(s),i=new Array(e).fill(0);for(const{column:r}of new mt(s))i[r]++;const n=i.reduce((r,o,l)=>o?r:[...r,l],[]);if(n.length>0){const r=n[n.length-1];return t.removeColumns(s,{at:r}),!0}return!1}function h1(s,t){const e=[],i=t.getRows(s);for(let n=0;n<i;n++)s.getChild(n).isEmpty&&e.push(n);if(e.length>0){const n=e[e.length-1];return t.removeRows(s,{at:n}),!0}return!1}function Vy(s,t){u1(s,t)||h1(s,t)}function g4(s,t){const e=Array.from(new mt(s,{startColumn:t.firstColumn,endColumn:t.lastColumn,row:t.lastRow}));if(e.every(({cellHeight:r})=>r===1))return t.lastRow;const n=e[0].cellHeight-1;return t.lastRow+n}function p4(s,t){const e=Array.from(new mt(s,{startRow:t.firstRow,endRow:t.lastRow,column:t.lastColumn}));if(e.every(({cellWidth:r})=>r===1))return t.lastColumn;const n=e[0].cellWidth-1;return t.lastColumn+n}class om extends Be{constructor(e,i){super(e);p(this,"direction");p(this,"isHorizontal");this.direction=i.direction,this.isHorizontal=this.direction=="right"||this.direction=="left"}refresh(){const e=this._getMergeableCell();this.value=e,this.isEnabled=!!e}execute(){const e=this.editor.model,i=e.document,r=this.editor.plugins.get("TableUtils").getTableCellsContainingSelection(i.selection)[0],o=this.value,l=this.direction;e.change(a=>{const c=l=="right"||l=="down",h=c?r:o,f=c?o:r,m=f.parent;AJ(f,h,a);const w=this.isHorizontal?"colspan":"rowspan",O=parseInt(r.getAttribute(w)||"1"),_=parseInt(o.getAttribute(w)||"1");a.setAttribute(w,O+_,h),a.setSelection(a.createRangeIn(h));const k=this.editor.plugins.get("TableUtils"),C=m.findAncestor("table");Vy(C,k)})}_getMergeableCell(){const i=this.editor.model.document,n=this.editor.plugins.get("TableUtils"),r=n.getTableCellsContainingSelection(i.selection)[0];if(!r)return;const o=this.isHorizontal?TJ(r,this.direction,n):EJ(r,this.direction,n);if(!o)return;const l=this.isHorizontal?"rowspan":"colspan",a=parseInt(r.getAttribute(l)||"1");if(parseInt(o.getAttribute(l)||"1")===a)return o}}function TJ(s,t,e){const n=s.parent.parent,r=t=="right"?s.nextSibling:s.previousSibling,o=(n.getAttribute("headingColumns")||0)>0;if(!r)return;const l=t=="right"?s:r,a=t=="right"?r:s,{column:c}=e.getCellLocation(l),{column:h}=e.getCellLocation(a),f=parseInt(l.getAttribute("colspan")||"1"),m=c1(e,l),w=c1(e,a);return o&&m!=w?void 0:c+f===h?r:void 0}function EJ(s,t,e){const i=s.parent,n=i.parent,r=n.getChildIndex(i);if(t=="down"&&r===e.getRows(n)-1||t=="up"&&r===0)return null;const o=parseInt(s.getAttribute("rowspan")||"1"),l=n.getAttribute("headingRows")||0,a=t=="down"&&r+o===l,c=t=="up"&&r===l;if(l&&(a||c))return null;const h=parseInt(s.getAttribute("rowspan")||"1"),f=t=="down"?r+h:r,m=[...new mt(n,{endRow:f})],O=m.find(k=>k.cell===s).column,_=m.find(({row:k,cellHeight:C,column:P})=>P!==O?!1:t=="down"?k===f:f===k+C);return _&&_.cell?_.cell:null}function AJ(s,t,e){tP(s)||(tP(t)&&e.remove(e.createRangeIn(t)),e.move(e.createRangeIn(s),e.createPositionAt(t,"end"))),e.remove(s)}function tP(s){const t=s.getChild(0);return s.childCount==1&&t.is("element","paragraph")&&t.isEmpty}class IJ extends Be{refresh(){const t=this.editor.plugins.get("TableUtils"),e=t.getSelectionAffectedTableCells(this.editor.model.document.selection),i=e[0];if(i){const n=i.findAncestor("table"),o=t.getRows(n)-1,l=t.getRowIndexes(e),a=l.first===0&&l.last===o;this.isEnabled=!a}else this.isEnabled=!1}execute(){const t=this.editor.model,e=this.editor.plugins.get("TableUtils"),i=e.getSelectionAffectedTableCells(t.document.selection),n=e.getRowIndexes(i),r=i[0],o=r.findAncestor("table"),l=e.getCellLocation(r).column;t.change(a=>{const c=n.last-n.first+1;e.removeRows(o,{at:n.first,rows:c});const h=RJ(o,n.first,l,e.getRows(o));a.setSelection(a.createPositionAt(h,0))})}}function RJ(s,t,e,i){const n=s.getChild(Math.min(t,i-1));let r=n.getChild(0),o=0;for(const l of n.getChildren()){if(o>e)return r;r=l,o+=parseInt(l.getAttribute("colspan")||"1")}return r}class VJ extends Be{refresh(){const t=this.editor.plugins.get("TableUtils"),e=t.getSelectionAffectedTableCells(this.editor.model.document.selection),i=e[0];if(i){const n=i.findAncestor("table"),r=t.getColumns(n),{first:o,last:l}=t.getColumnIndexes(e);this.isEnabled=l-o<r-1}else this.isEnabled=!1}execute(){const t=this.editor.plugins.get("TableUtils"),[e,i]=LJ(this.editor.model.document.selection,t),n=e.parent.parent,r=[...new mt(n)],o={first:r.find(a=>a.cell===e).column,last:r.find(a=>a.cell===i).column},l=MJ(r,e,i,o);this.editor.model.change(a=>{const c=o.last-o.first+1;t.removeColumns(n,{at:o.first,columns:c}),a.setSelection(a.createPositionAt(l,0))})}}function MJ(s,t,e,i){return parseInt(e.getAttribute("colspan")||"1")>1?e:t.previousSibling||e.nextSibling?e.nextSibling||t.previousSibling:i.first?s.reverse().find(({column:r})=>r<i.first).cell:s.reverse().find(({column:r})=>r>i.last).cell}function LJ(s,t){const e=t.getSelectionAffectedTableCells(s),i=e[0],n=e.pop(),r=[i,n];return i.isBefore(n)?r:r.reverse()}class BJ extends Be{refresh(){const t=this.editor.plugins.get("TableUtils"),e=this.editor.model,i=t.getSelectionAffectedTableCells(e.document.selection);if(i.length===0){this.isEnabled=!1,this.value=!1;return}const n=i[0].findAncestor("table");this.isEnabled=e.schema.checkAttribute(n,"headingRows"),this.value=i.every(r=>this._isInHeading(r,r.parent.parent))}execute(t={}){if(t.forceValue===this.value)return;const e=this.editor.plugins.get("TableUtils"),i=this.editor.model,n=e.getSelectionAffectedTableCells(i.document.selection),r=n[0].findAncestor("table"),{first:o,last:l}=e.getRowIndexes(n),a=this.value?o:l+1,c=r.getAttribute("headingRows")||0;i.change(h=>{if(a){const f=a>c?c:0,m=u4(r,a,f);for(const{cell:w}of m)h4(w,a,h)}Wt("headingRows",a,r,h,0)})}_isInHeading(t,e){const i=parseInt(e.getAttribute("headingRows")||"0");return!!i&&t.parent.index<i}}class $J extends Be{refresh(){const t=this.editor.plugins.get("TableUtils"),e=this.editor.model,i=t.getSelectionAffectedTableCells(e.document.selection);if(i.length===0){this.isEnabled=!1,this.value=!1;return}const n=i[0].findAncestor("table");this.isEnabled=e.schema.checkAttribute(n,"headingColumns"),this.value=i.every(r=>c1(t,r))}execute(t={}){if(t.forceValue===this.value)return;const e=this.editor.plugins.get("TableUtils"),i=this.editor.model,n=e.getSelectionAffectedTableCells(i.document.selection),r=n[0].findAncestor("table"),{first:o,last:l}=e.getColumnIndexes(n),a=this.value?o:l+1;i.change(c=>{if(a){const h=d4(r,a);for(const{cell:f,column:m}of h)f4(f,m,a,c)}Wt("headingColumns",a,r,c,0)})}}/**
 * @license Copyright (c) 2003-2025, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options
 */const DJ=5,d1=40,QJ=2,NJ=3;function FJ(s){const t=new Set;for(const e of s.document.differ.getChanges()){let i=null;switch(e.type){case"insert":i=["table","tableRow","tableCell"].includes(e.name)?e.position:null;break;case"remove":i=["tableRow","tableCell"].includes(e.name)?e.position:null;break;case"attribute":e.range.start.nodeAfter&&(i=["table","tableRow","tableCell"].includes(e.range.start.nodeAfter.name)?e.range.start:null);break}if(!i)continue;const n=i.nodeAfter&&i.nodeAfter.is("element","table")?i.nodeAfter:i.findAncestor("table");for(const r of s.createRangeOn(n).getItems())r.is("element","table")&&wd(r)&&t.add(r)}return t}function zJ(s,t){return d1*100/w4(s,t)}function w4(s,t){const e=iP(s,"tbody",t)||iP(s,"thead",t),i=t.editing.view.domConverter.mapViewToDom(e);return f1(i)}function iP(s,t,e){return[...[...e.editing.mapper.toViewElement(s).getChildren()].find(r=>r.is("element","table")).getChildren()].find(r=>r.is("element",t))}function f1(s){const t=he.window.getComputedStyle(s);return t.boxSizing==="border-box"?parseFloat(t.width)-parseFloat(t.paddingLeft)-parseFloat(t.paddingRight)-parseFloat(t.borderLeftWidth)-parseFloat(t.borderRightWidth):parseFloat(t.width)}function WJ(s,t){const e=t.getCellLocation(s).column,i=s.getAttribute("colspan")||1;return{leftEdge:e,rightEdge:e+i-1}}function gn(s){const t=Math.pow(10,QJ),e=typeof s=="number"?s:parseFloat(s);return Math.round(e*t)/t}function UJ(s,t,e){return s<=t?gn(t):s>=e?gn(e):gn(s)}function ZJ(s,t){return Array(s).fill(t)}function Nh(s){return s.map(t=>typeof t=="number"?t:parseFloat(t)).filter(t=>!Number.isNaN(t)).reduce((t,e)=>t+e,0)}function My(s){const t=s.map(n=>n==="auto"?n:parseFloat(n.replace("%","")));let e=HJ(t);const i=Nh(e);return i!==100&&(e=e.map(n=>gn(n*100/i)).map((n,r,o)=>{if(!(r===o.length-1))return n;const a=Nh(o);return gn(n+100-a)})),e.map(n=>n+"%")}function HJ(s){const t=s.filter(n=>n==="auto").length;if(t===0)return s.map(n=>gn(n));const e=Nh(s),i=Math.max((100-e)/t,DJ);return s.map(n=>n==="auto"?i:n).map(n=>gn(n))}function qJ(s){const t=he.window.getComputedStyle(s);return t.boxSizing==="border-box"?parseInt(t.width):parseFloat(t.width)+parseFloat(t.paddingLeft)+parseFloat(t.paddingRight)+parseFloat(t.borderWidth)}function x4(s,t,e,i){for(let n=0;n<Math.max(e.length,s.length);n++){const r=s[n],o=e[n];o?r?i.setAttribute("columnWidth",o,r):i.appendElement("tableColumn",{columnWidth:o},t):i.remove(r)}}function wd(s){if(s.is("element","tableColumnGroup"))return s;const t=s.getChildren();return Array.from(t).find(e=>e.is("element","tableColumnGroup"))}function xd(s){const t=wd(s);return t?Array.from(t.getChildren()):[]}function jJ(s){return xd(s).map(t=>t.getAttribute("columnWidth"))}function XJ(s,t){return xd(s).reduce((i,n)=>{const r=n.getAttribute("columnWidth"),o=n.getAttribute("colSpan");if(!o)return i.push(r),i;for(let l=0;l<o;l++)i.push(r);return t.removeAttribute("colSpan",n),i},[])}class Oi extends F{static get pluginName(){return"TableUtils"}static get isOfficialPlugin(){return!0}init(){this.decorate("insertColumns"),this.decorate("insertRows")}getCellLocation(t){const e=t.parent,i=e.parent,n=i.getChildIndex(e),r=new mt(i,{row:n});for(const{cell:o,row:l,column:a}of r)if(o===t)return{row:l,column:a};/* istanbul ignore next -- @preserve */}createTable(t,e){const i=t.createElement("table"),n=e.rows||2,r=e.columns||2;return $x(t,i,0,n,r),e.headingRows&&Wt("headingRows",Math.min(e.headingRows,n),i,t,0),e.headingColumns&&Wt("headingColumns",Math.min(e.headingColumns,r),i,t,0),i}insertRows(t,e={}){const i=this.editor.model,n=e.at||0,r=e.rows||1,o=e.copyStructureFromAbove!==void 0,l=e.copyStructureFromAbove?n-1:n,a=this.getRows(t),c=this.getColumns(t);if(n>a)throw new E("tableutils-insertrows-insert-out-of-range",this,{options:e});i.change(h=>{const f=t.getAttribute("headingRows")||0;if(f>n&&Wt("headingRows",f+r,t,h,0),!o&&(n===0||n===a)){$x(h,t,n,r,c);return}const m=o?Math.max(n,l):n,w=new mt(t,{endRow:m}),O=new Array(c).fill(1);for(const{row:_,column:k,cellHeight:C,cellWidth:P,cell:M}of w){const Q=_+C-1,N=_<n&&n<=Q,G=_<=l&&l<=Q;N?(h.setAttribute("rowspan",C+r,M),O[k]=-P):o&&G&&(O[k]=P)}for(let _=0;_<r;_++){const k=h.createElement("tableRow");h.insert(k,t,n);for(let C=0;C<O.length;C++){const P=O[C],M=h.createPositionAt(k,"end");P>0&&jl(h,M,P>1?{colspan:P}:void 0),C+=Math.abs(P)-1}}})}insertColumns(t,e={}){const i=this.editor.model,n=e.at||0,r=e.columns||1;i.change(o=>{const l=t.getAttribute("headingColumns");n<l&&o.setAttribute("headingColumns",l+r,t);const a=this.getColumns(t);if(n===0||a===n){for(const h of t.getChildren())h.is("element","tableRow")&&Ua(r,o,o.createPositionAt(h,n?"end":0));return}const c=new mt(t,{column:n,includeAllSlots:!0});for(const h of c){const{row:f,cell:m,cellAnchorColumn:w,cellAnchorRow:O,cellWidth:_,cellHeight:k}=h;if(w<n){o.setAttribute("colspan",_+r,m);const C=O+k-1;for(let P=f;P<=C;P++)c.skipRow(P)}else Ua(r,o,h.getPositionBefore())}})}removeRows(t,e){const i=this.editor.model,n=e.rows||1,r=this.getRows(t),o=e.at,l=o+n-1;if(l>r-1)throw new E("tableutils-removerows-row-index-out-of-range",this,{table:t,options:e});i.change(a=>{const c={first:o,last:l},{cellsToMove:h,cellsToTrim:f}=KJ(t,c);if(h.size){const m=l+1;JJ(t,m,h,a)}for(let m=l;m>=o;m--)a.remove(t.getChild(m));for(const{rowspan:m,cell:w}of f)Wt("rowspan",m,w,a);YJ(t,c,a),u1(t,this)||h1(t,this)})}removeColumns(t,e){const i=this.editor.model,n=e.at,r=e.columns||1,o=e.at+r-1;i.change(l=>{GJ(t,{first:n,last:o},l);const a=xd(t);for(let c=o;c>=n;c--){for(const{cell:h,column:f,cellWidth:m}of[...new mt(t)])f<=c&&m>1&&f+m>c?Wt("colspan",m-1,h,l):f===c&&l.remove(h);if(a[c]){const h=c===0?a[1]:a[c-1],f=parseFloat(a[c].getAttribute("columnWidth")),m=parseFloat(h.getAttribute("columnWidth"));l.remove(a[c]),l.setAttribute("columnWidth",f+m+"%",h)}}h1(t,this)||u1(t,this)})}splitCellVertically(t,e=2){const i=this.editor.model,r=t.parent.parent,o=parseInt(t.getAttribute("rowspan")||"1"),l=parseInt(t.getAttribute("colspan")||"1");i.change(a=>{if(l>1){const{newCellsSpan:c,updatedSpan:h}=nP(l,e);Wt("colspan",h,t,a);const f={};c>1&&(f.colspan=c),o>1&&(f.rowspan=o);const m=l>e?e-1:l-1;Ua(m,a,a.createPositionAfter(t),f)}if(l<e){const c=e-l,h=[...new mt(r)],{column:f}=h.find(({cell:_})=>_===t),m=h.filter(({cell:_,cellWidth:k,column:C})=>{const P=_!==t&&C===f,M=C<f&&C+k>f;return P||M});for(const{cell:_,cellWidth:k}of m)a.setAttribute("colspan",k+c,_);const w={};o>1&&(w.rowspan=o),Ua(c,a,a.createPositionAfter(t),w);const O=r.getAttribute("headingColumns")||0;O>f&&Wt("headingColumns",O+c,r,a)}})}splitCellHorizontally(t,e=2){const i=this.editor.model,n=t.parent,r=n.parent,o=r.getChildIndex(n),l=parseInt(t.getAttribute("rowspan")||"1"),a=parseInt(t.getAttribute("colspan")||"1");i.change(c=>{if(l>1){const h=[...new mt(r,{startRow:o,endRow:o+l-1,includeAllSlots:!0})],{newCellsSpan:f,updatedSpan:m}=nP(l,e);Wt("rowspan",m,t,c);const{column:w}=h.find(({cell:k})=>k===t),O={};f>1&&(O.rowspan=f),a>1&&(O.colspan=a);let _=0;for(const k of h){const{column:C,row:P}=k,M=P>=o+m,Q=C===w;_>=f&&Q&&(_=0),M&&Q&&(_||Ua(1,c,k.getPositionBefore(),O),_++)}}if(l<e){const h=e-l,f=[...new mt(r,{startRow:0,endRow:o})];for(const{cell:O,cellHeight:_,row:k}of f)if(O!==t&&k+_>o){const C=_+h;c.setAttribute("rowspan",C,O)}const m={};a>1&&(m.colspan=a),$x(c,r,o+1,h,1,m);const w=r.getAttribute("headingRows")||0;w>o&&Wt("headingRows",w+h,r,c)}})}getColumns(t){return[...t.getChild(0).getChildren()].filter(i=>i.is("element","tableCell")).reduce((i,n)=>{const r=parseInt(n.getAttribute("colspan")||"1");return i+r},0)}getRows(t){return Array.from(t.getChildren()).reduce((e,i)=>i.is("element","tableRow")?e+1:e,0)}createTableWalker(t,e={}){return new mt(t,e)}getSelectedTableCells(t){const e=[];for(const i of this.sortRanges(t.getRanges())){const n=i.getContainedElement();n&&n.is("element","tableCell")&&e.push(n)}return e}getTableCellsContainingSelection(t){const e=[];for(const i of t.getRanges()){const n=i.start.findAncestor("tableCell");n&&e.push(n)}return e}getSelectionAffectedTableCells(t){const e=this.getSelectedTableCells(t);return e.length?e:this.getTableCellsContainingSelection(t)}getRowIndexes(t){const e=t.map(i=>i.parent.index);return this._getFirstLastIndexesObject(e)}getColumnIndexes(t){const e=t[0].findAncestor("table"),n=[...new mt(e)].filter(r=>t.includes(r.cell)).map(r=>r.column);return this._getFirstLastIndexesObject(n)}isSelectionRectangular(t){if(t.length<2||!this._areCellInTheSameTableSection(t))return!1;const e=new Set,i=new Set;let n=0;for(const o of t){const{row:l,column:a}=this.getCellLocation(o),c=parseInt(o.getAttribute("rowspan"))||1,h=parseInt(o.getAttribute("colspan"))||1;e.add(l),i.add(a),c>1&&e.add(l+c-1),h>1&&i.add(a+h-1),n+=c*h}return tee(e,i)==n}sortRanges(t){return Array.from(t).sort(eee)}_getFirstLastIndexesObject(t){const e=t.sort((r,o)=>r-o),i=e[0],n=e[e.length-1];return{first:i,last:n}}_areCellInTheSameTableSection(t){const e=t[0].findAncestor("table"),i=this.getRowIndexes(t),n=parseInt(e.getAttribute("headingRows"))||0;if(!this._areIndexesInSameSection(i,n))return!1;const r=this.getColumnIndexes(t),o=parseInt(e.getAttribute("headingColumns"))||0;return this._areIndexesInSameSection(r,o)}_areIndexesInSameSection({first:t,last:e},i){const n=t<i,r=e<i;return n===r}}function $x(s,t,e,i,n,r={}){for(let o=0;o<i;o++){const l=s.createElement("tableRow");s.insert(l,t,e),Ua(n,s,s.createPositionAt(l,"end"),r)}}function Ua(s,t,e,i={}){for(let n=0;n<s;n++)jl(t,e,i)}function nP(s,t){if(s<t)return{newCellsSpan:1,updatedSpan:1};const e=Math.floor(s/t),i=s-e*t+e;return{newCellsSpan:e,updatedSpan:i}}function GJ(s,t,e){const i=s.getAttribute("headingColumns")||0;if(i&&t.first<i){const n=Math.min(i-1,t.last)-t.first+1;e.setAttribute("headingColumns",i-n,s)}}function YJ(s,{first:t,last:e},i){const n=s.getAttribute("headingRows")||0;if(t<n){const r=e<n?n-(e-t+1):t;Wt("headingRows",r,s,i,0)}}function KJ(s,{first:t,last:e}){const i=new Map,n=[];for(const{row:r,column:o,cellHeight:l,cell:a}of new mt(s,{endRow:e})){const c=r+l-1;if(r>=t&&r<=e&&c>e){const m=e-r+1,w=l-m;i.set(o,{cell:a,rowspan:w})}if(r<t&&c>=t){let m;c>=e?m=e-t+1:m=c-t+1,n.push({cell:a,rowspan:l-m})}}return{cellsToMove:i,cellsToTrim:n}}function JJ(s,t,e,i){const r=[...new mt(s,{includeAllSlots:!0,row:t})],o=s.getChild(t);let l;for(const{column:a,cell:c,isAnchor:h}of r)if(e.has(a)){const{cell:f,rowspan:m}=e.get(a),w=l?i.createPositionAfter(l):i.createPositionAt(o,0);i.move(i.createRangeOn(f),w),Wt("rowspan",m,f,i),l=f}else h&&(l=c)}function eee(s,t){const e=s.start,i=t.start;return e.isBefore(i)?-1:1}function tee(s,t){const e=Array.from(s.values()),i=Array.from(t.values()),n=Math.max(...e),r=Math.min(...e),o=Math.max(...i),l=Math.min(...i);return(n-r+1)*(o-l+1)}class iee extends Be{refresh(){const t=this.editor.plugins.get(Oi),e=t.getSelectedTableCells(this.editor.model.document.selection);this.isEnabled=t.isSelectionRectangular(e)}execute(){const t=this.editor.model,e=this.editor.plugins.get(Oi);t.change(i=>{const n=e.getSelectedTableCells(t.document.selection),r=n.shift(),{mergeWidth:o,mergeHeight:l}=see(r,n,e);Wt("colspan",o,r,i),Wt("rowspan",l,r,i);for(const c of n)nee(c,r,i);const a=r.findAncestor("table");Vy(a,e),i.setSelection(r,"in")})}}function nee(s,t,e){sP(s)||(sP(t)&&e.remove(e.createRangeIn(t)),e.move(e.createRangeIn(s),e.createPositionAt(t,"end"))),e.remove(s)}function sP(s){const t=s.getChild(0);return s.childCount==1&&t.is("element","paragraph")&&t.isEmpty}function see(s,t,e){let i=0,n=0;for(const c of t){const{row:h,column:f}=e.getCellLocation(c);i=rP(c,f,i,"colspan"),n=rP(c,h,n,"rowspan")}const{row:r,column:o}=e.getCellLocation(s),l=i-o,a=n-r;return{mergeWidth:l,mergeHeight:a}}function rP(s,t,e,i){const n=parseInt(s.getAttribute(i)||"1");return Math.max(e,t+n)}class ree extends Be{constructor(t){super(t),this.affectsData=!1}refresh(){const e=this.editor.plugins.get("TableUtils").getSelectionAffectedTableCells(this.editor.model.document.selection);this.isEnabled=e.length>0}execute(){const t=this.editor.model,e=this.editor.plugins.get("TableUtils"),i=e.getSelectionAffectedTableCells(t.document.selection),n=e.getRowIndexes(i),r=i[0].findAncestor("table"),o=[];for(let l=n.first;l<=n.last;l++)for(const a of r.getChild(l).getChildren())o.push(t.createRangeOn(a));t.change(l=>{l.setSelection(o)})}}class oee extends Be{constructor(t){super(t),this.affectsData=!1}refresh(){const e=this.editor.plugins.get("TableUtils").getSelectionAffectedTableCells(this.editor.model.document.selection);this.isEnabled=e.length>0}execute(){const t=this.editor.plugins.get("TableUtils"),e=this.editor.model,i=t.getSelectionAffectedTableCells(e.document.selection),n=i[0],r=i.pop(),o=n.findAncestor("table"),l=t.getCellLocation(n),a=t.getCellLocation(r),c=Math.min(l.column,a.column),h=Math.max(l.column,a.column),f=[];for(const m of new mt(o,{startColumn:c,endColumn:h}))f.push(e.createRangeOn(m.cell));e.change(m=>{m.setSelection(f)})}}function lee(s){s.document.registerPostFixer(t=>aee(t,s))}function aee(s,t){const e=t.document.differ.getChanges();let i=!1;const n=new Set;for(const r of e){let o=null;r.type=="insert"&&r.name=="table"&&(o=r.position.nodeAfter),(r.type=="insert"||r.type=="remove")&&(r.name=="tableRow"||r.name=="tableCell")&&(o=r.position.findAncestor("table")),fee(r)&&(o=r.range.start.findAncestor("table")),o&&!n.has(o)&&(i=cee(o,s)||i,i=uee(o,s)||i,n.add(o))}return i}function cee(s,t){let e=!1;const i=hee(s);if(i.length){e=!0;for(const n of i)Wt("rowspan",n.rowspan,n.cell,t,1)}return e}function uee(s,t){let e=!1;const i=dee(s),n=[];for(const[a,c]of i.entries())!c&&s.getChild(a).is("element","tableRow")&&n.push(a);if(n.length){e=!0;for(const a of n.reverse())t.remove(s.getChild(a)),i.splice(a,1)}const r=i.filter((a,c)=>s.getChild(c).is("element","tableRow")),o=r[0];if(!r.every(a=>a===o)){const a=r.reduce((c,h)=>h>c?h:c,0);for(const[c,h]of r.entries()){const f=a-h;if(f){for(let m=0;m<f;m++)jl(t,t.createPositionAt(s.getChild(c),"end"));e=!0}}}return e}function hee(s){const t=parseInt(s.getAttribute("headingRows")||"0"),e=Array.from(s.getChildren()).reduce((n,r)=>r.is("element","tableRow")?n+1:n,0),i=[];for(const{row:n,cell:r,cellHeight:o}of new mt(s)){if(o<2)continue;const a=n<t?t:e;if(n+o>a){const c=a-n;i.push({cell:r,rowspan:c})}}return i}function dee(s){const t=new Array(s.childCount).fill(0);for(const{rowIndex:e}of new mt(s,{includeAllSlots:!0}))t[e]++;return t}function fee(s){if(s.type!=="attribute")return!1;const t=s.attributeKey;return t==="headingRows"||t==="colspan"||t==="rowspan"}/**
 * @license Copyright (c) 2003-2025, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options
 */function mee(s){s.document.registerPostFixer(t=>gee(t,s))}function gee(s,t){const e=t.document.differ.getChanges();let i=!1;for(const n of e)n.type=="insert"&&n.name=="table"&&(i=pee(n.position.nodeAfter,s)||i),n.type=="insert"&&n.name=="tableRow"&&(i=b4(n.position.nodeAfter,s)||i),n.type=="insert"&&n.name=="tableCell"&&(i=m1(n.position.nodeAfter,s)||i),(n.type=="remove"||n.type=="insert")&&wee(n)&&(i=m1(n.position.parent,s)||i);return i}function pee(s,t){let e=!1;for(const i of s.getChildren())i.is("element","tableRow")&&(e=b4(i,t)||e);return e}function b4(s,t){let e=!1;for(const i of s.getChildren())e=m1(i,t)||e;return e}function m1(s,t){if(s.childCount==0)return t.insertElement("paragraph",s),!0;const e=Array.from(s.getChildren()).filter(i=>i.is("$text"));for(const i of e)t.wrap(t.createRangeOn(i),"paragraph");return!!e.length}function wee(s){return s.position.parent.is("element","tableCell")?s.type=="insert"&&s.name=="$text"||s.type=="remove":!1}function xee(s,t){const e=s.document.differ;for(const i of e.getChanges()){let n,r=!1;if(i.type=="attribute"){const c=i.range.start.nodeAfter;if(!c||!c.is("element","table")||i.attributeKey!="headingRows"&&i.attributeKey!="headingColumns")continue;n=c,r=i.attributeKey=="headingRows"}else(i.name=="tableRow"||i.name=="tableCell")&&(n=i.position.findAncestor("table"),r=i.name=="tableRow");if(!n)continue;const o=n.getAttribute("headingRows")||0,l=n.getAttribute("headingColumns")||0,a=new mt(n);for(const c of a){const f=c.row<o||c.column<l?"th":"td",m=t.mapper.toViewElement(c.cell);m&&m.is("element")&&m.name!=f&&t.reconvertItem(r?c.cell.parent:c.cell)}}}function bee(s,t){const e=s.document.differ,i=new Set;for(const n of e.getChanges()){const r=n.type=="attribute"?n.range.start.parent:n.position.parent;r.is("element","tableCell")&&i.add(r)}for(const n of i.values()){const r=Array.from(n.getChildren()).filter(o=>Oee(o,t.mapper));for(const o of r)t.reconvertItem(o)}}function Oee(s,t){if(!s.is("element","paragraph"))return!1;const e=t.toViewElement(s);return e?a4(s)!==e.is("element","span"):!1}class bd extends F{constructor(e){super(e);p(this,"_additionalSlots");this._additionalSlots=[]}static get pluginName(){return"TableEditing"}static get isOfficialPlugin(){return!0}static get requires(){return[Oi]}init(){const e=this.editor,i=e.model,n=i.schema,r=e.conversion,o=e.plugins.get(Oi);n.register("table",{inheritAllFrom:"$blockObject",allowAttributes:["headingRows","headingColumns"]}),n.register("tableRow",{allowIn:"table",isLimit:!0}),n.register("tableCell",{allowContentOf:"$container",allowIn:"tableRow",allowAttributes:["colspan","rowspan"],isLimit:!0,isSelectable:!0}),r.for("upcast").add(gJ()),r.for("upcast").add(pJ()),r.for("editingDowncast").elementToStructure({model:{name:"table",attributes:["headingRows"]},view:X5(o,{asWidget:!0,additionalSlots:this._additionalSlots})}),r.for("dataDowncast").elementToStructure({model:{name:"table",attributes:["headingRows"]},view:X5(o,{additionalSlots:this._additionalSlots})}),r.for("upcast").elementToElement({model:"tableRow",view:"tr"}),r.for("upcast").add(wJ()),r.for("downcast").elementToElement({model:"tableRow",view:vJ()}),r.for("upcast").elementToElement({model:"tableCell",view:"td"}),r.for("upcast").elementToElement({model:"tableCell",view:"th"}),r.for("upcast").add(j5("td")),r.for("upcast").add(j5("th")),r.for("editingDowncast").elementToElement({model:"tableCell",view:G5({asWidget:!0})}),r.for("dataDowncast").elementToElement({model:"tableCell",view:G5()}),r.for("editingDowncast").elementToElement({model:"paragraph",view:Y5({asWidget:!0}),converterPriority:"high"}),r.for("dataDowncast").elementToElement({model:"paragraph",view:Y5(),converterPriority:"high"}),r.for("downcast").attributeToAttribute({model:"colspan",view:"colspan"}),r.for("upcast").attributeToAttribute({model:{key:"colspan",value:oP("colspan")},view:"colspan"}),r.for("downcast").attributeToAttribute({model:"rowspan",view:"rowspan"}),r.for("upcast").attributeToAttribute({model:{key:"rowspan",value:oP("rowspan")},view:"rowspan"}),e.config.define("table.defaultHeadings.rows",0),e.config.define("table.defaultHeadings.columns",0),e.commands.add("insertTable",new SJ(e)),e.commands.add("insertTableRowAbove",new K5(e,{order:"above"})),e.commands.add("insertTableRowBelow",new K5(e,{order:"below"})),e.commands.add("insertTableColumnLeft",new J5(e,{order:"left"})),e.commands.add("insertTableColumnRight",new J5(e,{order:"right"})),e.commands.add("removeTableRow",new IJ(e)),e.commands.add("removeTableColumn",new VJ(e)),e.commands.add("splitTableCellVertically",new eP(e,{direction:"vertically"})),e.commands.add("splitTableCellHorizontally",new eP(e,{direction:"horizontally"})),e.commands.add("mergeTableCells",new iee(e)),e.commands.add("mergeTableCellRight",new om(e,{direction:"right"})),e.commands.add("mergeTableCellLeft",new om(e,{direction:"left"})),e.commands.add("mergeTableCellDown",new om(e,{direction:"down"})),e.commands.add("mergeTableCellUp",new om(e,{direction:"up"})),e.commands.add("setTableColumnHeader",new $J(e)),e.commands.add("setTableRowHeader",new BJ(e)),e.commands.add("selectTableRow",new ree(e)),e.commands.add("selectTableColumn",new oee(e)),lee(i),mee(i),this.listenTo(i.document,"change:data",()=>{xee(i,e.editing),bee(i,e.editing)})}registerAdditionalSlot(e){this._additionalSlots.push(e)}}function oP(s){return t=>{const e=parseInt(t.getAttribute(s));return Number.isNaN(e)||e<=0?null:e}}class lP extends ue{constructor(e){super(e);p(this,"items");p(this,"keystrokes");p(this,"focusTracker");const i=this.bindTemplate;this.items=this._createGridCollection(),this.keystrokes=new wt,this.focusTracker=new ot,this.set("rows",0),this.set("columns",0),this.bind("label").to(this,"columns",this,"rows",(n,r)=>`${r} × ${n}`),this.setTemplate({tag:"div",attributes:{class:["ck"]},children:[{tag:"div",attributes:{class:["ck-insert-table-dropdown__grid"]},on:{"mouseover@.ck-insert-table-dropdown-grid-box":i.to("boxover")},children:this.items},{tag:"div",attributes:{class:["ck","ck-insert-table-dropdown__label"],"aria-hidden":!0},children:[{text:i.to("label")}]}],on:{mousedown:i.to(n=>{n.preventDefault()}),click:i.to(()=>{this.fire("execute")})}}),this.on("boxover",(n,r)=>{const{row:o,column:l}=r.target.dataset;this.items.get((parseInt(o,10)-1)*10+(parseInt(l,10)-1)).focus()}),this.focusTracker.on("change:focusedElement",(n,r,o)=>{if(!o)return;const{row:l,column:a}=o.dataset;this.set({rows:parseInt(l),columns:parseInt(a)})}),this.on("change:columns",()=>this._highlightGridBoxes()),this.on("change:rows",()=>this._highlightGridBoxes())}render(){super.render(),Ep({keystrokeHandler:this.keystrokes,focusTracker:this.focusTracker,gridItems:this.items,numberOfColumns:10,uiLanguageDirection:this.locale&&this.locale.uiLanguageDirection});for(const e of this.items)this.focusTracker.add(e.element);this.keystrokes.listenTo(this.element)}reset(){this.set({rows:1,columns:1})}focus(){this.items.get(0).focus()}focusLast(){this.items.get(0).focus()}_highlightGridBoxes(){const e=this.rows,i=this.columns;this.items.map((n,r)=>{const o=Math.floor(r/10),l=r%10,a=o<e&&l<i;n.set("isOn",a)})}_createGridButton(e,i,n,r){const o=new ye(e);return o.set({label:r,class:"ck-insert-table-dropdown-grid-box"}),o.extendTemplate({attributes:{"data-row":i,"data-column":n}}),o}_createGridCollection(){const e=[];for(let i=0;i<100;i++){const n=Math.floor(i/10),r=i%10,o=`${n+1} × ${r+1}`;e.push(this._createGridButton(this.locale,n+1,r+1,o))}return this.createCollection(e)}}class yee extends F{static get pluginName(){return"TableUI"}static get isOfficialPlugin(){return!0}init(){const t=this.editor,e=this.editor.t,n=t.locale.contentLanguageDirection==="ltr";t.ui.componentFactory.add("insertTable",r=>{const o=t.commands.get("insertTable"),l=nn(r);l.bind("isEnabled").to(o),l.buttonView.set({icon:FC,label:e("Insert table"),tooltip:!0});let a;return l.on("change:isOpen",()=>{a||(a=new lP(r),l.panelView.children.add(a),a.delegate("execute").to(l),l.on("execute",()=>{t.execute("insertTable",{rows:a.rows,columns:a.columns}),t.editing.view.focus()}))}),l}),t.ui.componentFactory.add("menuBar:insertTable",r=>{const o=t.commands.get("insertTable"),l=new cs(r),a=new lP(r);return a.delegate("execute").to(l),l.on("change:isOpen",(c,h,f)=>{f||a.reset()}),a.on("execute",()=>{t.execute("insertTable",{rows:a.rows,columns:a.columns}),t.editing.view.focus()}),l.buttonView.set({label:e("Table"),icon:FC}),l.panelView.children.add(a),l.bind("isEnabled").to(o),l}),t.ui.componentFactory.add("tableColumn",r=>{const o=[{type:"switchbutton",model:{commandName:"setTableColumnHeader",label:e("Header column"),bindIsOn:!0}},{type:"separator"},{type:"button",model:{commandName:n?"insertTableColumnLeft":"insertTableColumnRight",label:e("Insert column left")}},{type:"button",model:{commandName:n?"insertTableColumnRight":"insertTableColumnLeft",label:e("Insert column right")}},{type:"button",model:{commandName:"removeTableColumn",label:e("Delete column")}},{type:"button",model:{commandName:"selectTableColumn",label:e("Select column")}}];return this._prepareDropdown(e("Column"),Bz,o,r)}),t.ui.componentFactory.add("tableRow",r=>{const o=[{type:"switchbutton",model:{commandName:"setTableRowHeader",label:e("Header row"),bindIsOn:!0}},{type:"separator"},{type:"button",model:{commandName:"insertTableRowAbove",label:e("Insert row above")}},{type:"button",model:{commandName:"insertTableRowBelow",label:e("Insert row below")}},{type:"button",model:{commandName:"removeTableRow",label:e("Delete row")}},{type:"button",model:{commandName:"selectTableRow",label:e("Select row")}}];return this._prepareDropdown(e("Row"),Qz,o,r)}),t.ui.componentFactory.add("mergeTableCells",r=>{const o=[{type:"button",model:{commandName:"mergeTableCellUp",label:e("Merge cell up")}},{type:"button",model:{commandName:n?"mergeTableCellRight":"mergeTableCellLeft",label:e("Merge cell right")}},{type:"button",model:{commandName:"mergeTableCellDown",label:e("Merge cell down")}},{type:"button",model:{commandName:n?"mergeTableCellLeft":"mergeTableCellRight",label:e("Merge cell left")}},{type:"separator"},{type:"button",model:{commandName:"splitTableCellVertically",label:e("Split cell vertically")}},{type:"button",model:{commandName:"splitTableCellHorizontally",label:e("Split cell horizontally")}}];return this._prepareMergeSplitButtonDropdown(e("Merge cells"),$z,o,r)})}_prepareDropdown(t,e,i,n){const r=this.editor,o=nn(n),l=this._fillDropdownWithListOptions(o,i);return o.buttonView.set({label:t,icon:e,tooltip:!0}),o.bind("isEnabled").toMany(l,"isEnabled",(...a)=>a.some(c=>c)),this.listenTo(o,"execute",a=>{r.execute(a.source.commandName),a.source instanceof dd||r.editing.view.focus()}),o}_prepareMergeSplitButtonDropdown(t,e,i,n){const r=this.editor,o=nn(n,Vc),l="mergeTableCells",a=r.commands.get(l),c=this._fillDropdownWithListOptions(o,i);return o.buttonView.set({label:t,icon:e,tooltip:!0,isEnabled:!0}),o.bind("isEnabled").toMany([a,...c],"isEnabled",(...h)=>h.some(f=>f)),this.listenTo(o.buttonView,"execute",()=>{r.execute(l),r.editing.view.focus()}),this.listenTo(o,"execute",h=>{r.execute(h.source.commandName),r.editing.view.focus()}),o}_fillDropdownWithListOptions(t,e){const i=this.editor,n=[],r=new di;for(const o of e)vee(o,i,n,r);return Zl(t,r),n}}function vee(s,t,e,i){if(s.type==="button"||s.type==="switchbutton"){const n=s.model=new El(s.model),{commandName:r,bindIsOn:o}=s.model,l=t.commands.get(r);e.push(l),n.set({commandName:r}),n.bind("isEnabled").to(l),o&&n.bind("isOn").to(l,"value"),n.set({withText:!0})}i.add(s)}class To extends F{static get pluginName(){return"TableSelection"}static get isOfficialPlugin(){return!0}static get requires(){return[Oi,Oi]}init(){const t=this.editor,e=t.model,i=t.editing.view;this.listenTo(e,"deleteContent",(n,r)=>this._handleDeleteContent(n,r),{priority:"high"}),this.listenTo(i.document,"insertText",(n,r)=>this._handleInsertTextEvent(n,r),{priority:"high"}),this._defineSelectionConverter(),this._enablePluginDisabling()}getSelectedTableCells(){const t=this.editor.plugins.get(Oi),e=this.editor.model.document.selection,i=t.getSelectedTableCells(e);return i.length==0?null:i}getSelectionAsFragment(){const t=this.editor.plugins.get(Oi),e=this.getSelectedTableCells();return e?this.editor.model.change(i=>{const n=i.createDocumentFragment(),{first:r,last:o}=t.getColumnIndexes(e),{first:l,last:a}=t.getRowIndexes(e),c=e[0].findAncestor("table");let h=a,f=o;if(t.isSelectionRectangular(e)){const O={firstColumn:r,lastColumn:o,firstRow:l,lastRow:a};h=g4(c,O),f=p4(c,O)}const w=c4(c,{startRow:l,startColumn:r,endRow:h,endColumn:f},i);return i.insert(w,n,0),n}):null}setCellSelection(t,e){const i=this._getCellsToSelect(t,e);this.editor.model.change(n=>{n.setSelection(i.cells.map(r=>n.createRangeOn(r)),{backward:i.backward})})}getFocusCell(){const i=[...this.editor.model.document.selection.getRanges()].pop().getContainedElement();return i&&i.is("element","tableCell")?i:null}getAnchorCell(){const t=this.editor.model.document.selection,i=$t(t.getRanges()).getContainedElement();return i&&i.is("element","tableCell")?i:null}_defineSelectionConverter(){const t=this.editor,e=new Set;t.conversion.for("editingDowncast").add(n=>n.on("selection",(r,o,l)=>{const a=l.writer;i(a);const c=this.getSelectedTableCells();if(!c)return;for(const f of c){const m=l.mapper.toViewElement(f);a.addClass("ck-editor__editable_selected",m),e.add(m)}const h=l.mapper.toViewElement(c[c.length-1]);a.setSelection(h,0)},{priority:"lowest"}));function i(n){for(const r of e)n.removeClass("ck-editor__editable_selected",r);e.clear()}}_enablePluginDisabling(){const t=this.editor;this.on("change:isEnabled",()=>{if(!this.isEnabled){const e=this.getSelectedTableCells();if(!e)return;t.model.change(i=>{const n=i.createPositionAt(e[0],0),r=t.model.schema.getNearestSelectionRange(n);i.setSelection(r)})}})}_handleDeleteContent(t,e){const i=this.editor.plugins.get(Oi),n=e[0],r=e[1],o=this.editor.model,l=!r||r.direction=="backward",a=i.getSelectedTableCells(n);a.length&&(t.stop(),o.change(c=>{const h=a[l?a.length-1:0];o.change(m=>{for(const w of a)o.deleteContent(m.createSelection(w,"in"))});const f=o.schema.getNearestSelectionRange(c.createPositionAt(h,0));n.is("documentSelection")?c.setSelection(f):n.setTo(f)}))}_handleInsertTextEvent(t,e){const i=this.editor,n=this.getSelectedTableCells();if(!n)return;const r=i.editing.view,o=i.editing.mapper,l=n.map(a=>r.createRangeOn(o.toViewElement(a)));e.selection=r.createSelection(l),e.preventDefault()}_getCellsToSelect(t,e){const i=this.editor.plugins.get("TableUtils"),n=i.getCellLocation(t),r=i.getCellLocation(e),o=Math.min(n.row,r.row),l=Math.max(n.row,r.row),a=Math.min(n.column,r.column),c=parseInt(e.getAttribute("colspan")||"1")-1,h=Math.max(n.column,r.column+c),f=new Array(l-o+1).fill(null).map(()=>[]),m={startRow:o,endRow:l,startColumn:a,endColumn:h};for(const{row:_,cell:k}of new mt(t.findAncestor("table"),m))f[_-o].push(k);const w=r.row<n.row,O=r.column<n.column;return w&&f.reverse(),O&&f.forEach(_=>_.reverse()),{cells:f.flat(),backward:w||O}}}class _ee extends F{static get pluginName(){return"TableClipboard"}static get isOfficialPlugin(){return!0}static get requires(){return[kl,on,To,Oi]}init(){const e=this.editor.editing.view.document;this.listenTo(e,"copy",(i,n)=>this._onCopyCut(i,n)),this.listenTo(e,"cut",(i,n)=>this._onCopyCut(i,n)),this._listenToContentInsertion(),this.decorate("_replaceTableSlotCell")}_listenToContentInsertion(){const{editor:t}=this,e=t.plugins.get(on),i=t.plugins.get(To);let n=!1;e.on("contentInsertion",(r,o)=>{n=o.method==="paste"}),this.listenTo(t.model,"insertContent",(r,[o,l])=>{(n||i.getSelectedTableCells()!==null)&&this._onInsertContent(r,o,l)},{priority:"high"}),e.on("contentInsertion",()=>{n=!1},{priority:"lowest"})}_onCopyCut(t,e){const i=this.editor.editing.view,n=this.editor.plugins.get(To),r=this.editor.plugins.get(kl);n.getSelectedTableCells()&&(t.name=="cut"&&!this.editor.model.canEditAt(this.editor.model.document.selection)||(e.preventDefault(),t.stop(),this.editor.model.enqueueChange({isUndoable:t.name==="cut"},()=>{const o=r._copySelectedFragmentWithMarkers(t.name,this.editor.model.document.selection,()=>n.getSelectionAsFragment());i.document.fire("clipboardOutput",{dataTransfer:e.dataTransfer,content:this.editor.data.toView(o),method:t.name})})))}_onInsertContent(t,e,i){if(i&&!i.is("documentSelection"))return;const n=this.editor.model,r=this.editor.plugins.get(Oi),o=this.editor.plugins.get(kl),l=this.getTableIfOnlyTableInContent(e,n);if(!l)return;const a=r.getSelectionAffectedTableCells(n.document.selection);if(!a.length){Vy(l,r);return}t.stop(),e.is("documentFragment")?o._pasteMarkersIntoTransformedElement(e.markers,c=>this._replaceSelectedCells(l,a,c)):this.editor.model.change(c=>{this._replaceSelectedCells(l,a,c)})}_replaceSelectedCells(t,e,i){const n=this.editor.plugins.get(Oi),r={width:n.getColumns(t),height:n.getRows(t)},o=kee(e,r,i,n),l=o.lastRow-o.firstRow+1,a=o.lastColumn-o.firstColumn+1,c={startRow:0,startColumn:0,endRow:Math.min(l,r.height)-1,endColumn:Math.min(a,r.width)-1};t=c4(t,c,i);const h=e[0].findAncestor("table"),f=this._replaceSelectedCellsWithPasted(t,r,h,o,i);if(this.editor.plugins.get("TableSelection").isEnabled){const m=n.sortRanges(f.map(w=>i.createRangeOn(w)));i.setSelection(m)}else i.setSelection(f[0],0);return h}_replaceSelectedCellsWithPasted(t,e,i,n,r){const{width:o,height:l}=e,a=Cee(t,o,l),c=[...new mt(i,{startRow:n.firstRow,endRow:n.lastRow,startColumn:n.firstColumn,endColumn:n.lastColumn,includeAllSlots:!0})],h=[];let f;for(const k of c){const{row:C,column:P}=k;P===n.firstColumn&&(f=k.getPositionBefore());const M=C-n.firstRow,Q=P-n.firstColumn,N=a[M%l][Q%o],G=N?r.cloneElement(N):null,D=this._replaceTableSlotCell(k,G,f,r);D&&(m4(D,C,P,n.lastRow,n.lastColumn,r),h.push(D),f=r.createPositionAfter(D))}const m=parseInt(i.getAttribute("headingRows")||"0"),w=parseInt(i.getAttribute("headingColumns")||"0"),O=n.firstRow<m&&m<=n.lastRow,_=n.firstColumn<w&&w<=n.lastColumn;if(O){const k={first:n.firstColumn,last:n.lastColumn},C=g1(i,m,k,r,n.firstRow);h.push(...C)}if(_){const k={first:n.firstRow,last:n.lastRow},C=p1(i,w,k,r);h.push(...C)}return h}_replaceTableSlotCell(t,e,i,n){const{cell:r,isAnchor:o}=t;return o&&n.remove(r),e?(n.insert(e,i),e):null}getTableIfOnlyTableInContent(t,e){if(!t.is("documentFragment")&&!t.is("element"))return null;if(t.is("element","table"))return t;if(t.childCount==1&&t.getChild(0).is("element","table"))return t.getChild(0);const i=e.createRangeIn(t);for(const n of i.getItems())if(n.is("element","table")){const r=e.createRange(i.start,e.createPositionBefore(n));if(e.hasContent(r,{ignoreWhitespaces:!0}))return null;const o=e.createRange(e.createPositionAfter(n),i.end);return e.hasContent(o,{ignoreWhitespaces:!0})?null:n}return null}}function kee(s,t,e,i){const n=s[0].findAncestor("table"),r=i.getColumnIndexes(s),o=i.getRowIndexes(s),l={firstColumn:r.first,lastColumn:r.last,firstRow:o.first,lastRow:o.last},a=s.length===1;return a&&(l.lastRow+=t.height-1,l.lastColumn+=t.width-1,See(n,l.lastRow+1,l.lastColumn+1,i)),a||!i.isSelectionRectangular(s)?Pee(n,l,e):(l.lastRow=g4(n,l),l.lastColumn=p4(n,l)),l}function See(s,t,e,i){const n=i.getColumns(s),r=i.getRows(s);e>n&&i.insertColumns(s,{at:n,columns:e-n}),t>r&&i.insertRows(s,{at:r,rows:t-r})}function Cee(s,t,e){const i=new Array(e).fill(null).map(()=>new Array(t).fill(null));for(const{column:n,row:r,cell:o}of new mt(s))i[r][n]=o;return i}function Pee(s,t,e){const{firstRow:i,lastRow:n,firstColumn:r,lastColumn:o}=t,l={first:i,last:n},a={first:r,last:o};p1(s,r,l,e),p1(s,o+1,l,e),g1(s,i,a,e),g1(s,n+1,a,e,i)}function g1(s,t,e,i,n=0){return t<1?void 0:u4(s,t,n).filter(({column:l,cellWidth:a})=>O4(l,a,e)).map(({cell:l})=>h4(l,t,i))}function p1(s,t,e,i){return t<1?void 0:d4(s,t).filter(({row:o,cellHeight:l})=>O4(o,l,e)).map(({cell:o,column:l})=>f4(o,l,t,i))}function O4(s,t,e){const i=s+t-1,{first:n,last:r}=e,o=s>=n&&s<=r,l=s<n&&i>=n;return o||l}class Tee extends F{static get pluginName(){return"TableKeyboard"}static get isOfficialPlugin(){return!0}static get requires(){return[To,Oi]}init(){const t=this.editor,i=t.editing.view.document,n=t.t;this.listenTo(i,"arrowKey",(...r)=>this._onArrowKey(...r),{context:"table"}),this.listenTo(i,"tab",(...r)=>this._handleTabOnSelectedTable(...r),{context:"figure"}),this.listenTo(i,"tab",(...r)=>this._handleTab(...r),{context:["th","td"]}),t.accessibility.addKeystrokeInfoGroup({id:"table",label:n("Keystrokes that can be used in a table cell"),keystrokes:[{label:n("Move the selection to the next cell"),keystroke:"Tab"},{label:n("Move the selection to the previous cell"),keystroke:"Shift+Tab"},{label:n("Insert a new table row (when in the last cell of a table)"),keystroke:"Tab"},{label:n("Navigate through the table"),keystroke:[["arrowup"],["arrowright"],["arrowdown"],["arrowleft"]]}]})}_handleTabOnSelectedTable(t,e){const i=this.editor,r=i.model.document.selection.getSelectedElement();!r||!r.is("element","table")||(e.preventDefault(),e.stopPropagation(),t.stop(),i.model.change(o=>{o.setSelection(o.createRangeIn(r.getChild(0).getChild(0)))}))}_handleTab(t,e){const i=this.editor,n=this.editor.plugins.get(Oi),r=this.editor.plugins.get("TableSelection"),o=i.model.document.selection,l=!e.shiftKey;let a=n.getTableCellsContainingSelection(o)[0];if(a||(a=r.getFocusCell()),!a)return;e.preventDefault(),e.stopPropagation(),t.stop();const c=a.parent,h=c.parent,f=h.getChildIndex(c),m=c.getChildIndex(a),w=m===0;if(!l&&w&&f===0){i.model.change(C=>{C.setSelection(C.createRangeOn(h))});return}const O=m===c.childCount-1,_=f===n.getRows(h)-1;if(l&&_&&O&&(i.execute("insertTableRowBelow"),f===n.getRows(h)-1)){i.model.change(C=>{C.setSelection(C.createRangeOn(h))});return}let k;if(l&&O)k=h.getChild(f+1).getChild(0);else if(!l&&w){const C=h.getChild(f-1);k=C.getChild(C.childCount-1)}else k=c.getChild(m+(l?1:-1));i.model.change(C=>{C.setSelection(C.createRangeIn(k))})}_onArrowKey(t,e){const i=this.editor,n=e.keyCode,r=$O(n,i.locale.contentLanguageDirection);this._handleArrowKeys(r,e.shiftKey)&&(e.preventDefault(),e.stopPropagation(),t.stop())}_handleArrowKeys(t,e){const i=this.editor.plugins.get(Oi),n=this.editor.plugins.get("TableSelection"),r=this.editor.model,o=r.document.selection,l=["right","down"].includes(t),a=i.getSelectedTableCells(o);if(a.length){let h;return e?h=n.getFocusCell():h=l?a[a.length-1]:a[0],this._navigateFromCellInDirection(h,t,e),!0}const c=o.focus.findAncestor("tableCell");/* istanbul ignore if: paranoid check -- @preserve */if(!c)return!1;if(!o.isCollapsed)if(e){if(o.isBackward==l&&!o.containsEntireContent(c))return!1}else{const h=o.getSelectedElement();if(!h||!r.schema.isObject(h))return!1}return this._isSelectionAtCellEdge(o,c,l)?(this._navigateFromCellInDirection(c,t,e),!0):!1}_isSelectionAtCellEdge(t,e,i){const n=this.editor.model,r=this.editor.model.schema,o=i?t.getLastPosition():t.getFirstPosition();if(!r.getLimitElement(o).is("element","tableCell"))return n.createPositionAt(e,i?"end":0).isTouching(o);const l=n.createSelection(o);return n.modifySelection(l,{direction:i?"forward":"backward"}),o.isEqual(l.focus)}_navigateFromCellInDirection(t,e,i=!1){const n=this.editor.model,r=t.findAncestor("table"),o=[...new mt(r,{includeAllSlots:!0})],{row:l,column:a}=o[o.length-1],c=o.find(({cell:P})=>P==t);let{row:h,column:f}=c;switch(e){case"left":f--;break;case"up":h--;break;case"right":f+=c.cellWidth;break;case"down":h+=c.cellHeight;break}const m=h<0||h>l,w=f<0&&h<=0,O=f>a&&h>=l;if(m||w||O){n.change(P=>{P.setSelection(P.createRangeOn(r))});return}f<0?(f=i?0:a,h--):f>a&&(f=i?a:0,h++);const _=o.find(P=>P.row==h&&P.column==f).cell,k=["right","down"].includes(e),C=this.editor.plugins.get("TableSelection");if(i&&C.isEnabled){const P=C.getAnchorCell()||t;C.setCellSelection(P,_)}else{const P=n.createPositionAt(_,k?0:"end");n.change(M=>{M.setSelection(P)})}}}class y4 extends Nr{constructor(){super(...arguments);p(this,"domEventType",["mousemove","mouseleave"])}onDomEvent(e){this.fire(e.type,e)}}class Eee extends F{static get pluginName(){return"TableMouse"}static get isOfficialPlugin(){return!0}static get requires(){return[To,Oi]}init(){this.editor.editing.view.addObserver(y4),this._enableShiftClickSelection(),this._enableMouseDragSelection()}_enableShiftClickSelection(){const t=this.editor,e=t.plugins.get(Oi);let i=!1;const n=t.plugins.get(To);this.listenTo(t.editing.view.document,"mousedown",(r,o)=>{const l=t.model.document.selection;if(!this.isEnabled||!n.isEnabled||!o.domEvent.shiftKey)return;const a=n.getAnchorCell()||e.getTableCellsContainingSelection(l)[0];if(!a)return;const c=this._getModelTableCellFromDomEvent(o);c&&aP(a,c)&&(i=!0,n.setCellSelection(a,c),o.preventDefault())}),this.listenTo(t.editing.view.document,"mouseup",()=>{i=!1}),this.listenTo(t.editing.view.document,"selectionChange",r=>{i&&r.stop()},{priority:"highest"})}_enableMouseDragSelection(){const t=this.editor;let e,i,n=!1,r=!1;const o=t.plugins.get(To);this.listenTo(t.editing.view.document,"mousedown",(l,a)=>{!this.isEnabled||!o.isEnabled||a.domEvent.shiftKey||a.domEvent.ctrlKey||a.domEvent.altKey||(e=this._getModelTableCellFromDomEvent(a))}),this.listenTo(t.editing.view.document,"mousemove",(l,a)=>{if(!a.domEvent.buttons||!e)return;const c=this._getModelTableCellFromDomEvent(a);c&&aP(e,c)&&(i=c,!n&&i!=e&&(n=!0)),n&&(r=!0,o.setCellSelection(e,i),a.preventDefault())}),this.listenTo(t.editing.view.document,"mouseup",()=>{n=!1,r=!1,e=null,i=null}),this.listenTo(t.editing.view.document,"selectionChange",l=>{r&&l.stop()},{priority:"highest"})}_getModelTableCellFromDomEvent(t){const e=t.target,i=this.editor.editing.view.createPositionAt(e,0);return this.editor.editing.mapper.toModelPosition(i).parent.findAncestor("tableCell",{includeSelf:!0})}}function aP(s,t){return s.parent.parent==t.parent.parent}let Aee=class extends F{static get requires(){return[bd,yee,To,Eee,Tee,_ee,Lc]}static get pluginName(){return"Table"}static get isOfficialPlugin(){return!0}};function Dg(s){const t=v4(s);return t||Bp(s)}function v4(s){const t=s.getSelectedElement();return t&&_4(t)?t:null}function Bp(s){const t=s.getFirstPosition();if(!t)return null;let e=t.parent;for(;e;){if(e.is("element")&&_4(e))return e;e=e.parent}return null}function _4(s){return!!s.getCustomProperty("table")&&Ut(s)}class Iee extends F{static get requires(){return[Eg]}static get pluginName(){return"TableToolbar"}static get isOfficialPlugin(){return!0}afterInit(){const t=this.editor,e=t.t,i=t.plugins.get(Eg),n=t.config.get("table.contentToolbar"),r=t.config.get("table.tableToolbar");n&&i.register("tableContent",{ariaLabel:e("Table toolbar"),items:n,getRelatedElement:Bp}),r&&i.register("table",{ariaLabel:e("Table toolbar"),items:r,getRelatedElement:v4})}}class Ree extends ue{constructor(e,i){super(e);p(this,"options");p(this,"focusTracker");p(this,"focusCycler");p(this,"_focusables");p(this,"dropdownView");p(this,"inputView");p(this,"keystrokes");p(this,"_stillTyping");this.set("value",""),this.set("isReadOnly",!1),this.set("isFocused",!1),this.set("isEmpty",!0),this.options=i,this.focusTracker=new ot,this._focusables=new fi,this.dropdownView=this._createDropdownView(),this.inputView=this._createInputTextView(),this.keystrokes=new wt,this._stillTyping=!1,this.focusCycler=new Ht({focusables:this._focusables,focusTracker:this.focusTracker,keystrokeHandler:this.keystrokes,actions:{focusPrevious:"shift + tab",focusNext:"tab"}}),this.setTemplate({tag:"div",attributes:{class:["ck","ck-input-color"]},children:[this.dropdownView,this.inputView]}),this.on("change:value",(n,r,o)=>this._setInputValue(o))}render(){super.render(),[this.inputView,this.dropdownView.buttonView].forEach(e=>{this.focusTracker.add(e.element),this._focusables.add(e)}),this.keystrokes.listenTo(this.element)}focus(e){e===-1?this.focusCycler.focusLast():this.focusCycler.focusFirst()}destroy(){super.destroy(),this.focusTracker.destroy(),this.keystrokes.destroy()}_createDropdownView(){const e=this.locale,i=e.t,n=this.bindTemplate,r=this._createColorSelector(e),o=nn(e),l=new ue;return l.setTemplate({tag:"span",attributes:{class:["ck","ck-input-color__button__preview"],style:{backgroundColor:n.to("value")}},children:[{tag:"span",attributes:{class:["ck","ck-input-color__button__preview__no-color-indicator",n.if("value","ck-hidden",a=>a!="")]}}]}),o.buttonView.extendTemplate({attributes:{class:"ck-input-color__button"}}),o.buttonView.children.add(l),o.buttonView.label=i("Color picker"),o.buttonView.tooltip=!0,o.panelPosition=e.uiLanguageDirection==="rtl"?"se":"sw",o.panelView.children.add(r),o.bind("isEnabled").to(this,"isReadOnly",a=>!a),o.on("change:isOpen",(a,c,h)=>{h&&(r.updateSelectedColors(),r.showColorGridsFragment())}),o}_createInputTextView(){const e=this.locale,i=new vI(e);return i.extendTemplate({on:{blur:i.bindTemplate.to("blur")}}),i.value=this.value,i.bind("isReadOnly","hasError").to(this),this.bind("isFocused","isEmpty").to(i),i.on("input",()=>{const n=i.element.value,r=this.options.colorDefinitions.find(o=>n===o.label);this._stillTyping=!0,this.value=r&&r.color||n}),i.on("blur",()=>{this._stillTyping=!1,this._setInputValue(i.element.value)}),i.delegate("input").to(this),i}_createColorSelector(e){const i=e.t,n=this.options.defaultColorValue||"",r=i(n?"Restore default":"Remove color"),o=new fU(e,{colors:this.options.colorDefinitions,columns:this.options.columns,removeButtonLabel:r,colorPickerLabel:i("Color picker"),colorPickerViewConfig:this.options.colorPickerConfig===!1?!1:{...this.options.colorPickerConfig,hideInput:!0}});o.appendUI(),o.on("execute",(a,c)=>{if(c.source==="colorPickerSaveButton"){this.dropdownView.isOpen=!1;return}this.value=c.value||n,this.fire("input"),c.source!=="colorPicker"&&(this.dropdownView.isOpen=!1)});let l=this.value;return o.on("colorPicker:cancel",()=>{this.value=l,this.fire("input"),this.dropdownView.isOpen=!1}),o.colorGridsFragmentView.colorPickerButtonView.on("execute",()=>{l=this.value}),o.bind("selectedColor").to(this,"value"),o}_setInputValue(e){if(!this._stillTyping){const i=cP(e),n=this.options.colorDefinitions.find(r=>i===cP(r.color));n?this.inputView.value=n.label:this.inputView.value=e||""}}}function cP(s){return s.replace(/([(,])\s+/g,"$1").replace(/^\s+|\s+(?=[),\s]|$)/g,"").replace(/,|\s/g," ")}const Ly=s=>s==="";function By(s){return{none:s("None"),solid:s("Solid"),dotted:s("Dotted"),dashed:s("Dashed"),double:s("Double"),groove:s("Groove"),ridge:s("Ridge"),inset:s("Inset"),outset:s("Outset")}}function k4(s){return s('The color is invalid. Try "#FF0000" or "rgb(255,0,0)" or "red".')}function S4(s){return s('The value is invalid. Try "10px" or "2em" or simply "2".')}function Qg(s){return s=s.trim().toLowerCase(),Ly(s)||NA(s)}function gh(s){return s=s.trim(),Ly(s)||T4(s)||KO(s)||rF(s)}function C4(s){return s=s.trim(),Ly(s)||T4(s)||KO(s)}function P4(s,t){const e=new di,i=By(s.t);for(const n in i){const r={type:"button",model:new El({_borderStyleValue:n,label:i[n],role:"menuitemradio",withText:!0})};n==="none"?r.model.bind("isOn").to(s,"borderStyle",o=>t==="none"?!o:o===n):r.model.bind("isOn").to(s,"borderStyle",o=>o===n),e.add(r)}return e}function w1(s){const{view:t,icons:e,toolbar:i,labels:n,propertyName:r,nameToValue:o,defaultValue:l}=s;for(const a in n){const c=new ye(t.locale);c.set({role:"radio",isToggleable:!0,label:n[a],icon:e[a],tooltip:n[a]});const h=o?o(a):a;c.bind("isOn").to(t,r,f=>{let m=f;return f===""&&l&&(m=l),h===m}),c.on("execute",()=>{!l&&h&&t[r]===h?t[r]=void 0:t[r]=h}),i.items.add(c)}}const Ng=[{color:"hsl(0, 0%, 0%)",label:"Black"},{color:"hsl(0, 0%, 30%)",label:"Dim grey"},{color:"hsl(0, 0%, 60%)",label:"Grey"},{color:"hsl(0, 0%, 90%)",label:"Light grey"},{color:"hsl(0, 0%, 100%)",label:"White",hasBorder:!0},{color:"hsl(0, 75%, 60%)",label:"Red"},{color:"hsl(30, 75%, 60%)",label:"Orange"},{color:"hsl(60, 75%, 60%)",label:"Yellow"},{color:"hsl(90, 75%, 60%)",label:"Light green"},{color:"hsl(120, 75%, 60%)",label:"Green"},{color:"hsl(150, 75%, 60%)",label:"Aquamarine"},{color:"hsl(180, 75%, 60%)",label:"Turquoise"},{color:"hsl(210, 75%, 60%)",label:"Light blue"},{color:"hsl(240, 75%, 60%)",label:"Blue"},{color:"hsl(270, 75%, 60%)",label:"Purple"}];function Fg(s){return(t,e,i)=>{const n=new Ree(t.locale,{colorDefinitions:Vee(s.colorConfig),columns:s.columns,defaultColorValue:s.defaultColorValue,colorPickerConfig:s.colorPickerConfig});return n.inputView.set({id:e,ariaDescribedById:i}),n.bind("isReadOnly").to(t,"isEnabled",r=>!r),n.bind("hasError").to(t,"errorText",r=>!!r),n.on("input",()=>{t.errorText=null}),t.bind("isEmpty","isFocused").to(n),n}}function T4(s){const t=parseFloat(s);return!Number.isNaN(t)&&s===String(t)}function Vee(s){return s.map(t=>({color:t.model,label:t.label,options:{hasBorder:t.hasBorder}}))}class Mee extends ue{constructor(e,i){super(e);p(this,"options");p(this,"focusTracker");p(this,"keystrokes");p(this,"children");p(this,"borderStyleDropdown");p(this,"borderWidthInput");p(this,"borderColorInput");p(this,"backgroundInput");p(this,"paddingInput");p(this,"widthInput");p(this,"heightInput");p(this,"horizontalAlignmentToolbar");p(this,"verticalAlignmentToolbar");p(this,"saveButtonView");p(this,"cancelButtonView");p(this,"_focusables");p(this,"_focusCycler");this.set({borderStyle:"",borderWidth:"",borderColor:"",padding:"",backgroundColor:"",width:"",height:"",horizontalAlignment:"",verticalAlignment:""}),this.options=i;const{borderStyleDropdown:n,borderWidthInput:r,borderColorInput:o,borderRowLabel:l}=this._createBorderFields(),{backgroundRowLabel:a,backgroundInput:c}=this._createBackgroundFields(),{widthInput:h,operatorLabel:f,heightInput:m,dimensionsLabel:w}=this._createDimensionFields(),{horizontalAlignmentToolbar:O,verticalAlignmentToolbar:_,alignmentLabel:k}=this._createAlignmentFields();this.focusTracker=new ot,this.keystrokes=new wt,this.children=this.createCollection(),this.borderStyleDropdown=n,this.borderWidthInput=r,this.borderColorInput=o,this.backgroundInput=c,this.paddingInput=this._createPaddingField(),this.widthInput=h,this.heightInput=m,this.horizontalAlignmentToolbar=O,this.verticalAlignmentToolbar=_;const{saveButtonView:C,cancelButtonView:P}=this._createActionButtons();this.saveButtonView=C,this.cancelButtonView=P,this._focusables=new fi,this._focusCycler=new Ht({focusables:this._focusables,focusTracker:this.focusTracker,keystrokeHandler:this.keystrokes,actions:{focusPrevious:"shift + tab",focusNext:"tab"}}),this.children.add(new zr(e,{label:this.t("Cell properties")})),this.children.add(new Ei(e,{labelView:l,children:[l,n,o,r],class:"ck-table-form__border-row"})),this.children.add(new Ei(e,{labelView:a,children:[a,c],class:"ck-table-form__background-row"})),this.children.add(new Ei(e,{children:[new Ei(e,{labelView:w,children:[w,h,f,m],class:"ck-table-form__dimensions-row"}),new Ei(e,{children:[this.paddingInput],class:"ck-table-cell-properties-form__padding-row"})]})),this.children.add(new Ei(e,{labelView:k,children:[k,O,_],class:"ck-table-cell-properties-form__alignment-row"})),this.children.add(new Ei(e,{children:[this.saveButtonView,this.cancelButtonView],class:"ck-table-form__action-row"})),this.setTemplate({tag:"form",attributes:{class:["ck","ck-form","ck-table-form","ck-table-cell-properties-form"],tabindex:"-1"},children:this.children})}render(){super.render(),Wl({view:this}),[this.borderColorInput,this.backgroundInput].forEach(e=>{this._focusCycler.chain(e.fieldView.focusCycler)}),[this.borderStyleDropdown,this.borderColorInput,this.borderWidthInput,this.backgroundInput,this.widthInput,this.heightInput,this.paddingInput,this.horizontalAlignmentToolbar,this.verticalAlignmentToolbar,this.saveButtonView,this.cancelButtonView].forEach(e=>{this._focusables.add(e),this.focusTracker.add(e.element)}),this.keystrokes.listenTo(this.element)}destroy(){super.destroy(),this.focusTracker.destroy(),this.keystrokes.destroy()}focus(){this._focusCycler.focusFirst()}_createBorderFields(){const e=this.options.defaultTableCellProperties,i={style:e.borderStyle,width:e.borderWidth,color:e.borderColor},n=Fg({colorConfig:this.options.borderColors,columns:5,defaultColorValue:i.color,colorPickerConfig:this.options.colorPickerConfig}),r=this.locale,o=this.t,l=o("Style"),a=new ns(r);a.text=o("Border");const c=By(o),h=new Yt(r,RI);h.set({label:l,class:"ck-table-form__border-style"}),h.fieldView.buttonView.set({ariaLabel:l,ariaLabelledBy:void 0,isOn:!1,withText:!0,tooltip:l}),h.fieldView.buttonView.bind("label").to(this,"borderStyle",w=>c[w||"none"]),h.fieldView.on("execute",w=>{this.borderStyle=w.source._borderStyleValue}),h.bind("isEmpty").to(this,"borderStyle",w=>!w),Zl(h.fieldView,P4(this,i.style),{role:"menu",ariaLabel:l});const f=new Yt(r,On);f.set({label:o("Width"),class:"ck-table-form__border-width"}),f.fieldView.bind("value").to(this,"borderWidth"),f.bind("isEnabled").to(this,"borderStyle",lm),f.fieldView.on("input",()=>{this.borderWidth=f.fieldView.element.value});const m=new Yt(r,n);return m.set({label:o("Color"),class:"ck-table-form__border-color"}),m.fieldView.bind("value").to(this,"borderColor"),m.bind("isEnabled").to(this,"borderStyle",lm),m.fieldView.on("input",()=>{this.borderColor=m.fieldView.value}),this.on("change:borderStyle",(w,O,_,k)=>{lm(_)||(this.borderColor="",this.borderWidth=""),lm(k)||(this.borderColor=i.color,this.borderWidth=i.width)}),{borderRowLabel:a,borderStyleDropdown:h,borderColorInput:m,borderWidthInput:f}}_createBackgroundFields(){const e=this.locale,i=this.t,n=new ns(e);n.text=i("Background");const r=Fg({colorConfig:this.options.backgroundColors,columns:5,defaultColorValue:this.options.defaultTableCellProperties.backgroundColor,colorPickerConfig:this.options.colorPickerConfig}),o=new Yt(e,r);return o.set({label:i("Color"),class:"ck-table-cell-properties-form__background"}),o.fieldView.bind("value").to(this,"backgroundColor"),o.fieldView.on("input",()=>{this.backgroundColor=o.fieldView.value}),{backgroundRowLabel:n,backgroundInput:o}}_createDimensionFields(){const e=this.locale,i=this.t,n=new ns(e);n.text=i("Dimensions");const r=new Yt(e,On);r.set({label:i("Width"),class:"ck-table-form__dimensions-row__width"}),r.fieldView.bind("value").to(this,"width"),r.fieldView.on("input",()=>{this.width=r.fieldView.element.value});const o=new ue(e);o.setTemplate({tag:"span",attributes:{class:["ck-table-form__dimension-operator"]},children:[{text:"×"}]});const l=new Yt(e,On);return l.set({label:i("Height"),class:"ck-table-form__dimensions-row__height"}),l.fieldView.bind("value").to(this,"height"),l.fieldView.on("input",()=>{this.height=l.fieldView.element.value}),{dimensionsLabel:n,widthInput:r,operatorLabel:o,heightInput:l}}_createPaddingField(){const e=this.locale,i=this.t,n=new Yt(e,On);return n.set({label:i("Padding"),class:"ck-table-cell-properties-form__padding"}),n.fieldView.bind("value").to(this,"padding"),n.fieldView.on("input",()=>{this.padding=n.fieldView.element.value}),n}_createAlignmentFields(){const e=this.locale,i=this.t,n=new ns(e),r={left:jA,center:WF,right:HF,justify:UF,top:qF,middle:ZF,bottom:zF};n.text=i("Table cell text alignment");const o=new Vo(e),l=e.contentLanguageDirection==="rtl";o.set({isCompact:!0,role:"radiogroup",ariaLabel:i("Horizontal text alignment toolbar")}),w1({view:this,icons:r,toolbar:o,labels:this._horizontalAlignmentLabels,propertyName:"horizontalAlignment",nameToValue:c=>{if(l){if(c==="left")return"right";if(c==="right")return"left"}return c},defaultValue:this.options.defaultTableCellProperties.horizontalAlignment});const a=new Vo(e);return a.set({isCompact:!0,role:"radiogroup",ariaLabel:i("Vertical text alignment toolbar")}),w1({view:this,icons:r,toolbar:a,labels:this._verticalAlignmentLabels,propertyName:"verticalAlignment",defaultValue:this.options.defaultTableCellProperties.verticalAlignment}),{horizontalAlignmentToolbar:o,verticalAlignmentToolbar:a,alignmentLabel:n}}_createActionButtons(){const e=this.locale,i=this.t,n=new ye(e),r=new ye(e),o=[this.borderWidthInput,this.borderColorInput,this.backgroundInput,this.paddingInput];return n.set({label:i("Save"),icon:Ic,class:"ck-button-save",type:"submit",withText:!0}),n.bind("isEnabled").toMany(o,"errorText",(...l)=>l.every(a=>!a)),r.set({label:i("Cancel"),icon:Ac,class:"ck-button-cancel",withText:!0}),r.delegate("execute").to(this,"cancel"),{saveButtonView:n,cancelButtonView:r}}get _horizontalAlignmentLabels(){const e=this.locale,i=this.t,n=i("Align cell text to the left"),r=i("Align cell text to the center"),o=i("Align cell text to the right"),l=i("Justify cell text");return e.uiLanguageDirection==="rtl"?{right:o,center:r,left:n,justify:l}:{left:n,center:r,right:o,justify:l}}get _verticalAlignmentLabels(){const e=this.t;return{top:e("Align cell text to the top"),middle:e("Align cell text to the middle"),bottom:e("Align cell text to the bottom")}}}function lm(s){return s!=="none"}const x1=[Fi.defaultPositions.northArrowSouth,Fi.defaultPositions.northArrowSouthWest,Fi.defaultPositions.northArrowSouthEast,Fi.defaultPositions.southArrowNorth,Fi.defaultPositions.southArrowNorthWest,Fi.defaultPositions.southArrowNorthEast,Fi.defaultPositions.viewportStickyNorth];function E4(s,t){const e=s.plugins.get("ContextualBalloon"),i=s.editing.view.document.selection;let n;t==="cell"?Bp(i)&&(n=I4(s)):Dg(i)&&(n=A4(s)),n&&e.updatePosition(n)}function A4(s){const t=s.model.document.selection,e=Po(t),i=s.editing.mapper.toViewElement(e);return{target:s.editing.view.domConverter.mapViewToDom(i),positions:x1}}function I4(s){const t=s.editing.mapper,e=s.editing.view.domConverter,i=s.model.document.selection;if(i.rangeCount>1)return{target:()=>Lee(i.getRanges(),s),positions:x1};const n=R4(i.getFirstPosition()),r=t.toViewElement(n);return{target:e.mapViewToDom(r),positions:x1}}function R4(s){return s.nodeAfter&&s.nodeAfter.is("element","tableCell")?s.nodeAfter:s.findAncestor("tableCell")}function Lee(s,t){const e=t.editing.mapper,i=t.editing.view.domConverter,n=Array.from(s).map(r=>{const o=R4(r.start),l=e.toViewElement(o);return new Ve(i.mapViewToDom(l))});return Ve.getBoundingRect(n)}function Xl(s){if(!s||!ds(s))return s;const{top:t,right:e,bottom:i,left:n}=s;if(t==e&&e==i&&i==n)return t}function Gl(s,t){const e=parseFloat(s);return Number.isNaN(e)||String(e)!==String(s)?s:`${e}${t}`}function $p(s,t={}){const e={borderStyle:"none",borderWidth:"",borderColor:"",backgroundColor:"",width:"",height:"",...s};return t.includeAlignmentProperty&&!e.alignment&&(e.alignment="center"),t.includePaddingProperty&&!e.padding&&(e.padding=""),t.includeVerticalAlignmentProperty&&!e.verticalAlignment&&(e.verticalAlignment="middle"),t.includeHorizontalAlignmentProperty&&!e.horizontalAlignment&&(e.horizontalAlignment=t.isRightToLeftContent?"right":"left"),e}function V4(s,t){return $p({borderStyle:"double",borderColor:"hsl(0, 0%, 70%)",borderWidth:"1px",...s},t)}function $y(s,t){return $p({borderStyle:"solid",borderColor:"hsl(0, 0%, 75%)",borderWidth:"1px",...s},t)}const Bee=500,uP={borderStyle:"tableCellBorderStyle",borderColor:"tableCellBorderColor",borderWidth:"tableCellBorderWidth",height:"tableCellHeight",width:"tableCellWidth",padding:"tableCellPadding",backgroundColor:"tableCellBackgroundColor",horizontalAlignment:"tableCellHorizontalAlignment",verticalAlignment:"tableCellVerticalAlignment"};class $ee extends F{constructor(e){super(e);p(this,"_defaultContentTableCellProperties");p(this,"_defaultLayoutTableCellProperties");p(this,"_balloon");p(this,"view");p(this,"_viewWithContentTableDefaults");p(this,"_viewWithLayoutTableDefaults");p(this,"_undoStepBatch");p(this,"_isReady");e.config.define("table.tableCellProperties",{borderColors:Ng,backgroundColors:Ng})}static get requires(){return[gs]}static get pluginName(){return"TableCellPropertiesUI"}static get isOfficialPlugin(){return!0}init(){const e=this.editor,i=e.t;this._defaultContentTableCellProperties=$y(e.config.get("table.tableCellProperties.defaultProperties"),{includeVerticalAlignmentProperty:!0,includeHorizontalAlignmentProperty:!0,includePaddingProperty:!0,isRightToLeftContent:e.locale.contentLanguageDirection==="rtl"}),this._defaultLayoutTableCellProperties=$p(void 0,{includeVerticalAlignmentProperty:!0,includeHorizontalAlignmentProperty:!0,isRightToLeftContent:e.locale.contentLanguageDirection==="rtl"}),this._balloon=e.plugins.get(gs),this.view=null,this._isReady=!1,e.ui.componentFactory.add("tableCellProperties",n=>{const r=new ye(n);r.set({label:i("Cell properties"),icon:Lz,tooltip:!0}),this.listenTo(r,"execute",()=>this._showView());const o=Object.values(uP).map(l=>e.commands.get(l));return r.bind("isEnabled").toMany(o,"isEnabled",(...l)=>l.some(a=>a)),r})}destroy(){super.destroy(),this.view&&this.view.destroy()}_createPropertiesView(e){const i=this.editor,n=i.config.get("table.tableCellProperties"),r=Sg(n.borderColors),o=kg(i.locale,r),l=Sg(n.backgroundColors),a=kg(i.locale,l),c=n.colorPicker!==!1,h=new Mee(i.locale,{borderColors:o,backgroundColors:a,defaultTableCellProperties:e,colorPickerConfig:c?n.colorPicker||{}:!1}),f=i.t;h.render(),this.listenTo(h,"submit",()=>{this._hideView()}),this.listenTo(h,"cancel",()=>{this._undoStepBatch.operations.length&&i.execute("undo",this._undoStepBatch),this._hideView()}),h.keystrokes.set("Esc",(O,_)=>{this._hideView(),_()}),Fr({emitter:h,activator:()=>this._isViewInBalloon,contextElements:[this._balloon.view.element],callback:()=>this._hideView()});const m=k4(f),w=S4(f);return h.on("change:borderStyle",this._getPropertyChangeCallback("tableCellBorderStyle")),h.on("change:borderColor",this._getValidatedPropertyChangeCallback({viewField:h.borderColorInput,commandName:"tableCellBorderColor",errorText:m,validator:Qg})),h.on("change:borderWidth",this._getValidatedPropertyChangeCallback({viewField:h.borderWidthInput,commandName:"tableCellBorderWidth",errorText:w,validator:C4})),h.on("change:padding",this._getValidatedPropertyChangeCallback({viewField:h.paddingInput,commandName:"tableCellPadding",errorText:w,validator:gh})),h.on("change:width",this._getValidatedPropertyChangeCallback({viewField:h.widthInput,commandName:"tableCellWidth",errorText:w,validator:gh})),h.on("change:height",this._getValidatedPropertyChangeCallback({viewField:h.heightInput,commandName:"tableCellHeight",errorText:w,validator:gh})),h.on("change:backgroundColor",this._getValidatedPropertyChangeCallback({viewField:h.backgroundInput,commandName:"tableCellBackgroundColor",errorText:m,validator:Qg})),h.on("change:horizontalAlignment",this._getPropertyChangeCallback("tableCellHorizontalAlignment")),h.on("change:verticalAlignment",this._getPropertyChangeCallback("tableCellVerticalAlignment")),h}_fillViewFormFromCommandValues(){const e=this.editor.commands,i=e.get("tableCellBorderStyle");Object.entries(uP).map(([n,r])=>{const o=n,l=this.view===this._viewWithContentTableDefaults?this._defaultContentTableCellProperties[o]||"":this._defaultLayoutTableCellProperties[o]||"";return[n,e.get(r).value||l]}).forEach(([n,r])=>{(n==="borderColor"||n==="borderWidth")&&i.value==="none"||this.view.set(n,r)}),this._isReady=!0}_showView(){const e=this.editor,i=Dg(e.editing.view.document.selection),n=i&&e.editing.mapper.toModelElement(i),r=!n||n.getAttribute("tableType")!=="layout";r&&!this._viewWithContentTableDefaults?this._viewWithContentTableDefaults=this._createPropertiesView(this._defaultContentTableCellProperties):!r&&!this._viewWithLayoutTableDefaults&&(this._viewWithLayoutTableDefaults=this._createPropertiesView(this._defaultLayoutTableCellProperties)),this.view=r?this._viewWithContentTableDefaults:this._viewWithLayoutTableDefaults,this.listenTo(e.ui,"update",()=>{this._updateView()}),this._fillViewFormFromCommandValues(),this._balloon.add({view:this.view,position:I4(e)}),this._undoStepBatch=e.model.createBatch(),this.view.focus()}_hideView(){const e=this.editor;this.stopListening(e.ui,"update"),this._isReady=!1,this.view.saveButtonView.focus(),this._balloon.remove(this.view),this.editor.editing.view.focus()}_updateView(){const e=this.editor,i=e.editing.view.document;Bp(i.selection)?this._isViewVisible&&E4(e,"cell"):this._hideView()}get _isViewVisible(){return!!this.view&&this._balloon.visibleView===this.view}get _isViewInBalloon(){return!!this.view&&this._balloon.hasView(this.view)}_getPropertyChangeCallback(e){return(i,n,r)=>{this._isReady&&this.editor.execute(e,{value:r,batch:this._undoStepBatch})}}_getValidatedPropertyChangeCallback(e){const{commandName:i,viewField:n,validator:r,errorText:o}=e,l=fs(()=>{n.errorText=o},Bee);return(a,c,h)=>{l.cancel(),this._isReady&&(r(h)?(this.editor.execute(i,{value:h,batch:this._undoStepBatch}),n.errorText=null):l())}}}class Ur extends Be{constructor(e,i,n){super(e);p(this,"attributeName");p(this,"_defaultValue");p(this,"_defaultContentTableValue");p(this,"_defaultLayoutTableValue");switch(this.attributeName=i,this._defaultContentTableValue=n,i){case"tableCellBorderStyle":this._defaultLayoutTableValue="none";break;case"tableCellHorizontalAlignment":this._defaultLayoutTableValue="left";break;case"tableCellVerticalAlignment":this._defaultLayoutTableValue="middle";break;default:this._defaultLayoutTableValue=void 0}}refresh(){const i=this.editor.model.document.selection,r=this.editor.plugins.get("TableUtils").getSelectionAffectedTableCells(i),o=Po(i);this._defaultValue=!o||o.getAttribute("tableType")!=="layout"?this._defaultContentTableValue:this._defaultLayoutTableValue,this.isEnabled=!!r.length,this.value=this._getSingleValue(r)}execute(e={}){const{value:i,batch:n}=e,r=this.editor.model,l=this.editor.plugins.get("TableUtils").getSelectionAffectedTableCells(r.document.selection),a=this._getValueToSet(i);r.enqueueChange(n,c=>{a?l.forEach(h=>c.setAttribute(this.attributeName,a,h)):l.forEach(h=>c.removeAttribute(this.attributeName,h))})}_getAttribute(e){if(!e)return;const i=e.getAttribute(this.attributeName);if(i!==this._defaultValue)return i}_getValueToSet(e){if(e!==this._defaultValue)return e}_getSingleValue(e){const i=this._getAttribute(e[0]);return e.every(r=>this._getAttribute(r)===i)?i:void 0}}class Dee extends Ur{constructor(t,e){super(t,"tableCellWidth",e)}_getValueToSet(t){if(t=Gl(t,"px"),t!==this._defaultValue)return t}}class M4 extends F{static get pluginName(){return"TableCellWidthEditing"}static get isOfficialPlugin(){return!0}static get requires(){return[bd]}init(){const t=this.editor,e=$y(t.config.get("table.tableCellProperties.defaultProperties"));Um(t.model.schema,t.conversion,{modelAttribute:"tableCellWidth",styleName:"width",defaultValue:e.width}),t.commands.add("tableCellWidth",new Dee(t,e.width))}}class Qee extends Ur{constructor(t,e){super(t,"tableCellPadding",e)}_getAttribute(t){if(!t)return;const e=Xl(t.getAttribute(this.attributeName));if(e!==this._defaultValue)return e}_getValueToSet(t){const e=Gl(t,"px");if(e!==this._defaultValue)return e}}class Nee extends Ur{constructor(t,e){super(t,"tableCellHeight",e)}_getValueToSet(t){const e=Gl(t,"px");if(e!==this._defaultValue)return e}}class Fee extends Ur{constructor(t,e){super(t,"tableCellBackgroundColor",e)}}class zee extends Ur{constructor(t,e){super(t,"tableCellVerticalAlignment",e)}}class Wee extends Ur{constructor(t,e){super(t,"tableCellHorizontalAlignment",e)}}class Uee extends Ur{constructor(t,e){super(t,"tableCellBorderStyle",e)}_getAttribute(t){if(!t)return;const e=Xl(t.getAttribute(this.attributeName));if(e!==this._defaultValue)return e}}class Zee extends Ur{constructor(t,e){super(t,"tableCellBorderColor",e)}_getAttribute(t){if(!t)return;const e=Xl(t.getAttribute(this.attributeName));if(e!==this._defaultValue)return e}}class Hee extends Ur{constructor(t,e){super(t,"tableCellBorderWidth",e)}_getAttribute(t){if(!t)return;const e=Xl(t.getAttribute(this.attributeName));if(e!==this._defaultValue)return e}_getValueToSet(t){const e=Gl(t,"px");if(e!==this._defaultValue)return e}}const hP=/^(top|middle|bottom)$/,dP=/^(left|center|right|justify)$/;class qee extends F{static get pluginName(){return"TableCellPropertiesEditing"}static get isOfficialPlugin(){return!0}static get requires(){return[bd,M4]}init(){const t=this.editor,e=t.model.schema,i=t.conversion;t.config.define("table.tableCellProperties.defaultProperties",{});const n=$y(t.config.get("table.tableCellProperties.defaultProperties"),{includeVerticalAlignmentProperty:!0,includeHorizontalAlignmentProperty:!0,includePaddingProperty:!0,isRightToLeftContent:t.locale.contentLanguageDirection==="rtl"});t.data.addStyleProcessorRules(zA),jee(e,i,{color:n.borderColor,style:n.borderStyle,width:n.borderWidth}),t.commands.add("tableCellBorderStyle",new Uee(t,n.borderStyle)),t.commands.add("tableCellBorderColor",new Zee(t,n.borderColor)),t.commands.add("tableCellBorderWidth",new Hee(t,n.borderWidth)),Um(e,i,{modelAttribute:"tableCellHeight",styleName:"height",defaultValue:n.height}),t.commands.add("tableCellHeight",new Nee(t,n.height)),t.data.addStyleProcessorRules(vF),Um(e,i,{modelAttribute:"tableCellPadding",styleName:"padding",reduceBoxSides:!0,defaultValue:n.padding}),t.commands.add("tableCellPadding",new Qee(t,n.padding)),t.data.addStyleProcessorRules(FA),Um(e,i,{modelAttribute:"tableCellBackgroundColor",styleName:"background-color",defaultValue:n.backgroundColor}),t.commands.add("tableCellBackgroundColor",new Fee(t,n.backgroundColor)),Xee(e,i,n.horizontalAlignment),t.commands.add("tableCellHorizontalAlignment",new Wee(t,n.horizontalAlignment)),Gee(e,i,n.verticalAlignment),t.commands.add("tableCellVerticalAlignment",new zee(t,n.verticalAlignment))}}function jee(s,t,e){const i={width:"tableCellBorderWidth",color:"tableCellBorderColor",style:"tableCellBorderStyle"};s.extend("tableCell",{allowAttributes:Object.values(i)}),a1(t,"td",i,e),a1(t,"th",i,e),mh(t,{modelElement:"tableCell",modelAttribute:i.style,styleName:"border-style"}),mh(t,{modelElement:"tableCell",modelAttribute:i.color,styleName:"border-color"}),mh(t,{modelElement:"tableCell",modelAttribute:i.width,styleName:"border-width"})}function Xee(s,t,e){s.extend("tableCell",{allowAttributes:["tableCellHorizontalAlignment"]}),t.for("downcast").attributeToAttribute({model:{name:"tableCell",key:"tableCellHorizontalAlignment"},view:i=>({key:"style",value:{"text-align":i}})}),t.for("upcast").attributeToAttribute({view:{name:/^(td|th)$/,styles:{"text-align":dP}},model:{key:"tableCellHorizontalAlignment",value:(i,n,r)=>{const o=Co(e,"left",r),l=i.getStyle("text-align");return l===o?null:l}}}).attributeToAttribute({view:{name:/^(td|th)$/,attributes:{align:dP}},model:{key:"tableCellHorizontalAlignment",value:(i,n,r)=>{const o=Co(e,"left",r),l=i.getAttribute("align");return l===o?null:l}}})}function Gee(s,t,e){s.extend("tableCell",{allowAttributes:["tableCellVerticalAlignment"]}),t.for("downcast").attributeToAttribute({model:{name:"tableCell",key:"tableCellVerticalAlignment"},view:i=>({key:"style",value:{"vertical-align":i}})}),t.for("upcast").attributeToAttribute({view:{name:/^(td|th)$/,styles:{"vertical-align":hP}},model:{key:"tableCellVerticalAlignment",value:(i,n,r)=>{const o=Co(e,"middle",r),l=i.getStyle("vertical-align");return l===o?null:l}}}).attributeToAttribute({view:{name:/^(td|th)$/,attributes:{valign:hP}},model:{key:"tableCellVerticalAlignment",value:(i,n,r)=>{const o=Co(e,"middle",r),l=i.getAttribute("valign");return l===o?null:l}}})}class Yee extends F{static get pluginName(){return"TableCellProperties"}static get isOfficialPlugin(){return!0}static get requires(){return[qee,$ee]}}class Kee extends Be{refresh(){this.isEnabled=!0}execute(t={}){const{model:e,plugins:i}=this.editor;let{table:n=e.document.selection.getSelectedElement(),columnWidths:r,tableWidth:o}=t;r&&(r=Array.isArray(r)?r:r.split(",")),e.change(l=>{o?l.setAttribute("tableWidth",o,n):l.removeAttribute("tableWidth",n);const a=i.get("TableColumnResizeEditing").getColumnGroupElement(n);if(!r&&!a)return;if(!r)return l.remove(a);const c=My(r);if(a)Array.from(a.getChildren()).forEach((h,f)=>l.setAttribute("columnWidth",c[f],h));else{const h=l.createElement("tableColumnGroup");c.forEach(f=>l.appendElement("tableColumn",{columnWidth:f},h)),l.append(h,n)}})}}function Jee(s){return t=>t.on("element:colgroup",(e,i,n)=>{const r=i.modelCursor.findAncestor("table"),o=wd(r);if(!o)return;const l=xd(o),a=s.getColumns(r);let c=XJ(o,n.writer);c=Array.from({length:a},(h,f)=>c[f]||"auto"),(c.length!=l.length||c.includes("auto"))&&x4(l,o,My(c),n.writer)},{priority:"low"})}function ete(){return s=>s.on("insert:table",(t,e,i)=>{const n=i.writer,r=e.item,o=i.mapper.toViewElement(r),l=o.is("element","table")?o:Array.from(o.getChildren()).find(c=>c.is("element","table"));wd(r)?n.addClass("ck-table-resized",l):n.removeClass("ck-table-resized",l)},{priority:"low"})}const fP=No("px");class tte extends F{constructor(e){super(e);p(this,"_isResizingActive");p(this,"_resizingData");p(this,"_domEmitter");p(this,"_tableUtilsPlugin");p(this,"_initialMouseEventData",null);this._isResizingActive=!1,this.set("_isResizingAllowed",!0),this._resizingData=null,this._domEmitter=new(qi()),this._tableUtilsPlugin=e.plugins.get("TableUtils"),this.on("change:_isResizingAllowed",(i,n,r)=>{const o=r?"removeClass":"addClass";e.editing.view.change(l=>{for(const a of e.editing.view.document.roots)l[o]("ck-column-resize_disabled",e.editing.view.document.getRoot(a.rootName))})})}static get requires(){return[bd,Oi]}static get pluginName(){return"TableColumnResizeEditing"}static get isOfficialPlugin(){return!0}init(){this._extendSchema(),this._registerPostFixer(),this._registerConverters(),this._registerResizingListeners(),this._registerResizerInserter();const e=this.editor,i=e.plugins.get("TableColumnResize");e.plugins.get("TableEditing").registerAdditionalSlot({filter:o=>o.is("element","tableColumnGroup"),positionOffset:0});const r=new Kee(e);e.commands.add("resizeTableWidth",r),e.commands.add("resizeColumnWidths",r),this.bind("_isResizingAllowed").to(e,"isReadOnly",i,"isEnabled",r,"isEnabled",(o,l,a)=>!o&&l&&a)}destroy(){this._domEmitter.stopListening(),super.destroy()}getColumnGroupElement(e){return wd(e)}getTableColumnElements(e){return xd(e)}getTableColumnsWidths(e){return jJ(e)}_extendSchema(){this.editor.model.schema.extend("table",{allowAttributes:["tableWidth"]}),this.editor.model.schema.register("tableColumnGroup",{allowIn:"table",isLimit:!0}),this.editor.model.schema.register("tableColumn",{allowIn:"tableColumnGroup",allowAttributes:["columnWidth","colSpan"],isLimit:!0})}_registerPostFixer(){const i=this.editor.model;i.document.registerPostFixer(o=>{let l=!1;for(const a of FJ(i)){const c=this.getColumnGroupElement(a),h=this.getTableColumnElements(c),f=this.getTableColumnsWidths(c);let m=My(f);m=n(m,a,this),!Cl(f,m)&&(x4(h,c,m,o),l=!0)}return l});function n(o,l,a){const c=a._tableUtilsPlugin.getColumns(l);if(c-o.length===0)return o;const f=o.map(w=>Number(w.replace("%",""))),m=r(a.editor.model.document.differ,l);for(const w of m){const O=c-f.length;if(O===0)continue;const _=O>0,k=a._tableUtilsPlugin.getCellLocation(w).column;if(_){const C=zJ(l,a.editor),P=ZJ(O,C);f.splice(k,0,...P)}else{const C=f.splice(k,Math.abs(O));f[k]+=Nh(C)}}return f.map(w=>w+"%")}function r(o,l){const a=new Set;for(const c of o.getChanges())if(c.type=="insert"&&c.position.nodeAfter&&c.position.nodeAfter.name=="tableCell"&&c.position.nodeAfter.getAncestors().includes(l))a.add(c.position.nodeAfter);else if(c.type=="remove"){const h=c.position.nodeBefore||c.position.nodeAfter;h.name=="tableCell"&&h.getAncestors().includes(l)&&a.add(h)}return a}}_registerConverters(){const i=this.editor.conversion;i.for("upcast").attributeToAttribute({view:{name:/^(figure|table)$/,styles:{width:/[\s\S]+/}},model:{name:"table",key:"tableWidth",value:n=>{if(!n.parent.is("element","figure"))return n.getStyle("width")}}}),i.for("downcast").attributeToAttribute({model:{name:"table",key:"tableWidth"},view:n=>({name:"figure",key:"style",value:{width:n}})}),i.elementToElement({model:"tableColumnGroup",view:"colgroup"}),i.elementToElement({model:"tableColumn",view:"col"}),i.for("downcast").add(ete()),i.for("upcast").add(Jee(this._tableUtilsPlugin)),i.for("upcast").attributeToAttribute({view:{name:"col",styles:{width:/.*/}},model:{key:"columnWidth",value:n=>{const r=n.getStyle("width");return!r||!r.endsWith("%")&&!r.endsWith("pt")?"auto":r}}}),i.for("upcast").attributeToAttribute({view:{name:"col",key:"span"},model:"colSpan"}),i.for("downcast").attributeToAttribute({model:{name:"tableColumn",key:"columnWidth"},view:n=>({key:"style",value:{width:n}})})}_registerResizingListeners(){const e=this.editor.editing.view;e.addObserver(y4),e.document.on("mouseover",this._onMouseOverHandler.bind(this),{priority:"high"}),e.document.on("mousedown",this._onMouseDownHandler.bind(this),{priority:"high"}),e.document.on("mouseout",this._onMouseOutHandler.bind(this),{priority:"high"}),this._domEmitter.listenTo(he.window.document,"mousemove",hc(this._onMouseMoveHandler.bind(this),50)),this._domEmitter.listenTo(he.window.document,"mouseup",this._onMouseUpHandler.bind(this))}_recalculateResizerElement(e){const i=this.editor,n=i.editing.view.domConverter,r=n.mapViewToDom(e.findAncestor("table")),o=n.mapViewToDom(e.findAncestor(f=>["td","th"].includes(f.name))),l=new Ve(r),a=new Ve(o),c=fP(Number((l.top-a.top).toFixed(4))),h=fP(Number((a.bottom-l.bottom).toFixed(4)));i.editing.view.change(f=>{f.setStyle("top",c,e),f.setStyle("bottom",h,e)})}_resetResizerStyles(e){this.editor.editing.view.change(i=>{i.removeStyle("top",e),i.removeStyle("bottom",e)})}_onMouseOverHandler(e,i){const n=i.target;n.hasClass("ck-table-column-resizer")&&this._isResizingAllowed&&this._recalculateResizerElement(n)}_onMouseOutHandler(e,i){const n=i.target;n.hasClass("ck-table-column-resizer")&&this._isResizingAllowed&&(this._isResizingActive||this._resetResizerStyles(n))}_onMouseDownHandler(e,i){const n=i.target;if(!n.hasClass("ck-table-column-resizer")||!this._isResizingAllowed)return;const r=this.editor,o=r.editing.mapper.toModelElement(n.findAncestor("figure"));r.model.canEditAt(o)&&(i.preventDefault(),e.stop(),this._initialMouseEventData=i)}_startResizingAfterThreshold(){const e=this._initialMouseEventData,{target:i}=e,n=this.editor.editing.mapper.toModelElement(i.findAncestor("figure")),r=i.findAncestor("table"),o=l(n,this._tableUtilsPlugin,this.editor);Array.from(r.getChildren()).find(h=>h.is("element","colgroup"))||this.editor.editing.view.change(h=>{a(h,o,r)}),this._isResizingActive=!0,this._resizingData=this._getResizingData(e,o),this.editor.editing.view.change(h=>c(h,r,this._resizingData));function l(h,f,m){const w=Array(f.getColumns(h)),O=new mt(h);for(const _ of O){const k=m.editing.mapper.toViewElement(_.cell),C=m.editing.view.domConverter.mapViewToDom(k),P=qJ(C);(!w[_.column]||P<w[_.column])&&(w[_.column]=gn(P))}return w}function a(h,f,m){const w=h.createContainerElement("colgroup");for(let O=0;O<f.length;O++){const _=h.createEmptyElement("col"),k=`${gn(f[O]/Nh(f)*100)}%`;h.setStyle("width",k,_),h.insert(h.createPositionAt(w,"end"),_)}h.insert(h.createPositionAt(m,0),w)}function c(h,f,m){const w=m.widths.viewFigureWidth/m.widths.viewFigureParentWidth;h.addClass("ck-table-resized",f),h.addClass("ck-table-column-resizer__active",m.elements.viewResizer),h.setStyle("width",`${gn(w*100)}%`,f.findAncestor("figure"))}}_onMouseMoveHandler(e,i){if(this._initialMouseEventData){const Q=this._initialMouseEventData.domEvent;if(Math.abs(i.clientX-Q.clientX)>=NJ)this._startResizingAfterThreshold(),this._initialMouseEventData=null;else return}if(!this._isResizingActive)return;if(!this._isResizingAllowed){this._onMouseUpHandler();return}const{columnPosition:n,flags:{isRightEdge:r,isTableCentered:o,isLtrContent:l},elements:{viewFigure:a,viewLeftColumn:c,viewRightColumn:h,viewResizer:f},widths:{viewFigureParentWidth:m,tableWidth:w,leftColumnWidth:O,rightColumnWidth:_}}=this._resizingData,k=-O+d1,C=r?m-w:_-d1,P=(l?1:-1)*(r&&o?2:1),M=UJ((i.clientX-n)*P,Math.min(k,0),Math.max(C,0));M!==0&&(this.editor.editing.view.change(Q=>{const N=gn((O+M)*100/w);if(Q.setStyle("width",`${N}%`,c),r){const G=gn((w+M)*100/m);Q.setStyle("width",`${G}%`,a)}else{const G=gn((_-M)*100/w);Q.setStyle("width",`${G}%`,h)}}),this._recalculateResizerElement(f))}_onMouseUpHandler(){if(this._initialMouseEventData=null,!this._isResizingActive)return;const{viewResizer:e,modelTable:i,viewFigure:n,viewColgroup:r}=this._resizingData.elements,o=this.editor,l=o.editing.view,a=this.getColumnGroupElement(i),c=Array.from(r.getChildren()).filter(C=>C.is("view:element")),h=a?this.getTableColumnsWidths(a):null,f=c.map(C=>C.getStyle("width")),m=!Cl(h,f),w=i.getAttribute("tableWidth"),O=n.getStyle("width"),_=w!==O;(m||_)&&(this._isResizingAllowed?o.execute("resizeTableWidth",{table:i,tableWidth:`${gn(O)}%`,columnWidths:f}):l.change(C=>{if(h)for(const P of c)C.setStyle("width",h.shift(),P);else C.remove(r);_&&(w?C.setStyle("width",w,n):C.removeStyle("width",n)),!h&&!w&&C.removeClass("ck-table-resized",[...n.getChildren()].find(P=>P.name==="table"))})),l.change(C=>{C.removeClass("ck-table-column-resizer__active",e)}),l.domConverter.mapViewToDom(e).matches(":hover")||this._resetResizerStyles(e),this._isResizingActive=!1,this._resizingData=null}_getResizingData(e,i){const n=this.editor,r=e.domEvent.clientX,o=e.target,l=o.findAncestor("td")||o.findAncestor("th"),a=n.editing.mapper.toModelElement(l),c=a.findAncestor("table"),h=WJ(a,this._tableUtilsPlugin).rightEdge,f=this._tableUtilsPlugin.getColumns(c)-1,m=h===f,w=!c.hasAttribute("tableAlignment"),O=n.locale.contentLanguageDirection!=="rtl",_=l.findAncestor("table"),k=_.findAncestor("figure"),C=[..._.getChildren()].find(I=>I.is("element","colgroup")),P=C.getChild(h),M=m?void 0:C.getChild(h+1),Q=f1(n.editing.view.domConverter.mapViewToDom(k.parent)),N=f1(n.editing.view.domConverter.mapViewToDom(k)),G=w4(c,n),D=i[h],b=m?void 0:i[h+1];return{columnPosition:r,flags:{isRightEdge:m,isTableCentered:w,isLtrContent:O},elements:{viewResizer:o,modelTable:c,viewFigure:k,viewColgroup:C,viewLeftColumn:P,viewRightColumn:M},widths:{viewFigureParentWidth:Q,viewFigureWidth:N,tableWidth:G,leftColumnWidth:D,rightColumnWidth:b}}}_registerResizerInserter(){this.editor.conversion.for("editingDowncast").add(e=>{e.on("insert:tableCell",(i,n,r)=>{const o=n.item,l=r.mapper.toViewElement(o),a=r.writer;a.insert(a.createPositionAt(l,"end"),a.createUIElement("div",{class:"ck-table-column-resizer"}))},{priority:"lowest"})})}}class ite extends F{static get requires(){return[tte,M4]}static get pluginName(){return"TableColumnResize"}static get isOfficialPlugin(){return!0}}class Yl extends Be{constructor(e,i,n){super(e);p(this,"attributeName");p(this,"_defaultValue");p(this,"_defaultContentTableValue");p(this,"_defaultLayoutTableValue");this.attributeName=i,this._defaultContentTableValue=n,this._defaultLayoutTableValue=i==="tableBorderStyle"?"none":void 0}refresh(){const i=this.editor.model.document.selection,n=Po(i);this._defaultValue=!n||n.getAttribute("tableType")!=="layout"?this._defaultContentTableValue:this._defaultLayoutTableValue,this.isEnabled=!!n,this.value=this._getValue(n)}execute(e={}){const i=this.editor.model,n=i.document.selection,{value:r,batch:o}=e,l=Po(n),a=this._getValueToSet(r);i.enqueueChange(o,c=>{a?c.setAttribute(this.attributeName,a,l):c.removeAttribute(this.attributeName,l)})}_getValue(e){if(!e)return;const i=e.getAttribute(this.attributeName);if(i!==this._defaultValue)return i}_getValueToSet(e){if(e!==this._defaultValue)return e}}class nte extends Yl{constructor(t,e){super(t,"tableBackgroundColor",e)}}class ste extends Yl{constructor(t,e){super(t,"tableBorderColor",e)}_getValue(t){if(!t)return;const e=Xl(t.getAttribute(this.attributeName));if(e!==this._defaultValue)return e}}class rte extends Yl{constructor(t,e){super(t,"tableBorderStyle",e)}_getValue(t){if(!t)return;const e=Xl(t.getAttribute(this.attributeName));if(e!==this._defaultValue)return e}}class ote extends Yl{constructor(t,e){super(t,"tableBorderWidth",e)}_getValue(t){if(!t)return;const e=Xl(t.getAttribute(this.attributeName));if(e!==this._defaultValue)return e}_getValueToSet(t){const e=Gl(t,"px");if(e!==this._defaultValue)return e}}class lte extends Yl{constructor(t,e){super(t,"tableWidth",e)}_getValueToSet(t){if(t=Gl(t,"px"),t!==this._defaultValue)return t}}class ate extends Yl{constructor(t,e){super(t,"tableHeight",e)}_getValueToSet(t){if(t=Gl(t,"px"),t!==this._defaultValue)return t}}class cte extends Yl{constructor(t,e){super(t,"tableAlignment",e)}}const ute=/^(left|center|right)$/,hte=/^(left|none|right)$/;class dte extends F{static get pluginName(){return"TablePropertiesEditing"}static get isOfficialPlugin(){return!0}static get requires(){return[bd]}init(){const t=this.editor,e=t.model.schema,i=t.conversion;t.config.define("table.tableProperties.defaultProperties",{});const n=V4(t.config.get("table.tableProperties.defaultProperties"),{includeAlignmentProperty:!0});t.data.addStyleProcessorRules(zA),fte(e,i,{color:n.borderColor,style:n.borderStyle,width:n.borderWidth}),t.commands.add("tableBorderColor",new ste(t,n.borderColor)),t.commands.add("tableBorderStyle",new rte(t,n.borderStyle)),t.commands.add("tableBorderWidth",new ote(t,n.borderWidth)),mte(e,i,n.alignment),t.commands.add("tableAlignment",new cte(t,n.alignment)),mP(e,i,{modelAttribute:"tableWidth",styleName:"width",defaultValue:n.width}),t.commands.add("tableWidth",new lte(t,n.width)),mP(e,i,{modelAttribute:"tableHeight",styleName:"height",defaultValue:n.height}),t.commands.add("tableHeight",new ate(t,n.height)),t.data.addStyleProcessorRules(FA),gte(e,i,{modelAttribute:"tableBackgroundColor",styleName:"background-color",defaultValue:n.backgroundColor}),t.commands.add("tableBackgroundColor",new nte(t,n.backgroundColor))}}function fte(s,t,e){const i={width:"tableBorderWidth",color:"tableBorderColor",style:"tableBorderStyle"};s.extend("table",{allowAttributes:Object.values(i)}),a1(t,"table",i,e),zm(t,{modelAttribute:i.color,styleName:"border-color"}),zm(t,{modelAttribute:i.style,styleName:"border-style"}),zm(t,{modelAttribute:i.width,styleName:"border-width"})}function mte(s,t,e){s.extend("table",{allowAttributes:["tableAlignment"]}),t.for("downcast").attributeToAttribute({model:{name:"table",key:"tableAlignment",values:["left","center","right"]},view:{left:{key:"style",value:{float:"left"}},right:{key:"style",value:{float:"right"}},center:(i,n,r)=>({key:"style",value:r.item.getAttribute("tableType")!=="layout"?{float:"none"}:{"margin-left":"auto","margin-right":"auto"}})},converterPriority:"high"}),t.for("upcast").attributeToAttribute({view:{name:/^(table|figure)$/,styles:{float:hte}},model:{key:"tableAlignment",value:(i,n,r)=>{const o=Co(e,"",r);let l=i.getStyle("float");return l==="none"&&(l="center"),l===o?null:l}}}).attributeToAttribute({view:{name:/^(table|figure)$/,styles:{"margin-left":"auto","margin-right":"auto"}},model:{key:"tableAlignment",value:(i,n,r)=>{const o=Co(e,"",r),l="center";return l===o?null:l}}}).attributeToAttribute({view:{attributes:{align:ute}},model:{name:"table",key:"tableAlignment",value:(i,n,r)=>{const o=Co(e,"",r),l=i.getAttribute("align");return l===o?null:l}}})}function gte(s,t,e){const{modelAttribute:i}=e;s.extend("table",{allowAttributes:[i]}),Ry(t,{viewElement:"table",...e}),zm(t,e)}function mP(s,t,e){const{modelAttribute:i}=e;s.extend("table",{allowAttributes:[i]}),Ry(t,{viewElement:/^(table|figure)$/,shouldUpcast:n=>!(n.name=="table"&&n.parent.name=="figure"),...e}),mh(t,{modelElement:"table",...e})}class pte extends ue{constructor(e,i){super(e);p(this,"options");p(this,"focusTracker");p(this,"keystrokes");p(this,"children");p(this,"borderStyleDropdown");p(this,"borderWidthInput");p(this,"borderColorInput");p(this,"backgroundInput");p(this,"widthInput");p(this,"heightInput");p(this,"alignmentToolbar");p(this,"saveButtonView");p(this,"cancelButtonView");p(this,"_focusables");p(this,"_focusCycler");this.set({borderStyle:"",borderWidth:"",borderColor:"",backgroundColor:"",width:"",height:"",alignment:""}),this.options=i;const{borderStyleDropdown:n,borderWidthInput:r,borderColorInput:o,borderRowLabel:l}=this._createBorderFields(),{backgroundRowLabel:a,backgroundInput:c}=this._createBackgroundFields(),{widthInput:h,operatorLabel:f,heightInput:m,dimensionsLabel:w}=this._createDimensionFields(),{alignmentToolbar:O,alignmentLabel:_}=this._createAlignmentFields();this.focusTracker=new ot,this.keystrokes=new wt,this.children=this.createCollection(),this.borderStyleDropdown=n,this.borderWidthInput=r,this.borderColorInput=o,this.backgroundInput=c,this.widthInput=h,this.heightInput=m,this.alignmentToolbar=O;const{saveButtonView:k,cancelButtonView:C}=this._createActionButtons();this.saveButtonView=k,this.cancelButtonView=C,this._focusables=new fi,this._focusCycler=new Ht({focusables:this._focusables,focusTracker:this.focusTracker,keystrokeHandler:this.keystrokes,actions:{focusPrevious:"shift + tab",focusNext:"tab"}}),this.children.add(new zr(e,{label:this.t("Table properties")})),this.children.add(new Ei(e,{labelView:l,children:[l,n,o,r],class:"ck-table-form__border-row"})),this.children.add(new Ei(e,{labelView:a,children:[a,c],class:"ck-table-form__background-row"})),this.children.add(new Ei(e,{children:[new Ei(e,{labelView:w,children:[w,h,f,m],class:"ck-table-form__dimensions-row"}),new Ei(e,{labelView:_,children:[_,O],class:"ck-table-properties-form__alignment-row"})]})),this.children.add(new Ei(e,{children:[this.saveButtonView,this.cancelButtonView],class:"ck-table-form__action-row"})),this.setTemplate({tag:"form",attributes:{class:["ck","ck-form","ck-table-form","ck-table-properties-form"],tabindex:"-1"},children:this.children})}render(){super.render(),Wl({view:this}),[this.borderColorInput,this.backgroundInput].forEach(e=>{this._focusCycler.chain(e.fieldView.focusCycler)}),[this.borderStyleDropdown,this.borderColorInput,this.borderWidthInput,this.backgroundInput,this.widthInput,this.heightInput,this.alignmentToolbar,this.saveButtonView,this.cancelButtonView].forEach(e=>{this._focusables.add(e),this.focusTracker.add(e.element)}),this.keystrokes.listenTo(this.element)}destroy(){super.destroy(),this.focusTracker.destroy(),this.keystrokes.destroy()}focus(){this._focusCycler.focusFirst()}_createBorderFields(){const e=this.options.defaultTableProperties,i={style:e.borderStyle,width:e.borderWidth,color:e.borderColor},n=Fg({colorConfig:this.options.borderColors,columns:5,defaultColorValue:i.color,colorPickerConfig:this.options.colorPickerConfig}),r=this.locale,o=this.t,l=o("Style"),a=new ns(r);a.text=o("Border");const c=By(o),h=new Yt(r,RI);h.set({label:l,class:"ck-table-form__border-style"}),h.fieldView.buttonView.set({ariaLabel:l,ariaLabelledBy:void 0,isOn:!1,withText:!0,tooltip:l}),h.fieldView.buttonView.bind("label").to(this,"borderStyle",w=>c[w||"none"]),h.fieldView.on("execute",w=>{this.borderStyle=w.source._borderStyleValue}),h.bind("isEmpty").to(this,"borderStyle",w=>!w),Zl(h.fieldView,P4(this,i.style),{role:"menu",ariaLabel:l});const f=new Yt(r,On);f.set({label:o("Width"),class:"ck-table-form__border-width"}),f.fieldView.bind("value").to(this,"borderWidth"),f.bind("isEnabled").to(this,"borderStyle",am),f.fieldView.on("input",()=>{this.borderWidth=f.fieldView.element.value});const m=new Yt(r,n);return m.set({label:o("Color"),class:"ck-table-form__border-color"}),m.fieldView.bind("value").to(this,"borderColor"),m.bind("isEnabled").to(this,"borderStyle",am),m.fieldView.on("input",()=>{this.borderColor=m.fieldView.value}),this.on("change:borderStyle",(w,O,_,k)=>{am(_)||(this.borderColor="",this.borderWidth=""),am(k)||(this.borderColor=i.color,this.borderWidth=i.width)}),{borderRowLabel:a,borderStyleDropdown:h,borderColorInput:m,borderWidthInput:f}}_createBackgroundFields(){const e=this.locale,i=this.t,n=new ns(e);n.text=i("Background");const r=Fg({colorConfig:this.options.backgroundColors,columns:5,defaultColorValue:this.options.defaultTableProperties.backgroundColor,colorPickerConfig:this.options.colorPickerConfig}),o=new Yt(e,r);return o.set({label:i("Color"),class:"ck-table-properties-form__background"}),o.fieldView.bind("value").to(this,"backgroundColor"),o.fieldView.on("input",()=>{this.backgroundColor=o.fieldView.value}),{backgroundRowLabel:n,backgroundInput:o}}_createDimensionFields(){const e=this.locale,i=this.t,n=new ns(e);n.text=i("Dimensions");const r=new Yt(e,On);r.set({label:i("Width"),class:"ck-table-form__dimensions-row__width"}),r.fieldView.bind("value").to(this,"width"),r.fieldView.on("input",()=>{this.width=r.fieldView.element.value});const o=new ue(e);o.setTemplate({tag:"span",attributes:{class:["ck-table-form__dimension-operator"]},children:[{text:"×"}]});const l=new Yt(e,On);return l.set({label:i("Height"),class:"ck-table-form__dimensions-row__height"}),l.fieldView.bind("value").to(this,"height"),l.fieldView.on("input",()=>{this.height=l.fieldView.element.value}),{dimensionsLabel:n,widthInput:r,operatorLabel:o,heightInput:l}}_createAlignmentFields(){const e=this.locale,i=this.t,n=new ns(e);n.text=i("Alignment");const r=new Vo(e);return r.set({role:"radiogroup",isCompact:!0,ariaLabel:i("Table alignment toolbar")}),w1({view:this,icons:{left:iy,center:Og,right:yg},toolbar:r,labels:this._alignmentLabels,propertyName:"alignment",defaultValue:this.options.defaultTableProperties.alignment}),{alignmentLabel:n,alignmentToolbar:r}}_createActionButtons(){const e=this.locale,i=this.t,n=new ye(e),r=new ye(e),o=[this.borderWidthInput,this.borderColorInput,this.backgroundInput,this.widthInput,this.heightInput];return n.set({label:i("Save"),icon:Ic,class:"ck-button-save",type:"submit",withText:!0}),n.bind("isEnabled").toMany(o,"errorText",(...l)=>l.every(a=>!a)),r.set({label:i("Cancel"),icon:Ac,class:"ck-button-cancel",withText:!0}),r.delegate("execute").to(this,"cancel"),{saveButtonView:n,cancelButtonView:r}}get _alignmentLabels(){const e=this.locale,i=this.t,n=i("Align table to the left"),r=i("Center table"),o=i("Align table to the right");return e.uiLanguageDirection==="rtl"?{right:o,center:r,left:n}:{left:n,center:r,right:o}}}function am(s){return s!=="none"}const wte=500,gP={borderStyle:"tableBorderStyle",borderColor:"tableBorderColor",borderWidth:"tableBorderWidth",backgroundColor:"tableBackgroundColor",width:"tableWidth",height:"tableHeight",alignment:"tableAlignment"};class xte extends F{constructor(e){super(e);p(this,"_defaultContentTableProperties");p(this,"_defaultLayoutTableProperties");p(this,"_balloon");p(this,"view",null);p(this,"_viewWithContentTableDefaults",null);p(this,"_viewWithLayoutTableDefaults",null);p(this,"_undoStepBatch");p(this,"_isReady");e.config.define("table.tableProperties",{borderColors:Ng,backgroundColors:Ng})}static get requires(){return[gs]}static get pluginName(){return"TablePropertiesUI"}static get isOfficialPlugin(){return!0}init(){const e=this.editor;this._defaultContentTableProperties=V4(e.config.get("table.tableProperties.defaultProperties"),{includeAlignmentProperty:!0}),this._defaultLayoutTableProperties=$p(),this._balloon=e.plugins.get(gs),e.ui.componentFactory.add("tableProperties",()=>this._createTablePropertiesButton())}_createTablePropertiesButton(){const e=this.editor,i=e.t,n=new ye(e.locale);n.set({label:i("Table properties"),icon:Dz,tooltip:!0}),this.listenTo(n,"execute",()=>this._showView());const r=Object.values(gP).map(o=>e.commands.get(o));return n.bind("isEnabled").toMany(r,"isEnabled",(...o)=>o.some(l=>l)),n}destroy(){super.destroy(),this.view&&this.view.destroy()}_createPropertiesView(e){const i=this.editor,n=i.config.get("table.tableProperties"),r=Sg(n.borderColors),o=kg(i.locale,r),l=Sg(n.backgroundColors),a=kg(i.locale,l),c=n.colorPicker!==!1,h=new pte(i.locale,{borderColors:o,backgroundColors:a,defaultTableProperties:e,colorPickerConfig:c?n.colorPicker||{}:!1}),f=i.t;h.render(),this.listenTo(h,"submit",()=>{this._hideView()}),this.listenTo(h,"cancel",()=>{this._undoStepBatch.operations.length&&i.execute("undo",this._undoStepBatch),this._hideView()}),h.keystrokes.set("Esc",(O,_)=>{this._hideView(),_()}),Fr({emitter:h,activator:()=>this._isViewInBalloon,contextElements:[this._balloon.view.element],callback:()=>this._hideView()});const m=k4(f),w=S4(f);return h.on("change:borderStyle",this._getPropertyChangeCallback("tableBorderStyle")),h.on("change:borderColor",this._getValidatedPropertyChangeCallback({viewField:h.borderColorInput,commandName:"tableBorderColor",errorText:m,validator:Qg})),h.on("change:borderWidth",this._getValidatedPropertyChangeCallback({viewField:h.borderWidthInput,commandName:"tableBorderWidth",errorText:w,validator:C4})),h.on("change:backgroundColor",this._getValidatedPropertyChangeCallback({viewField:h.backgroundInput,commandName:"tableBackgroundColor",errorText:m,validator:Qg})),h.on("change:width",this._getValidatedPropertyChangeCallback({viewField:h.widthInput,commandName:"tableWidth",errorText:w,validator:gh})),h.on("change:height",this._getValidatedPropertyChangeCallback({viewField:h.heightInput,commandName:"tableHeight",errorText:w,validator:gh})),h.on("change:alignment",this._getPropertyChangeCallback("tableAlignment")),h}_fillViewFormFromCommandValues(){const e=this.editor.commands,i=e.get("tableBorderStyle");Object.entries(gP).map(([n,r])=>{const o=n,l=this.view===this._viewWithContentTableDefaults?this._defaultContentTableProperties[o]||"":this._defaultLayoutTableProperties[o]||"";return[o,e.get(r).value||l]}).forEach(([n,r])=>{(n==="borderColor"||n==="borderWidth")&&i.value==="none"||this.view.set(n,r)}),this._isReady=!0}_showView(){const e=this.editor,i=Dg(e.editing.view.document.selection),n=i&&e.editing.mapper.toModelElement(i),r=!n||n.getAttribute("tableType")!=="layout";r&&!this._viewWithContentTableDefaults?this._viewWithContentTableDefaults=this._createPropertiesView(this._defaultContentTableProperties):!r&&!this._viewWithLayoutTableDefaults&&(this._viewWithLayoutTableDefaults=this._createPropertiesView(this._defaultLayoutTableProperties)),this.view=r?this._viewWithContentTableDefaults:this._viewWithLayoutTableDefaults,this.listenTo(e.ui,"update",()=>{this._updateView()}),this._fillViewFormFromCommandValues(),this._balloon.add({view:this.view,position:A4(e)}),this._undoStepBatch=e.model.createBatch(),this.view.focus()}_hideView(){const e=this.editor;this.stopListening(e.ui,"update"),this._isReady=!1,this.view.saveButtonView.focus(),this._balloon.remove(this.view),this.editor.editing.view.focus()}_updateView(){const e=this.editor,i=e.editing.view.document;Dg(i.selection)?this._isViewVisible&&E4(e,"table"):this._hideView()}get _isViewVisible(){return!!this.view&&this._balloon.visibleView===this.view}get _isViewInBalloon(){return!!this.view&&this._balloon.hasView(this.view)}_getPropertyChangeCallback(e){return(i,n,r)=>{this._isReady&&this.editor.execute(e,{value:r,batch:this._undoStepBatch})}}_getValidatedPropertyChangeCallback(e){const{commandName:i,viewField:n,validator:r,errorText:o}=e,l=fs(()=>{n.errorText=o},wte);return(a,c,h)=>{l.cancel(),this._isReady&&(r(h)?(this.editor.execute(i,{value:h,batch:this._undoStepBatch}),n.errorText=null):l())}}}class bte extends F{static get pluginName(){return"TableProperties"}static get isOfficialPlugin(){return!0}static get requires(){return[dte,xte]}}/**
 * @license Copyright (c) 2003-2025, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options
 */function Ote(s){s.document.registerPostFixer(t=>yte(t,s))}function yte(s,t){const e=t.document.differ.getChanges();let i=!1;for(const n of e){if(n.type!="insert")continue;const r=n.position.parent;if(r.is("element","table")||n.name=="table"){const o=n.name=="table"?n.position.nodeAfter:r,l=Array.from(o.getChildren()).filter(c=>c.is("element","caption")),a=l.shift();if(!a)continue;for(const c of l)s.move(s.createRangeIn(c),a,"end"),s.remove(c);a.nextSibling&&(s.move(s.createRangeOn(a),o,"end"),i=!0),i=!!l.length||i}}return i}function pP(s){return!!s&&s.is("element","table")}function b1(s){for(const t of s.getChildren())if(t.is("element","caption"))return t;return null}function vte(s){const t=Po(s);return t?b1(t):null}function _te(s){const t=s.parent;return s.name=="figcaption"&&t&&t.is("element","figure")&&t.hasClass("table")?{name:!0}:s.name=="caption"&&t&&t.is("element","table")?{name:!0}:null}class kte extends Be{refresh(){const t=this.editor,e=Po(t.model.document.selection);this.isEnabled=!!e&&t.model.schema.checkChild(e,"caption"),this.isEnabled?this.value=!!b1(e):this.value=!1}execute({focusCaptionOnShow:t=!1}={}){this.editor.model.change(e=>{this.value?this._hideTableCaption(e):this._showTableCaption(e,t)})}_showTableCaption(t,e){const i=this.editor.model,n=Po(i.document.selection),l=this.editor.plugins.get("TableCaptionEditing")._getSavedCaption(n)||t.createElement("caption");i.insertContent(l,n,"end"),e&&t.setSelection(l,"in")}_hideTableCaption(t){const e=this.editor.model,i=Po(e.document.selection),n=this.editor.plugins.get("TableCaptionEditing"),r=b1(i);n._saveCaption(i,r),e.deleteContent(t.createSelection(r,"on"))}}class Ste extends F{constructor(e){super(e);p(this,"_savedCaptionsMap");this._savedCaptionsMap=new WeakMap}static get pluginName(){return"TableCaptionEditing"}static get isOfficialPlugin(){return!0}init(){const e=this.editor,i=e.model.schema,n=e.editing.view,r=e.t;i.isRegistered("caption")?i.extend("caption",{allowIn:"table"}):i.register("caption",{allowIn:"table",allowContentOf:"$block",isLimit:!0}),e.commands.add("toggleTableCaption",new kte(this.editor)),e.conversion.for("upcast").elementToElement({view:_te,model:"caption"}),e.conversion.for("dataDowncast").elementToElement({model:"caption",view:(o,{writer:l})=>pP(o.parent)?l.createContainerElement("figcaption"):null}),e.conversion.for("editingDowncast").elementToElement({model:"caption",view:(o,{writer:l})=>{if(!pP(o.parent))return null;const a=l.createEditableElement("figcaption");return l.setCustomProperty("tableCaption",!0,a),a.placeholder=r("Enter table caption"),FO({view:n,element:a,keepOnFocus:!0}),gy(a,l)}}),Ote(e.model)}_getSavedCaption(e){const i=this._savedCaptionsMap.get(e);return i?Mt.fromJSON(i):null}_saveCaption(e,i){this._savedCaptionsMap.set(e,i.toJSON())}}class Cte extends F{static get pluginName(){return"TableCaptionUI"}static get isOfficialPlugin(){return!0}init(){const t=this.editor,e=t.editing.view,i=t.t;t.ui.componentFactory.add("toggleTableCaption",n=>{const r=t.commands.get("toggleTableCaption"),o=new ye(n);return o.set({icon:GA,tooltip:!0,isToggleable:!0}),o.bind("isOn","isEnabled").to(r,"value","isEnabled"),o.bind("label").to(r,"value",l=>i(l?"Toggle caption off":"Toggle caption on")),this.listenTo(o,"execute",()=>{if(t.execute("toggleTableCaption",{focusCaptionOnShow:!0}),r.value){const l=vte(t.model.document.selection),a=t.editing.mapper.toViewElement(l);if(!a)return;e.scrollToTheSelection(),e.change(c=>{c.addClass("table__caption_highlighted",a)})}t.editing.view.focus()}),o})}}class Pte extends F{static get pluginName(){return"TableCaption"}static get isOfficialPlugin(){return!0}static get requires(){return[Ste,Cte]}}const O1="_ungrouppedCommands";function Zm(s,t){const e=(0,t.t)("Other");return s.length?"groupId"in s[0]?s:[{groupId:O1,groupLabel:e,order:1/0,commands:s}]:[{groupId:O1,groupLabel:e,order:1/0,commands:[]}]}const Tte=globalThis.DataTransfer,Bu="ai-ui";let Ju=class extends F{static get pluginName(){return"AIAssistantEditing"}static get isOfficialPlugin(){return!0}static get isPremiumPlugin(){return!0}init(){const{editor:t}=this,e=["ck-fake-ai-selection"];t.config.get("ai.useTheme")&&e.push("ck-ai-assistant-ui_theme"),t.conversion.for("editingDowncast").markerToHighlight({model:Bu,view:{classes:e,priority:12}}),t.conversion.for("editingDowncast").markerToElement({model:Bu,view:(i,{writer:n})=>{if(!i.markerRange.isCollapsed)return null;const r=n.createUIElement("span");return n.addClass(["ck-fake-ai-selection","ck-fake-ai-selection_collapsed"],r),r}})}afterInit(){(async function(t){const e=b([57,114,88,50,65,48,102,69,86,54,73,77,121,115,110,49,53,109,122,113,104,103,52,89,118,111,75,51,82,99,80,84,101,76,67,81,119,120,71,116,55,85,98,79,87,105,72,74,107,66,56,97,117,78,68,106,112,108,90,70,100,83]),i=329962326,n=330152190^i,r=window[b([68,97,116,101])][b([110,111,119])](),o=t[b([101,100,105,116,111,114])],l=new window[b([80,114,111,109,105,115,101])](I=>{o[b([111,110,99,101])](b([114,101,97,100,121]),I)}),a={[b([107,116,121])]:b([69,67]),[b([117,115,101])]:b([115,105,103]),[b([99,114,118])]:b([80,45,50,53,54]),[b([120])]:b([105,67,106,79,67,118,68,70,73,54,108,81,72,72,84,49,56,106,86,119,82,102,107,102,72,81,50,97,95,77,121,109,84,51,53,76,81,86,111,70,83,65,73]),[b([121])]:b([107,88,73,121,74,52,101,118,116,67,69,70,82,109,120,75,83,85,112,75,57,102,68,87,52,53,57,118,88,79,118,86,114,104,102,54,117,81,65,101,79,105,111]),[b([97,108,103])]:b([69,83,50,53,54])},c=o[b([99,111,110,102,105,103])][b([103,101,116])](b([108,105,99,101,110,115,101,75,101,121]));async function h(){let I,B=null,j=null;try{return c==b([71,80,76])?b([78,111,116,65,108,108,111,119,101,100]):(I=k(),I?(I[b([117,115,97,103,101,69,110,100,112,111,105,110,116])]&&(j=f(I[b([117,115,97,103,101,69,110,100,112,111,105,110,116])],I[b([106,116,105])])),await C()?H()?W()?b([69,120,112,105,114,101,100]):te()?(I[b([108,105,99,101,110,115,101,84,121,112,101])]==b([101,118,97,108,117,97,116,105,111,110])&&(B=m(b([69,118,97,108,117,97,116,105,111,110,76,105,109,105,116]))),I[b([108,105,99,101,110,115,101,84,121,112,101])]==b([116,114,105,97,108])&&(B=m(b([84,114,105,97,108,76,105,109,105,116]))),await de()):b([68,111,109,97,105,110,76,105,109,105,116]):b([78,111,116,65,108,108,111,119,101,100]):b([73,110,118,97,108,105,100])):b([73,110,118,97,108,105,100]))}catch{return b([73,110,118,97,108,105,100])}function W(){const oe=[b([101,118,97,108,117,97,116,105,111,110]),b([116,114,105,97,108])][b([105,110,99,108,117,100,101,115])](I[b([108,105,99,101,110,115,101,84,121,112,101])])?r/1e3:3600*n;return I[b([101,120,112])]<oe}function H(){const oe=I[b([102,101,97,116,117,114,101,115])];return!!oe&&(!!oe[b([105,110,99,108,117,100,101,115])](b([42]))||!!oe[b([105,110,99,108,117,100,101,115])](b([65,73])))}function te(){const oe=I[b([108,105,99,101,110,115,101,100,72,111,115,116,115])];if(!oe||oe[b([108,101,110,103,116,104])]==0)return!0;const{hostname:ve}=new URL(window[b([108,111,99,97,116,105,111,110])].href);if(oe[b([105,110,99,108,117,100,101,115])](ve))return!0;const Z=ve[b([115,112,108,105,116])](b([46]));return oe[b([102,105,108,116,101,114])](Y=>Y[b([105,110,99,108,117,100,101,115])](b([42])))[b([109,97,112])](Y=>Y[b([115,112,108,105,116])](b([46])))[b([102,105,108,116,101,114])](Y=>Y[b([108,101,110,103,116,104])]<=Z[b([108,101,110,103,116,104])])[b([109,97,112])](Y=>Array(Z[b([108,101,110,103,116,104])]-Y[b([108,101,110,103,116,104])])[b([102,105,108,108])](Y[0]===b([42])?b([42]):"")[b([99,111,110,99,97,116])](Y))[b([115,111,109,101])](Y=>Z[b([101,118,101,114,121])]((ie,V)=>Y[V]===ie||Y[V]===b([42])))}function de(){return B&&j?new window[b([80,114,111,109,105,115,101])]((oe,ve)=>{B[b([116,104,101,110])](oe,ve),j[b([116,104,101,110])](Z=>{Z!=b([86,97,108,105,100])&&oe(Z)},ve)}):B||j||b([86,97,108,105,100])}}function f(I,B){return new window[b([80,114,111,109,105,115,101])](H=>{if(j())return H(b([86,97,108,105,100]));W(),o[b([100,101,99,111,114,97,116,101])](b([95,115,101,110,100,85,115,97,103,101,82,101,113,117,101,115,116]));let te=!1;const de=ei();function oe(Z){return!!Z&&(typeof Z===b([111,98,106,101,99,116])||typeof Z===b([102,117,110,99,116,105,111,110]))&&typeof Z[b([116,104,101,110])]===b([102,117,110,99,116,105,111,110])&&typeof Z[b([99,97,116,99,104])]===b([102,117,110,99,116,105,111,110])}function ve(Z){J(Z)[b([116,104,101,110])](ae=>!ae||ae[b([115,116,97,116,117,115])]!=b([111,107])?b([85,115,97,103,101,76,105,109,105,116]):N(Q(de+B))!=ae[b([118,101,114,105,102,105,99,97,116,105,111,110])]?b([85,115,97,103,101,76,105,109,105,116]):b([86,97,108,105,100]))[b([116,104,101,110])](ae=>(ie(),ae),()=>{const ae=V();return ae==null?(ie(),b([86,97,108,105,100])):b(r-ae>(933648214^i)?[85,115,97,103,101,76,105,109,105,116]:[86,97,108,105,100])})[b([116,104,101,110])](H)[b([99,97,116,99,104])](()=>{H(b([85,115,97,103,101,76,105,109,105,116]))});const Y=329006550^i;function ie(){const ae=b([108,108,99,116,45])+N(Q(I)),U=G(N(window[b([77,97,116,104])][b([99,101,105,108])](r/Y)));window[b([108,111,99,97,108,83,116,111,114,97,103,101])][b([115,101,116,73,116,101,109])](ae,U)}function V(){const ae=b([108,108,99,116,45])+N(Q(I)),U=window[b([108,111,99,97,108,83,116,111,114,97,103,101])][b([103,101,116,73,116,101,109])](ae);return U?window[b([112,97,114,115,101,73,110,116])](G(U),16)*Y:null}function J(ae){return new window[b([80,114,111,109,105,115,101])]((U,$)=>{ae[b([116,104,101,110])](U,$),window[b([115,101,116,84,105,109,101,111,117,116])]($,329975702^i)})}}o[b([111,110])](b([95,115,101,110,100,85,115,97,103,101,82,101,113,117,101,115,116]),(Z,Y)=>{if(Y[0]!=I)return H(b([85,115,97,103,101,76,105,109,105,116]));Y[1]={...Y[1],[b([114,101,113,117,101,115,116,73,100])]:de}},{[b([112,114,105,111,114,105,116,121])]:b([104,105,103,104])}),o[b([111,110])](b([95,115,101,110,100,85,115,97,103,101,82,101,113,117,101,115,116]),Z=>{oe(Z[b([114,101,116,117,114,110])])&&(te=!0,ve(Z[b([114,101,116,117,114,110])]))},{[b([112,114,105,111,114,105,116,121])]:b([108,111,119])}),l[b([116,104,101,110])](()=>{te||H(b([85,115,97,103,101,76,105,109,105,116]))})});function j(){return o[b([101,100,105,116,105,110,103])][b([118,105,101,119])][b([95,111,118,101,114,108,97,121,77,111,100,101,72,105,110,116])]==b([97,117,116,111])}function W(){o[b([101,100,105,116,105,110,103])][b([118,105,101,119])][b([95,111,118,101,114,108,97,121,77,111,100,101,72,105,110,116])]=b([97,117,116,111])}}function m(I){const B=[new window[b([80,114,111,109,105,115,101])](j=>setTimeout(j,329510298^i)),l[b([116,104,101,110])](()=>new window[b([80,114,111,109,105,115,101])](j=>{let W=0;o[b([109,111,100,101,108])][b([111,110])](b([97,112,112,108,121,79,112,101,114,97,116,105,111,110]),(H,te)=>{te[0][b([105,115,68,111,99,117,109,101,110,116,79,112,101,114,97,116,105,111,110])]&&W++,W==(329962158^i)&&(j(),H[b([111,102,102])]())})}))];return window[b([80,114,111,109,105,115,101])][b([114,97,99,101])](B)[b([116,104,101,110])](()=>I)}async function w(){await l,o[b([109,111,100,101,108])][b([99,104,97,110,103,101])]=D,o[b([109,111,100,101,108])][b([101,110,113,117,101,117,101,67,104,97,110,103,101])]=D,o[b([101,110,97,98,108,101,82,101,97,100,79,110,108,121,77,111,100,101])](b([109,111,100,101,108]))}function O(I){const B=_();o[B]=b([97,105,76,105,99,101,110,115,101,75,101,121])+I,I!=b([86,97,108,105,100])&&w()}function _(){const I=window[b([83,116,114,105,110,103])](window[b([112,101,114,102,111,114,109,97,110,99,101])][b([110,111,119])]())[b([114,101,112,108,97,99,101])](b([46]),"");let B=b([114]);for(let j=0;j<I[b([108,101,110,103,116,104])];j+=2){let W=window[b([112,97,114,115,101,73,110,116])](I[b([115,117,98,115,116,114,105,110,103])](j,j+2));W>=e[b([108,101,110,103,116,104])]&&(W-=e[b([108,101,110,103,116,104])]),B+=e[W]}return B}function k(){const I=c[b([115,112,108,105,116])](b([46]));if(I[b([108,101,110,103,116,104])]!=3)return null;return B(I[1]);function B(j){const W=P(j);return W&&H()?W:null;function H(){const te=W[b([106,116,105])],de=window[b([112,97,114,115,101,73,110,116])](te[b([115,117,98,115,116,114,105,110,103])](te[b([108,101,110,103,116,104])]-8),16),oe={...W,[b([106,116,105])]:te[b([115,117,98,115,116,114,105,110,103])](0,te[b([108,101,110,103,116,104])]-8)};return delete oe[b([118,99])],Q(oe)==de}}}async function C(){let I=!0;try{const W=c[b([115,112,108,105,116])](b([46])),[H,te,de]=W;return B(H),await j(H,te,de),I}catch{return!1}function B(W){const H=P(W);H&&H[b([97,108,103])]==b([69,83,50,53,54])||(I=!1)}async function j(W,H,te){const de=window[b([85,105,110,116,56,65,114,114,97,121])][b([102,114,111,109])](M(te),Y=>Y[b([99,104,97,114,67,111,100,101,65,116])](0)),oe=new window[b([84,101,120,116,69,110,99,111,100,101,114])]()[b([101,110,99,111,100,101])](W+b([46])+H),ve=window[b([99,114,121,112,116,111])][b([115,117,98,116,108,101])];if(!ve)return;const Z=await ve[b([105,109,112,111,114,116,75,101,121])](b([106,119,107]),a,{[b([110,97,109,101])]:b([69,67,68,83,65]),[b([110,97,109,101,100,67,117,114,118,101])]:b([80,45,50,53,54])},!1,[b([118,101,114,105,102,121])]);await ve[b([118,101,114,105,102,121])]({[b([110,97,109,101])]:b([69,67,68,83,65]),[b([104,97,115,104])]:{[b([110,97,109,101])]:b([83,72,65,45,50,53,54])}},Z,de,oe)||(I=!1)}}function P(I){return I[b([115,116,97,114,116,115,87,105,116,104])](b([101,121]))?JSON[b([112,97,114,115,101])](M(I)):null}function M(I){return window[b([97,116,111,98])](I[b([114,101,112,108,97,99,101])](/-/g,b([43]))[b([114,101,112,108,97,99,101])](/_/g,b([47])))}function Q(I){let B=5381;function j(H){for(let te=0;te<H[b([108,101,110,103,116,104])];te++){const de=H[b([99,104,97,114,67,111,100,101,65,116])](te);B=(B<<5)+B+de,B&=B}}function W(H){Array[b([105,115,65,114,114,97,121])](H)?H[b([102,111,114,69,97,99,104])](W):H&&typeof H==b([111,98,106,101,99,116])?Object[b([101,110,116,114,105,101,115])](H)[b([115,111,114,116])]()[b([102,111,114,69,97,99,104])](([te,de])=>{j(te),W(de)}):j(window[b([83,116,114,105,110,103])](H))}return W(I),B>>>0}function N(I){return I[b([116,111,83,116,114,105,110,103])](16)[b([112,97,100,83,116,97,114,116])](8,b([48]))}function G(I){return I[b([115,112,108,105,116])]("")[b([114,101,118,101,114,115,101])]()[b([106,111,105,110])]("")}function D(){}function b(I){return I.map(B=>String.fromCharCode(B)).join("")}O(await h())})(this)}showFakeVisualSelection(){const t=this.editor.model;t.change(e=>{const i=t.document.selection.getRanges();let n=0;for(const r of i){const o=Bu+":"+n;if(t.markers.has(o))e.updateMarker(o,{range:r});else if(r.start.isAtEnd){const l=r.start.getLastMatchingPosition(({item:a})=>!t.schema.isContent(a),{boundaries:r});e.addMarker(o,{usingOperation:!1,affectsData:!1,range:e.createRange(l,r.end)})}else e.addMarker(o,{usingOperation:!1,affectsData:!1,range:r});n++}})}hideFakeVisualSelection(){const t=this.editor.model,e=Array.from(this.editor.model.markers.getMarkersGroup(Bu));e.length&&t.change(i=>{e.forEach(n=>{i.removeMarker(n)})})}insertContent(t,e){const i=this._getAISelection(),n=e||i.getFirstRange();this.editor.model.canEditAt(n)&&this.editor.model.change(r=>{this.hideFakeVisualSelection(),e||this._resetContentOfSelectedTableCells(r,i),this._pasteHTMLUsingClipboard({insertAt:n,writer:r,html:t})})}insertContentBelow(t){const{model:e}=this.editor,i=this._getAISelection();e.change(()=>{const n=this._prepareTableInsertBelowPosition(t,i)||this._getDefaultInsertBelowPosition(i);this.insertContent(t,n)})}_getAISelection(){const t=this.editor.model,e=Array.from(t.markers.getMarkersGroup(Bu)).map(i=>i.getRange());return t.createSelection(e)}_pasteHTMLUsingClipboard({writer:t,html:e,insertAt:i}){const{view:n}=this.editor.editing,r=this.editor.plugins.get(on),o=new Tte;o.setData("text/html",e);const l=new ClipboardEvent("paste",{clipboardData:o}),a=new $r(n,l,{dataTransfer:new Cp(o)});t.setSelection(i);const c=(h,f)=>{f.resultRange&&t.setSelection(f.resultRange)};r.once("contentInsertion",c,{priority:"lowest"}),n.document.fire("paste",a),r.off("contentInsertion",c)}_getDefaultInsertBelowPosition(t){const{model:e}=this.editor,i=Array.from(t.getSelectedBlocks());return i.length?e.createPositionAfter(i.pop()):t.getLastPosition()}_prepareTableInsertBelowPosition(t,e){const{model:i,plugins:n}=this.editor;if(n.has("TableUtils")){const r=n.get("TableUtils").getSelectedTableCells(e);if(r.length){const o=this._getTableRowCountFromContent(t),l=this._createEmptyTableRows(r,o);return i.createPositionAt(l,0)}}return null}_getTableRowCountFromContent(t){const e=this.editor.plugins.get("TableUtils"),i=this.editor.data.parse(t),n=Array.from(i.getChildren()).filter(o=>o.is("element","table"));let r=0;return n.forEach(o=>{r+=e.getRows(o)}),r}_createEmptyTableRows(t,e){const i=this.editor.plugins.get("TableUtils"),n=i.getRowIndexes(t),r=i.getColumnIndexes(t),o=n.last+1,l=r.first,a=t[0].findAncestor("table");for(let c=0;c<e;c++)i.insertRows(a,{at:o});return a.getChild(o).getChild(l)}_resetContentOfSelectedTableCells(t,e){const{plugins:i}=this.editor,{model:n}=t;i.has("TableUtils")&&i.get("TableUtils").getSelectedTableCells(e).length&&n.deleteContent(e)}},zg=class extends F{static get pluginName(){return"AIAdapter"}static get isOfficialPlugin(){return!0}static get isPremiumPlugin(){return!0}afterInit(){if(!this.textAdapter)throw new E("aiadapter-text-adapter-not-set",null)}};class rc extends Error{constructor(t){super(t),this.name="AIRequestError"}}function Le(s,t,e){const i=s.t;switch(t){case"Edit or review":return i("Edit or review");case"Improve writing":return i("Improve writing");case"Make shorter":return i("Make shorter");case"Make longer":return i("Make longer");case"Simplify language":return i("Simplify language");case"Generate from selection":return i("Generate from selection");case"Summarize":return i("Summarize");case"Continue":return i("Continue");case"Change tone":return i("Change tone");case"Professional":return i("Professional");case"Casual":return i("Casual");case"Direct":return i("Direct");case"Confident":return i("Confident");case"Friendly":return i("Friendly");case"Change style":return i("Change style");case"Business":return i("Business");case"Legal":return i("Legal");case"Journalism":return i("Journalism");case"Poetic":return i("Poetic");case"Translate":return i("Translate");case"English":return i("English");case"Spanish":return i("Spanish");case"German":return i("German");case"Portuguese":return i("Portuguese");case"French":return i("French");case"Simplified Chinese":return i("Simplified Chinese");case"Hindi":return i("Hindi");case"Arabic":return i("Arabic");case"AI Assistant":return i("AI Assistant");case"AI Commands":return i("AI Commands");case"Ask AI to edit or generate":return i("Ask AI to edit or generate");case"Ask AI to improve generated text":return i("Ask AI to improve generated text");case"Copy":return i("Copy");case"Submit":return i("Submit");case"Insert below":return i("Insert below");case"Try again":return i("Try again");case"Stop":return i("Stop");case"AI is writing...":return i("AI is writing...");case"AI is writing":return i("AI is writing");case"Generated content: %0":return i("Generated content: %0",e);case"Error during AI content generation: %0":return i("Error during AI content generation: %0",e);case"History":return i("History");case"Empty history":return i("Empty history");case"Ask AI and your prompts will be listed here for you to use later.":return i("Ask AI and your prompts will be listed here for you to use later.");case"Prompt history":return i("Prompt history");case"Clear":return i("Clear");case"AI_REPLACE_CONTENT":return i({id:"AI_REPLACE_CONTENT",string:"Replace"});case"AI_INSERT_CONTENT":return i({id:"AI_INSERT_CONTENT",string:"Insert"});case"AI_ERROR_GET_HEADERS":return i({id:"AI_ERROR_GET_HEADERS",string:"Preparing request headers failed"});case"AI_ERROR_GET_PARAMETERS":return i({id:"AI_ERROR_GET_PARAMETERS",string:"Preparing request parameters failed"});case"AI_ERROR_UNSUPPORTED_MODEL":return i({id:"AI_ERROR_UNSUPPORTED_MODEL",string:'The requested AI model ("%0") is not supported'},e);case"AI_ERROR_CONTEXT_LENGTH":return i({id:"AI_ERROR_CONTEXT_LENGTH",string:"Selected content is too long"});case"AI_ERROR_MODERATION":return i({id:"AI_ERROR_MODERATION",string:"Requested query does not pass moderation rules"});case"AI_ERROR_FAILED":return i({id:"AI_ERROR_FAILED",string:"Failed to communicate with the AI service"});default:return t}}class Ete extends Be{constructor(e,i){super(e);p(this,"_commandDefinitions");this._commandDefinitions=i,this.set("enabledCommandsIds",[]),this.on("change:_hasContext",(n,r,o)=>{this.isEnabled&&(this.enabledCommandsIds=wP(this._commandDefinitions,o))}),this.set("_hasContext",!1),this.on("change:isEnabled",(n,r,o)=>{this.enabledCommandsIds=o?wP(this._commandDefinitions,this._hasContext):[]})}refresh(){const e=this.editor.model;this._hasContext=function(r){const o=r.document.selection;return o.isCollapsed?[...o.getSelectedBlocks()].length!==0&&![...o.getSelectedBlocks()][0].isEmpty:!!r.hasContent(o.getFirstRange())}(e);const i=e.document.selection,n=this.editor.config.get("ai.aiAssistant.disabledElements");for(const r of i.getRanges())for(const o of r.getItems())if(o.is("element")&&n.includes(o.name))return void(this.isEnabled=!1);this.isEnabled=!0}execute(e="",i="",n="custom"){this.editor.plugins.get(L4).showUI(e,i,n)}}function wP(s,t){const e=new Set;for(const i of s.values())(t||i.requiresContent===!1)&&e.add(i.id);return Array.from(e)}const Ate=new RegExp(/^(.*?)<[a-zA-Z][a-zA-Z0-9_\-.]*[ >]/,"is");let Ite=class extends at(){constructor(e,i,n){super();p(this,"editor");p(this,"textAdapter");p(this,"view");p(this,"_sanitizationContainer");p(this,"_domParser");p(this,"_xmlSerializer");this.editor=e,this.textAdapter=i,this._sanitizationContainer=document.createElement("div"),this._domParser=new DOMParser,this._xmlSerializer=new XMLSerializer,this.view=n,this.set({initialContext:"",currentContext:"",currentResponse:"",previousContext:void 0,previousQuery:void 0,previousLabel:void 0,isProcessing:!1}),this.on("set:currentContext",(r,o,l)=>{this.view.value=this._sanitizeHTML(l)}),this.listenTo(this.view,"submitPrompt",(r,o)=>{const l=this.currentContext||this.initialContext;this._handleQuery(o,l,"custom")}),this.listenTo(this.view,"tryAgainEvent",()=>{this.view.prompt=this.previousLabel,this._handleQuery(this.previousQuery,this.previousContext,this.previousActionId,this.previousLabel)}),this.listenTo(this.view,"stopProcessing",()=>{this.stopProcessing()})}destroy(){this.stopListening()}async updateView({actionId:e,query:i,htmlContent:n,label:r,mainActionLabel:o}){this.view.prompt=r,this.view.mainAction=o,this.initialContext=n,i&&(this.view.isRendered?this._handleQuery(i,n,e,r):this.view.once("render",()=>{this._handleQuery(i,n,e,r)}))}stopProcessing(){this.isProcessing&&(this.isProcessing=!1,this.view.finishProcessing(),this.textAdapter.abort())}reset(){this.initialContext="",this.currentContext="",this.currentResponse="",this.previousContext="",this.previousQuery="",this.previousLabel="",this.previousActionId=void 0,this.view.reset(),this.stopProcessing()}async _handleQuery(e,i,n,r){return this.isProcessing=!0,this.view.startProcessing(),this.previousContext=i,this.previousQuery=e,this.previousLabel=r||e,this.previousActionId=n,new Promise(o=>{this.textAdapter.makeRequest({query:e,context:i,onData:l=>{this.currentResponse=l,this.currentContext=this._parseAndNormalizeContent(this.currentResponse)},actionId:n}).then(()=>{!this.currentContext&&this.currentResponse&&(this.currentContext=this._parseAndNormalizeContent(this.currentResponse,!0))}).catch(l=>{l instanceof rc?this.view.handleError(l.message):this.view.handleError(),o()}).finally(()=>{this.stopProcessing(),o()})})}_parseAndNormalizeContent(e,i=!1){const n=Ate.exec(e);e=n?e.substring(n[1].length):e.length<100&&!i?"":this._stripMarkdownSyntax(e);const r=this._domParser.parseFromString(e,"text/html");if(n){const c=Array.from(r.body.childNodes);c.reverse();for(const h of c){if(h.nodeType==Node.ELEMENT_NODE)break;h.remove()}}const o=this.editor.data.processor.toView(this._xmlSerializer.serializeToString(r.body));this._isH1TagSupportEnabled()||this._normalizeResponseHeadings(o);const l=this.editor.config.get("ai.aiAssistant.preserveComments"),a=this.editor.data.toModel(o);return l||a.markers.clear(),this.editor.data.stringify(a)}_normalizeResponseHeadings(e){const i=new Cn(this.editor.editing.view.document),n=new kn({name:/^h[1-5]$/}),r=[];let o=!1;for(const l of e)l.is("element")&&n.match(l)&&(r.push(l),l.name=="h1"&&(o=!0));if(o)for(const l of r)i.rename("h"+(parseInt(l.name[1])+1),l)}_isH1TagSupportEnabled(){const{data:e,editing:i}=this.editor,n=e.htmlProcessor.toView("<h1></h1>"),r=e.toView(e.toModel(n));return!!i.view.domConverter.viewToDom(r).querySelector("h1")}_sanitizeHTML(e){return this.editor.editing.view.domConverter.setContentOf(this._sanitizationContainer,e),this._sanitizationContainer.innerHTML}_stripMarkdownSyntax(e){const i=e.trim();return i.startsWith("```html")?i.endsWith("```")?i.substring(7,i.length-3):i.substring(7):e}};const Dy={REPLACE:"replace",INSERT:"insert"};let Rte=class extends Vo{constructor(t){super(t),this.set("isVisible",!1),this.set("mainAction",Dy.REPLACE),this.replaceButton=this._createButton("","ck-button-action"),this.replaceButton.bind("label").to(this,"mainAction",i=>Le(t,"AI_"+i.toUpperCase()+"_CONTENT")),this.insertButton=this._createButton(Le(t,"Insert below")),this.tryAgainButton=this._createButton(Le(t,"Try again")),this.stopButton=this._createButton(Le(t,"Stop"));const e=this.bindTemplate;this.extendTemplate({attributes:{class:["ck-ai-form__toolbar",e.if("isVisible","ck-hidden",i=>!i)]}}),this.items.addMany([this.replaceButton,this.insertButton,this.tryAgainButton,this.stopButton])}_createButton(t,e){const i=new ye(this.locale);return i.set({label:t,class:e||"",isVisible:!0,withText:!0}),i}};class Vte extends ue{constructor(e,i=""){super(e);p(this,"contentFieldView");p(this,"copyButtonView");this.set({value:null,isVisible:!1,isProcessing:!1});const n=this.bindTemplate;this.contentFieldView=new Mte(e,i),this.copyButtonView=this._createCopyButton(),this.setTemplate({tag:"div",attributes:{class:["ck","ck-ai-form__content-area-wrapper",n.if("isVisible","ck-hidden",r=>!r)],tabindex:"-1"},children:[{tag:"div",attributes:{class:["ck","ck-ai-form__content-area",n.if("isProcessing","ck-ai-form__content-area--processing")]},children:[this.contentFieldView,{tag:"div",attributes:{class:["ck","ck-ai-form__copy-button-wrapper"]},children:[this.copyButtonView]}]}]})}render(){super.render(),this.value&&this.contentFieldView.setContent(this.value);let e=!1;this.on("change:value",(i,n,r)=>{const o=!this.contentFieldView.element.querySelector(".ck-ai-form__loader");this.contentFieldView.setContent(r),this.isProcessing&&o&&!e&&this.element.scrollTo({top:this.element.scrollHeight,behavior:"smooth"})}),this.on("change:isProcessing",(i,n,r)=>{e=!1,r?(this.value=null,this.contentFieldView.appendLoader()):this.value||this.contentFieldView.setContent("")}),this.listenTo(this.element,"wheel",()=>{e=!0}),this.listenTo(this.element,"mousedown",()=>{e=!0})}focus(){this.element.focus()}_createCopyButton(){const e=this.locale,i=new ye(this.locale),n="ck-ai-form__copy-button";return i.set({label:Le(e,"Copy"),icon:BC,class:n,tooltip:!0}),i.bind("isVisible").to(this,"value",r=>!!r),i.bind("isEnabled").to(this,"isProcessing",r=>!r),i.on("execute",()=>{this._copyHTMLToClipboard(this.contentFieldView.element),i.icon=Ic,i.class=n+" ck-ai-form__copy-button--copied",this.focus(),setTimeout(()=>{i.icon=BC,i.class=n},1e3)}),i}_copyHTMLToClipboard(e){const{window:i,document:n}=he;if(i.ClipboardItem){const{Blob:r,ClipboardItem:o}=i,l=[new o({"text/html":new r([e.innerHTML],{type:"text/html"}),"text/plain":new r([e.textContent||""],{type:"text/plain"})})];navigator.clipboard.write(l)}else{const r=n.createElement("div");r.style.position="absolute",r.style.left="-9999px",r.innerHTML="<span>[</span>"+e.innerHTML+"<span>]</span>",n.body.appendChild(r);const o=n.createRange();o.setStartAfter(r.firstElementChild),o.setEndBefore(r.lastElementChild);const l=i.getSelection();l.removeAllRanges(),l.addRange(o),n.execCommand("copy"),r.remove()}}}class Mte extends ue{constructor(t,e=""){super(t),this.loaderView=this._createLoader(),this.setTemplate({tag:"div",attributes:{class:["ck","ck-content",e,"ck-reset_all-excluded","ck-ai-form__content-field"]}})}setContent(t){this.element.innerHTML=t}appendLoader(){this.element.appendChild(this.loaderView.element)}_createLoader(){const t=new ue,e=this.locale,i=new XU;return i.isVisible=!0,t.setTemplate({tag:"div",attributes:{class:["ck","ck-ai-form__loader"]},children:[i,{text:Le(e,"AI is writing...")}]}),t.render(),t}}class Lte extends ue{constructor(t,e=""){super(t);const i=new Zn,n=this.bindTemplate;this.set("text",e),i.content=iz,this.setTemplate({tag:"div",attributes:{class:["ck","ck-ai-form__error"]},children:[i,{text:n.to("text")}]})}}class Bte extends jb{constructor(e,i){super(e,i);p(this,"submitButtonView");p(this,"showHistoryButtonView");this.queryView.fieldView.minRows=1,this.queryView.fieldView.maxRows=3,this.submitButtonView=this._createSubmitButton(),this.showHistoryButtonView=this._createShowHistoryButton(),this.focusableChildren.add(this.showHistoryButtonView,1),this.focusableChildren.add(this.submitButtonView)}render(){super.render(),this.queryView.fieldWrapperChildren.add(this.showHistoryButtonView),this.children.add(this.submitButtonView),this.keystrokes.set("enter",(e,i)=>{e.target==this.queryView.fieldView.element&&(this.submit(),i())})}_createSubmitButton(){const e=new ye(this.locale),i=this.locale;return e.set({icon:Mz,label:Le(i,"Submit"),isVisible:!0,tooltip:!0,class:"ck-ai-form__submit"}),e.on("execute",()=>{this.submit()}),e.bind("isEnabled").to(this.queryView.fieldView,"isEmpty",this,"isEnabled",(n,r)=>!n&&r),e}_createShowHistoryButton(){const e=new ye(this.locale),i=this.resultsView,n=this.locale;e.set({label:Le(n,"History"),withText:!1,icon:nz,tooltip:!0,tooltipPosition:"sw",class:"ck-ai-form__toggle-history"}),e.bind("isOn").to(i,"isVisible"),e.bind("isEnabled").to(this,"isEnabled"),e.on("execute",()=>{i.isVisible=!i.isVisible,i.isVisible?this.filteredView.focus():this.focus()});const r=()=>{he.window.requestAnimationFrame(()=>{if(Ls(this.element)){const o=new Ve(this.queryView.fieldView.element),l=o.width,a=n.uiLanguageDirection==="rtl"?"left":"right";o.excludeScrollbarsAndBorders(),e.element.style[a]=l-o.width+1+"px"}})};return this.queryView.fieldView.on("update",r),this.on("render",r),e}submit(){const e=this.queryView.fieldView.element.value;this.fire("submit",e)}focus(e){e===-1?this.focusCycler.focusLast():this.focusCycler.focusFirst()}}class $te extends Wr{constructor(e){super(e);p(this,"historyGroupView");p(this,"clearHistoryButton");this.clearHistoryButton=this._createClearHistoryButton(),this.historyGroupView=new fh,this.historyGroupView.children.add(this.clearHistoryButton,1),this.historyGroupView.label=Le(e,"Prompt history"),this.historyGroupView.items.delegate("execute").to(this),this.items.add(this.historyGroupView)}filter(){let e=0;for(const i of this.items)e+=i.items.length;return{resultsCount:e,totalItemsCount:e}}_createClearHistoryButton(){const e=this.locale,i=new ye(this.locale);return i.set({label:"("+Le(e,"Clear")+")",withText:!0}),i.on("execute",()=>this.fire("clearHistory")),i}}class Dte extends Sn{constructor(t){super();const e=new ly,i=new ye(this.locale,e);this.children.add(i),i.set({label:t.prompt,withText:!0}),i.on("execute",()=>{this.fire("execute",{value:X$(t.prompt)})})}}const xP="CKEditor/AIFormView/PromptHistory";class Qte extends di{constructor(){super(),this._loadFromSessionStorage(),this.on("add",(t,e)=>{const i=bP(e.prompt);for(const n of this)if(n!=e&&bP(n.prompt)===i){this.remove(n);break}this.length>20&&this.remove(this.last),this._saveToSessionStorage()}),this.on("remove",()=>{this._saveToSessionStorage()})}_loadFromSessionStorage(){const t=sessionStorage.getItem(xP)||"[]";this.addMany(JSON.parse(t))}_saveToSessionStorage(){sessionStorage.setItem(xP,JSON.stringify(this.map(t=>t)))}}function bP(s){return s.toLowerCase().trim()}class Nte extends ue{constructor(e,i,n=""){super(e);p(this,"focusTracker");p(this,"keystrokes");p(this,"contentArea");p(this,"toolbar");p(this,"promptView");p(this,"errorView");p(this,"_focusables");p(this,"focusCycler");p(this,"_promptHistory");this.set("isEnabled",!0),this.set("isProcessing",!1),this.set("prompt",""),this.set("value",""),this.set("isError",!1),this.set("mainAction",Dy.REPLACE),this._promptHistory=new Qte,this.errorView=new Lte(e),this.contentArea=new Vte(e,n),this.contentArea.bind("isProcessing").to(this),this.contentArea.bind("value").to(this),this.toolbar=this._createToolbar(),this.toolbar.bind("mainAction").to(this),this.promptView=this._createPromptView(),this.focusTracker=new ot,this.keystrokes=new wt,this._focusables=this.createCollection([this.contentArea,this.contentArea.copyButtonView,this.toolbar,this.promptView]),this.focusCycler=new Ht({focusables:this._focusables,focusTracker:this.focusTracker,keystrokeHandler:this.keystrokes,actions:{focusPrevious:"shift + tab",focusNext:"tab"}}),this.focusCycler.chain(this.promptView.focusCycler),this.promptView.queryView.fieldView.bind("value").to(this,"prompt");const r=this.bindTemplate;this.setTemplate({tag:"div",attributes:{class:["ck","ck-ai-form",i],tabindex:"-1"},children:[{tag:"div",attributes:{class:["ck","ck-ai-form-content"]},children:[{tag:"div",attributes:{class:[r.if("isError","ck-hidden",o=>!o)]},children:[this.errorView]},this.contentArea,this.toolbar,this.promptView]}]})}render(){super.render(),this.focusTracker.add(this.contentArea.element),this.focusTracker.add(this.contentArea.copyButtonView.element),this.focusTracker.add(this.toolbar.element),this.focusTracker.add(this.promptView.element),this.keystrokes.listenTo(this.element)}focus(e=1){e===-1?this.focusCycler.focusLast():this.focusCycler.focusFirst()}reset(){this.prompt="",this.value="",this.isError=!1,this.promptView.reset(),this.contentArea.isVisible=!1,this.toolbar.isVisible=!1}_createPromptView(){const e=this.locale,i=new Bte(e,{queryView:{label:Le(e,"Ask AI to edit or generate"),creator:sU,showIcon:!1,showResetButton:!1},infoView:{text:{noSearchableItems:{primary:Le(e,"Empty history"),secondary:Le(e,"Ask AI and your prompts will be listed here for you to use later.")}}},filteredView:this._createHistoryView(),queryMinChars:1/0,resetOnBlur:!1});return i.bind("isEnabled").to(this,"isEnabled",this,"isProcessing",(n,r)=>n&&!r),this.listenTo(i,"submit",(n,r)=>{this.prompt=r;const o=U$(r);this.fire("submitPrompt",o),r.trim()&&this._promptHistory.add({prompt:o},0)},{priority:"high"}),i}_createHistoryView(){const e=new $te(this.locale);return e.historyGroupView.items.bindTo(this._promptHistory).as(Dte),e.on("clearHistory",()=>{this._promptHistory.clear(),this.promptView.search(""),this.promptView.focus()}),e}_createToolbar(){const e=new Rte(this.locale);return e.replaceButton.bind("isEnabled").to(this,"isEnabled",this,"isProcessing",this,"value",(i,n,r)=>i&&!n&&!!r),e.replaceButton.delegate("execute").to(this,"replaceContent"),e.insertButton.bind("isEnabled").to(this,"isEnabled",this,"isProcessing",this,"value",(i,n,r)=>i&&!n&&!!r),e.insertButton.delegate("execute").to(this,"insertContentBelow"),e.tryAgainButton.bind("isEnabled").to(this,"isEnabled",this,"isProcessing",(i,n)=>i&&!n),e.tryAgainButton.delegate("execute").to(this,"tryAgainEvent"),e.stopButton.bind("isEnabled").to(this,"isProcessing"),e.stopButton.delegate("execute").to(this,"stopProcessing"),e}startProcessing(){this.value="",this.isError=!1,this.isProcessing=!0,this.contentArea.isVisible=!0,this.toolbar.isVisible=!0,this.contentArea.focus()}finishProcessing(){const e=this.locale;this.isProcessing=!1,this.prompt="",this.promptView.reset(),this.value&&(this.promptView.queryView.label=Le(e,"Ask AI to improve generated text"))}handleError(e){const i=this.locale;this.finishProcessing(),this.isError=!0,this.errorView.text=e||Le(i,"AI_ERROR_FAILED"),this.value||(this.contentArea.isVisible=!1)}}const Fte=globalThis.DataTransfer;class L4 extends F{constructor(e){super(e);p(this,"licenseKey");p(this,"_licenseKeyCheckInterval");p(this,"_dialog");p(this,"_formView");p(this,"_aiAdapter");p(this,"_aiAssistantController");p(this,"_uiCssClasses","");e.config.define("ai.aiAssistant.disabledElements",["media","rawHtml","tableOfContents"]),e.config.define("ai.aiAssistant.contentAreaCssClass",""),e.config.define("ai.useTheme",!0),this._uiCssClasses="ck-ai-assistant-ui"+(e.config.get("ai.useTheme")?" ck-ai-assistant-ui_theme":"")}static get pluginName(){return"AIAssistantUI"}static get isOfficialPlugin(){return!0}static get isPremiumPlugin(){return!0}static get requires(){return[kl,Ju,zg,Pl]}init(){const{editor:e}=this;this._aiAdapter=e.plugins.get(zg),this._dialog=e.plugins.get(Pl),this._formView=null,this._commandDefinitions=this._getResolvedCommandsDefinitions();const i=new Ete(e,Array.from(this._commandDefinitions.values()));e.commands.add("showAIAssistant",i),e.ui.componentFactory.add("aiCommands",r=>{const o=nn(r);return o.set({class:"ck-ai-commands-dropdown "+this._uiCssClasses}),o.buttonView.set({label:Le(r,"AI Commands"),icon:$C,tooltip:!0}),o.on("execute",a=>this._onExecute(a.source.id)),XW(o,e.ui.view.body,function(a){const c=Zm(a.config.get("ai.aiAssistant.commands"),a.locale),h=$u(a,c).filter(f=>f.commands.length);return h.length===1?$u(a,h[0].commands).map(f=>({id:f.id,label:f.label})):h.map(f=>{const{groupId:m,groupLabel:w,commands:O}=f,_=$u(a,O).map(k=>({id:k.id,label:k.label}));return{id:m,menu:w||m,children:_}})}(e),{ariaLabel:Le(r,"AI Commands")}),o.menuView.menuPanelClass="ck-ai-commands-dropdown "+this._uiCssClasses,i.on("change:enabledCommandsIds",l),o.menuView.once("render",l),o;function l(){o.isEnabled=i.enabledCommandsIds.length>0;for(const a of o.menuView.buttons)a.isEnabled=i.enabledCommandsIds.includes(a.id)}}),e.ui.componentFactory.add("menuBar:aiCommands",r=>{const o=new cs(r);o.buttonView.set({label:Le(r,"AI Commands"),icon:$C}),o.bind("isEnabled").to(i,"enabledCommandsIds",a=>a.length>0);const l=Zm(e.config.get("ai.aiAssistant.commands"),r);return this._populateMenuBarMenu(i,o,l,a=>this._onExecute(a)),o}),e.ui.componentFactory.add("aiAssistant",()=>{const r=this._createAIAssistantUIButton(ye);return r.set({tooltip:!0,class:"ck-ai-assistant-button "+this._uiCssClasses}),r}),e.ui.componentFactory.add("menuBar:aiAssistant",()=>{const r=this._createAIAssistantUIButton(ti);return r.set({role:"menuitemcheckbox"}),r}),this.licenseKey=this.editor.config.get("licenseKey");const n=this.editor;this._licenseKeyCheckInterval=setInterval(()=>{let r;for(const o in n){const l=o,a=n[l];if(a=="aiLicenseKeyValid"||a=="aiLicenseKeyInvalid"||a=="aiLicenseKeyExpired"||a=="aiLicenseKeyDomainLimit"||a=="aiLicenseKeyNotAllowed"||a=="aiLicenseKeyEvaluationLimit"||a=="aiLicenseKeyTrialLimit"||a=="aiLicenseKeyUsageLimit"){delete n[l],r=a,clearInterval(this._licenseKeyCheckInterval),this._licenseKeyCheckInterval=void 0;break}}r=="aiLicenseKeyInvalid"&&n._showLicenseError("invalid"),r=="aiLicenseKeyExpired"&&n._showLicenseError("expired"),r=="aiLicenseKeyDomainLimit"&&n._showLicenseError("domainLimit"),r=="aiLicenseKeyNotAllowed"&&n._showLicenseError("featureNotAllowed","AIAssistant"),r=="aiLicenseKeyEvaluationLimit"&&n._showLicenseError("evaluationLimit"),r=="aiLicenseKeyTrialLimit"&&n._showLicenseError("trialLimit"),r=="aiLicenseKeyUsageLimit"&&n._showLicenseError("usageLimit")},1e3)}destroy(){super.destroy(),this._licenseKeyCheckInterval&&clearInterval(this._licenseKeyCheckInterval)}showUI(e="",i="",n="custom"){const r=this.editor,o=r.editing.view,l=r.plugins.get(Ju),a=r.plugins.get(kl);l.showFakeVisualSelection();const c=new Fte,h=new ClipboardEvent("copy",{clipboardData:c}),f=new Cp(c),m=new $r(o,h,{dataTransfer:f});a._forceMarkersCopy("comment",()=>{o.document.fire("copy",m)}),this._formView||(this._initView(),this._aiAssistantController=new Ite(r,this._aiAdapter.textAdapter,this._formView));let w=f.getData("text/html");const O=r.model.document.selection,_=Array.from(O.getRanges());_.length===1&&_[0].isFlat&&!O.getSelectedElement()&&w.replace(/&nbsp;/g,"").trim()!==""&&(w="<p>"+w+"</p>"),this._aiAssistantController.updateView({actionId:n,query:e,htmlContent:w,label:i,mainActionLabel:Dy[r.model.document.selection.isCollapsed?"INSERT":"REPLACE"]}),this._dialog.id!=="aiAssistant"?this._dialog.show({id:"aiAssistant",icon:QC,title:Le(this.editor.locale,"AI Assistant"),content:this._formView,position:ts.EDITOR_TOP_SIDE,onShow:()=>{this._formView.focus()},onHide:()=>{this._aiAssistantController.reset(),l.hideFakeVisualSelection()}}):this._dialog.view.wasMoved||this._dialog.view.updatePosition()}hideUI(){this._dialog.hide()}_getResolvedCommandsDefinitions(){const e=new Map,i=Zm(this.editor.config.get("ai.aiAssistant.commands"),this.editor.locale);for(const n of i)for(const r of n.commands)e.set(r.id,{...r,groupId:n.groupId,groupLabel:n.groupLabel||n.groupId});return e}_createAIAssistantUIButton(e){const i=this.editor,n=i.commands.get("showAIAssistant"),r=new e(i.locale);return r.set({label:Le(i.locale,"AI Assistant"),icon:QC,isToggleable:!0}),r.bind("isEnabled").to(n),r.bind("isOn").to(this._dialog,"id",o=>o==="aiAssistant"),this.listenTo(r,"execute",()=>{r.isOn?this.hideUI():n.execute()}),r}_initView(){const e=this.editor.plugins.get(Ju);this._formView=new Nte(this.editor.locale,this._uiCssClasses,this.editor.config.get("ai.aiAssistant.contentAreaCssClass")),this._formView.on("change:value",()=>{this._dialog.view.wasMoved||this._dialog.view.updatePosition()}),this._formView.promptView.queryView.fieldView.on("update",()=>{this._dialog.view.wasMoved||this._dialog.view.updatePosition()}),this.listenTo(this._formView,"replaceContent",()=>{e.insertContent(this._aiAssistantController.currentContext),this.hideUI()}),this.listenTo(this._formView,"insertContentBelow",()=>{e.insertContentBelow(this._aiAssistantController.currentContext),this.hideUI()}),this._initAriaAiStatusChangeAnnouncements()}_initAriaAiStatusChangeAnnouncements(){const{locale:e,ui:{ariaLiveAnnouncer:i}}=this.editor;this._formView.contentArea.on("change:isProcessing",(n,r,o)=>{const l=this._aiAssistantController.currentContext;o?i.announce(Le(e,"AI is writing")):l&&i.announce(Le(e,"Generated content: %0",l),{politeness:"polite",isUnsafeHTML:!0})}),this._formView.on("change:isError",(n,r,o)=>{if(o){const l=this._formView.errorView.text;i.announce(Le(e,"Error during AI content generation: %0",l))}})}_onExecute(e){const i=this._commandDefinitions.get(e),n=this.editor,r=n.model.document.selection,o=n.commands.get("showAIAssistant"),l=n.plugins.get(Ju),a=(i.groupId!==O1?i.groupLabel+": ":"")+i.label;if(i.requiresContent!==!1&&r.isCollapsed){const c=$t(r.getSelectedBlocks())||n.model.schema.getLimitElement(r);n.model.change(h=>{h.setSelection(c,"in")})}l.showFakeVisualSelection(),o.execute(i.prompt,a,"command:"+e)}_populateMenuBarMenu(e,i,n,r){const o=this.editor,l=o.locale,a=new Al(l),c=$u(o,n).filter(h=>h.commands.length);c.length===1?this._getMenuBarGroupButtons({command:e,commands:c[0].commands,parentMenuView:i,onExecute:r}).forEach(h=>a.items.add(h)):c.forEach(({groupId:h,groupLabel:f,commands:m})=>{const w=new Tl(l,i),O=new cs(l),_=new Al(l),k=this._getMenuBarGroupButtons({command:e,commands:m,parentMenuView:O,onExecute:r});O.buttonView.set({label:f||h}),O.delegate("execute").to(i),_.items.addMany(k),O.panelView.children.add(_),w.children.add(O),a.items.add(w)}),i.panelView.children.add(a)}_getMenuBarGroupButtons({command:e,commands:i,parentMenuView:n,onExecute:r}){const o=this.editor,l=o.locale;return $u(o,i).map(a=>{const c=new Tl(l,n),h=new ti(l);return h.set({label:a.label}),h.delegate("execute").to(n),h.on("execute",()=>r(a.id)),h.bind("isEnabled").to(e,"enabledCommandsIds",f=>f.includes(a.id)),c.children.add(h),c})}}function zte(s,t){return s.order!==void 0&&t.order===void 0?1:s.order===void 0&&t.order!==void 0?-1:s.order!==void 0&&t.order!==void 0?s.order-t.order:0}function $u(s,t){t.sort(zte);const e={},i=[];for(const n of t)if(n.order!==void 0){if(n.order in e)throw new E("ai-commands-config-order-collision",s,{conflictingDefinitions:[n,e[n.order]]});e[n.order]=n,i.splice(n.order,0,n)}else i.push(n);return i}class Wte extends F{static get requires(){return[L4,Ju]}static get pluginName(){return"AIAssistant"}static get isOfficialPlugin(){return!0}static get isPremiumPlugin(){return!0}constructor(t){super(t);const e=t.config,i=t.locale;e.define("ai.aiAssistant.preserveComments",!0),e.define("ai.aiAssistant.commands",function(l){return[{groupId:"editOrReview",groupLabel:Le(l,"Edit or review"),commands:[{id:"improveWriting",label:Le(l,"Improve writing"),prompt:"Fix spelling mistakes, use proper grammar and apply good writing practices. Do not lose the original meaning."},{id:"makeShorter",label:Le(l,"Make shorter"),prompt:"Remove any repetitive, redundant, or non-essential writing in this content without changing the meaning or losing any key information."},{id:"makeLonger",label:Le(l,"Make longer"),prompt:"Improve this content by using descriptive language and inserting more information and more detailed explanations."},{id:"simplifyLanguage",label:Le(l,"Simplify language"),prompt:"Simplify the writing style of this content and reduce the complexity, so that the content is easy to understand."}]},{groupId:"generate",groupLabel:Le(l,"Generate from selection"),commands:[{id:"summarize",label:Le(l,"Summarize"),prompt:"Summarize this content into one paragraph of text. Include only the key ideas and conclusions. Keep it short. Do not keep original text formatting."},{id:"continue",label:Le(l,"Continue"),prompt:"Start with the provided content and write at the end of it continuing this topic. Keep the added part short."}]},{groupId:"changeTone",groupLabel:Le(l,"Change tone"),commands:[{id:"professional",label:Le(l,"Professional"),prompt:"Improve using polished, formal, and respectful language to convey professional expertise and competence."},{id:"casual",label:Le(l,"Casual"),prompt:"Improve using casual, informal language to convey a casual conversation with a real person."},{id:"direct",label:Le(l,"Direct"),prompt:"Improve using direct language, using only the essential information."},{id:"confident",label:Le(l,"Confident"),prompt:"Improve using compelling, optimistic language to convey confidence in the writing."},{id:"friendly",label:Le(l,"Friendly"),prompt:"Improve using friendly, comforting language, to convey understanding and empathy."}]},{groupId:"changeStyle",groupLabel:Le(l,"Change style"),commands:[{id:"business",label:Le(l,"Business"),prompt:"Rewrite this content as a business professional with formal language."},{id:"legal",label:Le(l,"Legal"),prompt:"Rewrite this content as a legal professional using valid legal terminology."},{id:"journalism",label:Le(l,"Journalism"),prompt:"Rewrite this content as a journalist using engaging language to convey the importance of the information."},{id:"poetic",label:Le(l,"Poetic"),prompt:"Rewrite this content as a poem using poetic techniques without losing the original meaning."}]},{groupId:"translate",groupLabel:Le(l,"Translate"),commands:[{id:"translateEnglish",label:Le(l,"English"),prompt:"Translate the content to English language."},{id:"translateSpanish",label:Le(l,"Spanish"),prompt:"Translate the content to Spanish language."},{id:"translatePortuguese",label:Le(l,"Portuguese"),prompt:"Translate the content to Portuguese language."},{id:"translateGerman",label:Le(l,"German"),prompt:"Translate the content to German language."},{id:"translateFrench",label:Le(l,"French"),prompt:"Translate the content to French language."},{id:"translateChinese",label:Le(l,"Simplified Chinese"),prompt:"Translate the content to Simplified Chinese language."},{id:"translateHindi",label:Le(l,"Hindi"),prompt:"Translate the content to Hindi language."},{id:"translateArabic",label:Le(l,"Arabic"),prompt:"Translate the content to Arabic language."}]}]}(i)),e.define("ai.aiAssistant.extraCommandGroups",[]),e.define("ai.aiAssistant.removeCommands",[]);let n=Zm(e.get("ai.aiAssistant.commands"),i);const r=e.get("ai.aiAssistant.extraCommandGroups"),o=e.get("ai.aiAssistant.removeCommands");r.forEach(l=>{const a=n.find(c=>c.groupId===l.groupId);a?a.commands=a.commands.concat(l.commands):n.push(l)}),n=n.filter(l=>!o.includes(l.groupId)),n.forEach(l=>{l.commands=l.commands.filter(a=>!o.includes(a.id))}),e.set("ai.aiAssistant.commands",n)}}let Ute=class extends F{constructor(e){super(e);p(this,"abortController");this.abortController=new AbortController}static get requires(){return[zg]}init(){this.editor.plugins.get(zg).textAdapter=this}abort(){this.abortController.signal.aborted||(this.abortController.abort(),this.abortController=new AbortController)}async makeRequest(e){return this.sendRequest(e).catch(i=>{if(i instanceof rc)return Promise.reject(i);if(i.name=="AbortError")return Promise.resolve();throw console.error(i),new E("aitextadapter-send-request-failed",null)})}async _prepareRequestHeaders(e,i){const n=this.editor.locale,r={"Content-Type":"application/json"};if(typeof e=="object")Object.assign(r,e);else if(e)try{const o=await e(i);Object.assign(r,o)}catch{return Promise.reject(new rc(Le(n,"AI_ERROR_GET_HEADERS")))}return r}async _prepareRequestParameters(e,i){const n=this.editor.locale;if(typeof e=="object")return e;try{return await e(i)}catch{return Promise.reject(new rc(Le(n,"AI_ERROR_GET_PARAMETERS")))}}},Zte=class extends Ute{constructor(e){super(e);p(this,"_apiUrl");p(this,"_requestHeaders");p(this,"_requestParameters");e.config.define("ai.openAI.apiUrl","https://api.openai.com/v1/chat/completions"),e.config.get("ai.openAI.requestParameters")||e.config.define("ai.openAI.requestParameters",{model:"gpt-3.5-turbo",max_tokens:2e3,temperature:1,top_p:1,stream:!0}),this._apiUrl=e.config.get("ai.openAI.apiUrl"),this._requestHeaders=e.config.get("ai.openAI.requestHeaders")||{},this._requestParameters=e.config.get("ai.openAI.requestParameters")}static get pluginName(){return"OpenAITextAdapter"}async sendRequest({query:e,context:i,onData:n,actionId:r}){const o=this.editor.locale,l=await this.prepareMessages(e,i,r),a=await this._prepareRequestHeaders(this._requestHeaders,r),c=await this._prepareRequestParameters(this._requestParameters,r),h={messages:l,...c},f={method:"POST",headers:a,body:JSON.stringify(h),signal:this.abortController.signal},m=await fetch(this._apiUrl,f);if(m.ok)return c.stream?await this._readStreamableResponse(m,n):await this._readStaticResponse(m,n),Promise.resolve();{const w=await m.text();return w.includes("context_length_exceeded")?Promise.reject(new rc(Le(o,"AI_ERROR_CONTEXT_LENGTH"))):w.includes("Moderation")?Promise.reject(new rc(Le(o,"AI_ERROR_MODERATION"))):Promise.reject(new Error(w))}}async prepareMessages(e,i,n){let r,o;return i?(r="Your task is to execute the instruction using the provided HTML content. Follow the instruction closely. Your answer must be a properly formatted HTML code. Do not add any additional remarks or notes. Do not act like a chatbot or a real person.",o=`Instruction:
`+e+`
You must keep the text formatting.

Content:
`+i):(r="Your task is to generate HTML content accordingly to the given instruction. Never include <img> tag in your response even if asked for. Your answer must be a well-structured and properly formatted HTML code. Answer only with the generated HTML content. Do not add any additional remarks or notes. Do not act like a chatbot or a real person.",o=e),[{role:"system",content:r},{role:"user",content:o}]}async _readStreamableResponse(e,i){const n=e.body.getReader(),r=new TextDecoder;let o="",l="",a="",c=!1;for(;!c;){const{done:h,value:f}=await n.read(),m=o+r.decode(f);let w="";c=h;try{w=this._cleanUpData(m),o=""}catch{o=m;continue}l+=w,!c&&this._isBufferIncomplete(l)||l&&(a+=l,l="",i(a))}return Promise.resolve()}async _readStaticResponse(e,i){return i((await e.json()).choices[0].message.content),Promise.resolve()}_isBufferIncomplete(e){const i=e.split("<").length!==e.split(">").length,n=e.length<30;return i&&n}_cleanUpData(e){return e.split(/\n(?![^{]*\})/g).map(i=>i.replace("data: ","")).filter(i=>i&&i.length>0&&i!=="[DONE]").map(i=>{var r,o;const{choices:n}=JSON.parse(i);if((o=(r=n[0])==null?void 0:r.delta)!=null&&o.content)return n[0].delta.content}).filter(i=>i).join("")}};const Hte=/<meta\s*name="?generator"?\s*content="?microsoft\s*excel\s*\d+"?\/?>/i;function B4(s){return Hte.test(s)}const qte=/^(?<tagName>(?!\.)[\w-]+)?(\.(?<className>[\w-]+))?$/i;function jte(s,t){const e=new Map;for(const[i,n]of t){if(!i.tagName&&!i.className)continue;const r=!i.tagName||s.name===i.tagName,o=!i.className||s.hasClass(i.className);r&&o&&e.set(i,n)}return e}function Xte(s){const t={};for(let e=0;e<s.length;e++){const i=s[e],n=s.getPropertyValue(i);n!=="initial"&&(t[i]=n)}return t}function Gte(s){const t=s.split(",").map(i=>i.trim()),e=[];for(const i of t){const n=qte.exec(i);n&&e.push(n.groups)}return e}function Yte(s){const t={};for(const e of s)Object.assign(t,e);return t}let Kte=class extends Ay{execute(t){const{body:e,styles:i}=t._parsedData,n=new Cn(e.document),r=n.createRangeIn(e),o=function(a){const c={};for(const h of a)for(const f of h.cssRules)if(f instanceof CSSStyleRule){const m=Xte(f.style);c[f.selectorText]=Object.assign({},c[f.selectorText]||{},m)}return c}(i),l=function(a){const c=new Map;for(const h in a){const f=Gte(h),m=a[h];for(const w of f)c.set(w,m)}return c}(o);for(const a of r){if(a.type!=="elementStart")continue;const c=jte(a.item,l);if(c.size){const h=Yte(Array.from(c.values()));for(const f in h){const m=a.item;m.hasStyle(f)||n.setStyle(f,h[f],m)}}}t.content=e}isActive(t){return super.isActive(t)||B4(t)}},Jte=class extends F{static get pluginName(){return"PasteFromOfficeEnhancedInliner"}static get isOfficialPlugin(){return!0}static get isPremiumPlugin(){return!0}static get requires(){return["PasteFromOffice"]}init(){const t=this.editor,e=t.plugins.get("ClipboardPipeline"),i=t.editing.view.document,n=new Kte(i);e.on("inputTransformation",(r,o)=>{const l=o.dataTransfer.getData("text/html");n.isActive(l)&&(o._parsedData||(o._parsedData=Iy(l,i.stylesProcessor)),n.execute(o))},{priority:Ji.get("high")+11})}afterInit(){(async function(t){const e=b([53,48,112,99,103,54,84,66,121,82,118,116,57,72,97,88,108,85,86,50,119,106,74,98,102,107,56,55,69,81,109,73,87,105,77,113,104,100,111,65,89,117,83,115,90,67,114,79,68,75,70,51,49,122,71,78,52,76,80,101,110,120]),i=1792287792,n=1792233368^i,r=window[b([68,97,116,101])][b([110,111,119])](),o=t[b([101,100,105,116,111,114])],l=new window[b([80,114,111,109,105,115,101])](I=>{o[b([111,110,99,101])](b([114,101,97,100,121]),I)}),a={[b([107,116,121])]:b([69,67]),[b([117,115,101])]:b([115,105,103]),[b([99,114,118])]:b([80,45,50,53,54]),[b([120])]:b([105,67,106,79,67,118,68,70,73,54,108,81,72,72,84,49,56,106,86,119,82,102,107,102,72,81,50,97,95,77,121,109,84,51,53,76,81,86,111,70,83,65,73]),[b([121])]:b([107,88,73,121,74,52,101,118,116,67,69,70,82,109,120,75,83,85,112,75,57,102,68,87,52,53,57,118,88,79,118,86,114,104,102,54,117,81,65,101,79,105,111]),[b([97,108,103])]:b([69,83,50,53,54])},c=o[b([99,111,110,102,105,103])][b([103,101,116])](b([108,105,99,101,110,115,101,75,101,121]));async function h(){let I,B=null,j=null;try{return c==b([71,80,76])?b([78,111,116,65,108,108,111,119,101,100]):(I=k(),I?(I[b([117,115,97,103,101,69,110,100,112,111,105,110,116])]&&(j=f(I[b([117,115,97,103,101,69,110,100,112,111,105,110,116])],I[b([106,116,105])])),await C()?H()?W()?b([69,120,112,105,114,101,100]):te()?(I[b([108,105,99,101,110,115,101,84,121,112,101])]==b([101,118,97,108,117,97,116,105,111,110])&&(B=m(b([69,118,97,108,117,97,116,105,111,110,76,105,109,105,116]))),I[b([108,105,99,101,110,115,101,84,121,112,101])]==b([116,114,105,97,108])&&(B=m(b([84,114,105,97,108,76,105,109,105,116]))),await de()):b([68,111,109,97,105,110,76,105,109,105,116]):b([78,111,116,65,108,108,111,119,101,100]):b([73,110,118,97,108,105,100])):b([73,110,118,97,108,105,100]))}catch{return b([73,110,118,97,108,105,100])}function W(){const oe=[b([101,118,97,108,117,97,116,105,111,110]),b([116,114,105,97,108])][b([105,110,99,108,117,100,101,115])](I[b([108,105,99,101,110,115,101,84,121,112,101])])?r/1e3:3600*n;return I[b([101,120,112])]<oe}function H(){const oe=I[b([102,101,97,116,117,114,101,115])];return!!oe&&(!!oe[b([105,110,99,108,117,100,101,115])](b([42]))||!!oe[b([105,110,99,108,117,100,101,115])](b([80,79,69]))||!!oe[b([105,110,99,108,117,100,101,115])](b([80,80])))}function te(){const oe=I[b([108,105,99,101,110,115,101,100,72,111,115,116,115])];if(!oe||oe[b([108,101,110,103,116,104])]==0)return!0;const{hostname:ve}=new URL(window[b([108,111,99,97,116,105,111,110])].href);if(oe[b([105,110,99,108,117,100,101,115])](ve))return!0;const Z=ve[b([115,112,108,105,116])](b([46]));return oe[b([102,105,108,116,101,114])](Y=>Y[b([105,110,99,108,117,100,101,115])](b([42])))[b([109,97,112])](Y=>Y[b([115,112,108,105,116])](b([46])))[b([102,105,108,116,101,114])](Y=>Y[b([108,101,110,103,116,104])]<=Z[b([108,101,110,103,116,104])])[b([109,97,112])](Y=>Array(Z[b([108,101,110,103,116,104])]-Y[b([108,101,110,103,116,104])])[b([102,105,108,108])](Y[0]===b([42])?b([42]):"")[b([99,111,110,99,97,116])](Y))[b([115,111,109,101])](Y=>Z[b([101,118,101,114,121])]((ie,V)=>Y[V]===ie||Y[V]===b([42])))}function de(){return B&&j?new window[b([80,114,111,109,105,115,101])]((oe,ve)=>{B[b([116,104,101,110])](oe,ve),j[b([116,104,101,110])](Z=>{Z!=b([86,97,108,105,100])&&oe(Z)},ve)}):B||j||b([86,97,108,105,100])}}function f(I,B){return new window[b([80,114,111,109,105,115,101])](H=>{if(j())return H(b([86,97,108,105,100]));W(),o[b([100,101,99,111,114,97,116,101])](b([95,115,101,110,100,85,115,97,103,101,82,101,113,117,101,115,116]));let te=!1;const de=ei();function oe(Z){return!!Z&&(typeof Z===b([111,98,106,101,99,116])||typeof Z===b([102,117,110,99,116,105,111,110]))&&typeof Z[b([116,104,101,110])]===b([102,117,110,99,116,105,111,110])&&typeof Z[b([99,97,116,99,104])]===b([102,117,110,99,116,105,111,110])}function ve(Z){J(Z)[b([116,104,101,110])](ae=>!ae||ae[b([115,116,97,116,117,115])]!=b([111,107])?b([85,115,97,103,101,76,105,109,105,116]):N(Q(de+B))!=ae[b([118,101,114,105,102,105,99,97,116,105,111,110])]?b([85,115,97,103,101,76,105,109,105,116]):b([86,97,108,105,100]))[b([116,104,101,110])](ae=>(ie(),ae),()=>{const ae=V();return ae==null?(ie(),b([86,97,108,105,100])):b(r-ae>(1322819632^i)?[85,115,97,103,101,76,105,109,105,116]:[86,97,108,105,100])})[b([116,104,101,110])](H)[b([99,97,116,99,104])](()=>{H(b([85,115,97,103,101,76,105,109,105,116]))});const Y=1793247920^i;function ie(){const ae=b([108,108,99,116,45])+N(Q(I)),U=G(N(window[b([77,97,116,104])][b([99,101,105,108])](r/Y)));window[b([108,111,99,97,108,83,116,111,114,97,103,101])][b([115,101,116,73,116,101,109])](ae,U)}function V(){const ae=b([108,108,99,116,45])+N(Q(I)),U=window[b([108,111,99,97,108,83,116,111,114,97,103,101])][b([103,101,116,73,116,101,109])](ae);return U?window[b([112,97,114,115,101,73,110,116])](G(U),16)*Y:null}function J(ae){return new window[b([80,114,111,109,105,115,101])]((U,$)=>{ae[b([116,104,101,110])](U,$),window[b([115,101,116,84,105,109,101,111,117,116])]($,1792405744^i)})}}o[b([111,110])](b([95,115,101,110,100,85,115,97,103,101,82,101,113,117,101,115,116]),(Z,Y)=>{if(Y[0]!=I)return H(b([85,115,97,103,101,76,105,109,105,116]));Y[1]={...Y[1],[b([114,101,113,117,101,115,116,73,100])]:de}},{[b([112,114,105,111,114,105,116,121])]:b([104,105,103,104])}),o[b([111,110])](b([95,115,101,110,100,85,115,97,103,101,82,101,113,117,101,115,116]),Z=>{oe(Z[b([114,101,116,117,114,110])])&&(te=!0,ve(Z[b([114,101,116,117,114,110])]))},{[b([112,114,105,111,114,105,116,121])]:b([108,111,119])}),l[b([116,104,101,110])](()=>{te||H(b([85,115,97,103,101,76,105,109,105,116]))})});function j(){return o[b([101,100,105,116,105,110,103])][b([118,105,101,119])][b([95,111,118,101,114,108,97,121,77,111,100,101,72,105,110,116])]==b([97,117,116,111])}function W(){o[b([101,100,105,116,105,110,103])][b([118,105,101,119])][b([95,111,118,101,114,108,97,121,77,111,100,101,72,105,110,116])]=b([97,117,116,111])}}function m(I){const B=[new window[b([80,114,111,109,105,115,101])](j=>setTimeout(j,1792875260^i)),l[b([116,104,101,110])](()=>new window[b([80,114,111,109,105,115,101])](j=>{let W=0;o[b([109,111,100,101,108])][b([111,110])](b([97,112,112,108,121,79,112,101,114,97,116,105,111,110]),(H,te)=>{te[0][b([105,115,68,111,99,117,109,101,110,116,79,112,101,114,97,116,105,111,110])]&&W++,W==(1792288200^i)&&(j(),H[b([111,102,102])]())})}))];return window[b([80,114,111,109,105,115,101])][b([114,97,99,101])](B)[b([116,104,101,110])](()=>I)}async function w(){await l,o[b([109,111,100,101,108])][b([99,104,97,110,103,101])]=D,o[b([109,111,100,101,108])][b([101,110,113,117,101,117,101,67,104,97,110,103,101])]=D,o[b([101,110,97,98,108,101,82,101,97,100,79,110,108,121,77,111,100,101])](b([109,111,100,101,108]))}function O(I){const B=_();o[B]=b([112,97,115,116,101,70,114,111,109,79,102,102,105,99,101,69,110,104,97,110,99,101,100,76,105,99,101,110,115,101,75,101,121])+I,I!=b([86,97,108,105,100])&&w()}function _(){const I=window[b([83,116,114,105,110,103])](window[b([112,101,114,102,111,114,109,97,110,99,101])][b([110,111,119])]())[b([114,101,112,108,97,99,101])](b([46]),"");let B=b([112]);for(let j=0;j<I[b([108,101,110,103,116,104])];j+=2){let W=window[b([112,97,114,115,101,73,110,116])](I[b([115,117,98,115,116,114,105,110,103])](j,j+2));W>=e[b([108,101,110,103,116,104])]&&(W-=e[b([108,101,110,103,116,104])]),B+=e[W]}return B}function k(){const I=c[b([115,112,108,105,116])](b([46]));if(I[b([108,101,110,103,116,104])]!=3)return null;return B(I[1]);function B(j){const W=P(j);return W&&H()?W:null;function H(){const te=W[b([106,116,105])],de=window[b([112,97,114,115,101,73,110,116])](te[b([115,117,98,115,116,114,105,110,103])](te[b([108,101,110,103,116,104])]-8),16),oe={...W,[b([106,116,105])]:te[b([115,117,98,115,116,114,105,110,103])](0,te[b([108,101,110,103,116,104])]-8)};return delete oe[b([118,99])],Q(oe)==de}}}async function C(){let I=!0;try{const W=c[b([115,112,108,105,116])](b([46])),[H,te,de]=W;return B(H),await j(H,te,de),I}catch{return!1}function B(W){const H=P(W);H&&H[b([97,108,103])]==b([69,83,50,53,54])||(I=!1)}async function j(W,H,te){const de=window[b([85,105,110,116,56,65,114,114,97,121])][b([102,114,111,109])](M(te),Y=>Y[b([99,104,97,114,67,111,100,101,65,116])](0)),oe=new window[b([84,101,120,116,69,110,99,111,100,101,114])]()[b([101,110,99,111,100,101])](W+b([46])+H),ve=window[b([99,114,121,112,116,111])][b([115,117,98,116,108,101])];if(!ve)return;const Z=await ve[b([105,109,112,111,114,116,75,101,121])](b([106,119,107]),a,{[b([110,97,109,101])]:b([69,67,68,83,65]),[b([110,97,109,101,100,67,117,114,118,101])]:b([80,45,50,53,54])},!1,[b([118,101,114,105,102,121])]);await ve[b([118,101,114,105,102,121])]({[b([110,97,109,101])]:b([69,67,68,83,65]),[b([104,97,115,104])]:{[b([110,97,109,101])]:b([83,72,65,45,50,53,54])}},Z,de,oe)||(I=!1)}}function P(I){return I[b([115,116,97,114,116,115,87,105,116,104])](b([101,121]))?JSON[b([112,97,114,115,101])](M(I)):null}function M(I){return window[b([97,116,111,98])](I[b([114,101,112,108,97,99,101])](/-/g,b([43]))[b([114,101,112,108,97,99,101])](/_/g,b([47])))}function Q(I){let B=5381;function j(H){for(let te=0;te<H[b([108,101,110,103,116,104])];te++){const de=H[b([99,104,97,114,67,111,100,101,65,116])](te);B=(B<<5)+B+de,B&=B}}function W(H){Array[b([105,115,65,114,114,97,121])](H)?H[b([102,111,114,69,97,99,104])](W):H&&typeof H==b([111,98,106,101,99,116])?Object[b([101,110,116,114,105,101,115])](H)[b([115,111,114,116])]()[b([102,111,114,69,97,99,104])](([te,de])=>{j(te),W(de)}):j(window[b([83,116,114,105,110,103])](H))}return W(I),B>>>0}function N(I){return I[b([116,111,83,116,114,105,110,103])](16)[b([112,97,100,83,116,97,114,116])](8,b([48]))}function G(I){return I[b([115,112,108,105,116])]("")[b([114,101,118,101,114,115,101])]()[b([106,111,105,110])]("")}function D(){}function b(I){return I.map(B=>String.fromCharCode(B)).join("")}O(await h())})(this)}};const eie=["color","font-family","font-size","text-decoration","text-decoration-line","font-weight","font-style","vertical-align"],tie=["color","font-family","font-size"],OP={"font-style":[["italic","i"]],"font-weight":[["medium","strong"],["bold","strong"],["bolder","strong"],[s=>Number(s)>=600,"strong"]],"text-decoration":[["underline","u"],["line-through","s"]],"text-decoration-line":[["underline","u"],["line-through","s"]],"vertical-align":[["sub","sub"],["super","sup"]]};function iie(s){return eie.includes(s)}function nie(s){return Array.from(s.getStyleNames()).filter(iie)}function sie(s,t,e){const{spanStyles:i,stylesToBeHtmlElements:n}=function(r,o){const l={},a={};return o.forEach(c=>{const h=r.getStyle(c);if(h){if(function(f){return tie.includes(f)}(c))l[c]=h;else if(function(f){return f in OP}(c)){const f=h.split(" ");OP[c].forEach(([m,w])=>{for(const O of f)(typeof m=="function"&&m(O)||m===O)&&(a[c]=[...a[c]||[],[m,w]])})}}}),{spanStyles:l,stylesToBeHtmlElements:a}}(s,e);(function(r,o,l){for(const a in l)l[a].forEach(([,c])=>{const h=o.createElement(c,[],r.getChildren());o.insertChild(0,h,r)}),o.removeStyle(a,r)})(s,t,n),function(r,o,l){if(!Object.keys(l).length)return;const a=o.createElement("span",[],r.getChildren());o.setStyle(l,a),o.insertChild(0,a,r),o.removeStyle(Object.keys(l),r)}(s,t,i)}let rie=class extends Ay{execute(t){const{body:e}=t._parsedData,i=new Cn(e.document),n=i.createRangeIn(e),r=new ad(i.document.stylesProcessor),o=[...new cd(r).blockElements,"font"],l=n.getItems();for(const a of l)a.is("element")&&o.includes(a.name)&&sie(a,i,nie(a));t.content=e}isActive(t){return super.isActive(t)||B4(t)}},oie=class extends F{constructor(){super(...arguments);p(this,"licenseKey");p(this,"_licenseKeyCheckInterval")}static get pluginName(){return"PasteFromOfficeEnhancedPropagator"}static get isOfficialPlugin(){return!0}static get isPremiumPlugin(){return!0}static get requires(){return["PasteFromOffice"]}init(){const e=this.editor,i=e.plugins.get("ClipboardPipeline"),n=e.editing.view.document,r=new rie(n);i.on("inputTransformation",(l,a)=>{const c=a.dataTransfer.getData("text/html");r.isActive(c)&&(a._parsedData||(a._parsedData=Iy(c,n.stylesProcessor)),r.execute(a))},{priority:Ji.get("high")+10}),this.licenseKey=this.editor.config.get("licenseKey");const o=this.editor;this._licenseKeyCheckInterval=setInterval(()=>{let l;for(const a in o){const c=a,h=o[c];if(h=="pasteFromOfficeEnhancedLicenseKeyValid"||h=="pasteFromOfficeEnhancedLicenseKeyInvalid"||h=="pasteFromOfficeEnhancedLicenseKeyExpired"||h=="pasteFromOfficeEnhancedLicenseKeyDomainLimit"||h=="pasteFromOfficeEnhancedLicenseKeyNotAllowed"||h=="pasteFromOfficeEnhancedLicenseKeyEvaluationLimit"||h=="pasteFromOfficeEnhancedLicenseKeyTrialLimit"||h=="pasteFromOfficeEnhancedLicenseKeyUsageLimit"){delete o[c],l=h,clearInterval(this._licenseKeyCheckInterval),this._licenseKeyCheckInterval=void 0;break}}l=="pasteFromOfficeEnhancedLicenseKeyInvalid"&&o._showLicenseError("invalid"),l=="pasteFromOfficeEnhancedLicenseKeyExpired"&&o._showLicenseError("expired"),l=="pasteFromOfficeEnhancedLicenseKeyDomainLimit"&&o._showLicenseError("domainLimit"),l=="pasteFromOfficeEnhancedLicenseKeyNotAllowed"&&o._showLicenseError("featureNotAllowed","PasteFromOfficeEnhanced"),l=="pasteFromOfficeEnhancedLicenseKeyEvaluationLimit"&&o._showLicenseError("evaluationLimit"),l=="pasteFromOfficeEnhancedLicenseKeyTrialLimit"&&o._showLicenseError("trialLimit"),l=="pasteFromOfficeEnhancedLicenseKeyUsageLimit"&&o._showLicenseError("usageLimit")},1e3)}destroy(){super.destroy(),this._licenseKeyCheckInterval&&clearInterval(this._licenseKeyCheckInterval)}},lie=class extends F{static get pluginName(){return"PasteFromOfficeEnhanced"}static get isOfficialPlugin(){return!0}static get isPremiumPlugin(){return!0}static get requires(){return["PasteFromOffice",Jte,oie]}},y1=[],$4=[];(()=>{let s="lc,34,7n,7,7b,19,,,,2,,2,,,20,b,1c,l,g,,2t,7,2,6,2,2,,4,z,,u,r,2j,b,1m,9,9,,o,4,,9,,3,,5,17,3,3b,f,,w,1j,,,,4,8,4,,3,7,a,2,t,,1m,,,,2,4,8,,9,,a,2,q,,2,2,1l,,4,2,4,2,2,3,3,,u,2,3,,b,2,1l,,4,5,,2,4,,k,2,m,6,,,1m,,,2,,4,8,,7,3,a,2,u,,1n,,,,c,,9,,14,,3,,1l,3,5,3,,4,7,2,b,2,t,,1m,,2,,2,,3,,5,2,7,2,b,2,s,2,1l,2,,,2,4,8,,9,,a,2,t,,20,,4,,2,3,,,8,,29,,2,7,c,8,2q,,2,9,b,6,22,2,r,,,,,,1j,e,,5,,2,5,b,,10,9,,2u,4,,6,,2,2,2,p,2,4,3,g,4,d,,2,2,6,,f,,jj,3,qa,3,t,3,t,2,u,2,1s,2,,7,8,,2,b,9,,19,3,3b,2,y,,3a,3,4,2,9,,6,3,63,2,2,,1m,,,7,,,,,2,8,6,a,2,,1c,h,1r,4,1c,7,,,5,,14,9,c,2,w,4,2,2,,3,1k,,,2,3,,,3,1m,8,2,2,48,3,,d,,7,4,,6,,3,2,5i,1m,,5,ek,,5f,x,2da,3,3x,,2o,w,fe,6,2x,2,n9w,4,,a,w,2,28,2,7k,,3,,4,,p,2,5,,47,2,q,i,d,,12,8,p,b,1a,3,1c,,2,4,2,2,13,,1v,6,2,2,2,2,c,,8,,1b,,1f,,,3,2,2,5,2,,,16,2,8,,6m,,2,,4,,fn4,,kh,g,g,g,a6,2,gt,,6a,,45,5,1ae,3,,2,5,4,14,3,4,,4l,2,fx,4,ar,2,49,b,4w,,1i,f,1k,3,1d,4,2,2,1x,3,10,5,,8,1q,,c,2,1g,9,a,4,2,,2n,3,2,,,2,6,,4g,,3,8,l,2,1l,2,,,,,m,,e,7,3,5,5f,8,2,3,,,n,,29,,2,6,,,2,,,2,,2,6j,,2,4,6,2,,2,r,2,2d,8,2,,,2,2y,,,,2,6,,,2t,3,2,4,,5,77,9,,2,6t,,a,2,,,4,,40,4,2,2,4,,w,a,14,6,2,4,8,,9,6,2,3,1a,d,,2,ba,7,,6,,,2a,m,2,7,,2,,2,3e,6,3,,,2,,7,,,20,2,3,,,,9n,2,f0b,5,1n,7,t4,,1r,4,29,,f5k,2,43q,,,3,4,5,8,8,2,7,u,4,44,3,1iz,1j,4,1e,8,,e,,m,5,,f,11s,7,,h,2,7,,2,,5,79,7,c5,4,15s,7,31,7,240,5,gx7k,2o,3k,6o".split(",").map(t=>t?parseInt(t,36):1);for(let t=0,e=0;t<s.length;t++)(t%2?$4:y1).push(e=e+s[t])})();function aie(s){if(s<768)return!1;for(let t=0,e=y1.length;;){let i=t+e>>1;if(s<y1[i])e=i;else if(s>=$4[i])t=i+1;else return!0;if(t==e)return!1}}function yP(s){return s>=127462&&s<=127487}const vP=8205;function cie(s,t,e=!0,i=!0){return(e?D4:uie)(s,t,i)}function D4(s,t,e){if(t==s.length)return t;t&&Q4(s.charCodeAt(t))&&N4(s.charCodeAt(t-1))&&t--;let i=Dx(s,t);for(t+=_P(i);t<s.length;){let n=Dx(s,t);if(i==vP||n==vP||e&&aie(n))t+=_P(n),i=n;else if(yP(n)){let r=0,o=t-2;for(;o>=0&&yP(Dx(s,o));)r++,o-=2;if(r%2==0)break;t+=2}else break}return t}function uie(s,t,e){for(;t>0;){let i=D4(s,t-2,e);if(i<t)return i;t--}return 0}function Dx(s,t){let e=s.charCodeAt(t);if(!N4(e)||t+1==s.length)return e;let i=s.charCodeAt(t+1);return Q4(i)?(e-55296<<10)+(i-56320)+65536:e}function Q4(s){return s>=56320&&s<57344}function N4(s){return s>=55296&&s<56320}function _P(s){return s<65536?1:2}class Ke{lineAt(t){if(t<0||t>this.length)throw new RangeError(`Invalid position ${t} in document of length ${this.length}`);return this.lineInner(t,!1,1,0)}line(t){if(t<1||t>this.lines)throw new RangeError(`Invalid line number ${t} in ${this.lines}-line document`);return this.lineInner(t,!0,1,0)}replace(t,e,i){[t,e]=bc(this,t,e);let n=[];return this.decompose(0,t,n,2),i.length&&i.decompose(0,i.length,n,3),this.decompose(e,this.length,n,1),er.from(n,this.length-(e-t)+i.length)}append(t){return this.replace(this.length,this.length,t)}slice(t,e=this.length){[t,e]=bc(this,t,e);let i=[];return this.decompose(t,e,i,0),er.from(i,e-t)}eq(t){if(t==this)return!0;if(t.length!=this.length||t.lines!=this.lines)return!1;let e=this.scanIdentical(t,1),i=this.length-this.scanIdentical(t,-1),n=new ph(this),r=new ph(t);for(let o=e,l=e;;){if(n.next(o),r.next(o),o=0,n.lineBreak!=r.lineBreak||n.done!=r.done||n.value!=r.value)return!1;if(l+=n.value.length,n.done||l>=i)return!0}}iter(t=1){return new ph(this,t)}iterRange(t,e=this.length){return new F4(this,t,e)}iterLines(t,e){let i;if(t==null)i=this.iter();else{e==null&&(e=this.lines+1);let n=this.line(t).from;i=this.iterRange(n,Math.max(n,e==this.lines+1?this.length:e<=1?0:this.line(e-1).to))}return new z4(i)}toString(){return this.sliceString(0)}toJSON(){let t=[];return this.flatten(t),t}constructor(){}static of(t){if(t.length==0)throw new RangeError("A document must have at least one line");return t.length==1&&!t[0]?Ke.empty:t.length<=32?new Gt(t):er.from(Gt.split(t,[]))}}class Gt extends Ke{constructor(t,e=hie(t)){super(),this.text=t,this.length=e}get lines(){return this.text.length}get children(){return null}lineInner(t,e,i,n){for(let r=0;;r++){let o=this.text[r],l=n+o.length;if((e?i:l)>=t)return new die(n,l,i,o);n=l+1,i++}}decompose(t,e,i,n){let r=t<=0&&e>=this.length?this:new Gt(kP(this.text,t,e),Math.min(e,this.length)-Math.max(0,t));if(n&1){let o=i.pop(),l=Hm(r.text,o.text.slice(),0,r.length);if(l.length<=32)i.push(new Gt(l,o.length+r.length));else{let a=l.length>>1;i.push(new Gt(l.slice(0,a)),new Gt(l.slice(a)))}}else i.push(r)}replace(t,e,i){if(!(i instanceof Gt))return super.replace(t,e,i);[t,e]=bc(this,t,e);let n=Hm(this.text,Hm(i.text,kP(this.text,0,t)),e),r=this.length+i.length-(e-t);return n.length<=32?new Gt(n,r):er.from(Gt.split(n,[]),r)}sliceString(t,e=this.length,i=`
`){[t,e]=bc(this,t,e);let n="";for(let r=0,o=0;r<=e&&o<this.text.length;o++){let l=this.text[o],a=r+l.length;r>t&&o&&(n+=i),t<a&&e>r&&(n+=l.slice(Math.max(0,t-r),e-r)),r=a+1}return n}flatten(t){for(let e of this.text)t.push(e)}scanIdentical(){return 0}static split(t,e){let i=[],n=-1;for(let r of t)i.push(r),n+=r.length+1,i.length==32&&(e.push(new Gt(i,n)),i=[],n=-1);return n>-1&&e.push(new Gt(i,n)),e}}class er extends Ke{constructor(t,e){super(),this.children=t,this.length=e,this.lines=0;for(let i of t)this.lines+=i.lines}lineInner(t,e,i,n){for(let r=0;;r++){let o=this.children[r],l=n+o.length,a=i+o.lines-1;if((e?a:l)>=t)return o.lineInner(t,e,i,n);n=l+1,i=a+1}}decompose(t,e,i,n){for(let r=0,o=0;o<=e&&r<this.children.length;r++){let l=this.children[r],a=o+l.length;if(t<=a&&e>=o){let c=n&((o<=t?1:0)|(a>=e?2:0));o>=t&&a<=e&&!c?i.push(l):l.decompose(t-o,e-o,i,c)}o=a+1}}replace(t,e,i){if([t,e]=bc(this,t,e),i.lines<this.lines)for(let n=0,r=0;n<this.children.length;n++){let o=this.children[n],l=r+o.length;if(t>=r&&e<=l){let a=o.replace(t-r,e-r,i),c=this.lines-o.lines+a.lines;if(a.lines<c>>4&&a.lines>c>>6){let h=this.children.slice();return h[n]=a,new er(h,this.length-(e-t)+i.length)}return super.replace(r,l,a)}r=l+1}return super.replace(t,e,i)}sliceString(t,e=this.length,i=`
`){[t,e]=bc(this,t,e);let n="";for(let r=0,o=0;r<this.children.length&&o<=e;r++){let l=this.children[r],a=o+l.length;o>t&&r&&(n+=i),t<a&&e>o&&(n+=l.sliceString(t-o,e-o,i)),o=a+1}return n}flatten(t){for(let e of this.children)e.flatten(t)}scanIdentical(t,e){if(!(t instanceof er))return 0;let i=0,[n,r,o,l]=e>0?[0,0,this.children.length,t.children.length]:[this.children.length-1,t.children.length-1,-1,-1];for(;;n+=e,r+=e){if(n==o||r==l)return i;let a=this.children[n],c=t.children[r];if(a!=c)return i+a.scanIdentical(c,e);i+=a.length+1}}static from(t,e=t.reduce((i,n)=>i+n.length+1,-1)){let i=0;for(let w of t)i+=w.lines;if(i<32){let w=[];for(let O of t)O.flatten(w);return new Gt(w,e)}let n=Math.max(32,i>>5),r=n<<1,o=n>>1,l=[],a=0,c=-1,h=[];function f(w){let O;if(w.lines>r&&w instanceof er)for(let _ of w.children)f(_);else w.lines>o&&(a>o||!a)?(m(),l.push(w)):w instanceof Gt&&a&&(O=h[h.length-1])instanceof Gt&&w.lines+O.lines<=32?(a+=w.lines,c+=w.length+1,h[h.length-1]=new Gt(O.text.concat(w.text),O.length+1+w.length)):(a+w.lines>n&&m(),a+=w.lines,c+=w.length+1,h.push(w))}function m(){a!=0&&(l.push(h.length==1?h[0]:er.from(h,c)),c=-1,a=h.length=0)}for(let w of t)f(w);return m(),l.length==1?l[0]:new er(l,e)}}Ke.empty=new Gt([""],0);function hie(s){let t=-1;for(let e of s)t+=e.length+1;return t}function Hm(s,t,e=0,i=1e9){for(let n=0,r=0,o=!0;r<s.length&&n<=i;r++){let l=s[r],a=n+l.length;a>=e&&(a>i&&(l=l.slice(0,i-n)),n<e&&(l=l.slice(e-n)),o?(t[t.length-1]+=l,o=!1):t.push(l)),n=a+1}return t}function kP(s,t,e){return Hm(s,[""],t,e)}class ph{constructor(t,e=1){this.dir=e,this.done=!1,this.lineBreak=!1,this.value="",this.nodes=[t],this.offsets=[e>0?1:(t instanceof Gt?t.text.length:t.children.length)<<1]}nextInner(t,e){for(this.done=this.lineBreak=!1;;){let i=this.nodes.length-1,n=this.nodes[i],r=this.offsets[i],o=r>>1,l=n instanceof Gt?n.text.length:n.children.length;if(o==(e>0?l:0)){if(i==0)return this.done=!0,this.value="",this;e>0&&this.offsets[i-1]++,this.nodes.pop(),this.offsets.pop()}else if((r&1)==(e>0?0:1)){if(this.offsets[i]+=e,t==0)return this.lineBreak=!0,this.value=`
`,this;t--}else if(n instanceof Gt){let a=n.text[o+(e<0?-1:0)];if(this.offsets[i]+=e,a.length>Math.max(0,t))return this.value=t==0?a:e>0?a.slice(t):a.slice(0,a.length-t),this;t-=a.length}else{let a=n.children[o+(e<0?-1:0)];t>a.length?(t-=a.length,this.offsets[i]+=e):(e<0&&this.offsets[i]--,this.nodes.push(a),this.offsets.push(e>0?1:(a instanceof Gt?a.text.length:a.children.length)<<1))}}}next(t=0){return t<0&&(this.nextInner(-t,-this.dir),t=this.value.length),this.nextInner(t,this.dir)}}class F4{constructor(t,e,i){this.value="",this.done=!1,this.cursor=new ph(t,e>i?-1:1),this.pos=e>i?t.length:0,this.from=Math.min(e,i),this.to=Math.max(e,i)}nextInner(t,e){if(e<0?this.pos<=this.from:this.pos>=this.to)return this.value="",this.done=!0,this;t+=Math.max(0,e<0?this.pos-this.to:this.from-this.pos);let i=e<0?this.pos-this.from:this.to-this.pos;t>i&&(t=i),i-=t;let{value:n}=this.cursor.next(t);return this.pos+=(n.length+t)*e,this.value=n.length<=i?n:e<0?n.slice(n.length-i):n.slice(0,i),this.done=!this.value,this}next(t=0){return t<0?t=Math.max(t,this.from-this.pos):t>0&&(t=Math.min(t,this.to-this.pos)),this.nextInner(t,this.cursor.dir)}get lineBreak(){return this.cursor.lineBreak&&this.value!=""}}class z4{constructor(t){this.inner=t,this.afterBreak=!0,this.value="",this.done=!1}next(t=0){let{done:e,lineBreak:i,value:n}=this.inner.next(t);return e&&this.afterBreak?(this.value="",this.afterBreak=!1):e?(this.done=!0,this.value=""):i?this.afterBreak?this.value="":(this.afterBreak=!0,this.next()):(this.value=n,this.afterBreak=!1),this}get lineBreak(){return!1}}typeof Symbol<"u"&&(Ke.prototype[Symbol.iterator]=function(){return this.iter()},ph.prototype[Symbol.iterator]=F4.prototype[Symbol.iterator]=z4.prototype[Symbol.iterator]=function(){return this});let die=class{constructor(t,e,i,n){this.from=t,this.to=e,this.number=i,this.text=n}get length(){return this.to-this.from}};function bc(s,t,e){return t=Math.max(0,Math.min(s.length,t)),[t,Math.max(t,Math.min(s.length,e))]}function en(s,t,e=!0,i=!0){return cie(s,t,e,i)}function fie(s){return s>=56320&&s<57344}function mie(s){return s>=55296&&s<56320}function $n(s,t){let e=s.charCodeAt(t);if(!mie(e)||t+1==s.length)return e;let i=s.charCodeAt(t+1);return fie(i)?(e-55296<<10)+(i-56320)+65536:e}function W4(s){return s<=65535?String.fromCharCode(s):(s-=65536,String.fromCharCode((s>>10)+55296,(s&1023)+56320))}function Tr(s){return s<65536?1:2}const v1=/\r\n?|\n/;var Wi=function(s){return s[s.Simple=0]="Simple",s[s.TrackDel=1]="TrackDel",s[s.TrackBefore=2]="TrackBefore",s[s.TrackAfter=3]="TrackAfter",s}(Wi||(Wi={}));class ar{constructor(t){this.sections=t}get length(){let t=0;for(let e=0;e<this.sections.length;e+=2)t+=this.sections[e];return t}get newLength(){let t=0;for(let e=0;e<this.sections.length;e+=2){let i=this.sections[e+1];t+=i<0?this.sections[e]:i}return t}get empty(){return this.sections.length==0||this.sections.length==2&&this.sections[1]<0}iterGaps(t){for(let e=0,i=0,n=0;e<this.sections.length;){let r=this.sections[e++],o=this.sections[e++];o<0?(t(i,n,r),n+=r):n+=o,i+=r}}iterChangedRanges(t,e=!1){_1(this,t,e)}get invertedDesc(){let t=[];for(let e=0;e<this.sections.length;){let i=this.sections[e++],n=this.sections[e++];n<0?t.push(i,n):t.push(n,i)}return new ar(t)}composeDesc(t){return this.empty?t:t.empty?this:U4(this,t)}mapDesc(t,e=!1){return t.empty?this:k1(this,t,e)}mapPos(t,e=-1,i=Wi.Simple){let n=0,r=0;for(let o=0;o<this.sections.length;){let l=this.sections[o++],a=this.sections[o++],c=n+l;if(a<0){if(c>t)return r+(t-n);r+=l}else{if(i!=Wi.Simple&&c>=t&&(i==Wi.TrackDel&&n<t&&c>t||i==Wi.TrackBefore&&n<t||i==Wi.TrackAfter&&c>t))return null;if(c>t||c==t&&e<0&&!l)return t==n||e<0?r:r+a;r+=a}n=c}if(t>n)throw new RangeError(`Position ${t} is out of range for changeset of length ${n}`);return r}touchesRange(t,e=t){for(let i=0,n=0;i<this.sections.length&&n<=e;){let r=this.sections[i++],o=this.sections[i++],l=n+r;if(o>=0&&n<=e&&l>=t)return n<t&&l>e?"cover":!0;n=l}return!1}toString(){let t="";for(let e=0;e<this.sections.length;){let i=this.sections[e++],n=this.sections[e++];t+=(t?" ":"")+i+(n>=0?":"+n:"")}return t}toJSON(){return this.sections}static fromJSON(t){if(!Array.isArray(t)||t.length%2||t.some(e=>typeof e!="number"))throw new RangeError("Invalid JSON representation of ChangeDesc");return new ar(t)}static create(t){return new ar(t)}}class ci extends ar{constructor(t,e){super(t),this.inserted=e}apply(t){if(this.length!=t.length)throw new RangeError("Applying change set to a document with the wrong length");return _1(this,(e,i,n,r,o)=>t=t.replace(n,n+(i-e),o),!1),t}mapDesc(t,e=!1){return k1(this,t,e,!0)}invert(t){let e=this.sections.slice(),i=[];for(let n=0,r=0;n<e.length;n+=2){let o=e[n],l=e[n+1];if(l>=0){e[n]=l,e[n+1]=o;let a=n>>1;for(;i.length<a;)i.push(Ke.empty);i.push(o?t.slice(r,r+o):Ke.empty)}r+=o}return new ci(e,i)}compose(t){return this.empty?t:t.empty?this:U4(this,t,!0)}map(t,e=!1){return t.empty?this:k1(this,t,e,!0)}iterChanges(t,e=!1){_1(this,t,e)}get desc(){return ar.create(this.sections)}filter(t){let e=[],i=[],n=[],r=new Fh(this);e:for(let o=0,l=0;;){let a=o==t.length?1e9:t[o++];for(;l<a||l==a&&r.len==0;){if(r.done)break e;let h=Math.min(r.len,a-l);zi(n,h,-1);let f=r.ins==-1?-1:r.off==0?r.ins:0;zi(e,h,f),f>0&&vo(i,e,r.text),r.forward(h),l+=h}let c=t[o++];for(;l<c;){if(r.done)break e;let h=Math.min(r.len,c-l);zi(e,h,-1),zi(n,h,r.ins==-1?-1:r.off==0?r.ins:0),r.forward(h),l+=h}}return{changes:new ci(e,i),filtered:ar.create(n)}}toJSON(){let t=[];for(let e=0;e<this.sections.length;e+=2){let i=this.sections[e],n=this.sections[e+1];n<0?t.push(i):n==0?t.push([i]):t.push([i].concat(this.inserted[e>>1].toJSON()))}return t}static of(t,e,i){let n=[],r=[],o=0,l=null;function a(h=!1){if(!h&&!n.length)return;o<e&&zi(n,e-o,-1);let f=new ci(n,r);l=l?l.compose(f.map(l)):f,n=[],r=[],o=0}function c(h){if(Array.isArray(h))for(let f of h)c(f);else if(h instanceof ci){if(h.length!=e)throw new RangeError(`Mismatched change set length (got ${h.length}, expected ${e})`);a(),l=l?l.compose(h.map(l)):h}else{let{from:f,to:m=f,insert:w}=h;if(f>m||f<0||m>e)throw new RangeError(`Invalid change range ${f} to ${m} (in doc of length ${e})`);let O=w?typeof w=="string"?Ke.of(w.split(i||v1)):w:Ke.empty,_=O.length;if(f==m&&_==0)return;f<o&&a(),f>o&&zi(n,f-o,-1),zi(n,m-f,_),vo(r,n,O),o=m}}return c(t),a(!l),l}static empty(t){return new ci(t?[t,-1]:[],[])}static fromJSON(t){if(!Array.isArray(t))throw new RangeError("Invalid JSON representation of ChangeSet");let e=[],i=[];for(let n=0;n<t.length;n++){let r=t[n];if(typeof r=="number")e.push(r,-1);else{if(!Array.isArray(r)||typeof r[0]!="number"||r.some((o,l)=>l&&typeof o!="string"))throw new RangeError("Invalid JSON representation of ChangeSet");if(r.length==1)e.push(r[0],0);else{for(;i.length<n;)i.push(Ke.empty);i[n]=Ke.of(r.slice(1)),e.push(r[0],i[n].length)}}}return new ci(e,i)}static createSet(t,e){return new ci(t,e)}}function zi(s,t,e,i=!1){if(t==0&&e<=0)return;let n=s.length-2;n>=0&&e<=0&&e==s[n+1]?s[n]+=t:n>=0&&t==0&&s[n]==0?s[n+1]+=e:i?(s[n]+=t,s[n+1]+=e):s.push(t,e)}function vo(s,t,e){if(e.length==0)return;let i=t.length-2>>1;if(i<s.length)s[s.length-1]=s[s.length-1].append(e);else{for(;s.length<i;)s.push(Ke.empty);s.push(e)}}function _1(s,t,e){let i=s.inserted;for(let n=0,r=0,o=0;o<s.sections.length;){let l=s.sections[o++],a=s.sections[o++];if(a<0)n+=l,r+=l;else{let c=n,h=r,f=Ke.empty;for(;c+=l,h+=a,a&&i&&(f=f.append(i[o-2>>1])),!(e||o==s.sections.length||s.sections[o+1]<0);)l=s.sections[o++],a=s.sections[o++];t(n,c,r,h,f),n=c,r=h}}}function k1(s,t,e,i=!1){let n=[],r=i?[]:null,o=new Fh(s),l=new Fh(t);for(let a=-1;;){if(o.done&&l.len||l.done&&o.len)throw new Error("Mismatched change set lengths");if(o.ins==-1&&l.ins==-1){let c=Math.min(o.len,l.len);zi(n,c,-1),o.forward(c),l.forward(c)}else if(l.ins>=0&&(o.ins<0||a==o.i||o.off==0&&(l.len<o.len||l.len==o.len&&!e))){let c=l.len;for(zi(n,l.ins,-1);c;){let h=Math.min(o.len,c);o.ins>=0&&a<o.i&&o.len<=h&&(zi(n,0,o.ins),r&&vo(r,n,o.text),a=o.i),o.forward(h),c-=h}l.next()}else if(o.ins>=0){let c=0,h=o.len;for(;h;)if(l.ins==-1){let f=Math.min(h,l.len);c+=f,h-=f,l.forward(f)}else if(l.ins==0&&l.len<h)h-=l.len,l.next();else break;zi(n,c,a<o.i?o.ins:0),r&&a<o.i&&vo(r,n,o.text),a=o.i,o.forward(o.len-h)}else{if(o.done&&l.done)return r?ci.createSet(n,r):ar.create(n);throw new Error("Mismatched change set lengths")}}}function U4(s,t,e=!1){let i=[],n=e?[]:null,r=new Fh(s),o=new Fh(t);for(let l=!1;;){if(r.done&&o.done)return n?ci.createSet(i,n):ar.create(i);if(r.ins==0)zi(i,r.len,0,l),r.next();else if(o.len==0&&!o.done)zi(i,0,o.ins,l),n&&vo(n,i,o.text),o.next();else{if(r.done||o.done)throw new Error("Mismatched change set lengths");{let a=Math.min(r.len2,o.len),c=i.length;if(r.ins==-1){let h=o.ins==-1?-1:o.off?0:o.ins;zi(i,a,h,l),n&&h&&vo(n,i,o.text)}else o.ins==-1?(zi(i,r.off?0:r.len,a,l),n&&vo(n,i,r.textBit(a))):(zi(i,r.off?0:r.len,o.off?0:o.ins,l),n&&!o.off&&vo(n,i,o.text));l=(r.ins>a||o.ins>=0&&o.len>a)&&(l||i.length>c),r.forward2(a),o.forward(a)}}}}class Fh{constructor(t){this.set=t,this.i=0,this.next()}next(){let{sections:t}=this.set;this.i<t.length?(this.len=t[this.i++],this.ins=t[this.i++]):(this.len=0,this.ins=-2),this.off=0}get done(){return this.ins==-2}get len2(){return this.ins<0?this.len:this.ins}get text(){let{inserted:t}=this.set,e=this.i-2>>1;return e>=t.length?Ke.empty:t[e]}textBit(t){let{inserted:e}=this.set,i=this.i-2>>1;return i>=e.length&&!t?Ke.empty:e[i].slice(this.off,t==null?void 0:this.off+t)}forward(t){t==this.len?this.next():(this.len-=t,this.off+=t)}forward2(t){this.ins==-1?this.forward(t):t==this.ins?this.next():(this.ins-=t,this.off+=t)}}class xl{constructor(t,e,i){this.from=t,this.to=e,this.flags=i}get anchor(){return this.flags&32?this.to:this.from}get head(){return this.flags&32?this.from:this.to}get empty(){return this.from==this.to}get assoc(){return this.flags&8?-1:this.flags&16?1:0}get bidiLevel(){let t=this.flags&7;return t==7?null:t}get goalColumn(){let t=this.flags>>6;return t==16777215?void 0:t}map(t,e=-1){let i,n;return this.empty?i=n=t.mapPos(this.from,e):(i=t.mapPos(this.from,1),n=t.mapPos(this.to,-1)),i==this.from&&n==this.to?this:new xl(i,n,this.flags)}extend(t,e=t){if(t<=this.anchor&&e>=this.anchor)return se.range(t,e);let i=Math.abs(t-this.anchor)>Math.abs(e-this.anchor)?t:e;return se.range(this.anchor,i)}eq(t,e=!1){return this.anchor==t.anchor&&this.head==t.head&&(!e||!this.empty||this.assoc==t.assoc)}toJSON(){return{anchor:this.anchor,head:this.head}}static fromJSON(t){if(!t||typeof t.anchor!="number"||typeof t.head!="number")throw new RangeError("Invalid JSON representation for SelectionRange");return se.range(t.anchor,t.head)}static create(t,e,i){return new xl(t,e,i)}}class se{constructor(t,e){this.ranges=t,this.mainIndex=e}map(t,e=-1){return t.empty?this:se.create(this.ranges.map(i=>i.map(t,e)),this.mainIndex)}eq(t,e=!1){if(this.ranges.length!=t.ranges.length||this.mainIndex!=t.mainIndex)return!1;for(let i=0;i<this.ranges.length;i++)if(!this.ranges[i].eq(t.ranges[i],e))return!1;return!0}get main(){return this.ranges[this.mainIndex]}asSingle(){return this.ranges.length==1?this:new se([this.main],0)}addRange(t,e=!0){return se.create([t].concat(this.ranges),e?0:this.mainIndex+1)}replaceRange(t,e=this.mainIndex){let i=this.ranges.slice();return i[e]=t,se.create(i,this.mainIndex)}toJSON(){return{ranges:this.ranges.map(t=>t.toJSON()),main:this.mainIndex}}static fromJSON(t){if(!t||!Array.isArray(t.ranges)||typeof t.main!="number"||t.main>=t.ranges.length)throw new RangeError("Invalid JSON representation for EditorSelection");return new se(t.ranges.map(e=>xl.fromJSON(e)),t.main)}static single(t,e=t){return new se([se.range(t,e)],0)}static create(t,e=0){if(t.length==0)throw new RangeError("A selection needs at least one range");for(let i=0,n=0;n<t.length;n++){let r=t[n];if(r.empty?r.from<=i:r.from<i)return se.normalized(t.slice(),e);i=r.to}return new se(t,e)}static cursor(t,e=0,i,n){return xl.create(t,t,(e==0?0:e<0?8:16)|(i==null?7:Math.min(6,i))|(n??16777215)<<6)}static range(t,e,i,n){let r=(i??16777215)<<6|(n==null?7:Math.min(6,n));return e<t?xl.create(e,t,48|r):xl.create(t,e,(e>t?8:0)|r)}static normalized(t,e=0){let i=t[e];t.sort((n,r)=>n.from-r.from),e=t.indexOf(i);for(let n=1;n<t.length;n++){let r=t[n],o=t[n-1];if(r.empty?r.from<=o.to:r.from<o.to){let l=o.from,a=Math.max(r.to,o.to);n<=e&&e--,t.splice(--n,2,r.anchor>r.head?se.range(a,l):se.range(l,a))}}return new se(t,e)}}function Z4(s,t){for(let e of s.ranges)if(e.to>t)throw new RangeError("Selection points outside of document")}let Qy=0;class Pe{constructor(t,e,i,n,r){this.combine=t,this.compareInput=e,this.compare=i,this.isStatic=n,this.id=Qy++,this.default=t([]),this.extensions=typeof r=="function"?r(this):r}get reader(){return this}static define(t={}){return new Pe(t.combine||(e=>e),t.compareInput||((e,i)=>e===i),t.compare||(t.combine?(e,i)=>e===i:Ny),!!t.static,t.enables)}of(t){return new qm([],this,0,t)}compute(t,e){if(this.isStatic)throw new Error("Can't compute a static facet");return new qm(t,this,1,e)}computeN(t,e){if(this.isStatic)throw new Error("Can't compute a static facet");return new qm(t,this,2,e)}from(t,e){return e||(e=i=>i),this.compute([t],i=>e(i.field(t)))}}function Ny(s,t){return s==t||s.length==t.length&&s.every((e,i)=>e===t[i])}class qm{constructor(t,e,i,n){this.dependencies=t,this.facet=e,this.type=i,this.value=n,this.id=Qy++}dynamicSlot(t){var e;let i=this.value,n=this.facet.compareInput,r=this.id,o=t[r]>>1,l=this.type==2,a=!1,c=!1,h=[];for(let f of this.dependencies)f=="doc"?a=!0:f=="selection"?c=!0:(((e=t[f.id])!==null&&e!==void 0?e:1)&1)==0&&h.push(t[f.id]);return{create(f){return f.values[o]=i(f),1},update(f,m){if(a&&m.docChanged||c&&(m.docChanged||m.selection)||S1(f,h)){let w=i(f);if(l?!SP(w,f.values[o],n):!n(w,f.values[o]))return f.values[o]=w,1}return 0},reconfigure:(f,m)=>{let w,O=m.config.address[r];if(O!=null){let _=Ug(m,O);if(this.dependencies.every(k=>k instanceof Pe?m.facet(k)===f.facet(k):k instanceof Pn?m.field(k,!1)==f.field(k,!1):!0)||(l?SP(w=i(f),_,n):n(w=i(f),_)))return f.values[o]=_,0}else w=i(f);return f.values[o]=w,1}}}}function SP(s,t,e){if(s.length!=t.length)return!1;for(let i=0;i<s.length;i++)if(!e(s[i],t[i]))return!1;return!0}function S1(s,t){let e=!1;for(let i of t)wh(s,i)&1&&(e=!0);return e}function gie(s,t,e){let i=e.map(a=>s[a.id]),n=e.map(a=>a.type),r=i.filter(a=>!(a&1)),o=s[t.id]>>1;function l(a){let c=[];for(let h=0;h<i.length;h++){let f=Ug(a,i[h]);if(n[h]==2)for(let m of f)c.push(m);else c.push(f)}return t.combine(c)}return{create(a){for(let c of i)wh(a,c);return a.values[o]=l(a),1},update(a,c){if(!S1(a,r))return 0;let h=l(a);return t.compare(h,a.values[o])?0:(a.values[o]=h,1)},reconfigure(a,c){let h=S1(a,i),f=c.config.facets[t.id],m=c.facet(t);if(f&&!h&&Ny(e,f))return a.values[o]=m,0;let w=l(a);return t.compare(w,m)?(a.values[o]=m,0):(a.values[o]=w,1)}}}const cm=Pe.define({static:!0});class Pn{constructor(t,e,i,n,r){this.id=t,this.createF=e,this.updateF=i,this.compareF=n,this.spec=r,this.provides=void 0}static define(t){let e=new Pn(Qy++,t.create,t.update,t.compare||((i,n)=>i===n),t);return t.provide&&(e.provides=t.provide(e)),e}create(t){let e=t.facet(cm).find(i=>i.field==this);return((e==null?void 0:e.create)||this.createF)(t)}slot(t){let e=t[this.id]>>1;return{create:i=>(i.values[e]=this.create(i),1),update:(i,n)=>{let r=i.values[e],o=this.updateF(r,n);return this.compareF(r,o)?0:(i.values[e]=o,1)},reconfigure:(i,n)=>{let r=i.facet(cm),o=n.facet(cm),l;return(l=r.find(a=>a.field==this))&&l!=o.find(a=>a.field==this)?(i.values[e]=l.create(i),1):n.config.address[this.id]!=null?(i.values[e]=n.field(this),0):(i.values[e]=this.create(i),1)}}}init(t){return[this,cm.of({field:this,create:t})]}get extension(){return this}}const pl={lowest:4,low:3,default:2,high:1,highest:0};function Du(s){return t=>new H4(t,s)}const zo={highest:Du(pl.highest),high:Du(pl.high),default:Du(pl.default),low:Du(pl.low),lowest:Du(pl.lowest)};class H4{constructor(t,e){this.inner=t,this.prec=e}}class Od{of(t){return new C1(this,t)}reconfigure(t){return Od.reconfigure.of({compartment:this,extension:t})}get(t){return t.config.compartments.get(this)}}class C1{constructor(t,e){this.compartment=t,this.inner=e}}class Wg{constructor(t,e,i,n,r,o){for(this.base=t,this.compartments=e,this.dynamicSlots=i,this.address=n,this.staticValues=r,this.facets=o,this.statusTemplate=[];this.statusTemplate.length<i.length;)this.statusTemplate.push(0)}staticFacet(t){let e=this.address[t.id];return e==null?t.default:this.staticValues[e>>1]}static resolve(t,e,i){let n=[],r=Object.create(null),o=new Map;for(let m of pie(t,e,o))m instanceof Pn?n.push(m):(r[m.facet.id]||(r[m.facet.id]=[])).push(m);let l=Object.create(null),a=[],c=[];for(let m of n)l[m.id]=c.length<<1,c.push(w=>m.slot(w));let h=i==null?void 0:i.config.facets;for(let m in r){let w=r[m],O=w[0].facet,_=h&&h[m]||[];if(w.every(k=>k.type==0))if(l[O.id]=a.length<<1|1,Ny(_,w))a.push(i.facet(O));else{let k=O.combine(w.map(C=>C.value));a.push(i&&O.compare(k,i.facet(O))?i.facet(O):k)}else{for(let k of w)k.type==0?(l[k.id]=a.length<<1|1,a.push(k.value)):(l[k.id]=c.length<<1,c.push(C=>k.dynamicSlot(C)));l[O.id]=c.length<<1,c.push(k=>gie(k,O,w))}}let f=c.map(m=>m(l));return new Wg(t,o,f,l,a,r)}}function pie(s,t,e){let i=[[],[],[],[],[]],n=new Map;function r(o,l){let a=n.get(o);if(a!=null){if(a<=l)return;let c=i[a].indexOf(o);c>-1&&i[a].splice(c,1),o instanceof C1&&e.delete(o.compartment)}if(n.set(o,l),Array.isArray(o))for(let c of o)r(c,l);else if(o instanceof C1){if(e.has(o.compartment))throw new RangeError("Duplicate use of compartment in extensions");let c=t.get(o.compartment)||o.inner;e.set(o.compartment,c),r(c,l)}else if(o instanceof H4)r(o.inner,o.prec);else if(o instanceof Pn)i[l].push(o),o.provides&&r(o.provides,l);else if(o instanceof qm)i[l].push(o),o.facet.extensions&&r(o.facet.extensions,pl.default);else{let c=o.extension;if(!c)throw new Error(`Unrecognized extension value in extension set (${o}). This sometimes happens because multiple instances of @codemirror/state are loaded, breaking instanceof checks.`);r(c,l)}}return r(s,pl.default),i.reduce((o,l)=>o.concat(l))}function wh(s,t){if(t&1)return 2;let e=t>>1,i=s.status[e];if(i==4)throw new Error("Cyclic dependency between fields and/or facets");if(i&2)return i;s.status[e]=4;let n=s.computeSlot(s,s.config.dynamicSlots[e]);return s.status[e]=2|n}function Ug(s,t){return t&1?s.config.staticValues[t>>1]:s.values[t>>1]}const q4=Pe.define(),P1=Pe.define({combine:s=>s.some(t=>t),static:!0}),j4=Pe.define({combine:s=>s.length?s[0]:void 0,static:!0}),X4=Pe.define(),G4=Pe.define(),Y4=Pe.define(),K4=Pe.define({combine:s=>s.length?s[0]:!1});class Zr{constructor(t,e){this.type=t,this.value=e}static define(){return new wie}}class wie{of(t){return new Zr(this,t)}}class xie{constructor(t){this.map=t}of(t){return new rt(this,t)}}class rt{constructor(t,e){this.type=t,this.value=e}map(t){let e=this.type.map(this.value,t);return e===void 0?void 0:e==this.value?this:new rt(this.type,e)}is(t){return this.type==t}static define(t={}){return new xie(t.map||(e=>e))}static mapEffects(t,e){if(!t.length)return t;let i=[];for(let n of t){let r=n.map(e);r&&i.push(r)}return i}}rt.reconfigure=rt.define();rt.appendConfig=rt.define();class Jt{constructor(t,e,i,n,r,o){this.startState=t,this.changes=e,this.selection=i,this.effects=n,this.annotations=r,this.scrollIntoView=o,this._doc=null,this._state=null,i&&Z4(i,e.newLength),r.some(l=>l.type==Jt.time)||(this.annotations=r.concat(Jt.time.of(Date.now())))}static create(t,e,i,n,r,o){return new Jt(t,e,i,n,r,o)}get newDoc(){return this._doc||(this._doc=this.changes.apply(this.startState.doc))}get newSelection(){return this.selection||this.startState.selection.map(this.changes)}get state(){return this._state||this.startState.applyTransaction(this),this._state}annotation(t){for(let e of this.annotations)if(e.type==t)return e.value}get docChanged(){return!this.changes.empty}get reconfigured(){return this.startState.config!=this.state.config}isUserEvent(t){let e=this.annotation(Jt.userEvent);return!!(e&&(e==t||e.length>t.length&&e.slice(0,t.length)==t&&e[t.length]=="."))}}Jt.time=Zr.define();Jt.userEvent=Zr.define();Jt.addToHistory=Zr.define();Jt.remote=Zr.define();function bie(s,t){let e=[];for(let i=0,n=0;;){let r,o;if(i<s.length&&(n==t.length||t[n]>=s[i]))r=s[i++],o=s[i++];else if(n<t.length)r=t[n++],o=t[n++];else return e;!e.length||e[e.length-1]<r?e.push(r,o):e[e.length-1]<o&&(e[e.length-1]=o)}}function J4(s,t,e){var i;let n,r,o;return e?(n=t.changes,r=ci.empty(t.changes.length),o=s.changes.compose(t.changes)):(n=t.changes.map(s.changes),r=s.changes.mapDesc(t.changes,!0),o=s.changes.compose(n)),{changes:o,selection:t.selection?t.selection.map(r):(i=s.selection)===null||i===void 0?void 0:i.map(n),effects:rt.mapEffects(s.effects,n).concat(rt.mapEffects(t.effects,r)),annotations:s.annotations.length?s.annotations.concat(t.annotations):t.annotations,scrollIntoView:s.scrollIntoView||t.scrollIntoView}}function T1(s,t,e){let i=t.selection,n=oc(t.annotations);return t.userEvent&&(n=n.concat(Jt.userEvent.of(t.userEvent))),{changes:t.changes instanceof ci?t.changes:ci.of(t.changes||[],e,s.facet(j4)),selection:i&&(i instanceof se?i:se.single(i.anchor,i.head)),effects:oc(t.effects),annotations:n,scrollIntoView:!!t.scrollIntoView}}function e3(s,t,e){let i=T1(s,t.length?t[0]:{},s.doc.length);t.length&&t[0].filter===!1&&(e=!1);for(let r=1;r<t.length;r++){t[r].filter===!1&&(e=!1);let o=!!t[r].sequential;i=J4(i,T1(s,t[r],o?i.changes.newLength:s.doc.length),o)}let n=Jt.create(s,i.changes,i.selection,i.effects,i.annotations,i.scrollIntoView);return yie(e?Oie(n):n)}function Oie(s){let t=s.startState,e=!0;for(let n of t.facet(X4)){let r=n(s);if(r===!1){e=!1;break}Array.isArray(r)&&(e=e===!0?r:bie(e,r))}if(e!==!0){let n,r;if(e===!1)r=s.changes.invertedDesc,n=ci.empty(t.doc.length);else{let o=s.changes.filter(e);n=o.changes,r=o.filtered.mapDesc(o.changes).invertedDesc}s=Jt.create(t,n,s.selection&&s.selection.map(r),rt.mapEffects(s.effects,r),s.annotations,s.scrollIntoView)}let i=t.facet(G4);for(let n=i.length-1;n>=0;n--){let r=i[n](s);r instanceof Jt?s=r:Array.isArray(r)&&r.length==1&&r[0]instanceof Jt?s=r[0]:s=e3(t,oc(r),!1)}return s}function yie(s){let t=s.startState,e=t.facet(Y4),i=s;for(let n=e.length-1;n>=0;n--){let r=e[n](s);r&&Object.keys(r).length&&(i=J4(i,T1(t,r,s.changes.newLength),!0))}return i==s?s:Jt.create(t,s.changes,s.selection,i.effects,i.annotations,i.scrollIntoView)}const vie=[];function oc(s){return s==null?vie:Array.isArray(s)?s:[s]}var ss=function(s){return s[s.Word=0]="Word",s[s.Space=1]="Space",s[s.Other=2]="Other",s}(ss||(ss={}));const _ie=/[\u00df\u0587\u0590-\u05f4\u0600-\u06ff\u3040-\u309f\u30a0-\u30ff\u3400-\u4db5\u4e00-\u9fcc\uac00-\ud7af]/;let E1;try{E1=new RegExp("[\\p{Alphabetic}\\p{Number}_]","u")}catch{}function kie(s){if(E1)return E1.test(s);for(let t=0;t<s.length;t++){let e=s[t];if(/\w/.test(e)||e>""&&(e.toUpperCase()!=e.toLowerCase()||_ie.test(e)))return!0}return!1}function Sie(s){return t=>{if(!/\S/.test(t))return ss.Space;if(kie(t))return ss.Word;for(let e=0;e<s.length;e++)if(t.indexOf(s[e])>-1)return ss.Word;return ss.Other}}class ht{constructor(t,e,i,n,r,o){this.config=t,this.doc=e,this.selection=i,this.values=n,this.status=t.statusTemplate.slice(),this.computeSlot=r,o&&(o._state=this);for(let l=0;l<this.config.dynamicSlots.length;l++)wh(this,l<<1);this.computeSlot=null}field(t,e=!0){let i=this.config.address[t.id];if(i==null){if(e)throw new RangeError("Field is not present in this state");return}return wh(this,i),Ug(this,i)}update(...t){return e3(this,t,!0)}applyTransaction(t){let e=this.config,{base:i,compartments:n}=e;for(let l of t.effects)l.is(Od.reconfigure)?(e&&(n=new Map,e.compartments.forEach((a,c)=>n.set(c,a)),e=null),n.set(l.value.compartment,l.value.extension)):l.is(rt.reconfigure)?(e=null,i=l.value):l.is(rt.appendConfig)&&(e=null,i=oc(i).concat(l.value));let r;e?r=t.startState.values.slice():(e=Wg.resolve(i,n,this),r=new ht(e,this.doc,this.selection,e.dynamicSlots.map(()=>null),(a,c)=>c.reconfigure(a,this),null).values);let o=t.startState.facet(P1)?t.newSelection:t.newSelection.asSingle();new ht(e,t.newDoc,o,r,(l,a)=>a.update(l,t),t)}replaceSelection(t){return typeof t=="string"&&(t=this.toText(t)),this.changeByRange(e=>({changes:{from:e.from,to:e.to,insert:t},range:se.cursor(e.from+t.length)}))}changeByRange(t){let e=this.selection,i=t(e.ranges[0]),n=this.changes(i.changes),r=[i.range],o=oc(i.effects);for(let l=1;l<e.ranges.length;l++){let a=t(e.ranges[l]),c=this.changes(a.changes),h=c.map(n);for(let m=0;m<l;m++)r[m]=r[m].map(h);let f=n.mapDesc(c,!0);r.push(a.range.map(f)),n=n.compose(h),o=rt.mapEffects(o,h).concat(rt.mapEffects(oc(a.effects),f))}return{changes:n,selection:se.create(r,e.mainIndex),effects:o}}changes(t=[]){return t instanceof ci?t:ci.of(t,this.doc.length,this.facet(ht.lineSeparator))}toText(t){return Ke.of(t.split(this.facet(ht.lineSeparator)||v1))}sliceDoc(t=0,e=this.doc.length){return this.doc.sliceString(t,e,this.lineBreak)}facet(t){let e=this.config.address[t.id];return e==null?t.default:(wh(this,e),Ug(this,e))}toJSON(t){let e={doc:this.sliceDoc(),selection:this.selection.toJSON()};if(t)for(let i in t){let n=t[i];n instanceof Pn&&this.config.address[n.id]!=null&&(e[i]=n.spec.toJSON(this.field(t[i]),this))}return e}static fromJSON(t,e={},i){if(!t||typeof t.doc!="string")throw new RangeError("Invalid JSON representation for EditorState");let n=[];if(i){for(let r in i)if(Object.prototype.hasOwnProperty.call(t,r)){let o=i[r],l=t[r];n.push(o.init(a=>o.spec.fromJSON(l,a)))}}return ht.create({doc:t.doc,selection:se.fromJSON(t.selection),extensions:e.extensions?n.concat([e.extensions]):n})}static create(t={}){let e=Wg.resolve(t.extensions||[],new Map),i=t.doc instanceof Ke?t.doc:Ke.of((t.doc||"").split(e.staticFacet(ht.lineSeparator)||v1)),n=t.selection?t.selection instanceof se?t.selection:se.single(t.selection.anchor,t.selection.head):se.single(0);return Z4(n,i.length),e.staticFacet(P1)||(n=n.asSingle()),new ht(e,i,n,e.dynamicSlots.map(()=>null),(r,o)=>o.create(r),null)}get tabSize(){return this.facet(ht.tabSize)}get lineBreak(){return this.facet(ht.lineSeparator)||`
`}get readOnly(){return this.facet(K4)}phrase(t,...e){for(let i of this.facet(ht.phrases))if(Object.prototype.hasOwnProperty.call(i,t)){t=i[t];break}return e.length&&(t=t.replace(/\$(\$|\d*)/g,(i,n)=>{if(n=="$")return"$";let r=+(n||1);return!r||r>e.length?i:e[r-1]})),t}languageDataAt(t,e,i=-1){let n=[];for(let r of this.facet(q4))for(let o of r(this,e,i))Object.prototype.hasOwnProperty.call(o,t)&&n.push(o[t]);return n}charCategorizer(t){return Sie(this.languageDataAt("wordChars",t).join(""))}wordAt(t){let{text:e,from:i,length:n}=this.doc.lineAt(t),r=this.charCategorizer(t),o=t-i,l=t-i;for(;o>0;){let a=en(e,o,!1);if(r(e.slice(a,o))!=ss.Word)break;o=a}for(;l<n;){let a=en(e,l);if(r(e.slice(l,a))!=ss.Word)break;l=a}return o==l?null:se.range(o+i,l+i)}}ht.allowMultipleSelections=P1;ht.tabSize=Pe.define({combine:s=>s.length?s[0]:4});ht.lineSeparator=j4;ht.readOnly=K4;ht.phrases=Pe.define({compare(s,t){let e=Object.keys(s),i=Object.keys(t);return e.length==i.length&&e.every(n=>s[n]==t[n])}});ht.languageData=q4;ht.changeFilter=X4;ht.transactionFilter=G4;ht.transactionExtender=Y4;Od.reconfigure=rt.define();function Kl(s,t,e={}){let i={};for(let n of s)for(let r of Object.keys(n)){let o=n[r],l=i[r];if(l===void 0)i[r]=o;else if(!(l===o||o===void 0))if(Object.hasOwnProperty.call(e,r))i[r]=e[r](l,o);else throw new Error("Config merge conflict for field "+r)}for(let n in t)i[n]===void 0&&(i[n]=t[n]);return i}class Rl{eq(t){return this==t}range(t,e=t){return A1.create(t,e,this)}}Rl.prototype.startSide=Rl.prototype.endSide=0;Rl.prototype.point=!1;Rl.prototype.mapMode=Wi.TrackDel;let A1=class t3{constructor(t,e,i){this.from=t,this.to=e,this.value=i}static create(t,e,i){return new t3(t,e,i)}};function I1(s,t){return s.from-t.from||s.value.startSide-t.value.startSide}class Fy{constructor(t,e,i,n){this.from=t,this.to=e,this.value=i,this.maxPoint=n}get length(){return this.to[this.to.length-1]}findIndex(t,e,i,n=0){let r=i?this.to:this.from;for(let o=n,l=r.length;;){if(o==l)return o;let a=o+l>>1,c=r[a]-t||(i?this.value[a].endSide:this.value[a].startSide)-e;if(a==o)return c>=0?o:l;c>=0?l=a:o=a+1}}between(t,e,i,n){for(let r=this.findIndex(e,-1e9,!0),o=this.findIndex(i,1e9,!1,r);r<o;r++)if(n(this.from[r]+t,this.to[r]+t,this.value[r])===!1)return!1}map(t,e){let i=[],n=[],r=[],o=-1,l=-1;for(let a=0;a<this.value.length;a++){let c=this.value[a],h=this.from[a]+t,f=this.to[a]+t,m,w;if(h==f){let O=e.mapPos(h,c.startSide,c.mapMode);if(O==null||(m=w=O,c.startSide!=c.endSide&&(w=e.mapPos(h,c.endSide),w<m)))continue}else if(m=e.mapPos(h,c.startSide),w=e.mapPos(f,c.endSide),m>w||m==w&&c.startSide>0&&c.endSide<=0)continue;(w-m||c.endSide-c.startSide)<0||(o<0&&(o=m),c.point&&(l=Math.max(l,w-m)),i.push(c),n.push(m-o),r.push(w-o))}return{mapped:i.length?new Fy(n,r,i,l):null,pos:o}}}class st{constructor(t,e,i,n){this.chunkPos=t,this.chunk=e,this.nextLayer=i,this.maxPoint=n}static create(t,e,i,n){return new st(t,e,i,n)}get length(){let t=this.chunk.length-1;return t<0?0:Math.max(this.chunkEnd(t),this.nextLayer.length)}get size(){if(this.isEmpty)return 0;let t=this.nextLayer.size;for(let e of this.chunk)t+=e.value.length;return t}chunkEnd(t){return this.chunkPos[t]+this.chunk[t].length}update(t){let{add:e=[],sort:i=!1,filterFrom:n=0,filterTo:r=this.length}=t,o=t.filter;if(e.length==0&&!o)return this;if(i&&(e=e.slice().sort(I1)),this.isEmpty)return e.length?st.of(e):this;let l=new i3(this,null,-1).goto(0),a=0,c=[],h=new Vl;for(;l.value||a<e.length;)if(a<e.length&&(l.from-e[a].from||l.startSide-e[a].value.startSide)>=0){let f=e[a++];h.addInner(f.from,f.to,f.value)||c.push(f)}else l.rangeIndex==1&&l.chunkIndex<this.chunk.length&&(a==e.length||this.chunkEnd(l.chunkIndex)<e[a].from)&&(!o||n>this.chunkEnd(l.chunkIndex)||r<this.chunkPos[l.chunkIndex])&&h.addChunk(this.chunkPos[l.chunkIndex],this.chunk[l.chunkIndex])?l.nextChunk():((!o||n>l.to||r<l.from||o(l.from,l.to,l.value))&&(h.addInner(l.from,l.to,l.value)||c.push(A1.create(l.from,l.to,l.value))),l.next());return h.finishInner(this.nextLayer.isEmpty&&!c.length?st.empty:this.nextLayer.update({add:c,filter:o,filterFrom:n,filterTo:r}))}map(t){if(t.empty||this.isEmpty)return this;let e=[],i=[],n=-1;for(let o=0;o<this.chunk.length;o++){let l=this.chunkPos[o],a=this.chunk[o],c=t.touchesRange(l,l+a.length);if(c===!1)n=Math.max(n,a.maxPoint),e.push(a),i.push(t.mapPos(l));else if(c===!0){let{mapped:h,pos:f}=a.map(l,t);h&&(n=Math.max(n,h.maxPoint),e.push(h),i.push(f))}}let r=this.nextLayer.map(t);return e.length==0?r:new st(i,e,r||st.empty,n)}between(t,e,i){if(!this.isEmpty){for(let n=0;n<this.chunk.length;n++){let r=this.chunkPos[n],o=this.chunk[n];if(e>=r&&t<=r+o.length&&o.between(r,t-r,e-r,i)===!1)return}this.nextLayer.between(t,e,i)}}iter(t=0){return zh.from([this]).goto(t)}get isEmpty(){return this.nextLayer==this}static iter(t,e=0){return zh.from(t).goto(e)}static compare(t,e,i,n,r=-1){let o=t.filter(f=>f.maxPoint>0||!f.isEmpty&&f.maxPoint>=r),l=e.filter(f=>f.maxPoint>0||!f.isEmpty&&f.maxPoint>=r),a=CP(o,l,i),c=new Qu(o,a,r),h=new Qu(l,a,r);i.iterGaps((f,m,w)=>PP(c,f,h,m,w,n)),i.empty&&i.length==0&&PP(c,0,h,0,0,n)}static eq(t,e,i=0,n){n==null&&(n=999999999);let r=t.filter(h=>!h.isEmpty&&e.indexOf(h)<0),o=e.filter(h=>!h.isEmpty&&t.indexOf(h)<0);if(r.length!=o.length)return!1;if(!r.length)return!0;let l=CP(r,o),a=new Qu(r,l,0).goto(i),c=new Qu(o,l,0).goto(i);for(;;){if(a.to!=c.to||!R1(a.active,c.active)||a.point&&(!c.point||!a.point.eq(c.point)))return!1;if(a.to>n)return!0;a.next(),c.next()}}static spans(t,e,i,n,r=-1){let o=new Qu(t,null,r).goto(e),l=e,a=o.openStart;for(;;){let c=Math.min(o.to,i);if(o.point){let h=o.activeForPoint(o.to),f=o.pointFrom<e?h.length+1:o.point.startSide<0?h.length:Math.min(h.length,a);n.point(l,c,o.point,h,f,o.pointRank),a=Math.min(o.openEnd(c),h.length)}else c>l&&(n.span(l,c,o.active,a),a=o.openEnd(c));if(o.to>i)return a+(o.point&&o.to>i?1:0);l=o.to,o.next()}}static of(t,e=!1){let i=new Vl;for(let n of t instanceof A1?[t]:e?Cie(t):t)i.add(n.from,n.to,n.value);return i.finish()}static join(t){if(!t.length)return st.empty;let e=t[t.length-1];for(let i=t.length-2;i>=0;i--)for(let n=t[i];n!=st.empty;n=n.nextLayer)e=new st(n.chunkPos,n.chunk,e,Math.max(n.maxPoint,e.maxPoint));return e}}st.empty=new st([],[],null,-1);function Cie(s){if(s.length>1)for(let t=s[0],e=1;e<s.length;e++){let i=s[e];if(I1(t,i)>0)return s.slice().sort(I1);t=i}return s}st.empty.nextLayer=st.empty;class Vl{finishChunk(t){this.chunks.push(new Fy(this.from,this.to,this.value,this.maxPoint)),this.chunkPos.push(this.chunkStart),this.chunkStart=-1,this.setMaxPoint=Math.max(this.setMaxPoint,this.maxPoint),this.maxPoint=-1,t&&(this.from=[],this.to=[],this.value=[])}constructor(){this.chunks=[],this.chunkPos=[],this.chunkStart=-1,this.last=null,this.lastFrom=-1e9,this.lastTo=-1e9,this.from=[],this.to=[],this.value=[],this.maxPoint=-1,this.setMaxPoint=-1,this.nextLayer=null}add(t,e,i){this.addInner(t,e,i)||(this.nextLayer||(this.nextLayer=new Vl)).add(t,e,i)}addInner(t,e,i){let n=t-this.lastTo||i.startSide-this.last.endSide;if(n<=0&&(t-this.lastFrom||i.startSide-this.last.startSide)<0)throw new Error("Ranges must be added sorted by `from` position and `startSide`");return n<0?!1:(this.from.length==250&&this.finishChunk(!0),this.chunkStart<0&&(this.chunkStart=t),this.from.push(t-this.chunkStart),this.to.push(e-this.chunkStart),this.last=i,this.lastFrom=t,this.lastTo=e,this.value.push(i),i.point&&(this.maxPoint=Math.max(this.maxPoint,e-t)),!0)}addChunk(t,e){if((t-this.lastTo||e.value[0].startSide-this.last.endSide)<0)return!1;this.from.length&&this.finishChunk(!0),this.setMaxPoint=Math.max(this.setMaxPoint,e.maxPoint),this.chunks.push(e),this.chunkPos.push(t);let i=e.value.length-1;return this.last=e.value[i],this.lastFrom=e.from[i]+t,this.lastTo=e.to[i]+t,!0}finish(){return this.finishInner(st.empty)}finishInner(t){if(this.from.length&&this.finishChunk(!1),this.chunks.length==0)return t;let e=st.create(this.chunkPos,this.chunks,this.nextLayer?this.nextLayer.finishInner(t):t,this.setMaxPoint);return this.from=null,e}}function CP(s,t,e){let i=new Map;for(let r of s)for(let o=0;o<r.chunk.length;o++)r.chunk[o].maxPoint<=0&&i.set(r.chunk[o],r.chunkPos[o]);let n=new Set;for(let r of t)for(let o=0;o<r.chunk.length;o++){let l=i.get(r.chunk[o]);l!=null&&(e?e.mapPos(l):l)==r.chunkPos[o]&&!(e!=null&&e.touchesRange(l,l+r.chunk[o].length))&&n.add(r.chunk[o])}return n}class i3{constructor(t,e,i,n=0){this.layer=t,this.skip=e,this.minPoint=i,this.rank=n}get startSide(){return this.value?this.value.startSide:0}get endSide(){return this.value?this.value.endSide:0}goto(t,e=-1e9){return this.chunkIndex=this.rangeIndex=0,this.gotoInner(t,e,!1),this}gotoInner(t,e,i){for(;this.chunkIndex<this.layer.chunk.length;){let n=this.layer.chunk[this.chunkIndex];if(!(this.skip&&this.skip.has(n)||this.layer.chunkEnd(this.chunkIndex)<t||n.maxPoint<this.minPoint))break;this.chunkIndex++,i=!1}if(this.chunkIndex<this.layer.chunk.length){let n=this.layer.chunk[this.chunkIndex].findIndex(t-this.layer.chunkPos[this.chunkIndex],e,!0);(!i||this.rangeIndex<n)&&this.setRangeIndex(n)}this.next()}forward(t,e){(this.to-t||this.endSide-e)<0&&this.gotoInner(t,e,!0)}next(){for(;;)if(this.chunkIndex==this.layer.chunk.length){this.from=this.to=1e9,this.value=null;break}else{let t=this.layer.chunkPos[this.chunkIndex],e=this.layer.chunk[this.chunkIndex],i=t+e.from[this.rangeIndex];if(this.from=i,this.to=t+e.to[this.rangeIndex],this.value=e.value[this.rangeIndex],this.setRangeIndex(this.rangeIndex+1),this.minPoint<0||this.value.point&&this.to-this.from>=this.minPoint)break}}setRangeIndex(t){if(t==this.layer.chunk[this.chunkIndex].value.length){if(this.chunkIndex++,this.skip)for(;this.chunkIndex<this.layer.chunk.length&&this.skip.has(this.layer.chunk[this.chunkIndex]);)this.chunkIndex++;this.rangeIndex=0}else this.rangeIndex=t}nextChunk(){this.chunkIndex++,this.rangeIndex=0,this.next()}compare(t){return this.from-t.from||this.startSide-t.startSide||this.rank-t.rank||this.to-t.to||this.endSide-t.endSide}}class zh{constructor(t){this.heap=t}static from(t,e=null,i=-1){let n=[];for(let r=0;r<t.length;r++)for(let o=t[r];!o.isEmpty;o=o.nextLayer)o.maxPoint>=i&&n.push(new i3(o,e,i,r));return n.length==1?n[0]:new zh(n)}get startSide(){return this.value?this.value.startSide:0}goto(t,e=-1e9){for(let i of this.heap)i.goto(t,e);for(let i=this.heap.length>>1;i>=0;i--)Qx(this.heap,i);return this.next(),this}forward(t,e){for(let i of this.heap)i.forward(t,e);for(let i=this.heap.length>>1;i>=0;i--)Qx(this.heap,i);(this.to-t||this.value.endSide-e)<0&&this.next()}next(){if(this.heap.length==0)this.from=this.to=1e9,this.value=null,this.rank=-1;else{let t=this.heap[0];this.from=t.from,this.to=t.to,this.value=t.value,this.rank=t.rank,t.value&&t.next(),Qx(this.heap,0)}}}function Qx(s,t){for(let e=s[t];;){let i=(t<<1)+1;if(i>=s.length)break;let n=s[i];if(i+1<s.length&&n.compare(s[i+1])>=0&&(n=s[i+1],i++),e.compare(n)<0)break;s[i]=e,s[t]=n,t=i}}class Qu{constructor(t,e,i){this.minPoint=i,this.active=[],this.activeTo=[],this.activeRank=[],this.minActive=-1,this.point=null,this.pointFrom=0,this.pointRank=0,this.to=-1e9,this.endSide=0,this.openStart=-1,this.cursor=zh.from(t,e,i)}goto(t,e=-1e9){return this.cursor.goto(t,e),this.active.length=this.activeTo.length=this.activeRank.length=0,this.minActive=-1,this.to=t,this.endSide=e,this.openStart=-1,this.next(),this}forward(t,e){for(;this.minActive>-1&&(this.activeTo[this.minActive]-t||this.active[this.minActive].endSide-e)<0;)this.removeActive(this.minActive);this.cursor.forward(t,e)}removeActive(t){um(this.active,t),um(this.activeTo,t),um(this.activeRank,t),this.minActive=TP(this.active,this.activeTo)}addActive(t){let e=0,{value:i,to:n,rank:r}=this.cursor;for(;e<this.activeRank.length&&(r-this.activeRank[e]||n-this.activeTo[e])>0;)e++;hm(this.active,e,i),hm(this.activeTo,e,n),hm(this.activeRank,e,r),t&&hm(t,e,this.cursor.from),this.minActive=TP(this.active,this.activeTo)}next(){let t=this.to,e=this.point;this.point=null;let i=this.openStart<0?[]:null;for(;;){let n=this.minActive;if(n>-1&&(this.activeTo[n]-this.cursor.from||this.active[n].endSide-this.cursor.startSide)<0){if(this.activeTo[n]>t){this.to=this.activeTo[n],this.endSide=this.active[n].endSide;break}this.removeActive(n),i&&um(i,n)}else if(this.cursor.value)if(this.cursor.from>t){this.to=this.cursor.from,this.endSide=this.cursor.startSide;break}else{let r=this.cursor.value;if(!r.point)this.addActive(i),this.cursor.next();else if(e&&this.cursor.to==this.to&&this.cursor.from<this.cursor.to)this.cursor.next();else{this.point=r,this.pointFrom=this.cursor.from,this.pointRank=this.cursor.rank,this.to=this.cursor.to,this.endSide=r.endSide,this.cursor.next(),this.forward(this.to,this.endSide);break}}else{this.to=this.endSide=1e9;break}}if(i){this.openStart=0;for(let n=i.length-1;n>=0&&i[n]<t;n--)this.openStart++}}activeForPoint(t){if(!this.active.length)return this.active;let e=[];for(let i=this.active.length-1;i>=0&&!(this.activeRank[i]<this.pointRank);i--)(this.activeTo[i]>t||this.activeTo[i]==t&&this.active[i].endSide>=this.point.endSide)&&e.push(this.active[i]);return e.reverse()}openEnd(t){let e=0;for(let i=this.activeTo.length-1;i>=0&&this.activeTo[i]>t;i--)e++;return e}}function PP(s,t,e,i,n,r){s.goto(t),e.goto(i);let o=i+n,l=i,a=i-t;for(;;){let c=s.to+a-e.to,h=c||s.endSide-e.endSide,f=h<0?s.to+a:e.to,m=Math.min(f,o);if(s.point||e.point?s.point&&e.point&&(s.point==e.point||s.point.eq(e.point))&&R1(s.activeForPoint(s.to),e.activeForPoint(e.to))||r.comparePoint(l,m,s.point,e.point):m>l&&!R1(s.active,e.active)&&r.compareRange(l,m,s.active,e.active),f>o)break;(c||s.openEnd!=e.openEnd)&&r.boundChange&&r.boundChange(f),l=f,h<=0&&s.next(),h>=0&&e.next()}}function R1(s,t){if(s.length!=t.length)return!1;for(let e=0;e<s.length;e++)if(s[e]!=t[e]&&!s[e].eq(t[e]))return!1;return!0}function um(s,t){for(let e=t,i=s.length-1;e<i;e++)s[e]=s[e+1];s.pop()}function hm(s,t,e){for(let i=s.length-1;i>=t;i--)s[i+1]=s[i];s[t]=e}function TP(s,t){let e=-1,i=1e9;for(let n=0;n<t.length;n++)(t[n]-i||s[n].endSide-s[e].endSide)<0&&(e=n,i=t[n]);return e}function $s(s,t,e=s.length){let i=0;for(let n=0;n<e&&n<s.length;)s.charCodeAt(n)==9?(i+=t-i%t,n++):(i++,n=en(s,n));return i}function V1(s,t,e,i){for(let n=0,r=0;;){if(r>=t)return n;if(n==s.length)break;r+=s.charCodeAt(n)==9?e-r%e:1,n=en(s,n)}return i===!0?-1:s.length}const M1="ͼ",EP=typeof Symbol>"u"?"__"+M1:Symbol.for(M1),L1=typeof Symbol>"u"?"__styleSet"+Math.floor(Math.random()*1e8):Symbol("styleSet"),AP=typeof globalThis<"u"?globalThis:typeof window<"u"?window:{};class Lo{constructor(t,e){this.rules=[];let{finish:i}=e||{};function n(o){return/^@/.test(o)?[o]:o.split(/,\s*/)}function r(o,l,a,c){let h=[],f=/^@(\w+)\b/.exec(o[0]),m=f&&f[1]=="keyframes";if(f&&l==null)return a.push(o[0]+";");for(let w in l){let O=l[w];if(/&/.test(w))r(w.split(/,\s*/).map(_=>o.map(k=>_.replace(/&/,k))).reduce((_,k)=>_.concat(k)),O,a);else if(O&&typeof O=="object"){if(!f)throw new RangeError("The value of a property ("+w+") should be a primitive value.");r(n(w),O,h,m)}else O!=null&&h.push(w.replace(/_.*/,"").replace(/[A-Z]/g,_=>"-"+_.toLowerCase())+": "+O+";")}(h.length||m)&&a.push((i&&!f&&!c?o.map(i):o).join(", ")+" {"+h.join(" ")+"}")}for(let o in t)r(n(o),t[o],this.rules)}getRules(){return this.rules.join(`
`)}static newName(){let t=AP[EP]||1;return AP[EP]=t+1,M1+t.toString(36)}static mount(t,e,i){let n=t[L1],r=i&&i.nonce;n?r&&n.setNonce(r):n=new Pie(t,r),n.mount(Array.isArray(e)?e:[e],t)}}let IP=new Map;class Pie{constructor(t,e){let i=t.ownerDocument||t,n=i.defaultView;if(!t.head&&t.adoptedStyleSheets&&n.CSSStyleSheet){let r=IP.get(i);if(r)return t[L1]=r;this.sheet=new n.CSSStyleSheet,IP.set(i,this)}else this.styleTag=i.createElement("style"),e&&this.styleTag.setAttribute("nonce",e);this.modules=[],t[L1]=this}mount(t,e){let i=this.sheet,n=0,r=0;for(let o=0;o<t.length;o++){let l=t[o],a=this.modules.indexOf(l);if(a<r&&a>-1&&(this.modules.splice(a,1),r--,a=-1),a==-1){if(this.modules.splice(r++,0,l),i)for(let c=0;c<l.rules.length;c++)i.insertRule(l.rules[c],n++)}else{for(;r<a;)n+=this.modules[r++].rules.length;n+=l.rules.length,r++}}if(i)e.adoptedStyleSheets.indexOf(this.sheet)<0&&(e.adoptedStyleSheets=[this.sheet,...e.adoptedStyleSheets]);else{let o="";for(let a=0;a<this.modules.length;a++)o+=this.modules[a].getRules()+`
`;this.styleTag.textContent=o;let l=e.head||e;this.styleTag.parentNode!=l&&l.insertBefore(this.styleTag,l.firstChild)}}setNonce(t){this.styleTag&&this.styleTag.getAttribute("nonce")!=t&&this.styleTag.setAttribute("nonce",t)}}var Bo={8:"Backspace",9:"Tab",10:"Enter",12:"NumLock",13:"Enter",16:"Shift",17:"Control",18:"Alt",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",44:"PrintScreen",45:"Insert",46:"Delete",59:";",61:"=",91:"Meta",92:"Meta",106:"*",107:"+",108:",",109:"-",110:".",111:"/",144:"NumLock",145:"ScrollLock",160:"Shift",161:"Shift",162:"Control",163:"Control",164:"Alt",165:"Alt",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},Wh={48:")",49:"!",50:"@",51:"#",52:"$",53:"%",54:"^",55:"&",56:"*",57:"(",59:":",61:"+",173:"_",186:":",187:"+",188:"<",189:"_",190:">",191:"?",192:"~",219:"{",220:"|",221:"}",222:'"'},Tie=typeof navigator<"u"&&/Mac/.test(navigator.platform),Eie=typeof navigator<"u"&&/MSIE \d|Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(navigator.userAgent);for(var Ai=0;Ai<10;Ai++)Bo[48+Ai]=Bo[96+Ai]=String(Ai);for(var Ai=1;Ai<=24;Ai++)Bo[Ai+111]="F"+Ai;for(var Ai=65;Ai<=90;Ai++)Bo[Ai]=String.fromCharCode(Ai+32),Wh[Ai]=String.fromCharCode(Ai);for(var Nx in Bo)Wh.hasOwnProperty(Nx)||(Wh[Nx]=Bo[Nx]);function Aie(s){var t=Tie&&s.metaKey&&s.shiftKey&&!s.ctrlKey&&!s.altKey||Eie&&s.shiftKey&&s.key&&s.key.length==1||s.key=="Unidentified",e=!t&&s.key||(s.shiftKey?Wh:Bo)[s.keyCode]||s.key||"Unidentified";return e=="Esc"&&(e="Escape"),e=="Del"&&(e="Delete"),e=="Left"&&(e="ArrowLeft"),e=="Up"&&(e="ArrowUp"),e=="Right"&&(e="ArrowRight"),e=="Down"&&(e="ArrowDown"),e}function Uh(s){let t;return s.nodeType==11?t=s.getSelection?s:s.ownerDocument:t=s,t.getSelection()}function B1(s,t){return t?s==t||s.contains(t.nodeType!=1?t.parentNode:t):!1}function jm(s,t){if(!t.anchorNode)return!1;try{return B1(s,t.anchorNode)}catch{return!1}}function Zh(s){return s.nodeType==3?Ll(s,0,s.nodeValue.length).getClientRects():s.nodeType==1?s.getClientRects():[]}function xh(s,t,e,i){return e?RP(s,t,e,i,-1)||RP(s,t,e,i,1):!1}function Ml(s){for(var t=0;;t++)if(s=s.previousSibling,!s)return t}function Zg(s){return s.nodeType==1&&/^(DIV|P|LI|UL|OL|BLOCKQUOTE|DD|DT|H\d|SECTION|PRE)$/.test(s.nodeName)}function RP(s,t,e,i,n){for(;;){if(s==e&&t==i)return!0;if(t==(n<0?0:ur(s))){if(s.nodeName=="DIV")return!1;let r=s.parentNode;if(!r||r.nodeType!=1)return!1;t=Ml(s)+(n<0?0:1),s=r}else if(s.nodeType==1){if(s=s.childNodes[t+(n<0?-1:0)],s.nodeType==1&&s.contentEditable=="false")return!1;t=n<0?ur(s):0}else return!1}}function ur(s){return s.nodeType==3?s.nodeValue.length:s.childNodes.length}function Dp(s,t){let e=t?s.left:s.right;return{left:e,right:e,top:s.top,bottom:s.bottom}}function Iie(s){let t=s.visualViewport;return t?{left:0,right:t.width,top:0,bottom:t.height}:{left:0,right:s.innerWidth,top:0,bottom:s.innerHeight}}function n3(s,t){let e=t.width/s.offsetWidth,i=t.height/s.offsetHeight;return(e>.995&&e<1.005||!isFinite(e)||Math.abs(t.width-s.offsetWidth)<1)&&(e=1),(i>.995&&i<1.005||!isFinite(i)||Math.abs(t.height-s.offsetHeight)<1)&&(i=1),{scaleX:e,scaleY:i}}function Rie(s,t,e,i,n,r,o,l){let a=s.ownerDocument,c=a.defaultView||window;for(let h=s,f=!1;h&&!f;)if(h.nodeType==1){let m,w=h==a.body,O=1,_=1;if(w)m=Iie(c);else{if(/^(fixed|sticky)$/.test(getComputedStyle(h).position)&&(f=!0),h.scrollHeight<=h.clientHeight&&h.scrollWidth<=h.clientWidth){h=h.assignedSlot||h.parentNode;continue}let P=h.getBoundingClientRect();({scaleX:O,scaleY:_}=n3(h,P)),m={left:P.left,right:P.left+h.clientWidth*O,top:P.top,bottom:P.top+h.clientHeight*_}}let k=0,C=0;if(n=="nearest")t.top<m.top?(C=t.top-(m.top+o),e>0&&t.bottom>m.bottom+C&&(C=t.bottom-m.bottom+o)):t.bottom>m.bottom&&(C=t.bottom-m.bottom+o,e<0&&t.top-C<m.top&&(C=t.top-(m.top+o)));else{let P=t.bottom-t.top,M=m.bottom-m.top;C=(n=="center"&&P<=M?t.top+P/2-M/2:n=="start"||n=="center"&&e<0?t.top-o:t.bottom-M+o)-m.top}if(i=="nearest"?t.left<m.left?(k=t.left-(m.left+r),e>0&&t.right>m.right+k&&(k=t.right-m.right+r)):t.right>m.right&&(k=t.right-m.right+r,e<0&&t.left<m.left+k&&(k=t.left-(m.left+r))):k=(i=="center"?t.left+(t.right-t.left)/2-(m.right-m.left)/2:i=="start"==l?t.left-r:t.right-(m.right-m.left)+r)-m.left,k||C)if(w)c.scrollBy(k,C);else{let P=0,M=0;if(C){let Q=h.scrollTop;h.scrollTop+=C/_,M=(h.scrollTop-Q)*_}if(k){let Q=h.scrollLeft;h.scrollLeft+=k/O,P=(h.scrollLeft-Q)*O}t={left:t.left-P,top:t.top-M,right:t.right-P,bottom:t.bottom-M},P&&Math.abs(P-k)<1&&(i="nearest"),M&&Math.abs(M-C)<1&&(n="nearest")}if(w)break;(t.top<m.top||t.bottom>m.bottom||t.left<m.left||t.right>m.right)&&(t={left:Math.max(t.left,m.left),right:Math.min(t.right,m.right),top:Math.max(t.top,m.top),bottom:Math.min(t.bottom,m.bottom)}),h=h.assignedSlot||h.parentNode}else if(h.nodeType==11)h=h.host;else break}function Vie(s){let t=s.ownerDocument,e,i;for(let n=s.parentNode;n&&!(n==t.body||e&&i);)if(n.nodeType==1)!i&&n.scrollHeight>n.clientHeight&&(i=n),!e&&n.scrollWidth>n.clientWidth&&(e=n),n=n.assignedSlot||n.parentNode;else if(n.nodeType==11)n=n.host;else break;return{x:e,y:i}}class Mie{constructor(){this.anchorNode=null,this.anchorOffset=0,this.focusNode=null,this.focusOffset=0}eq(t){return this.anchorNode==t.anchorNode&&this.anchorOffset==t.anchorOffset&&this.focusNode==t.focusNode&&this.focusOffset==t.focusOffset}setRange(t){let{anchorNode:e,focusNode:i}=t;this.set(e,Math.min(t.anchorOffset,e?ur(e):0),i,Math.min(t.focusOffset,i?ur(i):0))}set(t,e,i,n){this.anchorNode=t,this.anchorOffset=e,this.focusNode=i,this.focusOffset=n}}let Ba=null;function s3(s){if(s.setActive)return s.setActive();if(Ba)return s.focus(Ba);let t=[];for(let e=s;e&&(t.push(e,e.scrollTop,e.scrollLeft),e!=e.ownerDocument);e=e.parentNode);if(s.focus(Ba==null?{get preventScroll(){return Ba={preventScroll:!0},!0}}:void 0),!Ba){Ba=!1;for(let e=0;e<t.length;){let i=t[e++],n=t[e++],r=t[e++];i.scrollTop!=n&&(i.scrollTop=n),i.scrollLeft!=r&&(i.scrollLeft=r)}}}let VP;function Ll(s,t,e=t){let i=VP||(VP=document.createRange());return i.setEnd(s,e),i.setStart(s,t),i}function lc(s,t,e,i){let n={key:t,code:t,keyCode:e,which:e,cancelable:!0};i&&({altKey:n.altKey,ctrlKey:n.ctrlKey,shiftKey:n.shiftKey,metaKey:n.metaKey}=i);let r=new KeyboardEvent("keydown",n);r.synthetic=!0,s.dispatchEvent(r);let o=new KeyboardEvent("keyup",n);return o.synthetic=!0,s.dispatchEvent(o),r.defaultPrevented||o.defaultPrevented}function Lie(s){for(;s;){if(s&&(s.nodeType==9||s.nodeType==11&&s.host))return s;s=s.assignedSlot||s.parentNode}return null}function r3(s){for(;s.attributes.length;)s.removeAttributeNode(s.attributes[0])}function Bie(s,t){let e=t.focusNode,i=t.focusOffset;if(!e||t.anchorNode!=e||t.anchorOffset!=i)return!1;for(i=Math.min(i,ur(e));;)if(i){if(e.nodeType!=1)return!1;let n=e.childNodes[i-1];n.contentEditable=="false"?i--:(e=n,i=ur(e))}else{if(e==s)return!0;i=Ml(e),e=e.parentNode}}function o3(s){return s.scrollTop>Math.max(1,s.scrollHeight-s.clientHeight-4)}function l3(s,t){for(let e=s,i=t;;){if(e.nodeType==3&&i>0)return{node:e,offset:i};if(e.nodeType==1&&i>0){if(e.contentEditable=="false")return null;e=e.childNodes[i-1],i=ur(e)}else if(e.parentNode&&!Zg(e))i=Ml(e),e=e.parentNode;else return null}}function a3(s,t){for(let e=s,i=t;;){if(e.nodeType==3&&i<e.nodeValue.length)return{node:e,offset:i};if(e.nodeType==1&&i<e.childNodes.length){if(e.contentEditable=="false")return null;e=e.childNodes[i],i=0}else if(e.parentNode&&!Zg(e))i=Ml(e)+1,e=e.parentNode;else return null}}class Ui{constructor(t,e,i=!0){this.node=t,this.offset=e,this.precise=i}static before(t,e){return new Ui(t.parentNode,Ml(t),e)}static after(t,e){return new Ui(t.parentNode,Ml(t)+1,e)}}const zy=[];class vt{constructor(){this.parent=null,this.dom=null,this.flags=2}get overrideDOMText(){return null}get posAtStart(){return this.parent?this.parent.posBefore(this):0}get posAtEnd(){return this.posAtStart+this.length}posBefore(t){let e=this.posAtStart;for(let i of this.children){if(i==t)return e;e+=i.length+i.breakAfter}throw new RangeError("Invalid child in posBefore")}posAfter(t){return this.posBefore(t)+t.length}sync(t,e){if(this.flags&2){let i=this.dom,n=null,r;for(let o of this.children){if(o.flags&7){if(!o.dom&&(r=n?n.nextSibling:i.firstChild)){let l=vt.get(r);(!l||!l.parent&&l.canReuseDOM(o))&&o.reuseDOM(r)}o.sync(t,e),o.flags&=-8}if(r=n?n.nextSibling:i.firstChild,e&&!e.written&&e.node==i&&r!=o.dom&&(e.written=!0),o.dom.parentNode==i)for(;r&&r!=o.dom;)r=MP(r);else i.insertBefore(o.dom,r);n=o.dom}for(r=n?n.nextSibling:i.firstChild,r&&e&&e.node==i&&(e.written=!0);r;)r=MP(r)}else if(this.flags&1)for(let i of this.children)i.flags&7&&(i.sync(t,e),i.flags&=-8)}reuseDOM(t){}localPosFromDOM(t,e){let i;if(t==this.dom)i=this.dom.childNodes[e];else{let n=ur(t)==0?0:e==0?-1:1;for(;;){let r=t.parentNode;if(r==this.dom)break;n==0&&r.firstChild!=r.lastChild&&(t==r.firstChild?n=-1:n=1),t=r}n<0?i=t:i=t.nextSibling}if(i==this.dom.firstChild)return 0;for(;i&&!vt.get(i);)i=i.nextSibling;if(!i)return this.length;for(let n=0,r=0;;n++){let o=this.children[n];if(o.dom==i)return r;r+=o.length+o.breakAfter}}domBoundsAround(t,e,i=0){let n=-1,r=-1,o=-1,l=-1;for(let a=0,c=i,h=i;a<this.children.length;a++){let f=this.children[a],m=c+f.length;if(c<t&&m>e)return f.domBoundsAround(t,e,c);if(m>=t&&n==-1&&(n=a,r=c),c>e&&f.dom.parentNode==this.dom){o=a,l=h;break}h=m,c=m+f.breakAfter}return{from:r,to:l<0?i+this.length:l,startDOM:(n?this.children[n-1].dom.nextSibling:null)||this.dom.firstChild,endDOM:o<this.children.length&&o>=0?this.children[o].dom:null}}markDirty(t=!1){this.flags|=2,this.markParentsDirty(t)}markParentsDirty(t){for(let e=this.parent;e;e=e.parent){if(t&&(e.flags|=2),e.flags&1)return;e.flags|=1,t=!1}}setParent(t){this.parent!=t&&(this.parent=t,this.flags&7&&this.markParentsDirty(!0))}setDOM(t){this.dom!=t&&(this.dom&&(this.dom.cmView=null),this.dom=t,t.cmView=this)}get rootView(){for(let t=this;;){let e=t.parent;if(!e)return t;t=e}}replaceChildren(t,e,i=zy){this.markDirty();for(let n=t;n<e;n++){let r=this.children[n];r.parent==this&&i.indexOf(r)<0&&r.destroy()}i.length<250?this.children.splice(t,e-t,...i):this.children=[].concat(this.children.slice(0,t),i,this.children.slice(e));for(let n=0;n<i.length;n++)i[n].setParent(this)}ignoreMutation(t){return!1}ignoreEvent(t){return!1}childCursor(t=this.length){return new c3(this.children,t,this.children.length)}childPos(t,e=1){return this.childCursor().findPos(t,e)}toString(){let t=this.constructor.name.replace("View","");return t+(this.children.length?"("+this.children.join()+")":this.length?"["+(t=="Text"?this.text:this.length)+"]":"")+(this.breakAfter?"#":"")}static get(t){return t.cmView}get isEditable(){return!0}get isWidget(){return!1}get isHidden(){return!1}merge(t,e,i,n,r,o){return!1}become(t){return!1}canReuseDOM(t){return t.constructor==this.constructor&&!((this.flags|t.flags)&8)}getSide(){return 0}destroy(){for(let t of this.children)t.parent==this&&t.destroy();this.parent=null}}vt.prototype.breakAfter=0;function MP(s){let t=s.nextSibling;return s.parentNode.removeChild(s),t}class c3{constructor(t,e,i){this.children=t,this.pos=e,this.i=i,this.off=0}findPos(t,e=1){for(;;){if(t>this.pos||t==this.pos&&(e>0||this.i==0||this.children[this.i-1].breakAfter))return this.off=t-this.pos,this;let i=this.children[--this.i];this.pos-=i.length+i.breakAfter}}}function u3(s,t,e,i,n,r,o,l,a){let{children:c}=s,h=c.length?c[t]:null,f=r.length?r[r.length-1]:null,m=f?f.breakAfter:o;if(!(t==i&&h&&!o&&!m&&r.length<2&&h.merge(e,n,r.length?f:null,e==0,l,a))){if(i<c.length){let w=c[i];w&&(n<w.length||w.breakAfter&&(f!=null&&f.breakAfter))?(t==i&&(w=w.split(n),n=0),!m&&f&&w.merge(0,n,f,!0,0,a)?r[r.length-1]=w:((n||w.children.length&&!w.children[0].length)&&w.merge(0,n,null,!1,0,a),r.push(w))):w!=null&&w.breakAfter&&(f?f.breakAfter=1:o=1),i++}for(h&&(h.breakAfter=o,e>0&&(!o&&r.length&&h.merge(e,h.length,r[0],!1,l,0)?h.breakAfter=r.shift().breakAfter:(e<h.length||h.children.length&&h.children[h.children.length-1].length==0)&&h.merge(e,h.length,null,!1,l,0),t++));t<i&&r.length;)if(c[i-1].become(r[r.length-1]))i--,r.pop(),a=r.length?0:l;else if(c[t].become(r[0]))t++,r.shift(),l=r.length?0:a;else break;!r.length&&t&&i<c.length&&!c[t-1].breakAfter&&c[i].merge(0,0,c[t-1],!1,l,a)&&t--,(t<i||r.length)&&s.replaceChildren(t,i,r)}}function h3(s,t,e,i,n,r){let o=s.childCursor(),{i:l,off:a}=o.findPos(e,1),{i:c,off:h}=o.findPos(t,-1),f=t-e;for(let m of i)f+=m.length;s.length+=f,u3(s,c,h,l,a,i,0,n,r)}let wn=typeof navigator<"u"?navigator:{userAgent:"",vendor:"",platform:""},$1=typeof document<"u"?document:{documentElement:{style:{}}};const D1=/Edge\/(\d+)/.exec(wn.userAgent),d3=/MSIE \d/.test(wn.userAgent),Q1=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(wn.userAgent),Qp=!!(d3||Q1||D1),LP=!Qp&&/gecko\/(\d+)/i.test(wn.userAgent),Fx=!Qp&&/Chrome\/(\d+)/.exec(wn.userAgent),$ie="webkitFontSmoothing"in $1.documentElement.style,f3=!Qp&&/Apple Computer/.test(wn.vendor),BP=f3&&(/Mobile\/\w+/.test(wn.userAgent)||wn.maxTouchPoints>2);var ke={mac:BP||/Mac/.test(wn.platform),windows:/Win/.test(wn.platform),linux:/Linux|X11/.test(wn.platform),ie:Qp,ie_version:d3?$1.documentMode||6:Q1?+Q1[1]:D1?+D1[1]:0,gecko:LP,gecko_version:LP?+(/Firefox\/(\d+)/.exec(wn.userAgent)||[0,0])[1]:0,chrome:!!Fx,chrome_version:Fx?+Fx[1]:0,ios:BP,android:/Android\b/.test(wn.userAgent),safari:f3,webkit_version:$ie?+(/\bAppleWebKit\/(\d+)/.exec(wn.userAgent)||[0,0])[1]:0,tabSize:$1.documentElement.style.tabSize!=null?"tab-size":"-moz-tab-size"};const Die=256;class Ds extends vt{constructor(t){super(),this.text=t}get length(){return this.text.length}createDOM(t){this.setDOM(t||document.createTextNode(this.text))}sync(t,e){this.dom||this.createDOM(),this.dom.nodeValue!=this.text&&(e&&e.node==this.dom&&(e.written=!0),this.dom.nodeValue=this.text)}reuseDOM(t){t.nodeType==3&&this.createDOM(t)}merge(t,e,i){return this.flags&8||i&&(!(i instanceof Ds)||this.length-(e-t)+i.length>Die||i.flags&8)?!1:(this.text=this.text.slice(0,t)+(i?i.text:"")+this.text.slice(e),this.markDirty(),!0)}split(t){let e=new Ds(this.text.slice(t));return this.text=this.text.slice(0,t),this.markDirty(),e.flags|=this.flags&8,e}localPosFromDOM(t,e){return t==this.dom?e:e?this.text.length:0}domAtPos(t){return new Ui(this.dom,t)}domBoundsAround(t,e,i){return{from:i,to:i+this.length,startDOM:this.dom,endDOM:this.dom.nextSibling}}coordsAt(t,e){return Qie(this.dom,t,e)}}class Dr extends vt{constructor(t,e=[],i=0){super(),this.mark=t,this.children=e,this.length=i;for(let n of e)n.setParent(this)}setAttrs(t){if(r3(t),this.mark.class&&(t.className=this.mark.class),this.mark.attrs)for(let e in this.mark.attrs)t.setAttribute(e,this.mark.attrs[e]);return t}canReuseDOM(t){return super.canReuseDOM(t)&&!((this.flags|t.flags)&8)}reuseDOM(t){t.nodeName==this.mark.tagName.toUpperCase()&&(this.setDOM(t),this.flags|=6)}sync(t,e){this.dom?this.flags&4&&this.setAttrs(this.dom):this.setDOM(this.setAttrs(document.createElement(this.mark.tagName))),super.sync(t,e)}merge(t,e,i,n,r,o){return i&&(!(i instanceof Dr&&i.mark.eq(this.mark))||t&&r<=0||e<this.length&&o<=0)?!1:(h3(this,t,e,i?i.children.slice():[],r-1,o-1),this.markDirty(),!0)}split(t){let e=[],i=0,n=-1,r=0;for(let l of this.children){let a=i+l.length;a>t&&e.push(i<t?l.split(t-i):l),n<0&&i>=t&&(n=r),i=a,r++}let o=this.length-t;return this.length=t,n>-1&&(this.children.length=n,this.markDirty()),new Dr(this.mark,e,o)}domAtPos(t){return m3(this,t)}coordsAt(t,e){return p3(this,t,e)}}function Qie(s,t,e){let i=s.nodeValue.length;t>i&&(t=i);let n=t,r=t,o=0;t==0&&e<0||t==i&&e>=0?ke.chrome||ke.gecko||(t?(n--,o=1):r<i&&(r++,o=-1)):e<0?n--:r<i&&r++;let l=Ll(s,n,r).getClientRects();if(!l.length)return null;let a=l[(o?o<0:e>=0)?0:l.length-1];return ke.safari&&!o&&a.width==0&&(a=Array.prototype.find.call(l,c=>c.width)||a),o?Dp(a,o<0):a||null}class bl extends vt{static create(t,e,i){return new bl(t,e,i)}constructor(t,e,i){super(),this.widget=t,this.length=e,this.side=i,this.prevWidget=null}split(t){let e=bl.create(this.widget,this.length-t,this.side);return this.length-=t,e}sync(t){(!this.dom||!this.widget.updateDOM(this.dom,t))&&(this.dom&&this.prevWidget&&this.prevWidget.destroy(this.dom),this.prevWidget=null,this.setDOM(this.widget.toDOM(t)),this.widget.editable||(this.dom.contentEditable="false"))}getSide(){return this.side}merge(t,e,i,n,r,o){return i&&(!(i instanceof bl)||!this.widget.compare(i.widget)||t>0&&r<=0||e<this.length&&o<=0)?!1:(this.length=t+(i?i.length:0)+(this.length-e),!0)}become(t){return t instanceof bl&&t.side==this.side&&this.widget.constructor==t.widget.constructor?(this.widget.compare(t.widget)||this.markDirty(!0),this.dom&&!this.prevWidget&&(this.prevWidget=this.widget),this.widget=t.widget,this.length=t.length,!0):!1}ignoreMutation(){return!0}ignoreEvent(t){return this.widget.ignoreEvent(t)}get overrideDOMText(){if(this.length==0)return Ke.empty;let t=this;for(;t.parent;)t=t.parent;let{view:e}=t,i=e&&e.state.doc,n=this.posAtStart;return i?i.slice(n,n+this.length):Ke.empty}domAtPos(t){return(this.length?t==0:this.side>0)?Ui.before(this.dom):Ui.after(this.dom,t==this.length)}domBoundsAround(){return null}coordsAt(t,e){let i=this.widget.coordsAt(this.dom,t,e);if(i)return i;let n=this.dom.getClientRects(),r=null;if(!n.length)return null;let o=this.side?this.side<0:t>0;for(let l=o?n.length-1:0;r=n[l],!(t>0?l==0:l==n.length-1||r.top<r.bottom);l+=o?-1:1);return Dp(r,!o)}get isEditable(){return!1}get isWidget(){return!0}get isHidden(){return this.widget.isHidden}destroy(){super.destroy(),this.dom&&this.widget.destroy(this.dom)}}class Oc extends vt{constructor(t){super(),this.side=t}get length(){return 0}merge(){return!1}become(t){return t instanceof Oc&&t.side==this.side}split(){return new Oc(this.side)}sync(){if(!this.dom){let t=document.createElement("img");t.className="cm-widgetBuffer",t.setAttribute("aria-hidden","true"),this.setDOM(t)}}getSide(){return this.side}domAtPos(t){return this.side>0?Ui.before(this.dom):Ui.after(this.dom)}localPosFromDOM(){return 0}domBoundsAround(){return null}coordsAt(t){return this.dom.getBoundingClientRect()}get overrideDOMText(){return Ke.empty}get isHidden(){return!0}}Ds.prototype.children=bl.prototype.children=Oc.prototype.children=zy;function m3(s,t){let e=s.dom,{children:i}=s,n=0;for(let r=0;n<i.length;n++){let o=i[n],l=r+o.length;if(!(l==r&&o.getSide()<=0)){if(t>r&&t<l&&o.dom.parentNode==e)return o.domAtPos(t-r);if(t<=r)break;r=l}}for(let r=n;r>0;r--){let o=i[r-1];if(o.dom.parentNode==e)return o.domAtPos(o.length)}for(let r=n;r<i.length;r++){let o=i[r];if(o.dom.parentNode==e)return o.domAtPos(0)}return new Ui(e,0)}function g3(s,t,e){let i,{children:n}=s;e>0&&t instanceof Dr&&n.length&&(i=n[n.length-1])instanceof Dr&&i.mark.eq(t.mark)?g3(i,t.children[0],e-1):(n.push(t),t.setParent(s)),s.length+=t.length}function p3(s,t,e){let i=null,n=-1,r=null,o=-1;function l(c,h){for(let f=0,m=0;f<c.children.length&&m<=h;f++){let w=c.children[f],O=m+w.length;O>=h&&(w.children.length?l(w,h-m):(!r||r.isHidden&&(e>0||Fie(r,w)))&&(O>h||m==O&&w.getSide()>0)?(r=w,o=h-m):(m<h||m==O&&w.getSide()<0&&!w.isHidden)&&(i=w,n=h-m)),m=O}}l(s,t);let a=(e<0?i:r)||i||r;return a?a.coordsAt(Math.max(0,a==i?n:o),e):Nie(s)}function Nie(s){let t=s.dom.lastChild;if(!t)return s.dom.getBoundingClientRect();let e=Zh(t);return e[e.length-1]||null}function Fie(s,t){let e=s.coordsAt(0,1),i=t.coordsAt(0,1);return e&&i&&i.top<e.bottom}function N1(s,t){for(let e in s)e=="class"&&t.class?t.class+=" "+s.class:e=="style"&&t.style?t.style+=";"+s.style:t[e]=s[e];return t}const $P=Object.create(null);function Hg(s,t,e){if(s==t)return!0;s||(s=$P),t||(t=$P);let i=Object.keys(s),n=Object.keys(t);if(i.length-(e&&i.indexOf(e)>-1?1:0)!=n.length-(e&&n.indexOf(e)>-1?1:0))return!1;for(let r of i)if(r!=e&&(n.indexOf(r)==-1||s[r]!==t[r]))return!1;return!0}function F1(s,t,e){let i=!1;if(t)for(let n in t)e&&n in e||(i=!0,n=="style"?s.style.cssText="":s.removeAttribute(n));if(e)for(let n in e)t&&t[n]==e[n]||(i=!0,n=="style"?s.style.cssText=e[n]:s.setAttribute(n,e[n]));return i}function zie(s){let t=Object.create(null);for(let e=0;e<s.attributes.length;e++){let i=s.attributes[e];t[i.name]=i.value}return t}class Wo{eq(t){return!1}updateDOM(t,e){return!1}compare(t){return this==t||this.constructor==t.constructor&&this.eq(t)}get estimatedHeight(){return-1}get lineBreaks(){return 0}ignoreEvent(t){return!0}coordsAt(t,e,i){return null}get isHidden(){return!1}get editable(){return!1}destroy(t){}}var sn=function(s){return s[s.Text=0]="Text",s[s.WidgetBefore=1]="WidgetBefore",s[s.WidgetAfter=2]="WidgetAfter",s[s.WidgetRange=3]="WidgetRange",s}(sn||(sn={}));class Je extends Rl{constructor(t,e,i,n){super(),this.startSide=t,this.endSide=e,this.widget=i,this.spec=n}get heightRelevant(){return!1}static mark(t){return new yd(t)}static widget(t){let e=Math.max(-1e4,Math.min(1e4,t.side||0)),i=!!t.block;return e+=i&&!t.inlineOrder?e>0?3e8:-4e8:e>0?1e8:-1e8,new $o(t,e,e,i,t.widget||null,!1)}static replace(t){let e=!!t.block,i,n;if(t.isBlockGap)i=-5e8,n=4e8;else{let{start:r,end:o}=w3(t,e);i=(r?e?-3e8:-1:5e8)-1,n=(o?e?2e8:1:-6e8)+1}return new $o(t,i,n,e,t.widget||null,!0)}static line(t){return new vd(t)}static set(t,e=!1){return st.of(t,e)}hasHeight(){return this.widget?this.widget.estimatedHeight>-1:!1}}Je.none=st.empty;class yd extends Je{constructor(t){let{start:e,end:i}=w3(t);super(e?-1:5e8,i?1:-6e8,null,t),this.tagName=t.tagName||"span",this.class=t.class||"",this.attrs=t.attributes||null}eq(t){var e,i;return this==t||t instanceof yd&&this.tagName==t.tagName&&(this.class||((e=this.attrs)===null||e===void 0?void 0:e.class))==(t.class||((i=t.attrs)===null||i===void 0?void 0:i.class))&&Hg(this.attrs,t.attrs,"class")}range(t,e=t){if(t>=e)throw new RangeError("Mark decorations may not be empty");return super.range(t,e)}}yd.prototype.point=!1;class vd extends Je{constructor(t){super(-2e8,-2e8,null,t)}eq(t){return t instanceof vd&&this.spec.class==t.spec.class&&Hg(this.spec.attributes,t.spec.attributes)}range(t,e=t){if(e!=t)throw new RangeError("Line decoration ranges must be zero-length");return super.range(t,e)}}vd.prototype.mapMode=Wi.TrackBefore;vd.prototype.point=!0;class $o extends Je{constructor(t,e,i,n,r,o){super(e,i,r,t),this.block=n,this.isReplace=o,this.mapMode=n?e<=0?Wi.TrackBefore:Wi.TrackAfter:Wi.TrackDel}get type(){return this.startSide!=this.endSide?sn.WidgetRange:this.startSide<=0?sn.WidgetBefore:sn.WidgetAfter}get heightRelevant(){return this.block||!!this.widget&&(this.widget.estimatedHeight>=5||this.widget.lineBreaks>0)}eq(t){return t instanceof $o&&Wie(this.widget,t.widget)&&this.block==t.block&&this.startSide==t.startSide&&this.endSide==t.endSide}range(t,e=t){if(this.isReplace&&(t>e||t==e&&this.startSide>0&&this.endSide<=0))throw new RangeError("Invalid range for replacement decoration");if(!this.isReplace&&e!=t)throw new RangeError("Widget decorations can only have zero-length ranges");return super.range(t,e)}}$o.prototype.point=!0;function w3(s,t=!1){let{inclusiveStart:e,inclusiveEnd:i}=s;return e==null&&(e=s.inclusive),i==null&&(i=s.inclusive),{start:e??t,end:i??t}}function Wie(s,t){return s==t||!!(s&&t&&s.compare(t))}function Xm(s,t,e,i=0){let n=e.length-1;n>=0&&e[n]+i>=s?e[n]=Math.max(e[n],t):e.push(s,t)}class si extends vt{constructor(){super(...arguments),this.children=[],this.length=0,this.prevAttrs=void 0,this.attrs=null,this.breakAfter=0}merge(t,e,i,n,r,o){if(i){if(!(i instanceof si))return!1;this.dom||i.transferDOM(this)}return n&&this.setDeco(i?i.attrs:null),h3(this,t,e,i?i.children.slice():[],r,o),!0}split(t){let e=new si;if(e.breakAfter=this.breakAfter,this.length==0)return e;let{i,off:n}=this.childPos(t);n&&(e.append(this.children[i].split(n),0),this.children[i].merge(n,this.children[i].length,null,!1,0,0),i++);for(let r=i;r<this.children.length;r++)e.append(this.children[r],0);for(;i>0&&this.children[i-1].length==0;)this.children[--i].destroy();return this.children.length=i,this.markDirty(),this.length=t,e}transferDOM(t){this.dom&&(this.markDirty(),t.setDOM(this.dom),t.prevAttrs=this.prevAttrs===void 0?this.attrs:this.prevAttrs,this.prevAttrs=void 0,this.dom=null)}setDeco(t){Hg(this.attrs,t)||(this.dom&&(this.prevAttrs=this.attrs,this.markDirty()),this.attrs=t)}append(t,e){g3(this,t,e)}addLineDeco(t){let e=t.spec.attributes,i=t.spec.class;e&&(this.attrs=N1(e,this.attrs||{})),i&&(this.attrs=N1({class:i},this.attrs||{}))}domAtPos(t){return m3(this,t)}reuseDOM(t){t.nodeName=="DIV"&&(this.setDOM(t),this.flags|=6)}sync(t,e){var i;this.dom?this.flags&4&&(r3(this.dom),this.dom.className="cm-line",this.prevAttrs=this.attrs?null:void 0):(this.setDOM(document.createElement("div")),this.dom.className="cm-line",this.prevAttrs=this.attrs?null:void 0),this.prevAttrs!==void 0&&(F1(this.dom,this.prevAttrs,this.attrs),this.dom.classList.add("cm-line"),this.prevAttrs=void 0),super.sync(t,e);let n=this.dom.lastChild;for(;n&&vt.get(n)instanceof Dr;)n=n.lastChild;if(!n||!this.length||n.nodeName!="BR"&&((i=vt.get(n))===null||i===void 0?void 0:i.isEditable)==!1&&(!ke.ios||!this.children.some(r=>r instanceof Ds))){let r=document.createElement("BR");r.cmIgnore=!0,this.dom.appendChild(r)}}measureTextSize(){if(this.children.length==0||this.length>20)return null;let t=0,e;for(let i of this.children){if(!(i instanceof Ds)||/[^ -~]/.test(i.text))return null;let n=Zh(i.dom);if(n.length!=1)return null;t+=n[0].width,e=n[0].height}return t?{lineHeight:this.dom.getBoundingClientRect().height,charWidth:t/this.length,textHeight:e}:null}coordsAt(t,e){let i=p3(this,t,e);if(!this.children.length&&i&&this.parent){let{heightOracle:n}=this.parent.view.viewState,r=i.bottom-i.top;if(Math.abs(r-n.lineHeight)<2&&n.textHeight<r){let o=(r-n.textHeight)/2;return{top:i.top+o,bottom:i.bottom-o,left:i.left,right:i.left}}}return i}become(t){return t instanceof si&&this.children.length==0&&t.children.length==0&&Hg(this.attrs,t.attrs)&&this.breakAfter==t.breakAfter}covers(){return!0}static find(t,e){for(let i=0,n=0;i<t.children.length;i++){let r=t.children[i],o=n+r.length;if(o>=e){if(r instanceof si)return r;if(o>e)break}n=o+r.breakAfter}return null}}class Vr extends vt{constructor(t,e,i){super(),this.widget=t,this.length=e,this.deco=i,this.breakAfter=0,this.prevWidget=null}merge(t,e,i,n,r,o){return i&&(!(i instanceof Vr)||!this.widget.compare(i.widget)||t>0&&r<=0||e<this.length&&o<=0)?!1:(this.length=t+(i?i.length:0)+(this.length-e),!0)}domAtPos(t){return t==0?Ui.before(this.dom):Ui.after(this.dom,t==this.length)}split(t){let e=this.length-t;this.length=t;let i=new Vr(this.widget,e,this.deco);return i.breakAfter=this.breakAfter,i}get children(){return zy}sync(t){(!this.dom||!this.widget.updateDOM(this.dom,t))&&(this.dom&&this.prevWidget&&this.prevWidget.destroy(this.dom),this.prevWidget=null,this.setDOM(this.widget.toDOM(t)),this.widget.editable||(this.dom.contentEditable="false"))}get overrideDOMText(){return this.parent?this.parent.view.state.doc.slice(this.posAtStart,this.posAtEnd):Ke.empty}domBoundsAround(){return null}become(t){return t instanceof Vr&&t.widget.constructor==this.widget.constructor?(t.widget.compare(this.widget)||this.markDirty(!0),this.dom&&!this.prevWidget&&(this.prevWidget=this.widget),this.widget=t.widget,this.length=t.length,this.deco=t.deco,this.breakAfter=t.breakAfter,!0):!1}ignoreMutation(){return!0}ignoreEvent(t){return this.widget.ignoreEvent(t)}get isEditable(){return!1}get isWidget(){return!0}coordsAt(t,e){let i=this.widget.coordsAt(this.dom,t,e);return i||(this.widget instanceof z1?null:Dp(this.dom.getBoundingClientRect(),this.length?t==0:e<=0))}destroy(){super.destroy(),this.dom&&this.widget.destroy(this.dom)}covers(t){let{startSide:e,endSide:i}=this.deco;return e==i?!1:t<0?e<0:i>0}}class z1 extends Wo{constructor(t){super(),this.height=t}toDOM(){let t=document.createElement("div");return t.className="cm-gap",this.updateDOM(t),t}eq(t){return t.height==this.height}updateDOM(t){return t.style.height=this.height+"px",!0}get editable(){return!0}get estimatedHeight(){return this.height}ignoreEvent(){return!1}}class bh{constructor(t,e,i,n){this.doc=t,this.pos=e,this.end=i,this.disallowBlockEffectsFor=n,this.content=[],this.curLine=null,this.breakAtStart=0,this.pendingBuffer=0,this.bufferMarks=[],this.atCursorPos=!0,this.openStart=-1,this.openEnd=-1,this.text="",this.textOff=0,this.cursor=t.iter(),this.skip=e}posCovered(){if(this.content.length==0)return!this.breakAtStart&&this.doc.lineAt(this.pos).from!=this.pos;let t=this.content[this.content.length-1];return!(t.breakAfter||t instanceof Vr&&t.deco.endSide<0)}getLine(){return this.curLine||(this.content.push(this.curLine=new si),this.atCursorPos=!0),this.curLine}flushBuffer(t=this.bufferMarks){this.pendingBuffer&&(this.curLine.append(dm(new Oc(-1),t),t.length),this.pendingBuffer=0)}addBlockWidget(t){this.flushBuffer(),this.curLine=null,this.content.push(t)}finish(t){this.pendingBuffer&&t<=this.bufferMarks.length?this.flushBuffer():this.pendingBuffer=0,!this.posCovered()&&!(t&&this.content.length&&this.content[this.content.length-1]instanceof Vr)&&this.getLine()}buildText(t,e,i){for(;t>0;){if(this.textOff==this.text.length){let{value:r,lineBreak:o,done:l}=this.cursor.next(this.skip);if(this.skip=0,l)throw new Error("Ran out of text content when drawing inline views");if(o){this.posCovered()||this.getLine(),this.content.length?this.content[this.content.length-1].breakAfter=1:this.breakAtStart=1,this.flushBuffer(),this.curLine=null,this.atCursorPos=!0,t--;continue}else this.text=r,this.textOff=0}let n=Math.min(this.text.length-this.textOff,t,512);this.flushBuffer(e.slice(e.length-i)),this.getLine().append(dm(new Ds(this.text.slice(this.textOff,this.textOff+n)),e),i),this.atCursorPos=!0,this.textOff+=n,t-=n,i=0}}span(t,e,i,n){this.buildText(e-t,i,n),this.pos=e,this.openStart<0&&(this.openStart=n)}point(t,e,i,n,r,o){if(this.disallowBlockEffectsFor[o]&&i instanceof $o){if(i.block)throw new RangeError("Block decorations may not be specified via plugins");if(e>this.doc.lineAt(this.pos).to)throw new RangeError("Decorations that replace line breaks may not be specified via plugins")}let l=e-t;if(i instanceof $o)if(i.block)i.startSide>0&&!this.posCovered()&&this.getLine(),this.addBlockWidget(new Vr(i.widget||yc.block,l,i));else{let a=bl.create(i.widget||yc.inline,l,l?0:i.startSide),c=this.atCursorPos&&!a.isEditable&&r<=n.length&&(t<e||i.startSide>0),h=!a.isEditable&&(t<e||r>n.length||i.startSide<=0),f=this.getLine();this.pendingBuffer==2&&!c&&!a.isEditable&&(this.pendingBuffer=0),this.flushBuffer(n),c&&(f.append(dm(new Oc(1),n),r),r=n.length+Math.max(0,r-n.length)),f.append(dm(a,n),r),this.atCursorPos=h,this.pendingBuffer=h?t<e||r>n.length?1:2:0,this.pendingBuffer&&(this.bufferMarks=n.slice())}else this.doc.lineAt(this.pos).from==this.pos&&this.getLine().addLineDeco(i);l&&(this.textOff+l<=this.text.length?this.textOff+=l:(this.skip+=l-(this.text.length-this.textOff),this.text="",this.textOff=0),this.pos=e),this.openStart<0&&(this.openStart=r)}static build(t,e,i,n,r){let o=new bh(t,e,i,r);return o.openEnd=st.spans(n,e,i,o),o.openStart<0&&(o.openStart=o.openEnd),o.finish(o.openEnd),o}}function dm(s,t){for(let e of t)s=new Dr(e,[s],s.length);return s}class yc extends Wo{constructor(t){super(),this.tag=t}eq(t){return t.tag==this.tag}toDOM(){return document.createElement(this.tag)}updateDOM(t){return t.nodeName.toLowerCase()==this.tag}get isHidden(){return!0}}yc.inline=new yc("span");yc.block=new yc("div");var Bt=function(s){return s[s.LTR=0]="LTR",s[s.RTL=1]="RTL",s}(Bt||(Bt={}));const Bl=Bt.LTR,Wy=Bt.RTL;function x3(s){let t=[];for(let e=0;e<s.length;e++)t.push(1<<+s[e]);return t}const Uie=x3("88888888888888888888888888888888888666888888787833333333337888888000000000000000000000000008888880000000000000000000000000088888888888888888888888888888888888887866668888088888663380888308888800000000000000000000000800000000000000000000000000000008"),Zie=x3("4444448826627288999999999992222222222222222222222222222222222222222222222229999999999999999999994444444444644222822222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222999999949999999229989999223333333333"),W1=Object.create(null),Xs=[];for(let s of["()","[]","{}"]){let t=s.charCodeAt(0),e=s.charCodeAt(1);W1[t]=e,W1[e]=-t}function b3(s){return s<=247?Uie[s]:1424<=s&&s<=1524?2:1536<=s&&s<=1785?Zie[s-1536]:1774<=s&&s<=2220?4:8192<=s&&s<=8204?256:64336<=s&&s<=65023?4:1}const Hie=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac\ufb50-\ufdff]/;class _o{get dir(){return this.level%2?Wy:Bl}constructor(t,e,i){this.from=t,this.to=e,this.level=i}side(t,e){return this.dir==e==t?this.to:this.from}forward(t,e){return t==(this.dir==e)}static find(t,e,i,n){let r=-1;for(let o=0;o<t.length;o++){let l=t[o];if(l.from<=e&&l.to>=e){if(l.level==i)return o;(r<0||(n!=0?n<0?l.from<e:l.to>e:t[r].level>l.level))&&(r=o)}}if(r<0)throw new RangeError("Index out of range");return r}}function O3(s,t){if(s.length!=t.length)return!1;for(let e=0;e<s.length;e++){let i=s[e],n=t[e];if(i.from!=n.from||i.to!=n.to||i.direction!=n.direction||!O3(i.inner,n.inner))return!1}return!0}const yt=[];function qie(s,t,e,i,n){for(let r=0;r<=i.length;r++){let o=r?i[r-1].to:t,l=r<i.length?i[r].from:e,a=r?256:n;for(let c=o,h=a,f=a;c<l;c++){let m=b3(s.charCodeAt(c));m==512?m=h:m==8&&f==4&&(m=16),yt[c]=m==4?2:m,m&7&&(f=m),h=m}for(let c=o,h=a,f=a;c<l;c++){let m=yt[c];if(m==128)c<l-1&&h==yt[c+1]&&h&24?m=yt[c]=h:yt[c]=256;else if(m==64){let w=c+1;for(;w<l&&yt[w]==64;)w++;let O=c&&h==8||w<e&&yt[w]==8?f==1?1:8:256;for(let _=c;_<w;_++)yt[_]=O;c=w-1}else m==8&&f==1&&(yt[c]=1);h=m,m&7&&(f=m)}}}function jie(s,t,e,i,n){let r=n==1?2:1;for(let o=0,l=0,a=0;o<=i.length;o++){let c=o?i[o-1].to:t,h=o<i.length?i[o].from:e;for(let f=c,m,w,O;f<h;f++)if(w=W1[m=s.charCodeAt(f)])if(w<0){for(let _=l-3;_>=0;_-=3)if(Xs[_+1]==-w){let k=Xs[_+2],C=k&2?n:k&4?k&1?r:n:0;C&&(yt[f]=yt[Xs[_]]=C),l=_;break}}else{if(Xs.length==189)break;Xs[l++]=f,Xs[l++]=m,Xs[l++]=a}else if((O=yt[f])==2||O==1){let _=O==n;a=_?0:1;for(let k=l-3;k>=0;k-=3){let C=Xs[k+2];if(C&2)break;if(_)Xs[k+2]|=2;else{if(C&4)break;Xs[k+2]|=4}}}}}function Xie(s,t,e,i){for(let n=0,r=i;n<=e.length;n++){let o=n?e[n-1].to:s,l=n<e.length?e[n].from:t;for(let a=o;a<l;){let c=yt[a];if(c==256){let h=a+1;for(;;)if(h==l){if(n==e.length)break;h=e[n++].to,l=n<e.length?e[n].from:t}else if(yt[h]==256)h++;else break;let f=r==1,m=(h<t?yt[h]:i)==1,w=f==m?f?1:2:i;for(let O=h,_=n,k=_?e[_-1].to:s;O>a;)O==k&&(O=e[--_].from,k=_?e[_-1].to:s),yt[--O]=w;a=h}else r=c,a++}}}function U1(s,t,e,i,n,r,o){let l=i%2?2:1;if(i%2==n%2)for(let a=t,c=0;a<e;){let h=!0,f=!1;if(c==r.length||a<r[c].from){let _=yt[a];_!=l&&(h=!1,f=_==16)}let m=!h&&l==1?[]:null,w=h?i:i+1,O=a;e:for(;;)if(c<r.length&&O==r[c].from){if(f)break e;let _=r[c];if(!h)for(let k=_.to,C=c+1;;){if(k==e)break e;if(C<r.length&&r[C].from==k)k=r[C++].to;else{if(yt[k]==l)break e;break}}if(c++,m)m.push(_);else{_.from>a&&o.push(new _o(a,_.from,w));let k=_.direction==Bl!=!(w%2);Z1(s,k?i+1:i,n,_.inner,_.from,_.to,o),a=_.to}O=_.to}else{if(O==e||(h?yt[O]!=l:yt[O]==l))break;O++}m?U1(s,a,O,i+1,n,m,o):a<O&&o.push(new _o(a,O,w)),a=O}else for(let a=e,c=r.length;a>t;){let h=!0,f=!1;if(!c||a>r[c-1].to){let _=yt[a-1];_!=l&&(h=!1,f=_==16)}let m=!h&&l==1?[]:null,w=h?i:i+1,O=a;e:for(;;)if(c&&O==r[c-1].to){if(f)break e;let _=r[--c];if(!h)for(let k=_.from,C=c;;){if(k==t)break e;if(C&&r[C-1].to==k)k=r[--C].from;else{if(yt[k-1]==l)break e;break}}if(m)m.push(_);else{_.to<a&&o.push(new _o(_.to,a,w));let k=_.direction==Bl!=!(w%2);Z1(s,k?i+1:i,n,_.inner,_.from,_.to,o),a=_.from}O=_.from}else{if(O==t||(h?yt[O-1]!=l:yt[O-1]==l))break;O--}m?U1(s,O,a,i+1,n,m,o):O<a&&o.push(new _o(O,a,w)),a=O}}function Z1(s,t,e,i,n,r,o){let l=t%2?2:1;qie(s,n,r,i,l),jie(s,n,r,i,l),Xie(n,r,i,l),U1(s,n,r,t,e,i,o)}function Gie(s,t,e){if(!s)return[new _o(0,0,t==Wy?1:0)];if(t==Bl&&!e.length&&!Hie.test(s))return y3(s.length);if(e.length)for(;s.length>yt.length;)yt[yt.length]=256;let i=[],n=t==Bl?0:1;return Z1(s,n,n,e,0,s.length,i),i}function y3(s){return[new _o(0,s,0)]}let v3="";function Yie(s,t,e,i,n){var r;let o=i.head-s.from,l=_o.find(t,o,(r=i.bidiLevel)!==null&&r!==void 0?r:-1,i.assoc),a=t[l],c=a.side(n,e);if(o==c){let m=l+=n?1:-1;if(m<0||m>=t.length)return null;a=t[l=m],o=a.side(!n,e),c=a.side(n,e)}let h=en(s.text,o,a.forward(n,e));(h<a.from||h>a.to)&&(h=c),v3=s.text.slice(Math.min(o,h),Math.max(o,h));let f=l==(n?t.length-1:0)?null:t[l+(n?1:-1)];return f&&h==c&&f.level+(n?0:1)<a.level?se.cursor(f.side(!n,e)+s.from,f.forward(n,e)?1:-1,f.level):se.cursor(h+s.from,a.forward(n,e)?-1:1,a.level)}function Kie(s,t,e){for(let i=t;i<e;i++){let n=b3(s.charCodeAt(i));if(n==1)return Bl;if(n==2||n==4)return Wy}return Bl}const _3=Pe.define(),k3=Pe.define(),S3=Pe.define(),C3=Pe.define(),H1=Pe.define(),P3=Pe.define(),T3=Pe.define(),Uy=Pe.define(),Zy=Pe.define(),E3=Pe.define({combine:s=>s.some(t=>t)}),A3=Pe.define({combine:s=>s.some(t=>t)}),I3=Pe.define();class ac{constructor(t,e="nearest",i="nearest",n=5,r=5,o=!1){this.range=t,this.y=e,this.x=i,this.yMargin=n,this.xMargin=r,this.isSnapshot=o}map(t){return t.empty?this:new ac(this.range.map(t),this.y,this.x,this.yMargin,this.xMargin,this.isSnapshot)}clip(t){return this.range.to<=t.doc.length?this:new ac(se.cursor(t.doc.length),this.y,this.x,this.yMargin,this.xMargin,this.isSnapshot)}}const fm=rt.define({map:(s,t)=>s.map(t)}),R3=rt.define();function Fn(s,t,e){let i=s.facet(C3);i.length?i[0](t):window.onerror&&window.onerror(String(t),e,void 0,void 0,t)||(e?console.error(e+":",t):console.error(t))}const Er=Pe.define({combine:s=>s.length?s[0]:!0});let Jie=0;const Ga=Pe.define({combine(s){return s.filter((t,e)=>{for(let i=0;i<e;i++)if(s[i].plugin==t.plugin)return!1;return!0})}});class Hi{constructor(t,e,i,n,r){this.id=t,this.create=e,this.domEventHandlers=i,this.domEventObservers=n,this.baseExtensions=r(this),this.extension=this.baseExtensions.concat(Ga.of({plugin:this,arg:void 0}))}of(t){return this.baseExtensions.concat(Ga.of({plugin:this,arg:t}))}static define(t,e){const{eventHandlers:i,eventObservers:n,provide:r,decorations:o}=e||{};return new Hi(Jie++,t,i,n,l=>{let a=[];return o&&a.push(Hh.of(c=>{let h=c.plugin(l);return h?o(h):Je.none})),r&&a.push(r(l)),a})}static fromClass(t,e){return Hi.define((i,n)=>new t(i,n),e)}}class zx{constructor(t){this.spec=t,this.mustUpdate=null,this.value=null}get plugin(){return this.spec&&this.spec.plugin}update(t){if(this.value){if(this.mustUpdate){let e=this.mustUpdate;if(this.mustUpdate=null,this.value.update)try{this.value.update(e)}catch(i){if(Fn(e.state,i,"CodeMirror plugin crashed"),this.value.destroy)try{this.value.destroy()}catch{}this.deactivate()}}}else if(this.spec)try{this.value=this.spec.plugin.create(t,this.spec.arg)}catch(e){Fn(t.state,e,"CodeMirror plugin crashed"),this.deactivate()}return this}destroy(t){var e;if(!((e=this.value)===null||e===void 0)&&e.destroy)try{this.value.destroy()}catch(i){Fn(t.state,i,"CodeMirror plugin crashed")}}deactivate(){this.spec=this.value=null}}const V3=Pe.define(),Hy=Pe.define(),Hh=Pe.define(),M3=Pe.define(),qy=Pe.define(),L3=Pe.define();function DP(s,t){let e=s.state.facet(L3);if(!e.length)return e;let i=e.map(r=>r instanceof Function?r(s):r),n=[];return st.spans(i,t.from,t.to,{point(){},span(r,o,l,a){let c=r-t.from,h=o-t.from,f=n;for(let m=l.length-1;m>=0;m--,a--){let w=l[m].spec.bidiIsolate,O;if(w==null&&(w=Kie(t.text,c,h)),a>0&&f.length&&(O=f[f.length-1]).to==c&&O.direction==w)O.to=h,f=O.inner;else{let _={from:c,to:h,direction:w,inner:[]};f.push(_),f=_.inner}}}}),n}const B3=Pe.define();function jy(s){let t=0,e=0,i=0,n=0;for(let r of s.state.facet(B3)){let o=r(s);o&&(o.left!=null&&(t=Math.max(t,o.left)),o.right!=null&&(e=Math.max(e,o.right)),o.top!=null&&(i=Math.max(i,o.top)),o.bottom!=null&&(n=Math.max(n,o.bottom)))}return{left:t,right:e,top:i,bottom:n}}const eh=Pe.define();class hs{constructor(t,e,i,n){this.fromA=t,this.toA=e,this.fromB=i,this.toB=n}join(t){return new hs(Math.min(this.fromA,t.fromA),Math.max(this.toA,t.toA),Math.min(this.fromB,t.fromB),Math.max(this.toB,t.toB))}addToSet(t){let e=t.length,i=this;for(;e>0;e--){let n=t[e-1];if(!(n.fromA>i.toA)){if(n.toA<i.fromA)break;i=i.join(n),t.splice(e-1,1)}}return t.splice(e,0,i),t}static extendWithRanges(t,e){if(e.length==0)return t;let i=[];for(let n=0,r=0,o=0,l=0;;n++){let a=n==t.length?null:t[n],c=o-l,h=a?a.fromB:1e9;for(;r<e.length&&e[r]<h;){let f=e[r],m=e[r+1],w=Math.max(l,f),O=Math.min(h,m);if(w<=O&&new hs(w+c,O+c,w,O).addToSet(i),m>h)break;r+=2}if(!a)return i;new hs(a.fromA,a.toA,a.fromB,a.toB).addToSet(i),o=a.toA,l=a.toB}}}class qg{constructor(t,e,i){this.view=t,this.state=e,this.transactions=i,this.flags=0,this.startState=t.state,this.changes=ci.empty(this.startState.doc.length);for(let r of i)this.changes=this.changes.compose(r.changes);let n=[];this.changes.iterChangedRanges((r,o,l,a)=>n.push(new hs(r,o,l,a))),this.changedRanges=n}static create(t,e,i){return new qg(t,e,i)}get viewportChanged(){return(this.flags&4)>0}get viewportMoved(){return(this.flags&8)>0}get heightChanged(){return(this.flags&2)>0}get geometryChanged(){return this.docChanged||(this.flags&18)>0}get focusChanged(){return(this.flags&1)>0}get docChanged(){return!this.changes.empty}get selectionSet(){return this.transactions.some(t=>t.selection)}get empty(){return this.flags==0&&this.transactions.length==0}}class QP extends vt{get length(){return this.view.state.doc.length}constructor(t){super(),this.view=t,this.decorations=[],this.dynamicDecorationMap=[!1],this.domChanged=null,this.hasComposition=null,this.markedForComposition=new Set,this.editContextFormatting=Je.none,this.lastCompositionAfterCursor=!1,this.minWidth=0,this.minWidthFrom=0,this.minWidthTo=0,this.impreciseAnchor=null,this.impreciseHead=null,this.forceSelection=!1,this.lastUpdate=Date.now(),this.setDOM(t.contentDOM),this.children=[new si],this.children[0].setParent(this),this.updateDeco(),this.updateInner([new hs(0,0,0,t.state.doc.length)],0,null)}update(t){var e;let i=t.changedRanges;this.minWidth>0&&i.length&&(i.every(({fromA:c,toA:h})=>h<this.minWidthFrom||c>this.minWidthTo)?(this.minWidthFrom=t.changes.mapPos(this.minWidthFrom,1),this.minWidthTo=t.changes.mapPos(this.minWidthTo,1)):this.minWidth=this.minWidthFrom=this.minWidthTo=0),this.updateEditContextFormatting(t);let n=-1;this.view.inputState.composing>=0&&!this.view.observer.editContext&&(!((e=this.domChanged)===null||e===void 0)&&e.newSel?n=this.domChanged.newSel.head:!one(t.changes,this.hasComposition)&&!t.selectionSet&&(n=t.state.selection.main.head));let r=n>-1?tne(this.view,t.changes,n):null;if(this.domChanged=null,this.hasComposition){this.markedForComposition.clear();let{from:c,to:h}=this.hasComposition;i=new hs(c,h,t.changes.mapPos(c,-1),t.changes.mapPos(h,1)).addToSet(i.slice())}this.hasComposition=r?{from:r.range.fromB,to:r.range.toB}:null,(ke.ie||ke.chrome)&&!r&&t&&t.state.doc.lines!=t.startState.doc.lines&&(this.forceSelection=!0);let o=this.decorations,l=this.updateDeco(),a=sne(o,l,t.changes);return i=hs.extendWithRanges(i,a),!(this.flags&7)&&i.length==0?!1:(this.updateInner(i,t.startState.doc.length,r),t.transactions.length&&(this.lastUpdate=Date.now()),!0)}updateInner(t,e,i){this.view.viewState.mustMeasureContent=!0,this.updateChildren(t,e,i);let{observer:n}=this.view;n.ignore(()=>{this.dom.style.height=this.view.viewState.contentHeight/this.view.scaleY+"px",this.dom.style.flexBasis=this.minWidth?this.minWidth+"px":"";let o=ke.chrome||ke.ios?{node:n.selectionRange.focusNode,written:!1}:void 0;this.sync(this.view,o),this.flags&=-8,o&&(o.written||n.selectionRange.focusNode!=o.node)&&(this.forceSelection=!0),this.dom.style.height=""}),this.markedForComposition.forEach(o=>o.flags&=-9);let r=[];if(this.view.viewport.from||this.view.viewport.to<this.view.state.doc.length)for(let o of this.children)o instanceof Vr&&o.widget instanceof z1&&r.push(o.dom);n.updateGaps(r)}updateChildren(t,e,i){let n=i?i.range.addToSet(t.slice()):t,r=this.childCursor(e);for(let o=n.length-1;;o--){let l=o>=0?n[o]:null;if(!l)break;let{fromA:a,toA:c,fromB:h,toB:f}=l,m,w,O,_;if(i&&i.range.fromB<f&&i.range.toB>h){let Q=bh.build(this.view.state.doc,h,i.range.fromB,this.decorations,this.dynamicDecorationMap),N=bh.build(this.view.state.doc,i.range.toB,f,this.decorations,this.dynamicDecorationMap);w=Q.breakAtStart,O=Q.openStart,_=N.openEnd;let G=this.compositionView(i);N.breakAtStart?G.breakAfter=1:N.content.length&&G.merge(G.length,G.length,N.content[0],!1,N.openStart,0)&&(G.breakAfter=N.content[0].breakAfter,N.content.shift()),Q.content.length&&G.merge(0,0,Q.content[Q.content.length-1],!0,0,Q.openEnd)&&Q.content.pop(),m=Q.content.concat(G).concat(N.content)}else({content:m,breakAtStart:w,openStart:O,openEnd:_}=bh.build(this.view.state.doc,h,f,this.decorations,this.dynamicDecorationMap));let{i:k,off:C}=r.findPos(c,1),{i:P,off:M}=r.findPos(a,-1);u3(this,P,M,k,C,m,w,O,_)}i&&this.fixCompositionDOM(i)}updateEditContextFormatting(t){this.editContextFormatting=this.editContextFormatting.map(t.changes);for(let e of t.transactions)for(let i of e.effects)i.is(R3)&&(this.editContextFormatting=i.value)}compositionView(t){let e=new Ds(t.text.nodeValue);e.flags|=8;for(let{deco:n}of t.marks)e=new Dr(n,[e],e.length);let i=new si;return i.append(e,0),i}fixCompositionDOM(t){let e=(r,o)=>{o.flags|=8|(o.children.some(a=>a.flags&7)?1:0),this.markedForComposition.add(o);let l=vt.get(r);l&&l!=o&&(l.dom=null),o.setDOM(r)},i=this.childPos(t.range.fromB,1),n=this.children[i.i];e(t.line,n);for(let r=t.marks.length-1;r>=-1;r--)i=n.childPos(i.off,1),n=n.children[i.i],e(r>=0?t.marks[r].node:t.text,n)}updateSelection(t=!1,e=!1){(t||!this.view.observer.selectionRange.focusNode)&&this.view.observer.readSelectionRange();let i=this.view.root.activeElement,n=i==this.dom,r=!n&&!(this.view.state.facet(Er)||this.dom.tabIndex>-1)&&jm(this.dom,this.view.observer.selectionRange)&&!(i&&this.dom.contains(i));if(!(n||e||r))return;let o=this.forceSelection;this.forceSelection=!1;let l=this.view.state.selection.main,a=this.moveToLine(this.domAtPos(l.anchor)),c=l.empty?a:this.moveToLine(this.domAtPos(l.head));if(ke.gecko&&l.empty&&!this.hasComposition&&ene(a)){let f=document.createTextNode("");this.view.observer.ignore(()=>a.node.insertBefore(f,a.node.childNodes[a.offset]||null)),a=c=new Ui(f,0),o=!0}let h=this.view.observer.selectionRange;(o||!h.focusNode||(!xh(a.node,a.offset,h.anchorNode,h.anchorOffset)||!xh(c.node,c.offset,h.focusNode,h.focusOffset))&&!this.suppressWidgetCursorChange(h,l))&&(this.view.observer.ignore(()=>{ke.android&&ke.chrome&&this.dom.contains(h.focusNode)&&rne(h.focusNode,this.dom)&&(this.dom.blur(),this.dom.focus({preventScroll:!0}));let f=Uh(this.view.root);if(f)if(l.empty){if(ke.gecko){let m=ine(a.node,a.offset);if(m&&m!=3){let w=(m==1?l3:a3)(a.node,a.offset);w&&(a=new Ui(w.node,w.offset))}}f.collapse(a.node,a.offset),l.bidiLevel!=null&&f.caretBidiLevel!==void 0&&(f.caretBidiLevel=l.bidiLevel)}else if(f.extend){f.collapse(a.node,a.offset);try{f.extend(c.node,c.offset)}catch{}}else{let m=document.createRange();l.anchor>l.head&&([a,c]=[c,a]),m.setEnd(c.node,c.offset),m.setStart(a.node,a.offset),f.removeAllRanges(),f.addRange(m)}r&&this.view.root.activeElement==this.dom&&(this.dom.blur(),i&&i.focus())}),this.view.observer.setSelectionRange(a,c)),this.impreciseAnchor=a.precise?null:new Ui(h.anchorNode,h.anchorOffset),this.impreciseHead=c.precise?null:new Ui(h.focusNode,h.focusOffset)}suppressWidgetCursorChange(t,e){return this.hasComposition&&e.empty&&xh(t.focusNode,t.focusOffset,t.anchorNode,t.anchorOffset)&&this.posFromDOM(t.focusNode,t.focusOffset)==e.head}enforceCursorAssoc(){if(this.hasComposition)return;let{view:t}=this,e=t.state.selection.main,i=Uh(t.root),{anchorNode:n,anchorOffset:r}=t.observer.selectionRange;if(!i||!e.empty||!e.assoc||!i.modify)return;let o=si.find(this,e.head);if(!o)return;let l=o.posAtStart;if(e.head==l||e.head==l+o.length)return;let a=this.coordsAt(e.head,-1),c=this.coordsAt(e.head,1);if(!a||!c||a.bottom>c.top)return;let h=this.domAtPos(e.head+e.assoc);i.collapse(h.node,h.offset),i.modify("move",e.assoc<0?"forward":"backward","lineboundary"),t.observer.readSelectionRange();let f=t.observer.selectionRange;t.docView.posFromDOM(f.anchorNode,f.anchorOffset)!=e.from&&i.collapse(n,r)}moveToLine(t){let e=this.dom,i;if(t.node!=e)return t;for(let n=t.offset;!i&&n<e.childNodes.length;n++){let r=vt.get(e.childNodes[n]);r instanceof si&&(i=r.domAtPos(0))}for(let n=t.offset-1;!i&&n>=0;n--){let r=vt.get(e.childNodes[n]);r instanceof si&&(i=r.domAtPos(r.length))}return i?new Ui(i.node,i.offset,!0):t}nearest(t){for(let e=t;e;){let i=vt.get(e);if(i&&i.rootView==this)return i;e=e.parentNode}return null}posFromDOM(t,e){let i=this.nearest(t);if(!i)throw new RangeError("Trying to find position for a DOM position outside of the document");return i.localPosFromDOM(t,e)+i.posAtStart}domAtPos(t){let{i:e,off:i}=this.childCursor().findPos(t,-1);for(;e<this.children.length-1;){let n=this.children[e];if(i<n.length||n instanceof si)break;e++,i=0}return this.children[e].domAtPos(i)}coordsAt(t,e){let i=null,n=0;for(let r=this.length,o=this.children.length-1;o>=0;o--){let l=this.children[o],a=r-l.breakAfter,c=a-l.length;if(a<t)break;if(c<=t&&(c<t||l.covers(-1))&&(a>t||l.covers(1))&&(!i||l instanceof si&&!(i instanceof si&&e>=0)))i=l,n=c;else if(i&&c==t&&a==t&&l instanceof Vr&&Math.abs(e)<2){if(l.deco.startSide<0)break;o&&(i=null)}r=c}return i?i.coordsAt(t-n,e):null}coordsForChar(t){let{i:e,off:i}=this.childPos(t,1),n=this.children[e];if(!(n instanceof si))return null;for(;n.children.length;){let{i:l,off:a}=n.childPos(i,1);for(;;l++){if(l==n.children.length)return null;if((n=n.children[l]).length)break}i=a}if(!(n instanceof Ds))return null;let r=en(n.text,i);if(r==i)return null;let o=Ll(n.dom,i,r).getClientRects();for(let l=0;l<o.length;l++){let a=o[l];if(l==o.length-1||a.top<a.bottom&&a.left<a.right)return a}return null}measureVisibleLineHeights(t){let e=[],{from:i,to:n}=t,r=this.view.contentDOM.clientWidth,o=r>Math.max(this.view.scrollDOM.clientWidth,this.minWidth)+1,l=-1,a=this.view.textDirection==Bt.LTR;for(let c=0,h=0;h<this.children.length;h++){let f=this.children[h],m=c+f.length;if(m>n)break;if(c>=i){let w=f.dom.getBoundingClientRect();if(e.push(w.height),o){let O=f.dom.lastChild,_=O?Zh(O):[];if(_.length){let k=_[_.length-1],C=a?k.right-w.left:w.right-k.left;C>l&&(l=C,this.minWidth=r,this.minWidthFrom=c,this.minWidthTo=m)}}}c=m+f.breakAfter}return e}textDirectionAt(t){let{i:e}=this.childPos(t,1);return getComputedStyle(this.children[e].dom).direction=="rtl"?Bt.RTL:Bt.LTR}measureTextSize(){for(let r of this.children)if(r instanceof si){let o=r.measureTextSize();if(o)return o}let t=document.createElement("div"),e,i,n;return t.className="cm-line",t.style.width="99999px",t.style.position="absolute",t.textContent="abc def ghi jkl mno pqr stu",this.view.observer.ignore(()=>{this.dom.appendChild(t);let r=Zh(t.firstChild)[0];e=t.getBoundingClientRect().height,i=r?r.width/27:7,n=r?r.height:e,t.remove()}),{lineHeight:e,charWidth:i,textHeight:n}}childCursor(t=this.length){let e=this.children.length;return e&&(t-=this.children[--e].length),new c3(this.children,t,e)}computeBlockGapDeco(){let t=[],e=this.view.viewState;for(let i=0,n=0;;n++){let r=n==e.viewports.length?null:e.viewports[n],o=r?r.from-1:this.length;if(o>i){let l=(e.lineBlockAt(o).bottom-e.lineBlockAt(i).top)/this.view.scaleY;t.push(Je.replace({widget:new z1(l),block:!0,inclusive:!0,isBlockGap:!0}).range(i,o))}if(!r)break;i=r.to+1}return Je.set(t)}updateDeco(){let t=1,e=this.view.state.facet(Hh).map(r=>(this.dynamicDecorationMap[t++]=typeof r=="function")?r(this.view):r),i=!1,n=this.view.state.facet(M3).map((r,o)=>{let l=typeof r=="function";return l&&(i=!0),l?r(this.view):r});for(n.length&&(this.dynamicDecorationMap[t++]=i,e.push(st.join(n))),this.decorations=[this.editContextFormatting,...e,this.computeBlockGapDeco(),this.view.viewState.lineGapDeco];t<this.decorations.length;)this.dynamicDecorationMap[t++]=!1;return this.decorations}scrollIntoView(t){if(t.isSnapshot){let c=this.view.viewState.lineBlockAt(t.range.head);this.view.scrollDOM.scrollTop=c.top-t.yMargin,this.view.scrollDOM.scrollLeft=t.xMargin;return}for(let c of this.view.state.facet(I3))try{if(c(this.view,t.range,t))return!0}catch(h){Fn(this.view.state,h,"scroll handler")}let{range:e}=t,i=this.coordsAt(e.head,e.empty?e.assoc:e.head>e.anchor?-1:1),n;if(!i)return;!e.empty&&(n=this.coordsAt(e.anchor,e.anchor>e.head?-1:1))&&(i={left:Math.min(i.left,n.left),top:Math.min(i.top,n.top),right:Math.max(i.right,n.right),bottom:Math.max(i.bottom,n.bottom)});let r=jy(this.view),o={left:i.left-r.left,top:i.top-r.top,right:i.right+r.right,bottom:i.bottom+r.bottom},{offsetWidth:l,offsetHeight:a}=this.view.scrollDOM;Rie(this.view.scrollDOM,o,e.head<e.anchor?-1:1,t.x,t.y,Math.max(Math.min(t.xMargin,l),-l),Math.max(Math.min(t.yMargin,a),-a),this.view.textDirection==Bt.LTR)}}function ene(s){return s.node.nodeType==1&&s.node.firstChild&&(s.offset==0||s.node.childNodes[s.offset-1].contentEditable=="false")&&(s.offset==s.node.childNodes.length||s.node.childNodes[s.offset].contentEditable=="false")}function $3(s,t){let e=s.observer.selectionRange;if(!e.focusNode)return null;let i=l3(e.focusNode,e.focusOffset),n=a3(e.focusNode,e.focusOffset),r=i||n;if(n&&i&&n.node!=i.node){let l=vt.get(n.node);if(!l||l instanceof Ds&&l.text!=n.node.nodeValue)r=n;else if(s.docView.lastCompositionAfterCursor){let a=vt.get(i.node);!a||a instanceof Ds&&a.text!=i.node.nodeValue||(r=n)}}if(s.docView.lastCompositionAfterCursor=r!=i,!r)return null;let o=t-r.offset;return{from:o,to:o+r.node.nodeValue.length,node:r.node}}function tne(s,t,e){let i=$3(s,e);if(!i)return null;let{node:n,from:r,to:o}=i,l=n.nodeValue;if(/[\n\r]/.test(l)||s.state.doc.sliceString(i.from,i.to)!=l)return null;let a=t.invertedDesc,c=new hs(a.mapPos(r),a.mapPos(o),r,o),h=[];for(let f=n.parentNode;;f=f.parentNode){let m=vt.get(f);if(m instanceof Dr)h.push({node:f,deco:m.mark});else{if(m instanceof si||f.nodeName=="DIV"&&f.parentNode==s.contentDOM)return{range:c,text:n,marks:h,line:f};if(f!=s.contentDOM)h.push({node:f,deco:new yd({inclusive:!0,attributes:zie(f),tagName:f.tagName.toLowerCase()})});else return null}}}function ine(s,t){return s.nodeType!=1?0:(t&&s.childNodes[t-1].contentEditable=="false"?1:0)|(t<s.childNodes.length&&s.childNodes[t].contentEditable=="false"?2:0)}let nne=class{constructor(){this.changes=[]}compareRange(t,e){Xm(t,e,this.changes)}comparePoint(t,e){Xm(t,e,this.changes)}boundChange(t){Xm(t,t,this.changes)}};function sne(s,t,e){let i=new nne;return st.compare(s,t,e,i),i.changes}function rne(s,t){for(let e=s;e&&e!=t;e=e.assignedSlot||e.parentNode)if(e.nodeType==1&&e.contentEditable=="false")return!0;return!1}function one(s,t){let e=!1;return t&&s.iterChangedRanges((i,n)=>{i<t.to&&n>t.from&&(e=!0)}),e}function lne(s,t,e=1){let i=s.charCategorizer(t),n=s.doc.lineAt(t),r=t-n.from;if(n.length==0)return se.cursor(t);r==0?e=1:r==n.length&&(e=-1);let o=r,l=r;e<0?o=en(n.text,r,!1):l=en(n.text,r);let a=i(n.text.slice(o,l));for(;o>0;){let c=en(n.text,o,!1);if(i(n.text.slice(c,o))!=a)break;o=c}for(;l<n.length;){let c=en(n.text,l);if(i(n.text.slice(l,c))!=a)break;l=c}return se.range(o+n.from,l+n.from)}function ane(s,t){return t.left>s?t.left-s:Math.max(0,s-t.right)}function cne(s,t){return t.top>s?t.top-s:Math.max(0,s-t.bottom)}function Wx(s,t){return s.top<t.bottom-1&&s.bottom>t.top+1}function NP(s,t){return t<s.top?{top:t,left:s.left,right:s.right,bottom:s.bottom}:s}function FP(s,t){return t>s.bottom?{top:s.top,left:s.left,right:s.right,bottom:t}:s}function q1(s,t,e){let i,n,r,o,l=!1,a,c,h,f;for(let O=s.firstChild;O;O=O.nextSibling){let _=Zh(O);for(let k=0;k<_.length;k++){let C=_[k];n&&Wx(n,C)&&(C=NP(FP(C,n.bottom),n.top));let P=ane(t,C),M=cne(e,C);if(P==0&&M==0)return O.nodeType==3?zP(O,t,e):q1(O,t,e);(!i||o>M||o==M&&r>P)&&(i=O,n=C,r=P,o=M,l=P?t<C.left?k>0:k<_.length-1:!0),P==0?e>C.bottom&&(!h||h.bottom<C.bottom)?(a=O,h=C):e<C.top&&(!f||f.top>C.top)&&(c=O,f=C):h&&Wx(h,C)?h=FP(h,C.bottom):f&&Wx(f,C)&&(f=NP(f,C.top))}}if(h&&h.bottom>=e?(i=a,n=h):f&&f.top<=e&&(i=c,n=f),!i)return{node:s,offset:0};let m=Math.max(n.left,Math.min(n.right,t));if(i.nodeType==3)return zP(i,m,e);if(l&&i.contentEditable!="false")return q1(i,m,e);let w=Array.prototype.indexOf.call(s.childNodes,i)+(t>=(n.left+n.right)/2?1:0);return{node:s,offset:w}}function zP(s,t,e){let i=s.nodeValue.length,n=-1,r=1e9,o=0;for(let l=0;l<i;l++){let a=Ll(s,l,l+1).getClientRects();for(let c=0;c<a.length;c++){let h=a[c];if(h.top==h.bottom)continue;o||(o=t-h.left);let f=(h.top>e?h.top-e:e-h.bottom)-1;if(h.left-1<=t&&h.right+1>=t&&f<r){let m=t>=(h.left+h.right)/2,w=m;if((ke.chrome||ke.gecko)&&Ll(s,l).getBoundingClientRect().left==h.right&&(w=!m),f<=0)return{node:s,offset:l+(w?1:0)};n=l+(w?1:0),r=f}}}return{node:s,offset:n>-1?n:o>0?s.nodeValue.length:0}}function D3(s,t,e,i=-1){var n,r;let o=s.contentDOM.getBoundingClientRect(),l=o.top+s.viewState.paddingTop,a,{docHeight:c}=s.viewState,{x:h,y:f}=t,m=f-l;if(m<0)return 0;if(m>c)return s.state.doc.length;for(let Q=s.viewState.heightOracle.textHeight/2,N=!1;a=s.elementAtHeight(m),a.type!=sn.Text;)for(;m=i>0?a.bottom+Q:a.top-Q,!(m>=0&&m<=c);){if(N)return e?null:0;N=!0,i=-i}f=l+m;let w=a.from;if(w<s.viewport.from)return s.viewport.from==0?0:e?null:WP(s,o,a,h,f);if(w>s.viewport.to)return s.viewport.to==s.state.doc.length?s.state.doc.length:e?null:WP(s,o,a,h,f);let O=s.dom.ownerDocument,_=s.root.elementFromPoint?s.root:O,k=_.elementFromPoint(h,f);k&&!s.contentDOM.contains(k)&&(k=null),k||(h=Math.max(o.left+1,Math.min(o.right-1,h)),k=_.elementFromPoint(h,f),k&&!s.contentDOM.contains(k)&&(k=null));let C,P=-1;if(k&&((n=s.docView.nearest(k))===null||n===void 0?void 0:n.isEditable)!=!1){if(O.caretPositionFromPoint){let Q=O.caretPositionFromPoint(h,f);Q&&({offsetNode:C,offset:P}=Q)}else if(O.caretRangeFromPoint){let Q=O.caretRangeFromPoint(h,f);Q&&({startContainer:C,startOffset:P}=Q,(!s.contentDOM.contains(C)||ke.safari&&une(C,P,h)||ke.chrome&&hne(C,P,h))&&(C=void 0))}C&&(P=Math.min(ur(C),P))}if(!C||!s.docView.dom.contains(C)){let Q=si.find(s.docView,w);if(!Q)return m>a.top+a.height/2?a.to:a.from;({node:C,offset:P}=q1(Q.dom,h,f))}let M=s.docView.nearest(C);if(!M)return null;if(M.isWidget&&((r=M.dom)===null||r===void 0?void 0:r.nodeType)==1){let Q=M.dom.getBoundingClientRect();return t.y<Q.top||t.y<=Q.bottom&&t.x<=(Q.left+Q.right)/2?M.posAtStart:M.posAtEnd}else return M.localPosFromDOM(C,P)+M.posAtStart}function WP(s,t,e,i,n){let r=Math.round((i-t.left)*s.defaultCharacterWidth);if(s.lineWrapping&&e.height>s.defaultLineHeight*1.5){let l=s.viewState.heightOracle.textHeight,a=Math.floor((n-e.top-(s.defaultLineHeight-l)*.5)/l);r+=a*s.viewState.heightOracle.lineLength}let o=s.state.sliceDoc(e.from,e.to);return e.from+V1(o,r,s.state.tabSize)}function une(s,t,e){let i,n=s;if(s.nodeType!=3||t!=(i=s.nodeValue.length))return!1;for(;;){let r=n.nextSibling;if(r){if(r.nodeName=="BR")break;return!1}else{let o=n.parentNode;if(!o||o.nodeName=="DIV")break;n=o}}return Ll(s,i-1,i).getBoundingClientRect().right>e}function hne(s,t,e){if(t!=0)return!1;for(let n=s;;){let r=n.parentNode;if(!r||r.nodeType!=1||r.firstChild!=n)return!1;if(r.classList.contains("cm-line"))break;n=r}let i=s.nodeType==1?s.getBoundingClientRect():Ll(s,0,Math.max(s.nodeValue.length,1)).getBoundingClientRect();return e-i.left>5}function j1(s,t,e){let i=s.lineBlockAt(t);if(Array.isArray(i.type)){let n;for(let r of i.type){if(r.from>t)break;if(!(r.to<t)){if(r.from<t&&r.to>t)return r;(!n||r.type==sn.Text&&(n.type!=r.type||(e<0?r.from<t:r.to>t)))&&(n=r)}}return n||i}return i}function dne(s,t,e,i){let n=j1(s,t.head,t.assoc||-1),r=!i||n.type!=sn.Text||!(s.lineWrapping||n.widgetLineBreaks)?null:s.coordsAtPos(t.assoc<0&&t.head>n.from?t.head-1:t.head);if(r){let o=s.dom.getBoundingClientRect(),l=s.textDirectionAt(n.from),a=s.posAtCoords({x:e==(l==Bt.LTR)?o.right-1:o.left+1,y:(r.top+r.bottom)/2});if(a!=null)return se.cursor(a,e?-1:1)}return se.cursor(e?n.to:n.from,e?-1:1)}function UP(s,t,e,i){let n=s.state.doc.lineAt(t.head),r=s.bidiSpans(n),o=s.textDirectionAt(n.from);for(let l=t,a=null;;){let c=Yie(n,r,o,l,e),h=v3;if(!c){if(n.number==(e?s.state.doc.lines:1))return l;h=`
`,n=s.state.doc.line(n.number+(e?1:-1)),r=s.bidiSpans(n),c=s.visualLineSide(n,!e)}if(a){if(!a(h))return l}else{if(!i)return c;a=i(h)}l=c}}function fne(s,t,e){let i=s.state.charCategorizer(t),n=i(e);return r=>{let o=i(r);return n==ss.Space&&(n=o),n==o}}function mne(s,t,e,i){let n=t.head,r=e?1:-1;if(n==(e?s.state.doc.length:0))return se.cursor(n,t.assoc);let o=t.goalColumn,l,a=s.contentDOM.getBoundingClientRect(),c=s.coordsAtPos(n,t.assoc||-1),h=s.documentTop;if(c)o==null&&(o=c.left-a.left),l=r<0?c.top:c.bottom;else{let w=s.viewState.lineBlockAt(n);o==null&&(o=Math.min(a.right-a.left,s.defaultCharacterWidth*(n-w.from))),l=(r<0?w.top:w.bottom)+h}let f=a.left+o,m=i??s.viewState.heightOracle.textHeight>>1;for(let w=0;;w+=10){let O=l+(m+w)*r,_=D3(s,{x:f,y:O},!1,r);if(O<a.top||O>a.bottom||(r<0?_<n:_>n)){let k=s.docView.coordsForChar(_),C=!k||O<k.top?-1:1;return se.cursor(_,C,void 0,o)}}}function Gm(s,t,e){for(;;){let i=0;for(let n of s)n.between(t-1,t+1,(r,o,l)=>{if(t>r&&t<o){let a=i||e||(t-r<o-t?-1:1);t=a<0?r:o,i=a}});if(!i)return t}}function Ux(s,t,e){let i=Gm(s.state.facet(qy).map(n=>n(s)),e.from,t.head>e.from?-1:1);return i==e.from?e:se.cursor(i,i<e.from?1:-1)}const th="￿";class gne{constructor(t,e){this.points=t,this.text="",this.lineSeparator=e.facet(ht.lineSeparator)}append(t){this.text+=t}lineBreak(){this.text+=th}readRange(t,e){if(!t)return this;let i=t.parentNode;for(let n=t;;){this.findPointBefore(i,n);let r=this.text.length;this.readNode(n);let o=n.nextSibling;if(o==e)break;let l=vt.get(n),a=vt.get(o);(l&&a?l.breakAfter:(l?l.breakAfter:Zg(n))||Zg(o)&&(n.nodeName!="BR"||n.cmIgnore)&&this.text.length>r)&&this.lineBreak(),n=o}return this.findPointBefore(i,e),this}readTextNode(t){let e=t.nodeValue;for(let i of this.points)i.node==t&&(i.pos=this.text.length+Math.min(i.offset,e.length));for(let i=0,n=this.lineSeparator?null:/\r\n?|\n/g;;){let r=-1,o=1,l;if(this.lineSeparator?(r=e.indexOf(this.lineSeparator,i),o=this.lineSeparator.length):(l=n.exec(e))&&(r=l.index,o=l[0].length),this.append(e.slice(i,r<0?e.length:r)),r<0)break;if(this.lineBreak(),o>1)for(let a of this.points)a.node==t&&a.pos>this.text.length&&(a.pos-=o-1);i=r+o}}readNode(t){if(t.cmIgnore)return;let e=vt.get(t),i=e&&e.overrideDOMText;if(i!=null){this.findPointInside(t,i.length);for(let n=i.iter();!n.next().done;)n.lineBreak?this.lineBreak():this.append(n.value)}else t.nodeType==3?this.readTextNode(t):t.nodeName=="BR"?t.nextSibling&&this.lineBreak():t.nodeType==1&&this.readRange(t.firstChild,null)}findPointBefore(t,e){for(let i of this.points)i.node==t&&t.childNodes[i.offset]==e&&(i.pos=this.text.length)}findPointInside(t,e){for(let i of this.points)(t.nodeType==3?i.node==t:t.contains(i.node))&&(i.pos=this.text.length+(pne(t,i.node,i.offset)?e:0))}}function pne(s,t,e){for(;;){if(!t||e<ur(t))return!1;if(t==s)return!0;e=Ml(t)+1,t=t.parentNode}}class ZP{constructor(t,e){this.node=t,this.offset=e,this.pos=-1}}class wne{constructor(t,e,i,n){this.typeOver=n,this.bounds=null,this.text="",this.domChanged=e>-1;let{impreciseHead:r,impreciseAnchor:o}=t.docView;if(t.state.readOnly&&e>-1)this.newSel=null;else if(e>-1&&(this.bounds=t.docView.domBoundsAround(e,i,0))){let l=r||o?[]:One(t),a=new gne(l,t.state);a.readRange(this.bounds.startDOM,this.bounds.endDOM),this.text=a.text,this.newSel=yne(l,this.bounds.from)}else{let l=t.observer.selectionRange,a=r&&r.node==l.focusNode&&r.offset==l.focusOffset||!B1(t.contentDOM,l.focusNode)?t.state.selection.main.head:t.docView.posFromDOM(l.focusNode,l.focusOffset),c=o&&o.node==l.anchorNode&&o.offset==l.anchorOffset||!B1(t.contentDOM,l.anchorNode)?t.state.selection.main.anchor:t.docView.posFromDOM(l.anchorNode,l.anchorOffset),h=t.viewport;if((ke.ios||ke.chrome)&&t.state.selection.main.empty&&a!=c&&(h.from>0||h.to<t.state.doc.length)){let f=Math.min(a,c),m=Math.max(a,c),w=h.from-f,O=h.to-m;(w==0||w==1||f==0)&&(O==0||O==-1||m==t.state.doc.length)&&(a=0,c=t.state.doc.length)}this.newSel=se.single(c,a)}}}function Q3(s,t){let e,{newSel:i}=t,n=s.state.selection.main,r=s.inputState.lastKeyTime>Date.now()-100?s.inputState.lastKeyCode:-1;if(t.bounds){let{from:o,to:l}=t.bounds,a=n.from,c=null;(r===8||ke.android&&t.text.length<l-o)&&(a=n.to,c="end");let h=bne(s.state.doc.sliceString(o,l,th),t.text,a-o,c);h&&(ke.chrome&&r==13&&h.toB==h.from+2&&t.text.slice(h.from,h.toB)==th+th&&h.toB--,e={from:o+h.from,to:o+h.toA,insert:Ke.of(t.text.slice(h.from,h.toB).split(th))})}else i&&(!s.hasFocus&&s.state.facet(Er)||i.main.eq(n))&&(i=null);if(!e&&!i)return!1;if(!e&&t.typeOver&&!n.empty&&i&&i.main.empty?e={from:n.from,to:n.to,insert:s.state.doc.slice(n.from,n.to)}:(ke.mac||ke.android)&&e&&e.from==e.to&&e.from==n.head-1&&/^\. ?$/.test(e.insert.toString())&&s.contentDOM.getAttribute("autocorrect")=="off"?(i&&e.insert.length==2&&(i=se.single(i.main.anchor-1,i.main.head-1)),e={from:e.from,to:e.to,insert:Ke.of([e.insert.toString().replace("."," ")])}):e&&e.from>=n.from&&e.to<=n.to&&(e.from!=n.from||e.to!=n.to)&&n.to-n.from-(e.to-e.from)<=4?e={from:n.from,to:n.to,insert:s.state.doc.slice(n.from,e.from).append(e.insert).append(s.state.doc.slice(e.to,n.to))}:ke.chrome&&e&&e.from==e.to&&e.from==n.head&&e.insert.toString()==`
 `&&s.lineWrapping&&(i&&(i=se.single(i.main.anchor-1,i.main.head-1)),e={from:n.from,to:n.to,insert:Ke.of([" "])}),e)return Xy(s,e,i,r);if(i&&!i.main.eq(n)){let o=!1,l="select";return s.inputState.lastSelectionTime>Date.now()-50&&(s.inputState.lastSelectionOrigin=="select"&&(o=!0),l=s.inputState.lastSelectionOrigin),s.dispatch({selection:i,scrollIntoView:o,userEvent:l}),!0}else return!1}function Xy(s,t,e,i=-1){if(ke.ios&&s.inputState.flushIOSKey(t))return!0;let n=s.state.selection.main;if(ke.android&&(t.to==n.to&&(t.from==n.from||t.from==n.from-1&&s.state.sliceDoc(t.from,n.from)==" ")&&t.insert.length==1&&t.insert.lines==2&&lc(s.contentDOM,"Enter",13)||(t.from==n.from-1&&t.to==n.to&&t.insert.length==0||i==8&&t.insert.length<t.to-t.from&&t.to>n.head)&&lc(s.contentDOM,"Backspace",8)||t.from==n.from&&t.to==n.to+1&&t.insert.length==0&&lc(s.contentDOM,"Delete",46)))return!0;let r=t.insert.toString();s.inputState.composing>=0&&s.inputState.composing++;let o,l=()=>o||(o=xne(s,t,e));return s.state.facet(P3).some(a=>a(s,t.from,t.to,r,l))||s.dispatch(l()),!0}function xne(s,t,e){let i,n=s.state,r=n.selection.main;if(t.from>=r.from&&t.to<=r.to&&t.to-t.from>=(r.to-r.from)/3&&(!e||e.main.empty&&e.main.from==t.from+t.insert.length)&&s.inputState.composing<0){let l=r.from<t.from?n.sliceDoc(r.from,t.from):"",a=r.to>t.to?n.sliceDoc(t.to,r.to):"";i=n.replaceSelection(s.state.toText(l+t.insert.sliceString(0,void 0,s.state.lineBreak)+a))}else{let l=n.changes(t),a=e&&e.main.to<=l.newLength?e.main:void 0;if(n.selection.ranges.length>1&&s.inputState.composing>=0&&t.to<=r.to&&t.to>=r.to-10){let c=s.state.sliceDoc(t.from,t.to),h,f=e&&$3(s,e.main.head);if(f){let O=t.insert.length-(t.to-t.from);h={from:f.from,to:f.to-O}}else h=s.state.doc.lineAt(r.head);let m=r.to-t.to,w=r.to-r.from;i=n.changeByRange(O=>{if(O.from==r.from&&O.to==r.to)return{changes:l,range:a||O.map(l)};let _=O.to-m,k=_-c.length;if(O.to-O.from!=w||s.state.sliceDoc(k,_)!=c||O.to>=h.from&&O.from<=h.to)return{range:O};let C=n.changes({from:k,to:_,insert:t.insert}),P=O.to-r.to;return{changes:C,range:a?se.range(Math.max(0,a.anchor+P),Math.max(0,a.head+P)):O.map(C)}})}else i={changes:l,selection:a&&n.selection.replaceRange(a)}}let o="input.type";return(s.composing||s.inputState.compositionPendingChange&&s.inputState.compositionEndedAt>Date.now()-50)&&(s.inputState.compositionPendingChange=!1,o+=".compose",s.inputState.compositionFirstChange&&(o+=".start",s.inputState.compositionFirstChange=!1)),n.update(i,{userEvent:o,scrollIntoView:!0})}function bne(s,t,e,i){let n=Math.min(s.length,t.length),r=0;for(;r<n&&s.charCodeAt(r)==t.charCodeAt(r);)r++;if(r==n&&s.length==t.length)return null;let o=s.length,l=t.length;for(;o>0&&l>0&&s.charCodeAt(o-1)==t.charCodeAt(l-1);)o--,l--;if(i=="end"){let a=Math.max(0,r-Math.min(o,l));e-=o+a-r}if(o<r&&s.length<t.length){let a=e<=r&&e>=o?r-e:0;r-=a,l=r+(l-o),o=r}else if(l<r){let a=e<=r&&e>=l?r-e:0;r-=a,o=r+(o-l),l=r}return{from:r,toA:o,toB:l}}function One(s){let t=[];if(s.root.activeElement!=s.contentDOM)return t;let{anchorNode:e,anchorOffset:i,focusNode:n,focusOffset:r}=s.observer.selectionRange;return e&&(t.push(new ZP(e,i)),(n!=e||r!=i)&&t.push(new ZP(n,r))),t}function yne(s,t){if(s.length==0)return null;let e=s[0].pos,i=s.length==2?s[1].pos:e;return e>-1&&i>-1?se.single(e+t,i+t):null}class vne{setSelectionOrigin(t){this.lastSelectionOrigin=t,this.lastSelectionTime=Date.now()}constructor(t){this.view=t,this.lastKeyCode=0,this.lastKeyTime=0,this.lastTouchTime=0,this.lastFocusTime=0,this.lastScrollTop=0,this.lastScrollLeft=0,this.pendingIOSKey=void 0,this.tabFocusMode=-1,this.lastSelectionOrigin=null,this.lastSelectionTime=0,this.lastContextMenu=0,this.scrollHandlers=[],this.handlers=Object.create(null),this.composing=-1,this.compositionFirstChange=null,this.compositionEndedAt=0,this.compositionPendingKey=!1,this.compositionPendingChange=!1,this.mouseSelection=null,this.draggedContent=null,this.handleEvent=this.handleEvent.bind(this),this.notifiedFocused=t.hasFocus,ke.safari&&t.contentDOM.addEventListener("input",()=>null),ke.gecko&&Dne(t.contentDOM.ownerDocument)}handleEvent(t){!Ane(this.view,t)||this.ignoreDuringComposition(t)||t.type=="keydown"&&this.keydown(t)||(this.view.updateState!=0?Promise.resolve().then(()=>this.runHandlers(t.type,t)):this.runHandlers(t.type,t))}runHandlers(t,e){let i=this.handlers[t];if(i){for(let n of i.observers)n(this.view,e);for(let n of i.handlers){if(e.defaultPrevented)break;if(n(this.view,e)){e.preventDefault();break}}}}ensureHandlers(t){let e=_ne(t),i=this.handlers,n=this.view.contentDOM;for(let r in e)if(r!="scroll"){let o=!e[r].handlers.length,l=i[r];l&&o!=!l.handlers.length&&(n.removeEventListener(r,this.handleEvent),l=null),l||n.addEventListener(r,this.handleEvent,{passive:o})}for(let r in i)r!="scroll"&&!e[r]&&n.removeEventListener(r,this.handleEvent);this.handlers=e}keydown(t){if(this.lastKeyCode=t.keyCode,this.lastKeyTime=Date.now(),t.keyCode==9&&this.tabFocusMode>-1&&(!this.tabFocusMode||Date.now()<=this.tabFocusMode))return!0;if(this.tabFocusMode>0&&t.keyCode!=27&&F3.indexOf(t.keyCode)<0&&(this.tabFocusMode=-1),ke.android&&ke.chrome&&!t.synthetic&&(t.keyCode==13||t.keyCode==8))return this.view.observer.delayAndroidKey(t.key,t.keyCode),!0;let e;return ke.ios&&!t.synthetic&&!t.altKey&&!t.metaKey&&((e=N3.find(i=>i.keyCode==t.keyCode))&&!t.ctrlKey||kne.indexOf(t.key)>-1&&t.ctrlKey&&!t.shiftKey)?(this.pendingIOSKey=e||t,setTimeout(()=>this.flushIOSKey(),250),!0):(t.keyCode!=229&&this.view.observer.forceFlush(),!1)}flushIOSKey(t){let e=this.pendingIOSKey;return!e||e.key=="Enter"&&t&&t.from<t.to&&/^\S+$/.test(t.insert.toString())?!1:(this.pendingIOSKey=void 0,lc(this.view.contentDOM,e.key,e.keyCode,e instanceof KeyboardEvent?e:void 0))}ignoreDuringComposition(t){return/^key/.test(t.type)?this.composing>0?!0:ke.safari&&!ke.ios&&this.compositionPendingKey&&Date.now()-this.compositionEndedAt<100?(this.compositionPendingKey=!1,!0):!1:!1}startMouseSelection(t){this.mouseSelection&&this.mouseSelection.destroy(),this.mouseSelection=t}update(t){this.view.observer.update(t),this.mouseSelection&&this.mouseSelection.update(t),this.draggedContent&&t.docChanged&&(this.draggedContent=this.draggedContent.map(t.changes)),t.transactions.length&&(this.lastKeyCode=this.lastSelectionTime=0)}destroy(){this.mouseSelection&&this.mouseSelection.destroy()}}function HP(s,t){return(e,i)=>{try{return t.call(s,i,e)}catch(n){Fn(e.state,n)}}}function _ne(s){let t=Object.create(null);function e(i){return t[i]||(t[i]={observers:[],handlers:[]})}for(let i of s){let n=i.spec,r=n&&n.plugin.domEventHandlers,o=n&&n.plugin.domEventObservers;if(r)for(let l in r){let a=r[l];a&&e(l).handlers.push(HP(i.value,a))}if(o)for(let l in o){let a=o[l];a&&e(l).observers.push(HP(i.value,a))}}for(let i in Qs)e(i).handlers.push(Qs[i]);for(let i in ws)e(i).observers.push(ws[i]);return t}const N3=[{key:"Backspace",keyCode:8,inputType:"deleteContentBackward"},{key:"Enter",keyCode:13,inputType:"insertParagraph"},{key:"Enter",keyCode:13,inputType:"insertLineBreak"},{key:"Delete",keyCode:46,inputType:"deleteContentForward"}],kne="dthko",F3=[16,17,18,20,91,92,224,225],mm=6;function gm(s){return Math.max(0,s)*.7+8}function Sne(s,t){return Math.max(Math.abs(s.clientX-t.clientX),Math.abs(s.clientY-t.clientY))}class Cne{constructor(t,e,i,n){this.view=t,this.startEvent=e,this.style=i,this.mustSelect=n,this.scrollSpeed={x:0,y:0},this.scrolling=-1,this.lastEvent=e,this.scrollParents=Vie(t.contentDOM),this.atoms=t.state.facet(qy).map(o=>o(t));let r=t.contentDOM.ownerDocument;r.addEventListener("mousemove",this.move=this.move.bind(this)),r.addEventListener("mouseup",this.up=this.up.bind(this)),this.extend=e.shiftKey,this.multiple=t.state.facet(ht.allowMultipleSelections)&&Pne(t,e),this.dragging=Ene(t,e)&&U3(e)==1?null:!1}start(t){this.dragging===!1&&this.select(t)}move(t){if(t.buttons==0)return this.destroy();if(this.dragging||this.dragging==null&&Sne(this.startEvent,t)<10)return;this.select(this.lastEvent=t);let e=0,i=0,n=0,r=0,o=this.view.win.innerWidth,l=this.view.win.innerHeight;this.scrollParents.x&&({left:n,right:o}=this.scrollParents.x.getBoundingClientRect()),this.scrollParents.y&&({top:r,bottom:l}=this.scrollParents.y.getBoundingClientRect());let a=jy(this.view);t.clientX-a.left<=n+mm?e=-gm(n-t.clientX):t.clientX+a.right>=o-mm&&(e=gm(t.clientX-o)),t.clientY-a.top<=r+mm?i=-gm(r-t.clientY):t.clientY+a.bottom>=l-mm&&(i=gm(t.clientY-l)),this.setScrollSpeed(e,i)}up(t){this.dragging==null&&this.select(this.lastEvent),this.dragging||t.preventDefault(),this.destroy()}destroy(){this.setScrollSpeed(0,0);let t=this.view.contentDOM.ownerDocument;t.removeEventListener("mousemove",this.move),t.removeEventListener("mouseup",this.up),this.view.inputState.mouseSelection=this.view.inputState.draggedContent=null}setScrollSpeed(t,e){this.scrollSpeed={x:t,y:e},t||e?this.scrolling<0&&(this.scrolling=setInterval(()=>this.scroll(),50)):this.scrolling>-1&&(clearInterval(this.scrolling),this.scrolling=-1)}scroll(){let{x:t,y:e}=this.scrollSpeed;t&&this.scrollParents.x&&(this.scrollParents.x.scrollLeft+=t,t=0),e&&this.scrollParents.y&&(this.scrollParents.y.scrollTop+=e,e=0),(t||e)&&this.view.win.scrollBy(t,e),this.dragging===!1&&this.select(this.lastEvent)}skipAtoms(t){let e=null;for(let i=0;i<t.ranges.length;i++){let n=t.ranges[i],r=null;if(n.empty){let o=Gm(this.atoms,n.from,0);o!=n.from&&(r=se.cursor(o,-1))}else{let o=Gm(this.atoms,n.from,-1),l=Gm(this.atoms,n.to,1);(o!=n.from||l!=n.to)&&(r=se.range(n.from==n.anchor?o:l,n.from==n.head?o:l))}r&&(e||(e=t.ranges.slice()),e[i]=r)}return e?se.create(e,t.mainIndex):t}select(t){let{view:e}=this,i=this.skipAtoms(this.style.get(t,this.extend,this.multiple));(this.mustSelect||!i.eq(e.state.selection,this.dragging===!1))&&this.view.dispatch({selection:i,userEvent:"select.pointer"}),this.mustSelect=!1}update(t){t.transactions.some(e=>e.isUserEvent("input.type"))?this.destroy():this.style.update(t)&&setTimeout(()=>this.select(this.lastEvent),20)}}function Pne(s,t){let e=s.state.facet(_3);return e.length?e[0](t):ke.mac?t.metaKey:t.ctrlKey}function Tne(s,t){let e=s.state.facet(k3);return e.length?e[0](t):ke.mac?!t.altKey:!t.ctrlKey}function Ene(s,t){let{main:e}=s.state.selection;if(e.empty)return!1;let i=Uh(s.root);if(!i||i.rangeCount==0)return!0;let n=i.getRangeAt(0).getClientRects();for(let r=0;r<n.length;r++){let o=n[r];if(o.left<=t.clientX&&o.right>=t.clientX&&o.top<=t.clientY&&o.bottom>=t.clientY)return!0}return!1}function Ane(s,t){if(!t.bubbles)return!0;if(t.defaultPrevented)return!1;for(let e=t.target,i;e!=s.contentDOM;e=e.parentNode)if(!e||e.nodeType==11||(i=vt.get(e))&&i.ignoreEvent(t))return!1;return!0}const Qs=Object.create(null),ws=Object.create(null),z3=ke.ie&&ke.ie_version<15||ke.ios&&ke.webkit_version<604;function Ine(s){let t=s.dom.parentNode;if(!t)return;let e=t.appendChild(document.createElement("textarea"));e.style.cssText="position: fixed; left: -10000px; top: 10px",e.focus(),setTimeout(()=>{s.focus(),e.remove(),W3(s,e.value)},50)}function Np(s,t,e){for(let i of s.facet(t))e=i(e,s);return e}function W3(s,t){t=Np(s.state,Uy,t);let{state:e}=s,i,n=1,r=e.toText(t),o=r.lines==e.selection.ranges.length;if(X1!=null&&e.selection.ranges.every(a=>a.empty)&&X1==r.toString()){let a=-1;i=e.changeByRange(c=>{let h=e.doc.lineAt(c.from);if(h.from==a)return{range:c};a=h.from;let f=e.toText((o?r.line(n++).text:t)+e.lineBreak);return{changes:{from:h.from,insert:f},range:se.cursor(c.from+f.length)}})}else o?i=e.changeByRange(a=>{let c=r.line(n++);return{changes:{from:a.from,to:a.to,insert:c.text},range:se.cursor(a.from+c.length)}}):i=e.replaceSelection(r);s.dispatch(i,{userEvent:"input.paste",scrollIntoView:!0})}ws.scroll=s=>{s.inputState.lastScrollTop=s.scrollDOM.scrollTop,s.inputState.lastScrollLeft=s.scrollDOM.scrollLeft};Qs.keydown=(s,t)=>(s.inputState.setSelectionOrigin("select"),t.keyCode==27&&s.inputState.tabFocusMode!=0&&(s.inputState.tabFocusMode=Date.now()+2e3),!1);ws.touchstart=(s,t)=>{s.inputState.lastTouchTime=Date.now(),s.inputState.setSelectionOrigin("select.pointer")};ws.touchmove=s=>{s.inputState.setSelectionOrigin("select.pointer")};Qs.mousedown=(s,t)=>{if(s.observer.flush(),s.inputState.lastTouchTime>Date.now()-2e3)return!1;let e=null;for(let i of s.state.facet(S3))if(e=i(s,t),e)break;if(!e&&t.button==0&&(e=Mne(s,t)),e){let i=!s.hasFocus;s.inputState.startMouseSelection(new Cne(s,t,e,i)),i&&s.observer.ignore(()=>{s3(s.contentDOM);let r=s.root.activeElement;r&&!r.contains(s.contentDOM)&&r.blur()});let n=s.inputState.mouseSelection;if(n)return n.start(t),n.dragging===!1}return!1};function qP(s,t,e,i){if(i==1)return se.cursor(t,e);if(i==2)return lne(s.state,t,e);{let n=si.find(s.docView,t),r=s.state.doc.lineAt(n?n.posAtEnd:t),o=n?n.posAtStart:r.from,l=n?n.posAtEnd:r.to;return l<s.state.doc.length&&l==r.to&&l++,se.range(o,l)}}let jP=(s,t,e)=>t>=e.top&&t<=e.bottom&&s>=e.left&&s<=e.right;function Rne(s,t,e,i){let n=si.find(s.docView,t);if(!n)return 1;let r=t-n.posAtStart;if(r==0)return 1;if(r==n.length)return-1;let o=n.coordsAt(r,-1);if(o&&jP(e,i,o))return-1;let l=n.coordsAt(r,1);return l&&jP(e,i,l)?1:o&&o.bottom>=i?-1:1}function XP(s,t){let e=s.posAtCoords({x:t.clientX,y:t.clientY},!1);return{pos:e,bias:Rne(s,e,t.clientX,t.clientY)}}const Vne=ke.ie&&ke.ie_version<=11;let GP=null,YP=0,KP=0;function U3(s){if(!Vne)return s.detail;let t=GP,e=KP;return GP=s,KP=Date.now(),YP=!t||e>Date.now()-400&&Math.abs(t.clientX-s.clientX)<2&&Math.abs(t.clientY-s.clientY)<2?(YP+1)%3:1}function Mne(s,t){let e=XP(s,t),i=U3(t),n=s.state.selection;return{update(r){r.docChanged&&(e.pos=r.changes.mapPos(e.pos),n=n.map(r.changes))},get(r,o,l){let a=XP(s,r),c,h=qP(s,a.pos,a.bias,i);if(e.pos!=a.pos&&!o){let f=qP(s,e.pos,e.bias,i),m=Math.min(f.from,h.from),w=Math.max(f.to,h.to);h=m<h.from?se.range(m,w):se.range(w,m)}return o?n.replaceRange(n.main.extend(h.from,h.to)):l&&i==1&&n.ranges.length>1&&(c=Lne(n,a.pos))?c:l?n.addRange(h):se.create([h])}}}function Lne(s,t){for(let e=0;e<s.ranges.length;e++){let{from:i,to:n}=s.ranges[e];if(i<=t&&n>=t)return se.create(s.ranges.slice(0,e).concat(s.ranges.slice(e+1)),s.mainIndex==e?0:s.mainIndex-(s.mainIndex>e?1:0))}return null}Qs.dragstart=(s,t)=>{let{selection:{main:e}}=s.state;if(t.target.draggable){let n=s.docView.nearest(t.target);if(n&&n.isWidget){let r=n.posAtStart,o=r+n.length;(r>=e.to||o<=e.from)&&(e=se.range(r,o))}}let{inputState:i}=s;return i.mouseSelection&&(i.mouseSelection.dragging=!0),i.draggedContent=e,t.dataTransfer&&(t.dataTransfer.setData("Text",Np(s.state,Zy,s.state.sliceDoc(e.from,e.to))),t.dataTransfer.effectAllowed="copyMove"),!1};Qs.dragend=s=>(s.inputState.draggedContent=null,!1);function JP(s,t,e,i){if(e=Np(s.state,Uy,e),!e)return;let n=s.posAtCoords({x:t.clientX,y:t.clientY},!1),{draggedContent:r}=s.inputState,o=i&&r&&Tne(s,t)?{from:r.from,to:r.to}:null,l={from:n,insert:e},a=s.state.changes(o?[o,l]:l);s.focus(),s.dispatch({changes:a,selection:{anchor:a.mapPos(n,-1),head:a.mapPos(n,1)},userEvent:o?"move.drop":"input.drop"}),s.inputState.draggedContent=null}Qs.drop=(s,t)=>{if(!t.dataTransfer)return!1;if(s.state.readOnly)return!0;let e=t.dataTransfer.files;if(e&&e.length){let i=Array(e.length),n=0,r=()=>{++n==e.length&&JP(s,t,i.filter(o=>o!=null).join(s.state.lineBreak),!1)};for(let o=0;o<e.length;o++){let l=new FileReader;l.onerror=r,l.onload=()=>{/[\x00-\x08\x0e-\x1f]{2}/.test(l.result)||(i[o]=l.result),r()},l.readAsText(e[o])}return!0}else{let i=t.dataTransfer.getData("Text");if(i)return JP(s,t,i,!0),!0}return!1};Qs.paste=(s,t)=>{if(s.state.readOnly)return!0;s.observer.flush();let e=z3?null:t.clipboardData;return e?(W3(s,e.getData("text/plain")||e.getData("text/uri-list")),!0):(Ine(s),!1)};function Bne(s,t){let e=s.dom.parentNode;if(!e)return;let i=e.appendChild(document.createElement("textarea"));i.style.cssText="position: fixed; left: -10000px; top: 10px",i.value=t,i.focus(),i.selectionEnd=t.length,i.selectionStart=0,setTimeout(()=>{i.remove(),s.focus()},50)}function $ne(s){let t=[],e=[],i=!1;for(let n of s.selection.ranges)n.empty||(t.push(s.sliceDoc(n.from,n.to)),e.push(n));if(!t.length){let n=-1;for(let{from:r}of s.selection.ranges){let o=s.doc.lineAt(r);o.number>n&&(t.push(o.text),e.push({from:o.from,to:Math.min(s.doc.length,o.to+1)})),n=o.number}i=!0}return{text:Np(s,Zy,t.join(s.lineBreak)),ranges:e,linewise:i}}let X1=null;Qs.copy=Qs.cut=(s,t)=>{let{text:e,ranges:i,linewise:n}=$ne(s.state);if(!e&&!n)return!1;X1=n?e:null,t.type=="cut"&&!s.state.readOnly&&s.dispatch({changes:i,scrollIntoView:!0,userEvent:"delete.cut"});let r=z3?null:t.clipboardData;return r?(r.clearData(),r.setData("text/plain",e),!0):(Bne(s,e),!1)};const Z3=Zr.define();function H3(s,t){let e=[];for(let i of s.facet(T3)){let n=i(s,t);n&&e.push(n)}return e.length?s.update({effects:e,annotations:Z3.of(!0)}):null}function q3(s){setTimeout(()=>{let t=s.hasFocus;if(t!=s.inputState.notifiedFocused){let e=H3(s.state,t);e?s.dispatch(e):s.update([])}},10)}ws.focus=s=>{s.inputState.lastFocusTime=Date.now(),!s.scrollDOM.scrollTop&&(s.inputState.lastScrollTop||s.inputState.lastScrollLeft)&&(s.scrollDOM.scrollTop=s.inputState.lastScrollTop,s.scrollDOM.scrollLeft=s.inputState.lastScrollLeft),q3(s)};ws.blur=s=>{s.observer.clearSelectionRange(),q3(s)};ws.compositionstart=ws.compositionupdate=s=>{s.observer.editContext||(s.inputState.compositionFirstChange==null&&(s.inputState.compositionFirstChange=!0),s.inputState.composing<0&&(s.inputState.composing=0))};ws.compositionend=s=>{s.observer.editContext||(s.inputState.composing=-1,s.inputState.compositionEndedAt=Date.now(),s.inputState.compositionPendingKey=!0,s.inputState.compositionPendingChange=s.observer.pendingRecords().length>0,s.inputState.compositionFirstChange=null,ke.chrome&&ke.android?s.observer.flushSoon():s.inputState.compositionPendingChange?Promise.resolve().then(()=>s.observer.flush()):setTimeout(()=>{s.inputState.composing<0&&s.docView.hasComposition&&s.update([])},50))};ws.contextmenu=s=>{s.inputState.lastContextMenu=Date.now()};Qs.beforeinput=(s,t)=>{var e,i;if(t.inputType=="insertReplacementText"&&s.observer.editContext){let r=(e=t.dataTransfer)===null||e===void 0?void 0:e.getData("text/plain"),o=t.getTargetRanges();if(r&&o.length){let l=o[0],a=s.posAtDOM(l.startContainer,l.startOffset),c=s.posAtDOM(l.endContainer,l.endOffset);return Xy(s,{from:a,to:c,insert:s.state.toText(r)},null),!0}}let n;if(ke.chrome&&ke.android&&(n=N3.find(r=>r.inputType==t.inputType))&&(s.observer.delayAndroidKey(n.key,n.keyCode),n.key=="Backspace"||n.key=="Delete")){let r=((i=window.visualViewport)===null||i===void 0?void 0:i.height)||0;setTimeout(()=>{var o;(((o=window.visualViewport)===null||o===void 0?void 0:o.height)||0)>r+10&&s.hasFocus&&(s.contentDOM.blur(),s.focus())},100)}return ke.ios&&t.inputType=="deleteContentForward"&&s.observer.flushSoon(),ke.safari&&t.inputType=="insertText"&&s.inputState.composing>=0&&setTimeout(()=>ws.compositionend(s,t),20),!1};const eT=new Set;function Dne(s){eT.has(s)||(eT.add(s),s.addEventListener("copy",()=>{}),s.addEventListener("cut",()=>{}))}const tT=["pre-wrap","normal","pre-line","break-spaces"];let vc=!1;function iT(){vc=!1}class Qne{constructor(t){this.lineWrapping=t,this.doc=Ke.empty,this.heightSamples={},this.lineHeight=14,this.charWidth=7,this.textHeight=14,this.lineLength=30}heightForGap(t,e){let i=this.doc.lineAt(e).number-this.doc.lineAt(t).number+1;return this.lineWrapping&&(i+=Math.max(0,Math.ceil((e-t-i*this.lineLength*.5)/this.lineLength))),this.lineHeight*i}heightForLine(t){return this.lineWrapping?(1+Math.max(0,Math.ceil((t-this.lineLength)/(this.lineLength-5))))*this.lineHeight:this.lineHeight}setDoc(t){return this.doc=t,this}mustRefreshForWrapping(t){return tT.indexOf(t)>-1!=this.lineWrapping}mustRefreshForHeights(t){let e=!1;for(let i=0;i<t.length;i++){let n=t[i];n<0?i++:this.heightSamples[Math.floor(n*10)]||(e=!0,this.heightSamples[Math.floor(n*10)]=!0)}return e}refresh(t,e,i,n,r,o){let l=tT.indexOf(t)>-1,a=Math.round(e)!=Math.round(this.lineHeight)||this.lineWrapping!=l;if(this.lineWrapping=l,this.lineHeight=e,this.charWidth=i,this.textHeight=n,this.lineLength=r,a){this.heightSamples={};for(let c=0;c<o.length;c++){let h=o[c];h<0?c++:this.heightSamples[Math.floor(h*10)]=!0}}return a}}class Nne{constructor(t,e){this.from=t,this.heights=e,this.index=0}get more(){return this.index<this.heights.length}}class tr{constructor(t,e,i,n,r){this.from=t,this.length=e,this.top=i,this.height=n,this._content=r}get type(){return typeof this._content=="number"?sn.Text:Array.isArray(this._content)?this._content:this._content.type}get to(){return this.from+this.length}get bottom(){return this.top+this.height}get widget(){return this._content instanceof $o?this._content.widget:null}get widgetLineBreaks(){return typeof this._content=="number"?this._content:0}join(t){let e=(Array.isArray(this._content)?this._content:[this]).concat(Array.isArray(t._content)?t._content:[t]);return new tr(this.from,this.length+t.length,this.top,this.height+t.height,e)}}var Et=function(s){return s[s.ByPos=0]="ByPos",s[s.ByHeight=1]="ByHeight",s[s.ByPosNoHeight=2]="ByPosNoHeight",s}(Et||(Et={}));const Ym=.001;class rn{constructor(t,e,i=2){this.length=t,this.height=e,this.flags=i}get outdated(){return(this.flags&2)>0}set outdated(t){this.flags=(t?2:0)|this.flags&-3}setHeight(t){this.height!=t&&(Math.abs(this.height-t)>Ym&&(vc=!0),this.height=t)}replace(t,e,i){return rn.of(i)}decomposeLeft(t,e){e.push(this)}decomposeRight(t,e){e.push(this)}applyChanges(t,e,i,n){let r=this,o=i.doc;for(let l=n.length-1;l>=0;l--){let{fromA:a,toA:c,fromB:h,toB:f}=n[l],m=r.lineAt(a,Et.ByPosNoHeight,i.setDoc(e),0,0),w=m.to>=c?m:r.lineAt(c,Et.ByPosNoHeight,i,0,0);for(f+=w.to-c,c=w.to;l>0&&m.from<=n[l-1].toA;)a=n[l-1].fromA,h=n[l-1].fromB,l--,a<m.from&&(m=r.lineAt(a,Et.ByPosNoHeight,i,0,0));h+=m.from-a,a=m.from;let O=Gy.build(i.setDoc(o),t,h,f);r=jg(r,r.replace(a,c,O))}return r.updateHeight(i,0)}static empty(){return new Bn(0,0)}static of(t){if(t.length==1)return t[0];let e=0,i=t.length,n=0,r=0;for(;;)if(e==i)if(n>r*2){let l=t[e-1];l.break?t.splice(--e,1,l.left,null,l.right):t.splice(--e,1,l.left,l.right),i+=1+l.break,n-=l.size}else if(r>n*2){let l=t[i];l.break?t.splice(i,1,l.left,null,l.right):t.splice(i,1,l.left,l.right),i+=2+l.break,r-=l.size}else break;else if(n<r){let l=t[e++];l&&(n+=l.size)}else{let l=t[--i];l&&(r+=l.size)}let o=0;return t[e-1]==null?(o=1,e--):t[e]==null&&(o=1,i++),new Fne(rn.of(t.slice(0,e)),o,rn.of(t.slice(i)))}}function jg(s,t){return s==t?s:(s.constructor!=t.constructor&&(vc=!0),t)}rn.prototype.size=1;class j3 extends rn{constructor(t,e,i){super(t,e),this.deco=i}blockAt(t,e,i,n){return new tr(n,this.length,i,this.height,this.deco||0)}lineAt(t,e,i,n,r){return this.blockAt(0,i,n,r)}forEachLine(t,e,i,n,r,o){t<=r+this.length&&e>=r&&o(this.blockAt(0,i,n,r))}updateHeight(t,e=0,i=!1,n){return n&&n.from<=e&&n.more&&this.setHeight(n.heights[n.index++]),this.outdated=!1,this}toString(){return`block(${this.length})`}}class Bn extends j3{constructor(t,e){super(t,e,null),this.collapsed=0,this.widgetHeight=0,this.breaks=0}blockAt(t,e,i,n){return new tr(n,this.length,i,this.height,this.breaks)}replace(t,e,i){let n=i[0];return i.length==1&&(n instanceof Bn||n instanceof Ti&&n.flags&4)&&Math.abs(this.length-n.length)<10?(n instanceof Ti?n=new Bn(n.length,this.height):n.height=this.height,this.outdated||(n.outdated=!1),n):rn.of(i)}updateHeight(t,e=0,i=!1,n){return n&&n.from<=e&&n.more?this.setHeight(n.heights[n.index++]):(i||this.outdated)&&this.setHeight(Math.max(this.widgetHeight,t.heightForLine(this.length-this.collapsed))+this.breaks*t.lineHeight),this.outdated=!1,this}toString(){return`line(${this.length}${this.collapsed?-this.collapsed:""}${this.widgetHeight?":"+this.widgetHeight:""})`}}class Ti extends rn{constructor(t){super(t,0)}heightMetrics(t,e){let i=t.doc.lineAt(e).number,n=t.doc.lineAt(e+this.length).number,r=n-i+1,o,l=0;if(t.lineWrapping){let a=Math.min(this.height,t.lineHeight*r);o=a/r,this.length>r+1&&(l=(this.height-a)/(this.length-r-1))}else o=this.height/r;return{firstLine:i,lastLine:n,perLine:o,perChar:l}}blockAt(t,e,i,n){let{firstLine:r,lastLine:o,perLine:l,perChar:a}=this.heightMetrics(e,n);if(e.lineWrapping){let c=n+(t<e.lineHeight?0:Math.round(Math.max(0,Math.min(1,(t-i)/this.height))*this.length)),h=e.doc.lineAt(c),f=l+h.length*a,m=Math.max(i,t-f/2);return new tr(h.from,h.length,m,f,0)}else{let c=Math.max(0,Math.min(o-r,Math.floor((t-i)/l))),{from:h,length:f}=e.doc.line(r+c);return new tr(h,f,i+l*c,l,0)}}lineAt(t,e,i,n,r){if(e==Et.ByHeight)return this.blockAt(t,i,n,r);if(e==Et.ByPosNoHeight){let{from:w,to:O}=i.doc.lineAt(t);return new tr(w,O-w,0,0,0)}let{firstLine:o,perLine:l,perChar:a}=this.heightMetrics(i,r),c=i.doc.lineAt(t),h=l+c.length*a,f=c.number-o,m=n+l*f+a*(c.from-r-f);return new tr(c.from,c.length,Math.max(n,Math.min(m,n+this.height-h)),h,0)}forEachLine(t,e,i,n,r,o){t=Math.max(t,r),e=Math.min(e,r+this.length);let{firstLine:l,perLine:a,perChar:c}=this.heightMetrics(i,r);for(let h=t,f=n;h<=e;){let m=i.doc.lineAt(h);if(h==t){let O=m.number-l;f+=a*O+c*(t-r-O)}let w=a+c*m.length;o(new tr(m.from,m.length,f,w,0)),f+=w,h=m.to+1}}replace(t,e,i){let n=this.length-e;if(n>0){let r=i[i.length-1];r instanceof Ti?i[i.length-1]=new Ti(r.length+n):i.push(null,new Ti(n-1))}if(t>0){let r=i[0];r instanceof Ti?i[0]=new Ti(t+r.length):i.unshift(new Ti(t-1),null)}return rn.of(i)}decomposeLeft(t,e){e.push(new Ti(t-1),null)}decomposeRight(t,e){e.push(null,new Ti(this.length-t-1))}updateHeight(t,e=0,i=!1,n){let r=e+this.length;if(n&&n.from<=e+this.length&&n.more){let o=[],l=Math.max(e,n.from),a=-1;for(n.from>e&&o.push(new Ti(n.from-e-1).updateHeight(t,e));l<=r&&n.more;){let h=t.doc.lineAt(l).length;o.length&&o.push(null);let f=n.heights[n.index++];a==-1?a=f:Math.abs(f-a)>=Ym&&(a=-2);let m=new Bn(h,f);m.outdated=!1,o.push(m),l+=h+1}l<=r&&o.push(null,new Ti(r-l).updateHeight(t,l));let c=rn.of(o);return(a<0||Math.abs(c.height-this.height)>=Ym||Math.abs(a-this.heightMetrics(t,e).perLine)>=Ym)&&(vc=!0),jg(this,c)}else(i||this.outdated)&&(this.setHeight(t.heightForGap(e,e+this.length)),this.outdated=!1);return this}toString(){return`gap(${this.length})`}}class Fne extends rn{constructor(t,e,i){super(t.length+e+i.length,t.height+i.height,e|(t.outdated||i.outdated?2:0)),this.left=t,this.right=i,this.size=t.size+i.size}get break(){return this.flags&1}blockAt(t,e,i,n){let r=i+this.left.height;return t<r?this.left.blockAt(t,e,i,n):this.right.blockAt(t,e,r,n+this.left.length+this.break)}lineAt(t,e,i,n,r){let o=n+this.left.height,l=r+this.left.length+this.break,a=e==Et.ByHeight?t<o:t<l,c=a?this.left.lineAt(t,e,i,n,r):this.right.lineAt(t,e,i,o,l);if(this.break||(a?c.to<l:c.from>l))return c;let h=e==Et.ByPosNoHeight?Et.ByPosNoHeight:Et.ByPos;return a?c.join(this.right.lineAt(l,h,i,o,l)):this.left.lineAt(l,h,i,n,r).join(c)}forEachLine(t,e,i,n,r,o){let l=n+this.left.height,a=r+this.left.length+this.break;if(this.break)t<a&&this.left.forEachLine(t,e,i,n,r,o),e>=a&&this.right.forEachLine(t,e,i,l,a,o);else{let c=this.lineAt(a,Et.ByPos,i,n,r);t<c.from&&this.left.forEachLine(t,c.from-1,i,n,r,o),c.to>=t&&c.from<=e&&o(c),e>c.to&&this.right.forEachLine(c.to+1,e,i,l,a,o)}}replace(t,e,i){let n=this.left.length+this.break;if(e<n)return this.balanced(this.left.replace(t,e,i),this.right);if(t>this.left.length)return this.balanced(this.left,this.right.replace(t-n,e-n,i));let r=[];t>0&&this.decomposeLeft(t,r);let o=r.length;for(let l of i)r.push(l);if(t>0&&nT(r,o-1),e<this.length){let l=r.length;this.decomposeRight(e,r),nT(r,l)}return rn.of(r)}decomposeLeft(t,e){let i=this.left.length;if(t<=i)return this.left.decomposeLeft(t,e);e.push(this.left),this.break&&(i++,t>=i&&e.push(null)),t>i&&this.right.decomposeLeft(t-i,e)}decomposeRight(t,e){let i=this.left.length,n=i+this.break;if(t>=n)return this.right.decomposeRight(t-n,e);t<i&&this.left.decomposeRight(t,e),this.break&&t<n&&e.push(null),e.push(this.right)}balanced(t,e){return t.size>2*e.size||e.size>2*t.size?rn.of(this.break?[t,null,e]:[t,e]):(this.left=jg(this.left,t),this.right=jg(this.right,e),this.setHeight(t.height+e.height),this.outdated=t.outdated||e.outdated,this.size=t.size+e.size,this.length=t.length+this.break+e.length,this)}updateHeight(t,e=0,i=!1,n){let{left:r,right:o}=this,l=e+r.length+this.break,a=null;return n&&n.from<=e+r.length&&n.more?a=r=r.updateHeight(t,e,i,n):r.updateHeight(t,e,i),n&&n.from<=l+o.length&&n.more?a=o=o.updateHeight(t,l,i,n):o.updateHeight(t,l,i),a?this.balanced(r,o):(this.height=this.left.height+this.right.height,this.outdated=!1,this)}toString(){return this.left+(this.break?" ":"-")+this.right}}function nT(s,t){let e,i;s[t]==null&&(e=s[t-1])instanceof Ti&&(i=s[t+1])instanceof Ti&&s.splice(t-1,3,new Ti(e.length+1+i.length))}const zne=5;class Gy{constructor(t,e){this.pos=t,this.oracle=e,this.nodes=[],this.lineStart=-1,this.lineEnd=-1,this.covering=null,this.writtenTo=t}get isCovered(){return this.covering&&this.nodes[this.nodes.length-1]==this.covering}span(t,e){if(this.lineStart>-1){let i=Math.min(e,this.lineEnd),n=this.nodes[this.nodes.length-1];n instanceof Bn?n.length+=i-this.pos:(i>this.pos||!this.isCovered)&&this.nodes.push(new Bn(i-this.pos,-1)),this.writtenTo=i,e>i&&(this.nodes.push(null),this.writtenTo++,this.lineStart=-1)}this.pos=e}point(t,e,i){if(t<e||i.heightRelevant){let n=i.widget?i.widget.estimatedHeight:0,r=i.widget?i.widget.lineBreaks:0;n<0&&(n=this.oracle.lineHeight);let o=e-t;i.block?this.addBlock(new j3(o,n,i)):(o||r||n>=zne)&&this.addLineDeco(n,r,o)}else e>t&&this.span(t,e);this.lineEnd>-1&&this.lineEnd<this.pos&&(this.lineEnd=this.oracle.doc.lineAt(this.pos).to)}enterLine(){if(this.lineStart>-1)return;let{from:t,to:e}=this.oracle.doc.lineAt(this.pos);this.lineStart=t,this.lineEnd=e,this.writtenTo<t&&((this.writtenTo<t-1||this.nodes[this.nodes.length-1]==null)&&this.nodes.push(this.blankContent(this.writtenTo,t-1)),this.nodes.push(null)),this.pos>t&&this.nodes.push(new Bn(this.pos-t,-1)),this.writtenTo=this.pos}blankContent(t,e){let i=new Ti(e-t);return this.oracle.doc.lineAt(t).to==e&&(i.flags|=4),i}ensureLine(){this.enterLine();let t=this.nodes.length?this.nodes[this.nodes.length-1]:null;if(t instanceof Bn)return t;let e=new Bn(0,-1);return this.nodes.push(e),e}addBlock(t){this.enterLine();let e=t.deco;e&&e.startSide>0&&!this.isCovered&&this.ensureLine(),this.nodes.push(t),this.writtenTo=this.pos=this.pos+t.length,e&&e.endSide>0&&(this.covering=t)}addLineDeco(t,e,i){let n=this.ensureLine();n.length+=i,n.collapsed+=i,n.widgetHeight=Math.max(n.widgetHeight,t),n.breaks+=e,this.writtenTo=this.pos=this.pos+i}finish(t){let e=this.nodes.length==0?null:this.nodes[this.nodes.length-1];this.lineStart>-1&&!(e instanceof Bn)&&!this.isCovered?this.nodes.push(new Bn(0,-1)):(this.writtenTo<this.pos||e==null)&&this.nodes.push(this.blankContent(this.writtenTo,this.pos));let i=t;for(let n of this.nodes)n instanceof Bn&&n.updateHeight(this.oracle,i),i+=n?n.length:1;return this.nodes}static build(t,e,i,n){let r=new Gy(i,t);return st.spans(e,i,n,r,0),r.finish(i)}}function Wne(s,t,e){let i=new Une;return st.compare(s,t,e,i,0),i.changes}class Une{constructor(){this.changes=[]}compareRange(){}comparePoint(t,e,i,n){(t<e||i&&i.heightRelevant||n&&n.heightRelevant)&&Xm(t,e,this.changes,5)}}function Zne(s,t){let e=s.getBoundingClientRect(),i=s.ownerDocument,n=i.defaultView||window,r=Math.max(0,e.left),o=Math.min(n.innerWidth,e.right),l=Math.max(0,e.top),a=Math.min(n.innerHeight,e.bottom);for(let c=s.parentNode;c&&c!=i.body;)if(c.nodeType==1){let h=c,f=window.getComputedStyle(h);if((h.scrollHeight>h.clientHeight||h.scrollWidth>h.clientWidth)&&f.overflow!="visible"){let m=h.getBoundingClientRect();r=Math.max(r,m.left),o=Math.min(o,m.right),l=Math.max(l,m.top),a=Math.min(c==s.parentNode?n.innerHeight:a,m.bottom)}c=f.position=="absolute"||f.position=="fixed"?h.offsetParent:h.parentNode}else if(c.nodeType==11)c=c.host;else break;return{left:r-e.left,right:Math.max(r,o)-e.left,top:l-(e.top+t),bottom:Math.max(l,a)-(e.top+t)}}function Hne(s){let t=s.getBoundingClientRect(),e=s.ownerDocument.defaultView||window;return t.left<e.innerWidth&&t.right>0&&t.top<e.innerHeight&&t.bottom>0}function qne(s,t){let e=s.getBoundingClientRect();return{left:0,right:e.right-e.left,top:t,bottom:e.bottom-(e.top+t)}}class Zx{constructor(t,e,i,n){this.from=t,this.to=e,this.size=i,this.displaySize=n}static same(t,e){if(t.length!=e.length)return!1;for(let i=0;i<t.length;i++){let n=t[i],r=e[i];if(n.from!=r.from||n.to!=r.to||n.size!=r.size)return!1}return!0}draw(t,e){return Je.replace({widget:new jne(this.displaySize*(e?t.scaleY:t.scaleX),e)}).range(this.from,this.to)}}class jne extends Wo{constructor(t,e){super(),this.size=t,this.vertical=e}eq(t){return t.size==this.size&&t.vertical==this.vertical}toDOM(){let t=document.createElement("div");return this.vertical?t.style.height=this.size+"px":(t.style.width=this.size+"px",t.style.height="2px",t.style.display="inline-block"),t}get estimatedHeight(){return this.vertical?this.size:-1}}class sT{constructor(t){this.state=t,this.pixelViewport={left:0,right:window.innerWidth,top:0,bottom:0},this.inView=!0,this.paddingTop=0,this.paddingBottom=0,this.contentDOMWidth=0,this.contentDOMHeight=0,this.editorHeight=0,this.editorWidth=0,this.scrollTop=0,this.scrolledToBottom=!1,this.scaleX=1,this.scaleY=1,this.scrollAnchorPos=0,this.scrollAnchorHeight=-1,this.scaler=rT,this.scrollTarget=null,this.printing=!1,this.mustMeasureContent=!0,this.defaultTextDirection=Bt.LTR,this.visibleRanges=[],this.mustEnforceCursorAssoc=!1;let e=t.facet(Hy).some(i=>typeof i!="function"&&i.class=="cm-lineWrapping");this.heightOracle=new Qne(e),this.stateDeco=t.facet(Hh).filter(i=>typeof i!="function"),this.heightMap=rn.empty().applyChanges(this.stateDeco,Ke.empty,this.heightOracle.setDoc(t.doc),[new hs(0,0,0,t.doc.length)]);for(let i=0;i<2&&(this.viewport=this.getViewport(0,null),!!this.updateForViewport());i++);this.updateViewportLines(),this.lineGaps=this.ensureLineGaps([]),this.lineGapDeco=Je.set(this.lineGaps.map(i=>i.draw(this,!1))),this.computeVisibleRanges()}updateForViewport(){let t=[this.viewport],{main:e}=this.state.selection;for(let i=0;i<=1;i++){let n=i?e.head:e.anchor;if(!t.some(({from:r,to:o})=>n>=r&&n<=o)){let{from:r,to:o}=this.lineBlockAt(n);t.push(new pm(r,o))}}return this.viewports=t.sort((i,n)=>i.from-n.from),this.updateScaler()}updateScaler(){let t=this.scaler;return this.scaler=this.heightMap.height<=7e6?rT:new Yy(this.heightOracle,this.heightMap,this.viewports),t.eq(this.scaler)?0:2}updateViewportLines(){this.viewportLines=[],this.heightMap.forEachLine(this.viewport.from,this.viewport.to,this.heightOracle.setDoc(this.state.doc),0,0,t=>{this.viewportLines.push(ih(t,this.scaler))})}update(t,e=null){this.state=t.state;let i=this.stateDeco;this.stateDeco=this.state.facet(Hh).filter(h=>typeof h!="function");let n=t.changedRanges,r=hs.extendWithRanges(n,Wne(i,this.stateDeco,t?t.changes:ci.empty(this.state.doc.length))),o=this.heightMap.height,l=this.scrolledToBottom?null:this.scrollAnchorAt(this.scrollTop);iT(),this.heightMap=this.heightMap.applyChanges(this.stateDeco,t.startState.doc,this.heightOracle.setDoc(this.state.doc),r),(this.heightMap.height!=o||vc)&&(t.flags|=2),l?(this.scrollAnchorPos=t.changes.mapPos(l.from,-1),this.scrollAnchorHeight=l.top):(this.scrollAnchorPos=-1,this.scrollAnchorHeight=o);let a=r.length?this.mapViewport(this.viewport,t.changes):this.viewport;(e&&(e.range.head<a.from||e.range.head>a.to)||!this.viewportIsAppropriate(a))&&(a=this.getViewport(0,e));let c=a.from!=this.viewport.from||a.to!=this.viewport.to;this.viewport=a,t.flags|=this.updateForViewport(),(c||!t.changes.empty||t.flags&2)&&this.updateViewportLines(),(this.lineGaps.length||this.viewport.to-this.viewport.from>4e3)&&this.updateLineGaps(this.ensureLineGaps(this.mapLineGaps(this.lineGaps,t.changes))),t.flags|=this.computeVisibleRanges(t.changes),e&&(this.scrollTarget=e),!this.mustEnforceCursorAssoc&&t.selectionSet&&t.view.lineWrapping&&t.state.selection.main.empty&&t.state.selection.main.assoc&&!t.state.facet(A3)&&(this.mustEnforceCursorAssoc=!0)}measure(t){let e=t.contentDOM,i=window.getComputedStyle(e),n=this.heightOracle,r=i.whiteSpace;this.defaultTextDirection=i.direction=="rtl"?Bt.RTL:Bt.LTR;let o=this.heightOracle.mustRefreshForWrapping(r),l=e.getBoundingClientRect(),a=o||this.mustMeasureContent||this.contentDOMHeight!=l.height;this.contentDOMHeight=l.height,this.mustMeasureContent=!1;let c=0,h=0;if(l.width&&l.height){let{scaleX:Q,scaleY:N}=n3(e,l);(Q>.005&&Math.abs(this.scaleX-Q)>.005||N>.005&&Math.abs(this.scaleY-N)>.005)&&(this.scaleX=Q,this.scaleY=N,c|=16,o=a=!0)}let f=(parseInt(i.paddingTop)||0)*this.scaleY,m=(parseInt(i.paddingBottom)||0)*this.scaleY;(this.paddingTop!=f||this.paddingBottom!=m)&&(this.paddingTop=f,this.paddingBottom=m,c|=18),this.editorWidth!=t.scrollDOM.clientWidth&&(n.lineWrapping&&(a=!0),this.editorWidth=t.scrollDOM.clientWidth,c|=16);let w=t.scrollDOM.scrollTop*this.scaleY;this.scrollTop!=w&&(this.scrollAnchorHeight=-1,this.scrollTop=w),this.scrolledToBottom=o3(t.scrollDOM);let O=(this.printing?qne:Zne)(e,this.paddingTop),_=O.top-this.pixelViewport.top,k=O.bottom-this.pixelViewport.bottom;this.pixelViewport=O;let C=this.pixelViewport.bottom>this.pixelViewport.top&&this.pixelViewport.right>this.pixelViewport.left;if(C!=this.inView&&(this.inView=C,C&&(a=!0)),!this.inView&&!this.scrollTarget&&!Hne(t.dom))return 0;let P=l.width;if((this.contentDOMWidth!=P||this.editorHeight!=t.scrollDOM.clientHeight)&&(this.contentDOMWidth=l.width,this.editorHeight=t.scrollDOM.clientHeight,c|=16),a){let Q=t.docView.measureVisibleLineHeights(this.viewport);if(n.mustRefreshForHeights(Q)&&(o=!0),o||n.lineWrapping&&Math.abs(P-this.contentDOMWidth)>n.charWidth){let{lineHeight:N,charWidth:G,textHeight:D}=t.docView.measureTextSize();o=N>0&&n.refresh(r,N,G,D,P/G,Q),o&&(t.docView.minWidth=0,c|=16)}_>0&&k>0?h=Math.max(_,k):_<0&&k<0&&(h=Math.min(_,k)),iT();for(let N of this.viewports){let G=N.from==this.viewport.from?Q:t.docView.measureVisibleLineHeights(N);this.heightMap=(o?rn.empty().applyChanges(this.stateDeco,Ke.empty,this.heightOracle,[new hs(0,0,0,t.state.doc.length)]):this.heightMap).updateHeight(n,0,o,new Nne(N.from,G))}vc&&(c|=2)}let M=!this.viewportIsAppropriate(this.viewport,h)||this.scrollTarget&&(this.scrollTarget.range.head<this.viewport.from||this.scrollTarget.range.head>this.viewport.to);return M&&(c&2&&(c|=this.updateScaler()),this.viewport=this.getViewport(h,this.scrollTarget),c|=this.updateForViewport()),(c&2||M)&&this.updateViewportLines(),(this.lineGaps.length||this.viewport.to-this.viewport.from>4e3)&&this.updateLineGaps(this.ensureLineGaps(o?[]:this.lineGaps,t)),c|=this.computeVisibleRanges(),this.mustEnforceCursorAssoc&&(this.mustEnforceCursorAssoc=!1,t.docView.enforceCursorAssoc()),c}get visibleTop(){return this.scaler.fromDOM(this.pixelViewport.top)}get visibleBottom(){return this.scaler.fromDOM(this.pixelViewport.bottom)}getViewport(t,e){let i=.5-Math.max(-.5,Math.min(.5,t/1e3/2)),n=this.heightMap,r=this.heightOracle,{visibleTop:o,visibleBottom:l}=this,a=new pm(n.lineAt(o-i*1e3,Et.ByHeight,r,0,0).from,n.lineAt(l+(1-i)*1e3,Et.ByHeight,r,0,0).to);if(e){let{head:c}=e.range;if(c<a.from||c>a.to){let h=Math.min(this.editorHeight,this.pixelViewport.bottom-this.pixelViewport.top),f=n.lineAt(c,Et.ByPos,r,0,0),m;e.y=="center"?m=(f.top+f.bottom)/2-h/2:e.y=="start"||e.y=="nearest"&&c<a.from?m=f.top:m=f.bottom-h,a=new pm(n.lineAt(m-1e3/2,Et.ByHeight,r,0,0).from,n.lineAt(m+h+1e3/2,Et.ByHeight,r,0,0).to)}}return a}mapViewport(t,e){let i=e.mapPos(t.from,-1),n=e.mapPos(t.to,1);return new pm(this.heightMap.lineAt(i,Et.ByPos,this.heightOracle,0,0).from,this.heightMap.lineAt(n,Et.ByPos,this.heightOracle,0,0).to)}viewportIsAppropriate({from:t,to:e},i=0){if(!this.inView)return!0;let{top:n}=this.heightMap.lineAt(t,Et.ByPos,this.heightOracle,0,0),{bottom:r}=this.heightMap.lineAt(e,Et.ByPos,this.heightOracle,0,0),{visibleTop:o,visibleBottom:l}=this;return(t==0||n<=o-Math.max(10,Math.min(-i,250)))&&(e==this.state.doc.length||r>=l+Math.max(10,Math.min(i,250)))&&n>o-2*1e3&&r<l+2*1e3}mapLineGaps(t,e){if(!t.length||e.empty)return t;let i=[];for(let n of t)e.touchesRange(n.from,n.to)||i.push(new Zx(e.mapPos(n.from),e.mapPos(n.to),n.size,n.displaySize));return i}ensureLineGaps(t,e){let i=this.heightOracle.lineWrapping,n=i?1e4:2e3,r=n>>1,o=n<<1;if(this.defaultTextDirection!=Bt.LTR&&!i)return[];let l=[],a=(h,f,m,w)=>{if(f-h<r)return;let O=this.state.selection.main,_=[O.from];O.empty||_.push(O.to);for(let C of _)if(C>h&&C<f){a(h,C-10,m,w),a(C+10,f,m,w);return}let k=Gne(t,C=>C.from>=m.from&&C.to<=m.to&&Math.abs(C.from-h)<r&&Math.abs(C.to-f)<r&&!_.some(P=>C.from<P&&C.to>P));if(!k){if(f<m.to&&e&&i&&e.visibleRanges.some(M=>M.from<=f&&M.to>=f)){let M=e.moveToLineBoundary(se.cursor(f),!1,!0).head;M>h&&(f=M)}let C=this.gapSize(m,h,f,w),P=i||C<2e6?C:2e6;k=new Zx(h,f,C,P)}l.push(k)},c=h=>{if(h.length<o||h.type!=sn.Text)return;let f=Xne(h.from,h.to,this.stateDeco);if(f.total<o)return;let m=this.scrollTarget?this.scrollTarget.range.head:null,w,O;if(i){let _=n/this.heightOracle.lineLength*this.heightOracle.lineHeight,k,C;if(m!=null){let P=xm(f,m),M=((this.visibleBottom-this.visibleTop)/2+_)/h.height;k=P-M,C=P+M}else k=(this.visibleTop-h.top-_)/h.height,C=(this.visibleBottom-h.top+_)/h.height;w=wm(f,k),O=wm(f,C)}else{let _=f.total*this.heightOracle.charWidth,k=n*this.heightOracle.charWidth,C=0;if(_>2e6)for(let G of t)G.from>=h.from&&G.from<h.to&&G.size!=G.displaySize&&G.from*this.heightOracle.charWidth+C<this.pixelViewport.left&&(C=G.size-G.displaySize);let P=this.pixelViewport.left+C,M=this.pixelViewport.right+C,Q,N;if(m!=null){let G=xm(f,m),D=((M-P)/2+k)/_;Q=G-D,N=G+D}else Q=(P-k)/_,N=(M+k)/_;w=wm(f,Q),O=wm(f,N)}w>h.from&&a(h.from,w,h,f),O<h.to&&a(O,h.to,h,f)};for(let h of this.viewportLines)Array.isArray(h.type)?h.type.forEach(c):c(h);return l}gapSize(t,e,i,n){let r=xm(n,i)-xm(n,e);return this.heightOracle.lineWrapping?t.height*r:n.total*this.heightOracle.charWidth*r}updateLineGaps(t){Zx.same(t,this.lineGaps)||(this.lineGaps=t,this.lineGapDeco=Je.set(t.map(e=>e.draw(this,this.heightOracle.lineWrapping))))}computeVisibleRanges(t){let e=this.stateDeco;this.lineGaps.length&&(e=e.concat(this.lineGapDeco));let i=[];st.spans(e,this.viewport.from,this.viewport.to,{span(r,o){i.push({from:r,to:o})},point(){}},20);let n=0;if(i.length!=this.visibleRanges.length)n=12;else for(let r=0;r<i.length&&!(n&8);r++){let o=this.visibleRanges[r],l=i[r];(o.from!=l.from||o.to!=l.to)&&(n|=4,t&&t.mapPos(o.from,-1)==l.from&&t.mapPos(o.to,1)==l.to||(n|=8))}return this.visibleRanges=i,n}lineBlockAt(t){return t>=this.viewport.from&&t<=this.viewport.to&&this.viewportLines.find(e=>e.from<=t&&e.to>=t)||ih(this.heightMap.lineAt(t,Et.ByPos,this.heightOracle,0,0),this.scaler)}lineBlockAtHeight(t){return t>=this.viewportLines[0].top&&t<=this.viewportLines[this.viewportLines.length-1].bottom&&this.viewportLines.find(e=>e.top<=t&&e.bottom>=t)||ih(this.heightMap.lineAt(this.scaler.fromDOM(t),Et.ByHeight,this.heightOracle,0,0),this.scaler)}scrollAnchorAt(t){let e=this.lineBlockAtHeight(t+8);return e.from>=this.viewport.from||this.viewportLines[0].top-t>200?e:this.viewportLines[0]}elementAtHeight(t){return ih(this.heightMap.blockAt(this.scaler.fromDOM(t),this.heightOracle,0,0),this.scaler)}get docHeight(){return this.scaler.toDOM(this.heightMap.height)}get contentHeight(){return this.docHeight+this.paddingTop+this.paddingBottom}}class pm{constructor(t,e){this.from=t,this.to=e}}function Xne(s,t,e){let i=[],n=s,r=0;return st.spans(e,s,t,{span(){},point(o,l){o>n&&(i.push({from:n,to:o}),r+=o-n),n=l}},20),n<t&&(i.push({from:n,to:t}),r+=t-n),{total:r,ranges:i}}function wm({total:s,ranges:t},e){if(e<=0)return t[0].from;if(e>=1)return t[t.length-1].to;let i=Math.floor(s*e);for(let n=0;;n++){let{from:r,to:o}=t[n],l=o-r;if(i<=l)return r+i;i-=l}}function xm(s,t){let e=0;for(let{from:i,to:n}of s.ranges){if(t<=n){e+=t-i;break}e+=n-i}return e/s.total}function Gne(s,t){for(let e of s)if(t(e))return e}const rT={toDOM(s){return s},fromDOM(s){return s},scale:1,eq(s){return s==this}};class Yy{constructor(t,e,i){let n=0,r=0,o=0;this.viewports=i.map(({from:l,to:a})=>{let c=e.lineAt(l,Et.ByPos,t,0,0).top,h=e.lineAt(a,Et.ByPos,t,0,0).bottom;return n+=h-c,{from:l,to:a,top:c,bottom:h,domTop:0,domBottom:0}}),this.scale=(7e6-n)/(e.height-n);for(let l of this.viewports)l.domTop=o+(l.top-r)*this.scale,o=l.domBottom=l.domTop+(l.bottom-l.top),r=l.bottom}toDOM(t){for(let e=0,i=0,n=0;;e++){let r=e<this.viewports.length?this.viewports[e]:null;if(!r||t<r.top)return n+(t-i)*this.scale;if(t<=r.bottom)return r.domTop+(t-r.top);i=r.bottom,n=r.domBottom}}fromDOM(t){for(let e=0,i=0,n=0;;e++){let r=e<this.viewports.length?this.viewports[e]:null;if(!r||t<r.domTop)return i+(t-n)/this.scale;if(t<=r.domBottom)return r.top+(t-r.domTop);i=r.bottom,n=r.domBottom}}eq(t){return t instanceof Yy?this.scale==t.scale&&this.viewports.length==t.viewports.length&&this.viewports.every((e,i)=>e.from==t.viewports[i].from&&e.to==t.viewports[i].to):!1}}function ih(s,t){if(t.scale==1)return s;let e=t.toDOM(s.top),i=t.toDOM(s.bottom);return new tr(s.from,s.length,e,i-e,Array.isArray(s._content)?s._content.map(n=>ih(n,t)):s._content)}const bm=Pe.define({combine:s=>s.join(" ")}),G1=Pe.define({combine:s=>s.indexOf(!0)>-1}),Y1=Lo.newName(),X3=Lo.newName(),G3=Lo.newName(),Y3={"&light":"."+X3,"&dark":"."+G3};function K1(s,t,e){return new Lo(t,{finish(i){return/&/.test(i)?i.replace(/&\w*/,n=>{if(n=="&")return s;if(!e||!e[n])throw new RangeError(`Unsupported selector: ${n}`);return e[n]}):s+" "+i}})}const Yne=K1("."+Y1,{"&":{position:"relative !important",boxSizing:"border-box","&.cm-focused":{outline:"1px dotted #212121"},display:"flex !important",flexDirection:"column"},".cm-scroller":{display:"flex !important",alignItems:"flex-start !important",fontFamily:"monospace",lineHeight:1.4,height:"100%",overflowX:"auto",position:"relative",zIndex:0,overflowAnchor:"none"},".cm-content":{margin:0,flexGrow:2,flexShrink:0,display:"block",whiteSpace:"pre",wordWrap:"normal",boxSizing:"border-box",minHeight:"100%",padding:"4px 0",outline:"none","&[contenteditable=true]":{WebkitUserModify:"read-write-plaintext-only"}},".cm-lineWrapping":{whiteSpace_fallback:"pre-wrap",whiteSpace:"break-spaces",wordBreak:"break-word",overflowWrap:"anywhere",flexShrink:1},"&light .cm-content":{caretColor:"black"},"&dark .cm-content":{caretColor:"white"},".cm-line":{display:"block",padding:"0 2px 0 6px"},".cm-layer":{position:"absolute",left:0,top:0,contain:"size style","& > *":{position:"absolute"}},"&light .cm-selectionBackground":{background:"#d9d9d9"},"&dark .cm-selectionBackground":{background:"#222"},"&light.cm-focused > .cm-scroller > .cm-selectionLayer .cm-selectionBackground":{background:"#d7d4f0"},"&dark.cm-focused > .cm-scroller > .cm-selectionLayer .cm-selectionBackground":{background:"#233"},".cm-cursorLayer":{pointerEvents:"none"},"&.cm-focused > .cm-scroller > .cm-cursorLayer":{animation:"steps(1) cm-blink 1.2s infinite"},"@keyframes cm-blink":{"0%":{},"50%":{opacity:0},"100%":{}},"@keyframes cm-blink2":{"0%":{},"50%":{opacity:0},"100%":{}},".cm-cursor, .cm-dropCursor":{borderLeft:"1.2px solid black",marginLeft:"-0.6px",pointerEvents:"none"},".cm-cursor":{display:"none"},"&dark .cm-cursor":{borderLeftColor:"#ddd"},".cm-dropCursor":{position:"absolute"},"&.cm-focused > .cm-scroller > .cm-cursorLayer .cm-cursor":{display:"block"},".cm-iso":{unicodeBidi:"isolate"},".cm-announced":{position:"fixed",top:"-10000px"},"@media print":{".cm-announced":{display:"none"}},"&light .cm-activeLine":{backgroundColor:"#cceeff44"},"&dark .cm-activeLine":{backgroundColor:"#99eeff33"},"&light .cm-specialChar":{color:"red"},"&dark .cm-specialChar":{color:"#f78"},".cm-gutters":{flexShrink:0,display:"flex",height:"100%",boxSizing:"border-box",zIndex:200},".cm-gutters-before":{insetInlineStart:0},".cm-gutters-after":{insetInlineEnd:0},"&light .cm-gutters":{backgroundColor:"#f5f5f5",color:"#6c6c6c",border:"0px solid #ddd","&.cm-gutters-before":{borderRightWidth:"1px"},"&.cm-gutters-after":{borderLeftWidth:"1px"}},"&dark .cm-gutters":{backgroundColor:"#333338",color:"#ccc"},".cm-gutter":{display:"flex !important",flexDirection:"column",flexShrink:0,boxSizing:"border-box",minHeight:"100%",overflow:"hidden"},".cm-gutterElement":{boxSizing:"border-box"},".cm-lineNumbers .cm-gutterElement":{padding:"0 3px 0 5px",minWidth:"20px",textAlign:"right",whiteSpace:"nowrap"},"&light .cm-activeLineGutter":{backgroundColor:"#e2f2ff"},"&dark .cm-activeLineGutter":{backgroundColor:"#222227"},".cm-panels":{boxSizing:"border-box",position:"sticky",left:0,right:0,zIndex:300},"&light .cm-panels":{backgroundColor:"#f5f5f5",color:"black"},"&light .cm-panels-top":{borderBottom:"1px solid #ddd"},"&light .cm-panels-bottom":{borderTop:"1px solid #ddd"},"&dark .cm-panels":{backgroundColor:"#333338",color:"white"},".cm-dialog":{padding:"2px 19px 4px 6px",position:"relative","& label":{fontSize:"80%"}},".cm-dialog-close":{position:"absolute",top:"3px",right:"4px",backgroundColor:"inherit",border:"none",font:"inherit",fontSize:"14px",padding:"0"},".cm-tab":{display:"inline-block",overflow:"hidden",verticalAlign:"bottom"},".cm-widgetBuffer":{verticalAlign:"text-top",height:"1em",width:0,display:"inline"},".cm-placeholder":{color:"#888",display:"inline-block",verticalAlign:"top",userSelect:"none"},".cm-highlightSpace":{backgroundImage:"radial-gradient(circle at 50% 55%, #aaa 20%, transparent 5%)",backgroundPosition:"center"},".cm-highlightTab":{backgroundImage:`url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" width="200" height="20"><path stroke="%23888" stroke-width="1" fill="none" d="M1 10H196L190 5M190 15L196 10M197 4L197 16"/></svg>')`,backgroundSize:"auto 100%",backgroundPosition:"right 90%",backgroundRepeat:"no-repeat"},".cm-trailingSpace":{backgroundColor:"#ff332255"},".cm-button":{verticalAlign:"middle",color:"inherit",fontSize:"70%",padding:".2em 1em",borderRadius:"1px"},"&light .cm-button":{backgroundImage:"linear-gradient(#eff1f5, #d9d9df)",border:"1px solid #888","&:active":{backgroundImage:"linear-gradient(#b4b4b4, #d0d3d6)"}},"&dark .cm-button":{backgroundImage:"linear-gradient(#393939, #111)",border:"1px solid #888","&:active":{backgroundImage:"linear-gradient(#111, #333)"}},".cm-textfield":{verticalAlign:"middle",color:"inherit",fontSize:"70%",border:"1px solid silver",padding:".2em .5em"},"&light .cm-textfield":{backgroundColor:"white"},"&dark .cm-textfield":{border:"1px solid #555",backgroundColor:"inherit"}},Y3),Kne={childList:!0,characterData:!0,subtree:!0,attributes:!0,characterDataOldValue:!0},Hx=ke.ie&&ke.ie_version<=11;class Jne{constructor(t){this.view=t,this.active=!1,this.editContext=null,this.selectionRange=new Mie,this.selectionChanged=!1,this.delayedFlush=-1,this.resizeTimeout=-1,this.queue=[],this.delayedAndroidKey=null,this.flushingAndroidKey=-1,this.lastChange=0,this.scrollTargets=[],this.intersection=null,this.resizeScroll=null,this.intersecting=!1,this.gapIntersection=null,this.gaps=[],this.printQuery=null,this.parentCheck=-1,this.dom=t.contentDOM,this.observer=new MutationObserver(e=>{for(let i of e)this.queue.push(i);(ke.ie&&ke.ie_version<=11||ke.ios&&t.composing)&&e.some(i=>i.type=="childList"&&i.removedNodes.length||i.type=="characterData"&&i.oldValue.length>i.target.nodeValue.length)?this.flushSoon():this.flush()}),window.EditContext&&ke.android&&t.constructor.EDIT_CONTEXT!==!1&&!(ke.chrome&&ke.chrome_version<126)&&(this.editContext=new tse(t),t.state.facet(Er)&&(t.contentDOM.editContext=this.editContext.editContext)),Hx&&(this.onCharData=e=>{this.queue.push({target:e.target,type:"characterData",oldValue:e.prevValue}),this.flushSoon()}),this.onSelectionChange=this.onSelectionChange.bind(this),this.onResize=this.onResize.bind(this),this.onPrint=this.onPrint.bind(this),this.onScroll=this.onScroll.bind(this),window.matchMedia&&(this.printQuery=window.matchMedia("print")),typeof ResizeObserver=="function"&&(this.resizeScroll=new ResizeObserver(()=>{var e;((e=this.view.docView)===null||e===void 0?void 0:e.lastUpdate)<Date.now()-75&&this.onResize()}),this.resizeScroll.observe(t.scrollDOM)),this.addWindowListeners(this.win=t.win),this.start(),typeof IntersectionObserver=="function"&&(this.intersection=new IntersectionObserver(e=>{this.parentCheck<0&&(this.parentCheck=setTimeout(this.listenForScroll.bind(this),1e3)),e.length>0&&e[e.length-1].intersectionRatio>0!=this.intersecting&&(this.intersecting=!this.intersecting,this.intersecting!=this.view.inView&&this.onScrollChanged(document.createEvent("Event")))},{threshold:[0,.001]}),this.intersection.observe(this.dom),this.gapIntersection=new IntersectionObserver(e=>{e.length>0&&e[e.length-1].intersectionRatio>0&&this.onScrollChanged(document.createEvent("Event"))},{})),this.listenForScroll(),this.readSelectionRange()}onScrollChanged(t){this.view.inputState.runHandlers("scroll",t),this.intersecting&&this.view.measure()}onScroll(t){this.intersecting&&this.flush(!1),this.editContext&&this.view.requestMeasure(this.editContext.measureReq),this.onScrollChanged(t)}onResize(){this.resizeTimeout<0&&(this.resizeTimeout=setTimeout(()=>{this.resizeTimeout=-1,this.view.requestMeasure()},50))}onPrint(t){(t.type=="change"||!t.type)&&!t.matches||(this.view.viewState.printing=!0,this.view.measure(),setTimeout(()=>{this.view.viewState.printing=!1,this.view.requestMeasure()},500))}updateGaps(t){if(this.gapIntersection&&(t.length!=this.gaps.length||this.gaps.some((e,i)=>e!=t[i]))){this.gapIntersection.disconnect();for(let e of t)this.gapIntersection.observe(e);this.gaps=t}}onSelectionChange(t){let e=this.selectionChanged;if(!this.readSelectionRange()||this.delayedAndroidKey)return;let{view:i}=this,n=this.selectionRange;if(i.state.facet(Er)?i.root.activeElement!=this.dom:!jm(this.dom,n))return;let r=n.anchorNode&&i.docView.nearest(n.anchorNode);if(r&&r.ignoreEvent(t)){e||(this.selectionChanged=!1);return}(ke.ie&&ke.ie_version<=11||ke.android&&ke.chrome)&&!i.state.selection.main.empty&&n.focusNode&&xh(n.focusNode,n.focusOffset,n.anchorNode,n.anchorOffset)?this.flushSoon():this.flush(!1)}readSelectionRange(){let{view:t}=this,e=Uh(t.root);if(!e)return!1;let i=ke.safari&&t.root.nodeType==11&&t.root.activeElement==this.dom&&ese(this.view,e)||e;if(!i||this.selectionRange.eq(i))return!1;let n=jm(this.dom,i);return n&&!this.selectionChanged&&t.inputState.lastFocusTime>Date.now()-200&&t.inputState.lastTouchTime<Date.now()-300&&Bie(this.dom,i)?(this.view.inputState.lastFocusTime=0,t.docView.updateSelection(),!1):(this.selectionRange.setRange(i),n&&(this.selectionChanged=!0),!0)}setSelectionRange(t,e){this.selectionRange.set(t.node,t.offset,e.node,e.offset),this.selectionChanged=!1}clearSelectionRange(){this.selectionRange.set(null,0,null,0)}listenForScroll(){this.parentCheck=-1;let t=0,e=null;for(let i=this.dom;i;)if(i.nodeType==1)!e&&t<this.scrollTargets.length&&this.scrollTargets[t]==i?t++:e||(e=this.scrollTargets.slice(0,t)),e&&e.push(i),i=i.assignedSlot||i.parentNode;else if(i.nodeType==11)i=i.host;else break;if(t<this.scrollTargets.length&&!e&&(e=this.scrollTargets.slice(0,t)),e){for(let i of this.scrollTargets)i.removeEventListener("scroll",this.onScroll);for(let i of this.scrollTargets=e)i.addEventListener("scroll",this.onScroll)}}ignore(t){if(!this.active)return t();try{return this.stop(),t()}finally{this.start(),this.clear()}}start(){this.active||(this.observer.observe(this.dom,Kne),Hx&&this.dom.addEventListener("DOMCharacterDataModified",this.onCharData),this.active=!0)}stop(){this.active&&(this.active=!1,this.observer.disconnect(),Hx&&this.dom.removeEventListener("DOMCharacterDataModified",this.onCharData))}clear(){this.processRecords(),this.queue.length=0,this.selectionChanged=!1}delayAndroidKey(t,e){var i;if(!this.delayedAndroidKey){let n=()=>{let r=this.delayedAndroidKey;r&&(this.clearDelayedAndroidKey(),this.view.inputState.lastKeyCode=r.keyCode,this.view.inputState.lastKeyTime=Date.now(),!this.flush()&&r.force&&lc(this.dom,r.key,r.keyCode))};this.flushingAndroidKey=this.view.win.requestAnimationFrame(n)}(!this.delayedAndroidKey||t=="Enter")&&(this.delayedAndroidKey={key:t,keyCode:e,force:this.lastChange<Date.now()-50||!!(!((i=this.delayedAndroidKey)===null||i===void 0)&&i.force)})}clearDelayedAndroidKey(){this.win.cancelAnimationFrame(this.flushingAndroidKey),this.delayedAndroidKey=null,this.flushingAndroidKey=-1}flushSoon(){this.delayedFlush<0&&(this.delayedFlush=this.view.win.requestAnimationFrame(()=>{this.delayedFlush=-1,this.flush()}))}forceFlush(){this.delayedFlush>=0&&(this.view.win.cancelAnimationFrame(this.delayedFlush),this.delayedFlush=-1),this.flush()}pendingRecords(){for(let t of this.observer.takeRecords())this.queue.push(t);return this.queue}processRecords(){let t=this.pendingRecords();t.length&&(this.queue=[]);let e=-1,i=-1,n=!1;for(let r of t){let o=this.readMutation(r);o&&(o.typeOver&&(n=!0),e==-1?{from:e,to:i}=o:(e=Math.min(o.from,e),i=Math.max(o.to,i)))}return{from:e,to:i,typeOver:n}}readChange(){let{from:t,to:e,typeOver:i}=this.processRecords(),n=this.selectionChanged&&jm(this.dom,this.selectionRange);if(t<0&&!n)return null;t>-1&&(this.lastChange=Date.now()),this.view.inputState.lastFocusTime=0,this.selectionChanged=!1;let r=new wne(this.view,t,e,i);return this.view.docView.domChanged={newSel:r.newSel?r.newSel.main:null},r}flush(t=!0){if(this.delayedFlush>=0||this.delayedAndroidKey)return!1;t&&this.readSelectionRange();let e=this.readChange();if(!e)return this.view.requestMeasure(),!1;let i=this.view.state,n=Q3(this.view,e);return this.view.state==i&&(e.domChanged||e.newSel&&!e.newSel.main.eq(this.view.state.selection.main))&&this.view.update([]),n}readMutation(t){let e=this.view.docView.nearest(t.target);if(!e||e.ignoreMutation(t))return null;if(e.markDirty(t.type=="attributes"),t.type=="attributes"&&(e.flags|=4),t.type=="childList"){let i=oT(e,t.previousSibling||t.target.previousSibling,-1),n=oT(e,t.nextSibling||t.target.nextSibling,1);return{from:i?e.posAfter(i):e.posAtStart,to:n?e.posBefore(n):e.posAtEnd,typeOver:!1}}else return t.type=="characterData"?{from:e.posAtStart,to:e.posAtEnd,typeOver:t.target.nodeValue==t.oldValue}:null}setWindow(t){t!=this.win&&(this.removeWindowListeners(this.win),this.win=t,this.addWindowListeners(this.win))}addWindowListeners(t){t.addEventListener("resize",this.onResize),this.printQuery?this.printQuery.addEventListener?this.printQuery.addEventListener("change",this.onPrint):this.printQuery.addListener(this.onPrint):t.addEventListener("beforeprint",this.onPrint),t.addEventListener("scroll",this.onScroll),t.document.addEventListener("selectionchange",this.onSelectionChange)}removeWindowListeners(t){t.removeEventListener("scroll",this.onScroll),t.removeEventListener("resize",this.onResize),this.printQuery?this.printQuery.removeEventListener?this.printQuery.removeEventListener("change",this.onPrint):this.printQuery.removeListener(this.onPrint):t.removeEventListener("beforeprint",this.onPrint),t.document.removeEventListener("selectionchange",this.onSelectionChange)}update(t){this.editContext&&(this.editContext.update(t),t.startState.facet(Er)!=t.state.facet(Er)&&(t.view.contentDOM.editContext=t.state.facet(Er)?this.editContext.editContext:null))}destroy(){var t,e,i;this.stop(),(t=this.intersection)===null||t===void 0||t.disconnect(),(e=this.gapIntersection)===null||e===void 0||e.disconnect(),(i=this.resizeScroll)===null||i===void 0||i.disconnect();for(let n of this.scrollTargets)n.removeEventListener("scroll",this.onScroll);this.removeWindowListeners(this.win),clearTimeout(this.parentCheck),clearTimeout(this.resizeTimeout),this.win.cancelAnimationFrame(this.delayedFlush),this.win.cancelAnimationFrame(this.flushingAndroidKey),this.editContext&&(this.view.contentDOM.editContext=null,this.editContext.destroy())}}function oT(s,t,e){for(;t;){let i=vt.get(t);if(i&&i.parent==s)return i;let n=t.parentNode;t=n!=s.dom?n:e>0?t.nextSibling:t.previousSibling}return null}function lT(s,t){let e=t.startContainer,i=t.startOffset,n=t.endContainer,r=t.endOffset,o=s.docView.domAtPos(s.state.selection.main.anchor);return xh(o.node,o.offset,n,r)&&([e,i,n,r]=[n,r,e,i]),{anchorNode:e,anchorOffset:i,focusNode:n,focusOffset:r}}function ese(s,t){if(t.getComposedRanges){let n=t.getComposedRanges(s.root)[0];if(n)return lT(s,n)}let e=null;function i(n){n.preventDefault(),n.stopImmediatePropagation(),e=n.getTargetRanges()[0]}return s.contentDOM.addEventListener("beforeinput",i,!0),s.dom.ownerDocument.execCommand("indent"),s.contentDOM.removeEventListener("beforeinput",i,!0),e?lT(s,e):null}class tse{constructor(t){this.from=0,this.to=0,this.pendingContextChange=null,this.handlers=Object.create(null),this.composing=null,this.resetRange(t.state);let e=this.editContext=new window.EditContext({text:t.state.doc.sliceString(this.from,this.to),selectionStart:this.toContextPos(Math.max(this.from,Math.min(this.to,t.state.selection.main.anchor))),selectionEnd:this.toContextPos(t.state.selection.main.head)});this.handlers.textupdate=i=>{let n=t.state.selection.main,{anchor:r,head:o}=n,l=this.toEditorPos(i.updateRangeStart),a=this.toEditorPos(i.updateRangeEnd);t.inputState.composing>=0&&!this.composing&&(this.composing={contextBase:i.updateRangeStart,editorBase:l,drifted:!1});let c={from:l,to:a,insert:Ke.of(i.text.split(`
`))};if(c.from==this.from&&r<this.from?c.from=r:c.to==this.to&&r>this.to&&(c.to=r),c.from==c.to&&!c.insert.length){let h=se.single(this.toEditorPos(i.selectionStart),this.toEditorPos(i.selectionEnd));h.main.eq(n)||t.dispatch({selection:h,userEvent:"select"});return}if((ke.mac||ke.android)&&c.from==o-1&&/^\. ?$/.test(i.text)&&t.contentDOM.getAttribute("autocorrect")=="off"&&(c={from:l,to:a,insert:Ke.of([i.text.replace("."," ")])}),this.pendingContextChange=c,!t.state.readOnly){let h=this.to-this.from+(c.to-c.from+c.insert.length);Xy(t,c,se.single(this.toEditorPos(i.selectionStart,h),this.toEditorPos(i.selectionEnd,h)))}this.pendingContextChange&&(this.revertPending(t.state),this.setSelection(t.state))},this.handlers.characterboundsupdate=i=>{let n=[],r=null;for(let o=this.toEditorPos(i.rangeStart),l=this.toEditorPos(i.rangeEnd);o<l;o++){let a=t.coordsForChar(o);r=a&&new DOMRect(a.left,a.top,a.right-a.left,a.bottom-a.top)||r||new DOMRect,n.push(r)}e.updateCharacterBounds(i.rangeStart,n)},this.handlers.textformatupdate=i=>{let n=[];for(let r of i.getTextFormats()){let o=r.underlineStyle,l=r.underlineThickness;if(o!="None"&&l!="None"){let a=this.toEditorPos(r.rangeStart),c=this.toEditorPos(r.rangeEnd);if(a<c){let h=`text-decoration: underline ${o=="Dashed"?"dashed ":o=="Squiggle"?"wavy ":""}${l=="Thin"?1:2}px`;n.push(Je.mark({attributes:{style:h}}).range(a,c))}}}t.dispatch({effects:R3.of(Je.set(n))})},this.handlers.compositionstart=()=>{t.inputState.composing<0&&(t.inputState.composing=0,t.inputState.compositionFirstChange=!0)},this.handlers.compositionend=()=>{if(t.inputState.composing=-1,t.inputState.compositionFirstChange=null,this.composing){let{drifted:i}=this.composing;this.composing=null,i&&this.reset(t.state)}};for(let i in this.handlers)e.addEventListener(i,this.handlers[i]);this.measureReq={read:i=>{this.editContext.updateControlBounds(i.contentDOM.getBoundingClientRect());let n=Uh(i.root);n&&n.rangeCount&&this.editContext.updateSelectionBounds(n.getRangeAt(0).getBoundingClientRect())}}}applyEdits(t){let e=0,i=!1,n=this.pendingContextChange;return t.changes.iterChanges((r,o,l,a,c)=>{if(i)return;let h=c.length-(o-r);if(n&&o>=n.to)if(n.from==r&&n.to==o&&n.insert.eq(c)){n=this.pendingContextChange=null,e+=h,this.to+=h;return}else n=null,this.revertPending(t.state);if(r+=e,o+=e,o<=this.from)this.from+=h,this.to+=h;else if(r<this.to){if(r<this.from||o>this.to||this.to-this.from+c.length>3e4){i=!0;return}this.editContext.updateText(this.toContextPos(r),this.toContextPos(o),c.toString()),this.to+=h}e+=h}),n&&!i&&this.revertPending(t.state),!i}update(t){let e=this.pendingContextChange,i=t.startState.selection.main;this.composing&&(this.composing.drifted||!t.changes.touchesRange(i.from,i.to)&&t.transactions.some(n=>!n.isUserEvent("input.type")&&n.changes.touchesRange(this.from,this.to)))?(this.composing.drifted=!0,this.composing.editorBase=t.changes.mapPos(this.composing.editorBase)):!this.applyEdits(t)||!this.rangeIsValid(t.state)?(this.pendingContextChange=null,this.reset(t.state)):(t.docChanged||t.selectionSet||e)&&this.setSelection(t.state),(t.geometryChanged||t.docChanged||t.selectionSet)&&t.view.requestMeasure(this.measureReq)}resetRange(t){let{head:e}=t.selection.main;this.from=Math.max(0,e-1e4),this.to=Math.min(t.doc.length,e+1e4)}reset(t){this.resetRange(t),this.editContext.updateText(0,this.editContext.text.length,t.doc.sliceString(this.from,this.to)),this.setSelection(t)}revertPending(t){let e=this.pendingContextChange;this.pendingContextChange=null,this.editContext.updateText(this.toContextPos(e.from),this.toContextPos(e.from+e.insert.length),t.doc.sliceString(e.from,e.to))}setSelection(t){let{main:e}=t.selection,i=this.toContextPos(Math.max(this.from,Math.min(this.to,e.anchor))),n=this.toContextPos(e.head);(this.editContext.selectionStart!=i||this.editContext.selectionEnd!=n)&&this.editContext.updateSelection(i,n)}rangeIsValid(t){let{head:e}=t.selection.main;return!(this.from>0&&e-this.from<500||this.to<t.doc.length&&this.to-e<500||this.to-this.from>1e4*3)}toEditorPos(t,e=this.to-this.from){t=Math.min(t,e);let i=this.composing;return i&&i.drifted?i.editorBase+(t-i.contextBase):t+this.from}toContextPos(t){let e=this.composing;return e&&e.drifted?e.contextBase+(t-e.editorBase):t-this.from}destroy(){for(let t in this.handlers)this.editContext.removeEventListener(t,this.handlers[t])}}class Ee{get state(){return this.viewState.state}get viewport(){return this.viewState.viewport}get visibleRanges(){return this.viewState.visibleRanges}get inView(){return this.viewState.inView}get composing(){return!!this.inputState&&this.inputState.composing>0}get compositionStarted(){return!!this.inputState&&this.inputState.composing>=0}get root(){return this._root}get win(){return this.dom.ownerDocument.defaultView||window}constructor(t={}){var e;this.plugins=[],this.pluginMap=new Map,this.editorAttrs={},this.contentAttrs={},this.bidiCache=[],this.destroyed=!1,this.updateState=2,this.measureScheduled=-1,this.measureRequests=[],this.contentDOM=document.createElement("div"),this.scrollDOM=document.createElement("div"),this.scrollDOM.tabIndex=-1,this.scrollDOM.className="cm-scroller",this.scrollDOM.appendChild(this.contentDOM),this.announceDOM=document.createElement("div"),this.announceDOM.className="cm-announced",this.announceDOM.setAttribute("aria-live","polite"),this.dom=document.createElement("div"),this.dom.appendChild(this.announceDOM),this.dom.appendChild(this.scrollDOM),t.parent&&t.parent.appendChild(this.dom);let{dispatch:i}=t;this.dispatchTransactions=t.dispatchTransactions||i&&(n=>n.forEach(r=>i(r,this)))||(n=>this.update(n)),this.dispatch=this.dispatch.bind(this),this._root=t.root||Lie(t.parent)||document,this.viewState=new sT(t.state||ht.create(t)),t.scrollTo&&t.scrollTo.is(fm)&&(this.viewState.scrollTarget=t.scrollTo.value.clip(this.viewState.state)),this.plugins=this.state.facet(Ga).map(n=>new zx(n));for(let n of this.plugins)n.update(this);this.observer=new Jne(this),this.inputState=new vne(this),this.inputState.ensureHandlers(this.plugins),this.docView=new QP(this),this.mountStyles(),this.updateAttrs(),this.updateState=0,this.requestMeasure(),!((e=document.fonts)===null||e===void 0)&&e.ready&&document.fonts.ready.then(()=>this.requestMeasure())}dispatch(...t){let e=t.length==1&&t[0]instanceof Jt?t:t.length==1&&Array.isArray(t[0])?t[0]:[this.state.update(...t)];this.dispatchTransactions(e,this)}update(t){if(this.updateState!=0)throw new Error("Calls to EditorView.update are not allowed while an update is in progress");let e=!1,i=!1,n,r=this.state;for(let m of t){if(m.startState!=r)throw new RangeError("Trying to update state with a transaction that doesn't start from the previous state.");r=m.state}if(this.destroyed){this.viewState.state=r;return}let o=this.hasFocus,l=0,a=null;t.some(m=>m.annotation(Z3))?(this.inputState.notifiedFocused=o,l=1):o!=this.inputState.notifiedFocused&&(this.inputState.notifiedFocused=o,a=H3(r,o),a||(l=1));let c=this.observer.delayedAndroidKey,h=null;if(c?(this.observer.clearDelayedAndroidKey(),h=this.observer.readChange(),(h&&!this.state.doc.eq(r.doc)||!this.state.selection.eq(r.selection))&&(h=null)):this.observer.clear(),r.facet(ht.phrases)!=this.state.facet(ht.phrases))return this.setState(r);n=qg.create(this,r,t),n.flags|=l;let f=this.viewState.scrollTarget;try{this.updateState=2;for(let m of t){if(f&&(f=f.map(m.changes)),m.scrollIntoView){let{main:w}=m.state.selection;f=new ac(w.empty?w:se.cursor(w.head,w.head>w.anchor?-1:1))}for(let w of m.effects)w.is(fm)&&(f=w.value.clip(this.state))}this.viewState.update(n,f),this.bidiCache=Xg.update(this.bidiCache,n.changes),n.empty||(this.updatePlugins(n),this.inputState.update(n)),e=this.docView.update(n),this.state.facet(eh)!=this.styleModules&&this.mountStyles(),i=this.updateAttrs(),this.showAnnouncements(t),this.docView.updateSelection(e,t.some(m=>m.isUserEvent("select.pointer")))}finally{this.updateState=0}if(n.startState.facet(bm)!=n.state.facet(bm)&&(this.viewState.mustMeasureContent=!0),(e||i||f||this.viewState.mustEnforceCursorAssoc||this.viewState.mustMeasureContent)&&this.requestMeasure(),e&&this.docViewUpdate(),!n.empty)for(let m of this.state.facet(H1))try{m(n)}catch(w){Fn(this.state,w,"update listener")}(a||h)&&Promise.resolve().then(()=>{a&&this.state==a.startState&&this.dispatch(a),h&&!Q3(this,h)&&c.force&&lc(this.contentDOM,c.key,c.keyCode)})}setState(t){if(this.updateState!=0)throw new Error("Calls to EditorView.setState are not allowed while an update is in progress");if(this.destroyed){this.viewState.state=t;return}this.updateState=2;let e=this.hasFocus;try{for(let i of this.plugins)i.destroy(this);this.viewState=new sT(t),this.plugins=t.facet(Ga).map(i=>new zx(i)),this.pluginMap.clear();for(let i of this.plugins)i.update(this);this.docView.destroy(),this.docView=new QP(this),this.inputState.ensureHandlers(this.plugins),this.mountStyles(),this.updateAttrs(),this.bidiCache=[]}finally{this.updateState=0}e&&this.focus(),this.requestMeasure()}updatePlugins(t){let e=t.startState.facet(Ga),i=t.state.facet(Ga);if(e!=i){let n=[];for(let r of i){let o=e.indexOf(r);if(o<0)n.push(new zx(r));else{let l=this.plugins[o];l.mustUpdate=t,n.push(l)}}for(let r of this.plugins)r.mustUpdate!=t&&r.destroy(this);this.plugins=n,this.pluginMap.clear()}else for(let n of this.plugins)n.mustUpdate=t;for(let n=0;n<this.plugins.length;n++)this.plugins[n].update(this);e!=i&&this.inputState.ensureHandlers(this.plugins)}docViewUpdate(){for(let t of this.plugins){let e=t.value;if(e&&e.docViewUpdate)try{e.docViewUpdate(this)}catch(i){Fn(this.state,i,"doc view update listener")}}}measure(t=!0){if(this.destroyed)return;if(this.measureScheduled>-1&&this.win.cancelAnimationFrame(this.measureScheduled),this.observer.delayedAndroidKey){this.measureScheduled=-1,this.requestMeasure();return}this.measureScheduled=0,t&&this.observer.forceFlush();let e=null,i=this.scrollDOM,n=i.scrollTop*this.scaleY,{scrollAnchorPos:r,scrollAnchorHeight:o}=this.viewState;Math.abs(n-this.viewState.scrollTop)>1&&(o=-1),this.viewState.scrollAnchorHeight=-1;try{for(let l=0;;l++){if(o<0)if(o3(i))r=-1,o=this.viewState.heightMap.height;else{let w=this.viewState.scrollAnchorAt(n);r=w.from,o=w.top}this.updateState=1;let a=this.viewState.measure(this);if(!a&&!this.measureRequests.length&&this.viewState.scrollTarget==null)break;if(l>5){console.warn(this.measureRequests.length?"Measure loop restarted more than 5 times":"Viewport failed to stabilize");break}let c=[];a&4||([this.measureRequests,c]=[c,this.measureRequests]);let h=c.map(w=>{try{return w.read(this)}catch(O){return Fn(this.state,O),aT}}),f=qg.create(this,this.state,[]),m=!1;f.flags|=a,e?e.flags|=a:e=f,this.updateState=2,f.empty||(this.updatePlugins(f),this.inputState.update(f),this.updateAttrs(),m=this.docView.update(f),m&&this.docViewUpdate());for(let w=0;w<c.length;w++)if(h[w]!=aT)try{let O=c[w];O.write&&O.write(h[w],this)}catch(O){Fn(this.state,O)}if(m&&this.docView.updateSelection(!0),!f.viewportChanged&&this.measureRequests.length==0){if(this.viewState.editorHeight)if(this.viewState.scrollTarget){this.docView.scrollIntoView(this.viewState.scrollTarget),this.viewState.scrollTarget=null,o=-1;continue}else{let O=(r<0?this.viewState.heightMap.height:this.viewState.lineBlockAt(r).top)-o;if(O>1||O<-1){n=n+O,i.scrollTop=n/this.scaleY,o=-1;continue}}break}}}finally{this.updateState=0,this.measureScheduled=-1}if(e&&!e.empty)for(let l of this.state.facet(H1))l(e)}get themeClasses(){return Y1+" "+(this.state.facet(G1)?G3:X3)+" "+this.state.facet(bm)}updateAttrs(){let t=cT(this,V3,{class:"cm-editor"+(this.hasFocus?" cm-focused ":" ")+this.themeClasses}),e={spellcheck:"false",autocorrect:"off",autocapitalize:"off",writingsuggestions:"false",translate:"no",contenteditable:this.state.facet(Er)?"true":"false",class:"cm-content",style:`${ke.tabSize}: ${this.state.tabSize}`,role:"textbox","aria-multiline":"true"};this.state.readOnly&&(e["aria-readonly"]="true"),cT(this,Hy,e);let i=this.observer.ignore(()=>{let n=F1(this.contentDOM,this.contentAttrs,e),r=F1(this.dom,this.editorAttrs,t);return n||r});return this.editorAttrs=t,this.contentAttrs=e,i}showAnnouncements(t){let e=!0;for(let i of t)for(let n of i.effects)if(n.is(Ee.announce)){e&&(this.announceDOM.textContent=""),e=!1;let r=this.announceDOM.appendChild(document.createElement("div"));r.textContent=n.value}}mountStyles(){this.styleModules=this.state.facet(eh);let t=this.state.facet(Ee.cspNonce);Lo.mount(this.root,this.styleModules.concat(Yne).reverse(),t?{nonce:t}:void 0)}readMeasured(){if(this.updateState==2)throw new Error("Reading the editor layout isn't allowed during an update");this.updateState==0&&this.measureScheduled>-1&&this.measure(!1)}requestMeasure(t){if(this.measureScheduled<0&&(this.measureScheduled=this.win.requestAnimationFrame(()=>this.measure())),t){if(this.measureRequests.indexOf(t)>-1)return;if(t.key!=null){for(let e=0;e<this.measureRequests.length;e++)if(this.measureRequests[e].key===t.key){this.measureRequests[e]=t;return}}this.measureRequests.push(t)}}plugin(t){let e=this.pluginMap.get(t);return(e===void 0||e&&e.plugin!=t)&&this.pluginMap.set(t,e=this.plugins.find(i=>i.plugin==t)||null),e&&e.update(this).value}get documentTop(){return this.contentDOM.getBoundingClientRect().top+this.viewState.paddingTop}get documentPadding(){return{top:this.viewState.paddingTop,bottom:this.viewState.paddingBottom}}get scaleX(){return this.viewState.scaleX}get scaleY(){return this.viewState.scaleY}elementAtHeight(t){return this.readMeasured(),this.viewState.elementAtHeight(t)}lineBlockAtHeight(t){return this.readMeasured(),this.viewState.lineBlockAtHeight(t)}get viewportLineBlocks(){return this.viewState.viewportLines}lineBlockAt(t){return this.viewState.lineBlockAt(t)}get contentHeight(){return this.viewState.contentHeight}moveByChar(t,e,i){return Ux(this,t,UP(this,t,e,i))}moveByGroup(t,e){return Ux(this,t,UP(this,t,e,i=>fne(this,t.head,i)))}visualLineSide(t,e){let i=this.bidiSpans(t),n=this.textDirectionAt(t.from),r=i[e?i.length-1:0];return se.cursor(r.side(e,n)+t.from,r.forward(!e,n)?1:-1)}moveToLineBoundary(t,e,i=!0){return dne(this,t,e,i)}moveVertically(t,e,i){return Ux(this,t,mne(this,t,e,i))}domAtPos(t){return this.docView.domAtPos(t)}posAtDOM(t,e=0){return this.docView.posFromDOM(t,e)}posAtCoords(t,e=!0){return this.readMeasured(),D3(this,t,e)}coordsAtPos(t,e=1){this.readMeasured();let i=this.docView.coordsAt(t,e);if(!i||i.left==i.right)return i;let n=this.state.doc.lineAt(t),r=this.bidiSpans(n),o=r[_o.find(r,t-n.from,-1,e)];return Dp(i,o.dir==Bt.LTR==e>0)}coordsForChar(t){return this.readMeasured(),this.docView.coordsForChar(t)}get defaultCharacterWidth(){return this.viewState.heightOracle.charWidth}get defaultLineHeight(){return this.viewState.heightOracle.lineHeight}get textDirection(){return this.viewState.defaultTextDirection}textDirectionAt(t){return!this.state.facet(E3)||t<this.viewport.from||t>this.viewport.to?this.textDirection:(this.readMeasured(),this.docView.textDirectionAt(t))}get lineWrapping(){return this.viewState.heightOracle.lineWrapping}bidiSpans(t){if(t.length>ise)return y3(t.length);let e=this.textDirectionAt(t.from),i;for(let r of this.bidiCache)if(r.from==t.from&&r.dir==e&&(r.fresh||O3(r.isolates,i=DP(this,t))))return r.order;i||(i=DP(this,t));let n=Gie(t.text,e,i);return this.bidiCache.push(new Xg(t.from,t.to,e,i,!0,n)),n}get hasFocus(){var t;return(this.dom.ownerDocument.hasFocus()||ke.safari&&((t=this.inputState)===null||t===void 0?void 0:t.lastContextMenu)>Date.now()-3e4)&&this.root.activeElement==this.contentDOM}focus(){this.observer.ignore(()=>{s3(this.contentDOM),this.docView.updateSelection()})}setRoot(t){this._root!=t&&(this._root=t,this.observer.setWindow((t.nodeType==9?t:t.ownerDocument).defaultView||window),this.mountStyles())}destroy(){this.root.activeElement==this.contentDOM&&this.contentDOM.blur();for(let t of this.plugins)t.destroy(this);this.plugins=[],this.inputState.destroy(),this.docView.destroy(),this.dom.remove(),this.observer.destroy(),this.measureScheduled>-1&&this.win.cancelAnimationFrame(this.measureScheduled),this.destroyed=!0}static scrollIntoView(t,e={}){return fm.of(new ac(typeof t=="number"?se.cursor(t):t,e.y,e.x,e.yMargin,e.xMargin))}scrollSnapshot(){let{scrollTop:t,scrollLeft:e}=this.scrollDOM,i=this.viewState.scrollAnchorAt(t);return fm.of(new ac(se.cursor(i.from),"start","start",i.top-t,e,!0))}setTabFocusMode(t){t==null?this.inputState.tabFocusMode=this.inputState.tabFocusMode<0?0:-1:typeof t=="boolean"?this.inputState.tabFocusMode=t?0:-1:this.inputState.tabFocusMode!=0&&(this.inputState.tabFocusMode=Date.now()+t)}static domEventHandlers(t){return Hi.define(()=>({}),{eventHandlers:t})}static domEventObservers(t){return Hi.define(()=>({}),{eventObservers:t})}static theme(t,e){let i=Lo.newName(),n=[bm.of(i),eh.of(K1(`.${i}`,t))];return e&&e.dark&&n.push(G1.of(!0)),n}static baseTheme(t){return zo.lowest(eh.of(K1("."+Y1,t,Y3)))}static findFromDOM(t){var e;let i=t.querySelector(".cm-content"),n=i&&vt.get(i)||vt.get(t);return((e=n==null?void 0:n.rootView)===null||e===void 0?void 0:e.view)||null}}Ee.styleModule=eh;Ee.inputHandler=P3;Ee.clipboardInputFilter=Uy;Ee.clipboardOutputFilter=Zy;Ee.scrollHandler=I3;Ee.focusChangeEffect=T3;Ee.perLineTextDirection=E3;Ee.exceptionSink=C3;Ee.updateListener=H1;Ee.editable=Er;Ee.mouseSelectionStyle=S3;Ee.dragMovesSelection=k3;Ee.clickAddsSelectionRange=_3;Ee.decorations=Hh;Ee.outerDecorations=M3;Ee.atomicRanges=qy;Ee.bidiIsolatedRanges=L3;Ee.scrollMargins=B3;Ee.darkTheme=G1;Ee.cspNonce=Pe.define({combine:s=>s.length?s[0]:""});Ee.contentAttributes=Hy;Ee.editorAttributes=V3;Ee.lineWrapping=Ee.contentAttributes.of({class:"cm-lineWrapping"});Ee.announce=rt.define();const ise=4096,aT={};class Xg{constructor(t,e,i,n,r,o){this.from=t,this.to=e,this.dir=i,this.isolates=n,this.fresh=r,this.order=o}static update(t,e){if(e.empty&&!t.some(r=>r.fresh))return t;let i=[],n=t.length?t[t.length-1].dir:Bt.LTR;for(let r=Math.max(0,t.length-10);r<t.length;r++){let o=t[r];o.dir==n&&!e.touchesRange(o.from,o.to)&&i.push(new Xg(e.mapPos(o.from,1),e.mapPos(o.to,-1),o.dir,o.isolates,!1,o.order))}return i}}function cT(s,t,e){for(let i=s.state.facet(t),n=i.length-1;n>=0;n--){let r=i[n],o=typeof r=="function"?r(s):r;o&&N1(o,e)}return e}const nse=ke.mac?"mac":ke.windows?"win":ke.linux?"linux":"key";function sse(s,t){const e=s.split(/-(?!$)/);let i=e[e.length-1];i=="Space"&&(i=" ");let n,r,o,l;for(let a=0;a<e.length-1;++a){const c=e[a];if(/^(cmd|meta|m)$/i.test(c))l=!0;else if(/^a(lt)?$/i.test(c))n=!0;else if(/^(c|ctrl|control)$/i.test(c))r=!0;else if(/^s(hift)?$/i.test(c))o=!0;else if(/^mod$/i.test(c))t=="mac"?l=!0:r=!0;else throw new Error("Unrecognized modifier name: "+c)}return n&&(i="Alt-"+i),r&&(i="Ctrl-"+i),l&&(i="Meta-"+i),o&&(i="Shift-"+i),i}function Om(s,t,e){return t.altKey&&(s="Alt-"+s),t.ctrlKey&&(s="Ctrl-"+s),t.metaKey&&(s="Meta-"+s),e!==!1&&t.shiftKey&&(s="Shift-"+s),s}const rse=zo.default(Ee.domEventHandlers({keydown(s,t){return cse(ose(t.state),s,t,"editor")}})),_d=Pe.define({enables:rse}),uT=new WeakMap;function ose(s){let t=s.facet(_d),e=uT.get(t);return e||uT.set(t,e=ase(t.reduce((i,n)=>i.concat(n),[]))),e}let Oo=null;const lse=4e3;function ase(s,t=nse){let e=Object.create(null),i=Object.create(null),n=(o,l)=>{let a=i[o];if(a==null)i[o]=l;else if(a!=l)throw new Error("Key binding "+o+" is used both as a regular binding and as a multi-stroke prefix")},r=(o,l,a,c,h)=>{var f,m;let w=e[o]||(e[o]=Object.create(null)),O=l.split(/ (?!$)/).map(C=>sse(C,t));for(let C=1;C<O.length;C++){let P=O.slice(0,C).join(" ");n(P,!0),w[P]||(w[P]={preventDefault:!0,stopPropagation:!1,run:[M=>{let Q=Oo={view:M,prefix:P,scope:o};return setTimeout(()=>{Oo==Q&&(Oo=null)},lse),!0}]})}let _=O.join(" ");n(_,!1);let k=w[_]||(w[_]={preventDefault:!1,stopPropagation:!1,run:((m=(f=w._any)===null||f===void 0?void 0:f.run)===null||m===void 0?void 0:m.slice())||[]});a&&k.run.push(a),c&&(k.preventDefault=!0),h&&(k.stopPropagation=!0)};for(let o of s){let l=o.scope?o.scope.split(" "):["editor"];if(o.any)for(let c of l){let h=e[c]||(e[c]=Object.create(null));h._any||(h._any={preventDefault:!1,stopPropagation:!1,run:[]});let{any:f}=o;for(let m in h)h[m].run.push(w=>f(w,J1))}let a=o[t]||o.key;if(a)for(let c of l)r(c,a,o.run,o.preventDefault,o.stopPropagation),o.shift&&r(c,"Shift-"+a,o.shift,o.preventDefault,o.stopPropagation)}return e}let J1=null;function cse(s,t,e,i){J1=t;let n=Aie(t),r=$n(n,0),o=Tr(r)==n.length&&n!=" ",l="",a=!1,c=!1,h=!1;Oo&&Oo.view==e&&Oo.scope==i&&(l=Oo.prefix+" ",F3.indexOf(t.keyCode)<0&&(c=!0,Oo=null));let f=new Set,m=k=>{if(k){for(let C of k.run)if(!f.has(C)&&(f.add(C),C(e)))return k.stopPropagation&&(h=!0),!0;k.preventDefault&&(k.stopPropagation&&(h=!0),c=!0)}return!1},w=s[i],O,_;return w&&(m(w[l+Om(n,t,!o)])?a=!0:o&&(t.altKey||t.metaKey||t.ctrlKey)&&!(ke.windows&&t.ctrlKey&&t.altKey)&&(O=Bo[t.keyCode])&&O!=n?(m(w[l+Om(O,t,!0)])||t.shiftKey&&(_=Wh[t.keyCode])!=n&&_!=O&&m(w[l+Om(_,t,!1)]))&&(a=!0):o&&t.shiftKey&&m(w[l+Om(n,t,!0)])&&(a=!0),!a&&m(w._any)&&(a=!0)),c&&(a=!0),a&&h&&t.stopPropagation(),J1=null,a}class kd{constructor(t,e,i,n,r){this.className=t,this.left=e,this.top=i,this.width=n,this.height=r}draw(){let t=document.createElement("div");return t.className=this.className,this.adjust(t),t}update(t,e){return e.className!=this.className?!1:(this.adjust(t),!0)}adjust(t){t.style.left=this.left+"px",t.style.top=this.top+"px",this.width!=null&&(t.style.width=this.width+"px"),t.style.height=this.height+"px"}eq(t){return this.left==t.left&&this.top==t.top&&this.width==t.width&&this.height==t.height&&this.className==t.className}static forRange(t,e,i){if(i.empty){let n=t.coordsAtPos(i.head,i.assoc||1);if(!n)return[];let r=K3(t);return[new kd(e,n.left-r.left,n.top-r.top,null,n.bottom-n.top)]}else return use(t,e,i)}}function K3(s){let t=s.scrollDOM.getBoundingClientRect();return{left:(s.textDirection==Bt.LTR?t.left:t.right-s.scrollDOM.clientWidth*s.scaleX)-s.scrollDOM.scrollLeft*s.scaleX,top:t.top-s.scrollDOM.scrollTop*s.scaleY}}function hT(s,t,e,i){let n=s.coordsAtPos(t,e*2);if(!n)return i;let r=s.dom.getBoundingClientRect(),o=(n.top+n.bottom)/2,l=s.posAtCoords({x:r.left+1,y:o}),a=s.posAtCoords({x:r.right-1,y:o});return l==null||a==null?i:{from:Math.max(i.from,Math.min(l,a)),to:Math.min(i.to,Math.max(l,a))}}function use(s,t,e){if(e.to<=s.viewport.from||e.from>=s.viewport.to)return[];let i=Math.max(e.from,s.viewport.from),n=Math.min(e.to,s.viewport.to),r=s.textDirection==Bt.LTR,o=s.contentDOM,l=o.getBoundingClientRect(),a=K3(s),c=o.querySelector(".cm-line"),h=c&&window.getComputedStyle(c),f=l.left+(h?parseInt(h.paddingLeft)+Math.min(0,parseInt(h.textIndent)):0),m=l.right-(h?parseInt(h.paddingRight):0),w=j1(s,i,1),O=j1(s,n,-1),_=w.type==sn.Text?w:null,k=O.type==sn.Text?O:null;if(_&&(s.lineWrapping||w.widgetLineBreaks)&&(_=hT(s,i,1,_)),k&&(s.lineWrapping||O.widgetLineBreaks)&&(k=hT(s,n,-1,k)),_&&k&&_.from==k.from&&_.to==k.to)return P(M(e.from,e.to,_));{let N=_?M(e.from,null,_):Q(w,!1),G=k?M(null,e.to,k):Q(O,!0),D=[];return(_||w).to<(k||O).from-(_&&k?1:0)||w.widgetLineBreaks>1&&N.bottom+s.defaultLineHeight/2<G.top?D.push(C(f,N.bottom,m,G.top)):N.bottom<G.top&&s.elementAtHeight((N.bottom+G.top)/2).type==sn.Text&&(N.bottom=G.top=(N.bottom+G.top)/2),P(N).concat(D).concat(P(G))}function C(N,G,D,b){return new kd(t,N-a.left,G-a.top,D-N,b-G)}function P({top:N,bottom:G,horizontal:D}){let b=[];for(let I=0;I<D.length;I+=2)b.push(C(D[I],N,D[I+1],G));return b}function M(N,G,D){let b=1e9,I=-1e9,B=[];function j(te,de,oe,ve,Z){let Y=s.coordsAtPos(te,te==D.to?-2:2),ie=s.coordsAtPos(oe,oe==D.from?2:-2);!Y||!ie||(b=Math.min(Y.top,ie.top,b),I=Math.max(Y.bottom,ie.bottom,I),Z==Bt.LTR?B.push(r&&de?f:Y.left,r&&ve?m:ie.right):B.push(!r&&ve?f:ie.left,!r&&de?m:Y.right))}let W=N??D.from,H=G??D.to;for(let te of s.visibleRanges)if(te.to>W&&te.from<H)for(let de=Math.max(te.from,W),oe=Math.min(te.to,H);;){let ve=s.state.doc.lineAt(de);for(let Z of s.bidiSpans(ve)){let Y=Z.from+ve.from,ie=Z.to+ve.from;if(Y>=oe)break;ie>de&&j(Math.max(Y,de),N==null&&Y<=W,Math.min(ie,oe),G==null&&ie>=H,Z.dir)}if(de=ve.to+1,de>=oe)break}return B.length==0&&j(W,N==null,H,G==null,s.textDirection),{top:b,bottom:I,horizontal:B}}function Q(N,G){let D=l.top+(G?N.top:N.bottom);return{top:D,bottom:D,horizontal:[]}}}function hse(s,t){return s.constructor==t.constructor&&s.eq(t)}class dse{constructor(t,e){this.view=t,this.layer=e,this.drawn=[],this.scaleX=1,this.scaleY=1,this.measureReq={read:this.measure.bind(this),write:this.draw.bind(this)},this.dom=t.scrollDOM.appendChild(document.createElement("div")),this.dom.classList.add("cm-layer"),e.above&&this.dom.classList.add("cm-layer-above"),e.class&&this.dom.classList.add(e.class),this.scale(),this.dom.setAttribute("aria-hidden","true"),this.setOrder(t.state),t.requestMeasure(this.measureReq),e.mount&&e.mount(this.dom,t)}update(t){t.startState.facet(Km)!=t.state.facet(Km)&&this.setOrder(t.state),(this.layer.update(t,this.dom)||t.geometryChanged)&&(this.scale(),t.view.requestMeasure(this.measureReq))}docViewUpdate(t){this.layer.updateOnDocViewUpdate!==!1&&t.requestMeasure(this.measureReq)}setOrder(t){let e=0,i=t.facet(Km);for(;e<i.length&&i[e]!=this.layer;)e++;this.dom.style.zIndex=String((this.layer.above?150:-1)-e)}measure(){return this.layer.markers(this.view)}scale(){let{scaleX:t,scaleY:e}=this.view;(t!=this.scaleX||e!=this.scaleY)&&(this.scaleX=t,this.scaleY=e,this.dom.style.transform=`scale(${1/t}, ${1/e})`)}draw(t){if(t.length!=this.drawn.length||t.some((e,i)=>!hse(e,this.drawn[i]))){let e=this.dom.firstChild,i=0;for(let n of t)n.update&&e&&n.constructor&&this.drawn[i].constructor&&n.update(e,this.drawn[i])?(e=e.nextSibling,i++):this.dom.insertBefore(n.draw(),e);for(;e;){let n=e.nextSibling;e.remove(),e=n}this.drawn=t}}destroy(){this.layer.destroy&&this.layer.destroy(this.dom,this.view),this.dom.remove()}}const Km=Pe.define();function J3(s){return[Hi.define(t=>new dse(t,s)),Km.of(s)]}const qh=Pe.define({combine(s){return Kl(s,{cursorBlinkRate:1200,drawRangeCursor:!0},{cursorBlinkRate:(t,e)=>Math.min(t,e),drawRangeCursor:(t,e)=>t||e})}});function fse(s={}){return[qh.of(s),mse,gse,pse,A3.of(!0)]}function eR(s){return s.startState.facet(qh)!=s.state.facet(qh)}const mse=J3({above:!0,markers(s){let{state:t}=s,e=t.facet(qh),i=[];for(let n of t.selection.ranges){let r=n==t.selection.main;if(n.empty||e.drawRangeCursor){let o=r?"cm-cursor cm-cursor-primary":"cm-cursor cm-cursor-secondary",l=n.empty?n:se.cursor(n.head,n.head>n.anchor?-1:1);for(let a of kd.forRange(s,o,l))i.push(a)}}return i},update(s,t){s.transactions.some(i=>i.selection)&&(t.style.animationName=t.style.animationName=="cm-blink"?"cm-blink2":"cm-blink");let e=eR(s);return e&&dT(s.state,t),s.docChanged||s.selectionSet||e},mount(s,t){dT(t.state,s)},class:"cm-cursorLayer"});function dT(s,t){t.style.animationDuration=s.facet(qh).cursorBlinkRate+"ms"}const gse=J3({above:!1,markers(s){return s.state.selection.ranges.map(t=>t.empty?[]:kd.forRange(s,"cm-selectionBackground",t)).reduce((t,e)=>t.concat(e))},update(s,t){return s.docChanged||s.selectionSet||s.viewportChanged||eR(s)},class:"cm-selectionLayer"}),pse=zo.highest(Ee.theme({".cm-line":{"& ::selection, &::selection":{backgroundColor:"transparent !important"},caretColor:"transparent !important"},".cm-content":{caretColor:"transparent !important","& :focus":{caretColor:"initial !important","&::selection, & ::selection":{backgroundColor:"Highlight !important"}}}})),tR=rt.define({map(s,t){return s==null?null:t.mapPos(s)}}),nh=Pn.define({create(){return null},update(s,t){return s!=null&&(s=t.changes.mapPos(s)),t.effects.reduce((e,i)=>i.is(tR)?i.value:e,s)}}),wse=Hi.fromClass(class{constructor(s){this.view=s,this.cursor=null,this.measureReq={read:this.readPos.bind(this),write:this.drawCursor.bind(this)}}update(s){var t;let e=s.state.field(nh);e==null?this.cursor!=null&&((t=this.cursor)===null||t===void 0||t.remove(),this.cursor=null):(this.cursor||(this.cursor=this.view.scrollDOM.appendChild(document.createElement("div")),this.cursor.className="cm-dropCursor"),(s.startState.field(nh)!=e||s.docChanged||s.geometryChanged)&&this.view.requestMeasure(this.measureReq))}readPos(){let{view:s}=this,t=s.state.field(nh),e=t!=null&&s.coordsAtPos(t);if(!e)return null;let i=s.scrollDOM.getBoundingClientRect();return{left:e.left-i.left+s.scrollDOM.scrollLeft*s.scaleX,top:e.top-i.top+s.scrollDOM.scrollTop*s.scaleY,height:e.bottom-e.top}}drawCursor(s){if(this.cursor){let{scaleX:t,scaleY:e}=this.view;s?(this.cursor.style.left=s.left/t+"px",this.cursor.style.top=s.top/e+"px",this.cursor.style.height=s.height/e+"px"):this.cursor.style.left="-100000px"}}destroy(){this.cursor&&this.cursor.remove()}setDropPos(s){this.view.state.field(nh)!=s&&this.view.dispatch({effects:tR.of(s)})}},{eventObservers:{dragover(s){this.setDropPos(this.view.posAtCoords({x:s.clientX,y:s.clientY}))},dragleave(s){(s.target==this.view.contentDOM||!this.view.contentDOM.contains(s.relatedTarget))&&this.setDropPos(null)},dragend(){this.setDropPos(null)},drop(){this.setDropPos(null)}}});function xse(){return[nh,wse]}function fT(s,t,e,i,n){t.lastIndex=0;for(let r=s.iterRange(e,i),o=e,l;!r.next().done;o+=r.value.length)if(!r.lineBreak)for(;l=t.exec(r.value);)n(o+l.index,l)}function bse(s,t){let e=s.visibleRanges;if(e.length==1&&e[0].from==s.viewport.from&&e[0].to==s.viewport.to)return e;let i=[];for(let{from:n,to:r}of e)n=Math.max(s.state.doc.lineAt(n).from,n-t),r=Math.min(s.state.doc.lineAt(r).to,r+t),i.length&&i[i.length-1].to>=n?i[i.length-1].to=r:i.push({from:n,to:r});return i}class Ose{constructor(t){const{regexp:e,decoration:i,decorate:n,boundary:r,maxLength:o=1e3}=t;if(!e.global)throw new RangeError("The regular expression given to MatchDecorator should have its 'g' flag set");if(this.regexp=e,n)this.addMatch=(l,a,c,h)=>n(h,c,c+l[0].length,l,a);else if(typeof i=="function")this.addMatch=(l,a,c,h)=>{let f=i(l,a,c);f&&h(c,c+l[0].length,f)};else if(i)this.addMatch=(l,a,c,h)=>h(c,c+l[0].length,i);else throw new RangeError("Either 'decorate' or 'decoration' should be provided to MatchDecorator");this.boundary=r,this.maxLength=o}createDeco(t){let e=new Vl,i=e.add.bind(e);for(let{from:n,to:r}of bse(t,this.maxLength))fT(t.state.doc,this.regexp,n,r,(o,l)=>this.addMatch(l,t,o,i));return e.finish()}updateDeco(t,e){let i=1e9,n=-1;return t.docChanged&&t.changes.iterChanges((r,o,l,a)=>{a>=t.view.viewport.from&&l<=t.view.viewport.to&&(i=Math.min(l,i),n=Math.max(a,n))}),t.viewportMoved||n-i>1e3?this.createDeco(t.view):n>-1?this.updateRange(t.view,e.map(t.changes),i,n):e}updateRange(t,e,i,n){for(let r of t.visibleRanges){let o=Math.max(r.from,i),l=Math.min(r.to,n);if(l>=o){let a=t.state.doc.lineAt(o),c=a.to<l?t.state.doc.lineAt(l):a,h=Math.max(r.from,a.from),f=Math.min(r.to,c.to);if(this.boundary){for(;o>a.from;o--)if(this.boundary.test(a.text[o-1-a.from])){h=o;break}for(;l<c.to;l++)if(this.boundary.test(c.text[l-c.from])){f=l;break}}let m=[],w,O=(_,k,C)=>m.push(C.range(_,k));if(a==c)for(this.regexp.lastIndex=h-a.from;(w=this.regexp.exec(a.text))&&w.index<f-a.from;)this.addMatch(w,t,w.index+a.from,O);else fT(t.state.doc,this.regexp,h,f,(_,k)=>this.addMatch(k,t,_,O));e=e.update({filterFrom:h,filterTo:f,filter:(_,k)=>_<h||k>f,add:m})}}return e}}const eO=/x/.unicode!=null?"gu":"g",yse=new RegExp(`[\0-\b
--­؜​‎‏\u2028\u2029‭‮⁦⁧⁩\uFEFF￹-￼]`,eO),vse={0:"null",7:"bell",8:"backspace",10:"newline",11:"vertical tab",13:"carriage return",27:"escape",8203:"zero width space",8204:"zero width non-joiner",8205:"zero width joiner",8206:"left-to-right mark",8207:"right-to-left mark",8232:"line separator",8237:"left-to-right override",8238:"right-to-left override",8294:"left-to-right isolate",8295:"right-to-left isolate",8297:"pop directional isolate",8233:"paragraph separator",65279:"zero width no-break space",65532:"object replacement"};let qx=null;function _se(){var s;if(qx==null&&typeof document<"u"&&document.body){let t=document.body.style;qx=((s=t.tabSize)!==null&&s!==void 0?s:t.MozTabSize)!=null}return qx||!1}const Jm=Pe.define({combine(s){let t=Kl(s,{render:null,specialChars:yse,addSpecialChars:null});return(t.replaceTabs=!_se())&&(t.specialChars=new RegExp("	|"+t.specialChars.source,eO)),t.addSpecialChars&&(t.specialChars=new RegExp(t.specialChars.source+"|"+t.addSpecialChars.source,eO)),t}});function kse(s={}){return[Jm.of(s),Sse()]}let mT=null;function Sse(){return mT||(mT=Hi.fromClass(class{constructor(s){this.view=s,this.decorations=Je.none,this.decorationCache=Object.create(null),this.decorator=this.makeDecorator(s.state.facet(Jm)),this.decorations=this.decorator.createDeco(s)}makeDecorator(s){return new Ose({regexp:s.specialChars,decoration:(t,e,i)=>{let{doc:n}=e.state,r=$n(t[0],0);if(r==9){let o=n.lineAt(i),l=e.state.tabSize,a=$s(o.text,l,i-o.from);return Je.replace({widget:new Ese((l-a%l)*this.view.defaultCharacterWidth/this.view.scaleX)})}return this.decorationCache[r]||(this.decorationCache[r]=Je.replace({widget:new Tse(s,r)}))},boundary:s.replaceTabs?void 0:/[^]/})}update(s){let t=s.state.facet(Jm);s.startState.facet(Jm)!=t?(this.decorator=this.makeDecorator(t),this.decorations=this.decorator.createDeco(s.view)):this.decorations=this.decorator.updateDeco(s,this.decorations)}},{decorations:s=>s.decorations}))}const Cse="•";function Pse(s){return s>=32?Cse:s==10?"␤":String.fromCharCode(9216+s)}class Tse extends Wo{constructor(t,e){super(),this.options=t,this.code=e}eq(t){return t.code==this.code}toDOM(t){let e=Pse(this.code),i=t.state.phrase("Control character")+" "+(vse[this.code]||"0x"+this.code.toString(16)),n=this.options.render&&this.options.render(this.code,i,e);if(n)return n;let r=document.createElement("span");return r.textContent=e,r.title=i,r.setAttribute("aria-label",i),r.className="cm-specialChar",r}ignoreEvent(){return!1}}class Ese extends Wo{constructor(t){super(),this.width=t}eq(t){return t.width==this.width}toDOM(){let t=document.createElement("span");return t.textContent="	",t.className="cm-tab",t.style.width=this.width+"px",t}ignoreEvent(){return!1}}function Ase(){return Rse}const Ise=Je.line({class:"cm-activeLine"}),Rse=Hi.fromClass(class{constructor(s){this.decorations=this.getDeco(s)}update(s){(s.docChanged||s.selectionSet)&&(this.decorations=this.getDeco(s.view))}getDeco(s){let t=-1,e=[];for(let i of s.state.selection.ranges){let n=s.lineBlockAt(i.head);n.from>t&&(e.push(Ise.range(n.from)),t=n.from)}return Je.set(e)}},{decorations:s=>s.decorations}),tO=2e3;function Vse(s,t,e){let i=Math.min(t.line,e.line),n=Math.max(t.line,e.line),r=[];if(t.off>tO||e.off>tO||t.col<0||e.col<0){let o=Math.min(t.off,e.off),l=Math.max(t.off,e.off);for(let a=i;a<=n;a++){let c=s.doc.line(a);c.length<=l&&r.push(se.range(c.from+o,c.to+l))}}else{let o=Math.min(t.col,e.col),l=Math.max(t.col,e.col);for(let a=i;a<=n;a++){let c=s.doc.line(a),h=V1(c.text,o,s.tabSize,!0);if(h<0)r.push(se.cursor(c.to));else{let f=V1(c.text,l,s.tabSize);r.push(se.range(c.from+h,c.from+f))}}}return r}function Mse(s,t){let e=s.coordsAtPos(s.viewport.from);return e?Math.round(Math.abs((e.left-t)/s.defaultCharacterWidth)):-1}function gT(s,t){let e=s.posAtCoords({x:t.clientX,y:t.clientY},!1),i=s.state.doc.lineAt(e),n=e-i.from,r=n>tO?-1:n==i.length?Mse(s,t.clientX):$s(i.text,s.state.tabSize,e-i.from);return{line:i.number,col:r,off:n}}function Lse(s,t){let e=gT(s,t),i=s.state.selection;return e?{update(n){if(n.docChanged){let r=n.changes.mapPos(n.startState.doc.line(e.line).from),o=n.state.doc.lineAt(r);e={line:o.number,col:e.col,off:Math.min(e.off,o.length)},i=i.map(n.changes)}},get(n,r,o){let l=gT(s,n);if(!l)return i;let a=Vse(s.state,e,l);return a.length?o?se.create(a.concat(i.ranges)):se.create(a):i}}:null}function Bse(s){let t=e=>e.altKey&&e.button==0;return Ee.mouseSelectionStyle.of((e,i)=>t(i)?Lse(e,i):null)}const $se={Alt:[18,s=>!!s.altKey],Control:[17,s=>!!s.ctrlKey],Shift:[16,s=>!!s.shiftKey],Meta:[91,s=>!!s.metaKey]},Dse={style:"cursor: crosshair"};function Qse(s={}){let[t,e]=$se[s.key||"Alt"],i=Hi.fromClass(class{constructor(n){this.view=n,this.isDown=!1}set(n){this.isDown!=n&&(this.isDown=n,this.view.update([]))}},{eventObservers:{keydown(n){this.set(n.keyCode==t||e(n))},keyup(n){(n.keyCode==t||!e(n))&&this.set(!1)},mousemove(n){this.set(e(n))}}});return[i,Ee.contentAttributes.of(n=>{var r;return!((r=n.plugin(i))===null||r===void 0)&&r.isDown?Dse:null})]}const Nu="-10000px";class Nse{constructor(t,e,i,n){this.facet=e,this.createTooltipView=i,this.removeTooltipView=n,this.input=t.state.facet(e),this.tooltips=this.input.filter(o=>o);let r=null;this.tooltipViews=this.tooltips.map(o=>r=i(o,r))}update(t,e){var i;let n=t.state.facet(this.facet),r=n.filter(a=>a);if(n===this.input){for(let a of this.tooltipViews)a.update&&a.update(t);return!1}let o=[],l=e?[]:null;for(let a=0;a<r.length;a++){let c=r[a],h=-1;if(c){for(let f=0;f<this.tooltips.length;f++){let m=this.tooltips[f];m&&m.create==c.create&&(h=f)}if(h<0)o[a]=this.createTooltipView(c,a?o[a-1]:null),l&&(l[a]=!!c.above);else{let f=o[a]=this.tooltipViews[h];l&&(l[a]=e[h]),f.update&&f.update(t)}}}for(let a of this.tooltipViews)o.indexOf(a)<0&&(this.removeTooltipView(a),(i=a.destroy)===null||i===void 0||i.call(a));return e&&(l.forEach((a,c)=>e[c]=a),e.length=l.length),this.input=n,this.tooltips=r,this.tooltipViews=o,!0}}function Fse(s){let t=s.dom.ownerDocument.documentElement;return{top:0,left:0,bottom:t.clientHeight,right:t.clientWidth}}const jx=Pe.define({combine:s=>{var t,e,i;return{position:ke.ios?"absolute":((t=s.find(n=>n.position))===null||t===void 0?void 0:t.position)||"fixed",parent:((e=s.find(n=>n.parent))===null||e===void 0?void 0:e.parent)||null,tooltipSpace:((i=s.find(n=>n.tooltipSpace))===null||i===void 0?void 0:i.tooltipSpace)||Fse}}}),pT=new WeakMap,iR=Hi.fromClass(class{constructor(s){this.view=s,this.above=[],this.inView=!0,this.madeAbsolute=!1,this.lastTransaction=0,this.measureTimeout=-1;let t=s.state.facet(jx);this.position=t.position,this.parent=t.parent,this.classes=s.themeClasses,this.createContainer(),this.measureReq={read:this.readMeasure.bind(this),write:this.writeMeasure.bind(this),key:this},this.resizeObserver=typeof ResizeObserver=="function"?new ResizeObserver(()=>this.measureSoon()):null,this.manager=new Nse(s,nR,(e,i)=>this.createTooltip(e,i),e=>{this.resizeObserver&&this.resizeObserver.unobserve(e.dom),e.dom.remove()}),this.above=this.manager.tooltips.map(e=>!!e.above),this.intersectionObserver=typeof IntersectionObserver=="function"?new IntersectionObserver(e=>{Date.now()>this.lastTransaction-50&&e.length>0&&e[e.length-1].intersectionRatio<1&&this.measureSoon()},{threshold:[1]}):null,this.observeIntersection(),s.win.addEventListener("resize",this.measureSoon=this.measureSoon.bind(this)),this.maybeMeasure()}createContainer(){this.parent?(this.container=document.createElement("div"),this.container.style.position="relative",this.container.className=this.view.themeClasses,this.parent.appendChild(this.container)):this.container=this.view.dom}observeIntersection(){if(this.intersectionObserver){this.intersectionObserver.disconnect();for(let s of this.manager.tooltipViews)this.intersectionObserver.observe(s.dom)}}measureSoon(){this.measureTimeout<0&&(this.measureTimeout=setTimeout(()=>{this.measureTimeout=-1,this.maybeMeasure()},50))}update(s){s.transactions.length&&(this.lastTransaction=Date.now());let t=this.manager.update(s,this.above);t&&this.observeIntersection();let e=t||s.geometryChanged,i=s.state.facet(jx);if(i.position!=this.position&&!this.madeAbsolute){this.position=i.position;for(let n of this.manager.tooltipViews)n.dom.style.position=this.position;e=!0}if(i.parent!=this.parent){this.parent&&this.container.remove(),this.parent=i.parent,this.createContainer();for(let n of this.manager.tooltipViews)this.container.appendChild(n.dom);e=!0}else this.parent&&this.view.themeClasses!=this.classes&&(this.classes=this.container.className=this.view.themeClasses);e&&this.maybeMeasure()}createTooltip(s,t){let e=s.create(this.view),i=t?t.dom:null;if(e.dom.classList.add("cm-tooltip"),s.arrow&&!e.dom.querySelector(".cm-tooltip > .cm-tooltip-arrow")){let n=document.createElement("div");n.className="cm-tooltip-arrow",e.dom.appendChild(n)}return e.dom.style.position=this.position,e.dom.style.top=Nu,e.dom.style.left="0px",this.container.insertBefore(e.dom,i),e.mount&&e.mount(this.view),this.resizeObserver&&this.resizeObserver.observe(e.dom),e}destroy(){var s,t,e;this.view.win.removeEventListener("resize",this.measureSoon);for(let i of this.manager.tooltipViews)i.dom.remove(),(s=i.destroy)===null||s===void 0||s.call(i);this.parent&&this.container.remove(),(t=this.resizeObserver)===null||t===void 0||t.disconnect(),(e=this.intersectionObserver)===null||e===void 0||e.disconnect(),clearTimeout(this.measureTimeout)}readMeasure(){let s=1,t=1,e=!1;if(this.position=="fixed"&&this.manager.tooltipViews.length){let{dom:r}=this.manager.tooltipViews[0];if(ke.gecko)e=r.offsetParent!=this.container.ownerDocument.body;else if(r.style.top==Nu&&r.style.left=="0px"){let o=r.getBoundingClientRect();e=Math.abs(o.top+1e4)>1||Math.abs(o.left)>1}}if(e||this.position=="absolute")if(this.parent){let r=this.parent.getBoundingClientRect();r.width&&r.height&&(s=r.width/this.parent.offsetWidth,t=r.height/this.parent.offsetHeight)}else({scaleX:s,scaleY:t}=this.view.viewState);let i=this.view.scrollDOM.getBoundingClientRect(),n=jy(this.view);return{visible:{left:i.left+n.left,top:i.top+n.top,right:i.right-n.right,bottom:i.bottom-n.bottom},parent:this.parent?this.container.getBoundingClientRect():this.view.dom.getBoundingClientRect(),pos:this.manager.tooltips.map((r,o)=>{let l=this.manager.tooltipViews[o];return l.getCoords?l.getCoords(r.pos):this.view.coordsAtPos(r.pos)}),size:this.manager.tooltipViews.map(({dom:r})=>r.getBoundingClientRect()),space:this.view.state.facet(jx).tooltipSpace(this.view),scaleX:s,scaleY:t,makeAbsolute:e}}writeMeasure(s){var t;if(s.makeAbsolute){this.madeAbsolute=!0,this.position="absolute";for(let l of this.manager.tooltipViews)l.dom.style.position="absolute"}let{visible:e,space:i,scaleX:n,scaleY:r}=s,o=[];for(let l=0;l<this.manager.tooltips.length;l++){let a=this.manager.tooltips[l],c=this.manager.tooltipViews[l],{dom:h}=c,f=s.pos[l],m=s.size[l];if(!f||a.clip!==!1&&(f.bottom<=Math.max(e.top,i.top)||f.top>=Math.min(e.bottom,i.bottom)||f.right<Math.max(e.left,i.left)-.1||f.left>Math.min(e.right,i.right)+.1)){h.style.top=Nu;continue}let w=a.arrow?c.dom.querySelector(".cm-tooltip-arrow"):null,O=w?7:0,_=m.right-m.left,k=(t=pT.get(c))!==null&&t!==void 0?t:m.bottom-m.top,C=c.offset||Wse,P=this.view.textDirection==Bt.LTR,M=m.width>i.right-i.left?P?i.left:i.right-m.width:P?Math.max(i.left,Math.min(f.left-(w?14:0)+C.x,i.right-_)):Math.min(Math.max(i.left,f.left-_+(w?14:0)-C.x),i.right-_),Q=this.above[l];!a.strictSide&&(Q?f.top-k-O-C.y<i.top:f.bottom+k+O+C.y>i.bottom)&&Q==i.bottom-f.bottom>f.top-i.top&&(Q=this.above[l]=!Q);let N=(Q?f.top-i.top:i.bottom-f.bottom)-O;if(N<k&&c.resize!==!1){if(N<this.view.defaultLineHeight){h.style.top=Nu;continue}pT.set(c,k),h.style.height=(k=N)/r+"px"}else h.style.height&&(h.style.height="");let G=Q?f.top-k-O-C.y:f.bottom+O+C.y,D=M+_;if(c.overlap!==!0)for(let b of o)b.left<D&&b.right>M&&b.top<G+k&&b.bottom>G&&(G=Q?b.top-k-2-O:b.bottom+O+2);if(this.position=="absolute"?(h.style.top=(G-s.parent.top)/r+"px",wT(h,(M-s.parent.left)/n)):(h.style.top=G/r+"px",wT(h,M/n)),w){let b=f.left+(P?C.x:-C.x)-(M+14-7);w.style.left=b/n+"px"}c.overlap!==!0&&o.push({left:M,top:G,right:D,bottom:G+k}),h.classList.toggle("cm-tooltip-above",Q),h.classList.toggle("cm-tooltip-below",!Q),c.positioned&&c.positioned(s.space)}}maybeMeasure(){if(this.manager.tooltips.length&&(this.view.inView&&this.view.requestMeasure(this.measureReq),this.inView!=this.view.inView&&(this.inView=this.view.inView,!this.inView)))for(let s of this.manager.tooltipViews)s.dom.style.top=Nu}},{eventObservers:{scroll(){this.maybeMeasure()}}});function wT(s,t){let e=parseInt(s.style.left,10);(isNaN(e)||Math.abs(t-e)>1)&&(s.style.left=t+"px")}const zse=Ee.baseTheme({".cm-tooltip":{zIndex:500,boxSizing:"border-box"},"&light .cm-tooltip":{border:"1px solid #bbb",backgroundColor:"#f5f5f5"},"&light .cm-tooltip-section:not(:first-child)":{borderTop:"1px solid #bbb"},"&dark .cm-tooltip":{backgroundColor:"#333338",color:"white"},".cm-tooltip-arrow":{height:"7px",width:`${7*2}px`,position:"absolute",zIndex:-1,overflow:"hidden","&:before, &:after":{content:"''",position:"absolute",width:0,height:0,borderLeft:"7px solid transparent",borderRight:"7px solid transparent"},".cm-tooltip-above &":{bottom:"-7px","&:before":{borderTop:"7px solid #bbb"},"&:after":{borderTop:"7px solid #f5f5f5",bottom:"1px"}},".cm-tooltip-below &":{top:"-7px","&:before":{borderBottom:"7px solid #bbb"},"&:after":{borderBottom:"7px solid #f5f5f5",top:"1px"}}},"&dark .cm-tooltip .cm-tooltip-arrow":{"&:before":{borderTopColor:"#333338",borderBottomColor:"#333338"},"&:after":{borderTopColor:"transparent",borderBottomColor:"transparent"}}}),Wse={x:0,y:0},nR=Pe.define({enables:[iR,zse]});function sR(s,t){let e=s.plugin(iR);if(!e)return null;let i=e.manager.tooltips.indexOf(t);return i<0?null:e.manager.tooltipViews[i]}class Qr extends Rl{compare(t){return this==t||this.constructor==t.constructor&&this.eq(t)}eq(t){return!1}destroy(t){}}Qr.prototype.elementClass="";Qr.prototype.toDOM=void 0;Qr.prototype.mapMode=Wi.TrackBefore;Qr.prototype.startSide=Qr.prototype.endSide=-1;Qr.prototype.point=!0;const eg=Pe.define(),Use=Pe.define(),Zse={class:"",renderEmptyElements:!1,elementStyle:"",markers:()=>st.empty,lineMarker:()=>null,widgetMarker:()=>null,lineMarkerChange:null,initialSpacer:null,updateSpacer:null,domEventHandlers:{},side:"before"},Oh=Pe.define();function Hse(s){return[rR(),Oh.of({...Zse,...s})]}const xT=Pe.define({combine:s=>s.some(t=>t)});function rR(s){return[qse]}const qse=Hi.fromClass(class{constructor(s){this.view=s,this.domAfter=null,this.prevViewport=s.viewport,this.dom=document.createElement("div"),this.dom.className="cm-gutters cm-gutters-before",this.dom.setAttribute("aria-hidden","true"),this.dom.style.minHeight=this.view.contentHeight/this.view.scaleY+"px",this.gutters=s.state.facet(Oh).map(t=>new OT(s,t)),this.fixed=!s.state.facet(xT);for(let t of this.gutters)t.config.side=="after"?this.getDOMAfter().appendChild(t.dom):this.dom.appendChild(t.dom);this.fixed&&(this.dom.style.position="sticky"),this.syncGutters(!1),s.scrollDOM.insertBefore(this.dom,s.contentDOM)}getDOMAfter(){return this.domAfter||(this.domAfter=document.createElement("div"),this.domAfter.className="cm-gutters cm-gutters-after",this.domAfter.setAttribute("aria-hidden","true"),this.domAfter.style.minHeight=this.view.contentHeight/this.view.scaleY+"px",this.domAfter.style.position=this.fixed?"sticky":"",this.view.scrollDOM.appendChild(this.domAfter)),this.domAfter}update(s){if(this.updateGutters(s)){let t=this.prevViewport,e=s.view.viewport,i=Math.min(t.to,e.to)-Math.max(t.from,e.from);this.syncGutters(i<(e.to-e.from)*.8)}if(s.geometryChanged){let t=this.view.contentHeight/this.view.scaleY+"px";this.dom.style.minHeight=t,this.domAfter&&(this.domAfter.style.minHeight=t)}this.view.state.facet(xT)!=!this.fixed&&(this.fixed=!this.fixed,this.dom.style.position=this.fixed?"sticky":"",this.domAfter&&(this.domAfter.style.position=this.fixed?"sticky":"")),this.prevViewport=s.view.viewport}syncGutters(s){let t=this.dom.nextSibling;s&&(this.dom.remove(),this.domAfter&&this.domAfter.remove());let e=st.iter(this.view.state.facet(eg),this.view.viewport.from),i=[],n=this.gutters.map(r=>new jse(r,this.view.viewport,-this.view.documentPadding.top));for(let r of this.view.viewportLineBlocks)if(i.length&&(i=[]),Array.isArray(r.type)){let o=!0;for(let l of r.type)if(l.type==sn.Text&&o){iO(e,i,l.from);for(let a of n)a.line(this.view,l,i);o=!1}else if(l.widget)for(let a of n)a.widget(this.view,l)}else if(r.type==sn.Text){iO(e,i,r.from);for(let o of n)o.line(this.view,r,i)}else if(r.widget)for(let o of n)o.widget(this.view,r);for(let r of n)r.finish();s&&(this.view.scrollDOM.insertBefore(this.dom,t),this.domAfter&&this.view.scrollDOM.appendChild(this.domAfter))}updateGutters(s){let t=s.startState.facet(Oh),e=s.state.facet(Oh),i=s.docChanged||s.heightChanged||s.viewportChanged||!st.eq(s.startState.facet(eg),s.state.facet(eg),s.view.viewport.from,s.view.viewport.to);if(t==e)for(let n of this.gutters)n.update(s)&&(i=!0);else{i=!0;let n=[];for(let r of e){let o=t.indexOf(r);o<0?n.push(new OT(this.view,r)):(this.gutters[o].update(s),n.push(this.gutters[o]))}for(let r of this.gutters)r.dom.remove(),n.indexOf(r)<0&&r.destroy();for(let r of n)r.config.side=="after"?this.getDOMAfter().appendChild(r.dom):this.dom.appendChild(r.dom);this.gutters=n}return i}destroy(){for(let s of this.gutters)s.destroy();this.dom.remove(),this.domAfter&&this.domAfter.remove()}},{provide:s=>Ee.scrollMargins.of(t=>{let e=t.plugin(s);if(!e||e.gutters.length==0||!e.fixed)return null;let i=e.dom.offsetWidth*t.scaleX,n=e.domAfter?e.domAfter.offsetWidth*t.scaleX:0;return t.textDirection==Bt.LTR?{left:i,right:n}:{right:i,left:n}})});function bT(s){return Array.isArray(s)?s:[s]}function iO(s,t,e){for(;s.value&&s.from<=e;)s.from==e&&t.push(s.value),s.next()}class jse{constructor(t,e,i){this.gutter=t,this.height=i,this.i=0,this.cursor=st.iter(t.markers,e.from)}addElement(t,e,i){let{gutter:n}=this,r=(e.top-this.height)/t.scaleY,o=e.height/t.scaleY;if(this.i==n.elements.length){let l=new oR(t,o,r,i);n.elements.push(l),n.dom.appendChild(l.dom)}else n.elements[this.i].update(t,o,r,i);this.height=e.bottom,this.i++}line(t,e,i){let n=[];iO(this.cursor,n,e.from),i.length&&(n=n.concat(i));let r=this.gutter.config.lineMarker(t,e,n);r&&n.unshift(r);let o=this.gutter;n.length==0&&!o.config.renderEmptyElements||this.addElement(t,e,n)}widget(t,e){let i=this.gutter.config.widgetMarker(t,e.widget,e),n=i?[i]:null;for(let r of t.state.facet(Use)){let o=r(t,e.widget,e);o&&(n||(n=[])).push(o)}n&&this.addElement(t,e,n)}finish(){let t=this.gutter;for(;t.elements.length>this.i;){let e=t.elements.pop();t.dom.removeChild(e.dom),e.destroy()}}}class OT{constructor(t,e){this.view=t,this.config=e,this.elements=[],this.spacer=null,this.dom=document.createElement("div"),this.dom.className="cm-gutter"+(this.config.class?" "+this.config.class:"");for(let i in e.domEventHandlers)this.dom.addEventListener(i,n=>{let r=n.target,o;if(r!=this.dom&&this.dom.contains(r)){for(;r.parentNode!=this.dom;)r=r.parentNode;let a=r.getBoundingClientRect();o=(a.top+a.bottom)/2}else o=n.clientY;let l=t.lineBlockAtHeight(o-t.documentTop);e.domEventHandlers[i](t,l,n)&&n.preventDefault()});this.markers=bT(e.markers(t)),e.initialSpacer&&(this.spacer=new oR(t,0,0,[e.initialSpacer(t)]),this.dom.appendChild(this.spacer.dom),this.spacer.dom.style.cssText+="visibility: hidden; pointer-events: none")}update(t){let e=this.markers;if(this.markers=bT(this.config.markers(t.view)),this.spacer&&this.config.updateSpacer){let n=this.config.updateSpacer(this.spacer.markers[0],t);n!=this.spacer.markers[0]&&this.spacer.update(t.view,0,0,[n])}let i=t.view.viewport;return!st.eq(this.markers,e,i.from,i.to)||(this.config.lineMarkerChange?this.config.lineMarkerChange(t):!1)}destroy(){for(let t of this.elements)t.destroy()}}class oR{constructor(t,e,i,n){this.height=-1,this.above=0,this.markers=[],this.dom=document.createElement("div"),this.dom.className="cm-gutterElement",this.update(t,e,i,n)}update(t,e,i,n){this.height!=e&&(this.height=e,this.dom.style.height=e+"px"),this.above!=i&&(this.dom.style.marginTop=(this.above=i)?i+"px":""),Xse(this.markers,n)||this.setMarkers(t,n)}setMarkers(t,e){let i="cm-gutterElement",n=this.dom.firstChild;for(let r=0,o=0;;){let l=o,a=r<e.length?e[r++]:null,c=!1;if(a){let h=a.elementClass;h&&(i+=" "+h);for(let f=o;f<this.markers.length;f++)if(this.markers[f].compare(a)){l=f,c=!0;break}}else l=this.markers.length;for(;o<l;){let h=this.markers[o++];if(h.toDOM){h.destroy(n);let f=n.nextSibling;n.remove(),n=f}}if(!a)break;a.toDOM&&(c?n=n.nextSibling:this.dom.insertBefore(a.toDOM(t),n)),c&&o++}this.dom.className=i,this.markers=e}destroy(){this.setMarkers(null,[])}}function Xse(s,t){if(s.length!=t.length)return!1;for(let e=0;e<s.length;e++)if(!s[e].compare(t[e]))return!1;return!0}const Gse=Pe.define(),Yse=Pe.define(),Ya=Pe.define({combine(s){return Kl(s,{formatNumber:String,domEventHandlers:{}},{domEventHandlers(t,e){let i=Object.assign({},t);for(let n in e){let r=i[n],o=e[n];i[n]=r?(l,a,c)=>r(l,a,c)||o(l,a,c):o}return i}})}});class Xx extends Qr{constructor(t){super(),this.number=t}eq(t){return this.number==t.number}toDOM(){return document.createTextNode(this.number)}}function Gx(s,t){return s.state.facet(Ya).formatNumber(t,s.state)}const Kse=Oh.compute([Ya],s=>({class:"cm-lineNumbers",renderEmptyElements:!1,markers(t){return t.state.facet(Gse)},lineMarker(t,e,i){return i.some(n=>n.toDOM)?null:new Xx(Gx(t,t.state.doc.lineAt(e.from).number))},widgetMarker:(t,e,i)=>{for(let n of t.state.facet(Yse)){let r=n(t,e,i);if(r)return r}return null},lineMarkerChange:t=>t.startState.facet(Ya)!=t.state.facet(Ya),initialSpacer(t){return new Xx(Gx(t,yT(t.state.doc.lines)))},updateSpacer(t,e){let i=Gx(e.view,yT(e.view.state.doc.lines));return i==t.number?t:new Xx(i)},domEventHandlers:s.facet(Ya).domEventHandlers,side:"before"}));function Jse(s={}){return[Ya.of(s),rR(),Kse]}function yT(s){let t=9;for(;t<s;)t=t*10+9;return t}const ere=new class extends Qr{constructor(){super(...arguments),this.elementClass="cm-activeLineGutter"}},tre=eg.compute(["selection"],s=>{let t=[],e=-1;for(let i of s.selection.ranges){let n=s.doc.lineAt(i.head).from;n>e&&(e=n,t.push(ere.range(n)))}return st.of(t)});function ire(){return tre}const lR=1024;let nre=0;class rs{constructor(t,e){this.from=t,this.to=e}}class Fe{constructor(t={}){this.id=nre++,this.perNode=!!t.perNode,this.deserialize=t.deserialize||(()=>{throw new Error("This node type doesn't define a deserialize function")})}add(t){if(this.perNode)throw new RangeError("Can't add per-node props to node types");return typeof t!="function"&&(t=hi.match(t)),e=>{let i=t(e);return i===void 0?null:[this,i]}}}Fe.closedBy=new Fe({deserialize:s=>s.split(" ")});Fe.openedBy=new Fe({deserialize:s=>s.split(" ")});Fe.group=new Fe({deserialize:s=>s.split(" ")});Fe.isolate=new Fe({deserialize:s=>{if(s&&s!="rtl"&&s!="ltr"&&s!="auto")throw new RangeError("Invalid value for isolate: "+s);return s||"auto"}});Fe.contextHash=new Fe({perNode:!0});Fe.lookAhead=new Fe({perNode:!0});Fe.mounted=new Fe({perNode:!0});class jh{constructor(t,e,i){this.tree=t,this.overlay=e,this.parser=i}static get(t){return t&&t.props&&t.props[Fe.mounted.id]}}const sre=Object.create(null);class hi{constructor(t,e,i,n=0){this.name=t,this.props=e,this.id=i,this.flags=n}static define(t){let e=t.props&&t.props.length?Object.create(null):sre,i=(t.top?1:0)|(t.skipped?2:0)|(t.error?4:0)|(t.name==null?8:0),n=new hi(t.name||"",e,t.id,i);if(t.props){for(let r of t.props)if(Array.isArray(r)||(r=r(n)),r){if(r[0].perNode)throw new RangeError("Can't store a per-node prop on a node type");e[r[0].id]=r[1]}}return n}prop(t){return this.props[t.id]}get isTop(){return(this.flags&1)>0}get isSkipped(){return(this.flags&2)>0}get isError(){return(this.flags&4)>0}get isAnonymous(){return(this.flags&8)>0}is(t){if(typeof t=="string"){if(this.name==t)return!0;let e=this.prop(Fe.group);return e?e.indexOf(t)>-1:!1}return this.id==t}static match(t){let e=Object.create(null);for(let i in t)for(let n of i.split(" "))e[n]=t[i];return i=>{for(let n=i.prop(Fe.group),r=-1;r<(n?n.length:0);r++){let o=e[r<0?i.name:n[r]];if(o)return o}}}}hi.none=new hi("",Object.create(null),0,8);class Sd{constructor(t){this.types=t;for(let e=0;e<t.length;e++)if(t[e].id!=e)throw new RangeError("Node type ids should correspond to array positions when creating a node set")}extend(...t){let e=[];for(let i of this.types){let n=null;for(let r of t){let o=r(i);o&&(n||(n=Object.assign({},i.props)),n[o[0].id]=o[1])}e.push(n?new hi(i.name,n,i.id,i.flags):i)}return new Sd(e)}}const ym=new WeakMap,vT=new WeakMap;var kt;(function(s){s[s.ExcludeBuffers=1]="ExcludeBuffers",s[s.IncludeAnonymous=2]="IncludeAnonymous",s[s.IgnoreMounts=4]="IgnoreMounts",s[s.IgnoreOverlays=8]="IgnoreOverlays"})(kt||(kt={}));class gt{constructor(t,e,i,n,r){if(this.type=t,this.children=e,this.positions=i,this.length=n,this.props=null,r&&r.length){this.props=Object.create(null);for(let[o,l]of r)this.props[typeof o=="number"?o:o.id]=l}}toString(){let t=jh.get(this);if(t&&!t.overlay)return t.tree.toString();let e="";for(let i of this.children){let n=i.toString();n&&(e&&(e+=","),e+=n)}return this.type.name?(/\W/.test(this.type.name)&&!this.type.isError?JSON.stringify(this.type.name):this.type.name)+(e.length?"("+e+")":""):e}cursor(t=0){return new Gg(this.topNode,t)}cursorAt(t,e=0,i=0){let n=ym.get(this)||this.topNode,r=new Gg(n);return r.moveTo(t,e),ym.set(this,r._tree),r}get topNode(){return new Zi(this,0,0,null)}resolve(t,e=0){let i=Xh(ym.get(this)||this.topNode,t,e,!1);return ym.set(this,i),i}resolveInner(t,e=0){let i=Xh(vT.get(this)||this.topNode,t,e,!0);return vT.set(this,i),i}resolveStack(t,e=0){return lre(this,t,e)}iterate(t){let{enter:e,leave:i,from:n=0,to:r=this.length}=t,o=t.mode||0,l=(o&kt.IncludeAnonymous)>0;for(let a=this.cursor(o|kt.IncludeAnonymous);;){let c=!1;if(a.from<=r&&a.to>=n&&(!l&&a.type.isAnonymous||e(a)!==!1)){if(a.firstChild())continue;c=!0}for(;c&&i&&(l||!a.type.isAnonymous)&&i(a),!a.nextSibling();){if(!a.parent())return;c=!0}}}prop(t){return t.perNode?this.props?this.props[t.id]:void 0:this.type.prop(t)}get propValues(){let t=[];if(this.props)for(let e in this.props)t.push([+e,this.props[e]]);return t}balance(t={}){return this.children.length<=8?this:ev(hi.none,this.children,this.positions,0,this.children.length,0,this.length,(e,i,n)=>new gt(this.type,e,i,n,this.propValues),t.makeTree||((e,i,n)=>new gt(hi.none,e,i,n)))}static build(t){return are(t)}}gt.empty=new gt(hi.none,[],[],0);class Ky{constructor(t,e){this.buffer=t,this.index=e}get id(){return this.buffer[this.index-4]}get start(){return this.buffer[this.index-3]}get end(){return this.buffer[this.index-2]}get size(){return this.buffer[this.index-1]}get pos(){return this.index}next(){this.index-=4}fork(){return new Ky(this.buffer,this.index)}}class Do{constructor(t,e,i){this.buffer=t,this.length=e,this.set=i}get type(){return hi.none}toString(){let t=[];for(let e=0;e<this.buffer.length;)t.push(this.childString(e)),e=this.buffer[e+3];return t.join(",")}childString(t){let e=this.buffer[t],i=this.buffer[t+3],n=this.set.types[e],r=n.name;if(/\W/.test(r)&&!n.isError&&(r=JSON.stringify(r)),t+=4,i==t)return r;let o=[];for(;t<i;)o.push(this.childString(t)),t=this.buffer[t+3];return r+"("+o.join(",")+")"}findChild(t,e,i,n,r){let{buffer:o}=this,l=-1;for(let a=t;a!=e&&!(aR(r,n,o[a+1],o[a+2])&&(l=a,i>0));a=o[a+3]);return l}slice(t,e,i){let n=this.buffer,r=new Uint16Array(e-t),o=0;for(let l=t,a=0;l<e;){r[a++]=n[l++],r[a++]=n[l++]-i;let c=r[a++]=n[l++]-i;r[a++]=n[l++]-t,o=Math.max(o,c)}return new Do(r,o,this.set)}}function aR(s,t,e,i){switch(s){case-2:return e<t;case-1:return i>=t&&e<t;case 0:return e<t&&i>t;case 1:return e<=t&&i>t;case 2:return i>t;case 4:return!0}}function Xh(s,t,e,i){for(var n;s.from==s.to||(e<1?s.from>=t:s.from>t)||(e>-1?s.to<=t:s.to<t);){let o=!i&&s instanceof Zi&&s.index<0?null:s.parent;if(!o)return s;s=o}let r=i?0:kt.IgnoreOverlays;if(i)for(let o=s,l=o.parent;l;o=l,l=o.parent)o instanceof Zi&&o.index<0&&((n=l.enter(t,e,r))===null||n===void 0?void 0:n.from)!=o.from&&(s=l);for(;;){let o=s.enter(t,e,r);if(!o)return s;s=o}}class cR{cursor(t=0){return new Gg(this,t)}getChild(t,e=null,i=null){let n=_T(this,t,e,i);return n.length?n[0]:null}getChildren(t,e=null,i=null){return _T(this,t,e,i)}resolve(t,e=0){return Xh(this,t,e,!1)}resolveInner(t,e=0){return Xh(this,t,e,!0)}matchContext(t){return nO(this.parent,t)}enterUnfinishedNodesBefore(t){let e=this.childBefore(t),i=this;for(;e;){let n=e.lastChild;if(!n||n.to!=e.to)break;n.type.isError&&n.from==n.to?(i=e,e=n.prevSibling):e=n}return i}get node(){return this}get next(){return this.parent}}class Zi extends cR{constructor(t,e,i,n){super(),this._tree=t,this.from=e,this.index=i,this._parent=n}get type(){return this._tree.type}get name(){return this._tree.type.name}get to(){return this.from+this._tree.length}nextChild(t,e,i,n,r=0){for(let o=this;;){for(let{children:l,positions:a}=o._tree,c=e>0?l.length:-1;t!=c;t+=e){let h=l[t],f=a[t]+o.from;if(aR(n,i,f,f+h.length)){if(h instanceof Do){if(r&kt.ExcludeBuffers)continue;let m=h.findChild(0,h.buffer.length,e,i-f,n);if(m>-1)return new ir(new rre(o,h,t,f),null,m)}else if(r&kt.IncludeAnonymous||!h.type.isAnonymous||Jy(h)){let m;if(!(r&kt.IgnoreMounts)&&(m=jh.get(h))&&!m.overlay)return new Zi(m.tree,f,t,o);let w=new Zi(h,f,t,o);return r&kt.IncludeAnonymous||!w.type.isAnonymous?w:w.nextChild(e<0?h.children.length-1:0,e,i,n)}}}if(r&kt.IncludeAnonymous||!o.type.isAnonymous||(o.index>=0?t=o.index+e:t=e<0?-1:o._parent._tree.children.length,o=o._parent,!o))return null}}get firstChild(){return this.nextChild(0,1,0,4)}get lastChild(){return this.nextChild(this._tree.children.length-1,-1,0,4)}childAfter(t){return this.nextChild(0,1,t,2)}childBefore(t){return this.nextChild(this._tree.children.length-1,-1,t,-2)}enter(t,e,i=0){let n;if(!(i&kt.IgnoreOverlays)&&(n=jh.get(this._tree))&&n.overlay){let r=t-this.from;for(let{from:o,to:l}of n.overlay)if((e>0?o<=r:o<r)&&(e<0?l>=r:l>r))return new Zi(n.tree,n.overlay[0].from+this.from,-1,this)}return this.nextChild(0,1,t,e,i)}nextSignificantParent(){let t=this;for(;t.type.isAnonymous&&t._parent;)t=t._parent;return t}get parent(){return this._parent?this._parent.nextSignificantParent():null}get nextSibling(){return this._parent&&this.index>=0?this._parent.nextChild(this.index+1,1,0,4):null}get prevSibling(){return this._parent&&this.index>=0?this._parent.nextChild(this.index-1,-1,0,4):null}get tree(){return this._tree}toTree(){return this._tree}toString(){return this._tree.toString()}}function _T(s,t,e,i){let n=s.cursor(),r=[];if(!n.firstChild())return r;if(e!=null){for(let o=!1;!o;)if(o=n.type.is(e),!n.nextSibling())return r}for(;;){if(i!=null&&n.type.is(i))return r;if(n.type.is(t)&&r.push(n.node),!n.nextSibling())return i==null?r:[]}}function nO(s,t,e=t.length-1){for(let i=s;e>=0;i=i.parent){if(!i)return!1;if(!i.type.isAnonymous){if(t[e]&&t[e]!=i.name)return!1;e--}}return!0}class rre{constructor(t,e,i,n){this.parent=t,this.buffer=e,this.index=i,this.start=n}}class ir extends cR{get name(){return this.type.name}get from(){return this.context.start+this.context.buffer.buffer[this.index+1]}get to(){return this.context.start+this.context.buffer.buffer[this.index+2]}constructor(t,e,i){super(),this.context=t,this._parent=e,this.index=i,this.type=t.buffer.set.types[t.buffer.buffer[i]]}child(t,e,i){let{buffer:n}=this.context,r=n.findChild(this.index+4,n.buffer[this.index+3],t,e-this.context.start,i);return r<0?null:new ir(this.context,this,r)}get firstChild(){return this.child(1,0,4)}get lastChild(){return this.child(-1,0,4)}childAfter(t){return this.child(1,t,2)}childBefore(t){return this.child(-1,t,-2)}enter(t,e,i=0){if(i&kt.ExcludeBuffers)return null;let{buffer:n}=this.context,r=n.findChild(this.index+4,n.buffer[this.index+3],e>0?1:-1,t-this.context.start,e);return r<0?null:new ir(this.context,this,r)}get parent(){return this._parent||this.context.parent.nextSignificantParent()}externalSibling(t){return this._parent?null:this.context.parent.nextChild(this.context.index+t,t,0,4)}get nextSibling(){let{buffer:t}=this.context,e=t.buffer[this.index+3];return e<(this._parent?t.buffer[this._parent.index+3]:t.buffer.length)?new ir(this.context,this._parent,e):this.externalSibling(1)}get prevSibling(){let{buffer:t}=this.context,e=this._parent?this._parent.index+4:0;return this.index==e?this.externalSibling(-1):new ir(this.context,this._parent,t.findChild(e,this.index,-1,0,4))}get tree(){return null}toTree(){let t=[],e=[],{buffer:i}=this.context,n=this.index+4,r=i.buffer[this.index+3];if(r>n){let o=i.buffer[this.index+1];t.push(i.slice(n,r,o)),e.push(0)}return new gt(this.type,t,e,this.to-this.from)}toString(){return this.context.buffer.childString(this.index)}}function uR(s){if(!s.length)return null;let t=0,e=s[0];for(let r=1;r<s.length;r++){let o=s[r];(o.from>e.from||o.to<e.to)&&(e=o,t=r)}let i=e instanceof Zi&&e.index<0?null:e.parent,n=s.slice();return i?n[t]=i:n.splice(t,1),new ore(n,e)}class ore{constructor(t,e){this.heads=t,this.node=e}get next(){return uR(this.heads)}}function lre(s,t,e){let i=s.resolveInner(t,e),n=null;for(let r=i instanceof Zi?i:i.context.parent;r;r=r.parent)if(r.index<0){let o=r.parent;(n||(n=[i])).push(o.resolve(t,e)),r=o}else{let o=jh.get(r.tree);if(o&&o.overlay&&o.overlay[0].from<=t&&o.overlay[o.overlay.length-1].to>=t){let l=new Zi(o.tree,o.overlay[0].from+r.from,-1,r);(n||(n=[i])).push(Xh(l,t,e,!1))}}return n?uR(n):i}class Gg{get name(){return this.type.name}constructor(t,e=0){if(this.mode=e,this.buffer=null,this.stack=[],this.index=0,this.bufferNode=null,t instanceof Zi)this.yieldNode(t);else{this._tree=t.context.parent,this.buffer=t.context;for(let i=t._parent;i;i=i._parent)this.stack.unshift(i.index);this.bufferNode=t,this.yieldBuf(t.index)}}yieldNode(t){return t?(this._tree=t,this.type=t.type,this.from=t.from,this.to=t.to,!0):!1}yieldBuf(t,e){this.index=t;let{start:i,buffer:n}=this.buffer;return this.type=e||n.set.types[n.buffer[t]],this.from=i+n.buffer[t+1],this.to=i+n.buffer[t+2],!0}yield(t){return t?t instanceof Zi?(this.buffer=null,this.yieldNode(t)):(this.buffer=t.context,this.yieldBuf(t.index,t.type)):!1}toString(){return this.buffer?this.buffer.buffer.childString(this.index):this._tree.toString()}enterChild(t,e,i){if(!this.buffer)return this.yield(this._tree.nextChild(t<0?this._tree._tree.children.length-1:0,t,e,i,this.mode));let{buffer:n}=this.buffer,r=n.findChild(this.index+4,n.buffer[this.index+3],t,e-this.buffer.start,i);return r<0?!1:(this.stack.push(this.index),this.yieldBuf(r))}firstChild(){return this.enterChild(1,0,4)}lastChild(){return this.enterChild(-1,0,4)}childAfter(t){return this.enterChild(1,t,2)}childBefore(t){return this.enterChild(-1,t,-2)}enter(t,e,i=this.mode){return this.buffer?i&kt.ExcludeBuffers?!1:this.enterChild(1,t,e):this.yield(this._tree.enter(t,e,i))}parent(){if(!this.buffer)return this.yieldNode(this.mode&kt.IncludeAnonymous?this._tree._parent:this._tree.parent);if(this.stack.length)return this.yieldBuf(this.stack.pop());let t=this.mode&kt.IncludeAnonymous?this.buffer.parent:this.buffer.parent.nextSignificantParent();return this.buffer=null,this.yieldNode(t)}sibling(t){if(!this.buffer)return this._tree._parent?this.yield(this._tree.index<0?null:this._tree._parent.nextChild(this._tree.index+t,t,0,4,this.mode)):!1;let{buffer:e}=this.buffer,i=this.stack.length-1;if(t<0){let n=i<0?0:this.stack[i]+4;if(this.index!=n)return this.yieldBuf(e.findChild(n,this.index,-1,0,4))}else{let n=e.buffer[this.index+3];if(n<(i<0?e.buffer.length:e.buffer[this.stack[i]+3]))return this.yieldBuf(n)}return i<0?this.yield(this.buffer.parent.nextChild(this.buffer.index+t,t,0,4,this.mode)):!1}nextSibling(){return this.sibling(1)}prevSibling(){return this.sibling(-1)}atLastNode(t){let e,i,{buffer:n}=this;if(n){if(t>0){if(this.index<n.buffer.buffer.length)return!1}else for(let r=0;r<this.index;r++)if(n.buffer.buffer[r+3]<this.index)return!1;({index:e,parent:i}=n)}else({index:e,_parent:i}=this._tree);for(;i;{index:e,_parent:i}=i)if(e>-1)for(let r=e+t,o=t<0?-1:i._tree.children.length;r!=o;r+=t){let l=i._tree.children[r];if(this.mode&kt.IncludeAnonymous||l instanceof Do||!l.type.isAnonymous||Jy(l))return!1}return!0}move(t,e){if(e&&this.enterChild(t,0,4))return!0;for(;;){if(this.sibling(t))return!0;if(this.atLastNode(t)||!this.parent())return!1}}next(t=!0){return this.move(1,t)}prev(t=!0){return this.move(-1,t)}moveTo(t,e=0){for(;(this.from==this.to||(e<1?this.from>=t:this.from>t)||(e>-1?this.to<=t:this.to<t))&&this.parent(););for(;this.enterChild(1,t,e););return this}get node(){if(!this.buffer)return this._tree;let t=this.bufferNode,e=null,i=0;if(t&&t.context==this.buffer)e:for(let n=this.index,r=this.stack.length;r>=0;){for(let o=t;o;o=o._parent)if(o.index==n){if(n==this.index)return o;e=o,i=r+1;break e}n=this.stack[--r]}for(let n=i;n<this.stack.length;n++)e=new ir(this.buffer,e,this.stack[n]);return this.bufferNode=new ir(this.buffer,e,this.index)}get tree(){return this.buffer?null:this._tree._tree}iterate(t,e){for(let i=0;;){let n=!1;if(this.type.isAnonymous||t(this)!==!1){if(this.firstChild()){i++;continue}this.type.isAnonymous||(n=!0)}for(;;){if(n&&e&&e(this),n=this.type.isAnonymous,!i)return;if(this.nextSibling())break;this.parent(),i--,n=!0}}}matchContext(t){if(!this.buffer)return nO(this.node.parent,t);let{buffer:e}=this.buffer,{types:i}=e.set;for(let n=t.length-1,r=this.stack.length-1;n>=0;r--){if(r<0)return nO(this._tree,t,n);let o=i[e.buffer[this.stack[r]]];if(!o.isAnonymous){if(t[n]&&t[n]!=o.name)return!1;n--}}return!0}}function Jy(s){return s.children.some(t=>t instanceof Do||!t.type.isAnonymous||Jy(t))}function are(s){var t;let{buffer:e,nodeSet:i,maxBufferLength:n=lR,reused:r=[],minRepeatType:o=i.types.length}=s,l=Array.isArray(e)?new Ky(e,e.length):e,a=i.types,c=0,h=0;function f(N,G,D,b,I,B){let{id:j,start:W,end:H,size:te}=l,de=h,oe=c;for(;te<0;)if(l.next(),te==-1){let V=r[j];D.push(V),b.push(W-N);return}else if(te==-3){c=j;return}else if(te==-4){h=j;return}else throw new RangeError(`Unrecognized record size: ${te}`);let ve=a[j],Z,Y,ie=W-N;if(H-W<=n&&(Y=k(l.pos-G,I))){let V=new Uint16Array(Y.size-Y.skip),J=l.pos-Y.size,ae=V.length;for(;l.pos>J;)ae=C(Y.start,V,ae);Z=new Do(V,H-Y.start,i),ie=Y.start-N}else{let V=l.pos-te;l.next();let J=[],ae=[],U=j>=o?j:-1,$=0,ee=H;for(;l.pos>V;)U>=0&&l.id==U&&l.size>=0?(l.end<=ee-n&&(O(J,ae,W,$,l.end,ee,U,de,oe),$=J.length,ee=l.end),l.next()):B>2500?m(W,V,J,ae):f(W,V,J,ae,U,B+1);if(U>=0&&$>0&&$<J.length&&O(J,ae,W,$,W,ee,U,de,oe),J.reverse(),ae.reverse(),U>-1&&$>0){let pe=w(ve,oe);Z=ev(ve,J,ae,0,J.length,0,H-W,pe,pe)}else Z=_(ve,J,ae,H-W,de-H,oe)}D.push(Z),b.push(ie)}function m(N,G,D,b){let I=[],B=0,j=-1;for(;l.pos>G;){let{id:W,start:H,end:te,size:de}=l;if(de>4)l.next();else{if(j>-1&&H<j)break;j<0&&(j=te-n),I.push(W,H,te),B++,l.next()}}if(B){let W=new Uint16Array(B*4),H=I[I.length-2];for(let te=I.length-3,de=0;te>=0;te-=3)W[de++]=I[te],W[de++]=I[te+1]-H,W[de++]=I[te+2]-H,W[de++]=de;D.push(new Do(W,I[2]-H,i)),b.push(H-N)}}function w(N,G){return(D,b,I)=>{let B=0,j=D.length-1,W,H;if(j>=0&&(W=D[j])instanceof gt){if(!j&&W.type==N&&W.length==I)return W;(H=W.prop(Fe.lookAhead))&&(B=b[j]+W.length+H)}return _(N,D,b,I,B,G)}}function O(N,G,D,b,I,B,j,W,H){let te=[],de=[];for(;N.length>b;)te.push(N.pop()),de.push(G.pop()+D-I);N.push(_(i.types[j],te,de,B-I,W-B,H)),G.push(I-D)}function _(N,G,D,b,I,B,j){if(B){let W=[Fe.contextHash,B];j=j?[W].concat(j):[W]}if(I>25){let W=[Fe.lookAhead,I];j=j?[W].concat(j):[W]}return new gt(N,G,D,b,j)}function k(N,G){let D=l.fork(),b=0,I=0,B=0,j=D.end-n,W={size:0,start:0,skip:0};e:for(let H=D.pos-N;D.pos>H;){let te=D.size;if(D.id==G&&te>=0){W.size=b,W.start=I,W.skip=B,B+=4,b+=4,D.next();continue}let de=D.pos-te;if(te<0||de<H||D.start<j)break;let oe=D.id>=o?4:0,ve=D.start;for(D.next();D.pos>de;){if(D.size<0)if(D.size==-3)oe+=4;else break e;else D.id>=o&&(oe+=4);D.next()}I=ve,b+=te,B+=oe}return(G<0||b==N)&&(W.size=b,W.start=I,W.skip=B),W.size>4?W:void 0}function C(N,G,D){let{id:b,start:I,end:B,size:j}=l;if(l.next(),j>=0&&b<o){let W=D;if(j>4){let H=l.pos-(j-4);for(;l.pos>H;)D=C(N,G,D)}G[--D]=W,G[--D]=B-N,G[--D]=I-N,G[--D]=b}else j==-3?c=b:j==-4&&(h=b);return D}let P=[],M=[];for(;l.pos>0;)f(s.start||0,s.bufferStart||0,P,M,-1,0);let Q=(t=s.length)!==null&&t!==void 0?t:P.length?M[0]+P[0].length:0;return new gt(a[s.topID],P.reverse(),M.reverse(),Q)}const kT=new WeakMap;function tg(s,t){if(!s.isAnonymous||t instanceof Do||t.type!=s)return 1;let e=kT.get(t);if(e==null){e=1;for(let i of t.children){if(i.type!=s||!(i instanceof gt)){e=1;break}e+=tg(s,i)}kT.set(t,e)}return e}function ev(s,t,e,i,n,r,o,l,a){let c=0;for(let O=i;O<n;O++)c+=tg(s,t[O]);let h=Math.ceil(c*1.5/8),f=[],m=[];function w(O,_,k,C,P){for(let M=k;M<C;){let Q=M,N=_[M],G=tg(s,O[M]);for(M++;M<C;M++){let D=tg(s,O[M]);if(G+D>=h)break;G+=D}if(M==Q+1){if(G>h){let D=O[Q];w(D.children,D.positions,0,D.children.length,_[Q]+P);continue}f.push(O[Q])}else{let D=_[M-1]+O[M-1].length-N;f.push(ev(s,O,_,Q,M,N,D,null,a))}m.push(N+P-r)}}return w(t,e,i,n,0),(l||a)(f,m,o)}class hR{constructor(){this.map=new WeakMap}setBuffer(t,e,i){let n=this.map.get(t);n||this.map.set(t,n=new Map),n.set(e,i)}getBuffer(t,e){let i=this.map.get(t);return i&&i.get(e)}set(t,e){t instanceof ir?this.setBuffer(t.context.buffer,t.index,e):t instanceof Zi&&this.map.set(t.tree,e)}get(t){return t instanceof ir?this.getBuffer(t.context.buffer,t.index):t instanceof Zi?this.map.get(t.tree):void 0}cursorSet(t,e){t.buffer?this.setBuffer(t.buffer.buffer,t.index,e):this.map.set(t.tree,e)}cursorGet(t){return t.buffer?this.getBuffer(t.buffer.buffer,t.index):this.map.get(t.tree)}}class Mr{constructor(t,e,i,n,r=!1,o=!1){this.from=t,this.to=e,this.tree=i,this.offset=n,this.open=(r?1:0)|(o?2:0)}get openStart(){return(this.open&1)>0}get openEnd(){return(this.open&2)>0}static addTree(t,e=[],i=!1){let n=[new Mr(0,t.length,t,0,!1,i)];for(let r of e)r.to>t.length&&n.push(r);return n}static applyChanges(t,e,i=128){if(!e.length)return t;let n=[],r=1,o=t.length?t[0]:null;for(let l=0,a=0,c=0;;l++){let h=l<e.length?e[l]:null,f=h?h.fromA:1e9;if(f-a>=i)for(;o&&o.from<f;){let m=o;if(a>=m.from||f<=m.to||c){let w=Math.max(m.from,a)-c,O=Math.min(m.to,f)-c;m=w>=O?null:new Mr(w,O,m.tree,m.offset+c,l>0,!!h)}if(m&&n.push(m),o.to>f)break;o=r<t.length?t[r++]:null}if(!h)break;a=h.toA,c=h.toA-h.toB}return n}}class tv{startParse(t,e,i){return typeof t=="string"&&(t=new cre(t)),i=i?i.length?i.map(n=>new rs(n.from,n.to)):[new rs(0,0)]:[new rs(0,t.length)],this.createParse(t,e||[],i)}parse(t,e,i){let n=this.startParse(t,e,i);for(;;){let r=n.advance();if(r)return r}}}class cre{constructor(t){this.string=t}get length(){return this.string.length}chunk(t){return this.string.slice(t)}get lineChunks(){return!1}read(t,e){return this.string.slice(t,e)}}function dR(s){return(t,e,i,n)=>new hre(t,s,e,i,n)}class ST{constructor(t,e,i,n,r){this.parser=t,this.parse=e,this.overlay=i,this.target=n,this.from=r}}function CT(s){if(!s.length||s.some(t=>t.from>=t.to))throw new RangeError("Invalid inner parse ranges given: "+JSON.stringify(s))}class ure{constructor(t,e,i,n,r,o,l){this.parser=t,this.predicate=e,this.mounts=i,this.index=n,this.start=r,this.target=o,this.prev=l,this.depth=0,this.ranges=[]}}const sO=new Fe({perNode:!0});class hre{constructor(t,e,i,n,r){this.nest=e,this.input=i,this.fragments=n,this.ranges=r,this.inner=[],this.innerDone=0,this.baseTree=null,this.stoppedAt=null,this.baseParse=t}advance(){if(this.baseParse){let i=this.baseParse.advance();if(!i)return null;if(this.baseParse=null,this.baseTree=i,this.startInner(),this.stoppedAt!=null)for(let n of this.inner)n.parse.stopAt(this.stoppedAt)}if(this.innerDone==this.inner.length){let i=this.baseTree;return this.stoppedAt!=null&&(i=new gt(i.type,i.children,i.positions,i.length,i.propValues.concat([[sO,this.stoppedAt]]))),i}let t=this.inner[this.innerDone],e=t.parse.advance();if(e){this.innerDone++;let i=Object.assign(Object.create(null),t.target.props);i[Fe.mounted.id]=new jh(e,t.overlay,t.parser),t.target.props=i}return null}get parsedPos(){if(this.baseParse)return 0;let t=this.input.length;for(let e=this.innerDone;e<this.inner.length;e++)this.inner[e].from<t&&(t=Math.min(t,this.inner[e].parse.parsedPos));return t}stopAt(t){if(this.stoppedAt=t,this.baseParse)this.baseParse.stopAt(t);else for(let e=this.innerDone;e<this.inner.length;e++)this.inner[e].parse.stopAt(t)}startInner(){let t=new mre(this.fragments),e=null,i=null,n=new Gg(new Zi(this.baseTree,this.ranges[0].from,0,null),kt.IncludeAnonymous|kt.IgnoreMounts);e:for(let r,o;;){let l=!0,a;if(this.stoppedAt!=null&&n.from>=this.stoppedAt)l=!1;else if(t.hasNode(n)){if(e){let c=e.mounts.find(h=>h.frag.from<=n.from&&h.frag.to>=n.to&&h.mount.overlay);if(c)for(let h of c.mount.overlay){let f=h.from+c.pos,m=h.to+c.pos;f>=n.from&&m<=n.to&&!e.ranges.some(w=>w.from<m&&w.to>f)&&e.ranges.push({from:f,to:m})}}l=!1}else if(i&&(o=dre(i.ranges,n.from,n.to)))l=o!=2;else if(!n.type.isAnonymous&&(r=this.nest(n,this.input))&&(n.from<n.to||!r.overlay)){n.tree||fre(n);let c=t.findMounts(n.from,r.parser);if(typeof r.overlay=="function")e=new ure(r.parser,r.overlay,c,this.inner.length,n.from,n.tree,e);else{let h=ET(this.ranges,r.overlay||(n.from<n.to?[new rs(n.from,n.to)]:[]));h.length&&CT(h),(h.length||!r.overlay)&&this.inner.push(new ST(r.parser,h.length?r.parser.startParse(this.input,AT(c,h),h):r.parser.startParse(""),r.overlay?r.overlay.map(f=>new rs(f.from-n.from,f.to-n.from)):null,n.tree,h.length?h[0].from:n.from)),r.overlay?h.length&&(i={ranges:h,depth:0,prev:i}):l=!1}}else if(e&&(a=e.predicate(n))&&(a===!0&&(a=new rs(n.from,n.to)),a.from<a.to)){let c=e.ranges.length-1;c>=0&&e.ranges[c].to==a.from?e.ranges[c]={from:e.ranges[c].from,to:a.to}:e.ranges.push(a)}if(l&&n.firstChild())e&&e.depth++,i&&i.depth++;else for(;!n.nextSibling();){if(!n.parent())break e;if(e&&!--e.depth){let c=ET(this.ranges,e.ranges);c.length&&(CT(c),this.inner.splice(e.index,0,new ST(e.parser,e.parser.startParse(this.input,AT(e.mounts,c),c),e.ranges.map(h=>new rs(h.from-e.start,h.to-e.start)),e.target,c[0].from))),e=e.prev}i&&!--i.depth&&(i=i.prev)}}}}function dre(s,t,e){for(let i of s){if(i.from>=e)break;if(i.to>t)return i.from<=t&&i.to>=e?2:1}return 0}function PT(s,t,e,i,n,r){if(t<e){let o=s.buffer[t+1];i.push(s.slice(t,e,o)),n.push(o-r)}}function fre(s){let{node:t}=s,e=[],i=t.context.buffer;do e.push(s.index),s.parent();while(!s.tree);let n=s.tree,r=n.children.indexOf(i),o=n.children[r],l=o.buffer,a=[r];function c(h,f,m,w,O,_){let k=e[_],C=[],P=[];PT(o,h,k,C,P,w);let M=l[k+1],Q=l[k+2];a.push(C.length);let N=_?c(k+4,l[k+3],o.set.types[l[k]],M,Q-M,_-1):t.toTree();return C.push(N),P.push(M-w),PT(o,l[k+3],f,C,P,w),new gt(m,C,P,O)}n.children[r]=c(0,l.length,hi.none,0,o.length,e.length-1);for(let h of a){let f=s.tree.children[h],m=s.tree.positions[h];s.yield(new Zi(f,m+s.from,h,s._tree))}}class TT{constructor(t,e){this.offset=e,this.done=!1,this.cursor=t.cursor(kt.IncludeAnonymous|kt.IgnoreMounts)}moveTo(t){let{cursor:e}=this,i=t-this.offset;for(;!this.done&&e.from<i;)e.to>=t&&e.enter(i,1,kt.IgnoreOverlays|kt.ExcludeBuffers)||e.next(!1)||(this.done=!0)}hasNode(t){if(this.moveTo(t.from),!this.done&&this.cursor.from+this.offset==t.from&&this.cursor.tree)for(let e=this.cursor.tree;;){if(e==t.tree)return!0;if(e.children.length&&e.positions[0]==0&&e.children[0]instanceof gt)e=e.children[0];else break}return!1}}let mre=class{constructor(t){var e;if(this.fragments=t,this.curTo=0,this.fragI=0,t.length){let i=this.curFrag=t[0];this.curTo=(e=i.tree.prop(sO))!==null&&e!==void 0?e:i.to,this.inner=new TT(i.tree,-i.offset)}else this.curFrag=this.inner=null}hasNode(t){for(;this.curFrag&&t.from>=this.curTo;)this.nextFrag();return this.curFrag&&this.curFrag.from<=t.from&&this.curTo>=t.to&&this.inner.hasNode(t)}nextFrag(){var t;if(this.fragI++,this.fragI==this.fragments.length)this.curFrag=this.inner=null;else{let e=this.curFrag=this.fragments[this.fragI];this.curTo=(t=e.tree.prop(sO))!==null&&t!==void 0?t:e.to,this.inner=new TT(e.tree,-e.offset)}}findMounts(t,e){var i;let n=[];if(this.inner){this.inner.cursor.moveTo(t,1);for(let r=this.inner.cursor.node;r;r=r.parent){let o=(i=r.tree)===null||i===void 0?void 0:i.prop(Fe.mounted);if(o&&o.parser==e)for(let l=this.fragI;l<this.fragments.length;l++){let a=this.fragments[l];if(a.from>=r.to)break;a.tree==this.curFrag.tree&&n.push({frag:a,pos:r.from-a.offset,mount:o})}}}return n}};function ET(s,t){let e=null,i=t;for(let n=1,r=0;n<s.length;n++){let o=s[n-1].to,l=s[n].from;for(;r<i.length;r++){let a=i[r];if(a.from>=l)break;a.to<=o||(e||(i=e=t.slice()),a.from<o?(e[r]=new rs(a.from,o),a.to>l&&e.splice(r+1,0,new rs(l,a.to))):a.to>l?e[r--]=new rs(l,a.to):e.splice(r--,1))}}return i}function gre(s,t,e,i){let n=0,r=0,o=!1,l=!1,a=-1e9,c=[];for(;;){let h=n==s.length?1e9:o?s[n].to:s[n].from,f=r==t.length?1e9:l?t[r].to:t[r].from;if(o!=l){let m=Math.max(a,e),w=Math.min(h,f,i);m<w&&c.push(new rs(m,w))}if(a=Math.min(h,f),a==1e9)break;h==a&&(o?(o=!1,n++):o=!0),f==a&&(l?(l=!1,r++):l=!0)}return c}function AT(s,t){let e=[];for(let{pos:i,mount:n,frag:r}of s){let o=i+(n.overlay?n.overlay[0].from:0),l=o+n.tree.length,a=Math.max(r.from,o),c=Math.min(r.to,l);if(n.overlay){let h=n.overlay.map(m=>new rs(m.from+i,m.to+i)),f=gre(t,h,a,c);for(let m=0,w=a;;m++){let O=m==f.length,_=O?c:f[m].from;if(_>w&&e.push(new Mr(w,_,n.tree,-o,r.from>=w||r.openStart,r.to<=_||r.openEnd)),O)break;w=f[m].to}}else e.push(new Mr(a,c,n.tree,-o,r.from>=o||r.openStart,r.to<=l||r.openEnd))}return e}let pre=0;class Dn{constructor(t,e,i,n){this.name=t,this.set=e,this.base=i,this.modified=n,this.id=pre++}toString(){let{name:t}=this;for(let e of this.modified)e.name&&(t=`${e.name}(${t})`);return t}static define(t,e){let i=typeof t=="string"?t:"?";if(t instanceof Dn&&(e=t),e!=null&&e.base)throw new Error("Can not derive from a modified tag");let n=new Dn(i,[],null,[]);if(n.set.push(n),e)for(let r of e.set)n.set.push(r);return n}static defineModifier(t){let e=new Yg(t);return i=>i.modified.indexOf(e)>-1?i:Yg.get(i.base||i,i.modified.concat(e).sort((n,r)=>n.id-r.id))}}let wre=0;class Yg{constructor(t){this.name=t,this.instances=[],this.id=wre++}static get(t,e){if(!e.length)return t;let i=e[0].instances.find(l=>l.base==t&&xre(e,l.modified));if(i)return i;let n=[],r=new Dn(t.name,n,t,e);for(let l of e)l.instances.push(r);let o=bre(e);for(let l of t.set)if(!l.modified.length)for(let a of o)n.push(Yg.get(l,a));return r}}function xre(s,t){return s.length==t.length&&s.every((e,i)=>e==t[i])}function bre(s){let t=[[]];for(let e=0;e<s.length;e++)for(let i=0,n=t.length;i<n;i++)t.push(t[i].concat(s[e]));return t.sort((e,i)=>i.length-e.length)}function Bc(s){let t=Object.create(null);for(let e in s){let i=s[e];Array.isArray(i)||(i=[i]);for(let n of e.split(" "))if(n){let r=[],o=2,l=n;for(let f=0;;){if(l=="..."&&f>0&&f+3==n.length){o=1;break}let m=/^"(?:[^"\\]|\\.)*?"|[^\/!]+/.exec(l);if(!m)throw new RangeError("Invalid path: "+n);if(r.push(m[0]=="*"?"":m[0][0]=='"'?JSON.parse(m[0]):m[0]),f+=m[0].length,f==n.length)break;let w=n[f++];if(f==n.length&&w=="!"){o=0;break}if(w!="/")throw new RangeError("Invalid path: "+n);l=n.slice(f)}let a=r.length-1,c=r[a];if(!c)throw new RangeError("Invalid path: "+n);let h=new Kg(i,o,a>0?r.slice(0,a):null);t[c]=h.sort(t[c])}}return fR.add(t)}const fR=new Fe;class Kg{constructor(t,e,i,n){this.tags=t,this.mode=e,this.context=i,this.next=n}get opaque(){return this.mode==0}get inherit(){return this.mode==1}sort(t){return!t||t.depth<this.depth?(this.next=t,this):(t.next=this.sort(t.next),t)}get depth(){return this.context?this.context.length:0}}Kg.empty=new Kg([],2,null);function mR(s,t){let e=Object.create(null);for(let r of s)if(!Array.isArray(r.tag))e[r.tag.id]=r.class;else for(let o of r.tag)e[o.id]=r.class;let{scope:i,all:n=null}=t||{};return{style:r=>{let o=n;for(let l of r)for(let a of l.set){let c=e[a.id];if(c){o=o?o+" "+c:c;break}}return o},scope:i}}function Ore(s,t){let e=null;for(let i of s){let n=i.style(t);n&&(e=e?e+" "+n:n)}return e}function yre(s,t,e,i=0,n=s.length){let r=new vre(i,Array.isArray(t)?t:[t],e);r.highlightRange(s.cursor(),i,n,"",r.highlighters),r.flush(n)}class vre{constructor(t,e,i){this.at=t,this.highlighters=e,this.span=i,this.class=""}startSpan(t,e){e!=this.class&&(this.flush(t),t>this.at&&(this.at=t),this.class=e)}flush(t){t>this.at&&this.class&&this.span(this.at,t,this.class)}highlightRange(t,e,i,n,r){let{type:o,from:l,to:a}=t;if(l>=i||a<=e)return;o.isTop&&(r=this.highlighters.filter(w=>!w.scope||w.scope(o)));let c=n,h=_re(t)||Kg.empty,f=Ore(r,h.tags);if(f&&(c&&(c+=" "),c+=f,h.mode==1&&(n+=(n?" ":"")+f)),this.startSpan(Math.max(e,l),c),h.opaque)return;let m=t.tree&&t.tree.prop(Fe.mounted);if(m&&m.overlay){let w=t.node.enter(m.overlay[0].from+l,1),O=this.highlighters.filter(k=>!k.scope||k.scope(m.tree.type)),_=t.firstChild();for(let k=0,C=l;;k++){let P=k<m.overlay.length?m.overlay[k]:null,M=P?P.from+l:a,Q=Math.max(e,C),N=Math.min(i,M);if(Q<N&&_)for(;t.from<N&&(this.highlightRange(t,Q,N,n,r),this.startSpan(Math.min(N,t.to),c),!(t.to>=M||!t.nextSibling())););if(!P||M>i)break;C=P.to+l,C>e&&(this.highlightRange(w.cursor(),Math.max(e,P.from+l),Math.min(i,C),"",O),this.startSpan(Math.min(i,C),c))}_&&t.parent()}else if(t.firstChild()){m&&(n="");do if(!(t.to<=e)){if(t.from>=i)break;this.highlightRange(t,e,i,n,r),this.startSpan(Math.min(i,t.to),c)}while(t.nextSibling());t.parent()}}}function _re(s){let t=s.type.prop(fR);for(;t&&t.context&&!s.matchContext(t.context);)t=t.next;return t||null}const Oe=Dn.define,vm=Oe(),wo=Oe(),IT=Oe(wo),RT=Oe(wo),xo=Oe(),_m=Oe(xo),Yx=Oe(xo),Ks=Oe(),hl=Oe(Ks),Gs=Oe(),Ys=Oe(),rO=Oe(),Fu=Oe(rO),km=Oe(),T={comment:vm,lineComment:Oe(vm),blockComment:Oe(vm),docComment:Oe(vm),name:wo,variableName:Oe(wo),typeName:IT,tagName:Oe(IT),propertyName:RT,attributeName:Oe(RT),className:Oe(wo),labelName:Oe(wo),namespace:Oe(wo),macroName:Oe(wo),literal:xo,string:_m,docString:Oe(_m),character:Oe(_m),attributeValue:Oe(_m),number:Yx,integer:Oe(Yx),float:Oe(Yx),bool:Oe(xo),regexp:Oe(xo),escape:Oe(xo),color:Oe(xo),url:Oe(xo),keyword:Gs,self:Oe(Gs),null:Oe(Gs),atom:Oe(Gs),unit:Oe(Gs),modifier:Oe(Gs),operatorKeyword:Oe(Gs),controlKeyword:Oe(Gs),definitionKeyword:Oe(Gs),moduleKeyword:Oe(Gs),operator:Ys,derefOperator:Oe(Ys),arithmeticOperator:Oe(Ys),logicOperator:Oe(Ys),bitwiseOperator:Oe(Ys),compareOperator:Oe(Ys),updateOperator:Oe(Ys),definitionOperator:Oe(Ys),typeOperator:Oe(Ys),controlOperator:Oe(Ys),punctuation:rO,separator:Oe(rO),bracket:Fu,angleBracket:Oe(Fu),squareBracket:Oe(Fu),paren:Oe(Fu),brace:Oe(Fu),content:Ks,heading:hl,heading1:Oe(hl),heading2:Oe(hl),heading3:Oe(hl),heading4:Oe(hl),heading5:Oe(hl),heading6:Oe(hl),contentSeparator:Oe(Ks),list:Oe(Ks),quote:Oe(Ks),emphasis:Oe(Ks),strong:Oe(Ks),link:Oe(Ks),monospace:Oe(Ks),strikethrough:Oe(Ks),inserted:Oe(),deleted:Oe(),changed:Oe(),invalid:Oe(),meta:km,documentMeta:Oe(km),annotation:Oe(km),processingInstruction:Oe(km),definition:Dn.defineModifier("definition"),constant:Dn.defineModifier("constant"),function:Dn.defineModifier("function"),standard:Dn.defineModifier("standard"),local:Dn.defineModifier("local"),special:Dn.defineModifier("special")};for(let s in T){let t=T[s];t instanceof Dn&&(t.name=s)}mR([{tag:T.link,class:"tok-link"},{tag:T.heading,class:"tok-heading"},{tag:T.emphasis,class:"tok-emphasis"},{tag:T.strong,class:"tok-strong"},{tag:T.keyword,class:"tok-keyword"},{tag:T.atom,class:"tok-atom"},{tag:T.bool,class:"tok-bool"},{tag:T.url,class:"tok-url"},{tag:T.labelName,class:"tok-labelName"},{tag:T.inserted,class:"tok-inserted"},{tag:T.deleted,class:"tok-deleted"},{tag:T.literal,class:"tok-literal"},{tag:T.string,class:"tok-string"},{tag:T.number,class:"tok-number"},{tag:[T.regexp,T.escape,T.special(T.string)],class:"tok-string2"},{tag:T.variableName,class:"tok-variableName"},{tag:T.local(T.variableName),class:"tok-variableName tok-local"},{tag:T.definition(T.variableName),class:"tok-variableName tok-definition"},{tag:T.special(T.variableName),class:"tok-variableName2"},{tag:T.definition(T.propertyName),class:"tok-propertyName tok-definition"},{tag:T.typeName,class:"tok-typeName"},{tag:T.namespace,class:"tok-namespace"},{tag:T.className,class:"tok-className"},{tag:T.macroName,class:"tok-macroName"},{tag:T.propertyName,class:"tok-propertyName"},{tag:T.operator,class:"tok-operator"},{tag:T.comment,class:"tok-comment"},{tag:T.meta,class:"tok-meta"},{tag:T.invalid,class:"tok-invalid"},{tag:T.punctuation,class:"tok-punctuation"}]);var Kx;const Ol=new Fe;function iv(s){return Pe.define({combine:s?t=>t.concat(s):void 0})}const nv=new Fe;class os{constructor(t,e,i=[],n=""){this.data=t,this.name=n,ht.prototype.hasOwnProperty("tree")||Object.defineProperty(ht.prototype,"tree",{get(){return St(this)}}),this.parser=e,this.extension=[Qo.of(this),ht.languageData.of((r,o,l)=>{let a=VT(r,o,l),c=a.type.prop(Ol);if(!c)return[];let h=r.facet(c),f=a.type.prop(nv);if(f){let m=a.resolve(o-a.from,l);for(let w of f)if(w.test(m,r)){let O=r.facet(w.facet);return w.type=="replace"?O:O.concat(h)}}return h})].concat(i)}isActiveAt(t,e,i=-1){return VT(t,e,i).type.prop(Ol)==this.data}findRegions(t){let e=t.facet(Qo);if((e==null?void 0:e.data)==this.data)return[{from:0,to:t.doc.length}];if(!e||!e.allowsNesting)return[];let i=[],n=(r,o)=>{if(r.prop(Ol)==this.data){i.push({from:o,to:o+r.length});return}let l=r.prop(Fe.mounted);if(l){if(l.tree.prop(Ol)==this.data){if(l.overlay)for(let a of l.overlay)i.push({from:a.from+o,to:a.to+o});else i.push({from:o,to:o+r.length});return}else if(l.overlay){let a=i.length;if(n(l.tree,l.overlay[0].from+o),i.length>a)return}}for(let a=0;a<r.children.length;a++){let c=r.children[a];c instanceof gt&&n(c,r.positions[a]+o)}};return n(St(t),0),i}get allowsNesting(){return!0}}os.setState=rt.define();function VT(s,t,e){let i=s.facet(Qo),n=St(s).topNode;if(!i||i.allowsNesting)for(let r=n;r;r=r.enter(t,e,kt.ExcludeBuffers))r.type.isTop&&(n=r);return n}class _c extends os{constructor(t,e,i){super(t,e,[],i),this.parser=e}static define(t){let e=iv(t.languageData);return new _c(e,t.parser.configure({props:[Ol.add(i=>i.isTop?e:void 0)]}),t.name)}configure(t,e){return new _c(this.data,this.parser.configure(t),e||this.name)}get allowsNesting(){return this.parser.hasWrappers()}}function St(s){let t=s.field(os.state,!1);return t?t.tree:gt.empty}class kre{constructor(t){this.doc=t,this.cursorPos=0,this.string="",this.cursor=t.iter()}get length(){return this.doc.length}syncTo(t){return this.string=this.cursor.next(t-this.cursorPos).value,this.cursorPos=t+this.string.length,this.cursorPos-this.string.length}chunk(t){return this.syncTo(t),this.string}get lineChunks(){return!0}read(t,e){let i=this.cursorPos-this.string.length;return t<i||e>=this.cursorPos?this.doc.sliceString(t,e):this.string.slice(t-i,e-i)}}let zu=null;class Gh{constructor(t,e,i=[],n,r,o,l,a){this.parser=t,this.state=e,this.fragments=i,this.tree=n,this.treeLen=r,this.viewport=o,this.skipped=l,this.scheduleOn=a,this.parse=null,this.tempSkipped=[]}static create(t,e,i){return new Gh(t,e,[],gt.empty,0,i,[],null)}startParse(){return this.parser.startParse(new kre(this.state.doc),this.fragments)}work(t,e){return e!=null&&e>=this.state.doc.length&&(e=void 0),this.tree!=gt.empty&&this.isDone(e??this.state.doc.length)?(this.takeTree(),!0):this.withContext(()=>{var i;if(typeof t=="number"){let n=Date.now()+t;t=()=>Date.now()>n}for(this.parse||(this.parse=this.startParse()),e!=null&&(this.parse.stoppedAt==null||this.parse.stoppedAt>e)&&e<this.state.doc.length&&this.parse.stopAt(e);;){let n=this.parse.advance();if(n)if(this.fragments=this.withoutTempSkipped(Mr.addTree(n,this.fragments,this.parse.stoppedAt!=null)),this.treeLen=(i=this.parse.stoppedAt)!==null&&i!==void 0?i:this.state.doc.length,this.tree=n,this.parse=null,this.treeLen<(e??this.state.doc.length))this.parse=this.startParse();else return!0;if(t())return!1}})}takeTree(){let t,e;this.parse&&(t=this.parse.parsedPos)>=this.treeLen&&((this.parse.stoppedAt==null||this.parse.stoppedAt>t)&&this.parse.stopAt(t),this.withContext(()=>{for(;!(e=this.parse.advance()););}),this.treeLen=t,this.tree=e,this.fragments=this.withoutTempSkipped(Mr.addTree(this.tree,this.fragments,!0)),this.parse=null)}withContext(t){let e=zu;zu=this;try{return t()}finally{zu=e}}withoutTempSkipped(t){for(let e;e=this.tempSkipped.pop();)t=MT(t,e.from,e.to);return t}changes(t,e){let{fragments:i,tree:n,treeLen:r,viewport:o,skipped:l}=this;if(this.takeTree(),!t.empty){let a=[];if(t.iterChangedRanges((c,h,f,m)=>a.push({fromA:c,toA:h,fromB:f,toB:m})),i=Mr.applyChanges(i,a),n=gt.empty,r=0,o={from:t.mapPos(o.from,-1),to:t.mapPos(o.to,1)},this.skipped.length){l=[];for(let c of this.skipped){let h=t.mapPos(c.from,1),f=t.mapPos(c.to,-1);h<f&&l.push({from:h,to:f})}}}return new Gh(this.parser,e,i,n,r,o,l,this.scheduleOn)}updateViewport(t){if(this.viewport.from==t.from&&this.viewport.to==t.to)return!1;this.viewport=t;let e=this.skipped.length;for(let i=0;i<this.skipped.length;i++){let{from:n,to:r}=this.skipped[i];n<t.to&&r>t.from&&(this.fragments=MT(this.fragments,n,r),this.skipped.splice(i--,1))}return this.skipped.length>=e?!1:(this.reset(),!0)}reset(){this.parse&&(this.takeTree(),this.parse=null)}skipUntilInView(t,e){this.skipped.push({from:t,to:e})}static getSkippingParser(t){return new class extends tv{createParse(e,i,n){let r=n[0].from,o=n[n.length-1].to;return{parsedPos:r,advance(){let a=zu;if(a){for(let c of n)a.tempSkipped.push(c);t&&(a.scheduleOn=a.scheduleOn?Promise.all([a.scheduleOn,t]):t)}return this.parsedPos=o,new gt(hi.none,[],[],o-r)},stoppedAt:null,stopAt(){}}}}}isDone(t){t=Math.min(t,this.state.doc.length);let e=this.fragments;return this.treeLen>=t&&e.length&&e[0].from==0&&e[0].to>=t}static get(){return zu}}function MT(s,t,e){return Mr.applyChanges(s,[{fromA:t,toA:e,fromB:t,toB:e}])}class kc{constructor(t){this.context=t,this.tree=t.tree}apply(t){if(!t.docChanged&&this.tree==this.context.tree)return this;let e=this.context.changes(t.changes,t.state),i=this.context.treeLen==t.startState.doc.length?void 0:Math.max(t.changes.mapPos(this.context.treeLen),e.viewport.to);return e.work(20,i)||e.takeTree(),new kc(e)}static init(t){let e=Math.min(3e3,t.doc.length),i=Gh.create(t.facet(Qo).parser,t,{from:0,to:e});return i.work(20,e)||i.takeTree(),new kc(i)}}os.state=Pn.define({create:kc.init,update(s,t){for(let e of t.effects)if(e.is(os.setState))return e.value;return t.startState.facet(Qo)!=t.state.facet(Qo)?kc.init(t.state):s.apply(t)}});let gR=s=>{let t=setTimeout(()=>s(),500);return()=>clearTimeout(t)};typeof requestIdleCallback<"u"&&(gR=s=>{let t=-1,e=setTimeout(()=>{t=requestIdleCallback(s,{timeout:400})},100);return()=>t<0?clearTimeout(e):cancelIdleCallback(t)});const Jx=typeof navigator<"u"&&(!((Kx=navigator.scheduling)===null||Kx===void 0)&&Kx.isInputPending)?()=>navigator.scheduling.isInputPending():null,Sre=Hi.fromClass(class{constructor(t){this.view=t,this.working=null,this.workScheduled=0,this.chunkEnd=-1,this.chunkBudget=-1,this.work=this.work.bind(this),this.scheduleWork()}update(t){let e=this.view.state.field(os.state).context;(e.updateViewport(t.view.viewport)||this.view.viewport.to>e.treeLen)&&this.scheduleWork(),(t.docChanged||t.selectionSet)&&(this.view.hasFocus&&(this.chunkBudget+=50),this.scheduleWork()),this.checkAsyncSchedule(e)}scheduleWork(){if(this.working)return;let{state:t}=this.view,e=t.field(os.state);(e.tree!=e.context.tree||!e.context.isDone(t.doc.length))&&(this.working=gR(this.work))}work(t){this.working=null;let e=Date.now();if(this.chunkEnd<e&&(this.chunkEnd<0||this.view.hasFocus)&&(this.chunkEnd=e+3e4,this.chunkBudget=3e3),this.chunkBudget<=0)return;let{state:i,viewport:{to:n}}=this.view,r=i.field(os.state);if(r.tree==r.context.tree&&r.context.isDone(n+1e5))return;let o=Date.now()+Math.min(this.chunkBudget,100,t&&!Jx?Math.max(25,t.timeRemaining()-5):1e9),l=r.context.treeLen<n&&i.doc.length>n+1e3,a=r.context.work(()=>Jx&&Jx()||Date.now()>o,n+(l?0:1e5));this.chunkBudget-=Date.now()-e,(a||this.chunkBudget<=0)&&(r.context.takeTree(),this.view.dispatch({effects:os.setState.of(new kc(r.context))})),this.chunkBudget>0&&!(a&&!l)&&this.scheduleWork(),this.checkAsyncSchedule(r.context)}checkAsyncSchedule(t){t.scheduleOn&&(this.workScheduled++,t.scheduleOn.then(()=>this.scheduleWork()).catch(e=>Fn(this.view.state,e)).then(()=>this.workScheduled--),t.scheduleOn=null)}destroy(){this.working&&this.working()}isWorking(){return!!(this.working||this.workScheduled>0)}},{eventHandlers:{focus(){this.scheduleWork()}}}),Qo=Pe.define({combine(s){return s.length?s[0]:null},enables:s=>[os.state,Sre,Ee.contentAttributes.compute([s],t=>{let e=t.facet(s);return e&&e.name?{"data-language":e.name}:{}})]});class Yh{constructor(t,e=[]){this.language=t,this.support=e,this.extension=[t,e]}}class Jg{constructor(t,e,i,n,r,o=void 0){this.name=t,this.alias=e,this.extensions=i,this.filename=n,this.loadFunc=r,this.support=o,this.loading=null}load(){return this.loading||(this.loading=this.loadFunc().then(t=>this.support=t,t=>{throw this.loading=null,t}))}static of(t){let{load:e,support:i}=t;if(!e){if(!i)throw new RangeError("Must pass either 'load' or 'support' to LanguageDescription.of");e=()=>Promise.resolve(i)}return new Jg(t.name,(t.alias||[]).concat(t.name).map(n=>n.toLowerCase()),t.extensions||[],t.filename,e,i)}static matchFilename(t,e){for(let n of t)if(n.filename&&n.filename.test(e))return n;let i=/\.([^.]+)$/.exec(e);if(i){for(let n of t)if(n.extensions.indexOf(i[1])>-1)return n}return null}static matchLanguageName(t,e,i=!0){e=e.toLowerCase();for(let n of t)if(n.alias.some(r=>r==e))return n;if(i)for(let n of t)for(let r of n.alias){let o=e.indexOf(r);if(o>-1&&(r.length>2||!/\w/.test(e[o-1])&&!/\w/.test(e[o+r.length])))return n}return null}}const Cre=Pe.define(),Cd=Pe.define({combine:s=>{if(!s.length)return"  ";let t=s[0];if(!t||/\S/.test(t)||Array.from(t).some(e=>e!=t[0]))throw new Error("Invalid indent unit: "+JSON.stringify(s[0]));return t}});function ep(s){let t=s.facet(Cd);return t.charCodeAt(0)==9?s.tabSize*t.length:t.length}function Kh(s,t){let e="",i=s.tabSize,n=s.facet(Cd)[0];if(n=="	"){for(;t>=i;)e+="	",t-=i;n=" "}for(let r=0;r<t;r++)e+=n;return e}function sv(s,t){s instanceof ht&&(s=new Fp(s));for(let i of s.state.facet(Cre)){let n=i(s,t);if(n!==void 0)return n}let e=St(s.state);return e.length>=t?Pre(s,e,t):null}class Fp{constructor(t,e={}){this.state=t,this.options=e,this.unit=ep(t)}lineAt(t,e=1){let i=this.state.doc.lineAt(t),{simulateBreak:n,simulateDoubleBreak:r}=this.options;return n!=null&&n>=i.from&&n<=i.to?r&&n==t?{text:"",from:t}:(e<0?n<t:n<=t)?{text:i.text.slice(n-i.from),from:n}:{text:i.text.slice(0,n-i.from),from:i.from}:i}textAfterPos(t,e=1){if(this.options.simulateDoubleBreak&&t==this.options.simulateBreak)return"";let{text:i,from:n}=this.lineAt(t,e);return i.slice(t-n,Math.min(i.length,t+100-n))}column(t,e=1){let{text:i,from:n}=this.lineAt(t,e),r=this.countColumn(i,t-n),o=this.options.overrideIndentation?this.options.overrideIndentation(n):-1;return o>-1&&(r+=o-this.countColumn(i,i.search(/\S|$/))),r}countColumn(t,e=t.length){return $s(t,this.state.tabSize,e)}lineIndent(t,e=1){let{text:i,from:n}=this.lineAt(t,e),r=this.options.overrideIndentation;if(r){let o=r(n);if(o>-1)return o}return this.countColumn(i,i.search(/\S|$/))}get simulatedBreak(){return this.options.simulateBreak||null}}const Pd=new Fe;function Pre(s,t,e){let i=t.resolveStack(e),n=t.resolveInner(e,-1).resolve(e,0).enterUnfinishedNodesBefore(e);if(n!=i.node){let r=[];for(let o=n;o&&!(o.from<i.node.from||o.to>i.node.to||o.from==i.node.from&&o.type==i.node.type);o=o.parent)r.push(o);for(let o=r.length-1;o>=0;o--)i={node:r[o],next:i}}return pR(i,s,e)}function pR(s,t,e){for(let i=s;i;i=i.next){let n=Ere(i.node);if(n)return n(rv.create(t,e,i))}return 0}function Tre(s){return s.pos==s.options.simulateBreak&&s.options.simulateDoubleBreak}function Ere(s){let t=s.type.prop(Pd);if(t)return t;let e=s.firstChild,i;if(e&&(i=e.type.prop(Fe.closedBy))){let n=s.lastChild,r=n&&i.indexOf(n.name)>-1;return o=>wR(o,!0,1,void 0,r&&!Tre(o)?n.from:void 0)}return s.parent==null?Are:null}function Are(){return 0}class rv extends Fp{constructor(t,e,i){super(t.state,t.options),this.base=t,this.pos=e,this.context=i}get node(){return this.context.node}static create(t,e,i){return new rv(t,e,i)}get textAfter(){return this.textAfterPos(this.pos)}get baseIndent(){return this.baseIndentFor(this.node)}baseIndentFor(t){let e=this.state.doc.lineAt(t.from);for(;;){let i=t.resolve(e.from);for(;i.parent&&i.parent.from==i.from;)i=i.parent;if(Ire(i,t))break;e=this.state.doc.lineAt(i.from)}return this.lineIndent(e.from)}continue(){return pR(this.context.next,this.base,this.pos)}}function Ire(s,t){for(let e=t;e;e=e.parent)if(s==e)return!0;return!1}function Rre(s){let t=s.node,e=t.childAfter(t.from),i=t.lastChild;if(!e)return null;let n=s.options.simulateBreak,r=s.state.doc.lineAt(e.from),o=n==null||n<=r.from?r.to:Math.min(r.to,n);for(let l=e.to;;){let a=t.childAfter(l);if(!a||a==i)return null;if(!a.type.isSkipped){if(a.from>=o)return null;let c=/^ */.exec(r.text.slice(e.to-r.from))[0].length;return{from:e.from,to:e.to+c}}l=a.to}}function Vre({closing:s,align:t=!0,units:e=1}){return i=>wR(i,t,e,s)}function wR(s,t,e,i,n){let r=s.textAfter,o=r.match(/^\s*/)[0].length,l=i&&r.slice(o,o+i.length)==i||n==s.pos+o,a=t?Rre(s):null;return a?l?s.column(a.from):s.column(a.to):s.baseIndent+(l?0:s.unit*e)}const Mre=s=>s.baseIndent;function ig({except:s,units:t=1}={}){return e=>{let i=s&&s.test(e.textAfter);return e.baseIndent+(i?0:t*e.unit)}}const Lre=200;function Bre(){return ht.transactionFilter.of(s=>{if(!s.docChanged||!s.isUserEvent("input.type")&&!s.isUserEvent("input.complete"))return s;let t=s.startState.languageDataAt("indentOnInput",s.startState.selection.main.head);if(!t.length)return s;let e=s.newDoc,{head:i}=s.newSelection.main,n=e.lineAt(i);if(i>n.from+Lre)return s;let r=e.sliceString(n.from,i);if(!t.some(c=>c.test(r)))return s;let{state:o}=s,l=-1,a=[];for(let{head:c}of o.selection.ranges){let h=o.doc.lineAt(c);if(h.from==l)continue;l=h.from;let f=sv(o,h.from);if(f==null)continue;let m=/^\s*/.exec(h.text)[0],w=Kh(o,f);m!=w&&a.push({from:h.from,to:h.from+m.length,insert:w})}return a.length?[s,{changes:a,sequential:!0}]:s})}const xR=Pe.define(),$c=new Fe;function bR(s){let t=s.firstChild,e=s.lastChild;return t&&t.to<e.from?{from:t.to,to:e.type.isError?s.to:e.from}:null}function $re(s,t,e){let i=St(s);if(i.length<e)return null;let n=i.resolveStack(e,1),r=null;for(let o=n;o;o=o.next){let l=o.node;if(l.to<=e||l.from>e)continue;if(r&&l.from<t)break;let a=l.type.prop($c);if(a&&(l.to<i.length-50||i.length==s.doc.length||!Dre(l))){let c=a(l,s);c&&c.from<=e&&c.from>=t&&c.to>e&&(r=c)}}return r}function Dre(s){let t=s.lastChild;return t&&t.to==s.to&&t.type.isError}function tp(s,t,e){for(let i of s.facet(xR)){let n=i(s,t,e);if(n)return n}return $re(s,t,e)}function OR(s,t){let e=t.mapPos(s.from,1),i=t.mapPos(s.to,-1);return e>=i?void 0:{from:e,to:i}}const zp=rt.define({map:OR}),Td=rt.define({map:OR});function yR(s){let t=[];for(let{head:e}of s.state.selection.ranges)t.some(i=>i.from<=e&&i.to>=e)||t.push(s.lineBlockAt(e));return t}const $l=Pn.define({create(){return Je.none},update(s,t){t.isUserEvent("delete")&&t.changes.iterChangedRanges((e,i)=>s=LT(s,e,i)),s=s.map(t.changes);for(let e of t.effects)if(e.is(zp)&&!Qre(s,e.value.from,e.value.to)){let{preparePlaceholder:i}=t.state.facet(kR),n=i?Je.replace({widget:new Hre(i(t.state,e.value))}):BT;s=s.update({add:[n.range(e.value.from,e.value.to)]})}else e.is(Td)&&(s=s.update({filter:(i,n)=>e.value.from!=i||e.value.to!=n,filterFrom:e.value.from,filterTo:e.value.to}));return t.selection&&(s=LT(s,t.selection.main.head)),s},provide:s=>Ee.decorations.from(s),toJSON(s,t){let e=[];return s.between(0,t.doc.length,(i,n)=>{e.push(i,n)}),e},fromJSON(s){if(!Array.isArray(s)||s.length%2)throw new RangeError("Invalid JSON for fold state");let t=[];for(let e=0;e<s.length;){let i=s[e++],n=s[e++];if(typeof i!="number"||typeof n!="number")throw new RangeError("Invalid JSON for fold state");t.push(BT.range(i,n))}return Je.set(t,!0)}});function LT(s,t,e=t){let i=!1;return s.between(t,e,(n,r)=>{n<e&&r>t&&(i=!0)}),i?s.update({filterFrom:t,filterTo:e,filter:(n,r)=>n>=e||r<=t}):s}function ip(s,t,e){var i;let n=null;return(i=s.field($l,!1))===null||i===void 0||i.between(t,e,(r,o)=>{(!n||n.from>r)&&(n={from:r,to:o})}),n}function Qre(s,t,e){let i=!1;return s.between(t,t,(n,r)=>{n==t&&r==e&&(i=!0)}),i}function vR(s,t){return s.field($l,!1)?t:t.concat(rt.appendConfig.of(SR()))}const Nre=s=>{for(let t of yR(s)){let e=tp(s.state,t.from,t.to);if(e)return s.dispatch({effects:vR(s.state,[zp.of(e),_R(s,e)])}),!0}return!1},Fre=s=>{if(!s.state.field($l,!1))return!1;let t=[];for(let e of yR(s)){let i=ip(s.state,e.from,e.to);i&&t.push(Td.of(i),_R(s,i,!1))}return t.length&&s.dispatch({effects:t}),t.length>0};function _R(s,t,e=!0){let i=s.state.doc.lineAt(t.from).number,n=s.state.doc.lineAt(t.to).number;return Ee.announce.of(`${s.state.phrase(e?"Folded lines":"Unfolded lines")} ${i} ${s.state.phrase("to")} ${n}.`)}const zre=s=>{let{state:t}=s,e=[];for(let i=0;i<t.doc.length;){let n=s.lineBlockAt(i),r=tp(t,n.from,n.to);r&&e.push(zp.of(r)),i=(r?s.lineBlockAt(r.to):n).to+1}return e.length&&s.dispatch({effects:vR(s.state,e)}),!!e.length},Wre=s=>{let t=s.state.field($l,!1);if(!t||!t.size)return!1;let e=[];return t.between(0,s.state.doc.length,(i,n)=>{e.push(Td.of({from:i,to:n}))}),s.dispatch({effects:e}),!0},Ure=[{key:"Ctrl-Shift-[",mac:"Cmd-Alt-[",run:Nre},{key:"Ctrl-Shift-]",mac:"Cmd-Alt-]",run:Fre},{key:"Ctrl-Alt-[",run:zre},{key:"Ctrl-Alt-]",run:Wre}],Zre={placeholderDOM:null,preparePlaceholder:null,placeholderText:"…"},kR=Pe.define({combine(s){return Kl(s,Zre)}});function SR(s){return[$l,Xre]}function CR(s,t){let{state:e}=s,i=e.facet(kR),n=o=>{let l=s.lineBlockAt(s.posAtDOM(o.target)),a=ip(s.state,l.from,l.to);a&&s.dispatch({effects:Td.of(a)}),o.preventDefault()};if(i.placeholderDOM)return i.placeholderDOM(s,n,t);let r=document.createElement("span");return r.textContent=i.placeholderText,r.setAttribute("aria-label",e.phrase("folded code")),r.title=e.phrase("unfold"),r.className="cm-foldPlaceholder",r.onclick=n,r}const BT=Je.replace({widget:new class extends Wo{toDOM(s){return CR(s,null)}}});class Hre extends Wo{constructor(t){super(),this.value=t}eq(t){return this.value==t.value}toDOM(t){return CR(t,this.value)}}const qre={openText:"⌄",closedText:"›",markerDOM:null,domEventHandlers:{},foldingChanged:()=>!1};class eb extends Qr{constructor(t,e){super(),this.config=t,this.open=e}eq(t){return this.config==t.config&&this.open==t.open}toDOM(t){if(this.config.markerDOM)return this.config.markerDOM(this.open);let e=document.createElement("span");return e.textContent=this.open?this.config.openText:this.config.closedText,e.title=t.state.phrase(this.open?"Fold line":"Unfold line"),e}}function jre(s={}){let t={...qre,...s},e=new eb(t,!0),i=new eb(t,!1),n=Hi.fromClass(class{constructor(o){this.from=o.viewport.from,this.markers=this.buildMarkers(o)}update(o){(o.docChanged||o.viewportChanged||o.startState.facet(Qo)!=o.state.facet(Qo)||o.startState.field($l,!1)!=o.state.field($l,!1)||St(o.startState)!=St(o.state)||t.foldingChanged(o))&&(this.markers=this.buildMarkers(o.view))}buildMarkers(o){let l=new Vl;for(let a of o.viewportLineBlocks){let c=ip(o.state,a.from,a.to)?i:tp(o.state,a.from,a.to)?e:null;c&&l.add(a.from,a.from,c)}return l.finish()}}),{domEventHandlers:r}=t;return[n,Hse({class:"cm-foldGutter",markers(o){var l;return((l=o.plugin(n))===null||l===void 0?void 0:l.markers)||st.empty},initialSpacer(){return new eb(t,!1)},domEventHandlers:{...r,click:(o,l,a)=>{if(r.click&&r.click(o,l,a))return!0;let c=ip(o.state,l.from,l.to);if(c)return o.dispatch({effects:Td.of(c)}),!0;let h=tp(o.state,l.from,l.to);return h?(o.dispatch({effects:zp.of(h)}),!0):!1}}}),SR()]}const Xre=Ee.baseTheme({".cm-foldPlaceholder":{backgroundColor:"#eee",border:"1px solid #ddd",color:"#888",borderRadius:".2em",margin:"0 1px",padding:"0 1px",cursor:"pointer"},".cm-foldGutter span":{padding:"0 1px",cursor:"pointer"}});class Ed{constructor(t,e){this.specs=t;let i;function n(l){let a=Lo.newName();return(i||(i=Object.create(null)))["."+a]=l,a}const r=typeof e.all=="string"?e.all:e.all?n(e.all):void 0,o=e.scope;this.scope=o instanceof os?l=>l.prop(Ol)==o.data:o?l=>l==o:void 0,this.style=mR(t.map(l=>({tag:l.tag,class:l.class||n(Object.assign({},l,{tag:null}))})),{all:r}).style,this.module=i?new Lo(i):null,this.themeType=e.themeType}static define(t,e){return new Ed(t,e||{})}}const oO=Pe.define(),PR=Pe.define({combine(s){return s.length?[s[0]]:null}});function tb(s){let t=s.facet(oO);return t.length?t:s.facet(PR)}function TR(s,t){let e=[Yre],i;return s instanceof Ed&&(s.module&&e.push(Ee.styleModule.of(s.module)),i=s.themeType),t!=null&&t.fallback?e.push(PR.of(s)):i?e.push(oO.computeN([Ee.darkTheme],n=>n.facet(Ee.darkTheme)==(i=="dark")?[s]:[])):e.push(oO.of(s)),e}class Gre{constructor(t){this.markCache=Object.create(null),this.tree=St(t.state),this.decorations=this.buildDeco(t,tb(t.state)),this.decoratedTo=t.viewport.to}update(t){let e=St(t.state),i=tb(t.state),n=i!=tb(t.startState),{viewport:r}=t.view,o=t.changes.mapPos(this.decoratedTo,1);e.length<r.to&&!n&&e.type==this.tree.type&&o>=r.to?(this.decorations=this.decorations.map(t.changes),this.decoratedTo=o):(e!=this.tree||t.viewportChanged||n)&&(this.tree=e,this.decorations=this.buildDeco(t.view,i),this.decoratedTo=r.to)}buildDeco(t,e){if(!e||!this.tree.length)return Je.none;let i=new Vl;for(let{from:n,to:r}of t.visibleRanges)yre(this.tree,e,(o,l,a)=>{i.add(o,l,this.markCache[a]||(this.markCache[a]=Je.mark({class:a})))},n,r);return i.finish()}}const Yre=zo.high(Hi.fromClass(Gre,{decorations:s=>s.decorations})),Kre=Ed.define([{tag:T.meta,color:"#404740"},{tag:T.link,textDecoration:"underline"},{tag:T.heading,textDecoration:"underline",fontWeight:"bold"},{tag:T.emphasis,fontStyle:"italic"},{tag:T.strong,fontWeight:"bold"},{tag:T.strikethrough,textDecoration:"line-through"},{tag:T.keyword,color:"#708"},{tag:[T.atom,T.bool,T.url,T.contentSeparator,T.labelName],color:"#219"},{tag:[T.literal,T.inserted],color:"#164"},{tag:[T.string,T.deleted],color:"#a11"},{tag:[T.regexp,T.escape,T.special(T.string)],color:"#e40"},{tag:T.definition(T.variableName),color:"#00f"},{tag:T.local(T.variableName),color:"#30a"},{tag:[T.typeName,T.namespace],color:"#085"},{tag:T.className,color:"#167"},{tag:[T.special(T.variableName),T.macroName],color:"#256"},{tag:T.definition(T.propertyName),color:"#00c"},{tag:T.comment,color:"#940"},{tag:T.invalid,color:"#f00"}]),Jre=Ee.baseTheme({"&.cm-focused .cm-matchingBracket":{backgroundColor:"#328c8252"},"&.cm-focused .cm-nonmatchingBracket":{backgroundColor:"#bb555544"}}),ER=1e4,AR="()[]{}",IR=Pe.define({combine(s){return Kl(s,{afterCursor:!0,brackets:AR,maxScanDistance:ER,renderMatch:ioe})}}),eoe=Je.mark({class:"cm-matchingBracket"}),toe=Je.mark({class:"cm-nonmatchingBracket"});function ioe(s){let t=[],e=s.matched?eoe:toe;return t.push(e.range(s.start.from,s.start.to)),s.end&&t.push(e.range(s.end.from,s.end.to)),t}const noe=Pn.define({create(){return Je.none},update(s,t){if(!t.docChanged&&!t.selection)return s;let e=[],i=t.state.facet(IR);for(let n of t.state.selection.ranges){if(!n.empty)continue;let r=nr(t.state,n.head,-1,i)||n.head>0&&nr(t.state,n.head-1,1,i)||i.afterCursor&&(nr(t.state,n.head,1,i)||n.head<t.state.doc.length&&nr(t.state,n.head+1,-1,i));r&&(e=e.concat(i.renderMatch(r,t.state)))}return Je.set(e,!0)},provide:s=>Ee.decorations.from(s)}),soe=[noe,Jre];function roe(s={}){return[IR.of(s),soe]}const RR=new Fe;function lO(s,t,e){let i=s.prop(t<0?Fe.openedBy:Fe.closedBy);if(i)return i;if(s.name.length==1){let n=e.indexOf(s.name);if(n>-1&&n%2==(t<0?1:0))return[e[n+t]]}return null}function aO(s){let t=s.type.prop(RR);return t?t(s.node):s}function nr(s,t,e,i={}){let n=i.maxScanDistance||ER,r=i.brackets||AR,o=St(s),l=o.resolveInner(t,e);for(let a=l;a;a=a.parent){let c=lO(a.type,e,r);if(c&&a.from<a.to){let h=aO(a);if(h&&(e>0?t>=h.from&&t<h.to:t>h.from&&t<=h.to))return ooe(s,t,e,a,h,c,r)}}return loe(s,t,e,o,l.type,n,r)}function ooe(s,t,e,i,n,r,o){let l=i.parent,a={from:n.from,to:n.to},c=0,h=l==null?void 0:l.cursor();if(h&&(e<0?h.childBefore(i.from):h.childAfter(i.to)))do if(e<0?h.to<=i.from:h.from>=i.to){if(c==0&&r.indexOf(h.type.name)>-1&&h.from<h.to){let f=aO(h);return{start:a,end:f?{from:f.from,to:f.to}:void 0,matched:!0}}else if(lO(h.type,e,o))c++;else if(lO(h.type,-e,o)){if(c==0){let f=aO(h);return{start:a,end:f&&f.from<f.to?{from:f.from,to:f.to}:void 0,matched:!1}}c--}}while(e<0?h.prevSibling():h.nextSibling());return{start:a,matched:!1}}function loe(s,t,e,i,n,r,o){let l=e<0?s.sliceDoc(t-1,t):s.sliceDoc(t,t+1),a=o.indexOf(l);if(a<0||a%2==0!=e>0)return null;let c={from:e<0?t-1:t,to:e>0?t+1:t},h=s.doc.iterRange(t,e>0?s.doc.length:0),f=0;for(let m=0;!h.next().done&&m<=r;){let w=h.value;e<0&&(m+=w.length);let O=t+m*e;for(let _=e>0?0:w.length-1,k=e>0?w.length:-1;_!=k;_+=e){let C=o.indexOf(w[_]);if(!(C<0||i.resolveInner(O+_,1).type!=n))if(C%2==0==e>0)f++;else{if(f==1)return{start:c,end:{from:O+_,to:O+_+1},matched:C>>1==a>>1};f--}}e>0&&(m+=w.length)}return h.done?{start:c,matched:!1}:null}const aoe=Object.create(null),$T=[hi.none],DT=[],QT=Object.create(null),coe=Object.create(null);for(let[s,t]of[["variable","variableName"],["variable-2","variableName.special"],["string-2","string.special"],["def","variableName.definition"],["tag","tagName"],["attribute","attributeName"],["type","typeName"],["builtin","variableName.standard"],["qualifier","modifier"],["error","invalid"],["header","heading"],["property","propertyName"]])coe[s]=uoe(aoe,t);function ib(s,t){DT.indexOf(s)>-1||(DT.push(s),console.warn(t))}function uoe(s,t){let e=[];for(let l of t.split(" ")){let a=[];for(let c of l.split(".")){let h=s[c]||T[c];h?typeof h=="function"?a.length?a=a.map(h):ib(c,`Modifier ${c} used at start of tag`):a.length?ib(c,`Tag ${c} used as modifier`):a=Array.isArray(h)?h:[h]:ib(c,`Unknown highlighting tag ${c}`)}for(let c of a)e.push(c)}if(!e.length)return 0;let i=t.replace(/ /g,"_"),n=i+" "+e.map(l=>l.id),r=QT[n];if(r)return r.id;let o=QT[n]=hi.define({id:$T.length,name:i,props:[Bc({[i]:e})]});return $T.push(o),o.id}Bt.RTL,Bt.LTR;const hoe=s=>{let{state:t}=s,e=t.doc.lineAt(t.selection.main.from),i=lv(s.state,e.from);return i.line?doe(s):i.block?moe(s):!1};function ov(s,t){return({state:e,dispatch:i})=>{if(e.readOnly)return!1;let n=s(t,e);return n?(i(e.update(n)),!0):!1}}const doe=ov(woe,0),foe=ov(VR,0),moe=ov((s,t)=>VR(s,t,poe(t)),0);function lv(s,t){let e=s.languageDataAt("commentTokens",t);return e.length?e[0]:{}}const Wu=50;function goe(s,{open:t,close:e},i,n){let r=s.sliceDoc(i-Wu,i),o=s.sliceDoc(n,n+Wu),l=/\s*$/.exec(r)[0].length,a=/^\s*/.exec(o)[0].length,c=r.length-l;if(r.slice(c-t.length,c)==t&&o.slice(a,a+e.length)==e)return{open:{pos:i-l,margin:l&&1},close:{pos:n+a,margin:a&&1}};let h,f;n-i<=2*Wu?h=f=s.sliceDoc(i,n):(h=s.sliceDoc(i,i+Wu),f=s.sliceDoc(n-Wu,n));let m=/^\s*/.exec(h)[0].length,w=/\s*$/.exec(f)[0].length,O=f.length-w-e.length;return h.slice(m,m+t.length)==t&&f.slice(O,O+e.length)==e?{open:{pos:i+m+t.length,margin:/\s/.test(h.charAt(m+t.length))?1:0},close:{pos:n-w-e.length,margin:/\s/.test(f.charAt(O-1))?1:0}}:null}function poe(s){let t=[];for(let e of s.selection.ranges){let i=s.doc.lineAt(e.from),n=e.to<=i.to?i:s.doc.lineAt(e.to);n.from>i.from&&n.from==e.to&&(n=e.to==i.to+1?i:s.doc.lineAt(e.to-1));let r=t.length-1;r>=0&&t[r].to>i.from?t[r].to=n.to:t.push({from:i.from+/^\s*/.exec(i.text)[0].length,to:n.to})}return t}function VR(s,t,e=t.selection.ranges){let i=e.map(r=>lv(t,r.from).block);if(!i.every(r=>r))return null;let n=e.map((r,o)=>goe(t,i[o],r.from,r.to));if(s!=2&&!n.every(r=>r))return{changes:t.changes(e.map((r,o)=>n[o]?[]:[{from:r.from,insert:i[o].open+" "},{from:r.to,insert:" "+i[o].close}]))};if(s!=1&&n.some(r=>r)){let r=[];for(let o=0,l;o<n.length;o++)if(l=n[o]){let a=i[o],{open:c,close:h}=l;r.push({from:c.pos-a.open.length,to:c.pos+c.margin},{from:h.pos-h.margin,to:h.pos+a.close.length})}return{changes:r}}return null}function woe(s,t,e=t.selection.ranges){let i=[],n=-1;for(let{from:r,to:o}of e){let l=i.length,a=1e9,c=lv(t,r).line;if(c){for(let h=r;h<=o;){let f=t.doc.lineAt(h);if(f.from>n&&(r==o||o>f.from)){n=f.from;let m=/^\s*/.exec(f.text)[0].length,w=m==f.length,O=f.text.slice(m,m+c.length)==c?m:-1;m<f.text.length&&m<a&&(a=m),i.push({line:f,comment:O,token:c,indent:m,empty:w,single:!1})}h=f.to+1}if(a<1e9)for(let h=l;h<i.length;h++)i[h].indent<i[h].line.text.length&&(i[h].indent=a);i.length==l+1&&(i[l].single=!0)}}if(s!=2&&i.some(r=>r.comment<0&&(!r.empty||r.single))){let r=[];for(let{line:l,token:a,indent:c,empty:h,single:f}of i)(f||!h)&&r.push({from:l.from+c,insert:a+" "});let o=t.changes(r);return{changes:o,selection:t.selection.map(o,1)}}else if(s!=1&&i.some(r=>r.comment>=0)){let r=[];for(let{line:o,comment:l,token:a}of i)if(l>=0){let c=o.from+l,h=c+a.length;o.text[h-o.from]==" "&&h++,r.push({from:c,to:h})}return{changes:r}}return null}const cO=Zr.define(),xoe=Zr.define(),boe=Pe.define(),MR=Pe.define({combine(s){return Kl(s,{minDepth:100,newGroupDelay:500,joinToEvent:(t,e)=>e},{minDepth:Math.max,newGroupDelay:Math.min,joinToEvent:(t,e)=>(i,n)=>t(i,n)||e(i,n)})}}),LR=Pn.define({create(){return sr.empty},update(s,t){let e=t.state.facet(MR),i=t.annotation(cO);if(i){let a=yn.fromTransaction(t,i.selection),c=i.side,h=c==0?s.undone:s.done;return a?h=np(h,h.length,e.minDepth,a):h=$R(h,t.startState.selection),new sr(c==0?i.rest:h,c==0?h:i.rest)}let n=t.annotation(xoe);if((n=="full"||n=="before")&&(s=s.isolate()),t.annotation(Jt.addToHistory)===!1)return t.changes.empty?s:s.addMapping(t.changes.desc);let r=yn.fromTransaction(t),o=t.annotation(Jt.time),l=t.annotation(Jt.userEvent);return r?s=s.addChanges(r,o,l,e,t):t.selection&&(s=s.addSelection(t.startState.selection,o,l,e.newGroupDelay)),(n=="full"||n=="after")&&(s=s.isolate()),s},toJSON(s){return{done:s.done.map(t=>t.toJSON()),undone:s.undone.map(t=>t.toJSON())}},fromJSON(s){return new sr(s.done.map(yn.fromJSON),s.undone.map(yn.fromJSON))}});function Ooe(s={}){return[LR,MR.of(s),Ee.domEventHandlers({beforeinput(t,e){let i=t.inputType=="historyUndo"?av:t.inputType=="historyRedo"?Jh:null;return i?(t.preventDefault(),i(e)):!1}})]}function Wp(s,t){return function({state:e,dispatch:i}){if(!t&&e.readOnly)return!1;let n=e.field(LR,!1);if(!n)return!1;let r=n.pop(s,e,t);return r?(i(r),!0):!1}}const av=Wp(0,!1),Jh=Wp(1,!1),yoe=Wp(0,!0),voe=Wp(1,!0);class yn{constructor(t,e,i,n,r){this.changes=t,this.effects=e,this.mapped=i,this.startSelection=n,this.selectionsAfter=r}setSelAfter(t){return new yn(this.changes,this.effects,this.mapped,this.startSelection,t)}toJSON(){var t,e,i;return{changes:(t=this.changes)===null||t===void 0?void 0:t.toJSON(),mapped:(e=this.mapped)===null||e===void 0?void 0:e.toJSON(),startSelection:(i=this.startSelection)===null||i===void 0?void 0:i.toJSON(),selectionsAfter:this.selectionsAfter.map(n=>n.toJSON())}}static fromJSON(t){return new yn(t.changes&&ci.fromJSON(t.changes),[],t.mapped&&ar.fromJSON(t.mapped),t.startSelection&&se.fromJSON(t.startSelection),t.selectionsAfter.map(se.fromJSON))}static fromTransaction(t,e){let i=ls;for(let n of t.startState.facet(boe)){let r=n(t);r.length&&(i=i.concat(r))}return!i.length&&t.changes.empty?null:new yn(t.changes.invert(t.startState.doc),i,void 0,e||t.startState.selection,ls)}static selection(t){return new yn(void 0,ls,void 0,void 0,t)}}function np(s,t,e,i){let n=t+1>e+20?t-e-1:0,r=s.slice(n,t);return r.push(i),r}function _oe(s,t){let e=[],i=!1;return s.iterChangedRanges((n,r)=>e.push(n,r)),t.iterChangedRanges((n,r,o,l)=>{for(let a=0;a<e.length;){let c=e[a++],h=e[a++];l>=c&&o<=h&&(i=!0)}}),i}function koe(s,t){return s.ranges.length==t.ranges.length&&s.ranges.filter((e,i)=>e.empty!=t.ranges[i].empty).length===0}function BR(s,t){return s.length?t.length?s.concat(t):s:t}const ls=[],Soe=200;function $R(s,t){if(s.length){let e=s[s.length-1],i=e.selectionsAfter.slice(Math.max(0,e.selectionsAfter.length-Soe));return i.length&&i[i.length-1].eq(t)?s:(i.push(t),np(s,s.length-1,1e9,e.setSelAfter(i)))}else return[yn.selection([t])]}function Coe(s){let t=s[s.length-1],e=s.slice();return e[s.length-1]=t.setSelAfter(t.selectionsAfter.slice(0,t.selectionsAfter.length-1)),e}function nb(s,t){if(!s.length)return s;let e=s.length,i=ls;for(;e;){let n=Poe(s[e-1],t,i);if(n.changes&&!n.changes.empty||n.effects.length){let r=s.slice(0,e);return r[e-1]=n,r}else t=n.mapped,e--,i=n.selectionsAfter}return i.length?[yn.selection(i)]:ls}function Poe(s,t,e){let i=BR(s.selectionsAfter.length?s.selectionsAfter.map(l=>l.map(t)):ls,e);if(!s.changes)return yn.selection(i);let n=s.changes.map(t),r=t.mapDesc(s.changes,!0),o=s.mapped?s.mapped.composeDesc(r):r;return new yn(n,rt.mapEffects(s.effects,t),o,s.startSelection.map(r),i)}const Toe=/^(input\.type|delete)($|\.)/;class sr{constructor(t,e,i=0,n=void 0){this.done=t,this.undone=e,this.prevTime=i,this.prevUserEvent=n}isolate(){return this.prevTime?new sr(this.done,this.undone):this}addChanges(t,e,i,n,r){let o=this.done,l=o[o.length-1];return l&&l.changes&&!l.changes.empty&&t.changes&&(!i||Toe.test(i))&&(!l.selectionsAfter.length&&e-this.prevTime<n.newGroupDelay&&n.joinToEvent(r,_oe(l.changes,t.changes))||i=="input.type.compose")?o=np(o,o.length-1,n.minDepth,new yn(t.changes.compose(l.changes),BR(rt.mapEffects(t.effects,l.changes),l.effects),l.mapped,l.startSelection,ls)):o=np(o,o.length,n.minDepth,t),new sr(o,ls,e,i)}addSelection(t,e,i,n){let r=this.done.length?this.done[this.done.length-1].selectionsAfter:ls;return r.length>0&&e-this.prevTime<n&&i==this.prevUserEvent&&i&&/^select($|\.)/.test(i)&&koe(r[r.length-1],t)?this:new sr($R(this.done,t),this.undone,e,i)}addMapping(t){return new sr(nb(this.done,t),nb(this.undone,t),this.prevTime,this.prevUserEvent)}pop(t,e,i){let n=t==0?this.done:this.undone;if(n.length==0)return null;let r=n[n.length-1],o=r.selectionsAfter[0]||e.selection;if(i&&r.selectionsAfter.length)return e.update({selection:r.selectionsAfter[r.selectionsAfter.length-1],annotations:cO.of({side:t,rest:Coe(n),selection:o}),userEvent:t==0?"select.undo":"select.redo",scrollIntoView:!0});if(r.changes){let l=n.length==1?ls:n.slice(0,n.length-1);return r.mapped&&(l=nb(l,r.mapped)),e.update({changes:r.changes,selection:r.startSelection,effects:r.effects,annotations:cO.of({side:t,rest:l,selection:o}),filter:!1,userEvent:t==0?"undo":"redo",scrollIntoView:!0})}else return null}}sr.empty=new sr(ls,ls);const Eoe=[{key:"Mod-z",run:av,preventDefault:!0},{key:"Mod-y",mac:"Mod-Shift-z",run:Jh,preventDefault:!0},{linux:"Ctrl-Shift-z",run:Jh,preventDefault:!0},{key:"Mod-u",run:yoe,preventDefault:!0},{key:"Alt-u",mac:"Mod-Shift-u",run:voe,preventDefault:!0}];function Dc(s,t){return se.create(s.ranges.map(t),s.mainIndex)}function dr(s,t){return s.update({selection:t,scrollIntoView:!0,userEvent:"select"})}function Ns({state:s,dispatch:t},e){let i=Dc(s.selection,e);return i.eq(s.selection,!0)?!1:(t(dr(s,i)),!0)}function Up(s,t){return se.cursor(t?s.to:s.from)}function DR(s,t){return Ns(s,e=>e.empty?s.moveByChar(e,t):Up(e,t))}function ji(s){return s.textDirectionAt(s.state.selection.main.head)==Bt.LTR}const QR=s=>DR(s,!ji(s)),NR=s=>DR(s,ji(s));function FR(s,t){return Ns(s,e=>e.empty?s.moveByGroup(e,t):Up(e,t))}const Aoe=s=>FR(s,!ji(s)),Ioe=s=>FR(s,ji(s));function Roe(s,t,e){if(t.type.prop(e))return!0;let i=t.to-t.from;return i&&(i>2||/[^\s,.;:]/.test(s.sliceDoc(t.from,t.to)))||t.firstChild}function Zp(s,t,e){let i=St(s).resolveInner(t.head),n=e?Fe.closedBy:Fe.openedBy;for(let a=t.head;;){let c=e?i.childAfter(a):i.childBefore(a);if(!c)break;Roe(s,c,n)?i=c:a=e?c.to:c.from}let r=i.type.prop(n),o,l;return r&&(o=e?nr(s,i.from,1):nr(s,i.to,-1))&&o.matched?l=e?o.end.to:o.end.from:l=e?i.to:i.from,se.cursor(l,e?-1:1)}const Voe=s=>Ns(s,t=>Zp(s.state,t,!ji(s))),Moe=s=>Ns(s,t=>Zp(s.state,t,ji(s)));function zR(s,t){return Ns(s,e=>{if(!e.empty)return Up(e,t);let i=s.moveVertically(e,t);return i.head!=e.head?i:s.moveToLineBoundary(e,t)})}const WR=s=>zR(s,!1),UR=s=>zR(s,!0);function ZR(s){let t=s.scrollDOM.clientHeight<s.scrollDOM.scrollHeight-2,e=0,i=0,n;if(t){for(let r of s.state.facet(Ee.scrollMargins)){let o=r(s);o!=null&&o.top&&(e=Math.max(o==null?void 0:o.top,e)),o!=null&&o.bottom&&(i=Math.max(o==null?void 0:o.bottom,i))}n=s.scrollDOM.clientHeight-e-i}else n=(s.dom.ownerDocument.defaultView||window).innerHeight;return{marginTop:e,marginBottom:i,selfScroll:t,height:Math.max(s.defaultLineHeight,n-5)}}function HR(s,t){let e=ZR(s),{state:i}=s,n=Dc(i.selection,o=>o.empty?s.moveVertically(o,t,e.height):Up(o,t));if(n.eq(i.selection))return!1;let r;if(e.selfScroll){let o=s.coordsAtPos(i.selection.main.head),l=s.scrollDOM.getBoundingClientRect(),a=l.top+e.marginTop,c=l.bottom-e.marginBottom;o&&o.top>a&&o.bottom<c&&(r=Ee.scrollIntoView(n.main.head,{y:"start",yMargin:o.top-a}))}return s.dispatch(dr(i,n),{effects:r}),!0}const NT=s=>HR(s,!1),uO=s=>HR(s,!0);function Uo(s,t,e){let i=s.lineBlockAt(t.head),n=s.moveToLineBoundary(t,e);if(n.head==t.head&&n.head!=(e?i.to:i.from)&&(n=s.moveToLineBoundary(t,e,!1)),!e&&n.head==i.from&&i.length){let r=/^\s*/.exec(s.state.sliceDoc(i.from,Math.min(i.from+100,i.to)))[0].length;r&&t.head!=i.from+r&&(n=se.cursor(i.from+r))}return n}const Loe=s=>Ns(s,t=>Uo(s,t,!0)),Boe=s=>Ns(s,t=>Uo(s,t,!1)),$oe=s=>Ns(s,t=>Uo(s,t,!ji(s))),Doe=s=>Ns(s,t=>Uo(s,t,ji(s))),Qoe=s=>Ns(s,t=>se.cursor(s.lineBlockAt(t.head).from,1)),Noe=s=>Ns(s,t=>se.cursor(s.lineBlockAt(t.head).to,-1));function Foe(s,t,e){let i=!1,n=Dc(s.selection,r=>{let o=nr(s,r.head,-1)||nr(s,r.head,1)||r.head>0&&nr(s,r.head-1,1)||r.head<s.doc.length&&nr(s,r.head+1,-1);if(!o||!o.end)return r;i=!0;let l=o.start.from==r.head?o.end.to:o.end.from;return se.cursor(l)});return i?(t(dr(s,n)),!0):!1}const zoe=({state:s,dispatch:t})=>Foe(s,t);function bs(s,t){let e=Dc(s.state.selection,i=>{let n=t(i);return se.range(i.anchor,n.head,n.goalColumn,n.bidiLevel||void 0)});return e.eq(s.state.selection)?!1:(s.dispatch(dr(s.state,e)),!0)}function qR(s,t){return bs(s,e=>s.moveByChar(e,t))}const jR=s=>qR(s,!ji(s)),XR=s=>qR(s,ji(s));function GR(s,t){return bs(s,e=>s.moveByGroup(e,t))}const Woe=s=>GR(s,!ji(s)),Uoe=s=>GR(s,ji(s)),Zoe=s=>bs(s,t=>Zp(s.state,t,!ji(s))),Hoe=s=>bs(s,t=>Zp(s.state,t,ji(s)));function YR(s,t){return bs(s,e=>s.moveVertically(e,t))}const KR=s=>YR(s,!1),JR=s=>YR(s,!0);function eV(s,t){return bs(s,e=>s.moveVertically(e,t,ZR(s).height))}const FT=s=>eV(s,!1),zT=s=>eV(s,!0),qoe=s=>bs(s,t=>Uo(s,t,!0)),joe=s=>bs(s,t=>Uo(s,t,!1)),Xoe=s=>bs(s,t=>Uo(s,t,!ji(s))),Goe=s=>bs(s,t=>Uo(s,t,ji(s))),Yoe=s=>bs(s,t=>se.cursor(s.lineBlockAt(t.head).from)),Koe=s=>bs(s,t=>se.cursor(s.lineBlockAt(t.head).to)),WT=({state:s,dispatch:t})=>(t(dr(s,{anchor:0})),!0),UT=({state:s,dispatch:t})=>(t(dr(s,{anchor:s.doc.length})),!0),ZT=({state:s,dispatch:t})=>(t(dr(s,{anchor:s.selection.main.anchor,head:0})),!0),HT=({state:s,dispatch:t})=>(t(dr(s,{anchor:s.selection.main.anchor,head:s.doc.length})),!0),Joe=({state:s,dispatch:t})=>(t(s.update({selection:{anchor:0,head:s.doc.length},userEvent:"select"})),!0),ele=({state:s,dispatch:t})=>{let e=Hp(s).map(({from:i,to:n})=>se.range(i,Math.min(n+1,s.doc.length)));return t(s.update({selection:se.create(e),userEvent:"select"})),!0},tle=({state:s,dispatch:t})=>{let e=Dc(s.selection,i=>{let n=St(s),r=n.resolveStack(i.from,1);if(i.empty){let o=n.resolveStack(i.from,-1);o.node.from>=r.node.from&&o.node.to<=r.node.to&&(r=o)}for(let o=r;o;o=o.next){let{node:l}=o;if((l.from<i.from&&l.to>=i.to||l.to>i.to&&l.from<=i.from)&&o.next)return se.range(l.to,l.from)}return i});return e.eq(s.selection)?!1:(t(dr(s,e)),!0)},ile=({state:s,dispatch:t})=>{let e=s.selection,i=null;return e.ranges.length>1?i=se.create([e.main]):e.main.empty||(i=se.create([se.cursor(e.main.head)])),i?(t(dr(s,i)),!0):!1};function Ad(s,t){if(s.state.readOnly)return!1;let e="delete.selection",{state:i}=s,n=i.changeByRange(r=>{let{from:o,to:l}=r;if(o==l){let a=t(r);a<o?(e="delete.backward",a=Sm(s,a,!1)):a>o&&(e="delete.forward",a=Sm(s,a,!0)),o=Math.min(o,a),l=Math.max(l,a)}else o=Sm(s,o,!1),l=Sm(s,l,!0);return o==l?{range:r}:{changes:{from:o,to:l},range:se.cursor(o,o<r.head?-1:1)}});return n.changes.empty?!1:(s.dispatch(i.update(n,{scrollIntoView:!0,userEvent:e,effects:e=="delete.selection"?Ee.announce.of(i.phrase("Selection deleted")):void 0})),!0)}function Sm(s,t,e){if(s instanceof Ee)for(let i of s.state.facet(Ee.atomicRanges).map(n=>n(s)))i.between(t,t,(n,r)=>{n<t&&r>t&&(t=e?r:n)});return t}const tV=(s,t,e)=>Ad(s,i=>{let n=i.from,{state:r}=s,o=r.doc.lineAt(n),l,a;if(e&&!t&&n>o.from&&n<o.from+200&&!/[^ \t]/.test(l=o.text.slice(0,n-o.from))){if(l[l.length-1]=="	")return n-1;let c=$s(l,r.tabSize),h=c%ep(r)||ep(r);for(let f=0;f<h&&l[l.length-1-f]==" ";f++)n--;a=n}else a=en(o.text,n-o.from,t,t)+o.from,a==n&&o.number!=(t?r.doc.lines:1)?a+=t?1:-1:!t&&/[\ufe00-\ufe0f]/.test(o.text.slice(a-o.from,n-o.from))&&(a=en(o.text,a-o.from,!1,!1)+o.from);return a}),hO=s=>tV(s,!1,!0),iV=s=>tV(s,!0,!1),nV=(s,t)=>Ad(s,e=>{let i=e.head,{state:n}=s,r=n.doc.lineAt(i),o=n.charCategorizer(i);for(let l=null;;){if(i==(t?r.to:r.from)){i==e.head&&r.number!=(t?n.doc.lines:1)&&(i+=t?1:-1);break}let a=en(r.text,i-r.from,t)+r.from,c=r.text.slice(Math.min(i,a)-r.from,Math.max(i,a)-r.from),h=o(c);if(l!=null&&h!=l)break;(c!=" "||i!=e.head)&&(l=h),i=a}return i}),sV=s=>nV(s,!1),nle=s=>nV(s,!0),sle=s=>Ad(s,t=>{let e=s.lineBlockAt(t.head).to;return t.head<e?e:Math.min(s.state.doc.length,t.head+1)}),rle=s=>Ad(s,t=>{let e=s.moveToLineBoundary(t,!1).head;return t.head>e?e:Math.max(0,t.head-1)}),ole=s=>Ad(s,t=>{let e=s.moveToLineBoundary(t,!0).head;return t.head<e?e:Math.min(s.state.doc.length,t.head+1)}),lle=({state:s,dispatch:t})=>{if(s.readOnly)return!1;let e=s.changeByRange(i=>({changes:{from:i.from,to:i.to,insert:Ke.of(["",""])},range:se.cursor(i.from)}));return t(s.update(e,{scrollIntoView:!0,userEvent:"input"})),!0},ale=({state:s,dispatch:t})=>{if(s.readOnly)return!1;let e=s.changeByRange(i=>{if(!i.empty||i.from==0||i.from==s.doc.length)return{range:i};let n=i.from,r=s.doc.lineAt(n),o=n==r.from?n-1:en(r.text,n-r.from,!1)+r.from,l=n==r.to?n+1:en(r.text,n-r.from,!0)+r.from;return{changes:{from:o,to:l,insert:s.doc.slice(n,l).append(s.doc.slice(o,n))},range:se.cursor(l)}});return e.changes.empty?!1:(t(s.update(e,{scrollIntoView:!0,userEvent:"move.character"})),!0)};function Hp(s){let t=[],e=-1;for(let i of s.selection.ranges){let n=s.doc.lineAt(i.from),r=s.doc.lineAt(i.to);if(!i.empty&&i.to==r.from&&(r=s.doc.lineAt(i.to-1)),e>=n.number){let o=t[t.length-1];o.to=r.to,o.ranges.push(i)}else t.push({from:n.from,to:r.to,ranges:[i]});e=r.number+1}return t}function rV(s,t,e){if(s.readOnly)return!1;let i=[],n=[];for(let r of Hp(s)){if(e?r.to==s.doc.length:r.from==0)continue;let o=s.doc.lineAt(e?r.to+1:r.from-1),l=o.length+1;if(e){i.push({from:r.to,to:o.to},{from:r.from,insert:o.text+s.lineBreak});for(let a of r.ranges)n.push(se.range(Math.min(s.doc.length,a.anchor+l),Math.min(s.doc.length,a.head+l)))}else{i.push({from:o.from,to:r.from},{from:r.to,insert:s.lineBreak+o.text});for(let a of r.ranges)n.push(se.range(a.anchor-l,a.head-l))}}return i.length?(t(s.update({changes:i,scrollIntoView:!0,selection:se.create(n,s.selection.mainIndex),userEvent:"move.line"})),!0):!1}const cle=({state:s,dispatch:t})=>rV(s,t,!1),ule=({state:s,dispatch:t})=>rV(s,t,!0);function oV(s,t,e){if(s.readOnly)return!1;let i=[];for(let n of Hp(s))e?i.push({from:n.from,insert:s.doc.slice(n.from,n.to)+s.lineBreak}):i.push({from:n.to,insert:s.lineBreak+s.doc.slice(n.from,n.to)});return t(s.update({changes:i,scrollIntoView:!0,userEvent:"input.copyline"})),!0}const hle=({state:s,dispatch:t})=>oV(s,t,!1),dle=({state:s,dispatch:t})=>oV(s,t,!0),fle=s=>{if(s.state.readOnly)return!1;let{state:t}=s,e=t.changes(Hp(t).map(({from:n,to:r})=>(n>0?n--:r<t.doc.length&&r++,{from:n,to:r}))),i=Dc(t.selection,n=>{let r;if(s.lineWrapping){let o=s.lineBlockAt(n.head),l=s.coordsAtPos(n.head,n.assoc||1);l&&(r=o.bottom+s.documentTop-l.bottom+s.defaultLineHeight/2)}return s.moveVertically(n,!0,r)}).map(e);return s.dispatch({changes:e,selection:i,scrollIntoView:!0,userEvent:"delete.line"}),!0};function mle(s,t){if(/\(\)|\[\]|\{\}/.test(s.sliceDoc(t-1,t+1)))return{from:t,to:t};let e=St(s).resolveInner(t),i=e.childBefore(t),n=e.childAfter(t),r;return i&&n&&i.to<=t&&n.from>=t&&(r=i.type.prop(Fe.closedBy))&&r.indexOf(n.name)>-1&&s.doc.lineAt(i.to).from==s.doc.lineAt(n.from).from&&!/\S/.test(s.sliceDoc(i.to,n.from))?{from:i.to,to:n.from}:null}const qT=lV(!1),gle=lV(!0);function lV(s){return({state:t,dispatch:e})=>{if(t.readOnly)return!1;let i=t.changeByRange(n=>{let{from:r,to:o}=n,l=t.doc.lineAt(r),a=!s&&r==o&&mle(t,r);s&&(r=o=(o<=l.to?l:t.doc.lineAt(o)).to);let c=new Fp(t,{simulateBreak:r,simulateDoubleBreak:!!a}),h=sv(c,r);for(h==null&&(h=$s(/^\s*/.exec(t.doc.lineAt(r).text)[0],t.tabSize));o<l.to&&/\s/.test(l.text[o-l.from]);)o++;a?{from:r,to:o}=a:r>l.from&&r<l.from+100&&!/\S/.test(l.text.slice(0,r))&&(r=l.from);let f=["",Kh(t,h)];return a&&f.push(Kh(t,c.lineIndent(l.from,-1))),{changes:{from:r,to:o,insert:Ke.of(f)},range:se.cursor(r+1+f[1].length)}});return e(t.update(i,{scrollIntoView:!0,userEvent:"input"})),!0}}function cv(s,t){let e=-1;return s.changeByRange(i=>{let n=[];for(let o=i.from;o<=i.to;){let l=s.doc.lineAt(o);l.number>e&&(i.empty||i.to>l.from)&&(t(l,n,i),e=l.number),o=l.to+1}let r=s.changes(n);return{changes:n,range:se.range(r.mapPos(i.anchor,1),r.mapPos(i.head,1))}})}const ple=({state:s,dispatch:t})=>{if(s.readOnly)return!1;let e=Object.create(null),i=new Fp(s,{overrideIndentation:r=>{let o=e[r];return o??-1}}),n=cv(s,(r,o,l)=>{let a=sv(i,r.from);if(a==null)return;/\S/.test(r.text)||(a=0);let c=/^\s*/.exec(r.text)[0],h=Kh(s,a);(c!=h||l.from<r.from+c.length)&&(e[r.from]=a,o.push({from:r.from,to:r.from+c.length,insert:h}))});return n.changes.empty||t(s.update(n,{userEvent:"indent"})),!0},aV=({state:s,dispatch:t})=>s.readOnly?!1:(t(s.update(cv(s,(e,i)=>{i.push({from:e.from,insert:s.facet(Cd)})}),{userEvent:"input.indent"})),!0),cV=({state:s,dispatch:t})=>s.readOnly?!1:(t(s.update(cv(s,(e,i)=>{let n=/^\s*/.exec(e.text)[0];if(!n)return;let r=$s(n,s.tabSize),o=0,l=Kh(s,Math.max(0,r-ep(s)));for(;o<n.length&&o<l.length&&n.charCodeAt(o)==l.charCodeAt(o);)o++;i.push({from:e.from+o,to:e.from+n.length,insert:l.slice(o)})}),{userEvent:"delete.dedent"})),!0),uV=s=>(s.setTabFocusMode(),!0),wle=[{key:"Ctrl-b",run:QR,shift:jR,preventDefault:!0},{key:"Ctrl-f",run:NR,shift:XR},{key:"Ctrl-p",run:WR,shift:KR},{key:"Ctrl-n",run:UR,shift:JR},{key:"Ctrl-a",run:Qoe,shift:Yoe},{key:"Ctrl-e",run:Noe,shift:Koe},{key:"Ctrl-d",run:iV},{key:"Ctrl-h",run:hO},{key:"Ctrl-k",run:sle},{key:"Ctrl-Alt-h",run:sV},{key:"Ctrl-o",run:lle},{key:"Ctrl-t",run:ale},{key:"Ctrl-v",run:uO}],xle=[{key:"ArrowLeft",run:QR,shift:jR,preventDefault:!0},{key:"Mod-ArrowLeft",mac:"Alt-ArrowLeft",run:Aoe,shift:Woe,preventDefault:!0},{mac:"Cmd-ArrowLeft",run:$oe,shift:Xoe,preventDefault:!0},{key:"ArrowRight",run:NR,shift:XR,preventDefault:!0},{key:"Mod-ArrowRight",mac:"Alt-ArrowRight",run:Ioe,shift:Uoe,preventDefault:!0},{mac:"Cmd-ArrowRight",run:Doe,shift:Goe,preventDefault:!0},{key:"ArrowUp",run:WR,shift:KR,preventDefault:!0},{mac:"Cmd-ArrowUp",run:WT,shift:ZT},{mac:"Ctrl-ArrowUp",run:NT,shift:FT},{key:"ArrowDown",run:UR,shift:JR,preventDefault:!0},{mac:"Cmd-ArrowDown",run:UT,shift:HT},{mac:"Ctrl-ArrowDown",run:uO,shift:zT},{key:"PageUp",run:NT,shift:FT},{key:"PageDown",run:uO,shift:zT},{key:"Home",run:Boe,shift:joe,preventDefault:!0},{key:"Mod-Home",run:WT,shift:ZT},{key:"End",run:Loe,shift:qoe,preventDefault:!0},{key:"Mod-End",run:UT,shift:HT},{key:"Enter",run:qT,shift:qT},{key:"Mod-a",run:Joe},{key:"Backspace",run:hO,shift:hO},{key:"Delete",run:iV},{key:"Mod-Backspace",mac:"Alt-Backspace",run:sV},{key:"Mod-Delete",mac:"Alt-Delete",run:nle},{mac:"Mod-Backspace",run:rle},{mac:"Mod-Delete",run:ole}].concat(wle.map(s=>({mac:s.key,run:s.run,shift:s.shift}))),ble=[{key:"Alt-ArrowLeft",mac:"Ctrl-ArrowLeft",run:Voe,shift:Zoe},{key:"Alt-ArrowRight",mac:"Ctrl-ArrowRight",run:Moe,shift:Hoe},{key:"Alt-ArrowUp",run:cle},{key:"Shift-Alt-ArrowUp",run:hle},{key:"Alt-ArrowDown",run:ule},{key:"Shift-Alt-ArrowDown",run:dle},{key:"Escape",run:ile},{key:"Mod-Enter",run:gle},{key:"Alt-l",mac:"Ctrl-l",run:ele},{key:"Mod-i",run:tle,preventDefault:!0},{key:"Mod-[",run:cV},{key:"Mod-]",run:aV},{key:"Mod-Alt-\\",run:ple},{key:"Shift-Mod-k",run:fle},{key:"Shift-Mod-\\",run:zoe},{key:"Mod-/",run:hoe},{key:"Alt-A",run:foe},{key:"Ctrl-m",mac:"Shift-Alt-m",run:uV}].concat(xle);class uv{constructor(t,e,i,n){this.state=t,this.pos=e,this.explicit=i,this.view=n,this.abortListeners=[],this.abortOnDocChange=!1}tokenBefore(t){let e=St(this.state).resolveInner(this.pos,-1);for(;e&&t.indexOf(e.name)<0;)e=e.parent;return e?{from:e.from,to:this.pos,text:this.state.sliceDoc(e.from,this.pos),type:e.type}:null}matchBefore(t){let e=this.state.doc.lineAt(this.pos),i=Math.max(e.from,this.pos-250),n=e.text.slice(i-e.from,this.pos-e.from),r=n.search(dV(t,!1));return r<0?null:{from:i+r,to:this.pos,text:n.slice(r)}}get aborted(){return this.abortListeners==null}addEventListener(t,e,i){t=="abort"&&this.abortListeners&&(this.abortListeners.push(e),i&&i.onDocChange&&(this.abortOnDocChange=!0))}}function jT(s){let t=Object.keys(s).join(""),e=/\w/.test(t);return e&&(t=t.replace(/\w/g,"")),`[${e?"\\w":""}${t.replace(/[^\w\s]/g,"\\$&")}]`}function Ole(s){let t=Object.create(null),e=Object.create(null);for(let{label:n}of s){t[n[0]]=!0;for(let r=1;r<n.length;r++)e[n[r]]=!0}let i=jT(t)+jT(e)+"*$";return[new RegExp("^"+i),new RegExp(i)]}function hV(s){let t=s.map(n=>typeof n=="string"?{label:n}:n),[e,i]=t.every(n=>/^\w+$/.test(n.label))?[/\w*$/,/\w+$/]:Ole(t);return n=>{let r=n.matchBefore(i);return r||n.explicit?{from:r?r.from:n.pos,options:t,validFor:e}:null}}function yle(s,t){return e=>{for(let i=St(e.state).resolveInner(e.pos,-1);i;i=i.parent){if(s.indexOf(i.name)>-1)return null;if(i.type.isTop)break}return t(e)}}class XT{constructor(t,e,i,n){this.completion=t,this.source=e,this.match=i,this.score=n}}function Sl(s){return s.selection.main.from}function dV(s,t){var e;let{source:i}=s,n=t&&i[0]!="^",r=i[i.length-1]!="$";return!n&&!r?s:new RegExp(`${n?"^":""}(?:${i})${r?"$":""}`,(e=s.flags)!==null&&e!==void 0?e:s.ignoreCase?"i":"")}const hv=Zr.define();function vle(s,t,e,i){let{main:n}=s.selection,r=e-n.from,o=i-n.from;return Object.assign(Object.assign({},s.changeByRange(l=>{if(l!=n&&e!=i&&s.sliceDoc(l.from+r,l.from+o)!=s.sliceDoc(e,i))return{range:l};let a=s.toText(t);return{changes:{from:l.from+r,to:i==n.from?l.to:l.from+o,insert:a},range:se.cursor(l.from+r+a.length)}})),{scrollIntoView:!0,userEvent:"input.complete"})}const GT=new WeakMap;function _le(s){if(!Array.isArray(s))return s;let t=GT.get(s);return t||GT.set(s,t=hV(s)),t}const sp=rt.define(),ed=rt.define();class kle{constructor(t){this.pattern=t,this.chars=[],this.folded=[],this.any=[],this.precise=[],this.byWord=[],this.score=0,this.matched=[];for(let e=0;e<t.length;){let i=$n(t,e),n=Tr(i);this.chars.push(i);let r=t.slice(e,e+n),o=r.toUpperCase();this.folded.push($n(o==r?r.toLowerCase():o,0)),e+=n}this.astral=t.length!=this.chars.length}ret(t,e){return this.score=t,this.matched=e,this}match(t){if(this.pattern.length==0)return this.ret(-100,[]);if(t.length<this.pattern.length)return null;let{chars:e,folded:i,any:n,precise:r,byWord:o}=this;if(e.length==1){let P=$n(t,0),M=Tr(P),Q=M==t.length?0:-100;if(P!=e[0])if(P==i[0])Q+=-200;else return null;return this.ret(Q,[0,M])}let l=t.indexOf(this.pattern);if(l==0)return this.ret(t.length==this.pattern.length?0:-100,[0,this.pattern.length]);let a=e.length,c=0;if(l<0){for(let P=0,M=Math.min(t.length,200);P<M&&c<a;){let Q=$n(t,P);(Q==e[c]||Q==i[c])&&(n[c++]=P),P+=Tr(Q)}if(c<a)return null}let h=0,f=0,m=!1,w=0,O=-1,_=-1,k=/[a-z]/.test(t),C=!0;for(let P=0,M=Math.min(t.length,200),Q=0;P<M&&f<a;){let N=$n(t,P);l<0&&(h<a&&N==e[h]&&(r[h++]=P),w<a&&(N==e[w]||N==i[w]?(w==0&&(O=P),_=P+1,w++):w=0));let G,D=N<255?N>=48&&N<=57||N>=97&&N<=122?2:N>=65&&N<=90?1:0:(G=W4(N))!=G.toLowerCase()?1:G!=G.toUpperCase()?2:0;(!P||D==1&&k||Q==0&&D!=0)&&(e[f]==N||i[f]==N&&(m=!0)?o[f++]=P:o.length&&(C=!1)),Q=D,P+=Tr(N)}return f==a&&o[0]==0&&C?this.result(-100+(m?-200:0),o,t):w==a&&O==0?this.ret(-200-t.length+(_==t.length?0:-100),[0,_]):l>-1?this.ret(-700-t.length,[l,l+this.pattern.length]):w==a?this.ret(-900-t.length,[O,_]):f==a?this.result(-100+(m?-200:0)+-700+(C?0:-1100),o,t):e.length==2?null:this.result((n[0]?-700:0)+-200+-1100,n,t)}result(t,e,i){let n=[],r=0;for(let o of e){let l=o+(this.astral?Tr($n(i,o)):1);r&&n[r-1]==o?n[r-1]=l:(n[r++]=o,n[r++]=l)}return this.ret(t-i.length,n)}}class Sle{constructor(t){this.pattern=t,this.matched=[],this.score=0,this.folded=t.toLowerCase()}match(t){if(t.length<this.pattern.length)return null;let e=t.slice(0,this.pattern.length),i=e==this.pattern?0:e.toLowerCase()==this.folded?-200:null;return i==null?null:(this.matched=[0,e.length],this.score=i+(t.length==this.pattern.length?0:-100),this)}}const yi=Pe.define({combine(s){return Kl(s,{activateOnTyping:!0,activateOnCompletion:()=>!1,activateOnTypingDelay:100,selectOnOpen:!0,override:null,closeOnBlur:!0,maxRenderedOptions:100,defaultKeymap:!0,tooltipClass:()=>"",optionClass:()=>"",aboveCursor:!1,icons:!0,addToOptions:[],positionInfo:Cle,filterStrict:!1,compareCompletions:(t,e)=>t.label.localeCompare(e.label),interactionDelay:75,updateSyncTime:100},{defaultKeymap:(t,e)=>t&&e,closeOnBlur:(t,e)=>t&&e,icons:(t,e)=>t&&e,tooltipClass:(t,e)=>i=>YT(t(i),e(i)),optionClass:(t,e)=>i=>YT(t(i),e(i)),addToOptions:(t,e)=>t.concat(e),filterStrict:(t,e)=>t||e})}});function YT(s,t){return s?t?s+" "+t:s:t}function Cle(s,t,e,i,n,r){let o=s.textDirection==Bt.RTL,l=o,a=!1,c="top",h,f,m=t.left-n.left,w=n.right-t.right,O=i.right-i.left,_=i.bottom-i.top;if(l&&m<Math.min(O,w)?l=!1:!l&&w<Math.min(O,m)&&(l=!0),O<=(l?m:w))h=Math.max(n.top,Math.min(e.top,n.bottom-_))-t.top,f=Math.min(400,l?m:w);else{a=!0,f=Math.min(400,(o?t.right:n.right-t.left)-30);let P=n.bottom-t.bottom;P>=_||P>t.top?h=e.bottom-t.top:(c="bottom",h=t.bottom-e.top)}let k=(t.bottom-t.top)/r.offsetHeight,C=(t.right-t.left)/r.offsetWidth;return{style:`${c}: ${h/k}px; max-width: ${f/C}px`,class:"cm-completionInfo-"+(a?o?"left-narrow":"right-narrow":l?"left":"right")}}function Ple(s){let t=s.addToOptions.slice();return s.icons&&t.push({render(e){let i=document.createElement("div");return i.classList.add("cm-completionIcon"),e.type&&i.classList.add(...e.type.split(/\s+/g).map(n=>"cm-completionIcon-"+n)),i.setAttribute("aria-hidden","true"),i},position:20}),t.push({render(e,i,n,r){let o=document.createElement("span");o.className="cm-completionLabel";let l=e.displayLabel||e.label,a=0;for(let c=0;c<r.length;){let h=r[c++],f=r[c++];h>a&&o.appendChild(document.createTextNode(l.slice(a,h)));let m=o.appendChild(document.createElement("span"));m.appendChild(document.createTextNode(l.slice(h,f))),m.className="cm-completionMatchedText",a=f}return a<l.length&&o.appendChild(document.createTextNode(l.slice(a))),o},position:50},{render(e){if(!e.detail)return null;let i=document.createElement("span");return i.className="cm-completionDetail",i.textContent=e.detail,i},position:80}),t.sort((e,i)=>e.position-i.position).map(e=>e.render)}function sb(s,t,e){if(s<=e)return{from:0,to:s};if(t<0&&(t=0),t<=s>>1){let n=Math.floor(t/e);return{from:n*e,to:(n+1)*e}}let i=Math.floor((s-t)/e);return{from:s-(i+1)*e,to:s-i*e}}class Tle{constructor(t,e,i){this.view=t,this.stateField=e,this.applyCompletion=i,this.info=null,this.infoDestroy=null,this.placeInfoReq={read:()=>this.measureInfo(),write:a=>this.placeInfo(a),key:this},this.space=null,this.currentClass="";let n=t.state.field(e),{options:r,selected:o}=n.open,l=t.state.facet(yi);this.optionContent=Ple(l),this.optionClass=l.optionClass,this.tooltipClass=l.tooltipClass,this.range=sb(r.length,o,l.maxRenderedOptions),this.dom=document.createElement("div"),this.dom.className="cm-tooltip-autocomplete",this.updateTooltipClass(t.state),this.dom.addEventListener("mousedown",a=>{let{options:c}=t.state.field(e).open;for(let h=a.target,f;h&&h!=this.dom;h=h.parentNode)if(h.nodeName=="LI"&&(f=/-(\d+)$/.exec(h.id))&&+f[1]<c.length){this.applyCompletion(t,c[+f[1]]),a.preventDefault();return}}),this.dom.addEventListener("focusout",a=>{let c=t.state.field(this.stateField,!1);c&&c.tooltip&&t.state.facet(yi).closeOnBlur&&a.relatedTarget!=t.contentDOM&&t.dispatch({effects:ed.of(null)})}),this.showOptions(r,n.id)}mount(){this.updateSel()}showOptions(t,e){this.list&&this.list.remove(),this.list=this.dom.appendChild(this.createListBox(t,e,this.range)),this.list.addEventListener("scroll",()=>{this.info&&this.view.requestMeasure(this.placeInfoReq)})}update(t){var e;let i=t.state.field(this.stateField),n=t.startState.field(this.stateField);if(this.updateTooltipClass(t.state),i!=n){let{options:r,selected:o,disabled:l}=i.open;(!n.open||n.open.options!=r)&&(this.range=sb(r.length,o,t.state.facet(yi).maxRenderedOptions),this.showOptions(r,i.id)),this.updateSel(),l!=((e=n.open)===null||e===void 0?void 0:e.disabled)&&this.dom.classList.toggle("cm-tooltip-autocomplete-disabled",!!l)}}updateTooltipClass(t){let e=this.tooltipClass(t);if(e!=this.currentClass){for(let i of this.currentClass.split(" "))i&&this.dom.classList.remove(i);for(let i of e.split(" "))i&&this.dom.classList.add(i);this.currentClass=e}}positioned(t){this.space=t,this.info&&this.view.requestMeasure(this.placeInfoReq)}updateSel(){let t=this.view.state.field(this.stateField),e=t.open;if((e.selected>-1&&e.selected<this.range.from||e.selected>=this.range.to)&&(this.range=sb(e.options.length,e.selected,this.view.state.facet(yi).maxRenderedOptions),this.showOptions(e.options,t.id)),this.updateSelectedOption(e.selected)){this.destroyInfo();let{completion:i}=e.options[e.selected],{info:n}=i;if(!n)return;let r=typeof n=="string"?document.createTextNode(n):n(i);if(!r)return;"then"in r?r.then(o=>{o&&this.view.state.field(this.stateField,!1)==t&&this.addInfoPane(o,i)}).catch(o=>Fn(this.view.state,o,"completion info")):this.addInfoPane(r,i)}}addInfoPane(t,e){this.destroyInfo();let i=this.info=document.createElement("div");if(i.className="cm-tooltip cm-completionInfo",t.nodeType!=null)i.appendChild(t),this.infoDestroy=null;else{let{dom:n,destroy:r}=t;i.appendChild(n),this.infoDestroy=r||null}this.dom.appendChild(i),this.view.requestMeasure(this.placeInfoReq)}updateSelectedOption(t){let e=null;for(let i=this.list.firstChild,n=this.range.from;i;i=i.nextSibling,n++)i.nodeName!="LI"||!i.id?n--:n==t?i.hasAttribute("aria-selected")||(i.setAttribute("aria-selected","true"),e=i):i.hasAttribute("aria-selected")&&i.removeAttribute("aria-selected");return e&&Ale(this.list,e),e}measureInfo(){let t=this.dom.querySelector("[aria-selected]");if(!t||!this.info)return null;let e=this.dom.getBoundingClientRect(),i=this.info.getBoundingClientRect(),n=t.getBoundingClientRect(),r=this.space;if(!r){let o=this.dom.ownerDocument.documentElement;r={left:0,top:0,right:o.clientWidth,bottom:o.clientHeight}}return n.top>Math.min(r.bottom,e.bottom)-10||n.bottom<Math.max(r.top,e.top)+10?null:this.view.state.facet(yi).positionInfo(this.view,e,n,i,r,this.dom)}placeInfo(t){this.info&&(t?(t.style&&(this.info.style.cssText=t.style),this.info.className="cm-tooltip cm-completionInfo "+(t.class||"")):this.info.style.cssText="top: -1e6px")}createListBox(t,e,i){const n=document.createElement("ul");n.id=e,n.setAttribute("role","listbox"),n.setAttribute("aria-expanded","true"),n.setAttribute("aria-label",this.view.state.phrase("Completions")),n.addEventListener("mousedown",o=>{o.target==n&&o.preventDefault()});let r=null;for(let o=i.from;o<i.to;o++){let{completion:l,match:a}=t[o],{section:c}=l;if(c){let m=typeof c=="string"?c:c.name;if(m!=r&&(o>i.from||i.from==0))if(r=m,typeof c!="string"&&c.header)n.appendChild(c.header(c));else{let w=n.appendChild(document.createElement("completion-section"));w.textContent=m}}const h=n.appendChild(document.createElement("li"));h.id=e+"-"+o,h.setAttribute("role","option");let f=this.optionClass(l);f&&(h.className=f);for(let m of this.optionContent){let w=m(l,this.view.state,this.view,a);w&&h.appendChild(w)}}return i.from&&n.classList.add("cm-completionListIncompleteTop"),i.to<t.length&&n.classList.add("cm-completionListIncompleteBottom"),n}destroyInfo(){this.info&&(this.infoDestroy&&this.infoDestroy(),this.info.remove(),this.info=null)}destroy(){this.destroyInfo()}}function Ele(s,t){return e=>new Tle(e,s,t)}function Ale(s,t){let e=s.getBoundingClientRect(),i=t.getBoundingClientRect(),n=e.height/s.offsetHeight;i.top<e.top?s.scrollTop-=(e.top-i.top)/n:i.bottom>e.bottom&&(s.scrollTop+=(i.bottom-e.bottom)/n)}function KT(s){return(s.boost||0)*100+(s.apply?10:0)+(s.info?5:0)+(s.type?1:0)}function Ile(s,t){let e=[],i=null,n=c=>{e.push(c);let{section:h}=c.completion;if(h){i||(i=[]);let f=typeof h=="string"?h:h.name;i.some(m=>m.name==f)||i.push(typeof h=="string"?{name:f}:h)}},r=t.facet(yi);for(let c of s)if(c.hasResult()){let h=c.result.getMatch;if(c.result.filter===!1)for(let f of c.result.options)n(new XT(f,c.source,h?h(f):[],1e9-e.length));else{let f=t.sliceDoc(c.from,c.to),m,w=r.filterStrict?new Sle(f):new kle(f);for(let O of c.result.options)if(m=w.match(O.label)){let _=O.displayLabel?h?h(O,m.matched):[]:m.matched;n(new XT(O,c.source,_,m.score+(O.boost||0)))}}}if(i){let c=Object.create(null),h=0,f=(m,w)=>{var O,_;return((O=m.rank)!==null&&O!==void 0?O:1e9)-((_=w.rank)!==null&&_!==void 0?_:1e9)||(m.name<w.name?-1:1)};for(let m of i.sort(f))h-=1e5,c[m.name]=h;for(let m of e){let{section:w}=m.completion;w&&(m.score+=c[typeof w=="string"?w:w.name])}}let o=[],l=null,a=r.compareCompletions;for(let c of e.sort((h,f)=>f.score-h.score||a(h.completion,f.completion))){let h=c.completion;!l||l.label!=h.label||l.detail!=h.detail||l.type!=null&&h.type!=null&&l.type!=h.type||l.apply!=h.apply||l.boost!=h.boost?o.push(c):KT(c.completion)>KT(l)&&(o[o.length-1]=c),l=c.completion}return o}class Ka{constructor(t,e,i,n,r,o){this.options=t,this.attrs=e,this.tooltip=i,this.timestamp=n,this.selected=r,this.disabled=o}setSelected(t,e){return t==this.selected||t>=this.options.length?this:new Ka(this.options,JT(e,t),this.tooltip,this.timestamp,t,this.disabled)}static build(t,e,i,n,r,o){if(n&&!o&&t.some(c=>c.isPending))return n.setDisabled();let l=Ile(t,e);if(!l.length)return n&&t.some(c=>c.isPending)?n.setDisabled():null;let a=e.facet(yi).selectOnOpen?0:-1;if(n&&n.selected!=a&&n.selected!=-1){let c=n.options[n.selected].completion;for(let h=0;h<l.length;h++)if(l[h].completion==c){a=h;break}}return new Ka(l,JT(i,a),{pos:t.reduce((c,h)=>h.hasResult()?Math.min(c,h.from):c,1e8),create:$le,above:r.aboveCursor},n?n.timestamp:Date.now(),a,!1)}map(t){return new Ka(this.options,this.attrs,Object.assign(Object.assign({},this.tooltip),{pos:t.mapPos(this.tooltip.pos)}),this.timestamp,this.selected,this.disabled)}setDisabled(){return new Ka(this.options,this.attrs,this.tooltip,this.timestamp,this.selected,!0)}}class rp{constructor(t,e,i){this.active=t,this.id=e,this.open=i}static start(){return new rp(Lle,"cm-ac-"+Math.floor(Math.random()*2e6).toString(36),null)}update(t){let{state:e}=t,i=e.facet(yi),r=(i.override||e.languageDataAt("autocomplete",Sl(e)).map(_le)).map(a=>(this.active.find(h=>h.source==a)||new as(a,this.active.some(h=>h.state!=0)?1:0)).update(t,i));r.length==this.active.length&&r.every((a,c)=>a==this.active[c])&&(r=this.active);let o=this.open,l=t.effects.some(a=>a.is(dv));o&&t.docChanged&&(o=o.map(t.changes)),t.selection||r.some(a=>a.hasResult()&&t.changes.touchesRange(a.from,a.to))||!Rle(r,this.active)||l?o=Ka.build(r,e,this.id,o,i,l):o&&o.disabled&&!r.some(a=>a.isPending)&&(o=null),!o&&r.every(a=>!a.isPending)&&r.some(a=>a.hasResult())&&(r=r.map(a=>a.hasResult()?new as(a.source,0):a));for(let a of t.effects)a.is(mV)&&(o=o&&o.setSelected(a.value,this.id));return r==this.active&&o==this.open?this:new rp(r,this.id,o)}get tooltip(){return this.open?this.open.tooltip:null}get attrs(){return this.open?this.open.attrs:this.active.length?Vle:Mle}}function Rle(s,t){if(s==t)return!0;for(let e=0,i=0;;){for(;e<s.length&&!s[e].hasResult();)e++;for(;i<t.length&&!t[i].hasResult();)i++;let n=e==s.length,r=i==t.length;if(n||r)return n==r;if(s[e++].result!=t[i++].result)return!1}}const Vle={"aria-autocomplete":"list"},Mle={};function JT(s,t){let e={"aria-autocomplete":"list","aria-haspopup":"listbox","aria-controls":s};return t>-1&&(e["aria-activedescendant"]=s+"-"+t),e}const Lle=[];function fV(s,t){if(s.isUserEvent("input.complete")){let i=s.annotation(hv);if(i&&t.activateOnCompletion(i))return 12}let e=s.isUserEvent("input.type");return e&&t.activateOnTyping?5:e?1:s.isUserEvent("delete.backward")?2:s.selection?8:s.docChanged?16:0}class as{constructor(t,e,i=!1){this.source=t,this.state=e,this.explicit=i}hasResult(){return!1}get isPending(){return this.state==1}update(t,e){let i=fV(t,e),n=this;(i&8||i&16&&this.touches(t))&&(n=new as(n.source,0)),i&4&&n.state==0&&(n=new as(this.source,1)),n=n.updateFor(t,i);for(let r of t.effects)if(r.is(sp))n=new as(n.source,1,r.value);else if(r.is(ed))n=new as(n.source,0);else if(r.is(dv))for(let o of r.value)o.source==n.source&&(n=o);return n}updateFor(t,e){return this.map(t.changes)}map(t){return this}touches(t){return t.changes.touchesRange(Sl(t.state))}}class cc extends as{constructor(t,e,i,n,r,o){super(t,3,e),this.limit=i,this.result=n,this.from=r,this.to=o}hasResult(){return!0}updateFor(t,e){var i;if(!(e&3))return this.map(t.changes);let n=this.result;n.map&&!t.changes.empty&&(n=n.map(n,t.changes));let r=t.changes.mapPos(this.from),o=t.changes.mapPos(this.to,1),l=Sl(t.state);if(l>o||!n||e&2&&(Sl(t.startState)==this.from||l<this.limit))return new as(this.source,e&4?1:0);let a=t.changes.mapPos(this.limit);return Ble(n.validFor,t.state,r,o)?new cc(this.source,this.explicit,a,n,r,o):n.update&&(n=n.update(n,r,o,new uv(t.state,l,!1)))?new cc(this.source,this.explicit,a,n,n.from,(i=n.to)!==null&&i!==void 0?i:Sl(t.state)):new as(this.source,1,this.explicit)}map(t){return t.empty?this:(this.result.map?this.result.map(this.result,t):this.result)?new cc(this.source,this.explicit,t.mapPos(this.limit),this.result,t.mapPos(this.from),t.mapPos(this.to,1)):new as(this.source,0)}touches(t){return t.changes.touchesRange(this.from,this.to)}}function Ble(s,t,e,i){if(!s)return!1;let n=t.sliceDoc(e,i);return typeof s=="function"?s(n,e,i,t):dV(s,!0).test(n)}const dv=rt.define({map(s,t){return s.map(e=>e.map(t))}}),mV=rt.define(),xn=Pn.define({create(){return rp.start()},update(s,t){return s.update(t)},provide:s=>[nR.from(s,t=>t.tooltip),Ee.contentAttributes.from(s,t=>t.attrs)]});function fv(s,t){const e=t.completion.apply||t.completion.label;let i=s.state.field(xn).active.find(n=>n.source==t.source);return i instanceof cc?(typeof e=="string"?s.dispatch(Object.assign(Object.assign({},vle(s.state,e,i.from,i.to)),{annotations:hv.of(t.completion)})):e(s,t.completion,i.from,i.to),!0):!1}const $le=Ele(xn,fv);function Cm(s,t="option"){return e=>{let i=e.state.field(xn,!1);if(!i||!i.open||i.open.disabled||Date.now()-i.open.timestamp<e.state.facet(yi).interactionDelay)return!1;let n=1,r;t=="page"&&(r=sR(e,i.open.tooltip))&&(n=Math.max(2,Math.floor(r.dom.offsetHeight/r.dom.querySelector("li").offsetHeight)-1));let{length:o}=i.open.options,l=i.open.selected>-1?i.open.selected+n*(s?1:-1):s?0:o-1;return l<0?l=t=="page"?0:o-1:l>=o&&(l=t=="page"?o-1:0),e.dispatch({effects:mV.of(l)}),!0}}const Dle=s=>{let t=s.state.field(xn,!1);return s.state.readOnly||!t||!t.open||t.open.selected<0||t.open.disabled||Date.now()-t.open.timestamp<s.state.facet(yi).interactionDelay?!1:fv(s,t.open.options[t.open.selected])},eE=s=>s.state.field(xn,!1)?(s.dispatch({effects:sp.of(!0)}),!0):!1,Qle=s=>{let t=s.state.field(xn,!1);return!t||!t.active.some(e=>e.state!=0)?!1:(s.dispatch({effects:ed.of(null)}),!0)};class Nle{constructor(t,e){this.active=t,this.context=e,this.time=Date.now(),this.updates=[],this.done=void 0}}const Fle=50,zle=1e3,Wle=Hi.fromClass(class{constructor(s){this.view=s,this.debounceUpdate=-1,this.running=[],this.debounceAccept=-1,this.pendingStart=!1,this.composing=0;for(let t of s.state.field(xn).active)t.isPending&&this.startQuery(t)}update(s){let t=s.state.field(xn),e=s.state.facet(yi);if(!s.selectionSet&&!s.docChanged&&s.startState.field(xn)==t)return;let i=s.transactions.some(r=>{let o=fV(r,e);return o&8||(r.selection||r.docChanged)&&!(o&3)});for(let r=0;r<this.running.length;r++){let o=this.running[r];if(i||o.context.abortOnDocChange&&s.docChanged||o.updates.length+s.transactions.length>Fle&&Date.now()-o.time>zle){for(let l of o.context.abortListeners)try{l()}catch(a){Fn(this.view.state,a)}o.context.abortListeners=null,this.running.splice(r--,1)}else o.updates.push(...s.transactions)}this.debounceUpdate>-1&&clearTimeout(this.debounceUpdate),s.transactions.some(r=>r.effects.some(o=>o.is(sp)))&&(this.pendingStart=!0);let n=this.pendingStart?50:e.activateOnTypingDelay;if(this.debounceUpdate=t.active.some(r=>r.isPending&&!this.running.some(o=>o.active.source==r.source))?setTimeout(()=>this.startUpdate(),n):-1,this.composing!=0)for(let r of s.transactions)r.isUserEvent("input.type")?this.composing=2:this.composing==2&&r.selection&&(this.composing=3)}startUpdate(){this.debounceUpdate=-1,this.pendingStart=!1;let{state:s}=this.view,t=s.field(xn);for(let e of t.active)e.isPending&&!this.running.some(i=>i.active.source==e.source)&&this.startQuery(e);this.running.length&&t.open&&t.open.disabled&&(this.debounceAccept=setTimeout(()=>this.accept(),this.view.state.facet(yi).updateSyncTime))}startQuery(s){let{state:t}=this.view,e=Sl(t),i=new uv(t,e,s.explicit,this.view),n=new Nle(s,i);this.running.push(n),Promise.resolve(s.source(i)).then(r=>{n.context.aborted||(n.done=r||null,this.scheduleAccept())},r=>{this.view.dispatch({effects:ed.of(null)}),Fn(this.view.state,r)})}scheduleAccept(){this.running.every(s=>s.done!==void 0)?this.accept():this.debounceAccept<0&&(this.debounceAccept=setTimeout(()=>this.accept(),this.view.state.facet(yi).updateSyncTime))}accept(){var s;this.debounceAccept>-1&&clearTimeout(this.debounceAccept),this.debounceAccept=-1;let t=[],e=this.view.state.facet(yi),i=this.view.state.field(xn);for(let n=0;n<this.running.length;n++){let r=this.running[n];if(r.done===void 0)continue;if(this.running.splice(n--,1),r.done){let l=Sl(r.updates.length?r.updates[0].startState:this.view.state),a=Math.min(l,r.done.from+(r.active.explicit?0:1)),c=new cc(r.active.source,r.active.explicit,a,r.done,r.done.from,(s=r.done.to)!==null&&s!==void 0?s:l);for(let h of r.updates)c=c.update(h,e);if(c.hasResult()){t.push(c);continue}}let o=i.active.find(l=>l.source==r.active.source);if(o&&o.isPending)if(r.done==null){let l=new as(r.active.source,0);for(let a of r.updates)l=l.update(a,e);l.isPending||t.push(l)}else this.startQuery(o)}(t.length||i.open&&i.open.disabled)&&this.view.dispatch({effects:dv.of(t)})}},{eventHandlers:{blur(s){let t=this.view.state.field(xn,!1);if(t&&t.tooltip&&this.view.state.facet(yi).closeOnBlur){let e=t.open&&sR(this.view,t.open.tooltip);(!e||!e.dom.contains(s.relatedTarget))&&setTimeout(()=>this.view.dispatch({effects:ed.of(null)}),10)}},compositionstart(){this.composing=1},compositionend(){this.composing==3&&setTimeout(()=>this.view.dispatch({effects:sp.of(!1)}),20),this.composing=0}}}),Ule=typeof navigator=="object"&&/Win/.test(navigator.platform),Zle=zo.highest(Ee.domEventHandlers({keydown(s,t){let e=t.state.field(xn,!1);if(!e||!e.open||e.open.disabled||e.open.selected<0||s.key.length>1||s.ctrlKey&&!(Ule&&s.altKey)||s.metaKey)return!1;let i=e.open.options[e.open.selected],n=e.active.find(o=>o.source==i.source),r=i.completion.commitCharacters||n.result.commitCharacters;return r&&r.indexOf(s.key)>-1&&fv(t,i),!1}})),gV=Ee.baseTheme({".cm-tooltip.cm-tooltip-autocomplete":{"& > ul":{fontFamily:"monospace",whiteSpace:"nowrap",overflow:"hidden auto",maxWidth_fallback:"700px",maxWidth:"min(700px, 95vw)",minWidth:"250px",maxHeight:"10em",height:"100%",listStyle:"none",margin:0,padding:0,"& > li, & > completion-section":{padding:"1px 3px",lineHeight:1.2},"& > li":{overflowX:"hidden",textOverflow:"ellipsis",cursor:"pointer"},"& > completion-section":{display:"list-item",borderBottom:"1px solid silver",paddingLeft:"0.5em",opacity:.7}}},"&light .cm-tooltip-autocomplete ul li[aria-selected]":{background:"#17c",color:"white"},"&light .cm-tooltip-autocomplete-disabled ul li[aria-selected]":{background:"#777"},"&dark .cm-tooltip-autocomplete ul li[aria-selected]":{background:"#347",color:"white"},"&dark .cm-tooltip-autocomplete-disabled ul li[aria-selected]":{background:"#444"},".cm-completionListIncompleteTop:before, .cm-completionListIncompleteBottom:after":{content:'"···"',opacity:.5,display:"block",textAlign:"center"},".cm-tooltip.cm-completionInfo":{position:"absolute",padding:"3px 9px",width:"max-content",maxWidth:"400px",boxSizing:"border-box",whiteSpace:"pre-line"},".cm-completionInfo.cm-completionInfo-left":{right:"100%"},".cm-completionInfo.cm-completionInfo-right":{left:"100%"},".cm-completionInfo.cm-completionInfo-left-narrow":{right:"30px"},".cm-completionInfo.cm-completionInfo-right-narrow":{left:"30px"},"&light .cm-snippetField":{backgroundColor:"#00000022"},"&dark .cm-snippetField":{backgroundColor:"#ffffff22"},".cm-snippetFieldPosition":{verticalAlign:"text-top",width:0,height:"1.15em",display:"inline-block",margin:"0 -0.7px -.7em",borderLeft:"1.4px dotted #888"},".cm-completionMatchedText":{textDecoration:"underline"},".cm-completionDetail":{marginLeft:"0.5em",fontStyle:"italic"},".cm-completionIcon":{fontSize:"90%",width:".8em",display:"inline-block",textAlign:"center",paddingRight:".6em",opacity:"0.6",boxSizing:"content-box"},".cm-completionIcon-function, .cm-completionIcon-method":{"&:after":{content:"'ƒ'"}},".cm-completionIcon-class":{"&:after":{content:"'○'"}},".cm-completionIcon-interface":{"&:after":{content:"'◌'"}},".cm-completionIcon-variable":{"&:after":{content:"'𝑥'"}},".cm-completionIcon-constant":{"&:after":{content:"'𝐶'"}},".cm-completionIcon-type":{"&:after":{content:"'𝑡'"}},".cm-completionIcon-enum":{"&:after":{content:"'∪'"}},".cm-completionIcon-property":{"&:after":{content:"'□'"}},".cm-completionIcon-keyword":{"&:after":{content:"'🔑︎'"}},".cm-completionIcon-namespace":{"&:after":{content:"'▢'"}},".cm-completionIcon-text":{"&:after":{content:"'abc'",fontSize:"50%",verticalAlign:"middle"}}});class Hle{constructor(t,e,i,n){this.field=t,this.line=e,this.from=i,this.to=n}}class mv{constructor(t,e,i){this.field=t,this.from=e,this.to=i}map(t){let e=t.mapPos(this.from,-1,Wi.TrackDel),i=t.mapPos(this.to,1,Wi.TrackDel);return e==null||i==null?null:new mv(this.field,e,i)}}class gv{constructor(t,e){this.lines=t,this.fieldPositions=e}instantiate(t,e){let i=[],n=[e],r=t.doc.lineAt(e),o=/^\s*/.exec(r.text)[0];for(let a of this.lines){if(i.length){let c=o,h=/^\t*/.exec(a)[0].length;for(let f=0;f<h;f++)c+=t.facet(Cd);n.push(e+c.length-h),a=c+a.slice(h)}i.push(a),e+=a.length+1}let l=this.fieldPositions.map(a=>new mv(a.field,n[a.line]+a.from,n[a.line]+a.to));return{text:i,ranges:l}}static parse(t){let e=[],i=[],n=[],r;for(let o of t.split(/\r\n?|\n/)){for(;r=/[#$]\{(?:(\d+)(?::([^}]*))?|((?:\\[{}]|[^}])*))\}/.exec(o);){let l=r[1]?+r[1]:null,a=r[2]||r[3]||"",c=-1,h=a.replace(/\\[{}]/g,f=>f[1]);for(let f=0;f<e.length;f++)(l!=null?e[f].seq==l:h&&e[f].name==h)&&(c=f);if(c<0){let f=0;for(;f<e.length&&(l==null||e[f].seq!=null&&e[f].seq<l);)f++;e.splice(f,0,{seq:l,name:h}),c=f;for(let m of n)m.field>=c&&m.field++}n.push(new Hle(c,i.length,r.index,r.index+h.length)),o=o.slice(0,r.index)+a+o.slice(r.index+r[0].length)}o=o.replace(/\\([{}])/g,(l,a,c)=>{for(let h of n)h.line==i.length&&h.from>c&&(h.from--,h.to--);return a}),i.push(o)}return new gv(i,n)}}let qle=Je.widget({widget:new class extends Wo{toDOM(){let s=document.createElement("span");return s.className="cm-snippetFieldPosition",s}ignoreEvent(){return!1}}}),jle=Je.mark({class:"cm-snippetField"});class Qc{constructor(t,e){this.ranges=t,this.active=e,this.deco=Je.set(t.map(i=>(i.from==i.to?qle:jle).range(i.from,i.to)))}map(t){let e=[];for(let i of this.ranges){let n=i.map(t);if(!n)return null;e.push(n)}return new Qc(e,this.active)}selectionInsideField(t){return t.ranges.every(e=>this.ranges.some(i=>i.field==this.active&&i.from<=e.from&&i.to>=e.to))}}const Id=rt.define({map(s,t){return s&&s.map(t)}}),Xle=rt.define(),td=Pn.define({create(){return null},update(s,t){for(let e of t.effects){if(e.is(Id))return e.value;if(e.is(Xle)&&s)return new Qc(s.ranges,e.value)}return s&&t.docChanged&&(s=s.map(t.changes)),s&&t.selection&&!s.selectionInsideField(t.selection)&&(s=null),s},provide:s=>Ee.decorations.from(s,t=>t?t.deco:Je.none)});function pv(s,t){return se.create(s.filter(e=>e.field==t).map(e=>se.range(e.from,e.to)))}function Gle(s){let t=gv.parse(s);return(e,i,n,r)=>{let{text:o,ranges:l}=t.instantiate(e.state,n),{main:a}=e.state.selection,c={changes:{from:n,to:r==a.from?a.to:r,insert:Ke.of(o)},scrollIntoView:!0,annotations:i?[hv.of(i),Jt.userEvent.of("input.complete")]:void 0};if(l.length&&(c.selection=pv(l,0)),l.some(h=>h.field>0)){let h=new Qc(l,0),f=c.effects=[Id.of(h)];e.state.field(td,!1)===void 0&&f.push(rt.appendConfig.of([td,tae,iae,gV]))}e.dispatch(e.state.update(c))}}function pV(s){return({state:t,dispatch:e})=>{let i=t.field(td,!1);if(!i||s<0&&i.active==0)return!1;let n=i.active+s,r=s>0&&!i.ranges.some(o=>o.field==n+s);return e(t.update({selection:pv(i.ranges,n),effects:Id.of(r?null:new Qc(i.ranges,n)),scrollIntoView:!0})),!0}}const Yle=({state:s,dispatch:t})=>s.field(td,!1)?(t(s.update({effects:Id.of(null)})),!0):!1,Kle=pV(1),Jle=pV(-1),eae=[{key:"Tab",run:Kle,shift:Jle},{key:"Escape",run:Yle}],tE=Pe.define({combine(s){return s.length?s[0]:eae}}),tae=zo.highest(_d.compute([tE],s=>s.facet(tE)));function fn(s,t){return Object.assign(Object.assign({},t),{apply:Gle(s)})}const iae=Ee.domEventHandlers({mousedown(s,t){let e=t.state.field(td,!1),i;if(!e||(i=t.posAtCoords({x:s.clientX,y:s.clientY}))==null)return!1;let n=e.ranges.find(r=>r.from<=i&&r.to>=i);return!n||n.field==e.active?!1:(t.dispatch({selection:pv(e.ranges,n.field),effects:Id.of(e.ranges.some(r=>r.field>n.field)?new Qc(e.ranges,n.field):null),scrollIntoView:!0}),!0)}}),id={brackets:["(","[","{","'",'"'],before:")]}:;>",stringPrefixes:[]},yl=rt.define({map(s,t){let e=t.mapPos(s,-1,Wi.TrackAfter);return e??void 0}}),wv=new class extends Rl{};wv.startSide=1;wv.endSide=-1;const wV=Pn.define({create(){return st.empty},update(s,t){if(s=s.map(t.changes),t.selection){let e=t.state.doc.lineAt(t.selection.main.head);s=s.update({filter:i=>i>=e.from&&i<=e.to})}for(let e of t.effects)e.is(yl)&&(s=s.update({add:[wv.range(e.value,e.value+1)]}));return s}});function nae(){return[rae,wV]}const rb="()[]{}<>«»»«［］｛｝";function xV(s){for(let t=0;t<rb.length;t+=2)if(rb.charCodeAt(t)==s)return rb.charAt(t+1);return W4(s<128?s:s+1)}function bV(s,t){return s.languageDataAt("closeBrackets",t)[0]||id}const sae=typeof navigator=="object"&&/Android\b/.test(navigator.userAgent),rae=Ee.inputHandler.of((s,t,e,i)=>{if((sae?s.composing:s.compositionStarted)||s.state.readOnly)return!1;let n=s.state.selection.main;if(i.length>2||i.length==2&&Tr($n(i,0))==1||t!=n.from||e!=n.to)return!1;let r=aae(s.state,i);return r?(s.dispatch(r),!0):!1}),oae=({state:s,dispatch:t})=>{if(s.readOnly)return!1;let i=bV(s,s.selection.main.head).brackets||id.brackets,n=null,r=s.changeByRange(o=>{if(o.empty){let l=cae(s.doc,o.head);for(let a of i)if(a==l&&qp(s.doc,o.head)==xV($n(a,0)))return{changes:{from:o.head-a.length,to:o.head+a.length},range:se.cursor(o.head-a.length)}}return{range:n=o}});return n||t(s.update(r,{scrollIntoView:!0,userEvent:"delete.backward"})),!n},lae=[{key:"Backspace",run:oae}];function aae(s,t){let e=bV(s,s.selection.main.head),i=e.brackets||id.brackets;for(let n of i){let r=xV($n(n,0));if(t==n)return r==n?dae(s,n,i.indexOf(n+n+n)>-1,e):uae(s,n,r,e.before||id.before);if(t==r&&OV(s,s.selection.main.from))return hae(s,n,r)}return null}function OV(s,t){let e=!1;return s.field(wV).between(0,s.doc.length,i=>{i==t&&(e=!0)}),e}function qp(s,t){let e=s.sliceString(t,t+2);return e.slice(0,Tr($n(e,0)))}function cae(s,t){let e=s.sliceString(t-2,t);return Tr($n(e,0))==e.length?e:e.slice(1)}function uae(s,t,e,i){let n=null,r=s.changeByRange(o=>{if(!o.empty)return{changes:[{insert:t,from:o.from},{insert:e,from:o.to}],effects:yl.of(o.to+t.length),range:se.range(o.anchor+t.length,o.head+t.length)};let l=qp(s.doc,o.head);return!l||/\s/.test(l)||i.indexOf(l)>-1?{changes:{insert:t+e,from:o.head},effects:yl.of(o.head+t.length),range:se.cursor(o.head+t.length)}:{range:n=o}});return n?null:s.update(r,{scrollIntoView:!0,userEvent:"input.type"})}function hae(s,t,e){let i=null,n=s.changeByRange(r=>r.empty&&qp(s.doc,r.head)==e?{changes:{from:r.head,to:r.head+e.length,insert:e},range:se.cursor(r.head+e.length)}:i={range:r});return i?null:s.update(n,{scrollIntoView:!0,userEvent:"input.type"})}function dae(s,t,e,i){let n=i.stringPrefixes||id.stringPrefixes,r=null,o=s.changeByRange(l=>{if(!l.empty)return{changes:[{insert:t,from:l.from},{insert:t,from:l.to}],effects:yl.of(l.to+t.length),range:se.range(l.anchor+t.length,l.head+t.length)};let a=l.head,c=qp(s.doc,a),h;if(c==t){if(iE(s,a))return{changes:{insert:t+t,from:a},effects:yl.of(a+t.length),range:se.cursor(a+t.length)};if(OV(s,a)){let m=e&&s.sliceDoc(a,a+t.length*3)==t+t+t?t+t+t:t;return{changes:{from:a,to:a+m.length,insert:m},range:se.cursor(a+m.length)}}}else{if(e&&s.sliceDoc(a-2*t.length,a)==t+t&&(h=nE(s,a-2*t.length,n))>-1&&iE(s,h))return{changes:{insert:t+t+t+t,from:a},effects:yl.of(a+t.length),range:se.cursor(a+t.length)};if(s.charCategorizer(a)(c)!=ss.Word&&nE(s,a,n)>-1&&!fae(s,a,t,n))return{changes:{insert:t+t,from:a},effects:yl.of(a+t.length),range:se.cursor(a+t.length)}}return{range:r=l}});return r?null:s.update(o,{scrollIntoView:!0,userEvent:"input.type"})}function iE(s,t){let e=St(s).resolveInner(t+1);return e.parent&&e.from==t}function fae(s,t,e,i){let n=St(s).resolveInner(t,-1),r=i.reduce((o,l)=>Math.max(o,l.length),0);for(let o=0;o<5;o++){let l=s.sliceDoc(n.from,Math.min(n.to,n.from+e.length+r)),a=l.indexOf(e);if(!a||a>-1&&i.indexOf(l.slice(0,a))>-1){let h=n.firstChild;for(;h&&h.from==n.from&&h.to-h.from>e.length+a;){if(s.sliceDoc(h.to-e.length,h.to)==e)return!1;h=h.firstChild}return!0}let c=n.to==t&&n.parent;if(!c)break;n=c}return!1}function nE(s,t,e){let i=s.charCategorizer(t);if(i(s.sliceDoc(t-1,t))!=ss.Word)return t;for(let n of e){let r=t-n.length;if(s.sliceDoc(r,t)==n&&i(s.sliceDoc(r-1,r))!=ss.Word)return r}return-1}function mae(s={}){return[Zle,xn,yi.of(s),Wle,gae,gV]}const yV=[{key:"Ctrl-Space",run:eE},{mac:"Alt-`",run:eE},{key:"Escape",run:Qle},{key:"ArrowDown",run:Cm(!0)},{key:"ArrowUp",run:Cm(!1)},{key:"PageDown",run:Cm(!0,"page")},{key:"PageUp",run:Cm(!1,"page")},{key:"Enter",run:Dle}],gae=zo.highest(_d.computeN([yi],s=>s.facet(yi).defaultKeymap?[yV]:[]));var sE={};class op{constructor(t,e,i,n,r,o,l,a,c,h=0,f){this.p=t,this.stack=e,this.state=i,this.reducePos=n,this.pos=r,this.score=o,this.buffer=l,this.bufferBase=a,this.curContext=c,this.lookAhead=h,this.parent=f}toString(){return`[${this.stack.filter((t,e)=>e%3==0).concat(this.state)}]@${this.pos}${this.score?"!"+this.score:""}`}static start(t,e,i=0){let n=t.parser.context;return new op(t,[],e,i,i,0,[],0,n?new rE(n,n.start):null,0,null)}get context(){return this.curContext?this.curContext.context:null}pushState(t,e){this.stack.push(this.state,e,this.bufferBase+this.buffer.length),this.state=t}reduce(t){var e;let i=t>>19,n=t&65535,{parser:r}=this.p,o=this.reducePos<this.pos-25;o&&this.setLookAhead(this.pos);let l=r.dynamicPrecedence(n);if(l&&(this.score+=l),i==0){this.pushState(r.getGoto(this.state,n,!0),this.reducePos),n<r.minRepeatTerm&&this.storeNode(n,this.reducePos,this.reducePos,o?8:4,!0),this.reduceContext(n,this.reducePos);return}let a=this.stack.length-(i-1)*3-(t&262144?6:0),c=a?this.stack[a-2]:this.p.ranges[0].from,h=this.reducePos-c;h>=2e3&&!(!((e=this.p.parser.nodeSet.types[n])===null||e===void 0)&&e.isAnonymous)&&(c==this.p.lastBigReductionStart?(this.p.bigReductionCount++,this.p.lastBigReductionSize=h):this.p.lastBigReductionSize<h&&(this.p.bigReductionCount=1,this.p.lastBigReductionStart=c,this.p.lastBigReductionSize=h));let f=a?this.stack[a-1]:0,m=this.bufferBase+this.buffer.length-f;if(n<r.minRepeatTerm||t&131072){let w=r.stateFlag(this.state,1)?this.pos:this.reducePos;this.storeNode(n,c,w,m+4,!0)}if(t&262144)this.state=this.stack[a];else{let w=this.stack[a-3];this.state=r.getGoto(w,n,!0)}for(;this.stack.length>a;)this.stack.pop();this.reduceContext(n,c)}storeNode(t,e,i,n=4,r=!1){if(t==0&&(!this.stack.length||this.stack[this.stack.length-1]<this.buffer.length+this.bufferBase)){let o=this,l=this.buffer.length;if(l==0&&o.parent&&(l=o.bufferBase-o.parent.bufferBase,o=o.parent),l>0&&o.buffer[l-4]==0&&o.buffer[l-1]>-1){if(e==i)return;if(o.buffer[l-2]>=e){o.buffer[l-2]=i;return}}}if(!r||this.pos==i)this.buffer.push(t,e,i,n);else{let o=this.buffer.length;if(o>0&&this.buffer[o-4]!=0){let l=!1;for(let a=o;a>0&&this.buffer[a-2]>i;a-=4)if(this.buffer[a-1]>=0){l=!0;break}if(l)for(;o>0&&this.buffer[o-2]>i;)this.buffer[o]=this.buffer[o-4],this.buffer[o+1]=this.buffer[o-3],this.buffer[o+2]=this.buffer[o-2],this.buffer[o+3]=this.buffer[o-1],o-=4,n>4&&(n-=4)}this.buffer[o]=t,this.buffer[o+1]=e,this.buffer[o+2]=i,this.buffer[o+3]=n}}shift(t,e,i,n){if(t&131072)this.pushState(t&65535,this.pos);else if((t&262144)==0){let r=t,{parser:o}=this.p;(n>this.pos||e<=o.maxNode)&&(this.pos=n,o.stateFlag(r,1)||(this.reducePos=n)),this.pushState(r,i),this.shiftContext(e,i),e<=o.maxNode&&this.buffer.push(e,i,n,4)}else this.pos=n,this.shiftContext(e,i),e<=this.p.parser.maxNode&&this.buffer.push(e,i,n,4)}apply(t,e,i,n){t&65536?this.reduce(t):this.shift(t,e,i,n)}useNode(t,e){let i=this.p.reused.length-1;(i<0||this.p.reused[i]!=t)&&(this.p.reused.push(t),i++);let n=this.pos;this.reducePos=this.pos=n+t.length,this.pushState(e,n),this.buffer.push(i,n,this.reducePos,-1),this.curContext&&this.updateContext(this.curContext.tracker.reuse(this.curContext.context,t,this,this.p.stream.reset(this.pos-t.length)))}split(){let t=this,e=t.buffer.length;for(;e>0&&t.buffer[e-2]>t.reducePos;)e-=4;let i=t.buffer.slice(e),n=t.bufferBase+e;for(;t&&n==t.bufferBase;)t=t.parent;return new op(this.p,this.stack.slice(),this.state,this.reducePos,this.pos,this.score,i,n,this.curContext,this.lookAhead,t)}recoverByDelete(t,e){let i=t<=this.p.parser.maxNode;i&&this.storeNode(t,this.pos,e,4),this.storeNode(0,this.pos,e,i?8:4),this.pos=this.reducePos=e,this.score-=190}canShift(t){for(let e=new pae(this);;){let i=this.p.parser.stateSlot(e.state,4)||this.p.parser.hasAction(e.state,t);if(i==0)return!1;if((i&65536)==0)return!0;e.reduce(i)}}recoverByInsert(t){if(this.stack.length>=300)return[];let e=this.p.parser.nextStates(this.state);if(e.length>8||this.stack.length>=120){let n=[];for(let r=0,o;r<e.length;r+=2)(o=e[r+1])!=this.state&&this.p.parser.hasAction(o,t)&&n.push(e[r],o);if(this.stack.length<120)for(let r=0;n.length<8&&r<e.length;r+=2){let o=e[r+1];n.some((l,a)=>a&1&&l==o)||n.push(e[r],o)}e=n}let i=[];for(let n=0;n<e.length&&i.length<4;n+=2){let r=e[n+1];if(r==this.state)continue;let o=this.split();o.pushState(r,this.pos),o.storeNode(0,o.pos,o.pos,4,!0),o.shiftContext(e[n],this.pos),o.reducePos=this.pos,o.score-=200,i.push(o)}return i}forceReduce(){let{parser:t}=this.p,e=t.stateSlot(this.state,5);if((e&65536)==0)return!1;if(!t.validAction(this.state,e)){let i=e>>19,n=e&65535,r=this.stack.length-i*3;if(r<0||t.getGoto(this.stack[r],n,!1)<0){let o=this.findForcedReduction();if(o==null)return!1;e=o}this.storeNode(0,this.pos,this.pos,4,!0),this.score-=100}return this.reducePos=this.pos,this.reduce(e),!0}findForcedReduction(){let{parser:t}=this.p,e=[],i=(n,r)=>{if(!e.includes(n))return e.push(n),t.allActions(n,o=>{if(!(o&393216))if(o&65536){let l=(o>>19)-r;if(l>1){let a=o&65535,c=this.stack.length-l*3;if(c>=0&&t.getGoto(this.stack[c],a,!1)>=0)return l<<19|65536|a}}else{let l=i(o,r+1);if(l!=null)return l}})};return i(this.state,0)}forceAll(){for(;!this.p.parser.stateFlag(this.state,2);)if(!this.forceReduce()){this.storeNode(0,this.pos,this.pos,4,!0);break}return this}get deadEnd(){if(this.stack.length!=3)return!1;let{parser:t}=this.p;return t.data[t.stateSlot(this.state,1)]==65535&&!t.stateSlot(this.state,4)}restart(){this.storeNode(0,this.pos,this.pos,4,!0),this.state=this.stack[0],this.stack.length=0}sameState(t){if(this.state!=t.state||this.stack.length!=t.stack.length)return!1;for(let e=0;e<this.stack.length;e+=3)if(this.stack[e]!=t.stack[e])return!1;return!0}get parser(){return this.p.parser}dialectEnabled(t){return this.p.parser.dialect.flags[t]}shiftContext(t,e){this.curContext&&this.updateContext(this.curContext.tracker.shift(this.curContext.context,t,this,this.p.stream.reset(e)))}reduceContext(t,e){this.curContext&&this.updateContext(this.curContext.tracker.reduce(this.curContext.context,t,this,this.p.stream.reset(e)))}emitContext(){let t=this.buffer.length-1;(t<0||this.buffer[t]!=-3)&&this.buffer.push(this.curContext.hash,this.pos,this.pos,-3)}emitLookAhead(){let t=this.buffer.length-1;(t<0||this.buffer[t]!=-4)&&this.buffer.push(this.lookAhead,this.pos,this.pos,-4)}updateContext(t){if(t!=this.curContext.context){let e=new rE(this.curContext.tracker,t);e.hash!=this.curContext.hash&&this.emitContext(),this.curContext=e}}setLookAhead(t){t>this.lookAhead&&(this.emitLookAhead(),this.lookAhead=t)}close(){this.curContext&&this.curContext.tracker.strict&&this.emitContext(),this.lookAhead>0&&this.emitLookAhead()}}class rE{constructor(t,e){this.tracker=t,this.context=e,this.hash=t.strict?t.hash(e):0}}class pae{constructor(t){this.start=t,this.state=t.state,this.stack=t.stack,this.base=this.stack.length}reduce(t){let e=t&65535,i=t>>19;i==0?(this.stack==this.start.stack&&(this.stack=this.stack.slice()),this.stack.push(this.state,0,0),this.base+=3):this.base-=(i-1)*3;let n=this.start.p.parser.getGoto(this.stack[this.base-3],e,!0);this.state=n}}class lp{constructor(t,e,i){this.stack=t,this.pos=e,this.index=i,this.buffer=t.buffer,this.index==0&&this.maybeNext()}static create(t,e=t.bufferBase+t.buffer.length){return new lp(t,e,e-t.bufferBase)}maybeNext(){let t=this.stack.parent;t!=null&&(this.index=this.stack.bufferBase-t.bufferBase,this.stack=t,this.buffer=t.buffer)}get id(){return this.buffer[this.index-4]}get start(){return this.buffer[this.index-3]}get end(){return this.buffer[this.index-2]}get size(){return this.buffer[this.index-1]}next(){this.index-=4,this.pos-=4,this.index==0&&this.maybeNext()}fork(){return new lp(this.stack,this.pos,this.index)}}function sh(s,t=Uint16Array){if(typeof s!="string")return s;let e=null;for(let i=0,n=0;i<s.length;){let r=0;for(;;){let o=s.charCodeAt(i++),l=!1;if(o==126){r=65535;break}o>=92&&o--,o>=34&&o--;let a=o-32;if(a>=46&&(a-=46,l=!0),r+=a,l)break;r*=46}e?e[n++]=r:e=new t(r)}return e}class ng{constructor(){this.start=-1,this.value=-1,this.end=-1,this.extended=-1,this.lookAhead=0,this.mask=0,this.context=0}}const oE=new ng;class wae{constructor(t,e){this.input=t,this.ranges=e,this.chunk="",this.chunkOff=0,this.chunk2="",this.chunk2Pos=0,this.next=-1,this.token=oE,this.rangeIndex=0,this.pos=this.chunkPos=e[0].from,this.range=e[0],this.end=e[e.length-1].to,this.readNext()}resolveOffset(t,e){let i=this.range,n=this.rangeIndex,r=this.pos+t;for(;r<i.from;){if(!n)return null;let o=this.ranges[--n];r-=i.from-o.to,i=o}for(;e<0?r>i.to:r>=i.to;){if(n==this.ranges.length-1)return null;let o=this.ranges[++n];r+=o.from-i.to,i=o}return r}clipPos(t){if(t>=this.range.from&&t<this.range.to)return t;for(let e of this.ranges)if(e.to>t)return Math.max(t,e.from);return this.end}peek(t){let e=this.chunkOff+t,i,n;if(e>=0&&e<this.chunk.length)i=this.pos+t,n=this.chunk.charCodeAt(e);else{let r=this.resolveOffset(t,1);if(r==null)return-1;if(i=r,i>=this.chunk2Pos&&i<this.chunk2Pos+this.chunk2.length)n=this.chunk2.charCodeAt(i-this.chunk2Pos);else{let o=this.rangeIndex,l=this.range;for(;l.to<=i;)l=this.ranges[++o];this.chunk2=this.input.chunk(this.chunk2Pos=i),i+this.chunk2.length>l.to&&(this.chunk2=this.chunk2.slice(0,l.to-i)),n=this.chunk2.charCodeAt(0)}}return i>=this.token.lookAhead&&(this.token.lookAhead=i+1),n}acceptToken(t,e=0){let i=e?this.resolveOffset(e,-1):this.pos;if(i==null||i<this.token.start)throw new RangeError("Token end out of bounds");this.token.value=t,this.token.end=i}acceptTokenTo(t,e){this.token.value=t,this.token.end=e}getChunk(){if(this.pos>=this.chunk2Pos&&this.pos<this.chunk2Pos+this.chunk2.length){let{chunk:t,chunkPos:e}=this;this.chunk=this.chunk2,this.chunkPos=this.chunk2Pos,this.chunk2=t,this.chunk2Pos=e,this.chunkOff=this.pos-this.chunkPos}else{this.chunk2=this.chunk,this.chunk2Pos=this.chunkPos;let t=this.input.chunk(this.pos),e=this.pos+t.length;this.chunk=e>this.range.to?t.slice(0,this.range.to-this.pos):t,this.chunkPos=this.pos,this.chunkOff=0}}readNext(){return this.chunkOff>=this.chunk.length&&(this.getChunk(),this.chunkOff==this.chunk.length)?this.next=-1:this.next=this.chunk.charCodeAt(this.chunkOff)}advance(t=1){for(this.chunkOff+=t;this.pos+t>=this.range.to;){if(this.rangeIndex==this.ranges.length-1)return this.setDone();t-=this.range.to-this.pos,this.range=this.ranges[++this.rangeIndex],this.pos=this.range.from}return this.pos+=t,this.pos>=this.token.lookAhead&&(this.token.lookAhead=this.pos+1),this.readNext()}setDone(){return this.pos=this.chunkPos=this.end,this.range=this.ranges[this.rangeIndex=this.ranges.length-1],this.chunk="",this.next=-1}reset(t,e){if(e?(this.token=e,e.start=t,e.lookAhead=t+1,e.value=e.extended=-1):this.token=oE,this.pos!=t){if(this.pos=t,t==this.end)return this.setDone(),this;for(;t<this.range.from;)this.range=this.ranges[--this.rangeIndex];for(;t>=this.range.to;)this.range=this.ranges[++this.rangeIndex];t>=this.chunkPos&&t<this.chunkPos+this.chunk.length?this.chunkOff=t-this.chunkPos:(this.chunk="",this.chunkOff=0),this.readNext()}return this}read(t,e){if(t>=this.chunkPos&&e<=this.chunkPos+this.chunk.length)return this.chunk.slice(t-this.chunkPos,e-this.chunkPos);if(t>=this.chunk2Pos&&e<=this.chunk2Pos+this.chunk2.length)return this.chunk2.slice(t-this.chunk2Pos,e-this.chunk2Pos);if(t>=this.range.from&&e<=this.range.to)return this.input.read(t,e);let i="";for(let n of this.ranges){if(n.from>=e)break;n.to>t&&(i+=this.input.read(Math.max(n.from,t),Math.min(n.to,e)))}return i}}class uc{constructor(t,e){this.data=t,this.id=e}token(t,e){let{parser:i}=e.p;vV(this.data,t,e,this.id,i.data,i.tokenPrecTable)}}uc.prototype.contextual=uc.prototype.fallback=uc.prototype.extend=!1;class ap{constructor(t,e,i){this.precTable=e,this.elseToken=i,this.data=typeof t=="string"?sh(t):t}token(t,e){let i=t.pos,n=0;for(;;){let r=t.next<0,o=t.resolveOffset(1,1);if(vV(this.data,t,e,0,this.data,this.precTable),t.token.value>-1)break;if(this.elseToken==null)return;if(r||n++,o==null)break;t.reset(o,t.token)}n&&(t.reset(i,t.token),t.acceptToken(this.elseToken,n))}}ap.prototype.contextual=uc.prototype.fallback=uc.prototype.extend=!1;class Os{constructor(t,e={}){this.token=t,this.contextual=!!e.contextual,this.fallback=!!e.fallback,this.extend=!!e.extend}}function vV(s,t,e,i,n,r){let o=0,l=1<<i,{dialect:a}=e.p.parser;e:for(;(l&s[o])!=0;){let c=s[o+1];for(let w=o+3;w<c;w+=2)if((s[w+1]&l)>0){let O=s[w];if(a.allows(O)&&(t.token.value==-1||t.token.value==O||xae(O,t.token.value,n,r))){t.acceptToken(O);break}}let h=t.next,f=0,m=s[o+2];if(t.next<0&&m>f&&s[c+m*3-3]==65535){o=s[c+m*3-1];continue e}for(;f<m;){let w=f+m>>1,O=c+w+(w<<1),_=s[O],k=s[O+1]||65536;if(h<_)m=w;else if(h>=k)f=w+1;else{o=s[O+2],t.advance();continue e}}break}}function lE(s,t,e){for(let i=t,n;(n=s[i])!=65535;i++)if(n==e)return i-t;return-1}function xae(s,t,e,i){let n=lE(e,i,t);return n<0||lE(e,i,s)<n}const Vn=typeof process<"u"&&sE&&/\bparse\b/.test(sE.LOG);let ob=null;function aE(s,t,e){let i=s.cursor(kt.IncludeAnonymous);for(i.moveTo(t);;)if(!(e<0?i.childBefore(t):i.childAfter(t)))for(;;){if((e<0?i.to<t:i.from>t)&&!i.type.isError)return e<0?Math.max(0,Math.min(i.to-1,t-25)):Math.min(s.length,Math.max(i.from+1,t+25));if(e<0?i.prevSibling():i.nextSibling())break;if(!i.parent())return e<0?0:s.length}}let bae=class{constructor(t,e){this.fragments=t,this.nodeSet=e,this.i=0,this.fragment=null,this.safeFrom=-1,this.safeTo=-1,this.trees=[],this.start=[],this.index=[],this.nextFragment()}nextFragment(){let t=this.fragment=this.i==this.fragments.length?null:this.fragments[this.i++];if(t){for(this.safeFrom=t.openStart?aE(t.tree,t.from+t.offset,1)-t.offset:t.from,this.safeTo=t.openEnd?aE(t.tree,t.to+t.offset,-1)-t.offset:t.to;this.trees.length;)this.trees.pop(),this.start.pop(),this.index.pop();this.trees.push(t.tree),this.start.push(-t.offset),this.index.push(0),this.nextStart=this.safeFrom}else this.nextStart=1e9}nodeAt(t){if(t<this.nextStart)return null;for(;this.fragment&&this.safeTo<=t;)this.nextFragment();if(!this.fragment)return null;for(;;){let e=this.trees.length-1;if(e<0)return this.nextFragment(),null;let i=this.trees[e],n=this.index[e];if(n==i.children.length){this.trees.pop(),this.start.pop(),this.index.pop();continue}let r=i.children[n],o=this.start[e]+i.positions[n];if(o>t)return this.nextStart=o,null;if(r instanceof gt){if(o==t){if(o<this.safeFrom)return null;let l=o+r.length;if(l<=this.safeTo){let a=r.prop(Fe.lookAhead);if(!a||l+a<this.fragment.to)return r}}this.index[e]++,o+r.length>=Math.max(this.safeFrom,t)&&(this.trees.push(r),this.start.push(o),this.index.push(0))}else this.index[e]++,this.nextStart=o+r.length}}};class Oae{constructor(t,e){this.stream=e,this.tokens=[],this.mainToken=null,this.actions=[],this.tokens=t.tokenizers.map(i=>new ng)}getActions(t){let e=0,i=null,{parser:n}=t.p,{tokenizers:r}=n,o=n.stateSlot(t.state,3),l=t.curContext?t.curContext.hash:0,a=0;for(let c=0;c<r.length;c++){if((1<<c&o)==0)continue;let h=r[c],f=this.tokens[c];if(!(i&&!h.fallback)&&((h.contextual||f.start!=t.pos||f.mask!=o||f.context!=l)&&(this.updateCachedToken(f,h,t),f.mask=o,f.context=l),f.lookAhead>f.end+25&&(a=Math.max(f.lookAhead,a)),f.value!=0)){let m=e;if(f.extended>-1&&(e=this.addActions(t,f.extended,f.end,e)),e=this.addActions(t,f.value,f.end,e),!h.extend&&(i=f,e>m))break}}for(;this.actions.length>e;)this.actions.pop();return a&&t.setLookAhead(a),!i&&t.pos==this.stream.end&&(i=new ng,i.value=t.p.parser.eofTerm,i.start=i.end=t.pos,e=this.addActions(t,i.value,i.end,e)),this.mainToken=i,this.actions}getMainToken(t){if(this.mainToken)return this.mainToken;let e=new ng,{pos:i,p:n}=t;return e.start=i,e.end=Math.min(i+1,n.stream.end),e.value=i==n.stream.end?n.parser.eofTerm:0,e}updateCachedToken(t,e,i){let n=this.stream.clipPos(i.pos);if(e.token(this.stream.reset(n,t),i),t.value>-1){let{parser:r}=i.p;for(let o=0;o<r.specialized.length;o++)if(r.specialized[o]==t.value){let l=r.specializers[o](this.stream.read(t.start,t.end),i);if(l>=0&&i.p.parser.dialect.allows(l>>1)){(l&1)==0?t.value=l>>1:t.extended=l>>1;break}}}else t.value=0,t.end=this.stream.clipPos(n+1)}putAction(t,e,i,n){for(let r=0;r<n;r+=3)if(this.actions[r]==t)return n;return this.actions[n++]=t,this.actions[n++]=e,this.actions[n++]=i,n}addActions(t,e,i,n){let{state:r}=t,{parser:o}=t.p,{data:l}=o;for(let a=0;a<2;a++)for(let c=o.stateSlot(r,a?2:1);;c+=3){if(l[c]==65535)if(l[c+1]==1)c=Pr(l,c+2);else{n==0&&l[c+1]==2&&(n=this.putAction(Pr(l,c+2),e,i,n));break}l[c]==e&&(n=this.putAction(Pr(l,c+1),e,i,n))}return n}}class yae{constructor(t,e,i,n){this.parser=t,this.input=e,this.ranges=n,this.recovering=0,this.nextStackID=9812,this.minStackPos=0,this.reused=[],this.stoppedAt=null,this.lastBigReductionStart=-1,this.lastBigReductionSize=0,this.bigReductionCount=0,this.stream=new wae(e,n),this.tokens=new Oae(t,this.stream),this.topTerm=t.top[1];let{from:r}=n[0];this.stacks=[op.start(this,t.top[0],r)],this.fragments=i.length&&this.stream.end-r>t.bufferLength*4?new bae(i,t.nodeSet):null}get parsedPos(){return this.minStackPos}advance(){let t=this.stacks,e=this.minStackPos,i=this.stacks=[],n,r;if(this.bigReductionCount>300&&t.length==1){let[o]=t;for(;o.forceReduce()&&o.stack.length&&o.stack[o.stack.length-2]>=this.lastBigReductionStart;);this.bigReductionCount=this.lastBigReductionSize=0}for(let o=0;o<t.length;o++){let l=t[o];for(;;){if(this.tokens.mainToken=null,l.pos>e)i.push(l);else{if(this.advanceStack(l,i,t))continue;{n||(n=[],r=[]),n.push(l);let a=this.tokens.getMainToken(l);r.push(a.value,a.end)}}break}}if(!i.length){let o=n&&_ae(n);if(o)return Vn&&console.log("Finish with "+this.stackID(o)),this.stackToTree(o);if(this.parser.strict)throw Vn&&n&&console.log("Stuck with token "+(this.tokens.mainToken?this.parser.getName(this.tokens.mainToken.value):"none")),new SyntaxError("No parse at "+e);this.recovering||(this.recovering=5)}if(this.recovering&&n){let o=this.stoppedAt!=null&&n[0].pos>this.stoppedAt?n[0]:this.runRecovery(n,r,i);if(o)return Vn&&console.log("Force-finish "+this.stackID(o)),this.stackToTree(o.forceAll())}if(this.recovering){let o=this.recovering==1?1:this.recovering*3;if(i.length>o)for(i.sort((l,a)=>a.score-l.score);i.length>o;)i.pop();i.some(l=>l.reducePos>e)&&this.recovering--}else if(i.length>1){e:for(let o=0;o<i.length-1;o++){let l=i[o];for(let a=o+1;a<i.length;a++){let c=i[a];if(l.sameState(c)||l.buffer.length>500&&c.buffer.length>500)if((l.score-c.score||l.buffer.length-c.buffer.length)>0)i.splice(a--,1);else{i.splice(o--,1);continue e}}}i.length>12&&i.splice(12,i.length-12)}this.minStackPos=i[0].pos;for(let o=1;o<i.length;o++)i[o].pos<this.minStackPos&&(this.minStackPos=i[o].pos);return null}stopAt(t){if(this.stoppedAt!=null&&this.stoppedAt<t)throw new RangeError("Can't move stoppedAt forward");this.stoppedAt=t}advanceStack(t,e,i){let n=t.pos,{parser:r}=this,o=Vn?this.stackID(t)+" -> ":"";if(this.stoppedAt!=null&&n>this.stoppedAt)return t.forceReduce()?t:null;if(this.fragments){let c=t.curContext&&t.curContext.tracker.strict,h=c?t.curContext.hash:0;for(let f=this.fragments.nodeAt(n);f;){let m=this.parser.nodeSet.types[f.type.id]==f.type?r.getGoto(t.state,f.type.id):-1;if(m>-1&&f.length&&(!c||(f.prop(Fe.contextHash)||0)==h))return t.useNode(f,m),Vn&&console.log(o+this.stackID(t)+` (via reuse of ${r.getName(f.type.id)})`),!0;if(!(f instanceof gt)||f.children.length==0||f.positions[0]>0)break;let w=f.children[0];if(w instanceof gt&&f.positions[0]==0)f=w;else break}}let l=r.stateSlot(t.state,4);if(l>0)return t.reduce(l),Vn&&console.log(o+this.stackID(t)+` (via always-reduce ${r.getName(l&65535)})`),!0;if(t.stack.length>=8400)for(;t.stack.length>6e3&&t.forceReduce(););let a=this.tokens.getActions(t);for(let c=0;c<a.length;){let h=a[c++],f=a[c++],m=a[c++],w=c==a.length||!i,O=w?t:t.split(),_=this.tokens.mainToken;if(O.apply(h,f,_?_.start:O.pos,m),Vn&&console.log(o+this.stackID(O)+` (via ${(h&65536)==0?"shift":`reduce of ${r.getName(h&65535)}`} for ${r.getName(f)} @ ${n}${O==t?"":", split"})`),w)return!0;O.pos>n?e.push(O):i.push(O)}return!1}advanceFully(t,e){let i=t.pos;for(;;){if(!this.advanceStack(t,null,null))return!1;if(t.pos>i)return cE(t,e),!0}}runRecovery(t,e,i){let n=null,r=!1;for(let o=0;o<t.length;o++){let l=t[o],a=e[o<<1],c=e[(o<<1)+1],h=Vn?this.stackID(l)+" -> ":"";if(l.deadEnd&&(r||(r=!0,l.restart(),Vn&&console.log(h+this.stackID(l)+" (restarted)"),this.advanceFully(l,i))))continue;let f=l.split(),m=h;for(let w=0;f.forceReduce()&&w<10&&(Vn&&console.log(m+this.stackID(f)+" (via force-reduce)"),!this.advanceFully(f,i));w++)Vn&&(m=this.stackID(f)+" -> ");for(let w of l.recoverByInsert(a))Vn&&console.log(h+this.stackID(w)+" (via recover-insert)"),this.advanceFully(w,i);this.stream.end>l.pos?(c==l.pos&&(c++,a=0),l.recoverByDelete(a,c),Vn&&console.log(h+this.stackID(l)+` (via recover-delete ${this.parser.getName(a)})`),cE(l,i)):(!n||n.score<l.score)&&(n=l)}return n}stackToTree(t){return t.close(),gt.build({buffer:lp.create(t),nodeSet:this.parser.nodeSet,topID:this.topTerm,maxBufferLength:this.parser.bufferLength,reused:this.reused,start:this.ranges[0].from,length:t.pos-this.ranges[0].from,minRepeatType:this.parser.minRepeatTerm})}stackID(t){let e=(ob||(ob=new WeakMap)).get(t);return e||ob.set(t,e=String.fromCodePoint(this.nextStackID++)),e+t}}function cE(s,t){for(let e=0;e<t.length;e++){let i=t[e];if(i.pos==s.pos&&i.sameState(s)){t[e].score<s.score&&(t[e]=s);return}}t.push(s)}class vae{constructor(t,e,i){this.source=t,this.flags=e,this.disabled=i}allows(t){return!this.disabled||this.disabled[t]==0}}const lb=s=>s;class _V{constructor(t){this.start=t.start,this.shift=t.shift||lb,this.reduce=t.reduce||lb,this.reuse=t.reuse||lb,this.hash=t.hash||(()=>0),this.strict=t.strict!==!1}}class Sc extends tv{constructor(t){if(super(),this.wrappers=[],t.version!=14)throw new RangeError(`Parser version (${t.version}) doesn't match runtime version (14)`);let e=t.nodeNames.split(" ");this.minRepeatTerm=e.length;for(let l=0;l<t.repeatNodeCount;l++)e.push("");let i=Object.keys(t.topRules).map(l=>t.topRules[l][1]),n=[];for(let l=0;l<e.length;l++)n.push([]);function r(l,a,c){n[l].push([a,a.deserialize(String(c))])}if(t.nodeProps)for(let l of t.nodeProps){let a=l[0];typeof a=="string"&&(a=Fe[a]);for(let c=1;c<l.length;){let h=l[c++];if(h>=0)r(h,a,l[c++]);else{let f=l[c+-h];for(let m=-h;m>0;m--)r(l[c++],a,f);c++}}}this.nodeSet=new Sd(e.map((l,a)=>hi.define({name:a>=this.minRepeatTerm?void 0:l,id:a,props:n[a],top:i.indexOf(a)>-1,error:a==0,skipped:t.skippedNodes&&t.skippedNodes.indexOf(a)>-1}))),t.propSources&&(this.nodeSet=this.nodeSet.extend(...t.propSources)),this.strict=!1,this.bufferLength=lR;let o=sh(t.tokenData);this.context=t.context,this.specializerSpecs=t.specialized||[],this.specialized=new Uint16Array(this.specializerSpecs.length);for(let l=0;l<this.specializerSpecs.length;l++)this.specialized[l]=this.specializerSpecs[l].term;this.specializers=this.specializerSpecs.map(uE),this.states=sh(t.states,Uint32Array),this.data=sh(t.stateData),this.goto=sh(t.goto),this.maxTerm=t.maxTerm,this.tokenizers=t.tokenizers.map(l=>typeof l=="number"?new uc(o,l):l),this.topRules=t.topRules,this.dialects=t.dialects||{},this.dynamicPrecedences=t.dynamicPrecedences||null,this.tokenPrecTable=t.tokenPrec,this.termNames=t.termNames||null,this.maxNode=this.nodeSet.types.length-1,this.dialect=this.parseDialect(),this.top=this.topRules[Object.keys(this.topRules)[0]]}createParse(t,e,i){let n=new yae(this,t,e,i);for(let r of this.wrappers)n=r(n,t,e,i);return n}getGoto(t,e,i=!1){let n=this.goto;if(e>=n[0])return-1;for(let r=n[e+1];;){let o=n[r++],l=o&1,a=n[r++];if(l&&i)return a;for(let c=r+(o>>1);r<c;r++)if(n[r]==t)return a;if(l)return-1}}hasAction(t,e){let i=this.data;for(let n=0;n<2;n++)for(let r=this.stateSlot(t,n?2:1),o;;r+=3){if((o=i[r])==65535)if(i[r+1]==1)o=i[r=Pr(i,r+2)];else{if(i[r+1]==2)return Pr(i,r+2);break}if(o==e||o==0)return Pr(i,r+1)}return 0}stateSlot(t,e){return this.states[t*6+e]}stateFlag(t,e){return(this.stateSlot(t,0)&e)>0}validAction(t,e){return!!this.allActions(t,i=>i==e?!0:null)}allActions(t,e){let i=this.stateSlot(t,4),n=i?e(i):void 0;for(let r=this.stateSlot(t,1);n==null;r+=3){if(this.data[r]==65535)if(this.data[r+1]==1)r=Pr(this.data,r+2);else break;n=e(Pr(this.data,r+1))}return n}nextStates(t){let e=[];for(let i=this.stateSlot(t,1);;i+=3){if(this.data[i]==65535)if(this.data[i+1]==1)i=Pr(this.data,i+2);else break;if((this.data[i+2]&1)==0){let n=this.data[i+1];e.some((r,o)=>o&1&&r==n)||e.push(this.data[i],n)}}return e}configure(t){let e=Object.assign(Object.create(Sc.prototype),this);if(t.props&&(e.nodeSet=this.nodeSet.extend(...t.props)),t.top){let i=this.topRules[t.top];if(!i)throw new RangeError(`Invalid top rule name ${t.top}`);e.top=i}return t.tokenizers&&(e.tokenizers=this.tokenizers.map(i=>{let n=t.tokenizers.find(r=>r.from==i);return n?n.to:i})),t.specializers&&(e.specializers=this.specializers.slice(),e.specializerSpecs=this.specializerSpecs.map((i,n)=>{let r=t.specializers.find(l=>l.from==i.external);if(!r)return i;let o=Object.assign(Object.assign({},i),{external:r.to});return e.specializers[n]=uE(o),o})),t.contextTracker&&(e.context=t.contextTracker),t.dialect&&(e.dialect=this.parseDialect(t.dialect)),t.strict!=null&&(e.strict=t.strict),t.wrap&&(e.wrappers=e.wrappers.concat(t.wrap)),t.bufferLength!=null&&(e.bufferLength=t.bufferLength),e}hasWrappers(){return this.wrappers.length>0}getName(t){return this.termNames?this.termNames[t]:String(t<=this.maxNode&&this.nodeSet.types[t].name||t)}get eofTerm(){return this.maxNode+1}get topNode(){return this.nodeSet.types[this.top[1]]}dynamicPrecedence(t){let e=this.dynamicPrecedences;return e==null?0:e[t]||0}parseDialect(t){let e=Object.keys(this.dialects),i=e.map(()=>!1);if(t)for(let r of t.split(" ")){let o=e.indexOf(r);o>=0&&(i[o]=!0)}let n=null;for(let r=0;r<e.length;r++)if(!i[r])for(let o=this.dialects[e[r]],l;(l=this.data[o++])!=65535;)(n||(n=new Uint8Array(this.maxTerm+1)))[l]=1;return new vae(t,i,n)}static deserialize(t){return new Sc(t)}}function Pr(s,t){return s[t]|s[t+1]<<16}function _ae(s){let t=null;for(let e of s){let i=e.p.stoppedAt;(e.pos==e.p.stream.end||i!=null&&e.pos>i)&&e.p.parser.stateFlag(e.state,2)&&(!t||t.score<e.score)&&(t=e)}return t}function uE(s){if(s.external){let t=s.extend?1:0;return(e,i)=>s.external(e,i)<<1|t}return s.get}const kae=54,Sae=1,Cae=55,Pae=2,Tae=56,Eae=3,hE=4,Aae=5,cp=6,kV=7,SV=8,CV=9,PV=10,Iae=11,Rae=12,Vae=13,ab=57,Mae=14,dE=58,TV=20,Lae=22,EV=23,Bae=24,dO=26,AV=27,$ae=28,Dae=31,Qae=34,Nae=36,Fae=37,zae=0,Wae=1,Uae={area:!0,base:!0,br:!0,col:!0,command:!0,embed:!0,frame:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0,menuitem:!0},Zae={dd:!0,li:!0,optgroup:!0,option:!0,p:!0,rp:!0,rt:!0,tbody:!0,td:!0,tfoot:!0,th:!0,tr:!0},fE={dd:{dd:!0,dt:!0},dt:{dd:!0,dt:!0},li:{li:!0},option:{option:!0,optgroup:!0},optgroup:{optgroup:!0},p:{address:!0,article:!0,aside:!0,blockquote:!0,dir:!0,div:!0,dl:!0,fieldset:!0,footer:!0,form:!0,h1:!0,h2:!0,h3:!0,h4:!0,h5:!0,h6:!0,header:!0,hgroup:!0,hr:!0,menu:!0,nav:!0,ol:!0,p:!0,pre:!0,section:!0,table:!0,ul:!0},rp:{rp:!0,rt:!0},rt:{rp:!0,rt:!0},tbody:{tbody:!0,tfoot:!0},td:{td:!0,th:!0},tfoot:{tbody:!0},th:{td:!0,th:!0},thead:{tbody:!0,tfoot:!0},tr:{tr:!0}};function Hae(s){return s==45||s==46||s==58||s>=65&&s<=90||s==95||s>=97&&s<=122||s>=161}function IV(s){return s==9||s==10||s==13||s==32}let mE=null,gE=null,pE=0;function fO(s,t){let e=s.pos+t;if(pE==e&&gE==s)return mE;let i=s.peek(t);for(;IV(i);)i=s.peek(++t);let n="";for(;Hae(i);)n+=String.fromCharCode(i),i=s.peek(++t);return gE=s,pE=e,mE=n?n.toLowerCase():i==qae||i==jae?void 0:null}const RV=60,up=62,xv=47,qae=63,jae=33,Xae=45;function wE(s,t){this.name=s,this.parent=t}const Gae=[cp,PV,kV,SV,CV],Yae=new _V({start:null,shift(s,t,e,i){return Gae.indexOf(t)>-1?new wE(fO(i,1)||"",s):s},reduce(s,t){return t==TV&&s?s.parent:s},reuse(s,t,e,i){let n=t.type.id;return n==cp||n==Nae?new wE(fO(i,1)||"",s):s},strict:!1}),Kae=new Os((s,t)=>{if(s.next!=RV){s.next<0&&t.context&&s.acceptToken(ab);return}s.advance();let e=s.next==xv;e&&s.advance();let i=fO(s,0);if(i===void 0)return;if(!i)return s.acceptToken(e?Mae:cp);let n=t.context?t.context.name:null;if(e){if(i==n)return s.acceptToken(Iae);if(n&&Zae[n])return s.acceptToken(ab,-2);if(t.dialectEnabled(zae))return s.acceptToken(Rae);for(let r=t.context;r;r=r.parent)if(r.name==i)return;s.acceptToken(Vae)}else{if(i=="script")return s.acceptToken(kV);if(i=="style")return s.acceptToken(SV);if(i=="textarea")return s.acceptToken(CV);if(Uae.hasOwnProperty(i))return s.acceptToken(PV);n&&fE[n]&&fE[n][i]?s.acceptToken(ab,-1):s.acceptToken(cp)}},{contextual:!0}),Jae=new Os(s=>{for(let t=0,e=0;;e++){if(s.next<0){e&&s.acceptToken(dE);break}if(s.next==Xae)t++;else if(s.next==up&&t>=2){e>=3&&s.acceptToken(dE,-2);break}else t=0;s.advance()}});function ece(s){for(;s;s=s.parent)if(s.name=="svg"||s.name=="math")return!0;return!1}const tce=new Os((s,t)=>{if(s.next==xv&&s.peek(1)==up){let e=t.dialectEnabled(Wae)||ece(t.context);s.acceptToken(e?Aae:hE,2)}else s.next==up&&s.acceptToken(hE,1)});function bv(s,t,e){let i=2+s.length;return new Os(n=>{for(let r=0,o=0,l=0;;l++){if(n.next<0){l&&n.acceptToken(t);break}if(r==0&&n.next==RV||r==1&&n.next==xv||r>=2&&r<i&&n.next==s.charCodeAt(r-2))r++,o++;else if((r==2||r==i)&&IV(n.next))o++;else if(r==i&&n.next==up){l>o?n.acceptToken(t,-o):n.acceptToken(e,-(o-2));break}else if((n.next==10||n.next==13)&&l){n.acceptToken(t,1);break}else r=o=0;n.advance()}})}const ice=bv("script",kae,Sae),nce=bv("style",Cae,Pae),sce=bv("textarea",Tae,Eae),rce=Bc({"Text RawText":T.content,"StartTag StartCloseTag SelfClosingEndTag EndTag":T.angleBracket,TagName:T.tagName,"MismatchedCloseTag/TagName":[T.tagName,T.invalid],AttributeName:T.attributeName,"AttributeValue UnquotedAttributeValue":T.attributeValue,Is:T.definitionOperator,"EntityReference CharacterReference":T.character,Comment:T.blockComment,ProcessingInst:T.processingInstruction,DoctypeDecl:T.documentMeta}),oce=Sc.deserialize({version:14,states:",xOVO!rOOO!WQ#tO'#CqO!]Q#tO'#CzO!bQ#tO'#C}O!gQ#tO'#DQO!lQ#tO'#DSO!qOaO'#CpO!|ObO'#CpO#XOdO'#CpO$eO!rO'#CpOOO`'#Cp'#CpO$lO$fO'#DTO$tQ#tO'#DVO$yQ#tO'#DWOOO`'#Dk'#DkOOO`'#DY'#DYQVO!rOOO%OQ&rO,59]O%ZQ&rO,59fO%fQ&rO,59iO%qQ&rO,59lO%|Q&rO,59nOOOa'#D^'#D^O&XOaO'#CxO&dOaO,59[OOOb'#D_'#D_O&lObO'#C{O&wObO,59[OOOd'#D`'#D`O'POdO'#DOO'[OdO,59[OOO`'#Da'#DaO'dO!rO,59[O'kQ#tO'#DROOO`,59[,59[OOOp'#Db'#DbO'pO$fO,59oOOO`,59o,59oO'xQ#|O,59qO'}Q#|O,59rOOO`-E7W-E7WO(SQ&rO'#CsOOQW'#DZ'#DZO(bQ&rO1G.wOOOa1G.w1G.wOOO`1G/Y1G/YO(mQ&rO1G/QOOOb1G/Q1G/QO(xQ&rO1G/TOOOd1G/T1G/TO)TQ&rO1G/WOOO`1G/W1G/WO)`Q&rO1G/YOOOa-E7[-E7[O)kQ#tO'#CyOOO`1G.v1G.vOOOb-E7]-E7]O)pQ#tO'#C|OOOd-E7^-E7^O)uQ#tO'#DPOOO`-E7_-E7_O)zQ#|O,59mOOOp-E7`-E7`OOO`1G/Z1G/ZOOO`1G/]1G/]OOO`1G/^1G/^O*PQ,UO,59_OOQW-E7X-E7XOOOa7+$c7+$cOOO`7+$t7+$tOOOb7+$l7+$lOOOd7+$o7+$oOOO`7+$r7+$rO*[Q#|O,59eO*aQ#|O,59hO*fQ#|O,59kOOO`1G/X1G/XO*kO7[O'#CvO*|OMhO'#CvOOQW1G.y1G.yOOO`1G/P1G/POOO`1G/S1G/SOOO`1G/V1G/VOOOO'#D['#D[O+_O7[O,59bOOQW,59b,59bOOOO'#D]'#D]O+pOMhO,59bOOOO-E7Y-E7YOOQW1G.|1G.|OOOO-E7Z-E7Z",stateData:",]~O!^OS~OUSOVPOWQOXROYTO[]O][O^^O`^Oa^Ob^Oc^Ox^O{_O!dZO~OfaO~OfbO~OfcO~OfdO~OfeO~O!WfOPlP!ZlP~O!XiOQoP!ZoP~O!YlORrP!ZrP~OUSOVPOWQOXROYTOZqO[]O][O^^O`^Oa^Ob^Oc^Ox^O!dZO~O!ZrO~P#dO![sO!euO~OfvO~OfwO~OS|OT}OhyO~OS!POT}OhyO~OS!ROT}OhyO~OS!TOT}OhyO~OS}OT}OhyO~O!WfOPlX!ZlX~OP!WO!Z!XO~O!XiOQoX!ZoX~OQ!ZO!Z!XO~O!YlORrX!ZrX~OR!]O!Z!XO~O!Z!XO~P#dOf!_O~O![sO!e!aO~OS!bO~OS!cO~Oi!dOSgXTgXhgX~OS!fOT!gOhyO~OS!hOT!gOhyO~OS!iOT!gOhyO~OS!jOT!gOhyO~OS!gOT!gOhyO~Of!kO~Of!lO~Of!mO~OS!nO~Ok!qO!`!oO!b!pO~OS!rO~OS!sO~OS!tO~Oa!uOb!uOc!uO!`!wO!a!uO~Oa!xOb!xOc!xO!b!wO!c!xO~Oa!uOb!uOc!uO!`!{O!a!uO~Oa!xOb!xOc!xO!b!{O!c!xO~OT~bac!dx{!d~",goto:"%p!`PPPPPPPPPPPPPPPPPPPP!a!gP!mPP!yP!|#P#S#Y#]#`#f#i#l#r#x!aP!a!aP$O$U$l$r$x%O%U%[%bPPPPPPPP%hX^OX`pXUOX`pezabcde{!O!Q!S!UR!q!dRhUR!XhXVOX`pRkVR!XkXWOX`pRnWR!XnXXOX`pQrXR!XpXYOX`pQ`ORx`Q{aQ!ObQ!QcQ!SdQ!UeZ!e{!O!Q!S!UQ!v!oR!z!vQ!y!pR!|!yQgUR!VgQjVR!YjQmWR![mQpXR!^pQtZR!`tS_O`ToXp",nodeNames:"⚠ StartCloseTag StartCloseTag StartCloseTag EndTag SelfClosingEndTag StartTag StartTag StartTag StartTag StartTag StartCloseTag StartCloseTag StartCloseTag IncompleteCloseTag Document Text EntityReference CharacterReference InvalidEntity Element OpenTag TagName Attribute AttributeName Is AttributeValue UnquotedAttributeValue ScriptText CloseTag OpenTag StyleText CloseTag OpenTag TextareaText CloseTag OpenTag CloseTag SelfClosingTag Comment ProcessingInst MismatchedCloseTag CloseTag DoctypeDecl",maxTerm:67,context:Yae,nodeProps:[["closedBy",-10,1,2,3,7,8,9,10,11,12,13,"EndTag",6,"EndTag SelfClosingEndTag",-4,21,30,33,36,"CloseTag"],["openedBy",4,"StartTag StartCloseTag",5,"StartTag",-4,29,32,35,37,"OpenTag"],["group",-9,14,17,18,19,20,39,40,41,42,"Entity",16,"Entity TextContent",-3,28,31,34,"TextContent Entity"],["isolate",-11,21,29,30,32,33,35,36,37,38,41,42,"ltr",-3,26,27,39,""]],propSources:[rce],skippedNodes:[0],repeatNodeCount:9,tokenData:"!<p!aR!YOX$qXY,QYZ,QZ[$q[]&X]^,Q^p$qpq,Qqr-_rs3_sv-_vw3}wxHYx}-_}!OH{!O!P-_!P!Q$q!Q![-_![!]Mz!]!^-_!^!_!$S!_!`!;x!`!a&X!a!c-_!c!}Mz!}#R-_#R#SMz#S#T1k#T#oMz#o#s-_#s$f$q$f%W-_%W%oMz%o%p-_%p&aMz&a&b-_&b1pMz1p4U-_4U4dMz4d4e-_4e$ISMz$IS$I`-_$I`$IbMz$Ib$Kh-_$Kh%#tMz%#t&/x-_&/x&EtMz&Et&FV-_&FV;'SMz;'S;:j!#|;:j;=`3X<%l?&r-_?&r?AhMz?Ah?BY$q?BY?MnMz?MnO$q!Z$|c`PkW!a`!cpOX$qXZ&XZ[$q[^&X^p$qpq&Xqr$qrs&}sv$qvw+Pwx(tx!^$q!^!_*V!_!a&X!a#S$q#S#T&X#T;'S$q;'S;=`+z<%lO$q!R&bX`P!a`!cpOr&Xrs&}sv&Xwx(tx!^&X!^!_*V!_;'S&X;'S;=`*y<%lO&Xq'UV`P!cpOv&}wx'kx!^&}!^!_(V!_;'S&};'S;=`(n<%lO&}P'pT`POv'kw!^'k!_;'S'k;'S;=`(P<%lO'kP(SP;=`<%l'kp([S!cpOv(Vx;'S(V;'S;=`(h<%lO(Vp(kP;=`<%l(Vq(qP;=`<%l&}a({W`P!a`Or(trs'ksv(tw!^(t!^!_)e!_;'S(t;'S;=`*P<%lO(t`)jT!a`Or)esv)ew;'S)e;'S;=`)y<%lO)e`)|P;=`<%l)ea*SP;=`<%l(t!Q*^V!a`!cpOr*Vrs(Vsv*Vwx)ex;'S*V;'S;=`*s<%lO*V!Q*vP;=`<%l*V!R*|P;=`<%l&XW+UYkWOX+PZ[+P^p+Pqr+Psw+Px!^+P!a#S+P#T;'S+P;'S;=`+t<%lO+PW+wP;=`<%l+P!Z+}P;=`<%l$q!a,]``P!a`!cp!^^OX&XXY,QYZ,QZ]&X]^,Q^p&Xpq,Qqr&Xrs&}sv&Xwx(tx!^&X!^!_*V!_;'S&X;'S;=`*y<%lO&X!_-ljhS`PkW!a`!cpOX$qXZ&XZ[$q[^&X^p$qpq&Xqr-_rs&}sv-_vw/^wx(tx!P-_!P!Q$q!Q!^-_!^!_*V!_!a&X!a#S-_#S#T1k#T#s-_#s$f$q$f;'S-_;'S;=`3X<%l?Ah-_?Ah?BY$q?BY?Mn-_?MnO$q[/ebhSkWOX+PZ[+P^p+Pqr/^sw/^x!P/^!P!Q+P!Q!^/^!a#S/^#S#T0m#T#s/^#s$f+P$f;'S/^;'S;=`1e<%l?Ah/^?Ah?BY+P?BY?Mn/^?MnO+PS0rXhSqr0msw0mx!P0m!Q!^0m!a#s0m$f;'S0m;'S;=`1_<%l?Ah0m?BY?Mn0mS1bP;=`<%l0m[1hP;=`<%l/^!V1vchS`P!a`!cpOq&Xqr1krs&}sv1kvw0mwx(tx!P1k!P!Q&X!Q!^1k!^!_*V!_!a&X!a#s1k#s$f&X$f;'S1k;'S;=`3R<%l?Ah1k?Ah?BY&X?BY?Mn1k?MnO&X!V3UP;=`<%l1k!_3[P;=`<%l-_!Z3hV!`h`P!cpOv&}wx'kx!^&}!^!_(V!_;'S&};'S;=`(n<%lO&}!_4WihSkWc!ROX5uXZ7SZ[5u[^7S^p5uqr8trs7Sst>]tw8twx7Sx!P8t!P!Q5u!Q!]8t!]!^/^!^!a7S!a#S8t#S#T;{#T#s8t#s$f5u$f;'S8t;'S;=`>V<%l?Ah8t?Ah?BY5u?BY?Mn8t?MnO5u!Z5zbkWOX5uXZ7SZ[5u[^7S^p5uqr5urs7Sst+Ptw5uwx7Sx!]5u!]!^7w!^!a7S!a#S5u#S#T7S#T;'S5u;'S;=`8n<%lO5u!R7VVOp7Sqs7St!]7S!]!^7l!^;'S7S;'S;=`7q<%lO7S!R7qOa!R!R7tP;=`<%l7S!Z8OYkWa!ROX+PZ[+P^p+Pqr+Psw+Px!^+P!a#S+P#T;'S+P;'S;=`+t<%lO+P!Z8qP;=`<%l5u!_8{ihSkWOX5uXZ7SZ[5u[^7S^p5uqr8trs7Sst/^tw8twx7Sx!P8t!P!Q5u!Q!]8t!]!^:j!^!a7S!a#S8t#S#T;{#T#s8t#s$f5u$f;'S8t;'S;=`>V<%l?Ah8t?Ah?BY5u?BY?Mn8t?MnO5u!_:sbhSkWa!ROX+PZ[+P^p+Pqr/^sw/^x!P/^!P!Q+P!Q!^/^!a#S/^#S#T0m#T#s/^#s$f+P$f;'S/^;'S;=`1e<%l?Ah/^?Ah?BY+P?BY?Mn/^?MnO+P!V<QchSOp7Sqr;{rs7Sst0mtw;{wx7Sx!P;{!P!Q7S!Q!];{!]!^=]!^!a7S!a#s;{#s$f7S$f;'S;{;'S;=`>P<%l?Ah;{?Ah?BY7S?BY?Mn;{?MnO7S!V=dXhSa!Rqr0msw0mx!P0m!Q!^0m!a#s0m$f;'S0m;'S;=`1_<%l?Ah0m?BY?Mn0m!V>SP;=`<%l;{!_>YP;=`<%l8t!_>dhhSkWOX@OXZAYZ[@O[^AY^p@OqrBwrsAYswBwwxAYx!PBw!P!Q@O!Q!]Bw!]!^/^!^!aAY!a#SBw#S#TE{#T#sBw#s$f@O$f;'SBw;'S;=`HS<%l?AhBw?Ah?BY@O?BY?MnBw?MnO@O!Z@TakWOX@OXZAYZ[@O[^AY^p@Oqr@OrsAYsw@OwxAYx!]@O!]!^Az!^!aAY!a#S@O#S#TAY#T;'S@O;'S;=`Bq<%lO@O!RA]UOpAYq!]AY!]!^Ao!^;'SAY;'S;=`At<%lOAY!RAtOb!R!RAwP;=`<%lAY!ZBRYkWb!ROX+PZ[+P^p+Pqr+Psw+Px!^+P!a#S+P#T;'S+P;'S;=`+t<%lO+P!ZBtP;=`<%l@O!_COhhSkWOX@OXZAYZ[@O[^AY^p@OqrBwrsAYswBwwxAYx!PBw!P!Q@O!Q!]Bw!]!^Dj!^!aAY!a#SBw#S#TE{#T#sBw#s$f@O$f;'SBw;'S;=`HS<%l?AhBw?Ah?BY@O?BY?MnBw?MnO@O!_DsbhSkWb!ROX+PZ[+P^p+Pqr/^sw/^x!P/^!P!Q+P!Q!^/^!a#S/^#S#T0m#T#s/^#s$f+P$f;'S/^;'S;=`1e<%l?Ah/^?Ah?BY+P?BY?Mn/^?MnO+P!VFQbhSOpAYqrE{rsAYswE{wxAYx!PE{!P!QAY!Q!]E{!]!^GY!^!aAY!a#sE{#s$fAY$f;'SE{;'S;=`G|<%l?AhE{?Ah?BYAY?BY?MnE{?MnOAY!VGaXhSb!Rqr0msw0mx!P0m!Q!^0m!a#s0m$f;'S0m;'S;=`1_<%l?Ah0m?BY?Mn0m!VHPP;=`<%lE{!_HVP;=`<%lBw!ZHcW!bx`P!a`Or(trs'ksv(tw!^(t!^!_)e!_;'S(t;'S;=`*P<%lO(t!aIYlhS`PkW!a`!cpOX$qXZ&XZ[$q[^&X^p$qpq&Xqr-_rs&}sv-_vw/^wx(tx}-_}!OKQ!O!P-_!P!Q$q!Q!^-_!^!_*V!_!a&X!a#S-_#S#T1k#T#s-_#s$f$q$f;'S-_;'S;=`3X<%l?Ah-_?Ah?BY$q?BY?Mn-_?MnO$q!aK_khS`PkW!a`!cpOX$qXZ&XZ[$q[^&X^p$qpq&Xqr-_rs&}sv-_vw/^wx(tx!P-_!P!Q$q!Q!^-_!^!_*V!_!`&X!`!aMS!a#S-_#S#T1k#T#s-_#s$f$q$f;'S-_;'S;=`3X<%l?Ah-_?Ah?BY$q?BY?Mn-_?MnO$q!TM_X`P!a`!cp!eQOr&Xrs&}sv&Xwx(tx!^&X!^!_*V!_;'S&X;'S;=`*y<%lO&X!aNZ!ZhSfQ`PkW!a`!cpOX$qXZ&XZ[$q[^&X^p$qpq&Xqr-_rs&}sv-_vw/^wx(tx}-_}!OMz!O!PMz!P!Q$q!Q![Mz![!]Mz!]!^-_!^!_*V!_!a&X!a!c-_!c!}Mz!}#R-_#R#SMz#S#T1k#T#oMz#o#s-_#s$f$q$f$}-_$}%OMz%O%W-_%W%oMz%o%p-_%p&aMz&a&b-_&b1pMz1p4UMz4U4dMz4d4e-_4e$ISMz$IS$I`-_$I`$IbMz$Ib$Je-_$Je$JgMz$Jg$Kh-_$Kh%#tMz%#t&/x-_&/x&EtMz&Et&FV-_&FV;'SMz;'S;:j!#|;:j;=`3X<%l?&r-_?&r?AhMz?Ah?BY$q?BY?MnMz?MnO$q!a!$PP;=`<%lMz!R!$ZY!a`!cpOq*Vqr!$yrs(Vsv*Vwx)ex!a*V!a!b!4t!b;'S*V;'S;=`*s<%lO*V!R!%Q]!a`!cpOr*Vrs(Vsv*Vwx)ex}*V}!O!%y!O!f*V!f!g!']!g#W*V#W#X!0`#X;'S*V;'S;=`*s<%lO*V!R!&QX!a`!cpOr*Vrs(Vsv*Vwx)ex}*V}!O!&m!O;'S*V;'S;=`*s<%lO*V!R!&vV!a`!cp!dPOr*Vrs(Vsv*Vwx)ex;'S*V;'S;=`*s<%lO*V!R!'dX!a`!cpOr*Vrs(Vsv*Vwx)ex!q*V!q!r!(P!r;'S*V;'S;=`*s<%lO*V!R!(WX!a`!cpOr*Vrs(Vsv*Vwx)ex!e*V!e!f!(s!f;'S*V;'S;=`*s<%lO*V!R!(zX!a`!cpOr*Vrs(Vsv*Vwx)ex!v*V!v!w!)g!w;'S*V;'S;=`*s<%lO*V!R!)nX!a`!cpOr*Vrs(Vsv*Vwx)ex!{*V!{!|!*Z!|;'S*V;'S;=`*s<%lO*V!R!*bX!a`!cpOr*Vrs(Vsv*Vwx)ex!r*V!r!s!*}!s;'S*V;'S;=`*s<%lO*V!R!+UX!a`!cpOr*Vrs(Vsv*Vwx)ex!g*V!g!h!+q!h;'S*V;'S;=`*s<%lO*V!R!+xY!a`!cpOr!+qrs!,hsv!+qvw!-Swx!.[x!`!+q!`!a!/j!a;'S!+q;'S;=`!0Y<%lO!+qq!,mV!cpOv!,hvx!-Sx!`!,h!`!a!-q!a;'S!,h;'S;=`!.U<%lO!,hP!-VTO!`!-S!`!a!-f!a;'S!-S;'S;=`!-k<%lO!-SP!-kO{PP!-nP;=`<%l!-Sq!-xS!cp{POv(Vx;'S(V;'S;=`(h<%lO(Vq!.XP;=`<%l!,ha!.aX!a`Or!.[rs!-Ssv!.[vw!-Sw!`!.[!`!a!.|!a;'S!.[;'S;=`!/d<%lO!.[a!/TT!a`{POr)esv)ew;'S)e;'S;=`)y<%lO)ea!/gP;=`<%l!.[!R!/sV!a`!cp{POr*Vrs(Vsv*Vwx)ex;'S*V;'S;=`*s<%lO*V!R!0]P;=`<%l!+q!R!0gX!a`!cpOr*Vrs(Vsv*Vwx)ex#c*V#c#d!1S#d;'S*V;'S;=`*s<%lO*V!R!1ZX!a`!cpOr*Vrs(Vsv*Vwx)ex#V*V#V#W!1v#W;'S*V;'S;=`*s<%lO*V!R!1}X!a`!cpOr*Vrs(Vsv*Vwx)ex#h*V#h#i!2j#i;'S*V;'S;=`*s<%lO*V!R!2qX!a`!cpOr*Vrs(Vsv*Vwx)ex#m*V#m#n!3^#n;'S*V;'S;=`*s<%lO*V!R!3eX!a`!cpOr*Vrs(Vsv*Vwx)ex#d*V#d#e!4Q#e;'S*V;'S;=`*s<%lO*V!R!4XX!a`!cpOr*Vrs(Vsv*Vwx)ex#X*V#X#Y!+q#Y;'S*V;'S;=`*s<%lO*V!R!4{Y!a`!cpOr!4trs!5ksv!4tvw!6Vwx!8]x!a!4t!a!b!:]!b;'S!4t;'S;=`!;r<%lO!4tq!5pV!cpOv!5kvx!6Vx!a!5k!a!b!7W!b;'S!5k;'S;=`!8V<%lO!5kP!6YTO!a!6V!a!b!6i!b;'S!6V;'S;=`!7Q<%lO!6VP!6lTO!`!6V!`!a!6{!a;'S!6V;'S;=`!7Q<%lO!6VP!7QOxPP!7TP;=`<%l!6Vq!7]V!cpOv!5kvx!6Vx!`!5k!`!a!7r!a;'S!5k;'S;=`!8V<%lO!5kq!7yS!cpxPOv(Vx;'S(V;'S;=`(h<%lO(Vq!8YP;=`<%l!5ka!8bX!a`Or!8]rs!6Vsv!8]vw!6Vw!a!8]!a!b!8}!b;'S!8];'S;=`!:V<%lO!8]a!9SX!a`Or!8]rs!6Vsv!8]vw!6Vw!`!8]!`!a!9o!a;'S!8];'S;=`!:V<%lO!8]a!9vT!a`xPOr)esv)ew;'S)e;'S;=`)y<%lO)ea!:YP;=`<%l!8]!R!:dY!a`!cpOr!4trs!5ksv!4tvw!6Vwx!8]x!`!4t!`!a!;S!a;'S!4t;'S;=`!;r<%lO!4t!R!;]V!a`!cpxPOr*Vrs(Vsv*Vwx)ex;'S*V;'S;=`*s<%lO*V!R!;uP;=`<%l!4t!V!<TXiS`P!a`!cpOr&Xrs&}sv&Xwx(tx!^&X!^!_*V!_;'S&X;'S;=`*y<%lO&X",tokenizers:[ice,nce,sce,tce,Kae,Jae,0,1,2,3,4,5],topRules:{Document:[0,15]},dialects:{noMatch:0,selfClosing:509},tokenPrec:511});function VV(s,t){let e=Object.create(null);for(let i of s.getChildren(EV)){let n=i.getChild(Bae),r=i.getChild(dO)||i.getChild(AV);n&&(e[t.read(n.from,n.to)]=r?r.type.id==dO?t.read(r.from+1,r.to-1):t.read(r.from,r.to):"")}return e}function xE(s,t){let e=s.getChild(Lae);return e?t.read(e.from,e.to):" "}function cb(s,t,e){let i;for(let n of e)if(!n.attrs||n.attrs(i||(i=VV(s.node.parent.firstChild,t))))return{parser:n.parser};return null}function MV(s=[],t=[]){let e=[],i=[],n=[],r=[];for(let l of s)(l.tag=="script"?e:l.tag=="style"?i:l.tag=="textarea"?n:r).push(l);let o=t.length?Object.create(null):null;for(let l of t)(o[l.name]||(o[l.name]=[])).push(l);return dR((l,a)=>{let c=l.type.id;if(c==$ae)return cb(l,a,e);if(c==Dae)return cb(l,a,i);if(c==Qae)return cb(l,a,n);if(c==TV&&r.length){let h=l.node,f=h.firstChild,m=f&&xE(f,a),w;if(m){for(let O of r)if(O.tag==m&&(!O.attrs||O.attrs(w||(w=VV(f,a))))){let _=h.lastChild,k=_.type.id==Fae?_.from:h.to;if(k>f.to)return{parser:O.parser,overlay:[{from:f.to,to:k}]}}}}if(o&&c==EV){let h=l.node,f;if(f=h.firstChild){let m=o[a.read(f.from,f.to)];if(m)for(let w of m){if(w.tagName&&w.tagName!=xE(h.parent,a))continue;let O=h.lastChild;if(O.type.id==dO){let _=O.from+1,k=O.lastChild,C=O.to-(k&&k.isError?0:1);if(C>_)return{parser:w.parser,overlay:[{from:_,to:C}]}}else if(O.type.id==AV)return{parser:w.parser,overlay:[{from:O.from,to:O.to}]}}}}return null})}const lce=107,bE=1,ace=108,cce=109,OE=2,yE=110,LV=[9,10,11,12,13,32,133,160,5760,8192,8193,8194,8195,8196,8197,8198,8199,8200,8201,8202,8232,8233,8239,8287,12288],uce=58,hce=40,BV=95,dce=91,sg=45,fce=46,mce=35,gce=37,pce=38,wce=92,xce=10,bce=42;function nd(s){return s>=65&&s<=90||s>=97&&s<=122||s>=161}function $V(s){return s>=48&&s<=57}const Oce=new Os((s,t)=>{for(let e=!1,i=0,n=0;;n++){let{next:r}=s;if(nd(r)||r==sg||r==BV||e&&$V(r))!e&&(r!=sg||n>0)&&(e=!0),i===n&&r==sg&&i++,s.advance();else if(r==wce&&s.peek(1)!=xce)s.advance(),s.next>-1&&s.advance(),e=!0;else{e&&s.acceptToken(i==2&&t.canShift(OE)?OE:t.canShift(yE)?yE:r==hce?ace:cce);break}}}),yce=new Os(s=>{if(LV.includes(s.peek(-1))){let{next:t}=s;(nd(t)||t==BV||t==mce||t==fce||t==bce||t==dce||t==uce&&nd(s.peek(1))||t==sg||t==pce)&&s.acceptToken(lce)}}),vce=new Os(s=>{if(!LV.includes(s.peek(-1))){let{next:t}=s;if(t==gce&&(s.advance(),s.acceptToken(bE)),nd(t)){do s.advance();while(nd(s.next)||$V(s.next));s.acceptToken(bE)}}}),_ce=Bc({"AtKeyword import charset namespace keyframes media supports":T.definitionKeyword,"from to selector":T.keyword,NamespaceName:T.namespace,KeyframeName:T.labelName,KeyframeRangeName:T.operatorKeyword,TagName:T.tagName,ClassName:T.className,PseudoClassName:T.constant(T.className),IdName:T.labelName,"FeatureName PropertyName":T.propertyName,AttributeName:T.attributeName,NumberLiteral:T.number,KeywordQuery:T.keyword,UnaryQueryOp:T.operatorKeyword,"CallTag ValueName":T.atom,VariableName:T.variableName,Callee:T.operatorKeyword,Unit:T.unit,"UniversalSelector NestingSelector":T.definitionOperator,"MatchOp CompareOp":T.compareOperator,"ChildOp SiblingOp, LogicOp":T.logicOperator,BinOp:T.arithmeticOperator,Important:T.modifier,Comment:T.blockComment,ColorLiteral:T.color,"ParenthesizedContent StringLiteral":T.string,":":T.punctuation,"PseudoOp #":T.derefOperator,"; ,":T.separator,"( )":T.paren,"[ ]":T.squareBracket,"{ }":T.brace}),kce={__proto__:null,lang:34,"nth-child":34,"nth-last-child":34,"nth-of-type":34,"nth-last-of-type":34,dir:34,"host-context":34,url:62,"url-prefix":62,domain:62,regexp:62},Sce={__proto__:null,"@import":120,"@media":154,"@charset":158,"@namespace":162,"@keyframes":168,"@supports":180},Cce={__proto__:null,layer:124,not:144,only:144,selector:150},Pce=Sc.deserialize({version:14,states:">`QYQ[OOO#kQ[OOP#rOWOOOOQP'#Cd'#CdOOQP'#Cc'#CcO#wQ[O'#CfO$hQXO'#CaO$rQ[O'#CiO$}Q[O'#DUO%SQ[O'#DXO%XQ[O'#D[O%XQ[O'#D_OOQP'#Ev'#EvO%yQdO'#DhO&hQ[O'#DzO%yQdO'#D|O&yQ[O'#EOO'UQ[O'#ERO'^Q[O'#EXO'lQ[O'#EZOOQS'#Eu'#EuOOQS'#E^'#E^QYQ[OOO'sQXO'#CdO(hQWO'#DdO(mQWO'#E{O(xQ[O'#E{QOQWOOP)SO#tO'#C_POOO)C@e)C@eOOQP'#Ch'#ChOOQP,59Q,59QO#wQ[O,59QO)_Q[O,59TO$}Q[O,59pO%SQ[O,59sO%XQ[O,59vO%XQ[O,59xO%XQ[O,59yO%XQ[O'#EcO)jQWO,58{O)rQ[O'#DcOOQS,58{,58{OOQP'#Cl'#ClOOQO'#DS'#DSOOQP,59T,59TO)yQWO,59TO*OQWO,59TOOQP'#DW'#DWOOQP,59p,59pOOQO'#DY'#DYO*TQ`O,59sO*nQXO,59vO+UQXO,59yOOQS'#Cq'#CqO%yQdO'#CrO+lQvO'#CtO-hQtO,5:SOOQO'#Cy'#CyO*OQWO'#CxO-rQWO'#CzO-wQ[O'#DPOOQS'#Ex'#ExOOQO'#Dn'#DnO.eQdO'#DwO.uQWO'#E|O'^Q[O'#DuO/TQWO'#DxOOQO'#E}'#E}O)mQWO,5:fO/YQpO,5:hOOQS'#EQ'#EQO/bQWO,5:jO/gQ[O,5:jOOQO'#ET'#ETO/oQWO,5:mO/tQWO,5:sO/|QWO,5:uOOQS-E8[-E8[O0UQdO,5:OO0fQ[O'#EeO0sQWO,5;gO0sQWO,5;gPOOO'#E]'#E]P1OO#tO,58yPOOO,58y,58yOOQP1G.l1G.lOOQP1G.o1G.oO)yQWO1G.oO*OQWO1G.oOOQP1G/[1G/[O1ZQ`O1G/_O1cQXO1G/bO1yQXO1G/dO2aQXO1G/eO2wQXO,5:}OOQO-E8a-E8aOOQS1G.g1G.gO3RQWO,59}O3WQ[O'#DTO3_QdO'#CpOOQP1G/_1G/_O%yQdO1G/_O3fQpO,59^OOQS,59`,59`O%yQdO,59bO3nQ[O'#DkO4PQWO1G/nO-VQ[O1G/nOOQS,59d,59dO4UQ!bO,59fOOQS'#DQ'#DQOOQS'#E`'#E`O4aQ[O,59kOOQS,59k,59kO4iQpO'#DnO4wQpO,5:ZO5PQWO,5:cOOQO'#FO'#FOO4zQpO,5:_O'^Q[O,5:]O5XQ[O'#EgO5pQWO,5;hO5{QWO,5:aO%XQ[O,5:dOOQS1G0Q1G0QOOQS1G0S1G0SOOQS1G0U1G0UO6^QWO1G0UO6cQdO'#EUOOQS1G0X1G0XOOQS1G0_1G0_OOQS1G0a1G0aO6nQtO1G/jOOQO1G/j1G/jOOQO,5;P,5;PO7UQ[O,5;POOQO-E8c-E8cO7cQWO1G1RPOOO-E8Z-E8ZPOOO1G.e1G.eOOQP7+$Z7+$ZOOQP7+$y7+$yO%yQdO7+$yOOQS1G/i1G/iO7nQXO'#EzO7xQWO,59oO7}QtO'#E_O8uQdO'#EwO9PQWO,59[O9UQpO7+$yOOQS1G.x1G.xOOQS1G.|1G.|O9^Q[O,5:VOOQS7+%Y7+%YO9cQWO7+%YOOQS1G/Q1G/QO9hQWO1G/QOOQS-E8^-E8^OOQS1G/V1G/VO%yQdO1G/uO9mQdO1G/yOOQO1G/}1G/}OOQO1G/w1G/wO9tQWO,5;ROOQO-E8e-E8eO:SQXO1G0OOOQS7+%p7+%pO:ZQYO'#CtOOQO'#EW'#EWO:iQ`O'#EVOOQO'#EV'#EVO:tQWO'#EhO:|QdO,5:pOOQS,5:p,5:pO;XQtO'#EdO%yQdO'#EdO<YQdO7+%UOOQO7+%U7+%UOOQO1G0k1G0kO<mQpO<<HeO<uQ[O'#EbO=PQWO,5;fOOQP1G/Z1G/ZOOQS-E8]-E8]O=XQdO'#EaO=cQWO,5;cOOQT1G.v1G.vOOQP<<He<<HeOOQO'#Dm'#DmO=kQWO1G/qOOQS<<Ht<<HtOOQS7+$l7+$lO=sQdO7+%aOOQO'#Dp'#DpO=zQpO7+%eOOQO7+%j7+%jOOQO,5:q,5:qO6fQdO'#EiO:tQWO,5;SOOQS,5;S,5;SOOQS-E8f-E8fOOQS1G0[1G0[O>SQtO,5;OOOQS-E8b-E8bOOQO<<Hp<<HpOOQPAN>PAN>PO?TQXO,5:|OOQO-E8`-E8`O?_QdO,5:{OOQO-E8_-E8_O9^Q[O'#EfO?iQWO7+%]OOQS7+%]7+%]OOQO<<H{<<H{OOQO<<IP<<IPO?qQdO<<IPOOQO,5;T,5;TOOQO-E8g-E8gOOQS1G0n1G0nOOQO,5;Q,5;QOOQO-E8d-E8dOOQS<<Hw<<HwO@YQWOAN>kOOQOG24VG24V",stateData:"@g~O#dOS#eQQ~OU[OX[OZTO^VO_VOrXOyWO!PYO!SZO!]cO!^]O!o^O!q_O!s`O!vaO!|bO#aRO~OQhOU[OX[OZTO^VO_VOrXOyWO!PYO!SZO!]cO!^]O!o^O!q_O!s`O!vaO!|bO#agO~O#^#oP~P!aO#elO~O#anO~OZpO^qO_qOrsOyrO!PtO!SvO#_uO~OuwO!UyO~P#|Oa!PO#`|O#a{O~O#a!QO~O#a!SO~OU[OX[OZTO^VO_VOrXOyWO!PYO!SZO#aRO~OQ!`Oc!XOg!`Oi!`Oo!^Or!_O#`![O#a!WO#m!YO~Oc!bO!j!dO!m!eO#b!aO!U#pP~Oi!jOo!^O#a!iO~Oi!lO#a!lO~Oc!bO!j!dO!m!eO#b!aO~O!Z#pP~P&hOZWX^WX^!XX_WXrWXuWXyWX!PWX!SWX!UWX#_WX~O^!qO~O!Z!rO#^#oX!T#oX~O#^#oX!T#oX~P!aO#f!uO#g!uO#h!wO~Oa!{O#`|O#a{O~OuwO!UyO~O!T#oP~P!aOc#VO~Oc#WO~Oq#XO}#YO~OZpO^qO_qOrsOyrO~Ou!Oa!P!Oa!S!Oa!U!Oa#_!Oab!Oa~P*]Ou!Ra!P!Ra!S!Ra!U!Ra#_!Rab!Ra~P*]OP#[OchXkhX!ZhX!`hX!jhX!mhX#bhXbhX!hhXQhXghXihXohXrhXuhX!YhX#^hX#`hX#ahX#mhXqhX!ThX~Oc!bO!j!dO!m!eO#b!aO!Z#pP~Ok#]O!`#^O~P-VOc#bO~Oq#fO#a#cO~OQ#jOg#jOi#jOo!^O#`![O#m!YO~Oc!bO!j!dO!m!eO#b#gO~P.POu#mO!f#lO!U#pX!Z#pX~Oc#pO~Ok#]O!Z#rO~O!Z#sO~Oi#tOo!^O~O!U#uO~O!UyO!f#lO~O!UyO!Z#xO~O!Y#zO!Z!Wa#^!Wa!T!Wa~P%yO!Z#XX#^#XX!T#XX~P!aO!Z!rO#^#oa!T#oa~O#f!uO#g!uO#h$QO~Oq$SO}$TO~Ou!Oi!P!Oi!S!Oi!U!Oi#_!Oib!Oi~P*]Ou!Qi!P!Qi!S!Qi!U!Qi#_!Qib!Qi~P*]Ou!Ri!P!Ri!S!Ri!U!Ri#_!Rib!Ri~P*]Ou#Va!U#Va~P#|O!T$UO~Ob#nP~P%XOb#kP~P%yOb$]Ok#]O~Oc$_O!Z!_X!j!_X!m!_X#b!_X~O!Z$`O~Ob$bOi$cOp$cO~Oq$eO#a#cO~O^!dXb!bX!f!bX!h!dX~O^$fO!h$gO~Ob$hO!f#lO~Oc!bO!j!dO!m!eO#b!aOu#ZX!U#ZX!Z#ZX~Ou#mO!U#pa!Z#pa~O!f#lOu!ia!U!ia!Z!iab!ia~O!Z$mO~O!T$tO#a$oO#m$nO~Ok#]Ou$vO!Y$xO!Z!Wi#^!Wi!T!Wi~P%yO!Z#Xa#^#Xa!T#Xa~P!aO!Z!rO#^#oi!T#oi~Ou${Ob#nX~P#|Ob$}O~Ok#]OQ#RXb#RXc#RXg#RXi#RXo#RXr#RXu#RX#`#RX#a#RX#m#RX~Ou%POb#kX~P%yOb%RO~Ok#]Oq%SO~O#a%TO~O!Z%VO~Ob%WO~O#b%YO~P.PO!f#lOu#Za!U#Za!Z#Za~Ob%[O~P#|OP#[OuhX!UhXbhX~O#m$nOu!yX!U!yX~Ou%^O!UyO~O!T%bO#a$oO#m$nO~Ok#]OQ#WXc#WXg#WXi#WXo#WXr#WXu#WX!Y#WX!Z#WX#^#WX#`#WX#a#WX#m#WX!T#WX~Ou$vO!Y%eO!Z!Wq#^!Wq!T!Wq~P%yOk#]Oq%fO~Ob#UXu#UX~P%XOu${Ob#na~Ob#TXu#TX~P%yOu%POb#ka~OZ%kOb%mO~Ob%nO~P%yOb%oO!h%pO~Ok#]OQ#Wac#Wag#Wai#Wao#War#Wau#Wa!Y#Wa!Z#Wa#^#Wa#`#Wa#a#Wa#m#Wa!T#Wa~Ob#Uau#Ua~P#|Ob#Tau#Ta~P%yOZ%kOb%vO~OQ#jOg#jOi#jOo!^O#`![O#b%YO#m$nO~Ob%xO~O#dp#e#mk!S#m~",goto:"/l#sPPP#tP#wP$Q$dP$QP$v$QPP$|PPP%S%]%]P%oP%]P&`&w'^PPPP%]'{P(P(V$QP(]$Q(cP$QP$Q$QPPP(i)O)]PP#wPP)dP)g)m)m)x)mP)mP)mP)m)mP#wP#wP#wP*R#wP*U*X*[*c#wP#wP*h*n*}+]+c+i+o+u+{,V,],c,iPPPPPPPPPPP,o,x-n-qP.g.j.p.|/cRmQ_dOPfjy!r#|q[OPYZfjtuvwy!r#V#p#|${qSOPYZfjtuvwy!r#V#p#|${QoTR!xpQ}VR!yqQ!y!PQ#a!]R$R!{q!`]_!X!q#W#Y#]#y$T$Y$f$v$w%P%X%ip!`]_!X!q#W#Y#]#y$T$Y$f$v$w%P%X%iU#j!b$g%pU$q#u$s%^R%]$pp!`]_!X!q#W#Y#]#y$T$Y$f$v$w%P%X%iV#j!b$g%pw!]]_!X!b!q#W#Y#]#y$T$Y$f$g$v$w%P%X%i%pp!`]_!X!q#W#Y#]#y$T$Y$f$v$w%P%X%iQ!j`U#j!b$g%pR#t!kT#d!_#eQ!OVR!zqQ!y!OR$R!zQ!RWR!|rQ!TXR!}sQzUQ#TxQ#q!gQ#w!nQ#x!oQ%`$rR%s%_SiPyQ!tjQ#{!rR$y#|ZhPjy!r#|R#`!ZQ%U$_R%t%kc!f^bc!Z!b!d#`#l#mQ#h!bQ%Z$gR%w%pR!k`R!maR#v!mS$r#u$sR%q%^V$p#u$s%^Q!vlR$P!vQfOSjPyU!pfj#|R#|!rQ$Y#WU%O$Y%X%iQ%X$fR%i%PQ#e!_R$d#eQ%Q$YR%j%QQ$|$VR%h$|QxUR#SxQ$w#yR%d$wQ!siS#}!s$OR$O!tQ%l%UR%u%lQ#n!cR$k#nQ$s#uR%a$sQ%_$rR%r%__eOPfjy!r#|^UOPfjy!r#|Q!UYQ!VZQ#OtQ#PuQ#QvQ#RwQ$V#VQ$l#pR%g${R$Z#WQ!Z]Q!h_Q#Z!XQ#y!q[$X#W$Y$f%P%X%iQ$[#YQ$^#]S$u#y$wQ$z$TR%c$vR$W#VQkPR#UyQ!g^Q!ocQ#_!ZR$a#`W!c^c!Z#`Q!nbQ#i!bQ#o!dQ$i#lR$j#mQ#k!bQ%Z$gR%w%p",nodeNames:"⚠ Unit VariableName Comment StyleSheet RuleSet UniversalSelector TagSelector TagName NestingSelector ClassSelector . ClassName PseudoClassSelector : :: PseudoClassName PseudoClassName ) ( ArgList ValueName ParenthesizedValue ColorLiteral NumberLiteral StringLiteral BinaryExpression BinOp CallExpression Callee CallLiteral CallTag ParenthesizedContent ] [ LineNames LineName , PseudoClassName ArgList IdSelector # IdName AttributeSelector AttributeName MatchOp ChildSelector ChildOp DescendantSelector SiblingSelector SiblingOp } { Block Declaration PropertyName Important ; ImportStatement AtKeyword import Layer layer LayerName KeywordQuery FeatureQuery FeatureName BinaryQuery LogicOp ComparisonQuery CompareOp UnaryQuery UnaryQueryOp ParenthesizedQuery SelectorQuery selector MediaStatement media CharsetStatement charset NamespaceStatement namespace NamespaceName KeyframesStatement keyframes KeyframeName KeyframeList KeyframeSelector KeyframeRangeName SupportsStatement supports AtRule Styles",maxTerm:126,nodeProps:[["isolate",-2,3,25,""],["openedBy",18,"(",33,"[",51,"{"],["closedBy",19,")",34,"]",52,"}"]],propSources:[_ce],skippedNodes:[0,3,93],repeatNodeCount:13,tokenData:"LU~R!^OX$}X^%u^p$}pq%uqr)Xrs.Rst/utu6duv$}vw7^wx7oxy9^yz9oz{9t{|:_|}?Q}!O?c!O!P@Q!P!Q@i!Q![Ab![!]B]!]!^CX!^!_Cj!_!`Df!`!aDy!a!b$}!b!cEz!c!}$}!}#OHX#O#P$}#P#QHj#Q#R6d#R#T$}#T#UH{#U#c$}#c#dJ^#d#o$}#o#pJs#p#q6d#q#rKU#r#sKg#s#y$}#y#z%u#z$f$}$f$g%u$g#BY$}#BY#BZ%u#BZ$IS$}$IS$I_%u$I_$I|$}$I|$JO%u$JO$JT$}$JT$JU%u$JU$KV$}$KV$KW%u$KW&FU$}&FU&FV%u&FV;'S$};'S;=`LO<%lO$}`%QSOy%^z;'S%^;'S;=`%o<%lO%^`%cSp`Oy%^z;'S%^;'S;=`%o<%lO%^`%rP;=`<%l%^~%zh#d~OX%^X^'f^p%^pq'fqy%^z#y%^#y#z'f#z$f%^$f$g'f$g#BY%^#BY#BZ'f#BZ$IS%^$IS$I_'f$I_$I|%^$I|$JO'f$JO$JT%^$JT$JU'f$JU$KV%^$KV$KW'f$KW&FU%^&FU&FV'f&FV;'S%^;'S;=`%o<%lO%^~'mh#d~p`OX%^X^'f^p%^pq'fqy%^z#y%^#y#z'f#z$f%^$f$g'f$g#BY%^#BY#BZ'f#BZ$IS%^$IS$I_'f$I_$I|%^$I|$JO'f$JO$JT%^$JT$JU'f$JU$KV%^$KV$KW'f$KW&FU%^&FU&FV'f&FV;'S%^;'S;=`%o<%lO%^l)[UOy%^z#]%^#]#^)n#^;'S%^;'S;=`%o<%lO%^l)sUp`Oy%^z#a%^#a#b*V#b;'S%^;'S;=`%o<%lO%^l*[Up`Oy%^z#d%^#d#e*n#e;'S%^;'S;=`%o<%lO%^l*sUp`Oy%^z#c%^#c#d+V#d;'S%^;'S;=`%o<%lO%^l+[Up`Oy%^z#f%^#f#g+n#g;'S%^;'S;=`%o<%lO%^l+sUp`Oy%^z#h%^#h#i,V#i;'S%^;'S;=`%o<%lO%^l,[Up`Oy%^z#T%^#T#U,n#U;'S%^;'S;=`%o<%lO%^l,sUp`Oy%^z#b%^#b#c-V#c;'S%^;'S;=`%o<%lO%^l-[Up`Oy%^z#h%^#h#i-n#i;'S%^;'S;=`%o<%lO%^l-uS!Y[p`Oy%^z;'S%^;'S;=`%o<%lO%^~.UWOY.RZr.Rrs.ns#O.R#O#P.s#P;'S.R;'S;=`/o<%lO.R~.sOi~~.vRO;'S.R;'S;=`/P;=`O.R~/SXOY.RZr.Rrs.ns#O.R#O#P.s#P;'S.R;'S;=`/o;=`<%l.R<%lO.R~/rP;=`<%l.Rn/zYyQOy%^z!Q%^!Q![0j![!c%^!c!i0j!i#T%^#T#Z0j#Z;'S%^;'S;=`%o<%lO%^l0oYp`Oy%^z!Q%^!Q![1_![!c%^!c!i1_!i#T%^#T#Z1_#Z;'S%^;'S;=`%o<%lO%^l1dYp`Oy%^z!Q%^!Q![2S![!c%^!c!i2S!i#T%^#T#Z2S#Z;'S%^;'S;=`%o<%lO%^l2ZYg[p`Oy%^z!Q%^!Q![2y![!c%^!c!i2y!i#T%^#T#Z2y#Z;'S%^;'S;=`%o<%lO%^l3QYg[p`Oy%^z!Q%^!Q![3p![!c%^!c!i3p!i#T%^#T#Z3p#Z;'S%^;'S;=`%o<%lO%^l3uYp`Oy%^z!Q%^!Q![4e![!c%^!c!i4e!i#T%^#T#Z4e#Z;'S%^;'S;=`%o<%lO%^l4lYg[p`Oy%^z!Q%^!Q![5[![!c%^!c!i5[!i#T%^#T#Z5[#Z;'S%^;'S;=`%o<%lO%^l5aYp`Oy%^z!Q%^!Q![6P![!c%^!c!i6P!i#T%^#T#Z6P#Z;'S%^;'S;=`%o<%lO%^l6WSg[p`Oy%^z;'S%^;'S;=`%o<%lO%^d6gUOy%^z!_%^!_!`6y!`;'S%^;'S;=`%o<%lO%^d7QS}Sp`Oy%^z;'S%^;'S;=`%o<%lO%^b7cSXQOy%^z;'S%^;'S;=`%o<%lO%^~7rWOY7oZw7owx.nx#O7o#O#P8[#P;'S7o;'S;=`9W<%lO7o~8_RO;'S7o;'S;=`8h;=`O7o~8kXOY7oZw7owx.nx#O7o#O#P8[#P;'S7o;'S;=`9W;=`<%l7o<%lO7o~9ZP;=`<%l7on9cSc^Oy%^z;'S%^;'S;=`%o<%lO%^~9tOb~n9{UUQkWOy%^z!_%^!_!`6y!`;'S%^;'S;=`%o<%lO%^n:fWkW!SQOy%^z!O%^!O!P;O!P!Q%^!Q![>T![;'S%^;'S;=`%o<%lO%^l;TUp`Oy%^z!Q%^!Q![;g![;'S%^;'S;=`%o<%lO%^l;nYp`#m[Oy%^z!Q%^!Q![;g![!g%^!g!h<^!h#X%^#X#Y<^#Y;'S%^;'S;=`%o<%lO%^l<cYp`Oy%^z{%^{|=R|}%^}!O=R!O!Q%^!Q![=j![;'S%^;'S;=`%o<%lO%^l=WUp`Oy%^z!Q%^!Q![=j![;'S%^;'S;=`%o<%lO%^l=qUp`#m[Oy%^z!Q%^!Q![=j![;'S%^;'S;=`%o<%lO%^l>[[p`#m[Oy%^z!O%^!O!P;g!P!Q%^!Q![>T![!g%^!g!h<^!h#X%^#X#Y<^#Y;'S%^;'S;=`%o<%lO%^n?VSu^Oy%^z;'S%^;'S;=`%o<%lO%^l?hWkWOy%^z!O%^!O!P;O!P!Q%^!Q![>T![;'S%^;'S;=`%o<%lO%^n@VUZQOy%^z!Q%^!Q![;g![;'S%^;'S;=`%o<%lO%^~@nTkWOy%^z{@}{;'S%^;'S;=`%o<%lO%^~AUSp`#e~Oy%^z;'S%^;'S;=`%o<%lO%^lAg[#m[Oy%^z!O%^!O!P;g!P!Q%^!Q![>T![!g%^!g!h<^!h#X%^#X#Y<^#Y;'S%^;'S;=`%o<%lO%^jBbU^YOy%^z![%^![!]Bt!];'S%^;'S;=`%o<%lO%^bB{S_Qp`Oy%^z;'S%^;'S;=`%o<%lO%^nC^S!Z^Oy%^z;'S%^;'S;=`%o<%lO%^hCoU!hWOy%^z!_%^!_!`DR!`;'S%^;'S;=`%o<%lO%^hDYS!hWp`Oy%^z;'S%^;'S;=`%o<%lO%^lDmS!hW}SOy%^z;'S%^;'S;=`%o<%lO%^jEQV!PQ!hWOy%^z!_%^!_!`DR!`!aEg!a;'S%^;'S;=`%o<%lO%^bEnS!PQp`Oy%^z;'S%^;'S;=`%o<%lO%^bE}YOy%^z}%^}!OFm!O!c%^!c!}G[!}#T%^#T#oG[#o;'S%^;'S;=`%o<%lO%^bFrWp`Oy%^z!c%^!c!}G[!}#T%^#T#oG[#o;'S%^;'S;=`%o<%lO%^bGc[!]Qp`Oy%^z}%^}!OG[!O!Q%^!Q![G[![!c%^!c!}G[!}#T%^#T#oG[#o;'S%^;'S;=`%o<%lO%^nH^Sr^Oy%^z;'S%^;'S;=`%o<%lO%^nHoSq^Oy%^z;'S%^;'S;=`%o<%lO%^jIOUOy%^z#b%^#b#cIb#c;'S%^;'S;=`%o<%lO%^jIgUp`Oy%^z#W%^#W#XIy#X;'S%^;'S;=`%o<%lO%^jJQS!fYp`Oy%^z;'S%^;'S;=`%o<%lO%^jJaUOy%^z#f%^#f#gIy#g;'S%^;'S;=`%o<%lO%^fJxS!UUOy%^z;'S%^;'S;=`%o<%lO%^nKZS!T^Oy%^z;'S%^;'S;=`%o<%lO%^fKlU!SQOy%^z!_%^!_!`6y!`;'S%^;'S;=`%o<%lO%^`LRP;=`<%l$}",tokenizers:[yce,vce,Oce,1,2,3,4,new ap("m~RRYZ[z{a~~g~aO#g~~dP!P!Qg~lO#h~~",28,114)],topRules:{StyleSheet:[0,4],Styles:[1,92]},specialized:[{term:108,get:s=>kce[s]||-1},{term:59,get:s=>Sce[s]||-1},{term:110,get:s=>Cce[s]||-1}],tokenPrec:1441});let ub=null;function hb(){if(!ub&&typeof document=="object"&&document.body){let{style:s}=document.body,t=[],e=new Set;for(let i in s)i!="cssText"&&i!="cssFloat"&&typeof s[i]=="string"&&(/[A-Z]/.test(i)&&(i=i.replace(/[A-Z]/g,n=>"-"+n.toLowerCase())),e.has(i)||(t.push(i),e.add(i)));ub=t.sort().map(i=>({type:"property",label:i,apply:i+": "}))}return ub||[]}const vE=["active","after","any-link","autofill","backdrop","before","checked","cue","default","defined","disabled","empty","enabled","file-selector-button","first","first-child","first-letter","first-line","first-of-type","focus","focus-visible","focus-within","fullscreen","has","host","host-context","hover","in-range","indeterminate","invalid","is","lang","last-child","last-of-type","left","link","marker","modal","not","nth-child","nth-last-child","nth-last-of-type","nth-of-type","only-child","only-of-type","optional","out-of-range","part","placeholder","placeholder-shown","read-only","read-write","required","right","root","scope","selection","slotted","target","target-text","valid","visited","where"].map(s=>({type:"class",label:s})),_E=["above","absolute","activeborder","additive","activecaption","after-white-space","ahead","alias","all","all-scroll","alphabetic","alternate","always","antialiased","appworkspace","asterisks","attr","auto","auto-flow","avoid","avoid-column","avoid-page","avoid-region","axis-pan","background","backwards","baseline","below","bidi-override","blink","block","block-axis","bold","bolder","border","border-box","both","bottom","break","break-all","break-word","bullets","button","button-bevel","buttonface","buttonhighlight","buttonshadow","buttontext","calc","capitalize","caps-lock-indicator","caption","captiontext","caret","cell","center","checkbox","circle","cjk-decimal","clear","clip","close-quote","col-resize","collapse","color","color-burn","color-dodge","column","column-reverse","compact","condensed","contain","content","contents","content-box","context-menu","continuous","copy","counter","counters","cover","crop","cross","crosshair","currentcolor","cursive","cyclic","darken","dashed","decimal","decimal-leading-zero","default","default-button","dense","destination-atop","destination-in","destination-out","destination-over","difference","disc","discard","disclosure-closed","disclosure-open","document","dot-dash","dot-dot-dash","dotted","double","down","e-resize","ease","ease-in","ease-in-out","ease-out","element","ellipse","ellipsis","embed","end","ethiopic-abegede-gez","ethiopic-halehame-aa-er","ethiopic-halehame-gez","ew-resize","exclusion","expanded","extends","extra-condensed","extra-expanded","fantasy","fast","fill","fill-box","fixed","flat","flex","flex-end","flex-start","footnotes","forwards","from","geometricPrecision","graytext","grid","groove","hand","hard-light","help","hidden","hide","higher","highlight","highlighttext","horizontal","hsl","hsla","hue","icon","ignore","inactiveborder","inactivecaption","inactivecaptiontext","infinite","infobackground","infotext","inherit","initial","inline","inline-axis","inline-block","inline-flex","inline-grid","inline-table","inset","inside","intrinsic","invert","italic","justify","keep-all","landscape","large","larger","left","level","lighter","lighten","line-through","linear","linear-gradient","lines","list-item","listbox","listitem","local","logical","loud","lower","lower-hexadecimal","lower-latin","lower-norwegian","lowercase","ltr","luminosity","manipulation","match","matrix","matrix3d","medium","menu","menutext","message-box","middle","min-intrinsic","mix","monospace","move","multiple","multiple_mask_images","multiply","n-resize","narrower","ne-resize","nesw-resize","no-close-quote","no-drop","no-open-quote","no-repeat","none","normal","not-allowed","nowrap","ns-resize","numbers","numeric","nw-resize","nwse-resize","oblique","opacity","open-quote","optimizeLegibility","optimizeSpeed","outset","outside","outside-shape","overlay","overline","padding","padding-box","painted","page","paused","perspective","pinch-zoom","plus-darker","plus-lighter","pointer","polygon","portrait","pre","pre-line","pre-wrap","preserve-3d","progress","push-button","radial-gradient","radio","read-only","read-write","read-write-plaintext-only","rectangle","region","relative","repeat","repeating-linear-gradient","repeating-radial-gradient","repeat-x","repeat-y","reset","reverse","rgb","rgba","ridge","right","rotate","rotate3d","rotateX","rotateY","rotateZ","round","row","row-resize","row-reverse","rtl","run-in","running","s-resize","sans-serif","saturation","scale","scale3d","scaleX","scaleY","scaleZ","screen","scroll","scrollbar","scroll-position","se-resize","self-start","self-end","semi-condensed","semi-expanded","separate","serif","show","single","skew","skewX","skewY","skip-white-space","slide","slider-horizontal","slider-vertical","sliderthumb-horizontal","sliderthumb-vertical","slow","small","small-caps","small-caption","smaller","soft-light","solid","source-atop","source-in","source-out","source-over","space","space-around","space-between","space-evenly","spell-out","square","start","static","status-bar","stretch","stroke","stroke-box","sub","subpixel-antialiased","svg_masks","super","sw-resize","symbolic","symbols","system-ui","table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row","table-row-group","text","text-bottom","text-top","textarea","textfield","thick","thin","threeddarkshadow","threedface","threedhighlight","threedlightshadow","threedshadow","to","top","transform","translate","translate3d","translateX","translateY","translateZ","transparent","ultra-condensed","ultra-expanded","underline","unidirectional-pan","unset","up","upper-latin","uppercase","url","var","vertical","vertical-text","view-box","visible","visibleFill","visiblePainted","visibleStroke","visual","w-resize","wait","wave","wider","window","windowframe","windowtext","words","wrap","wrap-reverse","x-large","x-small","xor","xx-large","xx-small"].map(s=>({type:"keyword",label:s})).concat(["aliceblue","antiquewhite","aqua","aquamarine","azure","beige","bisque","black","blanchedalmond","blue","blueviolet","brown","burlywood","cadetblue","chartreuse","chocolate","coral","cornflowerblue","cornsilk","crimson","cyan","darkblue","darkcyan","darkgoldenrod","darkgray","darkgreen","darkkhaki","darkmagenta","darkolivegreen","darkorange","darkorchid","darkred","darksalmon","darkseagreen","darkslateblue","darkslategray","darkturquoise","darkviolet","deeppink","deepskyblue","dimgray","dodgerblue","firebrick","floralwhite","forestgreen","fuchsia","gainsboro","ghostwhite","gold","goldenrod","gray","grey","green","greenyellow","honeydew","hotpink","indianred","indigo","ivory","khaki","lavender","lavenderblush","lawngreen","lemonchiffon","lightblue","lightcoral","lightcyan","lightgoldenrodyellow","lightgray","lightgreen","lightpink","lightsalmon","lightseagreen","lightskyblue","lightslategray","lightsteelblue","lightyellow","lime","limegreen","linen","magenta","maroon","mediumaquamarine","mediumblue","mediumorchid","mediumpurple","mediumseagreen","mediumslateblue","mediumspringgreen","mediumturquoise","mediumvioletred","midnightblue","mintcream","mistyrose","moccasin","navajowhite","navy","oldlace","olive","olivedrab","orange","orangered","orchid","palegoldenrod","palegreen","paleturquoise","palevioletred","papayawhip","peachpuff","peru","pink","plum","powderblue","purple","rebeccapurple","red","rosybrown","royalblue","saddlebrown","salmon","sandybrown","seagreen","seashell","sienna","silver","skyblue","slateblue","slategray","snow","springgreen","steelblue","tan","teal","thistle","tomato","turquoise","violet","wheat","white","whitesmoke","yellow","yellowgreen"].map(s=>({type:"constant",label:s}))),Tce=["a","abbr","address","article","aside","b","bdi","bdo","blockquote","body","br","button","canvas","caption","cite","code","col","colgroup","dd","del","details","dfn","dialog","div","dl","dt","em","figcaption","figure","footer","form","header","hgroup","h1","h2","h3","h4","h5","h6","hr","html","i","iframe","img","input","ins","kbd","label","legend","li","main","meter","nav","ol","output","p","pre","ruby","section","select","small","source","span","strong","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","tr","u","ul"].map(s=>({type:"type",label:s})),Ece=["@charset","@color-profile","@container","@counter-style","@font-face","@font-feature-values","@font-palette-values","@import","@keyframes","@layer","@media","@namespace","@page","@position-try","@property","@scope","@starting-style","@supports","@view-transition"].map(s=>({type:"keyword",label:s})),_r=/^(\w[\w-]*|-\w[\w-]*|)$/,Ace=/^-(-[\w-]*)?$/;function Ice(s,t){var e;if((s.name=="("||s.type.isError)&&(s=s.parent||s),s.name!="ArgList")return!1;let i=(e=s.parent)===null||e===void 0?void 0:e.firstChild;return(i==null?void 0:i.name)!="Callee"?!1:t.sliceString(i.from,i.to)=="var"}const kE=new hR,Rce=["Declaration"];function Vce(s){for(let t=s;;){if(t.type.isTop)return t;if(!(t=t.parent))return s}}function DV(s,t,e){if(t.to-t.from>4096){let i=kE.get(t);if(i)return i;let n=[],r=new Set,o=t.cursor(kt.IncludeAnonymous);if(o.firstChild())do for(let l of DV(s,o.node,e))r.has(l.label)||(r.add(l.label),n.push(l));while(o.nextSibling());return kE.set(t,n),n}else{let i=[],n=new Set;return t.cursor().iterate(r=>{var o;if(e(r)&&r.matchContext(Rce)&&((o=r.node.nextSibling)===null||o===void 0?void 0:o.name)==":"){let l=s.sliceString(r.from,r.to);n.has(l)||(n.add(l),i.push({label:l,type:"variable"}))}}),i}}const Mce=s=>t=>{let{state:e,pos:i}=t,n=St(e).resolveInner(i,-1),r=n.type.isError&&n.from==n.to-1&&e.doc.sliceString(n.from,n.to)=="-";if(n.name=="PropertyName"||(r||n.name=="TagName")&&/^(Block|Styles)$/.test(n.resolve(n.to).name))return{from:n.from,options:hb(),validFor:_r};if(n.name=="ValueName")return{from:n.from,options:_E,validFor:_r};if(n.name=="PseudoClassName")return{from:n.from,options:vE,validFor:_r};if(s(n)||(t.explicit||r)&&Ice(n,e.doc))return{from:s(n)||r?n.from:i,options:DV(e.doc,Vce(n),s),validFor:Ace};if(n.name=="TagName"){for(let{parent:a}=n;a;a=a.parent)if(a.name=="Block")return{from:n.from,options:hb(),validFor:_r};return{from:n.from,options:Tce,validFor:_r}}if(n.name=="AtKeyword")return{from:n.from,options:Ece,validFor:_r};if(!t.explicit)return null;let o=n.resolve(i),l=o.childBefore(i);return l&&l.name==":"&&o.name=="PseudoClassSelector"?{from:i,options:vE,validFor:_r}:l&&l.name==":"&&o.name=="Declaration"||o.name=="ArgList"?{from:i,options:_E,validFor:_r}:o.name=="Block"||o.name=="Styles"?{from:i,options:hb(),validFor:_r}:null},Lce=Mce(s=>s.name=="VariableName"),hp=_c.define({name:"css",parser:Pce.configure({props:[Pd.add({Declaration:ig()}),$c.add({"Block KeyframeList":bR})]}),languageData:{commentTokens:{block:{open:"/*",close:"*/"}},indentOnInput:/^\s*\}$/,wordChars:"-"}});function Bce(){return new Yh(hp,hp.data.of({autocomplete:Lce}))}const $ce=315,Dce=316,SE=1,Qce=2,Nce=3,Fce=4,zce=317,Wce=319,Uce=320,Zce=5,Hce=6,qce=0,mO=[9,10,11,12,13,32,133,160,5760,8192,8193,8194,8195,8196,8197,8198,8199,8200,8201,8202,8232,8233,8239,8287,12288],QV=125,jce=59,gO=47,Xce=42,Gce=43,Yce=45,Kce=60,Jce=44,eue=63,tue=46,iue=91,nue=new _V({start:!1,shift(s,t){return t==Zce||t==Hce||t==Wce?s:t==Uce},strict:!1}),sue=new Os((s,t)=>{let{next:e}=s;(e==QV||e==-1||t.context)&&s.acceptToken(zce)},{contextual:!0,fallback:!0}),rue=new Os((s,t)=>{let{next:e}=s,i;mO.indexOf(e)>-1||e==gO&&((i=s.peek(1))==gO||i==Xce)||e!=QV&&e!=jce&&e!=-1&&!t.context&&s.acceptToken($ce)},{contextual:!0}),oue=new Os((s,t)=>{s.next==iue&&!t.context&&s.acceptToken(Dce)},{contextual:!0}),lue=new Os((s,t)=>{let{next:e}=s;if(e==Gce||e==Yce){if(s.advance(),e==s.next){s.advance();let i=!t.context&&t.canShift(SE);s.acceptToken(i?SE:Qce)}}else e==eue&&s.peek(1)==tue&&(s.advance(),s.advance(),(s.next<48||s.next>57)&&s.acceptToken(Nce))},{contextual:!0});function db(s,t){return s>=65&&s<=90||s>=97&&s<=122||s==95||s>=192||!t&&s>=48&&s<=57}const aue=new Os((s,t)=>{if(s.next!=Kce||!t.dialectEnabled(qce)||(s.advance(),s.next==gO))return;let e=0;for(;mO.indexOf(s.next)>-1;)s.advance(),e++;if(db(s.next,!0)){for(s.advance(),e++;db(s.next,!1);)s.advance(),e++;for(;mO.indexOf(s.next)>-1;)s.advance(),e++;if(s.next==Jce)return;for(let i=0;;i++){if(i==7){if(!db(s.next,!0))return;break}if(s.next!="extends".charCodeAt(i))break;s.advance(),e++}}s.acceptToken(Fce,-e)}),cue=Bc({"get set async static":T.modifier,"for while do if else switch try catch finally return throw break continue default case":T.controlKeyword,"in of await yield void typeof delete instanceof as satisfies":T.operatorKeyword,"let var const using function class extends":T.definitionKeyword,"import export from":T.moduleKeyword,"with debugger new":T.keyword,TemplateString:T.special(T.string),super:T.atom,BooleanLiteral:T.bool,this:T.self,null:T.null,Star:T.modifier,VariableName:T.variableName,"CallExpression/VariableName TaggedTemplateExpression/VariableName":T.function(T.variableName),VariableDefinition:T.definition(T.variableName),Label:T.labelName,PropertyName:T.propertyName,PrivatePropertyName:T.special(T.propertyName),"CallExpression/MemberExpression/PropertyName":T.function(T.propertyName),"FunctionDeclaration/VariableDefinition":T.function(T.definition(T.variableName)),"ClassDeclaration/VariableDefinition":T.definition(T.className),"NewExpression/VariableName":T.className,PropertyDefinition:T.definition(T.propertyName),PrivatePropertyDefinition:T.definition(T.special(T.propertyName)),UpdateOp:T.updateOperator,"LineComment Hashbang":T.lineComment,BlockComment:T.blockComment,Number:T.number,String:T.string,Escape:T.escape,ArithOp:T.arithmeticOperator,LogicOp:T.logicOperator,BitOp:T.bitwiseOperator,CompareOp:T.compareOperator,RegExp:T.regexp,Equals:T.definitionOperator,Arrow:T.function(T.punctuation),": Spread":T.punctuation,"( )":T.paren,"[ ]":T.squareBracket,"{ }":T.brace,"InterpolationStart InterpolationEnd":T.special(T.brace),".":T.derefOperator,", ;":T.separator,"@":T.meta,TypeName:T.typeName,TypeDefinition:T.definition(T.typeName),"type enum interface implements namespace module declare":T.definitionKeyword,"abstract global Privacy readonly override":T.modifier,"is keyof unique infer asserts":T.operatorKeyword,JSXAttributeValue:T.attributeValue,JSXText:T.content,"JSXStartTag JSXStartCloseTag JSXSelfCloseEndTag JSXEndTag":T.angleBracket,"JSXIdentifier JSXNameSpacedName":T.tagName,"JSXAttribute/JSXIdentifier JSXAttribute/JSXNameSpacedName":T.attributeName,"JSXBuiltin/JSXIdentifier":T.standard(T.tagName)}),uue={__proto__:null,export:20,as:25,from:33,default:36,async:41,function:42,in:52,out:55,const:56,extends:60,this:64,true:72,false:72,null:84,void:88,typeof:92,super:108,new:142,delete:154,yield:163,await:167,class:172,public:235,private:235,protected:235,readonly:237,instanceof:256,satisfies:259,import:292,keyof:349,unique:353,infer:359,asserts:395,is:397,abstract:417,implements:419,type:421,let:424,var:426,using:429,interface:435,enum:439,namespace:445,module:447,declare:451,global:455,for:474,of:483,while:486,with:490,do:494,if:498,else:500,switch:504,case:510,try:516,catch:520,finally:524,return:528,throw:532,break:536,continue:540,debugger:544},hue={__proto__:null,async:129,get:131,set:133,declare:195,public:197,private:197,protected:197,static:199,abstract:201,override:203,readonly:209,accessor:211,new:401},due={__proto__:null,"<":193},fue=Sc.deserialize({version:14,states:"$EOQ%TQlOOO%[QlOOO'_QpOOP(lO`OOO*zQ!0MxO'#CiO+RO#tO'#CjO+aO&jO'#CjO+oO#@ItO'#DaO.QQlO'#DgO.bQlO'#DrO%[QlO'#DzO0fQlO'#ESOOQ!0Lf'#E['#E[O1PQ`O'#EXOOQO'#Ep'#EpOOQO'#Ik'#IkO1XQ`O'#GsO1dQ`O'#EoO1iQ`O'#EoO3hQ!0MxO'#JqO6[Q!0MxO'#JrO6uQ`O'#F]O6zQ,UO'#FtOOQ!0Lf'#Ff'#FfO7VO7dO'#FfO7eQMhO'#F|O9[Q`O'#F{OOQ!0Lf'#Jr'#JrOOQ!0Lb'#Jq'#JqO9aQ`O'#GwOOQ['#K^'#K^O9lQ`O'#IXO9qQ!0LrO'#IYOOQ['#J_'#J_OOQ['#I^'#I^Q`QlOOQ`QlOOO9yQ!L^O'#DvO:QQlO'#EOO:XQlO'#EQO9gQ`O'#GsO:`QMhO'#CoO:nQ`O'#EnO:yQ`O'#EyO;OQMhO'#FeO;mQ`O'#GsOOQO'#K_'#K_O;rQ`O'#K_O<QQ`O'#G{O<QQ`O'#G|O<QQ`O'#HOO9gQ`O'#HRO<wQ`O'#HUO>`Q`O'#CeO>pQ`O'#HbO>xQ`O'#HhO>xQ`O'#HjO`QlO'#HlO>xQ`O'#HnO>xQ`O'#HqO>}Q`O'#HwO?SQ!0LsO'#H}O%[QlO'#IPO?_Q!0LsO'#IRO?jQ!0LsO'#ITO9qQ!0LrO'#IVO?uQ!0MxO'#CiO@wQpO'#DlQOQ`OOO%[QlO'#EQOA_Q`O'#ETO:`QMhO'#EnOAjQ`O'#EnOAuQ!bO'#FeOOQ['#Cg'#CgOOQ!0Lb'#Dq'#DqOOQ!0Lb'#Ju'#JuO%[QlO'#JuOOQO'#Jx'#JxOOQO'#Ig'#IgOBuQpO'#EgOOQ!0Lb'#Ef'#EfOOQ!0Lb'#J|'#J|OCqQ!0MSO'#EgOC{QpO'#EWOOQO'#Jw'#JwODaQpO'#JxOEnQpO'#EWOC{QpO'#EgPE{O&2DjO'#CbPOOO)CD|)CD|OOOO'#I_'#I_OFWO#tO,59UOOQ!0Lh,59U,59UOOOO'#I`'#I`OFfO&jO,59UOFtQ!L^O'#DcOOOO'#Ib'#IbOF{O#@ItO,59{OOQ!0Lf,59{,59{OGZQlO'#IcOGnQ`O'#JsOImQ!fO'#JsO+}QlO'#JsOItQ`O,5:ROJ[Q`O'#EpOJiQ`O'#KSOJtQ`O'#KROJtQ`O'#KROJ|Q`O,5;^OKRQ`O'#KQOOQ!0Ln,5:^,5:^OKYQlO,5:^OMWQ!0MxO,5:fOMwQ`O,5:nONbQ!0LrO'#KPONiQ`O'#KOO9aQ`O'#KOON}Q`O'#KOO! VQ`O,5;]O! [Q`O'#KOO!#aQ!fO'#JrOOQ!0Lh'#Ci'#CiO%[QlO'#ESO!$PQ!fO,5:sOOQS'#Jy'#JyOOQO-E<i-E<iO9gQ`O,5=_O!$gQ`O,5=_O!$lQlO,5;ZO!&oQMhO'#EkO!(YQ`O,5;ZO!(_QlO'#DyO!(iQpO,5;dO!(qQpO,5;dO%[QlO,5;dOOQ['#FT'#FTOOQ['#FV'#FVO%[QlO,5;eO%[QlO,5;eO%[QlO,5;eO%[QlO,5;eO%[QlO,5;eO%[QlO,5;eO%[QlO,5;eO%[QlO,5;eO%[QlO,5;eO%[QlO,5;eOOQ['#FZ'#FZO!)PQlO,5;tOOQ!0Lf,5;y,5;yOOQ!0Lf,5;z,5;zOOQ!0Lf,5;|,5;|O%[QlO'#IoO!+SQ!0LrO,5<iO%[QlO,5;eO!&oQMhO,5;eO!+qQMhO,5;eO!-cQMhO'#E^O%[QlO,5;wOOQ!0Lf,5;{,5;{O!-jQ,UO'#FjO!.gQ,UO'#KWO!.RQ,UO'#KWO!.nQ,UO'#KWOOQO'#KW'#KWO!/SQ,UO,5<SOOOW,5<`,5<`O!/eQlO'#FvOOOW'#In'#InO7VO7dO,5<QO!/lQ,UO'#FxOOQ!0Lf,5<Q,5<QO!0]Q$IUO'#CyOOQ!0Lh'#C}'#C}O!0pO#@ItO'#DRO!1^QMjO,5<eO!1eQ`O,5<hO!3QQ(CWO'#GXO!3_Q`O'#GYO!3dQ`O'#GYO!5SQ(CWO'#G^O!6XQpO'#GbOOQO'#Gn'#GnO!+xQMhO'#GmOOQO'#Gp'#GpO!+xQMhO'#GoO!6zQ$IUO'#JkOOQ!0Lh'#Jk'#JkO!7UQ`O'#JjO!7dQ`O'#JiO!7lQ`O'#CuOOQ!0Lh'#C{'#C{O!7}Q`O'#C}OOQ!0Lh'#DV'#DVOOQ!0Lh'#DX'#DXO1SQ`O'#DZO!+xQMhO'#GPO!+xQMhO'#GRO!8SQ`O'#GTO!8XQ`O'#GUO!3dQ`O'#G[O!+xQMhO'#GaO<QQ`O'#JjO!8^Q`O'#EqO!8{Q`O,5<gOOQ!0Lb'#Cr'#CrO!9TQ`O'#ErO!9}QpO'#EsOOQ!0Lb'#KQ'#KQO!:UQ!0LrO'#K`O9qQ!0LrO,5=cO`QlO,5>sOOQ['#Jg'#JgOOQ[,5>t,5>tOOQ[-E<[-E<[O!<TQ!0MxO,5:bO!9xQpO,5:`O!>nQ!0MxO,5:jO%[QlO,5:jO!AUQ!0MxO,5:lOOQO,5@y,5@yO!AuQMhO,5=_O!BTQ!0LrO'#JhO9[Q`O'#JhO!BfQ!0LrO,59ZO!BqQpO,59ZO!ByQMhO,59ZO:`QMhO,59ZO!CUQ`O,5;ZO!C^Q`O'#HaO!CrQ`O'#KcO%[QlO,5;}O!9xQpO,5<PO!CzQ`O,5=zO!DPQ`O,5=zO!DUQ`O,5=zO9qQ!0LrO,5=zO<QQ`O,5=jOOQO'#Cy'#CyO!DdQpO,5=gO!DlQMhO,5=hO!DwQ`O,5=jO!D|Q!bO,5=mO!EUQ`O'#K_O>}Q`O'#HWO9gQ`O'#HYO!EZQ`O'#HYO:`QMhO'#H[O!E`Q`O'#H[OOQ[,5=p,5=pO!EeQ`O'#H]O!EvQ`O'#CoO!E{Q`O,59PO!FVQ`O,59PO!H[QlO,59POOQ[,59P,59PO!HlQ!0LrO,59PO%[QlO,59PO!JwQlO'#HdOOQ['#He'#HeOOQ['#Hf'#HfO`QlO,5=|O!K_Q`O,5=|O`QlO,5>SO`QlO,5>UO!KdQ`O,5>WO`QlO,5>YO!KiQ`O,5>]O!KnQlO,5>cOOQ[,5>i,5>iO%[QlO,5>iO9qQ!0LrO,5>kOOQ[,5>m,5>mO# xQ`O,5>mOOQ[,5>o,5>oO# xQ`O,5>oOOQ[,5>q,5>qO#!fQpO'#D_O%[QlO'#JuO##XQpO'#JuO##cQpO'#DmO##tQpO'#DmO#&VQlO'#DmO#&^Q`O'#JtO#&fQ`O,5:WO#&kQ`O'#EtO#&yQ`O'#KTO#'RQ`O,5;_O#'WQpO'#DmO#'eQpO'#EVOOQ!0Lf,5:o,5:oO%[QlO,5:oO#'lQ`O,5:oO>}Q`O,5;YO!BqQpO,5;YO!ByQMhO,5;YO:`QMhO,5;YO#'tQ`O,5@aO#'yQ07dO,5:sOOQO-E<e-E<eO#)PQ!0MSO,5;ROC{QpO,5:rO#)ZQpO,5:rOC{QpO,5;RO!BfQ!0LrO,5:rOOQ!0Lb'#Ej'#EjOOQO,5;R,5;RO%[QlO,5;RO#)hQ!0LrO,5;RO#)sQ!0LrO,5;RO!BqQpO,5:rOOQO,5;X,5;XO#*RQ!0LrO,5;RPOOO'#I]'#I]P#*gO&2DjO,58|POOO,58|,58|OOOO-E<]-E<]OOQ!0Lh1G.p1G.pOOOO-E<^-E<^OOOO,59},59}O#*rQ!bO,59}OOOO-E<`-E<`OOQ!0Lf1G/g1G/gO#*wQ!fO,5>}O+}QlO,5>}OOQO,5?T,5?TO#+RQlO'#IcOOQO-E<a-E<aO#+`Q`O,5@_O#+hQ!fO,5@_O#+oQ`O,5@mOOQ!0Lf1G/m1G/mO%[QlO,5@nO#+wQ`O'#IiOOQO-E<g-E<gO#+oQ`O,5@mOOQ!0Lb1G0x1G0xOOQ!0Ln1G/x1G/xOOQ!0Ln1G0Y1G0YO%[QlO,5@kO#,]Q!0LrO,5@kO#,nQ!0LrO,5@kO#,uQ`O,5@jO9aQ`O,5@jO#,}Q`O,5@jO#-]Q`O'#IlO#,uQ`O,5@jOOQ!0Lb1G0w1G0wO!(iQpO,5:uO!(tQpO,5:uOOQS,5:w,5:wO#-}QdO,5:wO#.VQMhO1G2yO9gQ`O1G2yOOQ!0Lf1G0u1G0uO#.eQ!0MxO1G0uO#/jQ!0MvO,5;VOOQ!0Lh'#GW'#GWO#0WQ!0MzO'#JkO!$lQlO1G0uO#2cQ!fO'#JvO%[QlO'#JvO#2mQ`O,5:eOOQ!0Lh'#D_'#D_OOQ!0Lf1G1O1G1OO%[QlO1G1OOOQ!0Lf1G1f1G1fO#2rQ`O1G1OO#5WQ!0MxO1G1PO#5_Q!0MxO1G1PO#7uQ!0MxO1G1PO#7|Q!0MxO1G1PO#:dQ!0MxO1G1PO#<zQ!0MxO1G1PO#=RQ!0MxO1G1PO#=YQ!0MxO1G1PO#?pQ!0MxO1G1PO#?wQ!0MxO1G1PO#BUQ?MtO'#CiO#DPQ?MtO1G1`O#DWQ?MtO'#JrO#DkQ!0MxO,5?ZOOQ!0Lb-E<m-E<mO#FxQ!0MxO1G1PO#GuQ!0MzO1G1POOQ!0Lf1G1P1G1PO#HxQMjO'#J{O#ISQ`O,5:xO#IXQ!0MxO1G1cO#I{Q,UO,5<WO#JTQ,UO,5<XO#J]Q,UO'#FoO#JtQ`O'#FnOOQO'#KX'#KXOOQO'#Im'#ImO#JyQ,UO1G1nOOQ!0Lf1G1n1G1nOOOW1G1y1G1yO#K[Q?MtO'#JqO#KfQ`O,5<bO!)PQlO,5<bOOOW-E<l-E<lOOQ!0Lf1G1l1G1lO#KkQpO'#KWOOQ!0Lf,5<d,5<dO#KsQpO,5<dO#KxQMhO'#DTOOOO'#Ia'#IaO#LPO#@ItO,59mOOQ!0Lh,59m,59mO%[QlO1G2PO!8XQ`O'#IqO#L[Q`O,5<zOOQ!0Lh,5<w,5<wO!+xQMhO'#ItO#LxQMjO,5=XO!+xQMhO'#IvO#MkQMjO,5=ZO!&oQMhO,5=]OOQO1G2S1G2SO#MuQ!dO'#CrO#NYQ(CWO'#ErO$ _QpO'#GbO$ uQ!dO,5<sO$ |Q`O'#KZO9aQ`O'#KZO$![Q`O,5<uO!+xQMhO,5<tO$!aQ`O'#GZO$!rQ`O,5<tO$!wQ!dO'#GWO$#UQ!dO'#K[O$#`Q`O'#K[O!&oQMhO'#K[O$#eQ`O,5<xO$#jQlO'#JuO$#tQpO'#GcO##tQpO'#GcO$$VQ`O'#GgO!3dQ`O'#GkO$$[Q!0LrO'#IsO$$gQpO,5<|OOQ!0Lp,5<|,5<|O$$nQpO'#GcO$${QpO'#GdO$%^QpO'#GdO$%cQMjO,5=XO$%sQMjO,5=ZOOQ!0Lh,5=^,5=^O!+xQMhO,5@UO!+xQMhO,5@UO$&TQ`O'#IxO$&iQ`O,5@TO$&qQ`O,59aOOQ!0Lh,59i,59iO$'hQ$IYO,59uOOQ!0Lh'#Jo'#JoO$(ZQMjO,5<kO$(|QMjO,5<mO@oQ`O,5<oOOQ!0Lh,5<p,5<pO$)WQ`O,5<vO$)]QMjO,5<{O$)mQ`O,5@UO$){Q`O'#KOO!$lQlO1G2RO$*QQ`O1G2RO9aQ`O'#KRO9aQ`O'#EtO%[QlO'#EtO9aQ`O'#IzO$*VQ!0LrO,5@zOOQ[1G2}1G2}OOQ[1G4_1G4_OOQ!0Lf1G/|1G/|OOQ!0Lf1G/z1G/zO$,XQ!0MxO1G0UOOQ[1G2y1G2yO!&oQMhO1G2yO%[QlO1G2yO#.YQ`O1G2yO$.]QMhO'#EkOOQ!0Lb,5@S,5@SO$.jQ!0LrO,5@SOOQ[1G.u1G.uO!BfQ!0LrO1G.uO!BqQpO1G.uO!ByQMhO1G.uO$.{Q`O1G0uO$/QQ`O'#CiO$/]Q`O'#KdO$/eQ`O,5={O$/jQ`O'#KdO$/oQ`O'#KdO$/}Q`O'#JQO$0]Q`O,5@}O$0eQ!fO1G1iOOQ!0Lf1G1k1G1kO9gQ`O1G3fO@oQ`O1G3fO$0lQ`O1G3fO$0qQ`O1G3fOOQ[1G3f1G3fO!DwQ`O1G3UO!&oQMhO1G3RO$0vQ`O1G3ROOQ[1G3S1G3SO!&oQMhO1G3SO$0{Q`O1G3SO$1TQpO'#HQOOQ[1G3U1G3UO!6SQpO'#I|O!D|Q!bO1G3XOOQ[1G3X1G3XOOQ[,5=r,5=rO$1]QMhO,5=tO9gQ`O,5=tO$$VQ`O,5=vO9[Q`O,5=vO!BqQpO,5=vO!ByQMhO,5=vO:`QMhO,5=vO$1kQ`O'#KbO$1vQ`O,5=wOOQ[1G.k1G.kO$1{Q!0LrO1G.kO@oQ`O1G.kO$2WQ`O1G.kO9qQ!0LrO1G.kO$4`Q!fO,5APO$4mQ`O,5APO9aQ`O,5APO$4xQlO,5>OO$5PQ`O,5>OOOQ[1G3h1G3hO`QlO1G3hOOQ[1G3n1G3nOOQ[1G3p1G3pO>xQ`O1G3rO$5UQlO1G3tO$9YQlO'#HsOOQ[1G3w1G3wO$9gQ`O'#HyO>}Q`O'#H{OOQ[1G3}1G3}O$9oQlO1G3}O9qQ!0LrO1G4TOOQ[1G4V1G4VOOQ!0Lb'#G_'#G_O9qQ!0LrO1G4XO9qQ!0LrO1G4ZO$=vQ`O,5@aO!)PQlO,5;`O9aQ`O,5;`O>}Q`O,5:XO!)PQlO,5:XO!BqQpO,5:XO$={Q?MtO,5:XOOQO,5;`,5;`O$>VQpO'#IdO$>mQ`O,5@`OOQ!0Lf1G/r1G/rO$>uQpO'#IjO$?PQ`O,5@oOOQ!0Lb1G0y1G0yO##tQpO,5:XOOQO'#If'#IfO$?XQpO,5:qOOQ!0Ln,5:q,5:qO#'oQ`O1G0ZOOQ!0Lf1G0Z1G0ZO%[QlO1G0ZOOQ!0Lf1G0t1G0tO>}Q`O1G0tO!BqQpO1G0tO!ByQMhO1G0tOOQ!0Lb1G5{1G5{O!BfQ!0LrO1G0^OOQO1G0m1G0mO%[QlO1G0mO$?`Q!0LrO1G0mO$?kQ!0LrO1G0mO!BqQpO1G0^OC{QpO1G0^O$?yQ!0LrO1G0mOOQO1G0^1G0^O$@_Q!0MxO1G0mPOOO-E<Z-E<ZPOOO1G.h1G.hOOOO1G/i1G/iO$@iQ!bO,5<iO$@qQ!fO1G4iOOQO1G4o1G4oO%[QlO,5>}O$@{Q`O1G5yO$ATQ`O1G6XO$A]Q!fO1G6YO9aQ`O,5?TO$AgQ!0MxO1G6VO%[QlO1G6VO$AwQ!0LrO1G6VO$BYQ`O1G6UO$BYQ`O1G6UO9aQ`O1G6UO$BbQ`O,5?WO9aQ`O,5?WOOQO,5?W,5?WO$BvQ`O,5?WO$){Q`O,5?WOOQO-E<j-E<jOOQS1G0a1G0aOOQS1G0c1G0cO#.QQ`O1G0cOOQ[7+(e7+(eO!&oQMhO7+(eO%[QlO7+(eO$CUQ`O7+(eO$CaQMhO7+(eO$CoQ!0MzO,5=XO$EzQ!0MzO,5=ZO$HVQ!0MzO,5=XO$JhQ!0MzO,5=ZO$LyQ!0MzO,59uO% OQ!0MzO,5<kO%#ZQ!0MzO,5<mO%%fQ!0MzO,5<{OOQ!0Lf7+&a7+&aO%'wQ!0MxO7+&aO%(kQlO'#IeO%(xQ`O,5@bO%)QQ!fO,5@bOOQ!0Lf1G0P1G0PO%)[Q`O7+&jOOQ!0Lf7+&j7+&jO%)aQ?MtO,5:fO%[QlO7+&zO%)kQ?MtO,5:bO%)xQ?MtO,5:jO%*SQ?MtO,5:lO%*^QMhO'#IhO%*hQ`O,5@gOOQ!0Lh1G0d1G0dOOQO1G1r1G1rOOQO1G1s1G1sO%*pQ!jO,5<ZO!)PQlO,5<YOOQO-E<k-E<kOOQ!0Lf7+'Y7+'YOOOW7+'e7+'eOOOW1G1|1G1|O%*{Q`O1G1|OOQ!0Lf1G2O1G2OOOOO,59o,59oO%+QQ!dO,59oOOOO-E<_-E<_OOQ!0Lh1G/X1G/XO%+XQ!0MxO7+'kOOQ!0Lh,5?],5?]O%+{QMhO1G2fP%,SQ`O'#IqPOQ!0Lh-E<o-E<oO%,pQMjO,5?`OOQ!0Lh-E<r-E<rO%-cQMjO,5?bOOQ!0Lh-E<t-E<tO%-mQ!dO1G2wO%-tQ!dO'#CrO%.[QMhO'#KRO$#jQlO'#JuOOQ!0Lh1G2_1G2_O%.cQ`O'#IpO%.wQ`O,5@uO%.wQ`O,5@uO%/PQ`O,5@uO%/[Q`O,5@uOOQO1G2a1G2aO%/jQMjO1G2`O!+xQMhO1G2`O%/zQ(CWO'#IrO%0XQ`O,5@vO!&oQMhO,5@vO%0aQ!dO,5@vOOQ!0Lh1G2d1G2dO%2qQ!fO'#CiO%2{Q`O,5=POOQ!0Lb,5<},5<}O%3TQpO,5<}OOQ!0Lb,5=O,5=OOClQ`O,5<}O%3`QpO,5<}OOQ!0Lb,5=R,5=RO$){Q`O,5=VOOQO,5?_,5?_OOQO-E<q-E<qOOQ!0Lp1G2h1G2hO##tQpO,5<}O$#jQlO,5=PO%3nQ`O,5=OO%3yQpO,5=OO!+xQMhO'#ItO%4sQMjO1G2sO!+xQMhO'#IvO%5fQMjO1G2uO%5pQMjO1G5pO%5zQMjO1G5pOOQO,5?d,5?dOOQO-E<v-E<vOOQO1G.{1G.{O!9xQpO,59wO%[QlO,59wOOQ!0Lh,5<j,5<jO%6XQ`O1G2ZO!+xQMhO1G2bO!+xQMhO1G5pO!+xQMhO1G5pO%6^Q!0MxO7+'mOOQ!0Lf7+'m7+'mO!$lQlO7+'mO%7QQ`O,5;`OOQ!0Lb,5?f,5?fOOQ!0Lb-E<x-E<xO%7VQ!dO'#K]O#'oQ`O7+(eO4UQ!fO7+(eO$CXQ`O7+(eO%7aQ!0MvO'#CiO%7tQ!0MvO,5=SO%8fQ`O,5=SO%8nQ`O,5=SOOQ!0Lb1G5n1G5nOOQ[7+$a7+$aO!BfQ!0LrO7+$aO!BqQpO7+$aO!$lQlO7+&aO%8sQ`O'#JPO%9[Q`O,5AOOOQO1G3g1G3gO9gQ`O,5AOO%9[Q`O,5AOO%9dQ`O,5AOOOQO,5?l,5?lOOQO-E=O-E=OOOQ!0Lf7+'T7+'TO%9iQ`O7+)QO9qQ!0LrO7+)QO9gQ`O7+)QO@oQ`O7+)QOOQ[7+(p7+(pO%9nQ!0MvO7+(mO!&oQMhO7+(mO!DrQ`O7+(nOOQ[7+(n7+(nO!&oQMhO7+(nO%9xQ`O'#KaO%:TQ`O,5=lOOQO,5?h,5?hOOQO-E<z-E<zOOQ[7+(s7+(sO%;gQpO'#HZOOQ[1G3`1G3`O!&oQMhO1G3`O%[QlO1G3`O%;nQ`O1G3`O%;yQMhO1G3`O9qQ!0LrO1G3bO$$VQ`O1G3bO9[Q`O1G3bO!BqQpO1G3bO!ByQMhO1G3bO%<XQ`O'#JOO%<mQ`O,5@|O%<uQpO,5@|OOQ!0Lb1G3c1G3cOOQ[7+$V7+$VO@oQ`O7+$VO9qQ!0LrO7+$VO%=QQ`O7+$VO%[QlO1G6kO%[QlO1G6lO%=VQ!0LrO1G6kO%=aQlO1G3jO%=hQ`O1G3jO%=mQlO1G3jOOQ[7+)S7+)SO9qQ!0LrO7+)^O`QlO7+)`OOQ['#Kg'#KgOOQ['#JR'#JRO%=tQlO,5>_OOQ[,5>_,5>_O%[QlO'#HtO%>RQ`O'#HvOOQ[,5>e,5>eO9aQ`O,5>eOOQ[,5>g,5>gOOQ[7+)i7+)iOOQ[7+)o7+)oOOQ[7+)s7+)sOOQ[7+)u7+)uO%>WQpO1G5{O%>rQ?MtO1G0zO%>|Q`O1G0zOOQO1G/s1G/sO%?XQ?MtO1G/sO>}Q`O1G/sO!)PQlO'#DmOOQO,5?O,5?OOOQO-E<b-E<bOOQO,5?U,5?UOOQO-E<h-E<hO!BqQpO1G/sOOQO-E<d-E<dOOQ!0Ln1G0]1G0]OOQ!0Lf7+%u7+%uO#'oQ`O7+%uOOQ!0Lf7+&`7+&`O>}Q`O7+&`O!BqQpO7+&`OOQO7+%x7+%xO$@_Q!0MxO7+&XOOQO7+&X7+&XO%[QlO7+&XO%?cQ!0LrO7+&XO!BfQ!0LrO7+%xO!BqQpO7+%xO%?nQ!0LrO7+&XO%?|Q!0MxO7++qO%[QlO7++qO%@^Q`O7++pO%@^Q`O7++pOOQO1G4r1G4rO9aQ`O1G4rO%@fQ`O1G4rOOQS7+%}7+%}O#'oQ`O<<LPO4UQ!fO<<LPO%@tQ`O<<LPOOQ[<<LP<<LPO!&oQMhO<<LPO%[QlO<<LPO%@|Q`O<<LPO%AXQ!0MzO,5?`O%CdQ!0MzO,5?bO%EoQ!0MzO1G2`O%HQQ!0MzO1G2sO%J]Q!0MzO1G2uO%LhQ!fO,5?PO%[QlO,5?POOQO-E<c-E<cO%LrQ`O1G5|OOQ!0Lf<<JU<<JUO%LzQ?MtO1G0uO& RQ?MtO1G1PO& YQ?MtO1G1PO&#ZQ?MtO1G1PO&#bQ?MtO1G1PO&%cQ?MtO1G1PO&'dQ?MtO1G1PO&'kQ?MtO1G1PO&'rQ?MtO1G1PO&)sQ?MtO1G1PO&)zQ?MtO1G1PO&*RQ!0MxO<<JfO&+yQ?MtO1G1PO&,vQ?MvO1G1PO&-yQ?MvO'#JkO&0PQ?MtO1G1cO&0^Q?MtO1G0UO&0hQMjO,5?SOOQO-E<f-E<fO!)PQlO'#FqOOQO'#KY'#KYOOQO1G1u1G1uO&0rQ`O1G1tO&0wQ?MtO,5?ZOOOW7+'h7+'hOOOO1G/Z1G/ZO&1RQ!dO1G4wOOQ!0Lh7+(Q7+(QP!&oQMhO,5?]O!+xQMhO7+(cO&1YQ`O,5?[O9aQ`O,5?[OOQO-E<n-E<nO&1hQ`O1G6aO&1hQ`O1G6aO&1pQ`O1G6aO&1{QMjO7+'zO&2]Q!dO,5?^O&2gQ`O,5?^O!&oQMhO,5?^OOQO-E<p-E<pO&2lQ!dO1G6bO&2vQ`O1G6bO&3OQ`O1G2kO!&oQMhO1G2kOOQ!0Lb1G2i1G2iOOQ!0Lb1G2j1G2jO%3TQpO1G2iO!BqQpO1G2iOClQ`O1G2iOOQ!0Lb1G2q1G2qO&3TQpO1G2iO&3cQ`O1G2kO$){Q`O1G2jOClQ`O1G2jO$#jQlO1G2kO&3kQ`O1G2jO&4_QMjO,5?`OOQ!0Lh-E<s-E<sO&5QQMjO,5?bOOQ!0Lh-E<u-E<uO!+xQMhO7++[OOQ!0Lh1G/c1G/cO&5[Q`O1G/cOOQ!0Lh7+'u7+'uO&5aQMjO7+'|O&5qQMjO7++[O&5{QMjO7++[O&6YQ!0MxO<<KXOOQ!0Lf<<KX<<KXO&6|Q`O1G0zO!&oQMhO'#IyO&7RQ`O,5@wO&9TQ!fO<<LPO!&oQMhO1G2nO&9[Q!0LrO1G2nOOQ[<<G{<<G{O!BfQ!0LrO<<G{O&9mQ!0MxO<<I{OOQ!0Lf<<I{<<I{OOQO,5?k,5?kO&:aQ`O,5?kO&:fQ`O,5?kOOQO-E<}-E<}O&:tQ`O1G6jO&:tQ`O1G6jO9gQ`O1G6jO@oQ`O<<LlOOQ[<<Ll<<LlO&:|Q`O<<LlO9qQ!0LrO<<LlOOQ[<<LX<<LXO%9nQ!0MvO<<LXOOQ[<<LY<<LYO!DrQ`O<<LYO&;RQpO'#I{O&;^Q`O,5@{O!)PQlO,5@{OOQ[1G3W1G3WOOQO'#I}'#I}O9qQ!0LrO'#I}O&;fQpO,5=uOOQ[,5=u,5=uO&;mQpO'#EgO&;tQpO'#GeO&;yQ`O7+(zO&<OQ`O7+(zOOQ[7+(z7+(zO!&oQMhO7+(zO%[QlO7+(zO&<WQ`O7+(zOOQ[7+(|7+(|O9qQ!0LrO7+(|O$$VQ`O7+(|O9[Q`O7+(|O!BqQpO7+(|O&<cQ`O,5?jOOQO-E<|-E<|OOQO'#H^'#H^O&<nQ`O1G6hO9qQ!0LrO<<GqOOQ[<<Gq<<GqO@oQ`O<<GqO&<vQ`O7+,VO&<{Q`O7+,WO%[QlO7+,VO%[QlO7+,WOOQ[7+)U7+)UO&=QQ`O7+)UO&=VQlO7+)UO&=^Q`O7+)UOOQ[<<Lx<<LxOOQ[<<Lz<<LzOOQ[-E=P-E=POOQ[1G3y1G3yO&=cQ`O,5>`OOQ[,5>b,5>bO&=hQ`O1G4PO9aQ`O7+&fO!)PQlO7+&fOOQO7+%_7+%_O&=mQ?MtO1G6YO>}Q`O7+%_OOQ!0Lf<<Ia<<IaOOQ!0Lf<<Iz<<IzO>}Q`O<<IzOOQO<<Is<<IsO$@_Q!0MxO<<IsO%[QlO<<IsOOQO<<Id<<IdO!BfQ!0LrO<<IdO&=wQ!0LrO<<IsO&>SQ!0MxO<= ]O&>dQ`O<= [OOQO7+*^7+*^O9aQ`O7+*^OOQ[ANAkANAkO&>lQ!fOANAkO!&oQMhOANAkO#'oQ`OANAkO4UQ!fOANAkO&>sQ`OANAkO%[QlOANAkO&>{Q!0MzO7+'zO&A^Q!0MzO,5?`O&CiQ!0MzO,5?bO&EtQ!0MzO7+'|O&HVQ!fO1G4kO&HaQ?MtO7+&aO&JeQ?MvO,5=XO&LlQ?MvO,5=ZO&L|Q?MvO,5=XO&M^Q?MvO,5=ZO&MnQ?MvO,59uO' tQ?MvO,5<kO'#wQ?MvO,5<mO'&]Q?MvO,5<{O'(RQ?MtO7+'kO'(`Q?MtO7+'mO'(mQ`O,5<]OOQO7+'`7+'`OOQ!0Lh7+*c7+*cO'(rQMjO<<K}OOQO1G4v1G4vO'(yQ`O1G4vO')UQ`O1G4vO')dQ`O7++{O')dQ`O7++{O!&oQMhO1G4xO')lQ!dO1G4xO')vQ`O7++|O'*OQ`O7+(VO'*ZQ!dO7+(VOOQ!0Lb7+(T7+(TOOQ!0Lb7+(U7+(UO!BqQpO7+(TOClQ`O7+(TO'*eQ`O7+(VO!&oQMhO7+(VO$){Q`O7+(UO'*jQ`O7+(VOClQ`O7+(UO'*rQMjO<<NvOOQ!0Lh7+$}7+$}O!+xQMhO<<NvO'*|Q!dO,5?eOOQO-E<w-E<wO'+WQ!0MvO7+(YO!&oQMhO7+(YOOQ[AN=gAN=gO9gQ`O1G5VOOQO1G5V1G5VO'+hQ`O1G5VO'+mQ`O7+,UO'+mQ`O7+,UO9qQ!0LrOANBWO@oQ`OANBWOOQ[ANBWANBWOOQ[ANAsANAsOOQ[ANAtANAtO'+uQ`O,5?gOOQO-E<y-E<yO',QQ?MtO1G6gOOQO,5?i,5?iOOQO-E<{-E<{OOQ[1G3a1G3aO',[Q`O,5=POOQ[<<Lf<<LfO!&oQMhO<<LfO&;yQ`O<<LfO',aQ`O<<LfO%[QlO<<LfOOQ[<<Lh<<LhO9qQ!0LrO<<LhO$$VQ`O<<LhO9[Q`O<<LhO',iQpO1G5UO',tQ`O7+,SOOQ[AN=]AN=]O9qQ!0LrOAN=]OOQ[<= q<= qOOQ[<= r<= rO',|Q`O<= qO'-RQ`O<= rOOQ[<<Lp<<LpO'-WQ`O<<LpO'-]QlO<<LpOOQ[1G3z1G3zO>}Q`O7+)kO'-dQ`O<<JQO'-oQ?MtO<<JQOOQO<<Hy<<HyOOQ!0LfAN?fAN?fOOQOAN?_AN?_O$@_Q!0MxOAN?_OOQOAN?OAN?OO%[QlOAN?_OOQO<<Mx<<MxOOQ[G27VG27VO!&oQMhOG27VO#'oQ`OG27VO'-yQ!fOG27VO4UQ!fOG27VO'.QQ`OG27VO'.YQ?MtO<<JfO'.gQ?MvO1G2`O'0]Q?MvO,5?`O'2`Q?MvO,5?bO'4cQ?MvO1G2sO'6fQ?MvO1G2uO'8iQ?MtO<<KXO'8vQ?MtO<<I{OOQO1G1w1G1wO!+xQMhOANAiOOQO7+*b7+*bO'9TQ`O7+*bO'9`Q`O<= gO'9hQ!dO7+*dOOQ!0Lb<<Kq<<KqO$){Q`O<<KqOClQ`O<<KqO'9rQ`O<<KqO!&oQMhO<<KqOOQ!0Lb<<Ko<<KoO!BqQpO<<KoO'9}Q!dO<<KqOOQ!0Lb<<Kp<<KpO':XQ`O<<KqO!&oQMhO<<KqO$){Q`O<<KpO':^QMjOANDbO':hQ!0MvO<<KtOOQO7+*q7+*qO9gQ`O7+*qO':xQ`O<= pOOQ[G27rG27rO9qQ!0LrOG27rO!)PQlO1G5RO';QQ`O7+,RO';YQ`O1G2kO&;yQ`OANBQOOQ[ANBQANBQO!&oQMhOANBQO';_Q`OANBQOOQ[ANBSANBSO9qQ!0LrOANBSO$$VQ`OANBSOOQO'#H_'#H_OOQO7+*p7+*pOOQ[G22wG22wOOQ[ANE]ANE]OOQ[ANE^ANE^OOQ[ANB[ANB[O';gQ`OANB[OOQ[<<MV<<MVO!)PQlOAN?lOOQOG24yG24yO$@_Q!0MxOG24yO#'oQ`OLD,qOOQ[LD,qLD,qO!&oQMhOLD,qO';lQ!fOLD,qO';sQ?MvO7+'zO'=iQ?MvO,5?`O'?lQ?MvO,5?bO'AoQ?MvO7+'|O'CeQMjOG27TOOQO<<M|<<M|OOQ!0LbANA]ANA]O$){Q`OANA]OClQ`OANA]O'CuQ!dOANA]OOQ!0LbANAZANAZO'C|Q`OANA]O!&oQMhOANA]O'DXQ!dOANA]OOQ!0LbANA[ANA[OOQO<<N]<<N]OOQ[LD-^LD-^O'DcQ?MtO7+*mOOQO'#Gf'#GfOOQ[G27lG27lO&;yQ`OG27lO!&oQMhOG27lOOQ[G27nG27nO9qQ!0LrOG27nOOQ[G27vG27vO'DmQ?MtOG25WOOQOLD*eLD*eOOQ[!$(!]!$(!]O#'oQ`O!$(!]O!&oQMhO!$(!]O'DwQ!0MzOG27TOOQ!0LbG26wG26wO$){Q`OG26wO'GYQ`OG26wOClQ`OG26wO'GeQ!dOG26wO!&oQMhOG26wOOQ[LD-WLD-WO&;yQ`OLD-WOOQ[LD-YLD-YOOQ[!)9Ew!)9EwO#'oQ`O!)9EwOOQ!0LbLD,cLD,cO$){Q`OLD,cOClQ`OLD,cO'GlQ`OLD,cO'GwQ!dOLD,cOOQ[!$(!r!$(!rOOQ[!.K;c!.K;cO'HOQ?MvOG27TOOQ!0Lb!$( }!$( }O$){Q`O!$( }OClQ`O!$( }O'ItQ`O!$( }OOQ!0Lb!)9Ei!)9EiO$){Q`O!)9EiOClQ`O!)9EiOOQ!0Lb!.K;T!.K;TO$){Q`O!.K;TOOQ!0Lb!4/0o!4/0oO!)PQlO'#DzO1PQ`O'#EXO'JPQ!fO'#JqO'JWQ!L^O'#DvO'J_QlO'#EOO'JfQ!fO'#CiO'L|Q!fO'#CiO!)PQlO'#EQO'M^QlO,5;ZO!)PQlO,5;eO!)PQlO,5;eO!)PQlO,5;eO!)PQlO,5;eO!)PQlO,5;eO!)PQlO,5;eO!)PQlO,5;eO!)PQlO,5;eO!)PQlO,5;eO!)PQlO,5;eO!)PQlO'#IoO( aQ`O,5<iO!)PQlO,5;eO( iQMhO,5;eO(#SQMhO,5;eO!)PQlO,5;wO!&oQMhO'#GmO( iQMhO'#GmO!&oQMhO'#GoO( iQMhO'#GoO1SQ`O'#DZO1SQ`O'#DZO!&oQMhO'#GPO( iQMhO'#GPO!&oQMhO'#GRO( iQMhO'#GRO!&oQMhO'#GaO( iQMhO'#GaO!)PQlO,5:jO(#ZQpO'#D_O(#eQpO'#JuO!)PQlO,5@nO'M^QlO1G0uO(#oQ?MtO'#CiO!)PQlO1G2PO!&oQMhO'#ItO( iQMhO'#ItO!&oQMhO'#IvO( iQMhO'#IvO(#yQ!dO'#CrO!&oQMhO,5<tO( iQMhO,5<tO'M^QlO1G2RO!)PQlO7+&zO!&oQMhO1G2`O( iQMhO1G2`O!&oQMhO'#ItO( iQMhO'#ItO!&oQMhO'#IvO( iQMhO'#IvO!&oQMhO1G2bO( iQMhO1G2bO'M^QlO7+'mO'M^QlO7+&aO!&oQMhOANAiO( iQMhOANAiO($^Q`O'#EoO($cQ`O'#EoO($kQ`O'#F]O($pQ`O'#EyO($uQ`O'#KSO(%QQ`O'#KQO(%]Q`O,5;ZO(%bQMjO,5<eO(%iQ`O'#GYO(%nQ`O'#GYO(%sQ`O,5<gO(%{Q`O,5;ZO(&TQ?MtO1G1`O(&[Q`O,5<tO(&aQ`O,5<tO(&fQ`O,5<vO(&kQ`O,5<vO(&pQ`O1G2RO(&uQ`O1G0uO(&zQMjO<<K}O('RQMjO<<K}O7eQMhO'#F|O9[Q`O'#F{OAjQ`O'#EnO!)PQlO,5;tO!3dQ`O'#GYO!3dQ`O'#GYO!3dQ`O'#G[O!3dQ`O'#G[O!+xQMhO7+(cO!+xQMhO7+(cO%-mQ!dO1G2wO%-mQ!dO1G2wO!&oQMhO,5=]O!&oQMhO,5=]",stateData:"((X~O'{OS'|OSTOS'}RQ~OPYOQYOSfOY!VOaqOdzOeyOl!POpkOrYOskOtkOzkO|YO!OYO!SWO!WkO!XkO!_XO!iuO!lZO!oYO!pYO!qYO!svO!uwO!xxO!|]O$W|O$niO%h}O%j!QO%l!OO%m!OO%n!OO%q!RO%s!SO%v!TO%w!TO%y!UO&V!WO&]!XO&_!YO&a!ZO&c![O&f!]O&l!^O&r!_O&t!`O&v!aO&x!bO&z!cO(SSO(UTO(XUO(`VO(n[O~OWtO~P`OPYOQYOSfOd!jOe!iOpkOrYOskOtkOzkO|YO!OYO!SWO!WkO!XkO!_!eO!iuO!lZO!oYO!pYO!qYO!svO!u!gO!x!hO$W!kO$niO(S!dO(UTO(XUO(`VO(n[O~Oa!wOs!nO!S!oO!b!yO!c!vO!d!vO!|;wO#T!pO#U!pO#V!xO#W!pO#X!pO#[!zO#]!zO(T!lO(UTO(XUO(d!mO(n!sO~O'}!{O~OP]XR]X[]Xa]Xj]Xr]X!Q]X!S]X!]]X!l]X!p]X#R]X#S]X#`]X#kfX#n]X#o]X#p]X#q]X#r]X#s]X#t]X#u]X#v]X#x]X#z]X#{]X$Q]X'y]X(`]X(q]X(x]X(y]X~O!g%RX~P(qO_!}O(U#PO(V!}O(W#PO~O_#QO(W#PO(X#PO(Y#QO~Ox#SO!U#TO(a#TO(b#VO~OPYOQYOSfOd!jOe!iOpkOrYOskOtkOzkO|YO!OYO!SWO!WkO!XkO!_!eO!iuO!lZO!oYO!pYO!qYO!svO!u!gO!x!hO$W!kO$niO(S;{O(UTO(XUO(`VO(n[O~O![#ZO!]#WO!Y(gP!Y(uP~P+}O!^#cO~P`OPYOQYOSfOd!jOe!iOrYOskOtkOzkO|YO!OYO!SWO!WkO!XkO!_!eO!iuO!lZO!oYO!pYO!qYO!svO!u!gO!x!hO$W!kO$niO(UTO(XUO(`VO(n[O~Op#mO![#iO!|]O#i#lO#j#iO(S;|O!k(rP~P.iO!l#oO(S#nO~O!x#sO!|]O%h#tO~O#k#uO~O!g#vO#k#uO~OP$[OR#zO[$cOj$ROr$aO!Q#yO!S#{O!]$_O!l#xO!p$[O#R$RO#n$OO#o$PO#p$PO#q$PO#r$QO#s$RO#t$RO#u$bO#v$SO#x$UO#z$WO#{$XO(`VO(q$YO(x#|O(y#}O~Oa(eX'y(eX'v(eX!k(eX!Y(eX!_(eX%i(eX!g(eX~P1qO#S$dO#`$eO$Q$eOP(fXR(fX[(fXj(fXr(fX!Q(fX!S(fX!](fX!l(fX!p(fX#R(fX#n(fX#o(fX#p(fX#q(fX#r(fX#s(fX#t(fX#u(fX#v(fX#x(fX#z(fX#{(fX(`(fX(q(fX(x(fX(y(fX!_(fX%i(fX~Oa(fX'y(fX'v(fX!Y(fX!k(fXv(fX!g(fX~P4UO#`$eO~O$]$hO$_$gO$f$mO~OSfO!_$nO$i$oO$k$qO~Oh%VOj%cOk%cOl%cOp%WOr%XOs$tOt$tOz%YO|%ZO!O%[O!S${O!_$|O!i%aO!l$xO#j%bO$W%_O$t%]O$v%^O$y%`O(S$sO(UTO(XUO(`$uO(x$}O(y%POg(]P~O!l%dO~O!S%gO!_%hO(S%fO~O!g%lO~Oa%mO'y%mO~O!Q%qO~P%[O(T!lO~P%[O%n%uO~P%[Oh%VO!l%dO(S%fO(T!lO~Oe%|O!l%dO(S%fO~Oj$RO~O!Q&RO!_&OO!l&QO%j&UO(S%fO(T!lO(UTO(XUO`)VP~O!x#sO~O%s&WO!S)RX!_)RX(S)RX~O(S&XO~Ol!PO!u&^O%j!QO%l!OO%m!OO%n!OO%q!RO%s!SO%v!TO%w!TO~Od&cOe&bO!x&`O%h&aO%{&_O~P<VOd&fOeyOl!PO!_&eO!u&^O!xxO!|]O%h}O%l!OO%m!OO%n!OO%q!RO%s!SO%v!TO%w!TO%y!UO~Ob&iO#`&lO%j&gO(T!lO~P=[O!l&mO!u&qO~O!l#oO~O!_XO~Oa%mO'w&yO'y%mO~Oa%mO'w&|O'y%mO~Oa%mO'w'OO'y%mO~O'v]X!Y]Xv]X!k]X&Z]X!_]X%i]X!g]X~P(qO!b']O!c'UO!d'UO(T!lO(UTO(XUO~Os'SO!S'RO!['VO(d'QO!^(hP!^(wP~P@cOn'`O!_'^O(S%fO~Oe'eO!l%dO(S%fO~O!Q&RO!l&QO~Os!nO!S!oO!|;wO#T!pO#U!pO#W!pO#X!pO(T!lO(UTO(XUO(d!mO(n!sO~O!b'kO!c'jO!d'jO#V!pO#['lO#]'lO~PA}Oa%mOh%VO!g#vO!l%dO'y%mO(q'nO~O!p'rO#`'pO~PC]Os!nO!S!oO(UTO(XUO(d!mO(n!sO~O!_XOs(lX!S(lX!b(lX!c(lX!d(lX!|(lX#T(lX#U(lX#V(lX#W(lX#X(lX#[(lX#](lX(T(lX(U(lX(X(lX(d(lX(n(lX~O!c'jO!d'jO(T!lO~PC{O(O'vO(P'vO(Q'xO~O_!}O(U'zO(V!}O(W'zO~O_#QO(W'zO(X'zO(Y#QO~Ov'|O~P%[Ox#SO!U#TO(a#TO(b(PO~O![(RO!Y'VX!Y']X!]'VX!]']X~P+}O!](TO!Y(gX~OP$[OR#zO[$cOj$ROr$aO!Q#yO!S#{O!](TO!l#xO!p$[O#R$RO#n$OO#o$PO#p$PO#q$PO#r$QO#s$RO#t$RO#u$bO#v$SO#x$UO#z$WO#{$XO(`VO(q$YO(x#|O(y#}O~O!Y(gX~PGvO!Y(YO~O!Y(tX!](tX!g(tX!k(tX(q(tX~O#`(tX#k#dX!^(tX~PIyO#`(ZO!Y(vX!](vX~O!]([O!Y(uX~O!Y(_O~O#`$eO~PIyO!^(`O~P`OR#zO!Q#yO!S#{O!l#xO(`VOP!na[!naj!nar!na!]!na!p!na#R!na#n!na#o!na#p!na#q!na#r!na#s!na#t!na#u!na#v!na#x!na#z!na#{!na(q!na(x!na(y!na~Oa!na'y!na'v!na!Y!na!k!nav!na!_!na%i!na!g!na~PKaO!k(aO~O!g#vO#`(bO(q'nO!](sXa(sX'y(sX~O!k(sX~PM|O!S%gO!_%hO!|]O#i(gO#j(fO(S%fO~O!](hO!k(rX~O!k(jO~O!S%gO!_%hO#j(fO(S%fO~OP(fXR(fX[(fXj(fXr(fX!Q(fX!S(fX!](fX!l(fX!p(fX#R(fX#n(fX#o(fX#p(fX#q(fX#r(fX#s(fX#t(fX#u(fX#v(fX#x(fX#z(fX#{(fX(`(fX(q(fX(x(fX(y(fX~O!g#vO!k(fX~P! jOR(lO!Q(kO!l#xO#S$dO!|!{a!S!{a~O!x!{a%h!{a!_!{a#i!{a#j!{a(S!{a~P!#kO!x(pO~OPYOQYOSfOd!jOe!iOpkOrYOskOtkOzkO|YO!OYO!SWO!WkO!XkO!_XO!iuO!lZO!oYO!pYO!qYO!svO!u!gO!x!hO$W!kO$niO(S!dO(UTO(XUO(`VO(n[O~Oh%VOp%WOr%XOs$tOt$tOz%YO|%ZO!O<eO!S${O!_$|O!i=vO!l$xO#j<kO$W%_O$t<gO$v<iO$y%`O(S(tO(UTO(XUO(`$uO(x$}O(y%PO~O#k(vO~O![(xO!k(jP~P%[O(d(zO(n[O~O!S(|O!l#xO(d(zO(n[O~OP;vOQ;vOSfOd=rOe!iOpkOr;vOskOtkOzkO|;vO!O;vO!SWO!WkO!XkO!_!eO!i;yO!lZO!o;vO!p;vO!q;vO!s;zO!u;}O!x!hO$W!kO$n=pO(S)ZO(UTO(XUO(`VO(n[O~O!]$_Oa$qa'y$qa'v$qa!k$qa!Y$qa!_$qa%i$qa!g$qa~Ol)bO~P!&oOh%VOp%WOr%XOs$tOt$tOz%YO|%ZO!O%[O!S${O!_$|O!i%aO!l$xO#j%bO$W%_O$t%]O$v%^O$y%`O(S(tO(UTO(XUO(`$uO(x$}O(y%PO~Og(oP~P!+xO!Q)gO!g)fO!_$^X$Z$^X$]$^X$_$^X$f$^X~O!g)fO!_(zX$Z(zX$](zX$_(zX$f(zX~O!Q)gO~P!.RO!Q)gO!_(zX$Z(zX$](zX$_(zX$f(zX~O!_)iO$Z)mO$])hO$_)hO$f)nO~O![)qO~P!)PO$]$hO$_$gO$f)uO~On$zX!Q$zX#S$zX'x$zX(x$zX(y$zX~OgmXg$zXnmX!]mX#`mX~P!/wOx)wO(a)xO(b)zO~On*TO!Q)|O'x)}O(x$}O(y%PO~Og){O~P!0{Og*UO~Oh%VOp%WOr%XOs$tOt$tOz%YO|%ZO!O<eO!S*WO!_*XO!i=vO!l$xO#j<kO$W%_O$t<gO$v<iO$y%`O(UTO(XUO(`$uO(x$}O(y%PO~O![*[O(S*VO!k(}P~P!1jO#k*^O~O!l*_O~Oh%VOp%WOr%XOs$tOt$tOz%YO|%ZO!O<eO!S${O!_$|O!i=vO!l$xO#j<kO$W%_O$t<gO$v<iO$y%`O(S*aO(UTO(XUO(`$uO(x$}O(y%PO~O![*dO!Y)OP~P!3iOr*pOs!nO!S*fO!b*nO!c*hO!d*hO!l*_O#[*oO%`*jO(T!lO(UTO(XUO(d!mO~O!^*mO~P!5^O#S$dOn(_X!Q(_X'x(_X(x(_X(y(_X!](_X#`(_X~Og(_X$O(_X~P!6`On*uO#`*tOg(^X!](^X~O!]*vOg(]X~Oj%cOk%cOl%cO(S&XOg(]P~Os*yO~O!l+OO~O(S(tO~Op+TO!S%gO![#iO!_%hO!|]O#i#lO#j#iO(S%fO!k(rP~O!g#vO#k+UO~O!S%gO![+WO!]([O!_%hO(S%fO!Y(uP~Os'YO!S+YO![+XO(UTO(XUO(d(zO~O!^(wP~P!9iO!]+ZOa)SX'y)SX~OP$[OR#zO[$cOj$ROr$aO!Q#yO!S#{O!l#xO!p$[O#R$RO#n$OO#o$PO#p$PO#q$PO#r$QO#s$RO#t$RO#u$bO#v$SO#x$UO#z$WO#{$XO(`VO(q$YO(x#|O(y#}O~Oa!ja!]!ja'y!ja'v!ja!Y!ja!k!jav!ja!_!ja%i!ja!g!ja~P!:aOR#zO!Q#yO!S#{O!l#xO(`VOP!ra[!raj!rar!ra!]!ra!p!ra#R!ra#n!ra#o!ra#p!ra#q!ra#r!ra#s!ra#t!ra#u!ra#v!ra#x!ra#z!ra#{!ra(q!ra(x!ra(y!ra~Oa!ra'y!ra'v!ra!Y!ra!k!rav!ra!_!ra%i!ra!g!ra~P!<wOR#zO!Q#yO!S#{O!l#xO(`VOP!ta[!taj!tar!ta!]!ta!p!ta#R!ta#n!ta#o!ta#p!ta#q!ta#r!ta#s!ta#t!ta#u!ta#v!ta#x!ta#z!ta#{!ta(q!ta(x!ta(y!ta~Oa!ta'y!ta'v!ta!Y!ta!k!tav!ta!_!ta%i!ta!g!ta~P!?_Oh%VOn+dO!_'^O%i+cO~O!g+fOa([X!_([X'y([X!]([X~Oa%mO!_XO'y%mO~Oh%VO!l%dO~Oh%VO!l%dO(S%fO~O!g#vO#k(vO~Ob+qO%j+rO(S+nO(UTO(XUO!^)WP~O!]+sO`)VX~O[+wO~O`+xO~O!_&OO(S%fO(T!lO`)VP~Oh%VO#`+}O~Oh%VOn,QO!_$|O~O!_,SO~O!Q,UO!_XO~O%n%uO~O!x,ZO~Oe,`O~Ob,aO(S#nO(UTO(XUO!^)UP~Oe%|O~O%j!QO(S&XO~P=[O[,fO`,eO~OPYOQYOSfOdzOeyOpkOrYOskOtkOzkO|YO!OYO!SWO!WkO!XkO!iuO!lZO!oYO!pYO!qYO!svO!xxO!|]O$niO%h}O(UTO(XUO(`VO(n[O~O!_!eO!u!gO$W!kO(S!dO~P!F_O`,eOa%mO'y%mO~OPYOQYOSfOd!jOe!iOpkOrYOskOtkOzkO|YO!OYO!SWO!WkO!XkO!_!eO!iuO!lZO!oYO!pYO!qYO!svO!x!hO$W!kO$niO(S!dO(UTO(XUO(`VO(n[O~Oa,kOl!OO!uwO%l!OO%m!OO%n!OO~P!HwO!l&mO~O&],qO~O!_,sO~O&n,uO&p,vOP&kaQ&kaS&kaY&kaa&kad&kae&kal&kap&kar&kas&kat&kaz&ka|&ka!O&ka!S&ka!W&ka!X&ka!_&ka!i&ka!l&ka!o&ka!p&ka!q&ka!s&ka!u&ka!x&ka!|&ka$W&ka$n&ka%h&ka%j&ka%l&ka%m&ka%n&ka%q&ka%s&ka%v&ka%w&ka%y&ka&V&ka&]&ka&_&ka&a&ka&c&ka&f&ka&l&ka&r&ka&t&ka&v&ka&x&ka&z&ka'v&ka(S&ka(U&ka(X&ka(`&ka(n&ka!^&ka&d&kab&ka&i&ka~O(S,{O~Oh!eX!]!RX!^!RX!g!RX!g!eX!l!eX#`!RX~O!]!eX!^!eX~P# }O!g-QO#`-POh(iX!]#hX!^#hX!g(iX!l(iX~O!](iX!^(iX~P#!pOh%VO!g-SO!l%dO!]!aX!^!aX~Os!nO!S!oO(UTO(XUO(d!mO~OP;vOQ;vOSfOd=rOe!iOpkOr;vOskOtkOzkO|;vO!O;vO!SWO!WkO!XkO!_!eO!i;yO!lZO!o;vO!p;vO!q;vO!s;zO!u;}O!x!hO$W!kO$n=pO(UTO(XUO(`VO(n[O~O(S<rO~P#$VO!]-WO!^(hX~O!^-YO~O!g-QO#`-PO!]#hX!^#hX~O!]-ZO!^(wX~O!^-]O~O!c-^O!d-^O(T!lO~P##tO!^-aO~P'_On-dO!_'^O~O!Y-iO~Os!{a!b!{a!c!{a!d!{a#T!{a#U!{a#V!{a#W!{a#X!{a#[!{a#]!{a(T!{a(U!{a(X!{a(d!{a(n!{a~P!#kO!p-nO#`-lO~PC]O!c-pO!d-pO(T!lO~PC{Oa%mO#`-lO'y%mO~Oa%mO!g#vO#`-lO'y%mO~Oa%mO!g#vO!p-nO#`-lO'y%mO(q'nO~O(O'vO(P'vO(Q-uO~Ov-vO~O!Y'Va!]'Va~P!:aO![-zO!Y'VX!]'VX~P%[O!](TO!Y(ga~O!Y(ga~PGvO!]([O!Y(ua~O!S%gO![.OO!_%hO(S%fO!Y']X!]']X~O#`.QO!](sa!k(saa(sa'y(sa~O!g#vO~P#,]O!](hO!k(ra~O!S%gO!_%hO#j.UO(S%fO~Op.ZO!S%gO![.WO!_%hO!|]O#i.YO#j.WO(S%fO!]'`X!k'`X~OR._O!l#xO~Oh%VOn.bO!_'^O%i.aO~Oa#ci!]#ci'y#ci'v#ci!Y#ci!k#civ#ci!_#ci%i#ci!g#ci~P!:aOn=|O!Q)|O'x)}O(x$}O(y%PO~O#k#_aa#_a#`#_a'y#_a!]#_a!k#_a!_#_a!Y#_a~P#/XO#k(_XP(_XR(_X[(_Xa(_Xj(_Xr(_X!S(_X!l(_X!p(_X#R(_X#n(_X#o(_X#p(_X#q(_X#r(_X#s(_X#t(_X#u(_X#v(_X#x(_X#z(_X#{(_X'y(_X(`(_X(q(_X!k(_X!Y(_X'v(_Xv(_X!_(_X%i(_X!g(_X~P!6`O!].oO!k(jX~P!:aO!k.rO~O!Y.tO~OP$[OR#zO!Q#yO!S#{O!l#xO!p$[O(`VO[#mia#mij#mir#mi!]#mi#R#mi#o#mi#p#mi#q#mi#r#mi#s#mi#t#mi#u#mi#v#mi#x#mi#z#mi#{#mi'y#mi(q#mi(x#mi(y#mi'v#mi!Y#mi!k#miv#mi!_#mi%i#mi!g#mi~O#n#mi~P#2wO#n$OO~P#2wOP$[OR#zOr$aO!Q#yO!S#{O!l#xO!p$[O#n$OO#o$PO#p$PO#q$PO(`VO[#mia#mij#mi!]#mi#R#mi#s#mi#t#mi#u#mi#v#mi#x#mi#z#mi#{#mi'y#mi(q#mi(x#mi(y#mi'v#mi!Y#mi!k#miv#mi!_#mi%i#mi!g#mi~O#r#mi~P#5fO#r$QO~P#5fOP$[OR#zO[$cOj$ROr$aO!Q#yO!S#{O!l#xO!p$[O#R$RO#n$OO#o$PO#p$PO#q$PO#r$QO#s$RO#t$RO#u$bO(`VOa#mi!]#mi#x#mi#z#mi#{#mi'y#mi(q#mi(x#mi(y#mi'v#mi!Y#mi!k#miv#mi!_#mi%i#mi!g#mi~O#v#mi~P#8TOP$[OR#zO[$cOj$ROr$aO!Q#yO!S#{O!l#xO!p$[O#R$RO#n$OO#o$PO#p$PO#q$PO#r$QO#s$RO#t$RO#u$bO#v$SO(`VO(y#}Oa#mi!]#mi#z#mi#{#mi'y#mi(q#mi(x#mi'v#mi!Y#mi!k#miv#mi!_#mi%i#mi!g#mi~O#x$UO~P#:kO#x#mi~P#:kO#v$SO~P#8TOP$[OR#zO[$cOj$ROr$aO!Q#yO!S#{O!l#xO!p$[O#R$RO#n$OO#o$PO#p$PO#q$PO#r$QO#s$RO#t$RO#u$bO#v$SO#x$UO(`VO(x#|O(y#}Oa#mi!]#mi#{#mi'y#mi(q#mi'v#mi!Y#mi!k#miv#mi!_#mi%i#mi!g#mi~O#z#mi~P#=aO#z$WO~P#=aOP]XR]X[]Xj]Xr]X!Q]X!S]X!l]X!p]X#R]X#S]X#`]X#kfX#n]X#o]X#p]X#q]X#r]X#s]X#t]X#u]X#v]X#x]X#z]X#{]X$Q]X(`]X(q]X(x]X(y]X!]]X!^]X~O$O]X~P#@OOP$[OR#zO[<_Oj<SOr<]O!Q#yO!S#{O!l#xO!p$[O#R<SO#n<PO#o<QO#p<QO#q<QO#r<RO#s<SO#t<SO#u<^O#v<TO#x<VO#z<XO#{<YO(`VO(q$YO(x#|O(y#}O~O$O.vO~P#B]O#S$dO#`<`O$Q<`O$O(fX!^(fX~P! jOa'ca!]'ca'y'ca'v'ca!k'ca!Y'cav'ca!_'ca%i'ca!g'ca~P!:aO[#mia#mij#mir#mi!]#mi#R#mi#r#mi#s#mi#t#mi#u#mi#v#mi#x#mi#z#mi#{#mi'y#mi(q#mi'v#mi!Y#mi!k#miv#mi!_#mi%i#mi!g#mi~OP$[OR#zO!Q#yO!S#{O!l#xO!p$[O#n$OO#o$PO#p$PO#q$PO(`VO(x#mi(y#mi~P#E_On=|O!Q)|O'x)}O(x$}O(y%POP#miR#mi!S#mi!l#mi!p#mi#n#mi#o#mi#p#mi#q#mi(`#mi~P#E_O!].zOg(oX~P!0{Og.|O~Oa$Pi!]$Pi'y$Pi'v$Pi!Y$Pi!k$Piv$Pi!_$Pi%i$Pi!g$Pi~P!:aO$].}O$_.}O~O$]/OO$_/OO~O!g)fO#`/PO!_$cX$Z$cX$]$cX$_$cX$f$cX~O![/QO~O!_)iO$Z/SO$])hO$_)hO$f/TO~O!]<ZO!^(eX~P#B]O!^/UO~O!g)fO$f(zX~O$f/WO~Ov/XO~P!&oOx)wO(a)xO(b/[O~O!S/_O~O(x$}On%aa!Q%aa'x%aa(y%aa!]%aa#`%aa~Og%aa$O%aa~P#LaO(y%POn%ca!Q%ca'x%ca(x%ca!]%ca#`%ca~Og%ca$O%ca~P#MSO!]fX!gfX!kfX!k$zX(qfX~P!/wO![/hO!]([O(S/gO!Y(uP!Y)OP~P!1jOr*pO!b*nO!c*hO!d*hO!l*_O#[*oO%`*jO(T!lO(UTO(XUO~Os<oO!S/iO![+XO!^*mO(d<nO!^(wP~P#NmO!k/jO~P#/XO!]/kO!g#vO(q'nO!k(}X~O!k/pO~O!S%gO![*[O!_%hO(S%fO!k(}P~O#k/rO~O!Y$zX!]$zX!g%RX~P!/wO!]/sO!Y)OX~P#/XO!g/uO~O!Y/wO~OpkO(S/xO~P.iOh%VOr/}O!g#vO!l%dO(q'nO~O!g+fO~Oa%mO!]0RO'y%mO~O!^0TO~P!5^O!c0UO!d0UO(T!lO~P##tOs!nO!S0VO(UTO(XUO(d!mO~O#[0XO~Og%aa!]%aa#`%aa$O%aa~P!0{Og%ca!]%ca#`%ca$O%ca~P!0{Oj%cOk%cOl%cO(S&XOg'lX!]'lX~O!]*vOg(]a~Og0bO~OR0cO!Q0cO!S0dO#S$dOn}a'x}a(x}a(y}a!]}a#`}a~Og}a$O}a~P$&vO!Q)|O'x)}On$sa(x$sa(y$sa!]$sa#`$sa~Og$sa$O$sa~P$'rO!Q)|O'x)}On$ua(x$ua(y$ua!]$ua#`$ua~Og$ua$O$ua~P$(eO#k0gO~Og%Ta!]%Ta#`%Ta$O%Ta~P!0{On0iO#`0hOg(^a!](^a~O!g#vO~O#k0lO~O!]+ZOa)Sa'y)Sa~OR#zO!Q#yO!S#{O!l#xO(`VOP!ri[!rij!rir!ri!]!ri!p!ri#R!ri#n!ri#o!ri#p!ri#q!ri#r!ri#s!ri#t!ri#u!ri#v!ri#x!ri#z!ri#{!ri(q!ri(x!ri(y!ri~Oa!ri'y!ri'v!ri!Y!ri!k!riv!ri!_!ri%i!ri!g!ri~P$*bOh%VOr%XOs$tOt$tOz%YO|%ZO!O<eO!S${O!_$|O!i=vO!l$xO#j<kO$W%_O$t<gO$v<iO$y%`O(UTO(XUO(`$uO(x$}O(y%PO~Op0uO%]0vO(S0tO~P$,xO!g+fOa([a!_([a'y([a!]([a~O#k0|O~O[]X!]fX!^fX~O!]0}O!^)WX~O!^1PO~O[1QO~Ob1SO(S+nO(UTO(XUO~O!_&OO(S%fO`'tX!]'tX~O!]+sO`)Va~O!k1VO~P!:aO[1YO~O`1ZO~O#`1^O~On1aO!_$|O~O(d(zO!^)TP~Oh%VOn1jO!_1gO%i1iO~O[1tO!]1rO!^)UX~O!^1uO~O`1wOa%mO'y%mO~O(S#nO(UTO(XUO~O#S$dO#`$eO$Q$eOP(fXR(fX[(fXr(fX!Q(fX!S(fX!](fX!l(fX!p(fX#R(fX#n(fX#o(fX#p(fX#q(fX#r(fX#s(fX#t(fX#u(fX#v(fX#x(fX#z(fX#{(fX(`(fX(q(fX(x(fX(y(fX~Oj1zO&Z1{Oa(fX~P$2cOj1zO#`$eO&Z1{O~Oa1}O~P%[Oa2PO~O&d2SOP&biQ&biS&biY&bia&bid&bie&bil&bip&bir&bis&bit&biz&bi|&bi!O&bi!S&bi!W&bi!X&bi!_&bi!i&bi!l&bi!o&bi!p&bi!q&bi!s&bi!u&bi!x&bi!|&bi$W&bi$n&bi%h&bi%j&bi%l&bi%m&bi%n&bi%q&bi%s&bi%v&bi%w&bi%y&bi&V&bi&]&bi&_&bi&a&bi&c&bi&f&bi&l&bi&r&bi&t&bi&v&bi&x&bi&z&bi'v&bi(S&bi(U&bi(X&bi(`&bi(n&bi!^&bib&bi&i&bi~Ob2YO!^2WO&i2XO~P`O!_XO!l2[O~O&p,vOP&kiQ&kiS&kiY&kia&kid&kie&kil&kip&kir&kis&kit&kiz&ki|&ki!O&ki!S&ki!W&ki!X&ki!_&ki!i&ki!l&ki!o&ki!p&ki!q&ki!s&ki!u&ki!x&ki!|&ki$W&ki$n&ki%h&ki%j&ki%l&ki%m&ki%n&ki%q&ki%s&ki%v&ki%w&ki%y&ki&V&ki&]&ki&_&ki&a&ki&c&ki&f&ki&l&ki&r&ki&t&ki&v&ki&x&ki&z&ki'v&ki(S&ki(U&ki(X&ki(`&ki(n&ki!^&ki&d&kib&ki&i&ki~O!Y2bO~O!]!aa!^!aa~P#B]Os!nO!S!oO![2hO(d!mO!]'WX!^'WX~P@cO!]-WO!^(ha~O!]'^X!^'^X~P!9iO!]-ZO!^(wa~O!^2oO~P'_Oa%mO#`2xO'y%mO~Oa%mO!g#vO#`2xO'y%mO~Oa%mO!g#vO!p2|O#`2xO'y%mO(q'nO~Oa%mO'y%mO~P!:aO!]$_Ov$qa~O!Y'Vi!]'Vi~P!:aO!](TO!Y(gi~O!]([O!Y(ui~O!Y(vi!](vi~P!:aO!](si!k(sia(si'y(si~P!:aO#`3OO!](si!k(sia(si'y(si~O!](hO!k(ri~O!S%gO!_%hO!|]O#i3TO#j3SO(S%fO~O!S%gO!_%hO#j3SO(S%fO~On3[O!_'^O%i3ZO~Oh%VOn3[O!_'^O%i3ZO~O#k%aaP%aaR%aa[%aaa%aaj%aar%aa!S%aa!l%aa!p%aa#R%aa#n%aa#o%aa#p%aa#q%aa#r%aa#s%aa#t%aa#u%aa#v%aa#x%aa#z%aa#{%aa'y%aa(`%aa(q%aa!k%aa!Y%aa'v%aav%aa!_%aa%i%aa!g%aa~P#LaO#k%caP%caR%ca[%caa%caj%car%ca!S%ca!l%ca!p%ca#R%ca#n%ca#o%ca#p%ca#q%ca#r%ca#s%ca#t%ca#u%ca#v%ca#x%ca#z%ca#{%ca'y%ca(`%ca(q%ca!k%ca!Y%ca'v%cav%ca!_%ca%i%ca!g%ca~P#MSO#k%aaP%aaR%aa[%aaa%aaj%aar%aa!S%aa!]%aa!l%aa!p%aa#R%aa#n%aa#o%aa#p%aa#q%aa#r%aa#s%aa#t%aa#u%aa#v%aa#x%aa#z%aa#{%aa'y%aa(`%aa(q%aa!k%aa!Y%aa'v%aa#`%aav%aa!_%aa%i%aa!g%aa~P#/XO#k%caP%caR%ca[%caa%caj%car%ca!S%ca!]%ca!l%ca!p%ca#R%ca#n%ca#o%ca#p%ca#q%ca#r%ca#s%ca#t%ca#u%ca#v%ca#x%ca#z%ca#{%ca'y%ca(`%ca(q%ca!k%ca!Y%ca'v%ca#`%cav%ca!_%ca%i%ca!g%ca~P#/XO#k}aP}a[}aa}aj}ar}a!l}a!p}a#R}a#n}a#o}a#p}a#q}a#r}a#s}a#t}a#u}a#v}a#x}a#z}a#{}a'y}a(`}a(q}a!k}a!Y}a'v}av}a!_}a%i}a!g}a~P$&vO#k$saP$saR$sa[$saa$saj$sar$sa!S$sa!l$sa!p$sa#R$sa#n$sa#o$sa#p$sa#q$sa#r$sa#s$sa#t$sa#u$sa#v$sa#x$sa#z$sa#{$sa'y$sa(`$sa(q$sa!k$sa!Y$sa'v$sav$sa!_$sa%i$sa!g$sa~P$'rO#k$uaP$uaR$ua[$uaa$uaj$uar$ua!S$ua!l$ua!p$ua#R$ua#n$ua#o$ua#p$ua#q$ua#r$ua#s$ua#t$ua#u$ua#v$ua#x$ua#z$ua#{$ua'y$ua(`$ua(q$ua!k$ua!Y$ua'v$uav$ua!_$ua%i$ua!g$ua~P$(eO#k%TaP%TaR%Ta[%Taa%Taj%Tar%Ta!S%Ta!]%Ta!l%Ta!p%Ta#R%Ta#n%Ta#o%Ta#p%Ta#q%Ta#r%Ta#s%Ta#t%Ta#u%Ta#v%Ta#x%Ta#z%Ta#{%Ta'y%Ta(`%Ta(q%Ta!k%Ta!Y%Ta'v%Ta#`%Tav%Ta!_%Ta%i%Ta!g%Ta~P#/XOa#cq!]#cq'y#cq'v#cq!Y#cq!k#cqv#cq!_#cq%i#cq!g#cq~P!:aO![3dO!]'XX!k'XX~P%[O!].oO!k(ja~O!].oO!k(ja~P!:aO!Y3gO~O$O!na!^!na~PKaO$O!ja!]!ja!^!ja~P#B]O$O!ra!^!ra~P!<wO$O!ta!^!ta~P!?_Og'[X!]'[X~P!+xO!].zOg(oa~OSfO!_3{O$d3|O~O!^4QO~Ov4RO~P#/XOa$mq!]$mq'y$mq'v$mq!Y$mq!k$mqv$mq!_$mq%i$mq!g$mq~P!:aO!Y4TO~P!&oO!S4UO~O!Q)|O'x)}O(y%POn'ha(x'ha!]'ha#`'ha~Og'ha$O'ha~P%,XO!Q)|O'x)}On'ja(x'ja(y'ja!]'ja#`'ja~Og'ja$O'ja~P%,zO(q$YO~P#/XO!YfX!Y$zX!]fX!]$zX!g%RX#`fX~P!/wO(S<xO~P!1jO!S%gO![4XO!_%hO(S%fO!]'dX!k'dX~O!]/kO!k(}a~O!]/kO!g#vO!k(}a~O!]/kO!g#vO(q'nO!k(}a~Og$|i!]$|i#`$|i$O$|i~P!0{O![4aO!Y'fX!]'fX~P!3iO!]/sO!Y)Oa~O!]/sO!Y)Oa~P#/XOP]XR]X[]Xj]Xr]X!Q]X!S]X!Y]X!]]X!l]X!p]X#R]X#S]X#`]X#kfX#n]X#o]X#p]X#q]X#r]X#s]X#t]X#u]X#v]X#x]X#z]X#{]X$Q]X(`]X(q]X(x]X(y]X~Oj%YX!g%YX~P%0kOj4fO!g#vO~Oh%VO!g#vO!l%dO~Oh%VOr4kO!l%dO(q'nO~Or4pO!g#vO(q'nO~Os!nO!S4qO(UTO(XUO(d!mO~O(x$}On%ai!Q%ai'x%ai(y%ai!]%ai#`%ai~Og%ai$O%ai~P%4[O(y%POn%ci!Q%ci'x%ci(x%ci!]%ci#`%ci~Og%ci$O%ci~P%4}Og(^i!](^i~P!0{O#`4wOg(^i!](^i~P!0{O!k4zO~Oa$oq!]$oq'y$oq'v$oq!Y$oq!k$oqv$oq!_$oq%i$oq!g$oq~P!:aO!Y5QO~O!]5RO!_)PX~P#/XOa$zX!_$zX%^]X'y$zX!]$zX~P!/wO%^5UOaoXnoX!QoX!_oX'xoX'yoX(xoX(yoX!]oX~Op5VO(S#nO~O%^5UO~Ob5]O%j5^O(S+nO(UTO(XUO!]'sX!^'sX~O!]0}O!^)Wa~O[5bO~O`5cO~Oa%mO'y%mO~P#/XO!]5kO#`5mO!^)TX~O!^5nO~Or5tOs!nO!S*fO!b!yO!c!vO!d!vO!|;wO#T!pO#U!pO#V!pO#W!pO#X!pO#[5sO#]!zO(T!lO(UTO(XUO(d!mO(n!sO~O!^5rO~P%:YOn5yO!_1gO%i5xO~Oh%VOn5yO!_1gO%i5xO~Ob6QO(S#nO(UTO(XUO!]'rX!^'rX~O!]1rO!^)Ua~O(UTO(XUO(d6SO~O`6WO~Oj6ZO&Z6[O~PM|O!k6]O~P%[Oa6_O~Oa6_O~P%[Ob2YO!^6dO&i2XO~P`O!g6fO~O!g6hOh(ii!](ii!^(ii!g(ii!l(iir(ii(q(ii~O!]#hi!^#hi~P#B]O#`6iO!]#hi!^#hi~O!]!ai!^!ai~P#B]Oa%mO#`6rO'y%mO~Oa%mO!g#vO#`6rO'y%mO~O!](sq!k(sqa(sq'y(sq~P!:aO!](hO!k(rq~O!S%gO!_%hO#j6yO(S%fO~O!_'^O%i6|O~On7QO!_'^O%i6|O~O#k'haP'haR'ha['haa'haj'har'ha!S'ha!l'ha!p'ha#R'ha#n'ha#o'ha#p'ha#q'ha#r'ha#s'ha#t'ha#u'ha#v'ha#x'ha#z'ha#{'ha'y'ha(`'ha(q'ha!k'ha!Y'ha'v'hav'ha!_'ha%i'ha!g'ha~P%,XO#k'jaP'jaR'ja['jaa'jaj'jar'ja!S'ja!l'ja!p'ja#R'ja#n'ja#o'ja#p'ja#q'ja#r'ja#s'ja#t'ja#u'ja#v'ja#x'ja#z'ja#{'ja'y'ja(`'ja(q'ja!k'ja!Y'ja'v'jav'ja!_'ja%i'ja!g'ja~P%,zO#k$|iP$|iR$|i[$|ia$|ij$|ir$|i!S$|i!]$|i!l$|i!p$|i#R$|i#n$|i#o$|i#p$|i#q$|i#r$|i#s$|i#t$|i#u$|i#v$|i#x$|i#z$|i#{$|i'y$|i(`$|i(q$|i!k$|i!Y$|i'v$|i#`$|iv$|i!_$|i%i$|i!g$|i~P#/XO#k%aiP%aiR%ai[%aia%aij%air%ai!S%ai!l%ai!p%ai#R%ai#n%ai#o%ai#p%ai#q%ai#r%ai#s%ai#t%ai#u%ai#v%ai#x%ai#z%ai#{%ai'y%ai(`%ai(q%ai!k%ai!Y%ai'v%aiv%ai!_%ai%i%ai!g%ai~P%4[O#k%ciP%ciR%ci[%cia%cij%cir%ci!S%ci!l%ci!p%ci#R%ci#n%ci#o%ci#p%ci#q%ci#r%ci#s%ci#t%ci#u%ci#v%ci#x%ci#z%ci#{%ci'y%ci(`%ci(q%ci!k%ci!Y%ci'v%civ%ci!_%ci%i%ci!g%ci~P%4}O!]'Xa!k'Xa~P!:aO!].oO!k(ji~O$O#ci!]#ci!^#ci~P#B]OP$[OR#zO!Q#yO!S#{O!l#xO!p$[O(`VO[#mij#mir#mi#R#mi#o#mi#p#mi#q#mi#r#mi#s#mi#t#mi#u#mi#v#mi#x#mi#z#mi#{#mi$O#mi(q#mi(x#mi(y#mi!]#mi!^#mi~O#n#mi~P%MXO#n<PO~P%MXOP$[OR#zOr<]O!Q#yO!S#{O!l#xO!p$[O#n<PO#o<QO#p<QO#q<QO(`VO[#mij#mi#R#mi#s#mi#t#mi#u#mi#v#mi#x#mi#z#mi#{#mi$O#mi(q#mi(x#mi(y#mi!]#mi!^#mi~O#r#mi~P& aO#r<RO~P& aOP$[OR#zO[<_Oj<SOr<]O!Q#yO!S#{O!l#xO!p$[O#R<SO#n<PO#o<QO#p<QO#q<QO#r<RO#s<SO#t<SO#u<^O(`VO#x#mi#z#mi#{#mi$O#mi(q#mi(x#mi(y#mi!]#mi!^#mi~O#v#mi~P&#iOP$[OR#zO[<_Oj<SOr<]O!Q#yO!S#{O!l#xO!p$[O#R<SO#n<PO#o<QO#p<QO#q<QO#r<RO#s<SO#t<SO#u<^O#v<TO(`VO(y#}O#z#mi#{#mi$O#mi(q#mi(x#mi!]#mi!^#mi~O#x<VO~P&%jO#x#mi~P&%jO#v<TO~P&#iOP$[OR#zO[<_Oj<SOr<]O!Q#yO!S#{O!l#xO!p$[O#R<SO#n<PO#o<QO#p<QO#q<QO#r<RO#s<SO#t<SO#u<^O#v<TO#x<VO(`VO(x#|O(y#}O#{#mi$O#mi(q#mi!]#mi!^#mi~O#z#mi~P&'yO#z<XO~P&'yOa#|y!]#|y'y#|y'v#|y!Y#|y!k#|yv#|y!_#|y%i#|y!g#|y~P!:aO[#mij#mir#mi#R#mi#r#mi#s#mi#t#mi#u#mi#v#mi#x#mi#z#mi#{#mi$O#mi(q#mi!]#mi!^#mi~OP$[OR#zO!Q#yO!S#{O!l#xO!p$[O#n<PO#o<QO#p<QO#q<QO(`VO(x#mi(y#mi~P&*uOn=}O!Q)|O'x)}O(x$}O(y%POP#miR#mi!S#mi!l#mi!p#mi#n#mi#o#mi#p#mi#q#mi(`#mi~P&*uO#S$dOP(_XR(_X[(_Xj(_Xn(_Xr(_X!Q(_X!S(_X!l(_X!p(_X#R(_X#n(_X#o(_X#p(_X#q(_X#r(_X#s(_X#t(_X#u(_X#v(_X#x(_X#z(_X#{(_X$O(_X'x(_X(`(_X(q(_X(x(_X(y(_X!](_X!^(_X~O$O$Pi!]$Pi!^$Pi~P#B]O$O!ri!^!ri~P$*bOg'[a!]'[a~P!0{O!^7dO~O!]'ca!^'ca~P#B]O!Y7eO~P#/XO!g#vO(q'nO!]'da!k'da~O!]/kO!k(}i~O!]/kO!g#vO!k(}i~Og$|q!]$|q#`$|q$O$|q~P!0{O!Y'fa!]'fa~P#/XO!g7lO~O!]/sO!Y)Oi~P#/XO!]/sO!Y)Oi~O!Y7oO~Oh%VOr7tO!l%dO(q'nO~Oj7vO!g#vO~Or7yO!g#vO(q'nO~O!Q)|O'x)}O(y%POn'ia(x'ia!]'ia#`'ia~Og'ia$O'ia~P&3vO!Q)|O'x)}On'ka(x'ka(y'ka!]'ka#`'ka~Og'ka$O'ka~P&4iO!Y7{O~Og%Oq!]%Oq#`%Oq$O%Oq~P!0{Og(^q!](^q~P!0{O#`7|Og(^q!](^q~P!0{Oa$oy!]$oy'y$oy'v$oy!Y$oy!k$oyv$oy!_$oy%i$oy!g$oy~P!:aO!g6hO~O!]5RO!_)Pa~O!_'^OP$TaR$Ta[$Taj$Tar$Ta!Q$Ta!S$Ta!]$Ta!l$Ta!p$Ta#R$Ta#n$Ta#o$Ta#p$Ta#q$Ta#r$Ta#s$Ta#t$Ta#u$Ta#v$Ta#x$Ta#z$Ta#{$Ta(`$Ta(q$Ta(x$Ta(y$Ta~O%i6|O~P&7ZO%^8QOa%[i!_%[i'y%[i!]%[i~Oa#cy!]#cy'y#cy'v#cy!Y#cy!k#cyv#cy!_#cy%i#cy!g#cy~P!:aO[8SO~Ob8UO(S+nO(UTO(XUO~O!]0}O!^)Wi~O`8YO~O(d(zO!]'oX!^'oX~O!]5kO!^)Ta~O!^8cO~P%:YO(n!sO~P$${O#[8dO~O!_1gO~O!_1gO%i8fO~On8iO!_1gO%i8fO~O[8nO!]'ra!^'ra~O!]1rO!^)Ui~O!k8rO~O!k8sO~O!k8vO~O!k8vO~P%[Oa8xO~O!g8yO~O!k8zO~O!](vi!^(vi~P#B]Oa%mO#`9SO'y%mO~O!](sy!k(sya(sy'y(sy~P!:aO!](hO!k(ry~O%i9VO~P&7ZO!_'^O%i9VO~O#k$|qP$|qR$|q[$|qa$|qj$|qr$|q!S$|q!]$|q!l$|q!p$|q#R$|q#n$|q#o$|q#p$|q#q$|q#r$|q#s$|q#t$|q#u$|q#v$|q#x$|q#z$|q#{$|q'y$|q(`$|q(q$|q!k$|q!Y$|q'v$|q#`$|qv$|q!_$|q%i$|q!g$|q~P#/XO#k'iaP'iaR'ia['iaa'iaj'iar'ia!S'ia!l'ia!p'ia#R'ia#n'ia#o'ia#p'ia#q'ia#r'ia#s'ia#t'ia#u'ia#v'ia#x'ia#z'ia#{'ia'y'ia(`'ia(q'ia!k'ia!Y'ia'v'iav'ia!_'ia%i'ia!g'ia~P&3vO#k'kaP'kaR'ka['kaa'kaj'kar'ka!S'ka!l'ka!p'ka#R'ka#n'ka#o'ka#p'ka#q'ka#r'ka#s'ka#t'ka#u'ka#v'ka#x'ka#z'ka#{'ka'y'ka(`'ka(q'ka!k'ka!Y'ka'v'kav'ka!_'ka%i'ka!g'ka~P&4iO#k%OqP%OqR%Oq[%Oqa%Oqj%Oqr%Oq!S%Oq!]%Oq!l%Oq!p%Oq#R%Oq#n%Oq#o%Oq#p%Oq#q%Oq#r%Oq#s%Oq#t%Oq#u%Oq#v%Oq#x%Oq#z%Oq#{%Oq'y%Oq(`%Oq(q%Oq!k%Oq!Y%Oq'v%Oq#`%Oqv%Oq!_%Oq%i%Oq!g%Oq~P#/XO!]'Xi!k'Xi~P!:aO$O#cq!]#cq!^#cq~P#B]O(x$}OP%aaR%aa[%aaj%aar%aa!S%aa!l%aa!p%aa#R%aa#n%aa#o%aa#p%aa#q%aa#r%aa#s%aa#t%aa#u%aa#v%aa#x%aa#z%aa#{%aa$O%aa(`%aa(q%aa!]%aa!^%aa~On%aa!Q%aa'x%aa(y%aa~P&HnO(y%POP%caR%ca[%caj%car%ca!S%ca!l%ca!p%ca#R%ca#n%ca#o%ca#p%ca#q%ca#r%ca#s%ca#t%ca#u%ca#v%ca#x%ca#z%ca#{%ca$O%ca(`%ca(q%ca!]%ca!^%ca~On%ca!Q%ca'x%ca(x%ca~P&JuOn=}O!Q)|O'x)}O(y%PO~P&HnOn=}O!Q)|O'x)}O(x$}O~P&JuOR0cO!Q0cO!S0dO#S$dOP}a[}aj}an}ar}a!l}a!p}a#R}a#n}a#o}a#p}a#q}a#r}a#s}a#t}a#u}a#v}a#x}a#z}a#{}a$O}a'x}a(`}a(q}a(x}a(y}a!]}a!^}a~O!Q)|O'x)}OP$saR$sa[$saj$san$sar$sa!S$sa!l$sa!p$sa#R$sa#n$sa#o$sa#p$sa#q$sa#r$sa#s$sa#t$sa#u$sa#v$sa#x$sa#z$sa#{$sa$O$sa(`$sa(q$sa(x$sa(y$sa!]$sa!^$sa~O!Q)|O'x)}OP$uaR$ua[$uaj$uan$uar$ua!S$ua!l$ua!p$ua#R$ua#n$ua#o$ua#p$ua#q$ua#r$ua#s$ua#t$ua#u$ua#v$ua#x$ua#z$ua#{$ua$O$ua(`$ua(q$ua(x$ua(y$ua!]$ua!^$ua~On=}O!Q)|O'x)}O(x$}O(y%PO~OP%TaR%Ta[%Taj%Tar%Ta!S%Ta!l%Ta!p%Ta#R%Ta#n%Ta#o%Ta#p%Ta#q%Ta#r%Ta#s%Ta#t%Ta#u%Ta#v%Ta#x%Ta#z%Ta#{%Ta$O%Ta(`%Ta(q%Ta!]%Ta!^%Ta~P'%zO$O$mq!]$mq!^$mq~P#B]O$O$oq!]$oq!^$oq~P#B]O!^9dO~O$O9eO~P!0{O!g#vO!]'di!k'di~O!g#vO(q'nO!]'di!k'di~O!]/kO!k(}q~O!Y'fi!]'fi~P#/XO!]/sO!Y)Oq~Or9lO!g#vO(q'nO~O[9nO!Y9mO~P#/XO!Y9mO~Oj9tO!g#vO~Og(^y!](^y~P!0{O!]'ma!_'ma~P#/XOa%[q!_%[q'y%[q!]%[q~P#/XO[9yO~O!]0}O!^)Wq~O#`9}O!]'oa!^'oa~O!]5kO!^)Ti~P#B]O!S:PO~O!_1gO%i:SO~O(UTO(XUO(d:XO~O!]1rO!^)Uq~O!k:[O~O!k:]O~O!k:^O~O!k:^O~P%[O#`:aO!]#hy!^#hy~O!]#hy!^#hy~P#B]O%i:fO~P&7ZO!_'^O%i:fO~O$O#|y!]#|y!^#|y~P#B]OP$|iR$|i[$|ij$|ir$|i!S$|i!l$|i!p$|i#R$|i#n$|i#o$|i#p$|i#q$|i#r$|i#s$|i#t$|i#u$|i#v$|i#x$|i#z$|i#{$|i$O$|i(`$|i(q$|i!]$|i!^$|i~P'%zO!Q)|O'x)}O(y%POP'haR'ha['haj'han'har'ha!S'ha!l'ha!p'ha#R'ha#n'ha#o'ha#p'ha#q'ha#r'ha#s'ha#t'ha#u'ha#v'ha#x'ha#z'ha#{'ha$O'ha(`'ha(q'ha(x'ha!]'ha!^'ha~O!Q)|O'x)}OP'jaR'ja['jaj'jan'jar'ja!S'ja!l'ja!p'ja#R'ja#n'ja#o'ja#p'ja#q'ja#r'ja#s'ja#t'ja#u'ja#v'ja#x'ja#z'ja#{'ja$O'ja(`'ja(q'ja(x'ja(y'ja!]'ja!^'ja~O(x$}OP%aiR%ai[%aij%ain%air%ai!Q%ai!S%ai!l%ai!p%ai#R%ai#n%ai#o%ai#p%ai#q%ai#r%ai#s%ai#t%ai#u%ai#v%ai#x%ai#z%ai#{%ai$O%ai'x%ai(`%ai(q%ai(y%ai!]%ai!^%ai~O(y%POP%ciR%ci[%cij%cin%cir%ci!Q%ci!S%ci!l%ci!p%ci#R%ci#n%ci#o%ci#p%ci#q%ci#r%ci#s%ci#t%ci#u%ci#v%ci#x%ci#z%ci#{%ci$O%ci'x%ci(`%ci(q%ci(x%ci!]%ci!^%ci~O$O$oy!]$oy!^$oy~P#B]O$O#cy!]#cy!^#cy~P#B]O!g#vO!]'dq!k'dq~O!]/kO!k(}y~O!Y'fq!]'fq~P#/XOr:pO!g#vO(q'nO~O[:tO!Y:sO~P#/XO!Y:sO~Og(^!R!](^!R~P!0{Oa%[y!_%[y'y%[y!]%[y~P#/XO!]0}O!^)Wy~O!]5kO!^)Tq~O(S:zO~O!_1gO%i:}O~O!k;QO~O%i;VO~P&7ZOP$|qR$|q[$|qj$|qr$|q!S$|q!l$|q!p$|q#R$|q#n$|q#o$|q#p$|q#q$|q#r$|q#s$|q#t$|q#u$|q#v$|q#x$|q#z$|q#{$|q$O$|q(`$|q(q$|q!]$|q!^$|q~P'%zO!Q)|O'x)}O(y%POP'iaR'ia['iaj'ian'iar'ia!S'ia!l'ia!p'ia#R'ia#n'ia#o'ia#p'ia#q'ia#r'ia#s'ia#t'ia#u'ia#v'ia#x'ia#z'ia#{'ia$O'ia(`'ia(q'ia(x'ia!]'ia!^'ia~O!Q)|O'x)}OP'kaR'ka['kaj'kan'kar'ka!S'ka!l'ka!p'ka#R'ka#n'ka#o'ka#p'ka#q'ka#r'ka#s'ka#t'ka#u'ka#v'ka#x'ka#z'ka#{'ka$O'ka(`'ka(q'ka(x'ka(y'ka!]'ka!^'ka~OP%OqR%Oq[%Oqj%Oqr%Oq!S%Oq!l%Oq!p%Oq#R%Oq#n%Oq#o%Oq#p%Oq#q%Oq#r%Oq#s%Oq#t%Oq#u%Oq#v%Oq#x%Oq#z%Oq#{%Oq$O%Oq(`%Oq(q%Oq!]%Oq!^%Oq~P'%zOg%e!Z!]%e!Z#`%e!Z$O%e!Z~P!0{O!Y;ZO~P#/XOr;[O!g#vO(q'nO~O[;^O!Y;ZO~P#/XO!]'oq!^'oq~P#B]O!]#h!Z!^#h!Z~P#B]O#k%e!ZP%e!ZR%e!Z[%e!Za%e!Zj%e!Zr%e!Z!S%e!Z!]%e!Z!l%e!Z!p%e!Z#R%e!Z#n%e!Z#o%e!Z#p%e!Z#q%e!Z#r%e!Z#s%e!Z#t%e!Z#u%e!Z#v%e!Z#x%e!Z#z%e!Z#{%e!Z'y%e!Z(`%e!Z(q%e!Z!k%e!Z!Y%e!Z'v%e!Z#`%e!Zv%e!Z!_%e!Z%i%e!Z!g%e!Z~P#/XOr;fO!g#vO(q'nO~O!Y;gO~P#/XOr;nO!g#vO(q'nO~O!Y;oO~P#/XOP%e!ZR%e!Z[%e!Zj%e!Zr%e!Z!S%e!Z!l%e!Z!p%e!Z#R%e!Z#n%e!Z#o%e!Z#p%e!Z#q%e!Z#r%e!Z#s%e!Z#t%e!Z#u%e!Z#v%e!Z#x%e!Z#z%e!Z#{%e!Z$O%e!Z(`%e!Z(q%e!Z!]%e!Z!^%e!Z~P'%zOr;rO!g#vO(q'nO~Ov(eX~P1qO!Q%qO~P!)PO(T!lO~P!)PO!YfX!]fX#`fX~P%0kOP]XR]X[]Xj]Xr]X!Q]X!S]X!]]X!]fX!l]X!p]X#R]X#S]X#`]X#`fX#kfX#n]X#o]X#p]X#q]X#r]X#s]X#t]X#u]X#v]X#x]X#z]X#{]X$Q]X(`]X(q]X(x]X(y]X~O!gfX!k]X!kfX(qfX~P'JsOP;vOQ;vOSfOd=rOe!iOpkOr;vOskOtkOzkO|;vO!O;vO!SWO!WkO!XkO!_XO!i;yO!lZO!o;vO!p;vO!q;vO!s;zO!u;}O!x!hO$W!kO$n=pO(S)ZO(UTO(XUO(`VO(n[O~O!]<ZO!^$qa~Oh%VOp%WOr%XOs$tOt$tOz%YO|%ZO!O<fO!S${O!_$|O!i=wO!l$xO#j<lO$W%_O$t<hO$v<jO$y%`O(S(tO(UTO(XUO(`$uO(x$}O(y%PO~Ol)bO~P( iOr!eX(q!eX~P# }Or(iX(q(iX~P#!pO!^]X!^fX~P'JsO!YfX!Y$zX!]fX!]$zX#`fX~P!/wO#k<OO~O!g#vO#k<OO~O#`<`O~Oj<SO~O#`<pO!](vX!^(vX~O#`<`O!](tX!^(tX~O#k<qO~Og<sO~P!0{O#k<yO~O#k<zO~O!g#vO#k<{O~O!g#vO#k<qO~O$O<|O~P#B]O#k<}O~O#k=OO~O#k=TO~O#k=UO~O#k=VO~O#k=WO~O$O=XO~P!0{O$O=YO~P!0{Ok#S#T#U#W#X#[#i#j#u$n$t$v$y%]%^%h%i%j%q%s%v%w%y%{~'}T#o!X'{(T#ps#n#qr!Q'|$]'|(S$_(d~",goto:"$8g)[PPPPPP)]PP)`P)qP+R/WPPPP6bPP6xPP<pPPP@dP@zP@zPPP@zPCSP@zP@zP@zPCWPC]PCzPHtPPPHxPPPPHxK{PPPLRLsPHxPHxPP! RHxPPPHxPHxP!#YHxP!&p!'u!(OP!(r!(v!(r!,TPPPPPPP!,t!'uPP!-U!.vP!2SHxHx!2X!5e!:R!:R!>QPPP!>YHxPPPPPPPPP!AiP!BvPPHx!DXPHxPHxHxHxHxHxPHx!EkP!HuP!K{P!LP!LZ!L_!L_P!HrP!Lc!LcP# iP# mHxPHx# s#$xCW@zP@zP@z@zP#&V@z@z#(i@z#+a@z#-m@z@z#.]#0q#0q#0v#1P#0q#1[PP#0qP@z#1t@z#5s@z@z6bPPP#9xPPP#:c#:cP#:cP#:y#:cPP#;PP#:vP#:v#;d#:v#<O#<U#<X)`#<[)`P#<c#<c#<cP)`P)`P)`P)`PP)`P#<i#<lP#<l)`P#<pP#<sP)`P)`P)`P)`P)`P)`)`PP#<y#=P#=[#=b#=h#=n#=t#>S#>Y#>d#>j#>t#>z#?[#?b#@S#@f#@l#@r#AQ#Ag#C[#Cj#Cq#E]#Ek#G]#Gk#Gq#Gw#G}#HX#H_#He#Ho#IR#IXPPPPPPPPPPP#I_PPPPPPP#JS#MZ#Ns#Nz$ SPPP$&nP$&w$)p$0Z$0^$0a$1`$1c$1j$1rP$1x$1{P$2i$2m$3e$4s$4x$5`PP$5e$5k$5o$5r$5v$5z$6v$7_$7v$7z$7}$8Q$8W$8Z$8_$8cR!|RoqOXst!Z#d%l&p&r&s&u,n,s2S2VY!vQ'^-`1g5qQ%svQ%{yQ&S|Q&h!VS'U!e-WQ'd!iS'j!r!yU*h$|*X*lQ+l%|Q+y&UQ,_&bQ-^']Q-h'eQ-p'kQ0U*nQ1q,`R<m;z%SdOPWXYZstuvw!Z!`!g!o#S#W#Z#d#o#u#x#{$O$P$Q$R$S$T$U$V$W$X$_$a$e%l%s&Q&i&l&p&r&s&u&y'R'`'p(R(T(Z(b(v(x(|){*f+U+Y,k,n,s-d-l-z.Q.o.v/i0V0d0l0|1j1z1{1}2P2S2V2X2x3O3d4q5y6Z6[6_6r8i8x9SS#q];w!r)]$Z$n'V)q-P-S/Q2h3{5m6i9}:a;v;y;z;}<O<P<Q<R<S<T<U<V<W<X<Y<Z<]<`<m<p<q<s<{<|=V=W=sU*{%[<e<fQ+q&OQ,a&eQ,h&mQ0r+dQ0w+fQ1S+rQ1y,fQ3W.bQ5V0vQ5]0}Q6Q1rQ7O3[Q8U5^R9Y7Q'QkOPWXYZstuvw!Z!`!g!o#S#W#Z#d#o#u#x#{$O$P$Q$R$S$T$U$V$W$X$Z$_$a$e$n%l%s&Q&i&l&m&p&r&s&u&y'R'V'`'p(R(T(Z(b(v(x(|)q){*f+U+Y+d,k,n,s-P-S-d-l-z.Q.b.o.v/Q/i0V0d0l0|1j1z1{1}2P2S2V2X2h2x3O3[3d3{4q5m5y6Z6[6_6i6r7Q8i8x9S9}:a;v;y;z;}<O<P<Q<R<S<T<U<V<W<X<Y<Z<]<`<m<p<q<s<{<|=V=W=s!S!nQ!r!v!y!z$|'U']'^'j'k'l*h*l*n*o-W-^-`-p0U0X1g5q5s%[$ti#v$b$c$d$x${%O%Q%]%^%b)w*P*R*T*W*^*d*t*u+c+f+},Q.a.z/_/h/r/s/u0Y0[0g0h0i1^1a1i3Z4U4V4a4f4w5R5U5x6|7l7v7|8Q8f9V9e9n9t:S:f:t:};V;^<^<_<a<b<c<d<g<h<i<j<k<l<t<u<v<w<y<z<}=O=P=Q=R=S=T=U=X=Y=p=x=y=|=}Q&V|Q'S!eS'Y%h-ZQ+q&OQ,a&eQ0f+OQ1S+rQ1X+xQ1x,eQ1y,fQ5]0}Q5f1ZQ6Q1rQ6T1tQ6U1wQ8U5^Q8X5cQ8q6WQ9|8YQ:Y8nR<o*XrnOXst!V!Z#d%l&g&p&r&s&u,n,s2S2VR,c&i&z^OPXYstuvwz!Z!`!g!j!o#S#d#o#u#x#{$O$P$Q$R$S$T$U$V$W$X$Z$_$a$e$n%l%s&Q&i&l&m&p&r&s&u&y'R'`'p(T(Z(b(v(x(|)q){*f+U+Y+d,k,n,s-P-S-d-l-z.Q.b.o.v/Q/i0V0d0l0|1j1z1{1}2P2S2V2X2h2x3O3[3d3{4q5m5y6Z6[6_6i6r7Q8i8x9S9}:a;v;y;z;}<O<P<Q<R<S<T<U<V<W<X<Y<Z<]<`<m<p<q<s<{<|=V=W=r=s[#]WZ#W#Z'V(R!b%im#h#i#l$x%d%g([(f(g(h*W*[*_+W+X+Z,j-Q.O.U.V.W.Y/h/k2[3S3T4X6h6yQ%vxQ%zyS&P|&UQ&]!TQ'a!hQ'c!iQ(o#sS+k%{%|Q+o&OQ,Y&`Q,^&bS-g'd'eQ.d(pQ0{+lQ1R+rQ1T+sQ1W+wQ1l,ZS1p,_,`Q2t-hQ5[0}Q5`1QQ5e1YQ6P1qQ8T5^Q8W5bQ9x8SR:w9y!U$zi$d%O%Q%]%^%b*P*R*^*t*u.z/r0Y0[0g0h0i4V4w7|9e=p=x=y!^%xy!i!u%z%{%|'T'c'd'e'i's*g+k+l-T-g-h-o/{0O0{2m2t2{4i4j4m7s9pQ+e%vQ,O&YQ,R&ZQ,]&bQ.c(oQ1k,YU1o,^,_,`Q3].dQ5z1lS6O1p1qQ8m6P#f=t#v$b$c$x${)w*T*W*d+c+f+},Q.a/_/h/s/u1^1a1i3Z4U4a4f5R5U5x6|7l7v8Q8f9V9n9t:S:f:t:};V;^<a<c<g<i<k<t<v<y<}=P=R=T=X=|=}o=u<^<_<b<d<h<j<l<u<w<z=O=Q=S=U=YW%Ti%V*v=pS&Y!Q&gQ&Z!RQ&[!SQ+S%cR+|&W%]%Si#v$b$c$d$x${%O%Q%]%^%b)w*P*R*T*W*^*d*t*u+c+f+},Q.a.z/_/h/r/s/u0Y0[0g0h0i1^1a1i3Z4U4V4a4f4w5R5U5x6|7l7v7|8Q8f9V9e9n9t:S:f:t:};V;^<^<_<a<b<c<d<g<h<i<j<k<l<t<u<v<w<y<z<}=O=P=Q=R=S=T=U=X=Y=p=x=y=|=}T)x$u)yV*{%[<e<fW'Y!e%h*X-ZS({#y#zQ+`%qQ+v&RS.](k(lQ1b,SQ4x0cR8^5k'QkOPWXYZstuvw!Z!`!g!o#S#W#Z#d#o#u#x#{$O$P$Q$R$S$T$U$V$W$X$Z$_$a$e$n%l%s&Q&i&l&m&p&r&s&u&y'R'V'`'p(R(T(Z(b(v(x(|)q){*f+U+Y+d,k,n,s-P-S-d-l-z.Q.b.o.v/Q/i0V0d0l0|1j1z1{1}2P2S2V2X2h2x3O3[3d3{4q5m5y6Z6[6_6i6r7Q8i8x9S9}:a;v;y;z;}<O<P<Q<R<S<T<U<V<W<X<Y<Z<]<`<m<p<q<s<{<|=V=W=s$i$^c#Y#e%p%r%t(Q(W(r(w)P)Q)R)S)T)U)V)W)X)Y)[)^)`)e)o+a+u-U-s-x-}.P.n.q.u.w.x.y/]0j2c2f2v2}3c3h3i3j3k3l3m3n3o3p3q3r3s3t3w3x4P5O5Y6k6q6v7V7W7a7b8`8|9Q9[9b9c:c:y;R;x=gT#TV#U'RkOPWXYZstuvw!Z!`!g!o#S#W#Z#d#o#u#x#{$O$P$Q$R$S$T$U$V$W$X$Z$_$a$e$n%l%s&Q&i&l&m&p&r&s&u&y'R'V'`'p(R(T(Z(b(v(x(|)q){*f+U+Y+d,k,n,s-P-S-d-l-z.Q.b.o.v/Q/i0V0d0l0|1j1z1{1}2P2S2V2X2h2x3O3[3d3{4q5m5y6Z6[6_6i6r7Q8i8x9S9}:a;v;y;z;}<O<P<Q<R<S<T<U<V<W<X<Y<Z<]<`<m<p<q<s<{<|=V=W=sQ'W!eR2i-W!W!nQ!e!r!v!y!z$|'U']'^'j'k'l*X*h*l*n*o-W-^-`-p0U0X1g5q5sR1d,UnqOXst!Z#d%l&p&r&s&u,n,s2S2VQ&w!^Q't!xS(q#u<OQ+i%yQ,W&]Q,X&_Q-e'bQ-r'mS.m(v<qS0k+U<{Q0y+jQ1f,VQ2Z,uQ2],vQ2e-RQ2r-fQ2u-jS5P0l=VQ5W0zS5Z0|=WQ6j2gQ6n2sQ6s2zQ8R5XQ8}6lQ9O6oQ9R6tR:`8z$d$]c#Y#e%r%t(Q(W(r(w)P)Q)R)S)T)U)V)W)X)Y)[)^)`)e)o+a+u-U-s-x-}.P.n.q.u.x.y/]0j2c2f2v2}3c3h3i3j3k3l3m3n3o3p3q3r3s3t3w3x4P5O5Y6k6q6v7V7W7a7b8`8|9Q9[9b9c:c:y;R;x=gS(m#p'gQ(}#zS+_%p.wS.^(l(nR3U._'QkOPWXYZstuvw!Z!`!g!o#S#W#Z#d#o#u#x#{$O$P$Q$R$S$T$U$V$W$X$Z$_$a$e$n%l%s&Q&i&l&m&p&r&s&u&y'R'V'`'p(R(T(Z(b(v(x(|)q){*f+U+Y+d,k,n,s-P-S-d-l-z.Q.b.o.v/Q/i0V0d0l0|1j1z1{1}2P2S2V2X2h2x3O3[3d3{4q5m5y6Z6[6_6i6r7Q8i8x9S9}:a;v;y;z;}<O<P<Q<R<S<T<U<V<W<X<Y<Z<]<`<m<p<q<s<{<|=V=W=sS#q];wQ&r!XQ&s!YQ&u![Q&v!]R2R,qQ'_!hQ+b%vQ-c'aS.`(o+eQ2p-bW3Y.c.d0q0sQ6m2qW6z3V3X3]5TU9U6{6}7PU:e9W9X9ZS;T:d:gQ;b;UR;j;cU!wQ'^-`T5o1g5q!Q_OXZ`st!V!Z#d#h%d%l&g&i&p&r&s&u(h,n,s.V2S2V]!pQ!r'^-`1g5qT#q];w%^{OPWXYZstuvw!Z!`!g!o#S#W#Z#d#o#u#x#{$O$P$Q$R$S$T$U$V$W$X$_$a$e%l%s&Q&i&l&m&p&r&s&u&y'R'`'p(R(T(Z(b(v(x(|){*f+U+Y+d,k,n,s-d-l-z.Q.b.o.v/i0V0d0l0|1j1z1{1}2P2S2V2X2x3O3[3d4q5y6Z6[6_6r7Q8i8x9SS({#y#zS.](k(l!s=^$Z$n'V)q-P-S/Q2h3{5m6i9}:a;v;y;z;}<O<P<Q<R<S<T<U<V<W<X<Y<Z<]<`<m<p<q<s<{<|=V=W=sU$fd)],hS(n#p'gU*s%R(u3vU0e*z.i7]Q5T0rQ6{3WQ9X7OR:g9Ym!tQ!r!v!y!z'^'j'k'l-`-p1g5q5sQ'r!uS(d#g1|S-n'i'uQ/n*ZQ/{*gQ2|-qQ4]/oQ4i/}Q4j0OQ4o0WQ7h4WS7s4k4mS7w4p4rQ9g7iQ9k7oQ9p7tQ9u7yS:o9l9mS;Y:p:sS;e;Z;[S;m;f;gS;q;n;oR;t;rQ#wbQ'q!uS(c#g1|S(e#m+TQ+V%eQ+g%wQ+m%}U-m'i'r'uQ.R(dQ/m*ZQ/|*gQ0P*iQ0x+hQ1m,[S2y-n-qQ3R.ZS4[/n/oQ4e/yS4h/{0WQ4l0QQ5|1nQ6u2|Q7g4WQ7k4]U7r4i4o4rQ7u4nQ8k5}S9f7h7iQ9j7oQ9r7wQ9s7xQ:V8lQ:m9gS:n9k9mQ:v9uQ;P:WS;X:o:sS;d;Y;ZS;l;e;gS;p;m;oQ;s;qQ;u;tQ=a=[Q=l=eR=m=fV!wQ'^-`%^aOPWXYZstuvw!Z!`!g!o#S#W#Z#d#o#u#x#{$O$P$Q$R$S$T$U$V$W$X$_$a$e%l%s&Q&i&l&m&p&r&s&u&y'R'`'p(R(T(Z(b(v(x(|){*f+U+Y+d,k,n,s-d-l-z.Q.b.o.v/i0V0d0l0|1j1z1{1}2P2S2V2X2x3O3[3d4q5y6Z6[6_6r7Q8i8x9SS#wz!j!r=Z$Z$n'V)q-P-S/Q2h3{5m6i9}:a;v;y;z;}<O<P<Q<R<S<T<U<V<W<X<Y<Z<]<`<m<p<q<s<{<|=V=W=sR=a=r%^bOPWXYZstuvw!Z!`!g!o#S#W#Z#d#o#u#x#{$O$P$Q$R$S$T$U$V$W$X$_$a$e%l%s&Q&i&l&m&p&r&s&u&y'R'`'p(R(T(Z(b(v(x(|){*f+U+Y+d,k,n,s-d-l-z.Q.b.o.v/i0V0d0l0|1j1z1{1}2P2S2V2X2x3O3[3d4q5y6Z6[6_6r7Q8i8x9SQ%ej!^%wy!i!u%z%{%|'T'c'd'e'i's*g+k+l-T-g-h-o/{0O0{2m2t2{4i4j4m7s9pS%}z!jQ+h%xQ,[&bW1n,],^,_,`U5}1o1p1qS8l6O6PQ:W8m!r=[$Z$n'V)q-P-S/Q2h3{5m6i9}:a;v;y;z;}<O<P<Q<R<S<T<U<V<W<X<Y<Z<]<`<m<p<q<s<{<|=V=W=sQ=e=qR=f=r%QeOPXYstuvw!Z!`!g!o#S#d#o#u#x#{$O$P$Q$R$S$T$U$V$W$X$_$a$e%l%s&Q&i&l&p&r&s&u&y'R'`'p(T(Z(b(v(x(|){*f+U+Y+d,k,n,s-d-l-z.Q.b.o.v/i0V0d0l0|1j1z1{1}2P2S2V2X2x3O3[3d4q5y6Z6[6_6r7Q8i8x9SY#bWZ#W#Z(R!b%im#h#i#l$x%d%g([(f(g(h*W*[*_+W+X+Z,j-Q.O.U.V.W.Y/h/k2[3S3T4X6h6yQ,i&m!p=]$Z$n)q-P-S/Q2h3{5m6i9}:a;v;y;z;}<O<P<Q<R<S<T<U<V<W<X<Y<Z<]<`<m<p<q<s<{<|=V=W=sR=`'VU'Z!e%h*XR2k-Z%SdOPWXYZstuvw!Z!`!g!o#S#W#Z#d#o#u#x#{$O$P$Q$R$S$T$U$V$W$X$_$a$e%l%s&Q&i&l&p&r&s&u&y'R'`'p(R(T(Z(b(v(x(|){*f+U+Y,k,n,s-d-l-z.Q.o.v/i0V0d0l0|1j1z1{1}2P2S2V2X2x3O3d4q5y6Z6[6_6r8i8x9S!r)]$Z$n'V)q-P-S/Q2h3{5m6i9}:a;v;y;z;}<O<P<Q<R<S<T<U<V<W<X<Y<Z<]<`<m<p<q<s<{<|=V=W=sQ,h&mQ0r+dQ3W.bQ7O3[R9Y7Q!b$Tc#Y%p(Q(W(r(w)X)Y)^)e+u-s-x-}.P.n.q/]0j2v2}3c3s5O5Y6q6v7V9Q:c;x!P<U)[)o-U.w2c2f3h3q3r3w4P6k7W7a7b8`8|9[9b9c:y;R=g!f$Vc#Y%p(Q(W(r(w)U)V)X)Y)^)e+u-s-x-}.P.n.q/]0j2v2}3c3s5O5Y6q6v7V9Q:c;x!T<W)[)o-U.w2c2f3h3n3o3q3r3w4P6k7W7a7b8`8|9[9b9c:y;R=g!^$Zc#Y%p(Q(W(r(w)^)e+u-s-x-}.P.n.q/]0j2v2}3c3s5O5Y6q6v7V9Q:c;xQ4V/fz=s)[)o-U.w2c2f3h3w4P6k7W7a7b8`8|9[9b9c:y;R=gQ=x=zR=y={'QkOPWXYZstuvw!Z!`!g!o#S#W#Z#d#o#u#x#{$O$P$Q$R$S$T$U$V$W$X$Z$_$a$e$n%l%s&Q&i&l&m&p&r&s&u&y'R'V'`'p(R(T(Z(b(v(x(|)q){*f+U+Y+d,k,n,s-P-S-d-l-z.Q.b.o.v/Q/i0V0d0l0|1j1z1{1}2P2S2V2X2h2x3O3[3d3{4q5m5y6Z6[6_6i6r7Q8i8x9S9}:a;v;y;z;}<O<P<Q<R<S<T<U<V<W<X<Y<Z<]<`<m<p<q<s<{<|=V=W=sS$oh$pR3|/P'XgOPWXYZhstuvw!Z!`!g!o#S#W#Z#d#o#u#x#{$O$P$Q$R$S$T$U$V$W$X$Z$_$a$e$n$p%l%s&Q&i&l&m&p&r&s&u&y'R'V'`'p(R(T(Z(b(v(x(|)q){*f+U+Y+d,k,n,s-P-S-d-l-z.Q.b.o.v/P/Q/i0V0d0l0|1j1z1{1}2P2S2V2X2h2x3O3[3d3{4q5m5y6Z6[6_6i6r7Q8i8x9S9}:a;v;y;z;}<O<P<Q<R<S<T<U<V<W<X<Y<Z<]<`<m<p<q<s<{<|=V=W=sT$kf$qQ$ifS)h$l)lR)t$qT$jf$qT)j$l)l'XhOPWXYZhstuvw!Z!`!g!o#S#W#Z#d#o#u#x#{$O$P$Q$R$S$T$U$V$W$X$Z$_$a$e$n$p%l%s&Q&i&l&m&p&r&s&u&y'R'V'`'p(R(T(Z(b(v(x(|)q){*f+U+Y+d,k,n,s-P-S-d-l-z.Q.b.o.v/P/Q/i0V0d0l0|1j1z1{1}2P2S2V2X2h2x3O3[3d3{4q5m5y6Z6[6_6i6r7Q8i8x9S9}:a;v;y;z;}<O<P<Q<R<S<T<U<V<W<X<Y<Z<]<`<m<p<q<s<{<|=V=W=sT$oh$pQ$rhR)s$p%^jOPWXYZstuvw!Z!`!g!o#S#W#Z#d#o#u#x#{$O$P$Q$R$S$T$U$V$W$X$_$a$e%l%s&Q&i&l&m&p&r&s&u&y'R'`'p(R(T(Z(b(v(x(|){*f+U+Y+d,k,n,s-d-l-z.Q.b.o.v/i0V0d0l0|1j1z1{1}2P2S2V2X2x3O3[3d4q5y6Z6[6_6r7Q8i8x9S!s=q$Z$n'V)q-P-S/Q2h3{5m6i9}:a;v;y;z;}<O<P<Q<R<S<T<U<V<W<X<Y<Z<]<`<m<p<q<s<{<|=V=W=s#glOPXZst!Z!`!o#S#d#o#{$n%l&i&l&m&p&r&s&u&y'R'`(|)q*f+Y+d,k,n,s-d.b/Q/i0V0d1j1z1{1}2P2S2V2X3[3{4q5y6Z6[6_7Q8i8x!U%Ri$d%O%Q%]%^%b*P*R*^*t*u.z/r0Y0[0g0h0i4V4w7|9e=p=x=y#f(u#v$b$c$x${)w*T*W*d+c+f+},Q.a/_/h/s/u1^1a1i3Z4U4a4f5R5U5x6|7l7v8Q8f9V9n9t:S:f:t:};V;^<a<c<g<i<k<t<v<y<}=P=R=T=X=|=}Q+P%`Q/^)|o3v<^<_<b<d<h<j<l<u<w<z=O=Q=S=U=Y!U$yi$d%O%Q%]%^%b*P*R*^*t*u.z/r0Y0[0g0h0i4V4w7|9e=p=x=yQ*`$zU*i$|*X*lQ+Q%aQ0Q*j#f=c#v$b$c$x${)w*T*W*d+c+f+},Q.a/_/h/s/u1^1a1i3Z4U4a4f5R5U5x6|7l7v8Q8f9V9n9t:S:f:t:};V;^<a<c<g<i<k<t<v<y<}=P=R=T=X=|=}n=d<^<_<b<d<h<j<l<u<w<z=O=Q=S=U=YQ=h=tQ=i=uQ=j=vR=k=w!U%Ri$d%O%Q%]%^%b*P*R*^*t*u.z/r0Y0[0g0h0i4V4w7|9e=p=x=y#f(u#v$b$c$x${)w*T*W*d+c+f+},Q.a/_/h/s/u1^1a1i3Z4U4a4f5R5U5x6|7l7v8Q8f9V9n9t:S:f:t:};V;^<a<c<g<i<k<t<v<y<}=P=R=T=X=|=}o3v<^<_<b<d<h<j<l<u<w<z=O=Q=S=U=YnoOXst!Z#d%l&p&r&s&u,n,s2S2VS*c${*WQ,|&|Q,}'OR4`/s%[%Si#v$b$c$d$x${%O%Q%]%^%b)w*P*R*T*W*^*d*t*u+c+f+},Q.a.z/_/h/r/s/u0Y0[0g0h0i1^1a1i3Z4U4V4a4f4w5R5U5x6|7l7v7|8Q8f9V9e9n9t:S:f:t:};V;^<^<_<a<b<c<d<g<h<i<j<k<l<t<u<v<w<y<z<}=O=P=Q=R=S=T=U=X=Y=p=x=y=|=}Q,P&ZQ1`,RQ5i1_R8]5jV*k$|*X*lU*k$|*X*lT5p1g5qS/y*f/iQ4n0VT7x4q:PQ+g%wQ0P*iQ0x+hQ1m,[Q5|1nQ8k5}Q:V8lR;P:W!U%Oi$d%O%Q%]%^%b*P*R*^*t*u.z/r0Y0[0g0h0i4V4w7|9e=p=x=yx*P$v)c*Q*r+R/q0^0_3y4^4{4|4}7f7z9v:l=b=n=oS0Y*q0Z#f<a#v$b$c$x${)w*T*W*d+c+f+},Q.a/_/h/s/u1^1a1i3Z4U4a4f5R5U5x6|7l7v8Q8f9V9n9t:S:f:t:};V;^<a<c<g<i<k<t<v<y<}=P=R=T=X=|=}n<b<^<_<b<d<h<j<l<u<w<z=O=Q=S=U=Y!d<t(s)a*Y*b.e.h.l/Y/f/v0p1]3`4S4_4c5h7R7U7m7p7}8P9i9q9w:q:u;W;];h=z={`<u3u7X7[7`9]:h:k;kS=P.g3aT=Q7Z9`!U%Qi$d%O%Q%]%^%b*P*R*^*t*u.z/r0Y0[0g0h0i4V4w7|9e=p=x=y|*R$v)c*S*q+R/b/q0^0_3y4^4s4{4|4}7f7z9v:l=b=n=oS0[*r0]#f<c#v$b$c$x${)w*T*W*d+c+f+},Q.a/_/h/s/u1^1a1i3Z4U4a4f5R5U5x6|7l7v8Q8f9V9n9t:S:f:t:};V;^<a<c<g<i<k<t<v<y<}=P=R=T=X=|=}n<d<^<_<b<d<h<j<l<u<w<z=O=Q=S=U=Y!h<v(s)a*Y*b.f.g.l/Y/f/v0p1]3^3`4S4_4c5h7R7S7U7m7p7}8P9i9q9w:q:u;W;];h=z={d<w3u7Y7Z7`9]9^:h:i:k;kS=R.h3bT=S7[9arnOXst!V!Z#d%l&g&p&r&s&u,n,s2S2VQ&d!UR,k&mrnOXst!V!Z#d%l&g&p&r&s&u,n,s2S2VR&d!UQ,T&[R1[+|snOXst!V!Z#d%l&g&p&r&s&u,n,s2S2VQ1h,YS5w1k1lU8e5u5v5zS:R8g8hS:{:Q:TQ;_:|R;i;`Q&k!VR,d&gR6T1tR:Y8nS&P|&UR1T+sQ&p!WR,n&qR,t&vT2T,s2VR,x&wQ,w&wR2^,xQ'w!{R-t'wSsOtQ#dXT%os#dQ#OTR'y#OQ#RUR'{#RQ)y$uR/Z)yQ#UVR(O#UQ#XWU(U#X(V-{Q(V#YR-{(WQ-X'WR2j-XQ.p(wS3e.p3fR3f.qQ-`'^R2n-`Y!rQ'^-`1g5qR'h!rQ.{)cR3z.{U#_W%g*WU(]#_(^-|Q(^#`R-|(XQ-['ZR2l-[t`OXst!V!Z#d%l&g&i&p&r&s&u,n,s2S2VS#hZ%dU#r`#h.VR.V(hQ(i#jQ.S(eW.[(i.S3P6wQ3P.TR6w3QQ)l$lR/R)lQ$phR)r$pQ$`cU)_$`-w<[Q-w;xR<[)oQ/l*ZW4Y/l4Z7j9hU4Z/m/n/oS7j4[4]R9h7k$e*O$v(s)a)c*Y*b*q*r*|*}+R.g.h.j.k.l/Y/b/d/f/q/v0^0_0p1]3^3_3`3u3y4S4^4_4c4s4u4{4|4}5h7R7S7T7U7Z7[7^7_7`7f7m7p7z7}8P9]9^9_9i9q9v9w:h:i:j:k:l:q:u;W;];h;k=b=n=o=z={Q/t*bU4b/t4d7nQ4d/vR7n4cS*l$|*XR0S*lx*Q$v)c*q*r+R/q0^0_3y4^4{4|4}7f7z9v:l=b=n=o!d.e(s)a*Y*b.g.h.l/Y/f/v0p1]3`4S4_4c5h7R7U7m7p7}8P9i9q9w:q:u;W;];h=z={U/c*Q.e7Xa7X3u7Z7[7`9]:h:k;kQ0Z*qQ3a.gU4t0Z3a9`R9`7Z|*S$v)c*q*r+R/b/q0^0_3y4^4s4{4|4}7f7z9v:l=b=n=o!h.f(s)a*Y*b.g.h.l/Y/f/v0p1]3^3`4S4_4c5h7R7S7U7m7p7}8P9i9q9w:q:u;W;];h=z={U/e*S.f7Ye7Y3u7Z7[7`9]9^:h:i:k;kQ0]*rQ3b.hU4v0]3b9aR9a7[Q*w%UR0a*wQ5S0pR8O5SQ+[%jR0o+[Q5l1bS8_5l:OR:O8`Q,V&]R1e,VQ5q1gR8b5qQ1s,aS6R1s8oR8o6TQ1O+oW5_1O5a8V9zQ5a1RQ8V5`R9z8WQ+t&PR1U+tQ2V,sR6c2VYrOXst#dQ&t!ZQ+^%lQ,m&pQ,o&rQ,p&sQ,r&uQ2Q,nS2T,s2VR6b2SQ%npQ&x!_Q&{!aQ&}!bQ'P!cQ'o!uQ+]%kQ+i%yQ+{&VQ,c&kQ,z&zW-k'i'q'r'uQ-r'mQ0R*kQ0y+jS1v,d,gQ2_,yQ2`,|Q2a,}Q2u-jW2w-m-n-q-sQ5W0zQ5d1XQ5g1]Q5{1mQ6V1xQ6a2RU6p2v2y2|Q6s2zQ8R5XQ8Z5fQ8[5hQ8a5pQ8j5|Q8p6US9P6q6uQ9R6tQ9{8XQ:U8kQ:Z8qQ:b9QQ:x9|Q;O:VQ;S:cR;a;PQ%yyQ'b!iQ'm!uU+j%z%{%|Q-R'TU-f'c'd'eS-j'i'sQ/z*gS0z+k+lQ2g-TS2s-g-hQ2z-oS4g/{0OQ5X0{Q6l2mQ6o2tQ6t2{U7q4i4j4mQ9o7sR:r9pS$wi=pR*x%VU%Ui%V=pR0`*vQ$viS(s#v+fS)a$b$cQ)c$dQ*Y$xS*b${*WQ*q%OQ*r%QQ*|%]Q*}%^Q+R%bQ.g<aQ.h<cQ.j<gQ.k<iQ.l<kQ/Y)wQ/b*PQ/d*RQ/f*TQ/q*^S/v*d/hQ0^*tQ0_*ul0p+c,Q.a1a1i3Z5x6|8f9V:S:f:};VQ1]+}Q3^<tQ3_<vQ3`<yS3u<^<_Q3y.zS4S/_4UQ4^/rQ4_/sQ4c/uQ4s0YQ4u0[Q4{0gQ4|0hQ4}0iQ5h1^Q7R<}Q7S=PQ7T=RQ7U=TQ7Z<bQ7[<dQ7^<hQ7_<jQ7`<lQ7f4VQ7m4aQ7p4fQ7z4wQ7}5RQ8P5UQ9]<zQ9^<uQ9_<wQ9i7lQ9q7vQ9v7|Q9w8QQ:h=OQ:i=QQ:j=SQ:k=UQ:l9eQ:q9nQ:u9tQ;W=XQ;]:tQ;h;^Q;k=YQ=b=pQ=n=xQ=o=yQ=z=|R={=}Q*z%[Q.i<eR7]<fnpOXst!Z#d%l&p&r&s&u,n,s2S2VQ!fPS#fZ#oQ&z!`W'f!o*f0V4qQ'}#SQ)O#{Q)p$nS,g&i&lQ,l&mQ,y&yS-O'R/iQ-b'`Q.s(|Q/V)qQ0m+YQ0s+dQ2O,kQ2q-dQ3X.bQ4O/QQ4y0dQ5v1jQ6X1zQ6Y1{Q6^1}Q6`2PQ6e2XQ7P3[Q7c3{Q8h5yQ8t6ZQ8u6[Q8w6_Q9Z7QQ:T8iR:_8x#[cOPXZst!Z!`!o#d#o#{%l&i&l&m&p&r&s&u&y'R'`(|*f+Y+d,k,n,s-d.b/i0V0d1j1z1{1}2P2S2V2X3[4q5y6Z6[6_7Q8i8xQ#YWQ#eYQ%puQ%rvS%tw!gS(Q#W(TQ(W#ZQ(r#uQ(w#xQ)P$OQ)Q$PQ)R$QQ)S$RQ)T$SQ)U$TQ)V$UQ)W$VQ)X$WQ)Y$XQ)[$ZQ)^$_Q)`$aQ)e$eW)o$n)q/Q3{Q+a%sQ+u&QS-U'V2hQ-s'pS-x(R-zQ-}(ZQ.P(bQ.n(vQ.q(xQ.u;vQ.w;yQ.x;zQ.y;}Q/]){Q0j+UQ2c-PQ2f-SQ2v-lQ2}.QQ3c.oQ3h<OQ3i<PQ3j<QQ3k<RQ3l<SQ3m<TQ3n<UQ3o<VQ3p<WQ3q<XQ3r<YQ3s.vQ3t<]Q3w<`Q3x<mQ4P<ZQ5O0lQ5Y0|Q6k<pQ6q2xQ6v3OQ7V3dQ7W<qQ7a<sQ7b<{Q8`5mQ8|6iQ9Q6rQ9[<|Q9b=VQ9c=WQ:c9SQ:y9}Q;R:aQ;x#SR=g=sR#[WR'X!el!tQ!r!v!y!z'^'j'k'l-`-p1g5q5sS'T!e-WU*g$|*X*lS-T'U']S0O*h*nQ0W*oQ2m-^Q4m0UR4r0XR(y#xQ!fQT-_'^-`]!qQ!r'^-`1g5qQ#p]R'g;wR)d$dY!uQ'^-`1g5qQ'i!rS's!v!yS'u!z5sS-o'j'kQ-q'lR2{-pT#kZ%dS#jZ%dS%jm,jU(e#h#i#lS.T(f(gQ.X(hQ0n+ZQ3Q.UU3R.V.W.YS6x3S3TR9T6yd#^W#W#Z%g(R([*W+W.O/hr#gZm#h#i#l%d(f(g(h+Z.U.V.W.Y3S3T6yS*Z$x*_Q/o*[Q1|,jQ2d-QQ4W/kQ6g2[Q7i4XQ8{6hT=_'V+XV#aW%g*WU#`W%g*WS(S#W([U(X#Z+W/hS-V'V+XT-y(R.OV'[!e%h*XQ$lfR)v$qT)k$l)lR3}/PT*]$x*_T*e${*WQ0q+cQ1_,QQ3V.aQ5j1aQ5u1iQ6}3ZQ8g5xQ9W6|Q:Q8fQ:d9VQ:|:SQ;U:fQ;`:}R;c;VnqOXst!Z#d%l&p&r&s&u,n,s2S2VQ&j!VR,c&gtmOXst!U!V!Z#d%l&g&p&r&s&u,n,s2S2VR,j&mT%km,jR1c,SR,b&eQ&T|R+z&UR+p&OT&n!W&qT&o!W&qT2U,s2V",nodeNames:"⚠ ArithOp ArithOp ?. JSXStartTag LineComment BlockComment Script Hashbang ExportDeclaration export Star as VariableName String Escape from ; default FunctionDeclaration async function VariableDefinition > < TypeParamList in out const TypeDefinition extends ThisType this LiteralType ArithOp Number BooleanLiteral TemplateType InterpolationEnd Interpolation InterpolationStart NullType null VoidType void TypeofType typeof MemberExpression . PropertyName [ TemplateString Escape Interpolation super RegExp ] ArrayExpression Spread , } { ObjectExpression Property async get set PropertyDefinition Block : NewTarget new NewExpression ) ( ArgList UnaryExpression delete LogicOp BitOp YieldExpression yield AwaitExpression await ParenthesizedExpression ClassExpression class ClassBody MethodDeclaration Decorator @ MemberExpression PrivatePropertyName CallExpression TypeArgList CompareOp < declare Privacy static abstract override PrivatePropertyDefinition PropertyDeclaration readonly accessor Optional TypeAnnotation Equals StaticBlock FunctionExpression ArrowFunction ParamList ParamList ArrayPattern ObjectPattern PatternProperty Privacy readonly Arrow MemberExpression BinaryExpression ArithOp ArithOp ArithOp ArithOp BitOp CompareOp instanceof satisfies CompareOp BitOp BitOp BitOp LogicOp LogicOp ConditionalExpression LogicOp LogicOp AssignmentExpression UpdateOp PostfixExpression CallExpression InstantiationExpression TaggedTemplateExpression DynamicImport import ImportMeta JSXElement JSXSelfCloseEndTag JSXSelfClosingTag JSXIdentifier JSXBuiltin JSXIdentifier JSXNamespacedName JSXMemberExpression JSXSpreadAttribute JSXAttribute JSXAttributeValue JSXEscape JSXEndTag JSXOpenTag JSXFragmentTag JSXText JSXEscape JSXStartCloseTag JSXCloseTag PrefixCast < ArrowFunction TypeParamList SequenceExpression InstantiationExpression KeyofType keyof UniqueType unique ImportType InferredType infer TypeName ParenthesizedType FunctionSignature ParamList NewSignature IndexedType TupleType Label ArrayType ReadonlyType ObjectType MethodType PropertyType IndexSignature PropertyDefinition CallSignature TypePredicate asserts is NewSignature new UnionType LogicOp IntersectionType LogicOp ConditionalType ParameterizedType ClassDeclaration abstract implements type VariableDeclaration let var using TypeAliasDeclaration InterfaceDeclaration interface EnumDeclaration enum EnumBody NamespaceDeclaration namespace module AmbientDeclaration declare GlobalDeclaration global ClassDeclaration ClassBody AmbientFunctionDeclaration ExportGroup VariableName VariableName ImportDeclaration ImportGroup ForStatement for ForSpec ForInSpec ForOfSpec of WhileStatement while WithStatement with DoStatement do IfStatement if else SwitchStatement switch SwitchBody CaseLabel case DefaultLabel TryStatement try CatchClause catch FinallyClause finally ReturnStatement return ThrowStatement throw BreakStatement break ContinueStatement continue DebuggerStatement debugger LabeledStatement ExpressionStatement SingleExpression SingleClassItem",maxTerm:379,context:nue,nodeProps:[["isolate",-8,5,6,14,37,39,51,53,55,""],["group",-26,9,17,19,68,207,211,215,216,218,221,224,234,236,242,244,246,248,251,257,263,265,267,269,271,273,274,"Statement",-34,13,14,32,35,36,42,51,54,55,57,62,70,72,76,80,82,84,85,110,111,120,121,136,139,141,142,143,144,145,147,148,167,169,171,"Expression",-23,31,33,37,41,43,45,173,175,177,178,180,181,182,184,185,186,188,189,190,201,203,205,206,"Type",-3,88,103,109,"ClassItem"],["openedBy",23,"<",38,"InterpolationStart",56,"[",60,"{",73,"(",160,"JSXStartCloseTag"],["closedBy",-2,24,168,">",40,"InterpolationEnd",50,"]",61,"}",74,")",165,"JSXEndTag"]],propSources:[cue],skippedNodes:[0,5,6,277],repeatNodeCount:37,tokenData:"$Fq07[R!bOX%ZXY+gYZ-yZ[+g[]%Z]^.c^p%Zpq+gqr/mrs3cst:_tuEruvJSvwLkwx! Yxy!'iyz!(sz{!)}{|!,q|}!.O}!O!,q!O!P!/Y!P!Q!9j!Q!R#:O!R![#<_![!]#I_!]!^#Jk!^!_#Ku!_!`$![!`!a$$v!a!b$*T!b!c$,r!c!}Er!}#O$-|#O#P$/W#P#Q$4o#Q#R$5y#R#SEr#S#T$7W#T#o$8b#o#p$<r#p#q$=h#q#r$>x#r#s$@U#s$f%Z$f$g+g$g#BYEr#BY#BZ$A`#BZ$ISEr$IS$I_$A`$I_$I|Er$I|$I}$Dk$I}$JO$Dk$JO$JTEr$JT$JU$A`$JU$KVEr$KV$KW$A`$KW&FUEr&FU&FV$A`&FV;'SEr;'S;=`I|<%l?HTEr?HT?HU$A`?HUOEr(n%d_$i&j(Vp(Y!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z&j&hT$i&jO!^&c!_#o&c#p;'S&c;'S;=`&w<%lO&c&j&zP;=`<%l&c'|'U]$i&j(Y!bOY&}YZ&cZw&}wx&cx!^&}!^!_'}!_#O&}#O#P&c#P#o&}#o#p'}#p;'S&};'S;=`(l<%lO&}!b(SU(Y!bOY'}Zw'}x#O'}#P;'S'};'S;=`(f<%lO'}!b(iP;=`<%l'}'|(oP;=`<%l&}'[(y]$i&j(VpOY(rYZ&cZr(rrs&cs!^(r!^!_)r!_#O(r#O#P&c#P#o(r#o#p)r#p;'S(r;'S;=`*a<%lO(rp)wU(VpOY)rZr)rs#O)r#P;'S)r;'S;=`*Z<%lO)rp*^P;=`<%l)r'[*dP;=`<%l(r#S*nX(Vp(Y!bOY*gZr*grs'}sw*gwx)rx#O*g#P;'S*g;'S;=`+Z<%lO*g#S+^P;=`<%l*g(n+dP;=`<%l%Z07[+rq$i&j(Vp(Y!b'{0/lOX%ZXY+gYZ&cZ[+g[p%Zpq+gqr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p$f%Z$f$g+g$g#BY%Z#BY#BZ+g#BZ$IS%Z$IS$I_+g$I_$JT%Z$JT$JU+g$JU$KV%Z$KV$KW+g$KW&FU%Z&FU&FV+g&FV;'S%Z;'S;=`+a<%l?HT%Z?HT?HU+g?HUO%Z07[.ST(W#S$i&j'|0/lO!^&c!_#o&c#p;'S&c;'S;=`&w<%lO&c07[.n_$i&j(Vp(Y!b'|0/lOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z)3p/x`$i&j!p),Q(Vp(Y!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_!`0z!`#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z(KW1V`#v(Ch$i&j(Vp(Y!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_!`2X!`#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z(KW2d_#v(Ch$i&j(Vp(Y!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z'At3l_(U':f$i&j(Y!bOY4kYZ5qZr4krs7nsw4kwx5qx!^4k!^!_8p!_#O4k#O#P5q#P#o4k#o#p8p#p;'S4k;'S;=`:X<%lO4k(^4r_$i&j(Y!bOY4kYZ5qZr4krs7nsw4kwx5qx!^4k!^!_8p!_#O4k#O#P5q#P#o4k#o#p8p#p;'S4k;'S;=`:X<%lO4k&z5vX$i&jOr5qrs6cs!^5q!^!_6y!_#o5q#o#p6y#p;'S5q;'S;=`7h<%lO5q&z6jT$d`$i&jO!^&c!_#o&c#p;'S&c;'S;=`&w<%lO&c`6|TOr6yrs7]s;'S6y;'S;=`7b<%lO6y`7bO$d``7eP;=`<%l6y&z7kP;=`<%l5q(^7w]$d`$i&j(Y!bOY&}YZ&cZw&}wx&cx!^&}!^!_'}!_#O&}#O#P&c#P#o&}#o#p'}#p;'S&};'S;=`(l<%lO&}!r8uZ(Y!bOY8pYZ6yZr8prs9hsw8pwx6yx#O8p#O#P6y#P;'S8p;'S;=`:R<%lO8p!r9oU$d`(Y!bOY'}Zw'}x#O'}#P;'S'};'S;=`(f<%lO'}!r:UP;=`<%l8p(^:[P;=`<%l4k%9[:hh$i&j(Vp(Y!bOY%ZYZ&cZq%Zqr<Srs&}st%ZtuCruw%Zwx(rx!^%Z!^!_*g!_!c%Z!c!}Cr!}#O%Z#O#P&c#P#R%Z#R#SCr#S#T%Z#T#oCr#o#p*g#p$g%Z$g;'SCr;'S;=`El<%lOCr(r<__WS$i&j(Vp(Y!bOY<SYZ&cZr<Srs=^sw<Swx@nx!^<S!^!_Bm!_#O<S#O#P>`#P#o<S#o#pBm#p;'S<S;'S;=`Cl<%lO<S(Q=g]WS$i&j(Y!bOY=^YZ&cZw=^wx>`x!^=^!^!_?q!_#O=^#O#P>`#P#o=^#o#p?q#p;'S=^;'S;=`@h<%lO=^&n>gXWS$i&jOY>`YZ&cZ!^>`!^!_?S!_#o>`#o#p?S#p;'S>`;'S;=`?k<%lO>`S?XSWSOY?SZ;'S?S;'S;=`?e<%lO?SS?hP;=`<%l?S&n?nP;=`<%l>`!f?xWWS(Y!bOY?qZw?qwx?Sx#O?q#O#P?S#P;'S?q;'S;=`@b<%lO?q!f@eP;=`<%l?q(Q@kP;=`<%l=^'`@w]WS$i&j(VpOY@nYZ&cZr@nrs>`s!^@n!^!_Ap!_#O@n#O#P>`#P#o@n#o#pAp#p;'S@n;'S;=`Bg<%lO@ntAwWWS(VpOYApZrAprs?Ss#OAp#O#P?S#P;'SAp;'S;=`Ba<%lOAptBdP;=`<%lAp'`BjP;=`<%l@n#WBvYWS(Vp(Y!bOYBmZrBmrs?qswBmwxApx#OBm#O#P?S#P;'SBm;'S;=`Cf<%lOBm#WCiP;=`<%lBm(rCoP;=`<%l<S%9[C}i$i&j(n%1l(Vp(Y!bOY%ZYZ&cZr%Zrs&}st%ZtuCruw%Zwx(rx!Q%Z!Q![Cr![!^%Z!^!_*g!_!c%Z!c!}Cr!}#O%Z#O#P&c#P#R%Z#R#SCr#S#T%Z#T#oCr#o#p*g#p$g%Z$g;'SCr;'S;=`El<%lOCr%9[EoP;=`<%lCr07[FRk$i&j(Vp(Y!b$]#t(S,2j(d$I[OY%ZYZ&cZr%Zrs&}st%ZtuEruw%Zwx(rx}%Z}!OGv!O!Q%Z!Q![Er![!^%Z!^!_*g!_!c%Z!c!}Er!}#O%Z#O#P&c#P#R%Z#R#SEr#S#T%Z#T#oEr#o#p*g#p$g%Z$g;'SEr;'S;=`I|<%lOEr+dHRk$i&j(Vp(Y!b$]#tOY%ZYZ&cZr%Zrs&}st%ZtuGvuw%Zwx(rx}%Z}!OGv!O!Q%Z!Q![Gv![!^%Z!^!_*g!_!c%Z!c!}Gv!}#O%Z#O#P&c#P#R%Z#R#SGv#S#T%Z#T#oGv#o#p*g#p$g%Z$g;'SGv;'S;=`Iv<%lOGv+dIyP;=`<%lGv07[JPP;=`<%lEr(KWJ_`$i&j(Vp(Y!b#p(ChOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_!`Ka!`#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z(KWKl_$i&j$Q(Ch(Vp(Y!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z,#xLva(y+JY$i&j(Vp(Y!bOY%ZYZ&cZr%Zrs&}sv%ZvwM{wx(rx!^%Z!^!_*g!_!`Ka!`#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z(KWNW`$i&j#z(Ch(Vp(Y!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_!`Ka!`#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z'At! c_(X';W$i&j(VpOY!!bYZ!#hZr!!brs!#hsw!!bwx!$xx!^!!b!^!_!%z!_#O!!b#O#P!#h#P#o!!b#o#p!%z#p;'S!!b;'S;=`!'c<%lO!!b'l!!i_$i&j(VpOY!!bYZ!#hZr!!brs!#hsw!!bwx!$xx!^!!b!^!_!%z!_#O!!b#O#P!#h#P#o!!b#o#p!%z#p;'S!!b;'S;=`!'c<%lO!!b&z!#mX$i&jOw!#hwx6cx!^!#h!^!_!$Y!_#o!#h#o#p!$Y#p;'S!#h;'S;=`!$r<%lO!#h`!$]TOw!$Ywx7]x;'S!$Y;'S;=`!$l<%lO!$Y`!$oP;=`<%l!$Y&z!$uP;=`<%l!#h'l!%R]$d`$i&j(VpOY(rYZ&cZr(rrs&cs!^(r!^!_)r!_#O(r#O#P&c#P#o(r#o#p)r#p;'S(r;'S;=`*a<%lO(r!Q!&PZ(VpOY!%zYZ!$YZr!%zrs!$Ysw!%zwx!&rx#O!%z#O#P!$Y#P;'S!%z;'S;=`!']<%lO!%z!Q!&yU$d`(VpOY)rZr)rs#O)r#P;'S)r;'S;=`*Z<%lO)r!Q!'`P;=`<%l!%z'l!'fP;=`<%l!!b/5|!'t_!l/.^$i&j(Vp(Y!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z#&U!)O_!k!Lf$i&j(Vp(Y!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z-!n!*[b$i&j(Vp(Y!b(T%&f#q(ChOY%ZYZ&cZr%Zrs&}sw%Zwx(rxz%Zz{!+d{!^%Z!^!_*g!_!`Ka!`#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z(KW!+o`$i&j(Vp(Y!b#n(ChOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_!`Ka!`#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z+;x!,|`$i&j(Vp(Y!br+4YOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_!`Ka!`#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z,$U!.Z_!]+Jf$i&j(Vp(Y!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z07[!/ec$i&j(Vp(Y!b!Q.2^OY%ZYZ&cZr%Zrs&}sw%Zwx(rx!O%Z!O!P!0p!P!Q%Z!Q![!3Y![!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z#%|!0ya$i&j(Vp(Y!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!O%Z!O!P!2O!P!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z#%|!2Z_![!L^$i&j(Vp(Y!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z'Ad!3eg$i&j(Vp(Y!bs'9tOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!Q%Z!Q![!3Y![!^%Z!^!_*g!_!g%Z!g!h!4|!h#O%Z#O#P&c#P#R%Z#R#S!3Y#S#X%Z#X#Y!4|#Y#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z'Ad!5Vg$i&j(Vp(Y!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx{%Z{|!6n|}%Z}!O!6n!O!Q%Z!Q![!8S![!^%Z!^!_*g!_#O%Z#O#P&c#P#R%Z#R#S!8S#S#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z'Ad!6wc$i&j(Vp(Y!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!Q%Z!Q![!8S![!^%Z!^!_*g!_#O%Z#O#P&c#P#R%Z#R#S!8S#S#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z'Ad!8_c$i&j(Vp(Y!bs'9tOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!Q%Z!Q![!8S![!^%Z!^!_*g!_#O%Z#O#P&c#P#R%Z#R#S!8S#S#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z07[!9uf$i&j(Vp(Y!b#o(ChOY!;ZYZ&cZr!;Zrs!<nsw!;Zwx!Lcxz!;Zz{#-}{!P!;Z!P!Q#/d!Q!^!;Z!^!_#(i!_!`#7S!`!a#8i!a!}!;Z!}#O#,f#O#P!Dy#P#o!;Z#o#p#(i#p;'S!;Z;'S;=`#-w<%lO!;Z?O!;fb$i&j(Vp(Y!b!X7`OY!;ZYZ&cZr!;Zrs!<nsw!;Zwx!Lcx!P!;Z!P!Q#&`!Q!^!;Z!^!_#(i!_!}!;Z!}#O#,f#O#P!Dy#P#o!;Z#o#p#(i#p;'S!;Z;'S;=`#-w<%lO!;Z>^!<w`$i&j(Y!b!X7`OY!<nYZ&cZw!<nwx!=yx!P!<n!P!Q!Eq!Q!^!<n!^!_!Gr!_!}!<n!}#O!KS#O#P!Dy#P#o!<n#o#p!Gr#p;'S!<n;'S;=`!L]<%lO!<n<z!>Q^$i&j!X7`OY!=yYZ&cZ!P!=y!P!Q!>|!Q!^!=y!^!_!@c!_!}!=y!}#O!CW#O#P!Dy#P#o!=y#o#p!@c#p;'S!=y;'S;=`!Ek<%lO!=y<z!?Td$i&j!X7`O!^&c!_#W&c#W#X!>|#X#Z&c#Z#[!>|#[#]&c#]#^!>|#^#a&c#a#b!>|#b#g&c#g#h!>|#h#i&c#i#j!>|#j#k!>|#k#m&c#m#n!>|#n#o&c#p;'S&c;'S;=`&w<%lO&c7`!@hX!X7`OY!@cZ!P!@c!P!Q!AT!Q!}!@c!}#O!Ar#O#P!Bq#P;'S!@c;'S;=`!CQ<%lO!@c7`!AYW!X7`#W#X!AT#Z#[!AT#]#^!AT#a#b!AT#g#h!AT#i#j!AT#j#k!AT#m#n!AT7`!AuVOY!ArZ#O!Ar#O#P!B[#P#Q!@c#Q;'S!Ar;'S;=`!Bk<%lO!Ar7`!B_SOY!ArZ;'S!Ar;'S;=`!Bk<%lO!Ar7`!BnP;=`<%l!Ar7`!BtSOY!@cZ;'S!@c;'S;=`!CQ<%lO!@c7`!CTP;=`<%l!@c<z!C][$i&jOY!CWYZ&cZ!^!CW!^!_!Ar!_#O!CW#O#P!DR#P#Q!=y#Q#o!CW#o#p!Ar#p;'S!CW;'S;=`!Ds<%lO!CW<z!DWX$i&jOY!CWYZ&cZ!^!CW!^!_!Ar!_#o!CW#o#p!Ar#p;'S!CW;'S;=`!Ds<%lO!CW<z!DvP;=`<%l!CW<z!EOX$i&jOY!=yYZ&cZ!^!=y!^!_!@c!_#o!=y#o#p!@c#p;'S!=y;'S;=`!Ek<%lO!=y<z!EnP;=`<%l!=y>^!Ezl$i&j(Y!b!X7`OY&}YZ&cZw&}wx&cx!^&}!^!_'}!_#O&}#O#P&c#P#W&}#W#X!Eq#X#Z&}#Z#[!Eq#[#]&}#]#^!Eq#^#a&}#a#b!Eq#b#g&}#g#h!Eq#h#i&}#i#j!Eq#j#k!Eq#k#m&}#m#n!Eq#n#o&}#o#p'}#p;'S&};'S;=`(l<%lO&}8r!GyZ(Y!b!X7`OY!GrZw!Grwx!@cx!P!Gr!P!Q!Hl!Q!}!Gr!}#O!JU#O#P!Bq#P;'S!Gr;'S;=`!J|<%lO!Gr8r!Hse(Y!b!X7`OY'}Zw'}x#O'}#P#W'}#W#X!Hl#X#Z'}#Z#[!Hl#[#]'}#]#^!Hl#^#a'}#a#b!Hl#b#g'}#g#h!Hl#h#i'}#i#j!Hl#j#k!Hl#k#m'}#m#n!Hl#n;'S'};'S;=`(f<%lO'}8r!JZX(Y!bOY!JUZw!JUwx!Arx#O!JU#O#P!B[#P#Q!Gr#Q;'S!JU;'S;=`!Jv<%lO!JU8r!JyP;=`<%l!JU8r!KPP;=`<%l!Gr>^!KZ^$i&j(Y!bOY!KSYZ&cZw!KSwx!CWx!^!KS!^!_!JU!_#O!KS#O#P!DR#P#Q!<n#Q#o!KS#o#p!JU#p;'S!KS;'S;=`!LV<%lO!KS>^!LYP;=`<%l!KS>^!L`P;=`<%l!<n=l!Ll`$i&j(Vp!X7`OY!LcYZ&cZr!Lcrs!=ys!P!Lc!P!Q!Mn!Q!^!Lc!^!_# o!_!}!Lc!}#O#%P#O#P!Dy#P#o!Lc#o#p# o#p;'S!Lc;'S;=`#&Y<%lO!Lc=l!Mwl$i&j(Vp!X7`OY(rYZ&cZr(rrs&cs!^(r!^!_)r!_#O(r#O#P&c#P#W(r#W#X!Mn#X#Z(r#Z#[!Mn#[#](r#]#^!Mn#^#a(r#a#b!Mn#b#g(r#g#h!Mn#h#i(r#i#j!Mn#j#k!Mn#k#m(r#m#n!Mn#n#o(r#o#p)r#p;'S(r;'S;=`*a<%lO(r8Q# vZ(Vp!X7`OY# oZr# ors!@cs!P# o!P!Q#!i!Q!}# o!}#O#$R#O#P!Bq#P;'S# o;'S;=`#$y<%lO# o8Q#!pe(Vp!X7`OY)rZr)rs#O)r#P#W)r#W#X#!i#X#Z)r#Z#[#!i#[#])r#]#^#!i#^#a)r#a#b#!i#b#g)r#g#h#!i#h#i)r#i#j#!i#j#k#!i#k#m)r#m#n#!i#n;'S)r;'S;=`*Z<%lO)r8Q#$WX(VpOY#$RZr#$Rrs!Ars#O#$R#O#P!B[#P#Q# o#Q;'S#$R;'S;=`#$s<%lO#$R8Q#$vP;=`<%l#$R8Q#$|P;=`<%l# o=l#%W^$i&j(VpOY#%PYZ&cZr#%Prs!CWs!^#%P!^!_#$R!_#O#%P#O#P!DR#P#Q!Lc#Q#o#%P#o#p#$R#p;'S#%P;'S;=`#&S<%lO#%P=l#&VP;=`<%l#%P=l#&]P;=`<%l!Lc?O#&kn$i&j(Vp(Y!b!X7`OY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#W%Z#W#X#&`#X#Z%Z#Z#[#&`#[#]%Z#]#^#&`#^#a%Z#a#b#&`#b#g%Z#g#h#&`#h#i%Z#i#j#&`#j#k#&`#k#m%Z#m#n#&`#n#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z9d#(r](Vp(Y!b!X7`OY#(iZr#(irs!Grsw#(iwx# ox!P#(i!P!Q#)k!Q!}#(i!}#O#+`#O#P!Bq#P;'S#(i;'S;=`#,`<%lO#(i9d#)th(Vp(Y!b!X7`OY*gZr*grs'}sw*gwx)rx#O*g#P#W*g#W#X#)k#X#Z*g#Z#[#)k#[#]*g#]#^#)k#^#a*g#a#b#)k#b#g*g#g#h#)k#h#i*g#i#j#)k#j#k#)k#k#m*g#m#n#)k#n;'S*g;'S;=`+Z<%lO*g9d#+gZ(Vp(Y!bOY#+`Zr#+`rs!JUsw#+`wx#$Rx#O#+`#O#P!B[#P#Q#(i#Q;'S#+`;'S;=`#,Y<%lO#+`9d#,]P;=`<%l#+`9d#,cP;=`<%l#(i?O#,o`$i&j(Vp(Y!bOY#,fYZ&cZr#,frs!KSsw#,fwx#%Px!^#,f!^!_#+`!_#O#,f#O#P!DR#P#Q!;Z#Q#o#,f#o#p#+`#p;'S#,f;'S;=`#-q<%lO#,f?O#-tP;=`<%l#,f?O#-zP;=`<%l!;Z07[#.[b$i&j(Vp(Y!b'}0/l!X7`OY!;ZYZ&cZr!;Zrs!<nsw!;Zwx!Lcx!P!;Z!P!Q#&`!Q!^!;Z!^!_#(i!_!}!;Z!}#O#,f#O#P!Dy#P#o!;Z#o#p#(i#p;'S!;Z;'S;=`#-w<%lO!;Z07[#/o_$i&j(Vp(Y!bT0/lOY#/dYZ&cZr#/drs#0nsw#/dwx#4Ox!^#/d!^!_#5}!_#O#/d#O#P#1p#P#o#/d#o#p#5}#p;'S#/d;'S;=`#6|<%lO#/d06j#0w]$i&j(Y!bT0/lOY#0nYZ&cZw#0nwx#1px!^#0n!^!_#3R!_#O#0n#O#P#1p#P#o#0n#o#p#3R#p;'S#0n;'S;=`#3x<%lO#0n05W#1wX$i&jT0/lOY#1pYZ&cZ!^#1p!^!_#2d!_#o#1p#o#p#2d#p;'S#1p;'S;=`#2{<%lO#1p0/l#2iST0/lOY#2dZ;'S#2d;'S;=`#2u<%lO#2d0/l#2xP;=`<%l#2d05W#3OP;=`<%l#1p01O#3YW(Y!bT0/lOY#3RZw#3Rwx#2dx#O#3R#O#P#2d#P;'S#3R;'S;=`#3r<%lO#3R01O#3uP;=`<%l#3R06j#3{P;=`<%l#0n05x#4X]$i&j(VpT0/lOY#4OYZ&cZr#4Ors#1ps!^#4O!^!_#5Q!_#O#4O#O#P#1p#P#o#4O#o#p#5Q#p;'S#4O;'S;=`#5w<%lO#4O00^#5XW(VpT0/lOY#5QZr#5Qrs#2ds#O#5Q#O#P#2d#P;'S#5Q;'S;=`#5q<%lO#5Q00^#5tP;=`<%l#5Q05x#5zP;=`<%l#4O01p#6WY(Vp(Y!bT0/lOY#5}Zr#5}rs#3Rsw#5}wx#5Qx#O#5}#O#P#2d#P;'S#5};'S;=`#6v<%lO#5}01p#6yP;=`<%l#5}07[#7PP;=`<%l#/d)3h#7ab$i&j$Q(Ch(Vp(Y!b!X7`OY!;ZYZ&cZr!;Zrs!<nsw!;Zwx!Lcx!P!;Z!P!Q#&`!Q!^!;Z!^!_#(i!_!}!;Z!}#O#,f#O#P!Dy#P#o!;Z#o#p#(i#p;'S!;Z;'S;=`#-w<%lO!;ZAt#8vb$Z#t$i&j(Vp(Y!b!X7`OY!;ZYZ&cZr!;Zrs!<nsw!;Zwx!Lcx!P!;Z!P!Q#&`!Q!^!;Z!^!_#(i!_!}!;Z!}#O#,f#O#P!Dy#P#o!;Z#o#p#(i#p;'S!;Z;'S;=`#-w<%lO!;Z'Ad#:Zp$i&j(Vp(Y!bs'9tOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!O%Z!O!P!3Y!P!Q%Z!Q![#<_![!^%Z!^!_*g!_!g%Z!g!h!4|!h#O%Z#O#P&c#P#R%Z#R#S#<_#S#U%Z#U#V#?i#V#X%Z#X#Y!4|#Y#b%Z#b#c#>_#c#d#Bq#d#l%Z#l#m#Es#m#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z'Ad#<jk$i&j(Vp(Y!bs'9tOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!O%Z!O!P!3Y!P!Q%Z!Q![#<_![!^%Z!^!_*g!_!g%Z!g!h!4|!h#O%Z#O#P&c#P#R%Z#R#S#<_#S#X%Z#X#Y!4|#Y#b%Z#b#c#>_#c#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z'Ad#>j_$i&j(Vp(Y!bs'9tOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z'Ad#?rd$i&j(Vp(Y!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!Q%Z!Q!R#AQ!R!S#AQ!S!^%Z!^!_*g!_#O%Z#O#P&c#P#R%Z#R#S#AQ#S#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z'Ad#A]f$i&j(Vp(Y!bs'9tOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!Q%Z!Q!R#AQ!R!S#AQ!S!^%Z!^!_*g!_#O%Z#O#P&c#P#R%Z#R#S#AQ#S#b%Z#b#c#>_#c#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z'Ad#Bzc$i&j(Vp(Y!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!Q%Z!Q!Y#DV!Y!^%Z!^!_*g!_#O%Z#O#P&c#P#R%Z#R#S#DV#S#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z'Ad#Dbe$i&j(Vp(Y!bs'9tOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!Q%Z!Q!Y#DV!Y!^%Z!^!_*g!_#O%Z#O#P&c#P#R%Z#R#S#DV#S#b%Z#b#c#>_#c#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z'Ad#E|g$i&j(Vp(Y!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!Q%Z!Q![#Ge![!^%Z!^!_*g!_!c%Z!c!i#Ge!i#O%Z#O#P&c#P#R%Z#R#S#Ge#S#T%Z#T#Z#Ge#Z#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z'Ad#Gpi$i&j(Vp(Y!bs'9tOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!Q%Z!Q![#Ge![!^%Z!^!_*g!_!c%Z!c!i#Ge!i#O%Z#O#P&c#P#R%Z#R#S#Ge#S#T%Z#T#Z#Ge#Z#b%Z#b#c#>_#c#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z*)x#Il_!g$b$i&j$O)Lv(Vp(Y!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z)[#Jv_al$i&j(Vp(Y!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z04f#LS^h#)`#R-<U(Vp(Y!b$n7`OY*gZr*grs'}sw*gwx)rx!P*g!P!Q#MO!Q!^*g!^!_#Mt!_!`$ f!`#O*g#P;'S*g;'S;=`+Z<%lO*g(n#MXX$k&j(Vp(Y!bOY*gZr*grs'}sw*gwx)rx#O*g#P;'S*g;'S;=`+Z<%lO*g(El#M}Z#r(Ch(Vp(Y!bOY*gZr*grs'}sw*gwx)rx!_*g!_!`#Np!`#O*g#P;'S*g;'S;=`+Z<%lO*g(El#NyX$Q(Ch(Vp(Y!bOY*gZr*grs'}sw*gwx)rx#O*g#P;'S*g;'S;=`+Z<%lO*g(El$ oX#s(Ch(Vp(Y!bOY*gZr*grs'}sw*gwx)rx#O*g#P;'S*g;'S;=`+Z<%lO*g*)x$!ga#`*!Y$i&j(Vp(Y!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_!`0z!`!a$#l!a#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z(K[$#w_#k(Cl$i&j(Vp(Y!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z*)x$%Vag!*r#s(Ch$f#|$i&j(Vp(Y!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_!`$&[!`!a$'f!a#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z(KW$&g_#s(Ch$i&j(Vp(Y!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z(KW$'qa#r(Ch$i&j(Vp(Y!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_!`Ka!`!a$(v!a#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z(KW$)R`#r(Ch$i&j(Vp(Y!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_!`Ka!`#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z(Kd$*`a(q(Ct$i&j(Vp(Y!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_!a%Z!a!b$+e!b#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z(KW$+p`$i&j#{(Ch(Vp(Y!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_!`Ka!`#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z%#`$,}_!|$Ip$i&j(Vp(Y!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z04f$.X_!S0,v$i&j(Vp(Y!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z(n$/]Z$i&jO!^$0O!^!_$0f!_#i$0O#i#j$0k#j#l$0O#l#m$2^#m#o$0O#o#p$0f#p;'S$0O;'S;=`$4i<%lO$0O(n$0VT_#S$i&jO!^&c!_#o&c#p;'S&c;'S;=`&w<%lO&c#S$0kO_#S(n$0p[$i&jO!Q&c!Q![$1f![!^&c!_!c&c!c!i$1f!i#T&c#T#Z$1f#Z#o&c#o#p$3|#p;'S&c;'S;=`&w<%lO&c(n$1kZ$i&jO!Q&c!Q![$2^![!^&c!_!c&c!c!i$2^!i#T&c#T#Z$2^#Z#o&c#p;'S&c;'S;=`&w<%lO&c(n$2cZ$i&jO!Q&c!Q![$3U![!^&c!_!c&c!c!i$3U!i#T&c#T#Z$3U#Z#o&c#p;'S&c;'S;=`&w<%lO&c(n$3ZZ$i&jO!Q&c!Q![$0O![!^&c!_!c&c!c!i$0O!i#T&c#T#Z$0O#Z#o&c#p;'S&c;'S;=`&w<%lO&c#S$4PR!Q![$4Y!c!i$4Y#T#Z$4Y#S$4]S!Q![$4Y!c!i$4Y#T#Z$4Y#q#r$0f(n$4lP;=`<%l$0O#1[$4z_!Y#)l$i&j(Vp(Y!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z(KW$6U`#x(Ch$i&j(Vp(Y!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_!`Ka!`#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z+;p$7c_$i&j(Vp(Y!b(`+4QOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z07[$8qk$i&j(Vp(Y!b(S,2j$_#t(d$I[OY%ZYZ&cZr%Zrs&}st%Ztu$8buw%Zwx(rx}%Z}!O$:f!O!Q%Z!Q![$8b![!^%Z!^!_*g!_!c%Z!c!}$8b!}#O%Z#O#P&c#P#R%Z#R#S$8b#S#T%Z#T#o$8b#o#p*g#p$g%Z$g;'S$8b;'S;=`$<l<%lO$8b+d$:qk$i&j(Vp(Y!b$_#tOY%ZYZ&cZr%Zrs&}st%Ztu$:fuw%Zwx(rx}%Z}!O$:f!O!Q%Z!Q![$:f![!^%Z!^!_*g!_!c%Z!c!}$:f!}#O%Z#O#P&c#P#R%Z#R#S$:f#S#T%Z#T#o$:f#o#p*g#p$g%Z$g;'S$:f;'S;=`$<f<%lO$:f+d$<iP;=`<%l$:f07[$<oP;=`<%l$8b#Jf$<{X!_#Hb(Vp(Y!bOY*gZr*grs'}sw*gwx)rx#O*g#P;'S*g;'S;=`+Z<%lO*g,#x$=sa(x+JY$i&j(Vp(Y!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_!`Ka!`#O%Z#O#P&c#P#o%Z#o#p*g#p#q$+e#q;'S%Z;'S;=`+a<%lO%Z)>v$?V_!^(CdvBr$i&j(Vp(Y!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z?O$@a_!q7`$i&j(Vp(Y!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z07[$Aq|$i&j(Vp(Y!b'{0/l$]#t(S,2j(d$I[OX%ZXY+gYZ&cZ[+g[p%Zpq+gqr%Zrs&}st%ZtuEruw%Zwx(rx}%Z}!OGv!O!Q%Z!Q![Er![!^%Z!^!_*g!_!c%Z!c!}Er!}#O%Z#O#P&c#P#R%Z#R#SEr#S#T%Z#T#oEr#o#p*g#p$f%Z$f$g+g$g#BYEr#BY#BZ$A`#BZ$ISEr$IS$I_$A`$I_$JTEr$JT$JU$A`$JU$KVEr$KV$KW$A`$KW&FUEr&FU&FV$A`&FV;'SEr;'S;=`I|<%l?HTEr?HT?HU$A`?HUOEr07[$D|k$i&j(Vp(Y!b'|0/l$]#t(S,2j(d$I[OY%ZYZ&cZr%Zrs&}st%ZtuEruw%Zwx(rx}%Z}!OGv!O!Q%Z!Q![Er![!^%Z!^!_*g!_!c%Z!c!}Er!}#O%Z#O#P&c#P#R%Z#R#SEr#S#T%Z#T#oEr#o#p*g#p$g%Z$g;'SEr;'S;=`I|<%lOEr",tokenizers:[rue,oue,lue,aue,2,3,4,5,6,7,8,9,10,11,12,13,14,sue,new ap("$S~RRtu[#O#Pg#S#T#|~_P#o#pb~gOx~~jVO#i!P#i#j!U#j#l!P#l#m!q#m;'S!P;'S;=`#v<%lO!P~!UO!U~~!XS!Q![!e!c!i!e#T#Z!e#o#p#Z~!hR!Q![!q!c!i!q#T#Z!q~!tR!Q![!}!c!i!}#T#Z!}~#QR!Q![!P!c!i!P#T#Z!P~#^R!Q![#g!c!i#g#T#Z#g~#jS!Q![#g!c!i#g#T#Z#g#q#r!P~#yP;=`<%l!P~$RO(b~~",141,339),new ap("j~RQYZXz{^~^O(P~~aP!P!Qd~iO(Q~~",25,322)],topRules:{Script:[0,7],SingleExpression:[1,275],SingleClassItem:[2,276]},dialects:{jsx:0,ts:15098},dynamicPrecedences:{80:1,82:1,94:1,169:1,199:1},specialized:[{term:326,get:s=>uue[s]||-1},{term:342,get:s=>hue[s]||-1},{term:95,get:s=>due[s]||-1}],tokenPrec:15124}),NV=[fn("function ${name}(${params}) {\n	${}\n}",{label:"function",detail:"definition",type:"keyword"}),fn("for (let ${index} = 0; ${index} < ${bound}; ${index}++) {\n	${}\n}",{label:"for",detail:"loop",type:"keyword"}),fn("for (let ${name} of ${collection}) {\n	${}\n}",{label:"for",detail:"of loop",type:"keyword"}),fn("do {\n	${}\n} while (${})",{label:"do",detail:"loop",type:"keyword"}),fn("while (${}) {\n	${}\n}",{label:"while",detail:"loop",type:"keyword"}),fn(`try {
	\${}
} catch (\${error}) {
	\${}
}`,{label:"try",detail:"/ catch block",type:"keyword"}),fn("if (${}) {\n	${}\n}",{label:"if",detail:"block",type:"keyword"}),fn(`if (\${}) {
	\${}
} else {
	\${}
}`,{label:"if",detail:"/ else block",type:"keyword"}),fn(`class \${name} {
	constructor(\${params}) {
		\${}
	}
}`,{label:"class",detail:"definition",type:"keyword"}),fn('import {${names}} from "${module}"\n${}',{label:"import",detail:"named",type:"keyword"}),fn('import ${name} from "${module}"\n${}',{label:"import",detail:"default",type:"keyword"})],mue=NV.concat([fn("interface ${name} {\n	${}\n}",{label:"interface",detail:"definition",type:"keyword"}),fn("type ${name} = ${type}",{label:"type",detail:"definition",type:"keyword"}),fn("enum ${name} {\n	${}\n}",{label:"enum",detail:"definition",type:"keyword"})]),CE=new hR,FV=new Set(["Script","Block","FunctionExpression","FunctionDeclaration","ArrowFunction","MethodDeclaration","ForStatement"]);function Uu(s){return(t,e)=>{let i=t.node.getChild("VariableDefinition");return i&&e(i,s),!0}}const gue=["FunctionDeclaration"],pue={FunctionDeclaration:Uu("function"),ClassDeclaration:Uu("class"),ClassExpression:()=>!0,EnumDeclaration:Uu("constant"),TypeAliasDeclaration:Uu("type"),NamespaceDeclaration:Uu("namespace"),VariableDefinition(s,t){s.matchContext(gue)||t(s,"variable")},TypeDefinition(s,t){t(s,"type")},__proto__:null};function zV(s,t){let e=CE.get(t);if(e)return e;let i=[],n=!0;function r(o,l){let a=s.sliceString(o.from,o.to);i.push({label:a,type:l})}return t.cursor(kt.IncludeAnonymous).iterate(o=>{if(n)n=!1;else if(o.name){let l=pue[o.name];if(l&&l(o,r)||FV.has(o.name))return!1}else if(o.to-o.from>8192){for(let l of zV(s,o.node))i.push(l);return!1}}),CE.set(t,i),i}const PE=/^[\w$\xa1-\uffff][\w$\d\xa1-\uffff]*$/,WV=["TemplateString","String","RegExp","LineComment","BlockComment","VariableDefinition","TypeDefinition","Label","PropertyDefinition","PropertyName","PrivatePropertyDefinition","PrivatePropertyName","JSXText","JSXAttributeValue","JSXOpenTag","JSXCloseTag","JSXSelfClosingTag",".","?."];function wue(s){let t=St(s.state).resolveInner(s.pos,-1);if(WV.indexOf(t.name)>-1)return null;let e=t.name=="VariableName"||t.to-t.from<20&&PE.test(s.state.sliceDoc(t.from,t.to));if(!e&&!s.explicit)return null;let i=[];for(let n=t;n;n=n.parent)FV.has(n.name)&&(i=i.concat(zV(s.state.doc,n)));return{options:i,from:e?t.from:s.pos,validFor:PE}}const cr=_c.define({name:"javascript",parser:fue.configure({props:[Pd.add({IfStatement:ig({except:/^\s*({|else\b)/}),TryStatement:ig({except:/^\s*({|catch\b|finally\b)/}),LabeledStatement:Mre,SwitchBody:s=>{let t=s.textAfter,e=/^\s*\}/.test(t),i=/^\s*(case|default)\b/.test(t);return s.baseIndent+(e?0:i?1:2)*s.unit},Block:Vre({closing:"}"}),ArrowFunction:s=>s.baseIndent+s.unit,"TemplateString BlockComment":()=>null,"Statement Property":ig({except:/^\s*{/}),JSXElement(s){let t=/^\s*<\//.test(s.textAfter);return s.lineIndent(s.node.from)+(t?0:s.unit)},JSXEscape(s){let t=/\s*\}/.test(s.textAfter);return s.lineIndent(s.node.from)+(t?0:s.unit)},"JSXOpenTag JSXSelfClosingTag"(s){return s.column(s.node.from)+s.unit}}),$c.add({"Block ClassBody SwitchBody EnumBody ObjectExpression ArrayExpression ObjectType":bR,BlockComment(s){return{from:s.from+2,to:s.to-2}}})]}),languageData:{closeBrackets:{brackets:["(","[","{","'",'"',"`"]},commentTokens:{line:"//",block:{open:"/*",close:"*/"}},indentOnInput:/^\s*(?:case |default:|\{|\}|<\/)$/,wordChars:"$"}}),UV={test:s=>/^JSX/.test(s.name),facet:iv({commentTokens:{block:{open:"{/*",close:"*/}"}}})},ZV=cr.configure({dialect:"ts"},"typescript"),HV=cr.configure({dialect:"jsx",props:[nv.add(s=>s.isTop?[UV]:void 0)]}),qV=cr.configure({dialect:"jsx ts",props:[nv.add(s=>s.isTop?[UV]:void 0)]},"typescript");let jV=s=>({label:s,type:"keyword"});const XV="break case const continue default delete export extends false finally in instanceof let new return static super switch this throw true typeof var yield".split(" ").map(jV),xue=XV.concat(["declare","implements","private","protected","public"].map(jV));function bue(s={}){let t=s.jsx?s.typescript?qV:HV:s.typescript?ZV:cr,e=s.typescript?mue.concat(xue):NV.concat(XV);return new Yh(t,[cr.data.of({autocomplete:yle(WV,hV(e))}),cr.data.of({autocomplete:wue}),s.jsx?vue:[]])}function Oue(s){for(;;){if(s.name=="JSXOpenTag"||s.name=="JSXSelfClosingTag"||s.name=="JSXFragmentTag")return s;if(s.name=="JSXEscape"||!s.parent)return null;s=s.parent}}function TE(s,t,e=s.length){for(let i=t==null?void 0:t.firstChild;i;i=i.nextSibling)if(i.name=="JSXIdentifier"||i.name=="JSXBuiltin"||i.name=="JSXNamespacedName"||i.name=="JSXMemberExpression")return s.sliceString(i.from,Math.min(i.to,e));return""}const yue=typeof navigator=="object"&&/Android\b/.test(navigator.userAgent),vue=Ee.inputHandler.of((s,t,e,i,n)=>{if((yue?s.composing:s.compositionStarted)||s.state.readOnly||t!=e||i!=">"&&i!="/"||!cr.isActiveAt(s.state,t,-1))return!1;let r=n(),{state:o}=r,l=o.changeByRange(a=>{var c;let{head:h}=a,f=St(o).resolveInner(h-1,-1),m;if(f.name=="JSXStartTag"&&(f=f.parent),!(o.doc.sliceString(h-1,h)!=i||f.name=="JSXAttributeValue"&&f.to>h)){if(i==">"&&f.name=="JSXFragmentTag")return{range:a,changes:{from:h,insert:"</>"}};if(i=="/"&&f.name=="JSXStartCloseTag"){let w=f.parent,O=w.parent;if(O&&w.from==h-2&&((m=TE(o.doc,O.firstChild,h))||((c=O.firstChild)===null||c===void 0?void 0:c.name)=="JSXFragmentTag")){let _=`${m}>`;return{range:se.cursor(h+_.length,-1),changes:{from:h,insert:_}}}}else if(i==">"){let w=Oue(f);if(w&&w.name=="JSXOpenTag"&&!/^\/?>|^<\//.test(o.doc.sliceString(h,h+2))&&(m=TE(o.doc,w,h)))return{range:a,changes:{from:h,insert:`</${m}>`}}}}return{range:a}});return l.changes.empty?!1:(s.dispatch([r,o.update(l,{userEvent:"input.complete",scrollIntoView:!0})]),!0)}),Zu=["_blank","_self","_top","_parent"],fb=["ascii","utf-8","utf-16","latin1","latin1"],mb=["get","post","put","delete"],gb=["application/x-www-form-urlencoded","multipart/form-data","text/plain"],Mn=["true","false"],Re={},_ue={a:{attrs:{href:null,ping:null,type:null,media:null,target:Zu,hreflang:null}},abbr:Re,address:Re,area:{attrs:{alt:null,coords:null,href:null,target:null,ping:null,media:null,hreflang:null,type:null,shape:["default","rect","circle","poly"]}},article:Re,aside:Re,audio:{attrs:{src:null,mediagroup:null,crossorigin:["anonymous","use-credentials"],preload:["none","metadata","auto"],autoplay:["autoplay"],loop:["loop"],controls:["controls"]}},b:Re,base:{attrs:{href:null,target:Zu}},bdi:Re,bdo:Re,blockquote:{attrs:{cite:null}},body:Re,br:Re,button:{attrs:{form:null,formaction:null,name:null,value:null,autofocus:["autofocus"],disabled:["autofocus"],formenctype:gb,formmethod:mb,formnovalidate:["novalidate"],formtarget:Zu,type:["submit","reset","button"]}},canvas:{attrs:{width:null,height:null}},caption:Re,center:Re,cite:Re,code:Re,col:{attrs:{span:null}},colgroup:{attrs:{span:null}},command:{attrs:{type:["command","checkbox","radio"],label:null,icon:null,radiogroup:null,command:null,title:null,disabled:["disabled"],checked:["checked"]}},data:{attrs:{value:null}},datagrid:{attrs:{disabled:["disabled"],multiple:["multiple"]}},datalist:{attrs:{data:null}},dd:Re,del:{attrs:{cite:null,datetime:null}},details:{attrs:{open:["open"]}},dfn:Re,div:Re,dl:Re,dt:Re,em:Re,embed:{attrs:{src:null,type:null,width:null,height:null}},eventsource:{attrs:{src:null}},fieldset:{attrs:{disabled:["disabled"],form:null,name:null}},figcaption:Re,figure:Re,footer:Re,form:{attrs:{action:null,name:null,"accept-charset":fb,autocomplete:["on","off"],enctype:gb,method:mb,novalidate:["novalidate"],target:Zu}},h1:Re,h2:Re,h3:Re,h4:Re,h5:Re,h6:Re,head:{children:["title","base","link","style","meta","script","noscript","command"]},header:Re,hgroup:Re,hr:Re,html:{attrs:{manifest:null}},i:Re,iframe:{attrs:{src:null,srcdoc:null,name:null,width:null,height:null,sandbox:["allow-top-navigation","allow-same-origin","allow-forms","allow-scripts"],seamless:["seamless"]}},img:{attrs:{alt:null,src:null,ismap:null,usemap:null,width:null,height:null,crossorigin:["anonymous","use-credentials"]}},input:{attrs:{alt:null,dirname:null,form:null,formaction:null,height:null,list:null,max:null,maxlength:null,min:null,name:null,pattern:null,placeholder:null,size:null,src:null,step:null,value:null,width:null,accept:["audio/*","video/*","image/*"],autocomplete:["on","off"],autofocus:["autofocus"],checked:["checked"],disabled:["disabled"],formenctype:gb,formmethod:mb,formnovalidate:["novalidate"],formtarget:Zu,multiple:["multiple"],readonly:["readonly"],required:["required"],type:["hidden","text","search","tel","url","email","password","datetime","date","month","week","time","datetime-local","number","range","color","checkbox","radio","file","submit","image","reset","button"]}},ins:{attrs:{cite:null,datetime:null}},kbd:Re,keygen:{attrs:{challenge:null,form:null,name:null,autofocus:["autofocus"],disabled:["disabled"],keytype:["RSA"]}},label:{attrs:{for:null,form:null}},legend:Re,li:{attrs:{value:null}},link:{attrs:{href:null,type:null,hreflang:null,media:null,sizes:["all","16x16","16x16 32x32","16x16 32x32 64x64"]}},map:{attrs:{name:null}},mark:Re,menu:{attrs:{label:null,type:["list","context","toolbar"]}},meta:{attrs:{content:null,charset:fb,name:["viewport","application-name","author","description","generator","keywords"],"http-equiv":["content-language","content-type","default-style","refresh"]}},meter:{attrs:{value:null,min:null,low:null,high:null,max:null,optimum:null}},nav:Re,noscript:Re,object:{attrs:{data:null,type:null,name:null,usemap:null,form:null,width:null,height:null,typemustmatch:["typemustmatch"]}},ol:{attrs:{reversed:["reversed"],start:null,type:["1","a","A","i","I"]},children:["li","script","template","ul","ol"]},optgroup:{attrs:{disabled:["disabled"],label:null}},option:{attrs:{disabled:["disabled"],label:null,selected:["selected"],value:null}},output:{attrs:{for:null,form:null,name:null}},p:Re,param:{attrs:{name:null,value:null}},pre:Re,progress:{attrs:{value:null,max:null}},q:{attrs:{cite:null}},rp:Re,rt:Re,ruby:Re,samp:Re,script:{attrs:{type:["text/javascript"],src:null,async:["async"],defer:["defer"],charset:fb}},section:Re,select:{attrs:{form:null,name:null,size:null,autofocus:["autofocus"],disabled:["disabled"],multiple:["multiple"]}},slot:{attrs:{name:null}},small:Re,source:{attrs:{src:null,type:null,media:null}},span:Re,strong:Re,style:{attrs:{type:["text/css"],media:null,scoped:null}},sub:Re,summary:Re,sup:Re,table:Re,tbody:Re,td:{attrs:{colspan:null,rowspan:null,headers:null}},template:Re,textarea:{attrs:{dirname:null,form:null,maxlength:null,name:null,placeholder:null,rows:null,cols:null,autofocus:["autofocus"],disabled:["disabled"],readonly:["readonly"],required:["required"],wrap:["soft","hard"]}},tfoot:Re,th:{attrs:{colspan:null,rowspan:null,headers:null,scope:["row","col","rowgroup","colgroup"]}},thead:Re,time:{attrs:{datetime:null}},title:Re,tr:Re,track:{attrs:{src:null,label:null,default:null,kind:["subtitles","captions","descriptions","chapters","metadata"],srclang:null}},ul:{children:["li","script","template","ul","ol"]},var:Re,video:{attrs:{src:null,poster:null,width:null,height:null,crossorigin:["anonymous","use-credentials"],preload:["auto","metadata","none"],autoplay:["autoplay"],mediagroup:["movie"],muted:["muted"],controls:["controls"]}},wbr:Re},GV={accesskey:null,class:null,contenteditable:Mn,contextmenu:null,dir:["ltr","rtl","auto"],draggable:["true","false","auto"],dropzone:["copy","move","link","string:","file:"],hidden:["hidden"],id:null,inert:["inert"],itemid:null,itemprop:null,itemref:null,itemscope:["itemscope"],itemtype:null,lang:["ar","bn","de","en-GB","en-US","es","fr","hi","id","ja","pa","pt","ru","tr","zh"],spellcheck:Mn,autocorrect:Mn,autocapitalize:Mn,style:null,tabindex:null,title:null,translate:["yes","no"],rel:["stylesheet","alternate","author","bookmark","help","license","next","nofollow","noreferrer","prefetch","prev","search","tag"],role:"alert application article banner button cell checkbox complementary contentinfo dialog document feed figure form grid gridcell heading img list listbox listitem main navigation region row rowgroup search switch tab table tabpanel textbox timer".split(" "),"aria-activedescendant":null,"aria-atomic":Mn,"aria-autocomplete":["inline","list","both","none"],"aria-busy":Mn,"aria-checked":["true","false","mixed","undefined"],"aria-controls":null,"aria-describedby":null,"aria-disabled":Mn,"aria-dropeffect":null,"aria-expanded":["true","false","undefined"],"aria-flowto":null,"aria-grabbed":["true","false","undefined"],"aria-haspopup":Mn,"aria-hidden":Mn,"aria-invalid":["true","false","grammar","spelling"],"aria-label":null,"aria-labelledby":null,"aria-level":null,"aria-live":["off","polite","assertive"],"aria-multiline":Mn,"aria-multiselectable":Mn,"aria-owns":null,"aria-posinset":null,"aria-pressed":["true","false","mixed","undefined"],"aria-readonly":Mn,"aria-relevant":null,"aria-required":Mn,"aria-selected":["true","false","undefined"],"aria-setsize":null,"aria-sort":["ascending","descending","none","other"],"aria-valuemax":null,"aria-valuemin":null,"aria-valuenow":null,"aria-valuetext":null},YV="beforeunload copy cut dragstart dragover dragleave dragenter dragend drag paste focus blur change click load mousedown mouseenter mouseleave mouseup keydown keyup resize scroll unload".split(" ").map(s=>"on"+s);for(let s of YV)GV[s]=null;class sd{constructor(t,e){this.tags=Object.assign(Object.assign({},_ue),t),this.globalAttrs=Object.assign(Object.assign({},GV),e),this.allTags=Object.keys(this.tags),this.globalAttrNames=Object.keys(this.globalAttrs)}}sd.default=new sd;function Cc(s,t,e=s.length){if(!t)return"";let i=t.firstChild,n=i&&i.getChild("TagName");return n?s.sliceString(n.from,Math.min(n.to,e)):""}function Pc(s,t=!1){for(;s;s=s.parent)if(s.name=="Element")if(t)t=!1;else return s;return null}function KV(s,t,e){let i=e.tags[Cc(s,Pc(t))];return(i==null?void 0:i.children)||e.allTags}function Ov(s,t){let e=[];for(let i=Pc(t);i&&!i.type.isTop;i=Pc(i.parent)){let n=Cc(s,i);if(n&&i.lastChild.name=="CloseTag")break;n&&e.indexOf(n)<0&&(t.name=="EndTag"||t.from>=i.firstChild.to)&&e.push(n)}return e}const JV=/^[:\-\.\w\u00b7-\uffff]*$/;function EE(s,t,e,i,n){let r=/\s*>/.test(s.sliceDoc(n,n+5))?"":">",o=Pc(e,!0);return{from:i,to:n,options:KV(s.doc,o,t).map(l=>({label:l,type:"type"})).concat(Ov(s.doc,e).map((l,a)=>({label:"/"+l,apply:"/"+l+r,type:"type",boost:99-a}))),validFor:/^\/?[:\-\.\w\u00b7-\uffff]*$/}}function AE(s,t,e,i){let n=/\s*>/.test(s.sliceDoc(i,i+5))?"":">";return{from:e,to:i,options:Ov(s.doc,t).map((r,o)=>({label:r,apply:r+n,type:"type",boost:99-o})),validFor:JV}}function kue(s,t,e,i){let n=[],r=0;for(let o of KV(s.doc,e,t))n.push({label:"<"+o,type:"type"});for(let o of Ov(s.doc,e))n.push({label:"</"+o+">",type:"type",boost:99-r++});return{from:i,to:i,options:n,validFor:/^<\/?[:\-\.\w\u00b7-\uffff]*$/}}function Sue(s,t,e,i,n){let r=Pc(e),o=r?t.tags[Cc(s.doc,r)]:null,l=o&&o.attrs?Object.keys(o.attrs):[],a=o&&o.globalAttrs===!1?l:l.length?l.concat(t.globalAttrNames):t.globalAttrNames;return{from:i,to:n,options:a.map(c=>({label:c,type:"property"})),validFor:JV}}function Cue(s,t,e,i,n){var r;let o=(r=e.parent)===null||r===void 0?void 0:r.getChild("AttributeName"),l=[],a;if(o){let c=s.sliceDoc(o.from,o.to),h=t.globalAttrs[c];if(!h){let f=Pc(e),m=f?t.tags[Cc(s.doc,f)]:null;h=(m==null?void 0:m.attrs)&&m.attrs[c]}if(h){let f=s.sliceDoc(i,n).toLowerCase(),m='"',w='"';/^['"]/.test(f)?(a=f[0]=='"'?/^[^"]*$/:/^[^']*$/,m="",w=s.sliceDoc(n,n+1)==f[0]?"":f[0],f=f.slice(1),i++):a=/^[^\s<>='"]*$/;for(let O of h)l.push({label:O,apply:m+O+w,type:"constant"})}}return{from:i,to:n,options:l,validFor:a}}function eM(s,t){let{state:e,pos:i}=t,n=St(e).resolveInner(i,-1),r=n.resolve(i);for(let o=i,l;r==n&&(l=n.childBefore(o));){let a=l.lastChild;if(!a||!a.type.isError||a.from<a.to)break;r=n=l,o=a.from}return n.name=="TagName"?n.parent&&/CloseTag$/.test(n.parent.name)?AE(e,n,n.from,i):EE(e,s,n,n.from,i):n.name=="StartTag"?EE(e,s,n,i,i):n.name=="StartCloseTag"||n.name=="IncompleteCloseTag"?AE(e,n,i,i):n.name=="OpenTag"||n.name=="SelfClosingTag"||n.name=="AttributeName"?Sue(e,s,n,n.name=="AttributeName"?n.from:i,i):n.name=="Is"||n.name=="AttributeValue"||n.name=="UnquotedAttributeValue"?Cue(e,s,n,n.name=="Is"?i:n.from,i):t.explicit&&(r.name=="Element"||r.name=="Text"||r.name=="Document")?kue(e,s,n,i):null}function Pue(s){return eM(sd.default,s)}function Tue(s){let{extraTags:t,extraGlobalAttributes:e}=s,i=e||t?new sd(t,e):sd.default;return n=>eM(i,n)}const Eue=cr.parser.configure({top:"SingleExpression"}),tM=[{tag:"script",attrs:s=>s.type=="text/typescript"||s.lang=="ts",parser:ZV.parser},{tag:"script",attrs:s=>s.type=="text/babel"||s.type=="text/jsx",parser:HV.parser},{tag:"script",attrs:s=>s.type=="text/typescript-jsx",parser:qV.parser},{tag:"script",attrs(s){return/^(importmap|speculationrules|application\/(.+\+)?json)$/i.test(s.type)},parser:Eue},{tag:"script",attrs(s){return!s.type||/^(?:text|application)\/(?:x-)?(?:java|ecma)script$|^module$|^$/i.test(s.type)},parser:cr.parser},{tag:"style",attrs(s){return(!s.lang||s.lang=="css")&&(!s.type||/^(text\/)?(x-)?(stylesheet|css)$/i.test(s.type))},parser:hp.parser}],iM=[{name:"style",parser:hp.parser.configure({top:"Styles"})}].concat(YV.map(s=>({name:s,parser:cr.parser}))),nM=_c.define({name:"html",parser:oce.configure({props:[Pd.add({Element(s){let t=/^(\s*)(<\/)?/.exec(s.textAfter);return s.node.to<=s.pos+t[0].length?s.continue():s.lineIndent(s.node.from)+(t[2]?0:s.unit)},"OpenTag CloseTag SelfClosingTag"(s){return s.column(s.node.from)+s.unit},Document(s){if(s.pos+/\s*/.exec(s.textAfter)[0].length<s.node.to)return s.continue();let t=null,e;for(let i=s.node;;){let n=i.lastChild;if(!n||n.name!="Element"||n.to!=i.to)break;t=i=n}return t&&!((e=t.lastChild)&&(e.name=="CloseTag"||e.name=="SelfClosingTag"))?s.lineIndent(t.from)+s.unit:null}}),$c.add({Element(s){let t=s.firstChild,e=s.lastChild;return!t||t.name!="OpenTag"?null:{from:t.to,to:e.name=="CloseTag"?e.from:s.to}}}),RR.add({"OpenTag CloseTag":s=>s.getChild("TagName")})]}),languageData:{commentTokens:{block:{open:"<!--",close:"-->"}},indentOnInput:/^\s*<\/\w+\W$/,wordChars:"-._"}}),rg=nM.configure({wrap:MV(tM,iM)});function sM(s={}){let t="",e;s.matchClosingTags===!1&&(t="noMatch"),s.selfClosingTags===!0&&(t=(t?t+" ":"")+"selfClosing"),(s.nestedLanguages&&s.nestedLanguages.length||s.nestedAttributes&&s.nestedAttributes.length)&&(e=MV((s.nestedLanguages||[]).concat(tM),(s.nestedAttributes||[]).concat(iM)));let i=e?nM.configure({wrap:e,dialect:t}):t?rg.configure({dialect:t}):rg;return new Yh(i,[rg.data.of({autocomplete:Tue(s)}),s.autoCloseTags!==!1?Aue:[],bue().support,Bce().support])}const IE=new Set("area base br col command embed frame hr img input keygen link meta param source track wbr menuitem".split(" ")),Aue=Ee.inputHandler.of((s,t,e,i,n)=>{if(s.composing||s.state.readOnly||t!=e||i!=">"&&i!="/"||!rg.isActiveAt(s.state,t,-1))return!1;let r=n(),{state:o}=r,l=o.changeByRange(a=>{var c,h,f;let m=o.doc.sliceString(a.from-1,a.to)==i,{head:w}=a,O=St(o).resolveInner(w,-1),_;if(m&&i==">"&&O.name=="EndTag"){let k=O.parent;if(((h=(c=k.parent)===null||c===void 0?void 0:c.lastChild)===null||h===void 0?void 0:h.name)!="CloseTag"&&(_=Cc(o.doc,k.parent,w))&&!IE.has(_)){let C=w+(o.doc.sliceString(w,w+1)===">"?1:0),P=`</${_}>`;return{range:a,changes:{from:w,to:C,insert:P}}}}else if(m&&i=="/"&&O.name=="IncompleteCloseTag"){let k=O.parent;if(O.from==w-2&&((f=k.lastChild)===null||f===void 0?void 0:f.name)!="CloseTag"&&(_=Cc(o.doc,k,w))&&!IE.has(_)){let C=w+(o.doc.sliceString(w,w+1)===">"?1:0),P=`${_}>`;return{range:se.cursor(w+P.length,-1),changes:{from:w,to:C,insert:P}}}}return{range:a}});return l.changes.empty?!1:(s.dispatch([r,o.update(l,{userEvent:"input.complete",scrollIntoView:!0})]),!0)});class dp{static create(t,e,i,n,r){let o=n+(n<<8)+t+(e<<4)|0;return new dp(t,e,i,o,r,[],[])}constructor(t,e,i,n,r,o,l){this.type=t,this.value=e,this.from=i,this.hash=n,this.end=r,this.children=o,this.positions=l,this.hashProp=[[Fe.contextHash,n]]}addChild(t,e){t.prop(Fe.contextHash)!=this.hash&&(t=new gt(t.type,t.children,t.positions,t.length,this.hashProp)),this.children.push(t),this.positions.push(e)}toTree(t,e=this.end){let i=this.children.length-1;return i>=0&&(e=Math.max(e,this.positions[i]+this.children[i].length+this.from)),new gt(t.types[this.type],this.children,this.positions,e-this.from).balance({makeTree:(n,r,o)=>new gt(hi.none,n,r,o,this.hashProp)})}}var me;(function(s){s[s.Document=1]="Document",s[s.CodeBlock=2]="CodeBlock",s[s.FencedCode=3]="FencedCode",s[s.Blockquote=4]="Blockquote",s[s.HorizontalRule=5]="HorizontalRule",s[s.BulletList=6]="BulletList",s[s.OrderedList=7]="OrderedList",s[s.ListItem=8]="ListItem",s[s.ATXHeading1=9]="ATXHeading1",s[s.ATXHeading2=10]="ATXHeading2",s[s.ATXHeading3=11]="ATXHeading3",s[s.ATXHeading4=12]="ATXHeading4",s[s.ATXHeading5=13]="ATXHeading5",s[s.ATXHeading6=14]="ATXHeading6",s[s.SetextHeading1=15]="SetextHeading1",s[s.SetextHeading2=16]="SetextHeading2",s[s.HTMLBlock=17]="HTMLBlock",s[s.LinkReference=18]="LinkReference",s[s.Paragraph=19]="Paragraph",s[s.CommentBlock=20]="CommentBlock",s[s.ProcessingInstructionBlock=21]="ProcessingInstructionBlock",s[s.Escape=22]="Escape",s[s.Entity=23]="Entity",s[s.HardBreak=24]="HardBreak",s[s.Emphasis=25]="Emphasis",s[s.StrongEmphasis=26]="StrongEmphasis",s[s.Link=27]="Link",s[s.Image=28]="Image",s[s.InlineCode=29]="InlineCode",s[s.HTMLTag=30]="HTMLTag",s[s.Comment=31]="Comment",s[s.ProcessingInstruction=32]="ProcessingInstruction",s[s.Autolink=33]="Autolink",s[s.HeaderMark=34]="HeaderMark",s[s.QuoteMark=35]="QuoteMark",s[s.ListMark=36]="ListMark",s[s.LinkMark=37]="LinkMark",s[s.EmphasisMark=38]="EmphasisMark",s[s.CodeMark=39]="CodeMark",s[s.CodeText=40]="CodeText",s[s.CodeInfo=41]="CodeInfo",s[s.LinkTitle=42]="LinkTitle",s[s.LinkLabel=43]="LinkLabel",s[s.URL=44]="URL"})(me||(me={}));class Iue{constructor(t,e){this.start=t,this.content=e,this.marks=[],this.parsers=[]}}class Rue{constructor(){this.text="",this.baseIndent=0,this.basePos=0,this.depth=0,this.markers=[],this.pos=0,this.indent=0,this.next=-1}forward(){this.basePos>this.pos&&this.forwardInner()}forwardInner(){let t=this.skipSpace(this.basePos);this.indent=this.countIndent(t,this.pos,this.indent),this.pos=t,this.next=t==this.text.length?-1:this.text.charCodeAt(t)}skipSpace(t){return yh(this.text,t)}reset(t){for(this.text=t,this.baseIndent=this.basePos=this.pos=this.indent=0,this.forwardInner(),this.depth=1;this.markers.length;)this.markers.pop()}moveBase(t){this.basePos=t,this.baseIndent=this.countIndent(t,this.pos,this.indent)}moveBaseColumn(t){this.baseIndent=t,this.basePos=this.findColumn(t)}addMarker(t){this.markers.push(t)}countIndent(t,e=0,i=0){for(let n=e;n<t;n++)i+=this.text.charCodeAt(n)==9?4-i%4:1;return i}findColumn(t){let e=0;for(let i=0;e<this.text.length&&i<t;e++)i+=this.text.charCodeAt(e)==9?4-i%4:1;return e}scrub(){if(!this.baseIndent)return this.text;let t="";for(let e=0;e<this.basePos;e++)t+=" ";return t+this.text.slice(this.basePos)}}function RE(s,t,e){if(e.pos==e.text.length||s!=t.block&&e.indent>=t.stack[e.depth+1].value+e.baseIndent)return!0;if(e.indent>=e.baseIndent+4)return!1;let i=(s.type==me.OrderedList?_v:vv)(e,t,!1);return i>0&&(s.type!=me.BulletList||yv(e,t,!1)<0)&&e.text.charCodeAt(e.pos+i-1)==s.value}const rM={[me.Blockquote](s,t,e){return e.next!=62?!1:(e.markers.push(Ye(me.QuoteMark,t.lineStart+e.pos,t.lineStart+e.pos+1)),e.moveBase(e.pos+(ys(e.text.charCodeAt(e.pos+1))?2:1)),s.end=t.lineStart+e.text.length,!0)},[me.ListItem](s,t,e){return e.indent<e.baseIndent+s.value&&e.next>-1?!1:(e.moveBaseColumn(e.baseIndent+s.value),!0)},[me.OrderedList]:RE,[me.BulletList]:RE,[me.Document](){return!0}};function ys(s){return s==32||s==9||s==10||s==13}function yh(s,t=0){for(;t<s.length&&ys(s.charCodeAt(t));)t++;return t}function VE(s,t,e){for(;t>e&&ys(s.charCodeAt(t-1));)t--;return t}function oM(s){if(s.next!=96&&s.next!=126)return-1;let t=s.pos+1;for(;t<s.text.length&&s.text.charCodeAt(t)==s.next;)t++;if(t<s.pos+3)return-1;if(s.next==96){for(let e=t;e<s.text.length;e++)if(s.text.charCodeAt(e)==96)return-1}return t}function lM(s){return s.next!=62?-1:s.text.charCodeAt(s.pos+1)==32?2:1}function yv(s,t,e){if(s.next!=42&&s.next!=45&&s.next!=95)return-1;let i=1;for(let n=s.pos+1;n<s.text.length;n++){let r=s.text.charCodeAt(n);if(r==s.next)i++;else if(!ys(r))return-1}return e&&s.next==45&&uM(s)>-1&&s.depth==t.stack.length&&t.parser.leafBlockParsers.indexOf(mM.SetextHeading)>-1||i<3?-1:1}function aM(s,t){for(let e=s.stack.length-1;e>=0;e--)if(s.stack[e].type==t)return!0;return!1}function vv(s,t,e){return(s.next==45||s.next==43||s.next==42)&&(s.pos==s.text.length-1||ys(s.text.charCodeAt(s.pos+1)))&&(!e||aM(t,me.BulletList)||s.skipSpace(s.pos+2)<s.text.length)?1:-1}function _v(s,t,e){let i=s.pos,n=s.next;for(;n>=48&&n<=57;){i++;if(i==s.text.length)return-1;n=s.text.charCodeAt(i)}return i==s.pos||i>s.pos+9||n!=46&&n!=41||i<s.text.length-1&&!ys(s.text.charCodeAt(i+1))||e&&!aM(t,me.OrderedList)&&(s.skipSpace(i+1)==s.text.length||i>s.pos+1||s.next!=49)?-1:i+1-s.pos}function cM(s){if(s.next!=35)return-1;let t=s.pos+1;for(;t<s.text.length&&s.text.charCodeAt(t)==35;)t++;if(t<s.text.length&&s.text.charCodeAt(t)!=32)return-1;let e=t-s.pos;return e>6?-1:e}function uM(s){if(s.next!=45&&s.next!=61||s.indent>=s.baseIndent+4)return-1;let t=s.pos+1;for(;t<s.text.length&&s.text.charCodeAt(t)==s.next;)t++;let e=t;for(;t<s.text.length&&ys(s.text.charCodeAt(t));)t++;return t==s.text.length?e:-1}const pO=/^[ \t]*$/,hM=/-->/,dM=/\?>/,wO=[[/^<(?:script|pre|style)(?:\s|>|$)/i,/<\/(?:script|pre|style)>/i],[/^\s*<!--/,hM],[/^\s*<\?/,dM],[/^\s*<![A-Z]/,/>/],[/^\s*<!\[CDATA\[/,/\]\]>/],[/^\s*<\/?(?:address|article|aside|base|basefont|blockquote|body|caption|center|col|colgroup|dd|details|dialog|dir|div|dl|dt|fieldset|figcaption|figure|footer|form|frame|frameset|h1|h2|h3|h4|h5|h6|head|header|hr|html|iframe|legend|li|link|main|menu|menuitem|nav|noframes|ol|optgroup|option|p|param|section|source|summary|table|tbody|td|tfoot|th|thead|title|tr|track|ul)(?:\s|\/?>|$)/i,pO],[/^\s*(?:<\/[a-z][\w-]*\s*>|<[a-z][\w-]*(\s+[a-z:_][\w-.]*(?:\s*=\s*(?:[^\s"'=<>`]+|'[^']*'|"[^"]*"))?)*\s*>)\s*$/i,pO]];function fM(s,t,e){if(s.next!=60)return-1;let i=s.text.slice(s.pos);for(let n=0,r=wO.length-(e?1:0);n<r;n++)if(wO[n][0].test(i))return n;return-1}function ME(s,t){let e=s.countIndent(t,s.pos,s.indent),i=s.countIndent(s.skipSpace(t),t,e);return i>=e+5?e+1:i}function dl(s,t,e){let i=s.length-1;i>=0&&s[i].to==t&&s[i].type==me.CodeText?s[i].to=e:s.push(Ye(me.CodeText,t,e))}const Pm={LinkReference:void 0,IndentedCode(s,t){let e=t.baseIndent+4;if(t.indent<e)return!1;let i=t.findColumn(e),n=s.lineStart+i,r=s.lineStart+t.text.length,o=[],l=[];for(dl(o,n,r);s.nextLine()&&t.depth>=s.stack.length;)if(t.pos==t.text.length){dl(l,s.lineStart-1,s.lineStart);for(let a of t.markers)l.push(a)}else{if(t.indent<e)break;{if(l.length){for(let c of l)c.type==me.CodeText?dl(o,c.from,c.to):o.push(c);l=[]}dl(o,s.lineStart-1,s.lineStart);for(let c of t.markers)o.push(c);r=s.lineStart+t.text.length;let a=s.lineStart+t.findColumn(t.baseIndent+4);a<r&&dl(o,a,r)}}return l.length&&(l=l.filter(a=>a.type!=me.CodeText),l.length&&(t.markers=l.concat(t.markers))),s.addNode(s.buffer.writeElements(o,-n).finish(me.CodeBlock,r-n),n),!0},FencedCode(s,t){let e=oM(t);if(e<0)return!1;let i=s.lineStart+t.pos,n=t.next,r=e-t.pos,o=t.skipSpace(e),l=VE(t.text,t.text.length,o),a=[Ye(me.CodeMark,i,i+r)];o<l&&a.push(Ye(me.CodeInfo,s.lineStart+o,s.lineStart+l));for(let c=!0;s.nextLine()&&t.depth>=s.stack.length;c=!1){let h=t.pos;if(t.indent-t.baseIndent<4)for(;h<t.text.length&&t.text.charCodeAt(h)==n;)h++;if(h-t.pos>=r&&t.skipSpace(h)==t.text.length){for(let f of t.markers)a.push(f);a.push(Ye(me.CodeMark,s.lineStart+t.pos,s.lineStart+h)),s.nextLine();break}else{c||dl(a,s.lineStart-1,s.lineStart);for(let w of t.markers)a.push(w);let f=s.lineStart+t.basePos,m=s.lineStart+t.text.length;f<m&&dl(a,f,m)}}return s.addNode(s.buffer.writeElements(a,-i).finish(me.FencedCode,s.prevLineEnd()-i),i),!0},Blockquote(s,t){let e=lM(t);return e<0?!1:(s.startContext(me.Blockquote,t.pos),s.addNode(me.QuoteMark,s.lineStart+t.pos,s.lineStart+t.pos+1),t.moveBase(t.pos+e),null)},HorizontalRule(s,t){if(yv(t,s,!1)<0)return!1;let e=s.lineStart+t.pos;return s.nextLine(),s.addNode(me.HorizontalRule,e),!0},BulletList(s,t){let e=vv(t,s,!1);if(e<0)return!1;s.block.type!=me.BulletList&&s.startContext(me.BulletList,t.basePos,t.next);let i=ME(t,t.pos+1);return s.startContext(me.ListItem,t.basePos,i-t.baseIndent),s.addNode(me.ListMark,s.lineStart+t.pos,s.lineStart+t.pos+e),t.moveBaseColumn(i),null},OrderedList(s,t){let e=_v(t,s,!1);if(e<0)return!1;s.block.type!=me.OrderedList&&s.startContext(me.OrderedList,t.basePos,t.text.charCodeAt(t.pos+e-1));let i=ME(t,t.pos+e);return s.startContext(me.ListItem,t.basePos,i-t.baseIndent),s.addNode(me.ListMark,s.lineStart+t.pos,s.lineStart+t.pos+e),t.moveBaseColumn(i),null},ATXHeading(s,t){let e=cM(t);if(e<0)return!1;let i=t.pos,n=s.lineStart+i,r=VE(t.text,t.text.length,i),o=r;for(;o>i&&t.text.charCodeAt(o-1)==t.next;)o--;(o==r||o==i||!ys(t.text.charCodeAt(o-1)))&&(o=t.text.length);let l=s.buffer.write(me.HeaderMark,0,e).writeElements(s.parser.parseInline(t.text.slice(i+e+1,o),n+e+1),-n);o<t.text.length&&l.write(me.HeaderMark,o-i,r-i);let a=l.finish(me.ATXHeading1-1+e,t.text.length-i);return s.nextLine(),s.addNode(a,n),!0},HTMLBlock(s,t){let e=fM(t,s,!1);if(e<0)return!1;let i=s.lineStart+t.pos,n=wO[e][1],r=[],o=n!=pO;for(;!n.test(t.text)&&s.nextLine();){if(t.depth<s.stack.length){o=!1;break}for(let c of t.markers)r.push(c)}o&&s.nextLine();let l=n==hM?me.CommentBlock:n==dM?me.ProcessingInstructionBlock:me.HTMLBlock,a=s.prevLineEnd();return s.addNode(s.buffer.writeElements(r,-i).finish(l,a-i),i),!0},SetextHeading:void 0};class Vue{constructor(t){this.stage=0,this.elts=[],this.pos=0,this.start=t.start,this.advance(t.content)}nextLine(t,e,i){if(this.stage==-1)return!1;let n=i.content+`
`+e.scrub(),r=this.advance(n);return r>-1&&r<n.length?this.complete(t,i,r):!1}finish(t,e){return(this.stage==2||this.stage==3)&&yh(e.content,this.pos)==e.content.length?this.complete(t,e,e.content.length):!1}complete(t,e,i){return t.addLeafElement(e,Ye(me.LinkReference,this.start,this.start+i,this.elts)),!0}nextStage(t){return t?(this.pos=t.to-this.start,this.elts.push(t),this.stage++,!0):(t===!1&&(this.stage=-1),!1)}advance(t){for(;;){if(this.stage==-1)return-1;if(this.stage==0){if(!this.nextStage(_M(t,this.pos,this.start,!0)))return-1;if(t.charCodeAt(this.pos)!=58)return this.stage=-1;this.elts.push(Ye(me.LinkMark,this.pos+this.start,this.pos+this.start+1)),this.pos++}else if(this.stage==1){if(!this.nextStage(yM(t,yh(t,this.pos),this.start)))return-1}else if(this.stage==2){let e=yh(t,this.pos),i=0;if(e>this.pos){let n=vM(t,e,this.start);if(n){let r=pb(t,n.to-this.start);r>0&&(this.nextStage(n),i=r)}}return i||(i=pb(t,this.pos)),i>0&&i<t.length?i:-1}else return pb(t,this.pos)}}}function pb(s,t){for(;t<s.length;t++){let e=s.charCodeAt(t);if(e==10)break;if(!ys(e))return-1}return t}class Mue{nextLine(t,e,i){let n=e.depth<t.stack.length?-1:uM(e),r=e.next;if(n<0)return!1;let o=Ye(me.HeaderMark,t.lineStart+e.pos,t.lineStart+n);return t.nextLine(),t.addLeafElement(i,Ye(r==61?me.SetextHeading1:me.SetextHeading2,i.start,t.prevLineEnd(),[...t.parser.parseInline(i.content,i.start),o])),!0}finish(){return!1}}const mM={LinkReference(s,t){return t.content.charCodeAt(0)==91?new Vue(t):null},SetextHeading(){return new Mue}},Lue=[(s,t)=>cM(t)>=0,(s,t)=>oM(t)>=0,(s,t)=>lM(t)>=0,(s,t)=>vv(t,s,!0)>=0,(s,t)=>_v(t,s,!0)>=0,(s,t)=>yv(t,s,!0)>=0,(s,t)=>fM(t,s,!0)>=0],Bue={text:"",end:0};class $ue{constructor(t,e,i,n){this.parser=t,this.input=e,this.ranges=n,this.line=new Rue,this.atEnd=!1,this.reusePlaceholders=new Map,this.stoppedAt=null,this.rangeI=0,this.to=n[n.length-1].to,this.lineStart=this.absoluteLineStart=this.absoluteLineEnd=n[0].from,this.block=dp.create(me.Document,0,this.lineStart,0,0),this.stack=[this.block],this.fragments=i.length?new Fue(i,e):null,this.readLine()}get parsedPos(){return this.absoluteLineStart}advance(){if(this.stoppedAt!=null&&this.absoluteLineStart>this.stoppedAt)return this.finish();let{line:t}=this;for(;;){for(let i=0;;){let n=t.depth<this.stack.length?this.stack[this.stack.length-1]:null;for(;i<t.markers.length&&(!n||t.markers[i].from<n.end);){let r=t.markers[i++];this.addNode(r.type,r.from,r.to)}if(!n)break;this.finishContext()}if(t.pos<t.text.length)break;if(!this.nextLine())return this.finish()}if(this.fragments&&this.reuseFragment(t.basePos))return null;e:for(;;){for(let i of this.parser.blockParsers)if(i){let n=i(this,t);if(n!=!1){if(n==!0)return null;t.forward();continue e}}break}let e=new Iue(this.lineStart+t.pos,t.text.slice(t.pos));for(let i of this.parser.leafBlockParsers)if(i){let n=i(this,e);n&&e.parsers.push(n)}e:for(;this.nextLine()&&t.pos!=t.text.length;){if(t.indent<t.baseIndent+4){for(let i of this.parser.endLeafBlock)if(i(this,t,e))break e}for(let i of e.parsers)if(i.nextLine(this,t,e))return null;e.content+=`
`+t.scrub();for(let i of t.markers)e.marks.push(i)}return this.finishLeaf(e),null}stopAt(t){if(this.stoppedAt!=null&&this.stoppedAt<t)throw new RangeError("Can't move stoppedAt forward");this.stoppedAt=t}reuseFragment(t){if(!this.fragments.moveTo(this.absoluteLineStart+t,this.absoluteLineStart)||!this.fragments.matches(this.block.hash))return!1;let e=this.fragments.takeNodes(this);return e?(this.absoluteLineStart+=e,this.lineStart=kM(this.absoluteLineStart,this.ranges),this.moveRangeI(),this.absoluteLineStart<this.to?(this.lineStart++,this.absoluteLineStart++,this.readLine()):(this.atEnd=!0,this.readLine()),!0):!1}get depth(){return this.stack.length}parentType(t=this.depth-1){return this.parser.nodeSet.types[this.stack[t].type]}nextLine(){return this.lineStart+=this.line.text.length,this.absoluteLineEnd>=this.to?(this.absoluteLineStart=this.absoluteLineEnd,this.atEnd=!0,this.readLine(),!1):(this.lineStart++,this.absoluteLineStart=this.absoluteLineEnd+1,this.moveRangeI(),this.readLine(),!0)}peekLine(){return this.scanLine(this.absoluteLineEnd+1).text}moveRangeI(){for(;this.rangeI<this.ranges.length-1&&this.absoluteLineStart>=this.ranges[this.rangeI].to;)this.rangeI++,this.absoluteLineStart=Math.max(this.absoluteLineStart,this.ranges[this.rangeI].from)}scanLine(t){let e=Bue;if(e.end=t,t>=this.to)e.text="";else if(e.text=this.lineChunkAt(t),e.end+=e.text.length,this.ranges.length>1){let i=this.absoluteLineStart,n=this.rangeI;for(;this.ranges[n].to<e.end;){n++;let r=this.ranges[n].from,o=this.lineChunkAt(r);e.end=r+o.length,e.text=e.text.slice(0,this.ranges[n-1].to-i)+o,i=e.end-e.text.length}}return e}readLine(){let{line:t}=this,{text:e,end:i}=this.scanLine(this.absoluteLineStart);for(this.absoluteLineEnd=i,t.reset(e);t.depth<this.stack.length;t.depth++){let n=this.stack[t.depth],r=this.parser.skipContextMarkup[n.type];if(!r)throw new Error("Unhandled block context "+me[n.type]);if(!r(n,this,t))break;t.forward()}}lineChunkAt(t){let e=this.input.chunk(t),i;if(this.input.lineChunks)i=e==`
`?"":e;else{let n=e.indexOf(`
`);i=n<0?e:e.slice(0,n)}return t+i.length>this.to?i.slice(0,this.to-t):i}prevLineEnd(){return this.atEnd?this.lineStart:this.lineStart-1}startContext(t,e,i=0){this.block=dp.create(t,i,this.lineStart+e,this.block.hash,this.lineStart+this.line.text.length),this.stack.push(this.block)}startComposite(t,e,i=0){this.startContext(this.parser.getNodeType(t),e,i)}addNode(t,e,i){typeof t=="number"&&(t=new gt(this.parser.nodeSet.types[t],Tc,Tc,(i??this.prevLineEnd())-e)),this.block.addChild(t,e-this.block.from)}addElement(t){this.block.addChild(t.toTree(this.parser.nodeSet),t.from-this.block.from)}addLeafElement(t,e){this.addNode(this.buffer.writeElements(OO(e.children,t.marks),-e.from).finish(e.type,e.to-e.from),e.from)}finishContext(){let t=this.stack.pop(),e=this.stack[this.stack.length-1];e.addChild(t.toTree(this.parser.nodeSet),t.from-e.from),this.block=e}finish(){for(;this.stack.length>1;)this.finishContext();return this.addGaps(this.block.toTree(this.parser.nodeSet,this.lineStart))}addGaps(t){return this.ranges.length>1?gM(this.ranges,0,t.topNode,this.ranges[0].from,this.reusePlaceholders):t}finishLeaf(t){for(let i of t.parsers)if(i.finish(this,t))return;let e=OO(this.parser.parseInline(t.content,t.start),t.marks);this.addNode(this.buffer.writeElements(e,-t.start).finish(me.Paragraph,t.content.length),t.start)}elt(t,e,i,n){return typeof t=="string"?Ye(this.parser.getNodeType(t),e,i,n):new xM(t,e)}get buffer(){return new wM(this.parser.nodeSet)}}function gM(s,t,e,i,n){let r=s[t].to,o=[],l=[],a=e.from+i;function c(h,f){for(;f?h>=r:h>r;){let m=s[t+1].from-r;i+=m,h+=m,t++,r=s[t].to}}for(let h=e.firstChild;h;h=h.nextSibling){c(h.from+i,!0);let f=h.from+i,m,w=n.get(h.tree);w?m=w:h.to+i>r?(m=gM(s,t,h,i,n),c(h.to+i,!1)):m=h.toTree(),o.push(m),l.push(f-a)}return c(e.to+i,!1),new gt(e.type,o,l,e.to+i-a,e.tree?e.tree.propValues:void 0)}class jp extends tv{constructor(t,e,i,n,r,o,l,a,c){super(),this.nodeSet=t,this.blockParsers=e,this.leafBlockParsers=i,this.blockNames=n,this.endLeafBlock=r,this.skipContextMarkup=o,this.inlineParsers=l,this.inlineNames=a,this.wrappers=c,this.nodeTypes=Object.create(null);for(let h of t.types)this.nodeTypes[h.name]=h.id}createParse(t,e,i){let n=new $ue(this,t,e,i);for(let r of this.wrappers)n=r(n,t,e,i);return n}configure(t){let e=xO(t);if(!e)return this;let{nodeSet:i,skipContextMarkup:n}=this,r=this.blockParsers.slice(),o=this.leafBlockParsers.slice(),l=this.blockNames.slice(),a=this.inlineParsers.slice(),c=this.inlineNames.slice(),h=this.endLeafBlock.slice(),f=this.wrappers;if(Hu(e.defineNodes)){n=Object.assign({},n);let m=i.types.slice(),w;for(let O of e.defineNodes){let{name:_,block:k,composite:C,style:P}=typeof O=="string"?{name:O}:O;if(m.some(N=>N.name==_))continue;C&&(n[m.length]=(N,G,D)=>C(G,D,N.value));let M=m.length,Q=C?["Block","BlockContext"]:k?M>=me.ATXHeading1&&M<=me.SetextHeading2?["Block","LeafBlock","Heading"]:["Block","LeafBlock"]:void 0;m.push(hi.define({id:M,name:_,props:Q&&[[Fe.group,Q]]})),P&&(w||(w={}),Array.isArray(P)||P instanceof Dn?w[_]=P:Object.assign(w,P))}i=new Sd(m),w&&(i=i.extend(Bc(w)))}if(Hu(e.props)&&(i=i.extend(...e.props)),Hu(e.remove))for(let m of e.remove){let w=this.blockNames.indexOf(m),O=this.inlineNames.indexOf(m);w>-1&&(r[w]=o[w]=void 0),O>-1&&(a[O]=void 0)}if(Hu(e.parseBlock))for(let m of e.parseBlock){let w=l.indexOf(m.name);if(w>-1)r[w]=m.parse,o[w]=m.leaf;else{let O=m.before?Tm(l,m.before):m.after?Tm(l,m.after)+1:l.length-1;r.splice(O,0,m.parse),o.splice(O,0,m.leaf),l.splice(O,0,m.name)}m.endLeaf&&h.push(m.endLeaf)}if(Hu(e.parseInline))for(let m of e.parseInline){let w=c.indexOf(m.name);if(w>-1)a[w]=m.parse;else{let O=m.before?Tm(c,m.before):m.after?Tm(c,m.after)+1:c.length-1;a.splice(O,0,m.parse),c.splice(O,0,m.name)}}return e.wrap&&(f=f.concat(e.wrap)),new jp(i,r,o,l,h,n,a,c,f)}getNodeType(t){let e=this.nodeTypes[t];if(e==null)throw new RangeError(`Unknown node type '${t}'`);return e}parseInline(t,e){let i=new Que(this,t,e);e:for(let n=e;n<i.end;){let r=i.char(n);for(let o of this.inlineParsers)if(o){let l=o(i,r,n);if(l>=0){n=l;continue e}}n++}return i.resolveMarkers(0)}}function Hu(s){return s!=null&&s.length>0}function xO(s){if(!Array.isArray(s))return s;if(s.length==0)return null;let t=xO(s[0]);if(s.length==1)return t;let e=xO(s.slice(1));if(!e||!t)return t||e;let i=(o,l)=>(o||Tc).concat(l||Tc),n=t.wrap,r=e.wrap;return{props:i(t.props,e.props),defineNodes:i(t.defineNodes,e.defineNodes),parseBlock:i(t.parseBlock,e.parseBlock),parseInline:i(t.parseInline,e.parseInline),remove:i(t.remove,e.remove),wrap:n?r?(o,l,a,c)=>n(r(o,l,a,c),l,a,c):n:r}}function Tm(s,t){let e=s.indexOf(t);if(e<0)throw new RangeError(`Position specified relative to unknown parser ${t}`);return e}let pM=[hi.none];for(let s=1,t;t=me[s];s++)pM[s]=hi.define({id:s,name:t,props:s>=me.Escape?[]:[[Fe.group,s in rM?["Block","BlockContext"]:["Block","LeafBlock"]]],top:t=="Document"});const Tc=[];let wM=class{constructor(t){this.nodeSet=t,this.content=[],this.nodes=[]}write(t,e,i,n=0){return this.content.push(t,e,i,4+n*4),this}writeElements(t,e=0){for(let i of t)i.writeTo(this,e);return this}finish(t,e){return gt.build({buffer:this.content,nodeSet:this.nodeSet,reused:this.nodes,topID:t,length:e})}};class rd{constructor(t,e,i,n=Tc){this.type=t,this.from=e,this.to=i,this.children=n}writeTo(t,e){let i=t.content.length;t.writeElements(this.children,e),t.content.push(this.type,this.from+e,this.to+e,t.content.length+4-i)}toTree(t){return new wM(t).writeElements(this.children,-this.from).finish(this.type,this.to-this.from)}}class xM{constructor(t,e){this.tree=t,this.from=e}get to(){return this.from+this.tree.length}get type(){return this.tree.type.id}get children(){return Tc}writeTo(t,e){t.nodes.push(this.tree),t.content.push(t.nodes.length-1,this.from+e,this.to+e,-1)}toTree(){return this.tree}}function Ye(s,t,e,i){return new rd(s,t,e,i)}const bM={resolve:"Emphasis",mark:"EmphasisMark"},OM={resolve:"Emphasis",mark:"EmphasisMark"},Za={},bO={};class is{constructor(t,e,i,n){this.type=t,this.from=e,this.to=i,this.side=n}}const LE="!\"#$%&'()*+,-./:;<=>?@[\\]^_`{|}~";let od=/[!"#$%&'()*+,\-.\/:;<=>?@\[\\\]^_`{|}~\xA1\u2010-\u2027]/;try{od=new RegExp("[\\p{S}|\\p{P}]","u")}catch{}const wb={Escape(s,t,e){if(t!=92||e==s.end-1)return-1;let i=s.char(e+1);for(let n=0;n<LE.length;n++)if(LE.charCodeAt(n)==i)return s.append(Ye(me.Escape,e,e+2));return-1},Entity(s,t,e){if(t!=38)return-1;let i=/^(?:#\d+|#x[a-f\d]+|\w+);/i.exec(s.slice(e+1,e+31));return i?s.append(Ye(me.Entity,e,e+1+i[0].length)):-1},InlineCode(s,t,e){if(t!=96||e&&s.char(e-1)==96)return-1;let i=e+1;for(;i<s.end&&s.char(i)==96;)i++;let n=i-e,r=0;for(;i<s.end;i++)if(s.char(i)==96){if(r++,r==n&&s.char(i+1)!=96)return s.append(Ye(me.InlineCode,e,i+1,[Ye(me.CodeMark,e,e+n),Ye(me.CodeMark,i+1-n,i+1)]))}else r=0;return-1},HTMLTag(s,t,e){if(t!=60||e==s.end-1)return-1;let i=s.slice(e+1,s.end),n=/^(?:[a-z][-\w+.]+:[^\s>]+|[a-z\d.!#$%&'*+/=?^_`{|}~-]+@[a-z\d](?:[a-z\d-]{0,61}[a-z\d])?(?:\.[a-z\d](?:[a-z\d-]{0,61}[a-z\d])?)*)>/i.exec(i);if(n)return s.append(Ye(me.Autolink,e,e+1+n[0].length,[Ye(me.LinkMark,e,e+1),Ye(me.URL,e+1,e+n[0].length),Ye(me.LinkMark,e+n[0].length,e+1+n[0].length)]));let r=/^!--[^>](?:-[^-]|[^-])*?-->/i.exec(i);if(r)return s.append(Ye(me.Comment,e,e+1+r[0].length));let o=/^\?[^]*?\?>/.exec(i);if(o)return s.append(Ye(me.ProcessingInstruction,e,e+1+o[0].length));let l=/^(?:![A-Z][^]*?>|!\[CDATA\[[^]*?\]\]>|\/\s*[a-zA-Z][\w-]*\s*>|\s*[a-zA-Z][\w-]*(\s+[a-zA-Z:_][\w-.:]*(?:\s*=\s*(?:[^\s"'=<>`]+|'[^']*'|"[^"]*"))?)*\s*(\/\s*)?>)/.exec(i);return l?s.append(Ye(me.HTMLTag,e,e+1+l[0].length)):-1},Emphasis(s,t,e){if(t!=95&&t!=42)return-1;let i=e+1;for(;s.char(i)==t;)i++;let n=s.slice(e-1,e),r=s.slice(i,i+1),o=od.test(n),l=od.test(r),a=/\s|^$/.test(n),c=/\s|^$/.test(r),h=!c&&(!l||a||o),f=!a&&(!o||c||l),m=h&&(t==42||!f||o),w=f&&(t==42||!h||l);return s.append(new is(t==95?bM:OM,e,i,(m?1:0)|(w?2:0)))},HardBreak(s,t,e){if(t==92&&s.char(e+1)==10)return s.append(Ye(me.HardBreak,e,e+2));if(t==32){let i=e+1;for(;s.char(i)==32;)i++;if(s.char(i)==10&&i>=e+2)return s.append(Ye(me.HardBreak,e,i+1))}return-1},Link(s,t,e){return t==91?s.append(new is(Za,e,e+1,1)):-1},Image(s,t,e){return t==33&&s.char(e+1)==91?s.append(new is(bO,e,e+2,1)):-1},LinkEnd(s,t,e){if(t!=93)return-1;for(let i=s.parts.length-1;i>=0;i--){let n=s.parts[i];if(n instanceof is&&(n.type==Za||n.type==bO)){if(!n.side||s.skipSpace(n.to)==e&&!/[(\[]/.test(s.slice(e+1,e+2)))return s.parts[i]=null,-1;let r=s.takeContent(i),o=s.parts[i]=Due(s,r,n.type==Za?me.Link:me.Image,n.from,e+1);if(n.type==Za)for(let l=0;l<i;l++){let a=s.parts[l];a instanceof is&&a.type==Za&&(a.side=0)}return o.to}}return-1}};function Due(s,t,e,i,n){let{text:r}=s,o=s.char(n),l=n;if(t.unshift(Ye(me.LinkMark,i,i+(e==me.Image?2:1))),t.push(Ye(me.LinkMark,n-1,n)),o==40){let a=s.skipSpace(n+1),c=yM(r,a-s.offset,s.offset),h;c&&(a=s.skipSpace(c.to),a!=c.to&&(h=vM(r,a-s.offset,s.offset),h&&(a=s.skipSpace(h.to)))),s.char(a)==41&&(t.push(Ye(me.LinkMark,n,n+1)),l=a+1,c&&t.push(c),h&&t.push(h),t.push(Ye(me.LinkMark,a,l)))}else if(o==91){let a=_M(r,n-s.offset,s.offset,!1);a&&(t.push(a),l=a.to)}return Ye(e,i,l,t)}function yM(s,t,e){if(s.charCodeAt(t)==60){for(let n=t+1;n<s.length;n++){let r=s.charCodeAt(n);if(r==62)return Ye(me.URL,t+e,n+1+e);if(r==60||r==10)return!1}return null}else{let n=0,r=t;for(let o=!1;r<s.length;r++){let l=s.charCodeAt(r);if(ys(l))break;if(o)o=!1;else if(l==40)n++;else if(l==41){if(!n)break;n--}else l==92&&(o=!0)}return r>t?Ye(me.URL,t+e,r+e):r==s.length?null:!1}}function vM(s,t,e){let i=s.charCodeAt(t);if(i!=39&&i!=34&&i!=40)return!1;let n=i==40?41:i;for(let r=t+1,o=!1;r<s.length;r++){let l=s.charCodeAt(r);if(o)o=!1;else{if(l==n)return Ye(me.LinkTitle,t+e,r+1+e);l==92&&(o=!0)}}return null}function _M(s,t,e,i){for(let n=!1,r=t+1,o=Math.min(s.length,r+999);r<o;r++){let l=s.charCodeAt(r);if(n)n=!1;else{if(l==93)return i?!1:Ye(me.LinkLabel,t+e,r+1+e);if(i&&!ys(l)&&(i=!1),l==91)return!1;l==92&&(n=!0)}}return null}class Que{constructor(t,e,i){this.parser=t,this.text=e,this.offset=i,this.parts=[]}char(t){return t>=this.end?-1:this.text.charCodeAt(t-this.offset)}get end(){return this.offset+this.text.length}slice(t,e){return this.text.slice(t-this.offset,e-this.offset)}append(t){return this.parts.push(t),t.to}addDelimiter(t,e,i,n,r){return this.append(new is(t,e,i,(n?1:0)|(r?2:0)))}get hasOpenLink(){for(let t=this.parts.length-1;t>=0;t--){let e=this.parts[t];if(e instanceof is&&(e.type==Za||e.type==bO))return!0}return!1}addElement(t){return this.append(t)}resolveMarkers(t){for(let i=t;i<this.parts.length;i++){let n=this.parts[i];if(!(n instanceof is&&n.type.resolve&&n.side&2))continue;let r=n.type==bM||n.type==OM,o=n.to-n.from,l,a=i-1;for(;a>=t;a--){let _=this.parts[a];if(_ instanceof is&&_.side&1&&_.type==n.type&&!(r&&(n.side&1||_.side&2)&&(_.to-_.from+o)%3==0&&((_.to-_.from)%3||o%3))){l=_;break}}if(!l)continue;let c=n.type.resolve,h=[],f=l.from,m=n.to;if(r){let _=Math.min(2,l.to-l.from,o);f=l.to-_,m=n.from+_,c=_==1?"Emphasis":"StrongEmphasis"}l.type.mark&&h.push(this.elt(l.type.mark,f,l.to));for(let _=a+1;_<i;_++)this.parts[_]instanceof rd&&h.push(this.parts[_]),this.parts[_]=null;n.type.mark&&h.push(this.elt(n.type.mark,n.from,m));let w=this.elt(c,f,m,h);this.parts[a]=r&&l.from!=f?new is(l.type,l.from,f,l.side):null,(this.parts[i]=r&&n.to!=m?new is(n.type,m,n.to,n.side):null)?this.parts.splice(i,0,w):this.parts[i]=w}let e=[];for(let i=t;i<this.parts.length;i++){let n=this.parts[i];n instanceof rd&&e.push(n)}return e}findOpeningDelimiter(t){for(let e=this.parts.length-1;e>=0;e--){let i=this.parts[e];if(i instanceof is&&i.type==t)return e}return null}takeContent(t){let e=this.resolveMarkers(t);return this.parts.length=t,e}skipSpace(t){return yh(this.text,t-this.offset)+this.offset}elt(t,e,i,n){return typeof t=="string"?Ye(this.parser.getNodeType(t),e,i,n):new xM(t,e)}}function OO(s,t){if(!t.length)return s;if(!s.length)return t;let e=s.slice(),i=0;for(let n of t){for(;i<e.length&&e[i].to<n.to;)i++;if(i<e.length&&e[i].from<n.from){let r=e[i];r instanceof rd&&(e[i]=new rd(r.type,r.from,r.to,OO(r.children,[n])))}else e.splice(i++,0,n)}return e}const Nue=[me.CodeBlock,me.ListItem,me.OrderedList,me.BulletList];class Fue{constructor(t,e){this.fragments=t,this.input=e,this.i=0,this.fragment=null,this.fragmentEnd=-1,this.cursor=null,t.length&&(this.fragment=t[this.i++])}nextFragment(){this.fragment=this.i<this.fragments.length?this.fragments[this.i++]:null,this.cursor=null,this.fragmentEnd=-1}moveTo(t,e){for(;this.fragment&&this.fragment.to<=t;)this.nextFragment();if(!this.fragment||this.fragment.from>(t?t-1:0))return!1;if(this.fragmentEnd<0){let r=this.fragment.to;for(;r>0&&this.input.read(r-1,r)!=`
`;)r--;this.fragmentEnd=r?r-1:0}let i=this.cursor;i||(i=this.cursor=this.fragment.tree.cursor(),i.firstChild());let n=t+this.fragment.offset;for(;i.to<=n;)if(!i.parent())return!1;for(;;){if(i.from>=n)return this.fragment.from<=e;if(!i.childAfter(n))return!1}}matches(t){let e=this.cursor.tree;return e&&e.prop(Fe.contextHash)==t}takeNodes(t){let e=this.cursor,i=this.fragment.offset,n=this.fragmentEnd-(this.fragment.openEnd?1:0),r=t.absoluteLineStart,o=r,l=t.block.children.length,a=o,c=l;for(;;){if(e.to-i>n){if(e.type.isAnonymous&&e.firstChild())continue;break}let h=kM(e.from-i,t.ranges);if(e.to-i<=t.ranges[t.rangeI].to)t.addNode(e.tree,h);else{let f=new gt(t.parser.nodeSet.types[me.Paragraph],[],[],0,t.block.hashProp);t.reusePlaceholders.set(f,e.tree),t.addNode(f,h)}if(e.type.is("Block")&&(Nue.indexOf(e.type.id)<0?(o=e.to-i,l=t.block.children.length):(o=a,l=c,a=e.to-i,c=t.block.children.length)),!e.nextSibling())break}for(;t.block.children.length>l;)t.block.children.pop(),t.block.positions.pop();return o-r}}function kM(s,t){let e=s;for(let i=1;i<t.length;i++){let n=t[i-1].to,r=t[i].from;n<s&&(e-=r-n)}return e}const zue=Bc({"Blockquote/...":T.quote,HorizontalRule:T.contentSeparator,"ATXHeading1/... SetextHeading1/...":T.heading1,"ATXHeading2/... SetextHeading2/...":T.heading2,"ATXHeading3/...":T.heading3,"ATXHeading4/...":T.heading4,"ATXHeading5/...":T.heading5,"ATXHeading6/...":T.heading6,"Comment CommentBlock":T.comment,Escape:T.escape,Entity:T.character,"Emphasis/...":T.emphasis,"StrongEmphasis/...":T.strong,"Link/... Image/...":T.link,"OrderedList/... BulletList/...":T.list,"BlockQuote/...":T.quote,"InlineCode CodeText":T.monospace,"URL Autolink":T.url,"HeaderMark HardBreak QuoteMark ListMark LinkMark EmphasisMark CodeMark":T.processingInstruction,"CodeInfo LinkLabel":T.labelName,LinkTitle:T.string,Paragraph:T.content}),Wue=new jp(new Sd(pM).extend(zue),Object.keys(Pm).map(s=>Pm[s]),Object.keys(Pm).map(s=>mM[s]),Object.keys(Pm),Lue,rM,Object.keys(wb).map(s=>wb[s]),Object.keys(wb),[]);function Uue(s,t,e){let i=[];for(let n=s.firstChild,r=t;;n=n.nextSibling){let o=n?n.from:e;if(o>r&&i.push({from:r,to:o}),!n)break;r=n.to}return i}function Zue(s){let{codeParser:t,htmlParser:e}=s;return{wrap:dR((n,r)=>{let o=n.type.id;if(t&&(o==me.CodeBlock||o==me.FencedCode)){let l="";if(o==me.FencedCode){let c=n.node.getChild(me.CodeInfo);c&&(l=r.read(c.from,c.to))}let a=t(l);if(a)return{parser:a,overlay:c=>c.type.id==me.CodeText}}else if(e&&(o==me.HTMLBlock||o==me.HTMLTag||o==me.CommentBlock))return{parser:e,overlay:Uue(n.node,n.from,n.to)};return null})}}const Hue={resolve:"Strikethrough",mark:"StrikethroughMark"},que={defineNodes:[{name:"Strikethrough",style:{"Strikethrough/...":T.strikethrough}},{name:"StrikethroughMark",style:T.processingInstruction}],parseInline:[{name:"Strikethrough",parse(s,t,e){if(t!=126||s.char(e+1)!=126||s.char(e+2)==126)return-1;let i=s.slice(e-1,e),n=s.slice(e+2,e+3),r=/\s|^$/.test(i),o=/\s|^$/.test(n),l=od.test(i),a=od.test(n);return s.addDelimiter(Hue,e,e+2,!o&&(!a||r||l),!r&&(!l||o||a))},after:"Emphasis"}]};function vh(s,t,e=0,i,n=0){let r=0,o=!0,l=-1,a=-1,c=!1,h=()=>{i.push(s.elt("TableCell",n+l,n+a,s.parser.parseInline(t.slice(l,a),n+l)))};for(let f=e;f<t.length;f++){let m=t.charCodeAt(f);m==124&&!c?((!o||l>-1)&&r++,o=!1,i&&(l>-1&&h(),i.push(s.elt("TableDelimiter",f+n,f+n+1))),l=a=-1):(c||m!=32&&m!=9)&&(l<0&&(l=f),a=f+1),c=!c&&m==92}return l>-1&&(r++,i&&h()),r}function BE(s,t){for(let e=t;e<s.length;e++){let i=s.charCodeAt(e);if(i==124)return!0;i==92&&e++}return!1}const SM=/^\|?(\s*:?-+:?\s*\|)+(\s*:?-+:?\s*)?$/;class $E{constructor(){this.rows=null}nextLine(t,e,i){if(this.rows==null){this.rows=!1;let n;if((e.next==45||e.next==58||e.next==124)&&SM.test(n=e.text.slice(e.pos))){let r=[];vh(t,i.content,0,r,i.start)==vh(t,n,e.pos)&&(this.rows=[t.elt("TableHeader",i.start,i.start+i.content.length,r),t.elt("TableDelimiter",t.lineStart+e.pos,t.lineStart+e.text.length)])}}else if(this.rows){let n=[];vh(t,e.text,e.pos,n,t.lineStart),this.rows.push(t.elt("TableRow",t.lineStart+e.pos,t.lineStart+e.text.length,n))}return!1}finish(t,e){return this.rows?(t.addLeafElement(e,t.elt("Table",e.start,e.start+e.content.length,this.rows)),!0):!1}}const jue={defineNodes:[{name:"Table",block:!0},{name:"TableHeader",style:{"TableHeader/...":T.heading}},"TableRow",{name:"TableCell",style:T.content},{name:"TableDelimiter",style:T.processingInstruction}],parseBlock:[{name:"Table",leaf(s,t){return BE(t.content,0)?new $E:null},endLeaf(s,t,e){if(e.parsers.some(n=>n instanceof $E)||!BE(t.text,t.basePos))return!1;let i=s.peekLine();return SM.test(i)&&vh(s,t.text,t.basePos)==vh(s,i,t.basePos)},before:"SetextHeading"}]};class Xue{nextLine(){return!1}finish(t,e){return t.addLeafElement(e,t.elt("Task",e.start,e.start+e.content.length,[t.elt("TaskMarker",e.start,e.start+3),...t.parser.parseInline(e.content.slice(3),e.start+3)])),!0}}const Gue={defineNodes:[{name:"Task",block:!0,style:T.list},{name:"TaskMarker",style:T.atom}],parseBlock:[{name:"TaskList",leaf(s,t){return/^\[[ xX]\][ \t]/.test(t.content)&&s.parentType().name=="ListItem"?new Xue:null},after:"SetextHeading"}]},DE=/(www\.)|(https?:\/\/)|([\w.+-]{1,100}@)|(mailto:|xmpp:)/gy,QE=/[\w-]+(\.[\w-]+)+(\/[^\s<]*)?/gy,Yue=/[\w-]+\.[\w-]+($|\/)/,NE=/[\w.+-]+@[\w-]+(\.[\w.-]+)+/gy,FE=/\/[a-zA-Z\d@.]+/gy;function zE(s,t,e,i){let n=0;for(let r=t;r<e;r++)s[r]==i&&n++;return n}function Kue(s,t){QE.lastIndex=t;let e=QE.exec(s);if(!e||Yue.exec(e[0])[0].indexOf("_")>-1)return-1;let i=t+e[0].length;for(;;){let n=s[i-1],r;if(/[?!.,:*_~]/.test(n)||n==")"&&zE(s,t,i,")")>zE(s,t,i,"("))i--;else if(n==";"&&(r=/&(?:#\d+|#x[a-f\d]+|\w+);$/.exec(s.slice(t,i))))i=t+r.index;else break}return i}function WE(s,t){NE.lastIndex=t;let e=NE.exec(s);if(!e)return-1;let i=e[0][e[0].length-1];return i=="_"||i=="-"?-1:t+e[0].length-(i=="."?1:0)}const Jue={parseInline:[{name:"Autolink",parse(s,t,e){let i=e-s.offset;if(i&&/\w/.test(s.text[i-1]))return-1;DE.lastIndex=i;let n=DE.exec(s.text),r=-1;if(!n)return-1;if(n[1]||n[2]){if(r=Kue(s.text,i+n[0].length),r>-1&&s.hasOpenLink){let o=/([^\[\]]|\[[^\]]*\])*/.exec(s.text.slice(i,r));r=i+o[0].length}}else n[3]?r=WE(s.text,i):(r=WE(s.text,i+n[0].length),r>-1&&n[0]=="xmpp:"&&(FE.lastIndex=r,n=FE.exec(s.text),n&&(r=n.index+n[0].length)));return r<0?-1:(s.addElement(s.elt("URL",e,r+s.offset)),r+s.offset)}}]},ehe=[jue,Gue,que,Jue];function CM(s,t,e){return(i,n,r)=>{if(n!=s||i.char(r+1)==s)return-1;let o=[i.elt(e,r,r+1)];for(let l=r+1;l<i.end;l++){let a=i.char(l);if(a==s)return i.addElement(i.elt(t,r,l+1,o.concat(i.elt(e,l,l+1))));if(a==92&&o.push(i.elt("Escape",l,l+++2)),ys(a))break}return-1}}const the={defineNodes:[{name:"Superscript",style:T.special(T.content)},{name:"SuperscriptMark",style:T.processingInstruction}],parseInline:[{name:"Superscript",parse:CM(94,"Superscript","SuperscriptMark")}]},ihe={defineNodes:[{name:"Subscript",style:T.special(T.content)},{name:"SubscriptMark",style:T.processingInstruction}],parseInline:[{name:"Subscript",parse:CM(126,"Subscript","SubscriptMark")}]},nhe={defineNodes:[{name:"Emoji",style:T.character}],parseInline:[{name:"Emoji",parse(s,t,e){let i;return t!=58||!(i=/^[a-zA-Z_0-9]+:/.exec(s.slice(e+1,s.end)))?-1:s.addElement(s.elt("Emoji",e,e+1+i[0].length))}}]},PM=iv({commentTokens:{block:{open:"<!--",close:"-->"}}}),TM=new Fe,EM=Wue.configure({props:[$c.add(s=>!s.is("Block")||s.is("Document")||yO(s)!=null||she(s)?void 0:(t,e)=>({from:e.doc.lineAt(t.from).to,to:t.to})),TM.add(yO),Pd.add({Document:()=>null}),Ol.add({Document:PM})]});function yO(s){let t=/^(?:ATX|Setext)Heading(\d)$/.exec(s.name);return t?+t[1]:void 0}function she(s){return s.name=="OrderedList"||s.name=="BulletList"}function rhe(s,t){let e=s;for(;;){let i=e.nextSibling,n;if(!i||(n=yO(i.type))!=null&&n<=t)break;e=i}return e.to}const ohe=xR.of((s,t,e)=>{for(let i=St(s).resolveInner(e,-1);i&&!(i.from<t);i=i.parent){let n=i.type.prop(TM);if(n==null)continue;let r=rhe(i,n);if(r>e)return{from:e,to:r}}return null});function kv(s){return new os(PM,s,[ohe],"markdown")}const lhe=kv(EM),ahe=EM.configure([ehe,ihe,the,nhe,{props:[$c.add({Table:(s,t)=>({from:t.doc.lineAt(s.from).to,to:s.to})})]}]),AM=kv(ahe);function che(s,t){return e=>{if(e&&s){let i=null;if(e=/\S*/.exec(e)[0],typeof s=="function"?i=s(e):i=Jg.matchLanguageName(s,e,!0),i instanceof Jg)return i.support?i.support.language.parser:Gh.getSkippingParser(i.load());if(i)return i.parser}return t?t.parser:null}}class xb{constructor(t,e,i,n,r,o,l){this.node=t,this.from=e,this.to=i,this.spaceBefore=n,this.spaceAfter=r,this.type=o,this.item=l}blank(t,e=!0){let i=this.spaceBefore+(this.node.name=="Blockquote"?">":"");if(t!=null){for(;i.length<t;)i+=" ";return i}else{for(let n=this.to-this.from-i.length-this.spaceAfter.length;n>0;n--)i+=" ";return i+(e?this.spaceAfter:"")}}marker(t,e){let i=this.node.name=="OrderedList"?String(+RM(this.item,t)[2]+e):"";return this.spaceBefore+i+this.type+this.spaceAfter}}function IM(s,t){let e=[],i=[];for(let n=s;n;n=n.parent){if(n.name=="FencedCode")return i;(n.name=="ListItem"||n.name=="Blockquote")&&e.push(n)}for(let n=e.length-1;n>=0;n--){let r=e[n],o,l=t.lineAt(r.from),a=r.from-l.from;if(r.name=="Blockquote"&&(o=/^ *>( ?)/.exec(l.text.slice(a))))i.push(new xb(r,a,a+o[0].length,"",o[1],">",null));else if(r.name=="ListItem"&&r.parent.name=="OrderedList"&&(o=/^( *)\d+([.)])( *)/.exec(l.text.slice(a)))){let c=o[3],h=o[0].length;c.length>=4&&(c=c.slice(0,c.length-4),h-=4),i.push(new xb(r.parent,a,a+h,o[1],c,o[2],r))}else if(r.name=="ListItem"&&r.parent.name=="BulletList"&&(o=/^( *)([-+*])( {1,4}\[[ xX]\])?( +)/.exec(l.text.slice(a)))){let c=o[4],h=o[0].length;c.length>4&&(c=c.slice(0,c.length-4),h-=4);let f=o[2];o[3]&&(f+=o[3].replace(/[xX]/," ")),i.push(new xb(r.parent,a,a+h,o[1],c,f,r))}}return i}function RM(s,t){return/^(\s*)(\d+)(?=[.)])/.exec(t.sliceString(s.from,s.from+10))}function bb(s,t,e,i=0){for(let n=-1,r=s;;){if(r.name=="ListItem"){let l=RM(r,t),a=+l[2];if(n>=0){if(a!=n+1)return;e.push({from:r.from+l[1].length,to:r.from+l[0].length,insert:String(n+2+i)})}n=a}let o=r.nextSibling;if(!o)break;r=o}}function Sv(s,t){let e=/^[ \t]*/.exec(s)[0].length;if(!e||t.facet(Cd)!="	")return s;let i=$s(s,4,e),n="";for(let r=i;r>0;)r>=4?(n+="	",r-=4):(n+=" ",r--);return n+s.slice(e)}const uhe=({state:s,dispatch:t})=>{let e=St(s),{doc:i}=s,n=null,r=s.changeByRange(o=>{if(!o.empty||!AM.isActiveAt(s,o.from,0))return n={range:o};let l=o.from,a=i.lineAt(l),c=IM(e.resolveInner(l,-1),i);for(;c.length&&c[c.length-1].from>l-a.from;)c.pop();if(!c.length)return n={range:o};let h=c[c.length-1];if(h.to-h.spaceAfter.length>l-a.from)return n={range:o};let f=l>=h.to-h.spaceAfter.length&&!/\S/.test(a.text.slice(h.to));if(h.item&&f){let k=h.node.firstChild,C=h.node.getChild("ListItem","ListItem");if(k.to>=l||C&&C.to<l||a.from>0&&!/[^\s>]/.test(i.lineAt(a.from-1).text)){let P=c.length>1?c[c.length-2]:null,M,Q="";P&&P.item?(M=a.from+P.from,Q=P.marker(i,1)):M=a.from+(P?P.to:0);let N=[{from:M,to:l,insert:Q}];return h.node.name=="OrderedList"&&bb(h.item,i,N,-2),P&&P.node.name=="OrderedList"&&bb(P.item,i,N),{range:se.cursor(M+Q.length),changes:N}}else{let P=ZE(c,s,a);return{range:se.cursor(l+P.length+1),changes:{from:a.from,insert:P+s.lineBreak}}}}if(h.node.name=="Blockquote"&&f&&a.from){let k=i.lineAt(a.from-1),C=/>\s*$/.exec(k.text);if(C&&C.index==h.from){let P=s.changes([{from:k.from+C.index,to:k.to},{from:a.from+h.from,to:a.to}]);return{range:o.map(P),changes:P}}}let m=[];h.node.name=="OrderedList"&&bb(h.item,i,m);let w=h.item&&h.item.from<a.from,O="";if(!w||/^[\s\d.)\-+*>]*/.exec(a.text)[0].length>=h.to)for(let k=0,C=c.length-1;k<=C;k++)O+=k==C&&!w?c[k].marker(i,1):c[k].blank(k<C?$s(a.text,4,c[k+1].from)-O.length:null);let _=l;for(;_>a.from&&/\s/.test(a.text.charAt(_-a.from-1));)_--;return O=Sv(O,s),hhe(h.node,s.doc)&&(O=ZE(c,s,a)+s.lineBreak+O),m.push({from:_,to:l,insert:s.lineBreak+O}),{range:se.cursor(_+O.length+1),changes:m}});return n?!1:(t(s.update(r,{scrollIntoView:!0,userEvent:"input"})),!0)};function UE(s){return s.name=="QuoteMark"||s.name=="ListMark"}function hhe(s,t){if(s.name!="OrderedList"&&s.name!="BulletList")return!1;let e=s.firstChild,i=s.getChild("ListItem","ListItem");if(!i)return!1;let n=t.lineAt(e.to),r=t.lineAt(i.from),o=/^[\s>]*$/.test(n.text);return n.number+(o?0:1)<r.number}function ZE(s,t,e){let i="";for(let n=0,r=s.length-2;n<=r;n++)i+=s[n].blank(n<r?$s(e.text,4,Math.min(e.text.length,s[n+1].from))-i.length:null,n<r);return Sv(i,t)}function dhe(s,t){let e=s.resolveInner(t,-1),i=t;UE(e)&&(i=e.from,e=e.parent);for(let n;n=e.childBefore(i);)if(UE(n))i=n.from;else if(n.name=="OrderedList"||n.name=="BulletList")e=n.lastChild,i=e.to;else break;return e}const fhe=({state:s,dispatch:t})=>{let e=St(s),i=null,n=s.changeByRange(r=>{let o=r.from,{doc:l}=s;if(r.empty&&AM.isActiveAt(s,r.from)){let a=l.lineAt(o),c=IM(dhe(e,o),l);if(c.length){let h=c[c.length-1],f=h.to-h.spaceAfter.length+(h.spaceAfter?1:0);if(o-a.from>f&&!/\S/.test(a.text.slice(f,o-a.from)))return{range:se.cursor(a.from+f),changes:{from:a.from+f,to:o}};if(o-a.from==f&&(!h.item||a.from<=h.item.from||!/\S/.test(a.text.slice(0,h.to)))){let m=a.from+h.from;if(h.item&&h.node.from<h.item.from&&/\S/.test(a.text.slice(h.from,h.to))){let w=h.blank($s(a.text,4,h.to)-$s(a.text,4,h.from));return m==a.from&&(w=Sv(w,s)),{range:se.cursor(m+w.length),changes:{from:m,to:a.from+h.to,insert:w}}}if(m<o)return{range:se.cursor(m),changes:{from:m,to:o}}}}}return i={range:r}});return i?!1:(t(s.update(n,{scrollIntoView:!0,userEvent:"delete"})),!0)},mhe=[{key:"Enter",run:uhe},{key:"Backspace",run:fhe}],VM=sM({matchClosingTags:!1});function ghe(s={}){let{codeLanguages:t,defaultCodeLanguage:e,addKeymap:i=!0,base:{parser:n}=lhe,completeHTMLTags:r=!0,htmlTagLanguage:o=VM}=s;if(!(n instanceof jp))throw new RangeError("Base parser provided to `markdown` should be a Markdown parser");let l=s.extensions?[s.extensions]:[],a=[o.support],c;e instanceof Yh?(a.push(e.support),c=e.language):e&&(c=e);let h=t||c?che(t,c):void 0;l.push(Zue({codeParser:h,htmlParser:o.language.parser})),i&&a.push(zo.high(_d.of(mhe)));let f=kv(n.configure(l));return r&&a.push(f.data.of({autocomplete:phe})),new Yh(f,a)}function phe(s){let{state:t,pos:e}=s,i=/<[:\-\.\w\u00b7-\uffff]*$/.exec(t.sliceDoc(e-25,e));if(!i)return null;let n=St(t).resolveInner(e,-1);for(;n&&!n.type.isTop;){if(n.name=="CodeBlock"||n.name=="FencedCode"||n.name=="ProcessingInstructionBlock"||n.name=="CommentBlock"||n.name=="Link"||n.name=="Image")return null;n=n.parent}return{from:e-i[0].length,to:e,options:whe(),validFor:/^<[:\-\.\w\u00b7-\uffff]*$/}}let Ob=null;function whe(){if(Ob)return Ob;let s=Pue(new uv(ht.create({extensions:VM}),0,!0));return Ob=s?s.options:[]}const xhe="#e5c07b",HE="#e06c75",bhe="#56b6c2",Ohe="#ffffff",og="#abb2bf",vO="#7d8799",yhe="#61afef",vhe="#98c379",qE="#d19a66",_he="#c678dd",khe="#21252b",jE="#2c313a",XE="#282c34",yb="#353a42",She="#3E4451",GE="#528bff",Che=Ee.theme({"&":{color:og,backgroundColor:XE},".cm-content":{caretColor:GE},".cm-cursor, .cm-dropCursor":{borderLeftColor:GE},"&.cm-focused > .cm-scroller > .cm-selectionLayer .cm-selectionBackground, .cm-selectionBackground, .cm-content ::selection":{backgroundColor:She},".cm-panels":{backgroundColor:khe,color:og},".cm-panels.cm-panels-top":{borderBottom:"2px solid black"},".cm-panels.cm-panels-bottom":{borderTop:"2px solid black"},".cm-searchMatch":{backgroundColor:"#72a1ff59",outline:"1px solid #457dff"},".cm-searchMatch.cm-searchMatch-selected":{backgroundColor:"#6199ff2f"},".cm-activeLine":{backgroundColor:"#6699ff0b"},".cm-selectionMatch":{backgroundColor:"#aafe661a"},"&.cm-focused .cm-matchingBracket, &.cm-focused .cm-nonmatchingBracket":{backgroundColor:"#bad0f847"},".cm-gutters":{backgroundColor:XE,color:vO,border:"none"},".cm-activeLineGutter":{backgroundColor:jE},".cm-foldPlaceholder":{backgroundColor:"transparent",border:"none",color:"#ddd"},".cm-tooltip":{border:"none",backgroundColor:yb},".cm-tooltip .cm-tooltip-arrow:before":{borderTopColor:"transparent",borderBottomColor:"transparent"},".cm-tooltip .cm-tooltip-arrow:after":{borderTopColor:yb,borderBottomColor:yb},".cm-tooltip-autocomplete":{"& > ul > li[aria-selected]":{backgroundColor:jE,color:og}}},{dark:!0}),Phe=Ed.define([{tag:T.keyword,color:_he},{tag:[T.name,T.deleted,T.character,T.propertyName,T.macroName],color:HE},{tag:[T.function(T.variableName),T.labelName],color:yhe},{tag:[T.color,T.constant(T.name),T.standard(T.name)],color:qE},{tag:[T.definition(T.name),T.separator],color:og},{tag:[T.typeName,T.className,T.number,T.changed,T.annotation,T.modifier,T.self,T.namespace],color:xhe},{tag:[T.operator,T.operatorKeyword,T.url,T.escape,T.regexp,T.link,T.special(T.string)],color:bhe},{tag:[T.meta,T.comment],color:vO},{tag:T.strong,fontWeight:"bold"},{tag:T.emphasis,fontStyle:"italic"},{tag:T.strikethrough,textDecoration:"line-through"},{tag:T.link,color:vO,textDecoration:"underline"},{tag:T.heading,fontWeight:"bold",color:HE},{tag:[T.atom,T.bool,T.special(T.variableName)],color:qE},{tag:[T.processingInstruction,T.string,T.inserted],color:vhe},{tag:T.invalid,color:Ohe}]),The=[Che,TR(Phe)];function Tt(s,t){const e=s.t;switch(t){case"Edit source modal label":return e({string:"Edit source",id:"Edit source modal label"});case"Source":return e("Source");case"Source Editing Enhanced":return e("Source Editing Enhanced");case"Copy line down":return e("Copy line down");case"Copy line up":return e("Copy line up");case"Delete line":return e("Delete line");case"Indent less":return e("Indent less");case"Indent more":return e("Indent more");case"Fold all":return e("Fold all");case"Fold code (current level)":return e("Fold code (current level)");case"Move line down":return e("Move line down");case"Move line up":return e("Move line up");case"Redo (keystroke)":return e({id:"Redo (keystroke)",string:"Redo"});case"Select line":return e("Select line");case'Switch between "focus with tab" and "indent with tab" mode':return e('Switch between "focus with tab" and "indent with tab" mode');case"Toggle block comment":return e("Toggle block comment");case"Toggle comment":return e("Toggle comment");case"Undo (keystroke)":return e({id:"Undo (keystroke)",string:"Undo"});case"Unfold all":return e("Unfold all");case"Unfold code (current level)":return e("Unfold code (current level)");case"Are you sure you want to discard your changes? This action cannot be undone.":return e("Are you sure you want to discard your changes? This action cannot be undone.");case"Cancel":return e("Cancel");case"Save":return e("Save");default:return t}}function MM(s){const t=s.editing.view.document.roots,e=t.length;if(e===0)throw new E("source-editing-enhanced-editor-no-root",s);return e===1?t.first.rootName:Array.from(s.editing.view.document.selection.getRanges())[0].root.rootName}function Em(s){return LM(s.replace(/^[\n\s]*/g,""))?s.replace(/\s+/g,""):s}function LM(s){return s.startsWith("<")}function Ehe(s){const t=[Ee.lineWrapping,mae(),roe(),nae(),Qse(),fse(),xse(),Jse(),jre(),Ase(),ire(),kse(),Ooe(),Bre(),Bse(),TR(Kre,{fallback:!0})],e=new Od;t.push(e.of(Ee.editable.of(!0))),s.syntaxLanguage==="html"?t.push(sM()):t.push(ghe());const i=function(r){return r&&r!=="default"?r==="dark"?The:r:null}(s.theme);i&&t.push(i),t.push(_d.of([...lae,...ble,...Eoe,...Ure,...yV,{key:"Tab",run:aV,shift:cV,preventDefault:!0,stopPropagation:!0},{key:"Ctrl-y",mac:"Cmd-y",run:Jh,preventDefault:!0,stopPropagation:!0},{key:"Ctrl-Shift-z",mac:"Cmd-Shift-z",run:Jh,preventDefault:!0,stopPropagation:!0},{key:"Ctrl-z",mac:"Cmd-z",run:av,preventDefault:!0,stopPropagation:!0}]));const n=new Ee({extensions:t,parent:s.parent});return uV(n),{focus:()=>{n.dispatch({selection:{anchor:0},scrollIntoView:!0}),n.focus()},getData:()=>n.state.doc.toString(),setData:r=>{n.dispatch({changes:{from:0,to:n.state.doc.length,insert:r},annotations:Jt.addToHistory.of(!1)})},setReadOnly:r=>{n.dispatch({effects:[e.reconfigure(Ee.editable.of(!r))]})},destroy:()=>{n.destroy()},instance:n}}class Ahe extends ue{constructor(e,i){super(e);p(this,"_codeEditorApi",null);p(this,"_options");this._options=i,this.set("isReadOnly",!1),this.setTemplate({tag:"div",attributes:{class:["ck","ck-reset_all-excluded","ck-code-editor"],tabindex:-1}})}render(){super.render(),this._codeEditorApi=Ehe({parent:this.element,syntaxLanguage:this._options.syntaxLanguage,theme:this._options.theme}),this.on("change:isReadOnly",(e,i,n)=>{this.setReadOnly(n)})}destroy(){super.destroy(),this._codeEditorApi.destroy(),this._codeEditorApi=null}focus(){this.isReadOnly?this.element.focus():this._codeEditorApi.focus()}getData(){return this._codeEditorApi.getData()}setData(e){this._codeEditorApi.setData(e)}setReadOnly(e){this._codeEditorApi.setReadOnly(e)}}const YE="SourceEditingEnhancedMode";class Ihe extends Be{constructor(t){super(t),this.affectsData=!1,this.editor.plugins.get(Ro).on("change:hasAny",(e,i,n)=>{n?this.forceDisabled("pendingActions"):this.clearForceDisabled("pendingActions")})}_disableCommands(){const t=this.editor;for(const e of t.commands.names())["replaceSource","editSource"].includes(e)||t.commands.get(e).forceDisabled(YE)}_enableCommands(){const t=this.editor;for(const e of t.commands.commands())e.clearForceDisabled(YE)}refresh(){this.isEnabled=!0}execute(){const t=this.editor,e=t.locale,i=t.plugins.get("Dialog"),n=MM(t),r=t.data.get({rootName:n}),o=LM(l=r)?cD(l):l;var l;const a=new Ahe(e,{syntaxLanguage:t.plugins.has("Markdown")?"markdown":"html",theme:t.config.get("sourceEditingEnhanced.theme")});let c=!0;const h=f=>{if(c)return Em(a.getData())!==Em(o)?window.confirm(Tt(e,"Are you sure you want to discard your changes? This action cannot be undone."))?void 0:f.stop():void 0};i.show({id:"sourceEditingEnhanced",title:Tt(e,"Edit source modal label"),isModal:!0,className:"ck-source-editing-enhanced-dialog",content:a,actionButtons:[{label:Tt(e,"Cancel"),withText:!0,onExecute:()=>{i.hide()}},{label:Tt(e,"Save"),class:"ck-button-action",withText:!0,onExecute:()=>{const f=Em(a.getData())!==Em(o);f&&t.execute("replaceSource",a.getData()),c=!1,i.hide(),f&&"editables"in t.ui.view&&t.ui.view.editables[n].element.focus()},onCreate:f=>{f.set("isEnabled",!t.isReadOnly),f.bind("isEnabled").to(t,"isReadOnly",this,"isEnabled",(m,w)=>!m&&w)}}],onHide:()=>{this._enableCommands(),i.off("hide",h),a.destroy()},onShow:()=>{a.bind("isReadOnly").to(t,"isReadOnly",this,"isEnabled",(f,m)=>f||!m),a.setData(o),a.focus(),i.on("hide",h,{priority:"highest"}),this._disableCommands()}})}}class Rhe extends F{static get pluginName(){return"SourceEditingEnhancedUI"}static get requires(){return[Ro]}static get isOfficialPlugin(){return!0}static get isPremiumPlugin(){return!0}init(){const t=this.editor,e=t.locale,i=new Ihe(t);t.commands.add("editSource",i),t.ui.componentFactory.add("sourceEditingEnhanced",()=>{const n=this._createButton(ye,i);return n.set({label:Tt(e,"Source"),icon:NC,tooltip:Tt(e,"Edit source modal label"),class:"ck-source-editing-enhanced-button"}),n}),t.ui.componentFactory.add("menuBar:sourceEditingEnhanced",()=>{const n=this._createButton(ti,i,!0);return n.set({label:Tt(e,"Edit source modal label"),icon:NC,role:"menuitemcheckbox"}),n}),this._registerKeybindings()}afterInit(){(async function(t){const e=b([108,116,119,111,122,56,71,65,75,55,105,68,48,121,53,90,85,74,114,100,106,78,99,110,73,80,51,102,54,69,118,70,52,67,79,112,109,107,81,57,76,82,120,50,117,88,87,113,84,98,66,83,77,101,97,86,49,104,103,115,72,89]),i=1025283116,n=1025245060^i,r=window[b([68,97,116,101])][b([110,111,119])](),o=t[b([101,100,105,116,111,114])],l=new window[b([80,114,111,109,105,115,101])](I=>{o[b([111,110,99,101])](b([114,101,97,100,121]),I)}),a={[b([107,116,121])]:b([69,67]),[b([117,115,101])]:b([115,105,103]),[b([99,114,118])]:b([80,45,50,53,54]),[b([120])]:b([105,67,106,79,67,118,68,70,73,54,108,81,72,72,84,49,56,106,86,119,82,102,107,102,72,81,50,97,95,77,121,109,84,51,53,76,81,86,111,70,83,65,73]),[b([121])]:b([107,88,73,121,74,52,101,118,116,67,69,70,82,109,120,75,83,85,112,75,57,102,68,87,52,53,57,118,88,79,118,86,114,104,102,54,117,81,65,101,79,105,111]),[b([97,108,103])]:b([69,83,50,53,54])},c=o[b([99,111,110,102,105,103])][b([103,101,116])](b([108,105,99,101,110,115,101,75,101,121]));async function h(){let I,B=null,j=null;try{return c==b([71,80,76])?b([78,111,116,65,108,108,111,119,101,100]):(I=k(),I?(I[b([117,115,97,103,101,69,110,100,112,111,105,110,116])]&&(j=f(I[b([117,115,97,103,101,69,110,100,112,111,105,110,116])],I[b([106,116,105])])),await C()?H()?W()?b([69,120,112,105,114,101,100]):te()?(I[b([108,105,99,101,110,115,101,84,121,112,101])]==b([101,118,97,108,117,97,116,105,111,110])&&(B=m(b([69,118,97,108,117,97,116,105,111,110,76,105,109,105,116]))),I[b([108,105,99,101,110,115,101,84,121,112,101])]==b([116,114,105,97,108])&&(B=m(b([84,114,105,97,108,76,105,109,105,116]))),await de()):b([68,111,109,97,105,110,76,105,109,105,116]):b([78,111,116,65,108,108,111,119,101,100]):b([73,110,118,97,108,105,100])):b([73,110,118,97,108,105,100]))}catch{return b([73,110,118,97,108,105,100])}function W(){const oe=[b([101,118,97,108,117,97,116,105,111,110]),b([116,114,105,97,108])][b([105,110,99,108,117,100,101,115])](I[b([108,105,99,101,110,115,101,84,121,112,101])])?r/1e3:3600*n;return I[b([101,120,112])]<oe}function H(){const oe=I[b([102,101,97,116,117,114,101,115])];return!!oe&&(!!oe[b([105,110,99,108,117,100,101,115])](b([42]))||!!oe[b([105,110,99,108,117,100,101,115])](b([83,69,69])))}function te(){const oe=I[b([108,105,99,101,110,115,101,100,72,111,115,116,115])];if(!oe||oe[b([108,101,110,103,116,104])]==0)return!0;const{hostname:ve}=new URL(window[b([108,111,99,97,116,105,111,110])].href);if(oe[b([105,110,99,108,117,100,101,115])](ve))return!0;const Z=ve[b([115,112,108,105,116])](b([46]));return oe[b([102,105,108,116,101,114])](Y=>Y[b([105,110,99,108,117,100,101,115])](b([42])))[b([109,97,112])](Y=>Y[b([115,112,108,105,116])](b([46])))[b([102,105,108,116,101,114])](Y=>Y[b([108,101,110,103,116,104])]<=Z[b([108,101,110,103,116,104])])[b([109,97,112])](Y=>Array(Z[b([108,101,110,103,116,104])]-Y[b([108,101,110,103,116,104])])[b([102,105,108,108])](Y[0]===b([42])?b([42]):"")[b([99,111,110,99,97,116])](Y))[b([115,111,109,101])](Y=>Z[b([101,118,101,114,121])]((ie,V)=>Y[V]===ie||Y[V]===b([42])))}function de(){return B&&j?new window[b([80,114,111,109,105,115,101])]((oe,ve)=>{B[b([116,104,101,110])](oe,ve),j[b([116,104,101,110])](Z=>{Z!=b([86,97,108,105,100])&&oe(Z)},ve)}):B||j||b([86,97,108,105,100])}}function f(I,B){return new window[b([80,114,111,109,105,115,101])](H=>{if(j())return H(b([86,97,108,105,100]));W(),o[b([100,101,99,111,114,97,116,101])](b([95,115,101,110,100,85,115,97,103,101,82,101,113,117,101,115,116]));let te=!1;const de=ei();function oe(Z){return!!Z&&(typeof Z===b([111,98,106,101,99,116])||typeof Z===b([102,117,110,99,116,105,111,110]))&&typeof Z[b([116,104,101,110])]===b([102,117,110,99,116,105,111,110])&&typeof Z[b([99,97,116,99,104])]===b([102,117,110,99,116,105,111,110])}function ve(Z){J(Z)[b([116,104,101,110])](ae=>!ae||ae[b([115,116,97,116,117,115])]!=b([111,107])?b([85,115,97,103,101,76,105,109,105,116]):N(Q(de+B))!=ae[b([118,101,114,105,102,105,99,97,116,105,111,110])]?b([85,115,97,103,101,76,105,109,105,116]):b([86,97,108,105,100]))[b([116,104,101,110])](ae=>(ie(),ae),()=>{const ae=V();return ae==null?(ie(),b([86,97,108,105,100])):b(r-ae>(420483116^i)?[85,115,97,103,101,76,105,109,105,116]:[86,97,108,105,100])})[b([116,104,101,110])](H)[b([99,97,116,99,104])](()=>{H(b([85,115,97,103,101,76,105,109,105,116]))});const Y=1026194092^i;function ie(){const ae=b([108,108,99,116,45])+N(Q(I)),U=G(N(window[b([77,97,116,104])][b([99,101,105,108])](r/Y)));window[b([108,111,99,97,108,83,116,111,114,97,103,101])][b([115,101,116,73,116,101,109])](ae,U)}function V(){const ae=b([108,108,99,116,45])+N(Q(I)),U=window[b([108,111,99,97,108,83,116,111,114,97,103,101])][b([103,101,116,73,116,101,109])](ae);return U?window[b([112,97,114,115,101,73,110,116])](G(U),16)*Y:null}function J(ae){return new window[b([80,114,111,109,105,115,101])]((U,$)=>{ae[b([116,104,101,110])](U,$),window[b([115,101,116,84,105,109,101,111,117,116])]($,1025327340^i)})}}o[b([111,110])](b([95,115,101,110,100,85,115,97,103,101,82,101,113,117,101,115,116]),(Z,Y)=>{if(Y[0]!=I)return H(b([85,115,97,103,101,76,105,109,105,116]));Y[1]={...Y[1],[b([114,101,113,117,101,115,116,73,100])]:de}},{[b([112,114,105,111,114,105,116,121])]:b([104,105,103,104])}),o[b([111,110])](b([95,115,101,110,100,85,115,97,103,101,82,101,113,117,101,115,116]),Z=>{oe(Z[b([114,101,116,117,114,110])])&&(te=!0,ve(Z[b([114,101,116,117,114,110])]))},{[b([112,114,105,111,114,105,116,121])]:b([108,111,119])}),l[b([116,104,101,110])](()=>{te||H(b([85,115,97,103,101,76,105,109,105,116]))})});function j(){return o[b([101,100,105,116,105,110,103])][b([118,105,101,119])][b([95,111,118,101,114,108,97,121,77,111,100,101,72,105,110,116])]==b([97,117,116,111])}function W(){o[b([101,100,105,116,105,110,103])][b([118,105,101,119])][b([95,111,118,101,114,108,97,121,77,111,100,101,72,105,110,116])]=b([97,117,116,111])}}function m(I){const B=[new window[b([80,114,111,109,105,115,101])](j=>setTimeout(j,1024830176^i)),l[b([116,104,101,110])](()=>new window[b([80,114,111,109,105,115,101])](j=>{let W=0;o[b([109,111,100,101,108])][b([111,110])](b([97,112,112,108,121,79,112,101,114,97,116,105,111,110]),(H,te)=>{te[0][b([105,115,68,111,99,117,109,101,110,116,79,112,101,114,97,116,105,111,110])]&&W++,W==(1025283540^i)&&(j(),H[b([111,102,102])]())})}))];return window[b([80,114,111,109,105,115,101])][b([114,97,99,101])](B)[b([116,104,101,110])](()=>I)}async function w(){await l,o[b([109,111,100,101,108])][b([99,104,97,110,103,101])]=D,o[b([109,111,100,101,108])][b([101,110,113,117,101,117,101,67,104,97,110,103,101])]=D,o[b([101,110,97,98,108,101,82,101,97,100,79,110,108,121,77,111,100,101])](b([109,111,100,101,108]))}function O(I){const B=_();o[B]=b([115,111,117,114,99,101,69,100,105,116,105,110,103,69,110,104,97,110,99,101,100,76,105,99,101,110,115,101,75,101,121])+I,I!=b([86,97,108,105,100])&&w()}function _(){const I=window[b([83,116,114,105,110,103])](window[b([112,101,114,102,111,114,109,97,110,99,101])][b([110,111,119])]())[b([114,101,112,108,97,99,101])](b([46]),"");let B=b([108]);for(let j=0;j<I[b([108,101,110,103,116,104])];j+=2){let W=window[b([112,97,114,115,101,73,110,116])](I[b([115,117,98,115,116,114,105,110,103])](j,j+2));W>=e[b([108,101,110,103,116,104])]&&(W-=e[b([108,101,110,103,116,104])]),B+=e[W]}return B}function k(){const I=c[b([115,112,108,105,116])](b([46]));if(I[b([108,101,110,103,116,104])]!=3)return null;return B(I[1]);function B(j){const W=P(j);return W&&H()?W:null;function H(){const te=W[b([106,116,105])],de=window[b([112,97,114,115,101,73,110,116])](te[b([115,117,98,115,116,114,105,110,103])](te[b([108,101,110,103,116,104])]-8),16),oe={...W,[b([106,116,105])]:te[b([115,117,98,115,116,114,105,110,103])](0,te[b([108,101,110,103,116,104])]-8)};return delete oe[b([118,99])],Q(oe)==de}}}async function C(){let I=!0;try{const W=c[b([115,112,108,105,116])](b([46])),[H,te,de]=W;return B(H),await j(H,te,de),I}catch{return!1}function B(W){const H=P(W);H&&H[b([97,108,103])]==b([69,83,50,53,54])||(I=!1)}async function j(W,H,te){const de=window[b([85,105,110,116,56,65,114,114,97,121])][b([102,114,111,109])](M(te),Y=>Y[b([99,104,97,114,67,111,100,101,65,116])](0)),oe=new window[b([84,101,120,116,69,110,99,111,100,101,114])]()[b([101,110,99,111,100,101])](W+b([46])+H),ve=window[b([99,114,121,112,116,111])][b([115,117,98,116,108,101])];if(!ve)return;const Z=await ve[b([105,109,112,111,114,116,75,101,121])](b([106,119,107]),a,{[b([110,97,109,101])]:b([69,67,68,83,65]),[b([110,97,109,101,100,67,117,114,118,101])]:b([80,45,50,53,54])},!1,[b([118,101,114,105,102,121])]);await ve[b([118,101,114,105,102,121])]({[b([110,97,109,101])]:b([69,67,68,83,65]),[b([104,97,115,104])]:{[b([110,97,109,101])]:b([83,72,65,45,50,53,54])}},Z,de,oe)||(I=!1)}}function P(I){return I[b([115,116,97,114,116,115,87,105,116,104])](b([101,121]))?JSON[b([112,97,114,115,101])](M(I)):null}function M(I){return window[b([97,116,111,98])](I[b([114,101,112,108,97,99,101])](/-/g,b([43]))[b([114,101,112,108,97,99,101])](/_/g,b([47])))}function Q(I){let B=5381;function j(H){for(let te=0;te<H[b([108,101,110,103,116,104])];te++){const de=H[b([99,104,97,114,67,111,100,101,65,116])](te);B=(B<<5)+B+de,B&=B}}function W(H){Array[b([105,115,65,114,114,97,121])](H)?H[b([102,111,114,69,97,99,104])](W):H&&typeof H==b([111,98,106,101,99,116])?Object[b([101,110,116,114,105,101,115])](H)[b([115,111,114,116])]()[b([102,111,114,69,97,99,104])](([te,de])=>{j(te),W(de)}):j(window[b([83,116,114,105,110,103])](H))}return W(I),B>>>0}function N(I){return I[b([116,111,83,116,114,105,110,103])](16)[b([112,97,100,83,116,97,114,116])](8,b([48]))}function G(I){return I[b([115,112,108,105,116])]("")[b([114,101,118,101,114,115,101])]()[b([106,111,105,110])]("")}function D(){}function b(I){return I.map(B=>String.fromCharCode(B)).join("")}O(await h())})(this)}_createButton(t,e,i=!1){const n=new t(this.editor.locale);return n.set({withText:i,isToggleable:!1}),n.bind("isEnabled").to(e,"isEnabled"),this.listenTo(n,"execute",()=>e.execute()),n}_registerKeybindings(){const t=this.editor.locale;this.editor.accessibility.addKeystrokeInfoCategory({id:"sourceEditingEnhanced",label:Tt(t,"Source Editing Enhanced")});const e=Ie.isMac||Ie.isiOS;this.editor.accessibility.addKeystrokeInfos({categoryId:"sourceEditingEnhanced",keystrokes:[{label:Tt(t,"Copy line down"),keystroke:"Shift+Alt+ArrowDown"},{label:Tt(t,"Copy line up"),keystroke:"Shift+Alt+ArrowUp"},{label:Tt(t,"Delete line"),keystroke:"Shift+Ctrl+K"},{label:Tt(t,"Indent less"),keystroke:"Ctrl+["},{label:Tt(t,"Indent more"),keystroke:"Ctrl+]"},{label:Tt(t,"Fold all"),keystroke:"Ctrl!+Alt+["},{label:Tt(t,"Fold code (current level)"),keystroke:e?"Cmd+Alt+[":"Ctrl+Shift+["},{label:Tt(t,"Move line down"),keystroke:"Alt+ArrowDown"},{label:Tt(t,"Move line up"),keystroke:"Alt+ArrowUp"},{label:Tt(t,"Redo (keystroke)"),keystroke:[["Ctrl+Shift+Z"],["Ctrl+Y"]]},{label:Tt(t,"Select line"),keystroke:e?"Ctrl!+L":"Alt+L"},{label:Tt(t,'Switch between "focus with tab" and "indent with tab" mode'),keystroke:e?"Alt+Shift+M":"Ctrl+M"},{label:Tt(t,"Toggle block comment"),keystroke:"Shift+Alt+A"},{label:Tt(t,"Toggle comment"),keystroke:"Ctrl+/"},{label:Tt(t,"Undo (keystroke)"),keystroke:"Ctrl+Z"},{label:Tt(t,"Unfold all"),keystroke:"Ctrl!+Alt+]"},{label:Tt(t,"Unfold code (current level)"),keystroke:e?"Cmd+Alt+]":"Ctrl+Shift+]"}]})}}class Vhe extends Be{constructor(t){super(t),this.refresh()}refresh(){this.isEnabled=!this.editor.isReadOnly}execute(t,e){const i=this.editor,n=(e==null?void 0:e.rootName)??MM(i);i.data.set({[n]:t},{batchType:{isUndoable:!0},suppressErrorInCollaboration:!0})}}class Mhe extends F{constructor(e){super(e);p(this,"licenseKey");p(this,"_licenseKeyCheckInterval");e.config.define("sourceEditingEnhanced.allowCollaborationFeatures",!1)}static get pluginName(){return"SourceEditingEnhanced"}static get isOfficialPlugin(){return!0}static get isPremiumPlugin(){return!0}static get requires(){return[Rhe]}init(){this._checkCompatibility(),this.editor.commands.add("replaceSource",new Vhe(this.editor)),this.licenseKey=this.editor.config.get("licenseKey");const e=this.editor;this._licenseKeyCheckInterval=setInterval(()=>{let i;for(const n in e){const r=n,o=e[r];if(o=="sourceEditingEnhancedLicenseKeyValid"||o=="sourceEditingEnhancedLicenseKeyInvalid"||o=="sourceEditingEnhancedLicenseKeyExpired"||o=="sourceEditingEnhancedLicenseKeyDomainLimit"||o=="sourceEditingEnhancedLicenseKeyNotAllowed"||o=="sourceEditingEnhancedLicenseKeyEvaluationLimit"||o=="sourceEditingEnhancedLicenseKeyTrialLimit"||o=="sourceEditingEnhancedLicenseKeyUsageLimit"){delete e[r],i=o,clearInterval(this._licenseKeyCheckInterval),this._licenseKeyCheckInterval=void 0;break}}i=="sourceEditingEnhancedLicenseKeyInvalid"&&e._showLicenseError("invalid"),i=="sourceEditingEnhancedLicenseKeyExpired"&&e._showLicenseError("expired"),i=="sourceEditingEnhancedLicenseKeyDomainLimit"&&e._showLicenseError("domainLimit"),i=="sourceEditingEnhancedLicenseKeyNotAllowed"&&e._showLicenseError("featureNotAllowed","SourceEditingEnhanced"),i=="sourceEditingEnhancedLicenseKeyEvaluationLimit"&&e._showLicenseError("evaluationLimit"),i=="sourceEditingEnhancedLicenseKeyTrialLimit"&&e._showLicenseError("trialLimit"),i=="sourceEditingEnhancedLicenseKeyUsageLimit"&&e._showLicenseError("usageLimit")},1e3)}destroy(){this._licenseKeyCheckInterval&&clearInterval(this._licenseKeyCheckInterval)}_checkCompatibility(){const e=this.editor,i=e.config.get("sourceEditingEnhanced.allowCollaborationFeatures");if(!i&&e.plugins.has("RealTimeCollaborativeEditing"))throw new E("source-editing-enhanced-incompatible-with-real-time-collaboration",null);!i&&["CommentsEditing","TrackChangesEditing","RevisionHistory"].some(n=>e.plugins.has(n))&&console.warn("You initialized the editor with the source editing enhanced feature and at least one of the collaboration features. Please be advised that the source editing feature may not work, and be careful when editing document source that contains markers created by the collaboration features."),e.plugins.has("RestrictedEditingModeEditing")&&console.warn("You initialized the editor with the source editing enhanced feature and restricted editing feature. Please be advised that the source editing enhanced feature may not work, and be careful when editing document source that contains markers created by the restricted editing feature.")}}const Lhe=["tableCellBorderWidth","tableCellBorderColor","tableCellBorderStyle","tableCellHorizontalAlignment","tableCellVerticalAlignment","tableCellBackgroundColor","tableCellPadding"];Object.fromEntries(Lhe.map(s=>[s,null]));const Bhe="<YOUR_LICENSE_KEY>",$he="<YOUR_AI_API_KEY>",Dhe="<YOUR_CLOUD_SERVICES_TOKEN_URL>";function Qhe(){const s=pn.useRef(null),t=pn.useRef(null),[e,i]=pn.useState(!1);pn.useEffect(()=>(i(!0),()=>i(!1)),[]);const{editorConfig:n}=pn.useMemo(()=>e?{editorConfig:{toolbar:{items:["undo","redo","|","aiCommands","aiAssistant","|","sourceEditingEnhanced","showBlocks","|","heading","|","bold","italic","code","|","emoji","link","insertImage","ckbox","insertTable","codeBlock","htmlEmbed","|","bulletedList","numberedList"],shouldNotGroupWhenFull:!1},plugins:[Wte,bZ,vX,N7,OZ,_Z,XH,eq,bq,PZ,Mq,sj,pj,fX,_j,gX,Ej,MX,NX,BX,oG,P7,wG,TG,_y,EG,C7,AZ,hY,xY,WY,eK,vK,Zte,Vg,uJ,lie,IG,mJ,Mhe,Aee,Pte,Yee,ite,bte,Iee,dZ],ai:{openAI:{requestHeaders:{Authorization:"Bearer "+$he}}},cloudServices:{tokenUrl:Dhe},heading:{options:[{model:"paragraph",title:"Paragraph",class:"ck-heading_paragraph"},{model:"heading1",view:"h1",title:"Heading 1",class:"ck-heading_heading1"},{model:"heading2",view:"h2",title:"Heading 2",class:"ck-heading_heading2"},{model:"heading3",view:"h3",title:"Heading 3",class:"ck-heading_heading3"},{model:"heading4",view:"h4",title:"Heading 4",class:"ck-heading_heading4"},{model:"heading5",view:"h5",title:"Heading 5",class:"ck-heading_heading5"},{model:"heading6",view:"h6",title:"Heading 6",class:"ck-heading_heading6"}]},htmlSupport:{allow:[{name:/^.*$/,styles:!0,attributes:!0,classes:!0}]},image:{toolbar:["toggleImageCaption","imageTextAlternative","|","imageStyle:inline","imageStyle:wrapText","imageStyle:breakText","|","resizeImage","|","ckboxImageEdit"]},initialData:`<h2>Congratulations on setting up CKEditor 5! 🎉</h2>
<p>
	You've successfully created a CKEditor 5 project. This powerful text editor
	will enhance your application, enabling rich text editing capabilities that
	are customizable and easy to use.
</p>
<h3>What's next?</h3>
<ol>
	<li>
		<strong>Integrate into your app</strong>: time to bring the editing into
		your application. Take the code you created and add to your application.
	</li>
	<li>
		<strong>Explore features:</strong> Experiment with different plugins and
		toolbar options to discover what works best for your needs.
	</li>
	<li>
		<strong>Customize your editor:</strong> Tailor the editor's
		configuration to match your application's style and requirements. Or
		even write your plugin!
	</li>
</ol>
<p>
	Keep experimenting, and don't hesitate to push the boundaries of what you
	can achieve with CKEditor 5. Your feedback is invaluable to us as we strive
	to improve and evolve. Happy editing!
</p>
<h3>Helpful resources</h3>
<ul>
	<li>📝 <a href="https://portal.ckeditor.com/checkout?plan=free">Trial sign up</a>,</li>
	<li>📕 <a href="https://ckeditor.com/docs/ckeditor5/latest/installation/index.html">Documentation</a>,</li>
	<li>⭐️ <a href="https://github.com/ckeditor/ckeditor5">GitHub</a> (star us if you can!),</li>
	<li>🏠 <a href="https://ckeditor.com">CKEditor Homepage</a>,</li>
	<li>🧑‍💻 <a href="https://ckeditor.com/ckeditor-5/demo/">CKEditor 5 Demos</a>,</li>
</ul>
<h3>Need help?</h3>
<p>
	See this text, but the editor is not starting up? Check the browser's
	console for clues and guidance. It may be related to an incorrect license
	key if you use premium features or another feature-related requirement. If
	you cannot make it work, file a GitHub issue, and we will help as soon as
	possible!
</p>
`,licenseKey:Bhe,link:{addTargetToExternalLinks:!0,defaultProtocol:"https://",decorators:{toggleDownloadable:{mode:"manual",label:"Downloadable",attributes:{download:"file"}}}},list:{properties:{styles:!0,startIndex:!0,reversed:!0}},mention:{feeds:[{marker:"@",feed:[]}]},placeholder:"Type or paste your content here!",table:{contentToolbar:["tableColumn","tableRow","mergeTableCells","tableProperties","tableCellProperties"]}}}:{},[e]);return pn.useEffect(()=>{n&&_O(n)},[n]),ml.jsx("div",{className:"main-container",children:ml.jsx("div",{className:"editor-container editor-container_classic-editor",ref:s,children:ml.jsx("div",{className:"editor-container__editor",children:ml.jsx("div",{ref:t,children:n&&ml.jsx(s6,{editor:$q,config:n})})})})})}function _O(s){var i,n,r,o;if(_O.configUpdateAlertShown)return;const t=(l,a)=>!(l===a||l===void 0),e=[];_O.configUpdateAlertShown=!0,t(s.licenseKey,"<YOUR_LICENSE_KEY>")||e.push("LICENSE_KEY"),t((r=(n=(i=s.ai)==null?void 0:i.openAI)==null?void 0:n.requestHeaders)==null?void 0:r.Authorization,"Bearer <YOUR_AI_API_KEY>")||e.push("AI_API_KEY"),t((o=s.cloudServices)==null?void 0:o.tokenUrl,"<YOUR_CLOUD_SERVICES_TOKEN_URL>")||e.push("CLOUD_SERVICES_TOKEN_URL"),e.length&&window.alert(["Please update the following values in your editor config","to receive full access to Premium Features:","",...e.map(l=>` - ${l}`)].join(`
`))}zB.createRoot(document.getElementById("root")).render(ml.jsx(ko.StrictMode,{children:ml.jsx(Qhe,{})}));
